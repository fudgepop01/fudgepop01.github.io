var __awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,a)}l((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};HexEditor.loadBundle("6dkfuwqr",["exports"],function(e){var t=window.HexEditor.h;function n(e){return!(!e||!e.content)}var i=function(){function e(e){this.parent=e,this.added=new Uint8Array,this.pieces=[],this.chunk="",this.original=e.file,this.pieces=[{offset:0,length:this.original.length,source:"origin"}]}return e.prototype.initEdit=function(e,t){var n,i;if(this.inProgress={offset:e,type:t,content:[],index:-1,get length(){return this.content.length}},"insert"===t){for(var r=0,s=void 0,o=void 0,a=void 0,l=0,h=this.pieces.entries();l<h.length;l++){var c=h[l],u=c[0];if((r+=(f=c[1]).length)>=e){s=f.length-r+e,o=u,a=f;break}}this.inProgress.index=o+1,(n=this.pieces).splice.apply(n,[o,1].concat([{offset:a.offset,length:s,source:a.source},this.inProgress,{offset:a.offset+s,length:a.length-s,source:a.source}]))}else{r=0,s=void 0,o=void 0,a=void 0;for(var d=0,p=this.pieces.entries();d<p.length;d++){var f,g=p[d];if(u=g[0],(r+=(f=g[1]).length)>=e){s=f.length-r+e,o=u,a=f;break}}this.inProgress.index=o+1,(i=this.pieces).splice.apply(i,[o,1].concat([{offset:a.offset,length:s,source:a.source},this.inProgress,{offset:a.offset+s,length:a.length-s,source:a.source}]))}},e.prototype.buildEdit=function(e){if(/^[a-fA-F0-9]$/.test(e.key)&&(this.chunk+=e.key,2===this.chunk.length)){this.inProgress.content.push(parseInt(this.chunk,16)),this.chunk="",this.parent.setCursorPosition(this.parent.cursor+1);var t=this.pieces.indexOf(this.inProgress);if("overwrite"===this.inProgress.type&&t!==this.pieces.length-1){var n=this.pieces[t+1];n.offset+=1,n.length-=1,0===n.length&&this.pieces.splice(t+1,1)}}},e.prototype.commit=function(){var e=new Uint8Array(this.added.length+this.inProgress.content.length);e.set(this.added,0),e.set(this.inProgress.content,this.added.length),this.pieces[this.inProgress.index]={offset:this.added.length,length:this.inProgress.length,source:"added"},this.added=e,this.inProgress=null,this.chunk=""},e.prototype.render=function(e,t){for(var i,r=new Uint8Array(t),s={added:[]},o=0,a=0,l=0,h=this.pieces.entries();l<h.length;l++){var c=h[l],u=c[0];if((o+=(p=c[1]).length)>=e){i=p.length-o+e,a=u;break}}(n(this.pieces[a])||"added"===this.pieces[a].source)&&s.added.push([e-i,e-i+this.pieces[a].length]);var d=this.getPieceBuffer(this.pieces[a]).subarray(i,i+t);for(o=d.length,r.set(d,0),u=a+1;u<this.pieces.length;u++){var p;if(o+=(p=this.pieces[u]).length,(n(p)||"added"===p.source)&&s.added.push([e+o-p.length,e+o]),o>=t){r.set(this.getPieceBuffer(p).subarray(0,p.length-o+t),o-p.length);break}r.set(this.getPieceBuffer(p),o-p.length)}return o!==t?{out:r.subarray(0,o),meta:s}:{out:r,meta:s}},Object.defineProperty(e.prototype,"length",{get:function(){for(var e=0,t=0,n=this.pieces;t<n.length;t++)e+=n[t].length;return e},enumerable:!0,configurable:!0}),e.prototype.rollback=function(){},e.prototype.save=function(){return this.render(0,this.length).out},e.prototype.getPieceBuffer=function(e){return n(e)?new Uint8Array(e.content):"origin"===e.source?this.original.subarray(e.offset,e.offset+e.length):this.added.subarray(e.offset,e.offset+e.length)},e}(),r=function(){function e(){var e=this;this.file=new Uint8Array(32),this.lineNumber=0,this.maxLines=30,this.bytesPerLine=16,this.bytesUntilForcedLine=0,this.asciiInline=!1,this.bytesPerGroup=4,this.mode="edit",this.editType="overwrite",this.regionDepth=2,this.regions=[],this.scroll=function(t){t.preventDefault();var n=Number.isInteger(t.deltaY)?Math.ceil(t.deltaY/2):Math.ceil(t.deltaY/100);-0===n&&(n-=1),e.lineNumber+n<0?e.lineNumber=0:e.lineNumber+n>Math.floor(e.editController.length/e.bytesPerLine)-1?e.lineNumber=Math.floor(e.editController.length/e.bytesPerLine)-1:e.lineNumber+=n}}return e.prototype.componentWillLoad=function(){this.editController=new i(this)},e.prototype.acceptFile=function(e){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(r){return console.log(e),this.fileMetadata=e,(t=new FileReader).readAsArrayBuffer(e),t.onload=function(e){n.file=new Uint8Array(e.target.result),n.editController=new i(n)},[2]})})},e.prototype.saveFile=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return null==this.file?[2]:[2,this.editController.save()]})})},e.prototype.setLineNumber=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.lineNumber=e,this.hexLineChanged.emit(e),[2]})})},e.prototype.setCursorPosition=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.cursor=e,[2]})})},e.prototype.setSelection=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.selection=Object.assign({},this.selection,e),[2]})})},e.prototype.buildHexView=function(){for(var e=this,n=this,i=n.lineNumber,r=n.maxLines,s=n.bytesPerLine,o=n.bytesPerGroup,a=n.asciiInline,l=i*s,h=this.editController.render(l,r*s),c=h.out,u=h.meta.added,d=[],p=0;p<r;p++)d.push(c.subarray(p*s,(p+1)*s));for(var f=[],g=[],b=0,y=d.entries();b<y.length;b++){var m=y[b],v=m[1],P=l+m[0]*s,w=[],x=[],L="•",_=!1;if(0===v.length)break;for(var C=0,S=v.values().slice().entries();C<S.length;C++){var E,k=S[C],M=k[0],B=k[1];L=/\w|[!@#$%^&*()_+=\]\\:;"'>.<,\/?]/.test(String.fromCharCode(B))?String.fromCharCode(B):"•",E=a&&/\w/.test(L)?"."+L:B.toString(16).toUpperCase().padStart(2,"0");var N=[];M%o==o-1&&N.push("padByte"),this.cursor===P+M&&(N.push("cursor"),_=!0),this.selection&&this.selection.start<=P+M&&P+M<=this.selection.end&&N.push("selected");for(var U=0,A=u;U<A.length;U++){var O=A[U];if(O[0]<=P+M&&P+M<O[1]){N.push("added");break}}w.push(t("span",{class:N.join(" ")},L)),x.push(t("span",{class:N.join(" ")},E))}f.push(t("div",{class:"hexLine"+(_?" selected":"")},x)),g.push(t("div",{class:"charLine"+(_?" selected":"")},w))}for(;f.length<r;)f.push(t("div",{class:"hexLine",style:{pointerEvents:"none"}},t("span",null,"-"))),g.push(t("div",{class:"charLine",style:{pointerEvents:"none"}},t("span",null,"-")));var D=[];for(p=0;p<r;p++)D.push(t("div",{class:"lineLabel",style:{pointerEvents:"none"}},"0x"+(l+p*s).toString(16).padStart(8," ")));for(var F=document.getElementById("MEASURE").clientWidth,I=document.getElementById("MEASURE").clientHeight,j=[],R=function(n,r,s){if(void 0===r&&(r=0),(0!==r||!(n.end<l||n.start>l+e.maxLines*e.bytesPerLine))&&r!==e.regionDepth)if(n.subRegions&&r+1!==e.regionDepth)for(var o=0,a=n.subRegions.entries();o<a.length;o++){var h=a[o];R(h[1],r+1,h[0])}else{var c=n.start%e.bytesPerLine,u=n.end%e.bytesPerLine,d=Math.floor((n.end-n.start+c)/e.bytesPerLine);if(n.end<l||n.start>l+e.maxLines*e.bytesPerLine)return;var p=Math.floor(n.start/e.bytesPerLine)-i;j.push(t("polygon",{onmousemove:"\n            if (window.canUpdateMousemove === undefined) {\n              window.canUpdateMousemove = true;\n            }\n            if (window.canUpdateMousemove) {\n              window.canUpdateMousemove = false;\n              document.documentElement.style.setProperty('--mouse-x', event.clientX);\n              document.documentElement.style.setProperty('--mouse-y', event.clientY);\n              document.getElementById('tooltip').setAttribute('active', true)\n              document.getElementById('tooltip').setAttribute('complex', '"+JSON.stringify(Object.assign({},n,{subRegions:n.subRegions?n.subRegions.map(function(e){return e.name}):null}))+"');\n\n              setTimeout(() => {window.canUpdateMousemove = true}, 50);\n            }\n          ",onmouseleave:"document.getElementById('tooltip').setAttribute('active', false)",class:"region",points:"\n            0,"+(1+p)*I+"\n            "+c*F+","+(1+p)*I+"\n            "+c*F+","+p*I+"\n            "+e.bytesPerLine*F+","+p*I+"\n            "+e.bytesPerLine*F+","+(d+p)*I+"\n            "+u*F+","+(d+p)*I+"\n            "+u*F+","+(d+p+1)*I+"\n            0,"+(d+1+p)*I+"\n            ",fill:n.color||{0:["#77F","#BBF"],1:["#F77","#FBB"],2:["#7D7","#BDB"]}[r%3][s%2],stroke:"none"}))}},H=0,V=this.regions.entries();H<V.length;H++){var T=V[H];R(T[1],0,p=T[0])}return{lineViews:f,charViews:g,lineLabels:D,regionMarkers:t("svg",{viewbox:"0 0 "+this.bytesPerLine*F+" "+this.maxLines*I,width:""+this.bytesPerLine*F,height:""+this.maxLines*I},j)}},e.prototype.edit=function(e){if("readonly"!==this.editType){var t=this.editController;t.inProgress||t.initEdit(this.cursor,this.editType),t.buildEdit(e)}},e.prototype.showHex=function(){var e=this,n=this.buildHexView(),i=n.lineViews,r=n.charViews,s=n.lineLabels,o=n.regionMarkers;return t("div",{class:"hex",onMouseEnter:function(t){return e._toggleScrollListener(t)},onMouseLeave:function(t){return e._toggleScrollListener(t)},onMouseDown:function(t){return e.beginSelection(t)},onMouseUp:function(t){return e.endSelection(t)},tabindex:"0",onKeyDown:function(t){return e.edit(t)}},t("div",{id:"MEASURE",style:{position:"absolute",visibility:"hidden",padding:"0 5px"}},"AB"),t("div",{class:"lineLabels"},s),t("div",{class:"hexView"},t("div",{class:"highlight",style:{position:"absolute",top:"0",display:"noregion"===this.mode?"none":"block",zIndex:"region"===this.mode?"3":"0"}},o),t("div",{class:"main"},i)),t("div",{class:"asciiView"},r))},e.prototype.beginSelection=function(e){this.tempSelection=this.lineNumber*this.bytesPerLine+e.composedPath()[2].children.slice().indexOf(e.composedPath()[1])*this.bytesPerLine+e.composedPath()[1].children.slice().indexOf(e.composedPath()[0])},e.prototype.endSelection=function(e){var t=this.lineNumber*this.bytesPerLine+e.composedPath()[2].children.slice().indexOf(e.composedPath()[1])*this.bytesPerLine+e.composedPath()[1].children.slice().indexOf(e.composedPath()[0]);this.selection=this.tempSelection>t?{start:t,end:this.tempSelection}:{start:this.tempSelection,end:t},this.tempSelection=null,this.cursor=t,this.hexCursorChanged.emit(this.cursor),this.hexSelectionChanged.emit(this.selection),this.editController.inProgress&&(this.editController.commit(),this.hexDataChanged.emit())},e.prototype.render=function(){return t("div",{class:"container"},this.showHex())},e.prototype._toggleScrollListener=function(e){"mouseenter"===e.type?e.target.addEventListener("wheel",this.scroll,{passive:!1}):e.target.removeEventListener("wheel",this.scroll,!1)},Object.defineProperty(e,"is",{get:function(){return"hex-editor"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{acceptFile:{method:!0},asciiInline:{type:Boolean,attr:"ascii-inline"},bytesPerGroup:{type:Number,attr:"bytes-per-group"},bytesPerLine:{type:Number,attr:"bytes-per-line"},bytesUntilForcedLine:{type:Number,attr:"bytes-until-forced-line"},cursor:{state:!0},editType:{type:String,attr:"edit-type"},file:{state:!0},fileMetadata:{state:!0},lineNumber:{state:!0},maxLines:{type:Number,attr:"max-lines"},mode:{type:String,attr:"mode"},regionDepth:{type:Number,attr:"region-depth"},regions:{type:"Any",attr:"regions"},saveFile:{method:!0},selection:{state:!0},setCursorPosition:{method:!0},setLineNumber:{method:!0},setSelection:{method:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"events",{get:function(){return[{name:"hexLineChanged",method:"hexLineChanged",bubbles:!0,cancelable:!0,composed:!0},{name:"hexCursorChanged",method:"hexCursorChanged",bubbles:!0,cancelable:!0,composed:!0},{name:"hexSelectionChanged",method:"hexSelectionChanged",bubbles:!0,cancelable:!0,composed:!0},{name:"hexDataChanged",method:"hexDataChanged",bubbles:!0,cancelable:!0,composed:!0}]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return".container{overflow:scroll;position:relative;width:100vw;min-height:100%}.hex{font-family:Sourcecode Pro,Courier,monospace;font-size:15px;height:100%;outline:none}.asciiView,.hexView,.lineLabels{display:inline-block;padding:0 10px;white-space:pre;position:relative}.charLine span,.hexLine span{position:relative;height:17px;display:inline-block}.lineLabel{height:17px}.hexLine span{position:relative;padding:0 5px}.hexLine span:not(:last-child).padByte:after{background-color:rgba(0,0,0,.4);position:absolute;width:2px;height:100%;left:calc(100% - 1px);content:\"\"}.hexLine span{cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.charLine span.selected,.hexLine span.selected{background-color:rgba(136,136,255,.5)}.charLine span.cursor,.hexLine span.cursor{background-color:#008;color:#fff}.charLine span.added,.hexLine span.added{color:red}.hexLine span:hover{background-color:#000;color:#fff}.charLine:nth-child(2n-1),.hexLine:nth-child(2n-1),.lineLabel:nth-child(2n-1){background-color:#eff}.charLine.selected,.hexLine.selected{background-color:#ffa}.region{opacity:.8}.region:hover{opacity:.3;position:relative}"},enumerable:!0,configurable:!0}),e}();e.HexEditor=r,Object.defineProperty(e,"__esModule",{value:!0})});