HexEditor.loadBundle("em9ux4sm",["exports"],function(e){var t=window.HexEditor.h;function i(e){return!(!e||!e.content)}var n=function(){function e(e){this.parent=e,this.added=new Uint8Array,this.pieces=[],this.chunk="",this.original=e.file,this.pieces=[{offset:0,length:this.original.length,source:"origin"}]}return e.prototype.initEdit=function(e,t){var i,n;if(this.inProgress={offset:e,type:t,content:[],index:-1,get length(){return this.content.length}},"insert"===t){for(var s=0,r=void 0,o=void 0,l=void 0,a=0,h=this.pieces.entries();a<h.length;a++){var d=h[a],c=d[0];if((s+=(f=d[1]).length)>=e){r=f.length-s+e,o=c,l=f;break}}this.inProgress.index=o+1,(i=this.pieces).splice.apply(i,[o,1].concat([{offset:l.offset,length:r,source:l.source},this.inProgress,{offset:l.offset+r,length:l.length-r,source:l.source}]))}else{s=0,r=void 0,o=void 0,l=void 0;for(var u=0,p=this.pieces.entries();u<p.length;u++){var f,g=p[u];if(c=g[0],(s+=(f=g[1]).length)>=e){r=f.length-s+e,o=c,l=f;break}}this.inProgress.index=o+1,(n=this.pieces).splice.apply(n,[o,1].concat([{offset:l.offset,length:r,source:l.source},this.inProgress,{offset:l.offset+r,length:l.length-r,source:l.source}]))}},e.prototype.buildEdit=function(e){if(/^[a-fA-F0-9]$/.test(e.key)&&(this.chunk+=e.key,2===this.chunk.length)){this.inProgress.content.push(parseInt(this.chunk,16)),this.chunk="",this.parent.cursor+=1;var t=this.pieces.indexOf(this.inProgress);if("overwrite"===this.inProgress.type&&t!==this.pieces.length-1){var i=this.pieces[t+1];i.offset+=1,i.length-=1,0===i.length&&this.pieces.splice(t+1,1)}}},e.prototype.commit=function(){var e=new Uint8Array(this.added.length+this.inProgress.content.length);e.set(this.added,0),e.set(this.inProgress.content,this.added.length),this.pieces[this.inProgress.index]={offset:this.added.length,length:this.inProgress.length,source:"added"},console.log(this.pieces),this.added=e,this.inProgress=null,this.chunk=""},e.prototype.render=function(e,t){for(var n,s=new Uint8Array(t),r={added:[]},o=0,l=0,a=0,h=this.pieces.entries();a<h.length;a++){var d=h[a],c=d[0];if((o+=(p=d[1]).length)>=e){n=p.length-o+e,l=c;break}}(i(this.pieces[l])||"added"===this.pieces[l].source)&&r.added.push([e-n,e-n+this.pieces[l].length]);var u=this.getPieceBuffer(this.pieces[l]).subarray(n,n+t);for(o=u.length,s.set(u,0),c=l+1;c<this.pieces.length;c++){var p;if(o+=(p=this.pieces[c]).length,(i(p)||"added"===p.source)&&r.added.push([e+o-p.length,e+o]),o>=t){s.set(this.getPieceBuffer(p).subarray(0,p.length-o+t),o-p.length);break}s.set(this.getPieceBuffer(p),o-p.length)}return o!==t?{out:s.subarray(0,o),meta:r}:{out:s,meta:r}},Object.defineProperty(e.prototype,"length",{get:function(){for(var e=0,t=0,i=this.pieces;t<i.length;t++)e+=i[t].length;return e},enumerable:!0,configurable:!0}),e.prototype.rollback=function(){},e.prototype.save=function(){},e.prototype.getPieceBuffer=function(e){return i(e)?new Uint8Array(e.content):"origin"===e.source?this.original.subarray(e.offset,e.offset+e.length):this.added.subarray(e.offset,e.offset+e.length)},e}(),s=function(){function e(){var e=this;this.maxLines=30,this.bytesPerLine=16,this.bytesUntilForcedLine=0,this.asciiInline=!1,this.bytesPerGroup=4,this.mode="region",this.editType="overwrite",this.regionDepth=2,this.regions=[{start:0,end:64,name:"start",description:"the start of the file. Hopefully this works",subRegions:[{start:0,end:32,subRegions:[{start:0,end:8},{start:16,end:22}]},{start:32,end:64}]},{start:64,end:105},{start:617,end:873},{start:873,end:1024}],this.lineNumber=0,this.scroll=function(t){t.preventDefault();var i=Math.ceil(t.deltaY/2);-0===i&&(i-=1),e.lineNumber+i<0?e.lineNumber=0:e.lineNumber+i>Math.floor(e.editController.length/e.bytesPerLine)-1?e.lineNumber=Math.floor(e.editController.length/e.bytesPerLine)-1:e.lineNumber+=i}}return e.prototype.acceptFile=function(e){var t=this,i=e.target;this.fileMetadata=i.files[0];var s=new FileReader;s.readAsArrayBuffer(i.files[0]),s.onload=function(e){t.file=new Uint8Array(e.target.result),t.editController=new n(t)}},e.prototype.showSelector=function(){var e=this;return t("div",{class:"select"},t("label",{htmlFor:"file-uploader"},"select a file to upload: "),t("input",{type:"file",id:"file-uploader",onChange:function(t){return e.acceptFile(t)}}))},e.prototype.showLoading=function(){return t("div",{class:"loading"},t("div",{id:"MEASURE",class:"hex",style:{position:"absolute",visibility:"hidden",padding:"0 5px"}},"AB"),t("p",null,"loading..."))},e.prototype.buildHexView=function(){for(var e=this,i=this,n=i.lineNumber,s=i.maxLines,r=i.bytesPerLine,o=i.bytesPerGroup,l=i.asciiInline,a=n*r,h=this.editController.render(a,s*r),d=h.out,c=h.meta.added,u=[],p=0;p<s;p++)u.push(d.subarray(p*r,(p+1)*r));for(var f=[],g=[],y=0,b=u.entries();y<b.length;y++){var v=b[y],m=v[1],P=a+v[0]*r,w=[],L=[],x="•",S=!1;if(0===m.length)break;for(var E=0,M=m.values().slice().entries();E<M.length;E++){var B,k=M[E],A=k[0],U=k[1];x=/\w|[!@#$%^&*()_+=\]\\:;"'>.<,\/?]/.test(String.fromCharCode(U))?String.fromCharCode(U):"•",B=l&&/\w/.test(x)?"."+x:U.toString(16).toUpperCase().padStart(2,"0");var N=[];A%o==o-1&&N.push("padByte"),this.cursor===P+A&&(N.push("cursor"),S=!0),this.selection&&this.selection.start<=P+A&&P+A<=this.selection.end&&N.push("selected");for(var C=0,O=c;C<O.length;C++){var R=O[C];if(R[0]<=P+A&&P+A<R[1]){N.push("added");break}}w.push(t("span",{class:N.join(" ")},x)),L.push(t("span",{class:N.join(" ")},B))}f.push(t("div",{class:"hexLine"+(S?" selected":"")},L)),g.push(t("div",{class:"charLine"+(S?" selected":"")},w))}for(;f.length<s;)f.push(t("div",{class:"hexLine"},t("span",null,"-"))),g.push(t("div",{class:"charLine"},t("span",null,"-")));var F=[];for(p=0;p<s;p++)F.push(t("div",{class:"lineLabel"},"0x"+(a+p*r).toString(16).padStart(8," ")));for(var I=document.getElementById("MEASURE").clientWidth,D=document.getElementById("MEASURE").clientHeight,H=[],j=function(i,s,r){if(void 0===s&&(s=0),(0!==s||!(i.end<a||i.start>a+e.maxLines*e.bytesPerLine))&&s!==e.regionDepth)if(i.subRegions&&s+1!==e.regionDepth)for(var o=0,l=i.subRegions.entries();o<l.length;o++){var h=l[o];j(h[1],s+1,h[0])}else{var d=i.start%e.bytesPerLine,c=i.end%e.bytesPerLine,u=Math.floor((i.end-i.start+d)/e.bytesPerLine);if(i.end<a||i.start>a+e.maxLines*e.bytesPerLine)return;var p=Math.floor(i.start/e.bytesPerLine)-n;H.push(t("polygon",{onmousemove:"\n            if (window.canUpdateMousemove === undefined) {\n              window.canUpdateMousemove = true;\n            }\n            if (window.canUpdateMousemove) {\n              window.canUpdateMousemove = false;\n              document.documentElement.style.setProperty('--mouse-x', event.clientX);\n              document.documentElement.style.setProperty('--mouse-y', event.clientY);\n              document.getElementById('tooltip').setAttribute('active', true)\n              document.getElementById('tooltip').setAttribute('complex', '"+JSON.stringify(Object.assign({},i,{subRegions:i.subRegions?i.subRegions.map(function(e){return e.name}):null}))+"');\n\n              setTimeout(() => {window.canUpdateMousemove = true}, 50);\n            }\n          ",onmouseleave:"document.getElementById('tooltip').setAttribute('active', false)",class:"region",points:"\n            0,"+(1+p)*D+"\n            "+d*I+","+(1+p)*D+"\n            "+d*I+","+p*D+"\n            "+e.bytesPerLine*I+","+p*D+"\n            "+e.bytesPerLine*I+","+(u+p)*D+"\n            "+c*I+","+(u+p)*D+"\n            "+c*I+","+(u+p+1)*D+"\n            0,"+(u+1+p)*D+"\n            ",fill:i.color||{0:["#77F","#BBF"],1:["#F77","#FBB"],2:["#7D7","#BDB"]}[s%3][r%2],stroke:"none"}))}},V=0,_=this.regions.entries();V<_.length;V++){var T=_[V];j(T[1],0,p=T[0])}return{lineViews:f,charViews:g,lineLabels:F,regionMarkers:t("svg",{viewbox:"0 0 "+this.bytesPerLine*I+" "+this.maxLines*D,style:{width:this.bytesPerLine*I,height:this.maxLines*D}},H)}},e.prototype.edit=function(e){if("readonly"!==this.editType){var t=this.editController;t.inProgress||t.initEdit(this.cursor,this.editType),t.buildEdit(e)}},e.prototype.showHex=function(){var e=this,i=this.buildHexView(),n=i.lineViews,s=i.charViews,r=i.lineLabels,o=i.regionMarkers;return t("div",{class:"hex",onMouseEnter:function(t){return e._toggleScrollListener(t)},onMouseLeave:function(t){return e._toggleScrollListener(t)},onMouseDown:function(t){return e.beginSelection(t)},onMouseUp:function(t){return e.endSelection(t)},tabindex:"0",onKeyDown:function(t){return e.edit(t)}},t("div",{id:"MEASURE",style:{position:"absolute",visibility:"hidden",padding:"0 5px"}},"AB"),t("div",{class:"lineLabels"},r),t("div",{class:"hexView"},t("div",{class:"highlight",style:{position:"absolute",top:"0",display:"noregion"===this.mode?"none":"block",zIndex:"region"===this.mode?"3":"0"}},o),t("div",{class:"main"},n)),t("div",{class:"asciiView"},s))},e.prototype.beginSelection=function(e){this.tempSelection=this.lineNumber*this.bytesPerLine+e.path[2].children.slice().indexOf(e.path[1])*this.bytesPerLine+e.path[1].children.slice().indexOf(e.path[0])},e.prototype.endSelection=function(e){var t=this.lineNumber*this.bytesPerLine+e.path[2].children.slice().indexOf(e.path[1])*this.bytesPerLine+e.path[1].children.slice().indexOf(e.path[0]);this.selection=this.tempSelection>t?{start:t,end:this.tempSelection}:{start:this.tempSelection,end:t},this.tempSelection=null,this.cursor=t,this.editController.inProgress&&this.editController.commit()},e.prototype.render=function(){return t("div",{class:"container"},this.fileMetadata?this.file?this.showHex():this.showLoading():this.showSelector())},e.prototype._toggleScrollListener=function(e){"mouseenter"===e.type?e.target.addEventListener("wheel",this.scroll,{passive:!1}):e.target.removeEventListener("wheel",this.scroll,!1)},Object.defineProperty(e,"is",{get:function(){return"hex-editor"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{asciiInline:{type:Boolean,attr:"asciiinline"},bytesPerGroup:{type:Number,attr:"bytespergroup"},bytesPerLine:{type:Number,attr:"bytesperline"},bytesUntilForcedLine:{type:Number,attr:"bytes-until-forced-line"},cursor:{state:!0},editType:{type:String,attr:"edittype"},file:{state:!0},fileMetadata:{state:!0},lineNumber:{state:!0},maxLines:{type:Number,attr:"maxlines"},mode:{type:String,attr:"mode"},regionDepth:{type:Number,attr:"regiondepth"},regions:{type:"Any",attr:"regions"},selection:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return".container{overflow:scroll;position:relative;width:100vw;min-height:100%}.hex{font-family:Sourcecode Pro,Courier,monospace;font-size:15px}.asciiView,.hexView,.lineLabels{display:inline-block;padding:0 10px;white-space:pre;position:relative}.charLine span,.hexLine span{position:relative}.hexLine span{padding:0 5px}.hexLine span:not(:last-child).padByte:after{background-color:rgba(0,0,0,.4);position:absolute;width:2px;height:100%;left:calc(100% - 1px);content:\"\"}.hexLine span{cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.charLine span.selected,.hexLine span.selected{background-color:rgba(136,136,255,.5)}.charLine span.cursor,.hexLine span.cursor{background-color:#008;color:#fff}.charLine span.added,.hexLine span.added{color:red}.hexLine span:hover{background-color:#000;color:#fff}.charLine:nth-child(2n-1),.hexLine:nth-child(2n-1),.lineLabel:nth-child(2n-1){background-color:#eff}.charLine.selected,.hexLine.selected{background-color:#ffa}.region{opacity:.8}.region:hover{opacity:.3;position:relative}"},enumerable:!0,configurable:!0}),e}();e.HexEditor=s,Object.defineProperty(e,"__esModule",{value:!0})});