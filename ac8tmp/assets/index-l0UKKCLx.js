var lt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ct=lt((exports,module)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const PUBLIC_VERSION="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(PUBLIC_VERSION);const EACH_ITEM_REACTIVE=1,EACH_INDEX_REACTIVE=2,EACH_IS_CONTROLLED=4,EACH_IS_ANIMATED=8,EACH_ITEM_IMMUTABLE=16,PROPS_IS_IMMUTABLE=1,PROPS_IS_UPDATED=4,PROPS_IS_BINDABLE=8,PROPS_IS_LAZY_INITIAL=16,TEMPLATE_FRAGMENT=1,TEMPLATE_USE_IMPORT_NODE=2,UNINITIALIZED=Symbol(),NAMESPACE_HTML="http://www.w3.org/1999/xhtml",DEV=!1;var is_array=Array.isArray,index_of=Array.prototype.indexOf,array_from=Array.from,define_property=Object.defineProperty,get_descriptor=Object.getOwnPropertyDescriptor,get_descriptors=Object.getOwnPropertyDescriptors,object_prototype=Object.prototype,array_prototype=Array.prototype,get_prototype_of=Object.getPrototypeOf,is_extensible=Object.isExtensible;const noop=()=>{};function run_all(t){for(var e=0;e<t.length;e++)t[e]()}function deferred(){var t,e,r=new Promise((i,n)=>{t=i,e=n});return{promise:r,resolve:t,reject:e}}const DERIVED=2,EFFECT=4,RENDER_EFFECT=8,BLOCK_EFFECT=16,BRANCH_EFFECT=32,ROOT_EFFECT=64,BOUNDARY_EFFECT=128,UNOWNED=256,DISCONNECTED=512,CLEAN=1024,DIRTY=2048,MAYBE_DIRTY=4096,INERT=8192,DESTROYED=16384,EFFECT_RAN=32768,EFFECT_TRANSPARENT=65536,INSPECT_EFFECT=1<<17,HEAD_EFFECT=1<<18,EFFECT_PRESERVED=1<<19,USER_EFFECT=1<<20,REACTION_IS_UPDATING=1<<21,ASYNC=1<<22,ERROR_VALUE=1<<23,STATE_SYMBOL=Symbol("$state"),LEGACY_PROPS=Symbol("legacy props"),STALE_REACTION=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function await_outside_boundary(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function lifecycle_outside_component(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function async_derived_orphan(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function effect_in_teardown(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function effect_in_unowned_derived(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function effect_orphan(t){throw new Error("https://svelte.dev/e/effect_orphan")}function effect_update_depth_exceeded(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function props_invalid_value(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function state_descriptors_fixed(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function state_prototype_fixed(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function state_unsafe_mutation(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let hydrating=!1;function equals(t){return t===this.v}function safe_not_equal(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function not_equal(t,e){return t!==e}function safe_equals(t){return!safe_not_equal(t,this.v)}let tracing_mode_flag=!1,component_context=null;function set_component_context(t){component_context=t}function push(t,e=!1,r){component_context={p:component_context,c:null,e:null,s:t,x:null,l:null}}function pop(t){var e=component_context,r=e.e;if(r!==null){e.e=null;for(var i of r)create_user_effect(i)}return component_context=e.p,{}}function is_runes(){return!0}const adjustments=new WeakMap;function handle_error(t){var e=active_effect;if(e===null)return active_reaction.f|=ERROR_VALUE,t;if((e.f&EFFECT_RAN)===0){if((e.f&BOUNDARY_EFFECT)===0)throw!e.parent&&t instanceof Error&&apply_adjustments(t),t;e.b.error(t)}else invoke_error_boundary(t,e)}function invoke_error_boundary(t,e){for(;e!==null;){if((e.f&BOUNDARY_EFFECT)!==0)try{e.b.error(t);return}catch(r){t=r}e=e.parent}throw t instanceof Error&&apply_adjustments(t),t}function apply_adjustments(t){const e=adjustments.get(t);e&&(define_property(t,"message",{value:e.message}),define_property(t,"stack",{value:e.stack}))}let micro_tasks=[],idle_tasks=[];function run_micro_tasks(){var t=micro_tasks;micro_tasks=[],run_all(t)}function run_idle_tasks(){var t=idle_tasks;idle_tasks=[],run_all(t)}function queue_micro_task(t){micro_tasks.length===0&&queueMicrotask(run_micro_tasks),micro_tasks.push(t)}function flush_tasks(){micro_tasks.length>0&&run_micro_tasks(),idle_tasks.length>0&&run_idle_tasks()}function get_pending_boundary(){for(var t=active_effect.b;t!==null&&!t.has_pending_snippet();)t=t.parent;return t===null&&await_outside_boundary(),t}function derived$1(t){var e=DERIVED|DIRTY,r=active_reaction!==null&&(active_reaction.f&DERIVED)!==0?active_reaction:null;return active_effect===null||r!==null&&(r.f&UNOWNED)!==0?e|=UNOWNED:active_effect.f|=EFFECT_PRESERVED,{ctx:component_context,deps:null,effects:null,equals,f:e,fn:t,reactions:null,rv:0,v:UNINITIALIZED,wv:0,parent:r??active_effect,ac:null}}function async_derived(t,e){let r=active_effect;r===null&&async_derived_orphan();var i=r.b,n=void 0,s=source(UNINITIALIZED),o=null,a=!active_reaction;return async_effect(()=>{try{var l=t()}catch(f){l=Promise.reject(f)}var c=()=>l;n=o?.then(c,c)??Promise.resolve(l),o=n;var u=current_batch,d=i.pending;a&&(i.update_pending_count(1),d||u.increment());const h=(f,g=void 0)=>{o=null,d||u.activate(),g?g!==STALE_REACTION&&(s.f|=ERROR_VALUE,internal_set(s,g)):((s.f&ERROR_VALUE)!==0&&(s.f^=ERROR_VALUE),internal_set(s,f)),a&&(i.update_pending_count(-1),d||u.decrement()),unset_context()};if(n.then(h,f=>h(null,f||"unknown")),u)return()=>{queueMicrotask(()=>u.neuter())}}),new Promise(l=>{function c(u){function d(){u===n?l(s):c(n)}u.then(d,d)}c(n)})}function user_derived(t){const e=derived$1(t);return push_reaction_value(e),e}function derived_safe_equal(t){const e=derived$1(t);return e.equals=safe_equals,e}function destroy_derived_effects(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)destroy_effect(e[r])}}function get_derived_parent_effect(t){for(var e=t.parent;e!==null;){if((e.f&DERIVED)===0)return e;e=e.parent}return null}function execute_derived(t){var e,r=active_effect;set_active_effect(get_derived_parent_effect(t));try{destroy_derived_effects(t),e=update_reaction(t)}finally{set_active_effect(r)}return e}function update_derived(t){var e=execute_derived(t);if(t.equals(e)||(t.v=e,t.wv=increment_write_version()),!is_destroying_effect)if(batch_deriveds!==null)batch_deriveds.set(t,t.v);else{var r=(skip_reaction||(t.f&UNOWNED)!==0)&&t.deps!==null?MAYBE_DIRTY:CLEAN;set_signal_status(t,r)}}function flatten(t,e,r){const i=derived$1;if(e.length===0){r(t.map(i));return}var n=current_batch,s=active_effect,o=capture(),a=get_pending_boundary();Promise.all(e.map(l=>async_derived(l))).then(l=>{n?.activate(),o();try{r([...t.map(i),...l])}catch(c){(s.f&DESTROYED)===0&&invoke_error_boundary(c,s)}n?.deactivate(),unset_context()}).catch(l=>{a.error(l)})}function capture(){var t=active_effect,e=active_reaction,r=component_context;return function(){set_active_effect(t),set_active_reaction(e),set_component_context(r)}}function unset_context(){set_active_effect(null),set_active_reaction(null),set_component_context(null)}const batches=new Set;let current_batch=null,batch_deriveds=null,effect_pending_updates=new Set,tasks=[];function dequeue(){const t=tasks.shift();tasks.length>0&&queueMicrotask(dequeue),t()}let queued_root_effects=[],last_scheduled_effect=null,is_flushing=!1,is_flushing_sync=!1;class Batch{current=new Map;#n=new Map;#s=new Set;#e=0;#c=null;#u=!1;#r=[];#o=[];#i=[];#t=[];#a=[];#d=[];#h=[];skipped_effects=new Set;process(e){queued_root_effects=[];var r=null;if(batches.size>1){r=new Map,batch_deriveds=new Map;for(const[s,o]of this.current)r.set(s,{v:s.v,wv:s.wv}),s.v=o;for(const s of batches)if(s!==this)for(const[o,a]of s.#n)r.has(o)||(r.set(o,{v:o.v,wv:o.wv}),o.v=a)}for(const s of e)this.#g(s);if(this.#r.length===0&&this.#e===0){this.#f();var i=this.#i,n=this.#t;this.#i=[],this.#t=[],this.#a=[],current_batch=null,flush_queued_effects(i),flush_queued_effects(n),current_batch===null?current_batch=this:batches.delete(this),this.#c?.resolve()}else this.#l(this.#i),this.#l(this.#t),this.#l(this.#a);if(r){for(const[s,{v:o,wv:a}]of r)s.wv<=a&&(s.v=o);batch_deriveds=null}for(const s of this.#r)update_effect(s);for(const s of this.#o)update_effect(s);this.#r=[],this.#o=[]}#g(e){e.f^=CLEAN;for(var r=e.first;r!==null;){var i=r.f,n=(i&(BRANCH_EFFECT|ROOT_EFFECT))!==0,s=n&&(i&CLEAN)!==0,o=s||(i&INERT)!==0||this.skipped_effects.has(r);if(!o&&r.fn!==null){if(n)r.f^=CLEAN;else if((i&CLEAN)===0)if((i&EFFECT)!==0)this.#t.push(r);else if((i&ASYNC)!==0){var a=r.b?.pending?this.#o:this.#r;a.push(r)}else is_dirty(r)&&((r.f&BLOCK_EFFECT)!==0&&this.#a.push(r),update_effect(r));var l=r.first;if(l!==null){r=l;continue}}var c=r.parent;for(r=r.next;r===null&&c!==null;)r=c.next,c=c.parent}}#l(e){for(const r of e)((r.f&DIRTY)!==0?this.#d:this.#h).push(r),set_signal_status(r,CLEAN);e.length=0}capture(e,r){this.#n.has(e)||this.#n.set(e,r),this.current.set(e,e.v)}activate(){current_batch=this}deactivate(){current_batch=null;for(const e of effect_pending_updates)if(effect_pending_updates.delete(e),e(),current_batch!==null)break}neuter(){this.#u=!0}flush(){queued_root_effects.length>0?flush_effects():this.#f(),current_batch===this&&(this.#e===0&&batches.delete(this),this.deactivate())}#f(){if(!this.#u)for(const e of this.#s)e();this.#s.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#d)set_signal_status(e,DIRTY),schedule_effect(e);for(const e of this.#h)set_signal_status(e,MAYBE_DIRTY),schedule_effect(e);this.#i=[],this.#t=[],this.flush()}else this.deactivate()}add_callback(e){this.#s.add(e)}settled(){return(this.#c??=deferred()).promise}static ensure(){if(current_batch===null){const e=current_batch=new Batch;batches.add(current_batch),is_flushing_sync||Batch.enqueue(()=>{current_batch===e&&e.flush()})}return current_batch}static enqueue(e){tasks.length===0&&queueMicrotask(dequeue),tasks.unshift(e)}}function flushSync(t){var e=is_flushing_sync;is_flushing_sync=!0;try{for(var r;;){if(flush_tasks(),queued_root_effects.length===0&&(current_batch?.flush(),queued_root_effects.length===0))return last_scheduled_effect=null,r;flush_effects()}}finally{is_flushing_sync=e}}function flush_effects(){var t=is_updating_effect;is_flushing=!0;try{var e=0;for(set_is_updating_effect(!0);queued_root_effects.length>0;){var r=Batch.ensure();if(e++>1e3){var i,n;infinite_loop_guard()}r.process(queued_root_effects),old_values.clear()}}finally{is_flushing=!1,set_is_updating_effect(t),last_scheduled_effect=null}}function infinite_loop_guard(){try{effect_update_depth_exceeded()}catch(t){invoke_error_boundary(t,last_scheduled_effect)}}function flush_queued_effects(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var i=t[r++];if((i.f&(DESTROYED|INERT))===0&&is_dirty(i)){var n=current_batch?current_batch.current.size:0;if(update_effect(i),i.deps===null&&i.first===null&&i.nodes_start===null&&(i.teardown===null&&i.ac===null?unlink_effect(i):i.fn=null),current_batch!==null&&current_batch.current.size>n&&(i.f&USER_EFFECT)!==0)break}}for(;r<e;)schedule_effect(t[r++])}}function schedule_effect(t){for(var e=last_scheduled_effect=t;e.parent!==null;){e=e.parent;var r=e.f;if(is_flushing&&e===active_effect&&(r&BLOCK_EFFECT)!==0)return;if((r&(ROOT_EFFECT|BRANCH_EFFECT))!==0){if((r&CLEAN)===0)return;e.f^=CLEAN}}queued_root_effects.push(e)}const old_values=new Map;function source(t,e){var r={f:0,v:t,reactions:null,equals,rv:0,wv:0};return r}function state(t,e){const r=source(t);return push_reaction_value(r),r}function mutable_source(t,e=!1,r=!0){const i=source(t);return e||(i.equals=safe_equals),i}function set$2(t,e,r=!1){active_reaction!==null&&(!untracking||(active_reaction.f&INSPECT_EFFECT)!==0)&&is_runes()&&(active_reaction.f&(DERIVED|BLOCK_EFFECT|ASYNC|INSPECT_EFFECT))!==0&&!current_sources?.includes(t)&&state_unsafe_mutation();let i=r?proxy(e):e;return internal_set(t,i)}function internal_set(t,e){if(!t.equals(e)){var r=t.v;is_destroying_effect?old_values.set(t,e):old_values.set(t,r),t.v=e;var i=Batch.ensure();i.capture(t,r),(t.f&DERIVED)!==0&&((t.f&DIRTY)!==0&&execute_derived(t),set_signal_status(t,(t.f&UNOWNED)===0?CLEAN:MAYBE_DIRTY)),t.wv=increment_write_version(),mark_reactions(t,DIRTY),active_effect!==null&&(active_effect.f&CLEAN)!==0&&(active_effect.f&(BRANCH_EFFECT|ROOT_EFFECT))===0&&(untracked_writes===null?set_untracked_writes([t]):untracked_writes.push(t))}return e}function increment(t){set$2(t,t.v+1)}function mark_reactions(t,e){var r=t.reactions;if(r!==null)for(var i=r.length,n=0;n<i;n++){var s=r[n],o=s.f,a=(o&DIRTY)===0;a&&set_signal_status(s,e),(o&DERIVED)!==0?mark_reactions(s,MAYBE_DIRTY):a&&schedule_effect(s)}}function proxy(t){if(typeof t!="object"||t===null||STATE_SYMBOL in t)return t;const e=get_prototype_of(t);if(e!==object_prototype&&e!==array_prototype)return t;var r=new Map,i=is_array(t),n=state(0),s=update_version,o=a=>{if(update_version===s)return a();var l=active_reaction,c=update_version;set_active_reaction(null),set_update_version(s);var u=a();return set_active_reaction(l),set_update_version(c),u};return i&&r.set("length",state(t.length)),new Proxy(t,{defineProperty(a,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&state_descriptors_fixed();var u=r.get(l);return u===void 0?u=o(()=>{var d=state(c.value);return r.set(l,d),d}):set$2(u,c.value,!0),!0},deleteProperty(a,l){var c=r.get(l);if(c===void 0){if(l in a){const u=o(()=>state(UNINITIALIZED));r.set(l,u),increment(n)}}else set$2(c,UNINITIALIZED),increment(n);return!0},get(a,l,c){if(l===STATE_SYMBOL)return t;var u=r.get(l),d=l in a;if(u===void 0&&(!d||get_descriptor(a,l)?.writable)&&(u=o(()=>{var f=proxy(d?a[l]:UNINITIALIZED),g=state(f);return g}),r.set(l,u)),u!==void 0){var h=get$4(u);return h===UNINITIALIZED?void 0:h}return Reflect.get(a,l,c)},getOwnPropertyDescriptor(a,l){var c=Reflect.getOwnPropertyDescriptor(a,l);if(c&&"value"in c){var u=r.get(l);u&&(c.value=get$4(u))}else if(c===void 0){var d=r.get(l),h=d?.v;if(d!==void 0&&h!==UNINITIALIZED)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return c},has(a,l){if(l===STATE_SYMBOL)return!0;var c=r.get(l),u=c!==void 0&&c.v!==UNINITIALIZED||Reflect.has(a,l);if(c!==void 0||active_effect!==null&&(!u||get_descriptor(a,l)?.writable)){c===void 0&&(c=o(()=>{var h=u?proxy(a[l]):UNINITIALIZED,f=state(h);return f}),r.set(l,c));var d=get$4(c);if(d===UNINITIALIZED)return!1}return u},set(a,l,c,u){var d=r.get(l),h=l in a;if(i&&l==="length")for(var f=c;f<d.v;f+=1){var g=r.get(f+"");g!==void 0?set$2(g,UNINITIALIZED):f in a&&(g=o(()=>state(UNINITIALIZED)),r.set(f+"",g))}if(d===void 0)(!h||get_descriptor(a,l)?.writable)&&(d=o(()=>state(void 0)),set$2(d,proxy(c)),r.set(l,d));else{h=d.v!==UNINITIALIZED;var m=o(()=>proxy(c));set$2(d,m)}var C=Reflect.getOwnPropertyDescriptor(a,l);if(C?.set&&C.set.call(u,c),!h){if(i&&typeof l=="string"){var y=r.get("length"),v=Number(l);Number.isInteger(v)&&v>=y.v&&set$2(y,v+1)}increment(n)}return!0},ownKeys(a){get$4(n);var l=Reflect.ownKeys(a).filter(d=>{var h=r.get(d);return h===void 0||h.v!==UNINITIALIZED});for(var[c,u]of r)u.v!==UNINITIALIZED&&!(c in a)&&l.push(c);return l},setPrototypeOf(){state_prototype_fixed()}})}var $window,is_firefox,first_child_getter,next_sibling_getter;function init_operations(){if($window===void 0){$window=window,is_firefox=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;first_child_getter=get_descriptor(e,"firstChild").get,next_sibling_getter=get_descriptor(e,"nextSibling").get,is_extensible(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),is_extensible(r)&&(r.__t=void 0)}}function create_text(t=""){return document.createTextNode(t)}function get_first_child(t){return first_child_getter.call(t)}function get_next_sibling(t){return next_sibling_getter.call(t)}function child(t,e){return get_first_child(t)}function first_child(t,e){{var r=get_first_child(t);return r instanceof Comment&&r.data===""?get_next_sibling(r):r}}function sibling(t,e=1,r=!1){let i=t;for(;e--;)i=get_next_sibling(i);return i}function clear_text_content(t){t.textContent=""}function should_defer_append(){return!1}function without_reactive_context(t){var e=active_reaction,r=active_effect;set_active_reaction(null),set_active_effect(null);try{return t()}finally{set_active_reaction(e),set_active_effect(r)}}function validate_effect(t){active_effect===null&&active_reaction===null&&effect_orphan(),active_reaction!==null&&(active_reaction.f&UNOWNED)!==0&&active_effect===null&&effect_in_unowned_derived(),is_destroying_effect&&effect_in_teardown()}function push_effect(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function create_effect(t,e,r,i=!0){var n=active_effect;n!==null&&(n.f&INERT)!==0&&(t|=INERT);var s={ctx:component_context,deps:null,nodes_start:null,nodes_end:null,f:t|DIRTY,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{update_effect(s),s.f|=EFFECT_RAN}catch(l){throw destroy_effect(s),l}else e!==null&&schedule_effect(s);var o=r&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&EFFECT_PRESERVED)===0;if(!o&&i&&(n!==null&&push_effect(s,n),active_reaction!==null&&(active_reaction.f&DERIVED)!==0&&(t&ROOT_EFFECT)===0)){var a=active_reaction;(a.effects??=[]).push(s)}return s}function teardown(t){const e=create_effect(RENDER_EFFECT,null,!1);return set_signal_status(e,CLEAN),e.teardown=t,e}function user_effect(t){validate_effect();var e=active_effect.f,r=!active_reaction&&(e&BRANCH_EFFECT)!==0&&(e&EFFECT_RAN)===0;if(r){var i=component_context;(i.e??=[]).push(t)}else return create_user_effect(t)}function create_user_effect(t){return create_effect(EFFECT|USER_EFFECT,t,!1)}function component_root(t){Batch.ensure();const e=create_effect(ROOT_EFFECT,t,!0);return(r={})=>new Promise(i=>{r.outro?pause_effect(e,()=>{destroy_effect(e),i(void 0)}):(destroy_effect(e),i(void 0))})}function effect(t){return create_effect(EFFECT,t,!1)}function async_effect(t){return create_effect(ASYNC|EFFECT_PRESERVED,t,!0)}function render_effect(t,e=0){return create_effect(RENDER_EFFECT|e,t,!0)}function template_effect(t,e=[],r=[]){flatten(e,r,i=>{create_effect(RENDER_EFFECT,()=>t(...i.map(get$4)),!0)})}function block$1(t,e=0){var r=create_effect(BLOCK_EFFECT|e,t,!0);return r}function branch(t,e=!0){return create_effect(BRANCH_EFFECT,t,!0,e)}function execute_effect_teardown(t){var e=t.teardown;if(e!==null){const r=is_destroying_effect,i=active_reaction;set_is_destroying_effect(!0),set_active_reaction(null);try{e.call(null)}finally{set_is_destroying_effect(r),set_active_reaction(i)}}}function destroy_effect_children(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const n=r.ac;n!==null&&without_reactive_context(()=>{n.abort(STALE_REACTION)});var i=r.next;(r.f&ROOT_EFFECT)!==0?r.parent=null:destroy_effect(r,e),r=i}}function destroy_block_effect_children(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&BRANCH_EFFECT)===0&&destroy_effect(e),e=r}}function destroy_effect(t,e=!0){var r=!1;(e||(t.f&HEAD_EFFECT)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(remove_effect_dom(t.nodes_start,t.nodes_end),r=!0),destroy_effect_children(t,e&&!r),remove_reactions(t,0),set_signal_status(t,DESTROYED);var i=t.transitions;if(i!==null)for(const s of i)s.stop();execute_effect_teardown(t);var n=t.parent;n!==null&&n.first!==null&&unlink_effect(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function remove_effect_dom(t,e){for(;t!==null;){var r=t===e?null:get_next_sibling(t);t.remove(),t=r}}function unlink_effect(t){var e=t.parent,r=t.prev,i=t.next;r!==null&&(r.next=i),i!==null&&(i.prev=r),e!==null&&(e.first===t&&(e.first=i),e.last===t&&(e.last=r))}function pause_effect(t,e){var r=[];pause_children(t,r,!0),run_out_transitions(r,()=>{destroy_effect(t),e&&e()})}function run_out_transitions(t,e){var r=t.length;if(r>0){var i=()=>--r||e();for(var n of t)n.out(i)}else e()}function pause_children(t,e,r){if((t.f&INERT)===0){if(t.f^=INERT,t.transitions!==null)for(const o of t.transitions)(o.is_global||r)&&e.push(o);for(var i=t.first;i!==null;){var n=i.next,s=(i.f&EFFECT_TRANSPARENT)!==0||(i.f&BRANCH_EFFECT)!==0;pause_children(i,e,s?r:!1),i=n}}}function resume_effect(t){resume_children(t,!0)}function resume_children(t,e){if((t.f&INERT)!==0){t.f^=INERT,(t.f&CLEAN)===0&&(set_signal_status(t,DIRTY),schedule_effect(t));for(var r=t.first;r!==null;){var i=r.next,n=(r.f&EFFECT_TRANSPARENT)!==0||(r.f&BRANCH_EFFECT)!==0;resume_children(r,n?e:!1),r=i}if(t.transitions!==null)for(const s of t.transitions)(s.is_global||e)&&s.in()}}let is_updating_effect=!1;function set_is_updating_effect(t){is_updating_effect=t}let is_destroying_effect=!1;function set_is_destroying_effect(t){is_destroying_effect=t}let active_reaction=null,untracking=!1;function set_active_reaction(t){active_reaction=t}let active_effect=null;function set_active_effect(t){active_effect=t}let current_sources=null;function push_reaction_value(t){active_reaction!==null&&(current_sources===null?current_sources=[t]:current_sources.push(t))}let new_deps=null,skipped_deps=0,untracked_writes=null;function set_untracked_writes(t){untracked_writes=t}let write_version=1,read_version=0,update_version=read_version;function set_update_version(t){update_version=t}let skip_reaction=!1;function increment_write_version(){return++write_version}function is_dirty(t){var e=t.f;if((e&DIRTY)!==0)return!0;if((e&MAYBE_DIRTY)!==0){var r=t.deps,i=(e&UNOWNED)!==0;if(r!==null){var n,s,o=(e&DISCONNECTED)!==0,a=i&&active_effect!==null&&!skip_reaction,l=r.length;if((o||a)&&(active_effect===null||(active_effect.f&DESTROYED)===0)){var c=t,u=c.parent;for(n=0;n<l;n++)s=r[n],(o||!s?.reactions?.includes(c))&&(s.reactions??=[]).push(c);o&&(c.f^=DISCONNECTED),a&&u!==null&&(u.f&UNOWNED)===0&&(c.f^=UNOWNED)}for(n=0;n<l;n++)if(s=r[n],is_dirty(s)&&update_derived(s),s.wv>t.wv)return!0}(!i||active_effect!==null&&!skip_reaction)&&set_signal_status(t,CLEAN)}return!1}function schedule_possible_effect_self_invalidation(t,e,r=!0){var i=t.reactions;if(i!==null&&!current_sources?.includes(t))for(var n=0;n<i.length;n++){var s=i[n];(s.f&DERIVED)!==0?schedule_possible_effect_self_invalidation(s,e,!1):e===s&&(r?set_signal_status(s,DIRTY):(s.f&CLEAN)!==0&&set_signal_status(s,MAYBE_DIRTY),schedule_effect(s))}}function update_reaction(t){var e=new_deps,r=skipped_deps,i=untracked_writes,n=active_reaction,s=skip_reaction,o=current_sources,a=component_context,l=untracking,c=update_version,u=t.f;new_deps=null,skipped_deps=0,untracked_writes=null,skip_reaction=(u&UNOWNED)!==0&&(untracking||!is_updating_effect||active_reaction===null),active_reaction=(u&(BRANCH_EFFECT|ROOT_EFFECT))===0?t:null,current_sources=null,set_component_context(t.ctx),untracking=!1,update_version=++read_version,t.ac!==null&&(without_reactive_context(()=>{t.ac.abort(STALE_REACTION)}),t.ac=null);try{t.f|=REACTION_IS_UPDATING;var d=t.fn,h=d(),f=t.deps;if(new_deps!==null){var g;if(remove_reactions(t,skipped_deps),f!==null&&skipped_deps>0)for(f.length=skipped_deps+new_deps.length,g=0;g<new_deps.length;g++)f[skipped_deps+g]=new_deps[g];else t.deps=f=new_deps;if(!skip_reaction||(u&DERIVED)!==0&&t.reactions!==null)for(g=skipped_deps;g<f.length;g++)(f[g].reactions??=[]).push(t)}else f!==null&&skipped_deps<f.length&&(remove_reactions(t,skipped_deps),f.length=skipped_deps);if(is_runes()&&untracked_writes!==null&&!untracking&&f!==null&&(t.f&(DERIVED|MAYBE_DIRTY|DIRTY))===0)for(g=0;g<untracked_writes.length;g++)schedule_possible_effect_self_invalidation(untracked_writes[g],t);return n!==null&&n!==t&&(read_version++,untracked_writes!==null&&(i===null?i=untracked_writes:i.push(...untracked_writes))),(t.f&ERROR_VALUE)!==0&&(t.f^=ERROR_VALUE),h}catch(m){return handle_error(m)}finally{t.f^=REACTION_IS_UPDATING,new_deps=e,skipped_deps=r,untracked_writes=i,active_reaction=n,skip_reaction=s,current_sources=o,set_component_context(a),untracking=l,update_version=c}}function remove_reaction(t,e){let r=e.reactions;if(r!==null){var i=index_of.call(r,t);if(i!==-1){var n=r.length-1;n===0?r=e.reactions=null:(r[i]=r[n],r.pop())}}r===null&&(e.f&DERIVED)!==0&&(new_deps===null||!new_deps.includes(e))&&(set_signal_status(e,MAYBE_DIRTY),(e.f&(UNOWNED|DISCONNECTED))===0&&(e.f^=DISCONNECTED),destroy_derived_effects(e),remove_reactions(e,0))}function remove_reactions(t,e){var r=t.deps;if(r!==null)for(var i=e;i<r.length;i++)remove_reaction(t,r[i])}function update_effect(t){var e=t.f;if((e&DESTROYED)===0){set_signal_status(t,CLEAN);var r=active_effect,i=is_updating_effect;active_effect=t,is_updating_effect=!0;try{(e&BLOCK_EFFECT)!==0?destroy_block_effect_children(t):destroy_effect_children(t),execute_effect_teardown(t);var n=update_reaction(t);t.teardown=typeof n=="function"?n:null,t.wv=write_version;var s;DEV&&tracing_mode_flag&&(t.f&DIRTY)!==0&&t.deps}finally{is_updating_effect=i,active_effect=r}}}async function tick(){await Promise.resolve(),flushSync()}function get$4(t){var e=t.f,r=(e&DERIVED)!==0;if(active_reaction!==null&&!untracking){var i=active_effect!==null&&(active_effect.f&DESTROYED)!==0;if(!i&&!current_sources?.includes(t)){var n=active_reaction.deps;if((active_reaction.f&REACTION_IS_UPDATING)!==0)t.rv<read_version&&(t.rv=read_version,new_deps===null&&n!==null&&n[skipped_deps]===t?skipped_deps++:new_deps===null?new_deps=[t]:(!skip_reaction||!new_deps.includes(t))&&new_deps.push(t));else{(active_reaction.deps??=[]).push(t);var s=t.reactions;s===null?t.reactions=[active_reaction]:s.includes(active_reaction)||s.push(active_reaction)}}}else if(r&&t.deps===null&&t.effects===null){var o=t,a=o.parent;a!==null&&(a.f&UNOWNED)===0&&(o.f^=UNOWNED)}if(is_destroying_effect){if(old_values.has(t))return old_values.get(t);if(r){o=t;var l=o.v;return((o.f&CLEAN)===0&&o.reactions!==null||depends_on_old_values(o))&&(l=execute_derived(o)),old_values.set(o,l),l}}else if(r){if(o=t,batch_deriveds?.has(o))return batch_deriveds.get(o);is_dirty(o)&&update_derived(o)}if((t.f&ERROR_VALUE)!==0)throw t.v;return t.v}function depends_on_old_values(t){if(t.v===UNINITIALIZED)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(old_values.has(e)||(e.f&DERIVED)!==0&&depends_on_old_values(e))return!0;return!1}function untrack(t){var e=untracking;try{return untracking=!0,t()}finally{untracking=e}}const STATUS_MASK=-7169;function set_signal_status(t,e){t.f=t.f&STATUS_MASK|e}const all_registered_events=new Set,root_event_handles=new Set;function delegate(t){for(var e=0;e<t.length;e++)all_registered_events.add(t[e]);for(var r of root_event_handles)r(t)}let last_propagated_event=null;function handle_event_propagation(t){var e=this,r=e.ownerDocument,i=t.type,n=t.composedPath?.()||[],s=n[0]||t.target;last_propagated_event=t;var o=0,a=last_propagated_event===t&&t.__root;if(a){var l=n.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var c=n.indexOf(e);if(c===-1)return;l<=c&&(o=l)}if(s=n[o]||t.target,s!==e){define_property(t,"currentTarget",{configurable:!0,get(){return s||r}});var u=active_reaction,d=active_effect;set_active_reaction(null),set_active_effect(null);try{for(var h,f=[];s!==null;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var m=s["__"+i];if(m!=null&&(!s.disabled||t.target===s))if(is_array(m)){var[C,...y]=m;C.apply(s,[t,...y])}else m.call(s,t)}catch(v){h?f.push(v):h=v}if(t.cancelBubble||g===e||g===null)break;s=g}if(h){for(let v of f)queueMicrotask(()=>{throw v});throw h}}finally{t.__root=e,delete t.currentTarget,set_active_reaction(u),set_active_effect(d)}}}function create_fragment_from_html(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function assign_nodes(t,e){var r=active_effect;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function from_html(t,e){var r=(e&TEMPLATE_FRAGMENT)!==0,i=(e&TEMPLATE_USE_IMPORT_NODE)!==0,n,s=!t.startsWith("<!>");return()=>{n===void 0&&(n=create_fragment_from_html(s?t:"<!>"+t),r||(n=get_first_child(n)));var o=i||is_firefox?document.importNode(n,!0):n.cloneNode(!0);if(r){var a=get_first_child(o),l=o.lastChild;assign_nodes(a,l)}else assign_nodes(o,o);return o}}function comment(){var t=document.createDocumentFragment(),e=document.createComment(""),r=create_text();return t.append(e,r),assign_nodes(e,r),t}function append(t,e){t!==null&&t.before(e)}const PASSIVE_EVENTS=["touchstart","touchmove"];function is_passive_event(t){return PASSIVE_EVENTS.includes(t)}function set_text(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??=t.nodeValue)&&(t.__t=r,t.nodeValue=r+"")}function mount(t,e){return _mount(t,e)}const document_listeners=new Map;function _mount(t,{target:e,anchor:r,props:i={},events:n,context:s,intro:o=!0}){init_operations();var a=new Set,l=d=>{for(var h=0;h<d.length;h++){var f=d[h];if(!a.has(f)){a.add(f);var g=is_passive_event(f);e.addEventListener(f,handle_event_propagation,{passive:g});var m=document_listeners.get(f);m===void 0?(document.addEventListener(f,handle_event_propagation,{passive:g}),document_listeners.set(f,1)):document_listeners.set(f,m+1)}}};l(array_from(all_registered_events)),root_event_handles.add(l);var c=void 0,u=component_root(()=>{var d=r??e.appendChild(create_text());return branch(()=>{if(s){push({});var h=component_context;h.c=s}n&&(i.$$events=n),c=t(d,i)||{},s&&pop()}),()=>{for(var h of a){e.removeEventListener(h,handle_event_propagation);var f=document_listeners.get(h);--f===0?(document.removeEventListener(h,handle_event_propagation),document_listeners.delete(h)):document_listeners.set(h,f)}root_event_handles.delete(l),d!==r&&d.parentNode?.removeChild(d)}});return mounted_components.set(c,u),c}let mounted_components=new WeakMap;function onMount(t){component_context===null&&lifecycle_outside_component(),user_effect(()=>{const e=untrack(t);if(typeof e=="function")return e})}function if_block(t,e,r=!1){var i=t,n=null,s=null,o=UNINITIALIZED,a=r?EFFECT_TRANSPARENT:0,l=!1;const c=(f,g=!0)=>{l=!0,h(g,f)};var u=null;function d(){u!==null&&(u.lastChild.remove(),i.before(u),u=null);var f=o?n:s,g=o?s:n;f&&resume_effect(f),g&&pause_effect(g,()=>{o?s=null:n=null})}const h=(f,g)=>{if(o!==(o=f)){var m=should_defer_append(),C=i;if(m&&(u=document.createDocumentFragment(),u.append(C=create_text())),o?n??=g&&branch(()=>g(C)):s??=g&&branch(()=>g(C)),m){var y=current_batch,v=o?n:s,E=o?s:n;v&&y.skipped_effects.delete(v),E&&y.skipped_effects.add(E),y.add_callback(d)}else d()}};block$1(()=>{l=!1,e(c),l||h(null,null)},a)}function key(t,e,r){var i=t,n=UNINITIALIZED,s,o,a=null,l=not_equal;function c(){s&&pause_effect(s),a!==null&&(a.lastChild.remove(),i.before(a),a=null),s=o}block$1(()=>{if(l(n,n=e())){var u=i,d=should_defer_append();d&&(a=document.createDocumentFragment(),a.append(u=create_text())),o=branch(()=>r(u)),d?current_batch.add_callback(c):c()}})}function index$1(t,e){return e}function pause_effects(t,e,r){for(var i=t.items,n=[],s=e.length,o=0;o<s;o++)pause_children(e[o].e,n,!0);var a=s>0&&n.length===0&&r!==null;if(a){var l=r.parentNode;clear_text_content(l),l.append(r),i.clear(),link(t,e[0].prev,e[s-1].next)}run_out_transitions(n,()=>{for(var c=0;c<s;c++){var u=e[c];a||(i.delete(u.k),link(t,u.prev,u.next)),destroy_effect(u.e,!a)}})}function each(t,e,r,i,n,s=null){var o=t,a={flags:e,items:new Map,first:null},l=(e&EACH_IS_CONTROLLED)!==0;if(l){var c=t;o=c.appendChild(create_text())}var u=null,d=!1,h=new Map,f=derived_safe_equal(()=>{var y=r();return is_array(y)?y:y==null?[]:array_from(y)}),g,m;function C(){reconcile(m,g,a,h,o,n,e,i,r),s!==null&&(g.length===0?u?resume_effect(u):u=branch(()=>s(o)):u!==null&&pause_effect(u,()=>{u=null}))}block$1(()=>{m??=active_effect,g=get$4(f);var y=g.length;if(!(d&&y===0)){d=y===0;var v,E,$,O;if(should_defer_append()){var P=new Set,I=current_batch;for(E=0;E<y;E+=1){$=g[E],O=i($,E);var W=a.items.get(O)??h.get(O);W?(e&(EACH_ITEM_REACTIVE|EACH_INDEX_REACTIVE))!==0&&update_item(W,$,E,e):(v=create_item(null,a,null,null,$,O,E,n,e,r,!0),h.set(O,v)),P.add(O)}for(const[q,M]of a.items)P.has(q)||I.skipped_effects.add(M.e);I.add_callback(C)}else C();get$4(f)}})}function reconcile(t,e,r,i,n,s,o,a,l){var c=(o&EACH_IS_ANIMATED)!==0,u=(o&(EACH_ITEM_REACTIVE|EACH_INDEX_REACTIVE))!==0,d=e.length,h=r.items,f=r.first,g=f,m,C=null,y,v=[],E=[],$,O,P,I;if(c)for(I=0;I<d;I+=1)$=e[I],O=a($,I),P=h.get(O),P!==void 0&&(P.a?.measure(),(y??=new Set).add(P));for(I=0;I<d;I+=1){if($=e[I],O=a($,I),P=h.get(O),P===void 0){var W=i.get(O);if(W!==void 0){i.delete(O),h.set(O,W);var q=C?C.next:g;link(r,C,W),link(r,W,q),move(W,q,n),C=W}else{var M=g?g.e.nodes_start:n;C=create_item(M,r,C,C===null?r.first:C.next,$,O,I,s,o,l)}h.set(O,C),v=[],E=[],g=C.next;continue}if(u&&update_item(P,$,I,o),(P.e.f&INERT)!==0&&(resume_effect(P.e),c&&(P.a?.unfix(),(y??=new Set).delete(P))),P!==g){if(m!==void 0&&m.has(P)){if(v.length<E.length){var Y=E[0],z;C=Y.prev;var Q=v[0],K=v[v.length-1];for(z=0;z<v.length;z+=1)move(v[z],Y,n);for(z=0;z<E.length;z+=1)m.delete(E[z]);link(r,Q.prev,K.next),link(r,C,Q),link(r,K,Y),g=Y,C=K,I-=1,v=[],E=[]}else m.delete(P),move(P,g,n),link(r,P.prev,P.next),link(r,P,C===null?r.first:C.next),link(r,C,P),C=P;continue}for(v=[],E=[];g!==null&&g.k!==O;)(g.e.f&INERT)===0&&(m??=new Set).add(g),E.push(g),g=g.next;if(g===null)continue;P=g}v.push(P),C=P,g=P.next}if(g!==null||m!==void 0){for(var Z=m===void 0?[]:array_from(m);g!==null;)(g.e.f&INERT)===0&&Z.push(g),g=g.next;var ue=Z.length;if(ue>0){var oe=(o&EACH_IS_CONTROLLED)!==0&&d===0?n:null;if(c){for(I=0;I<ue;I+=1)Z[I].a?.measure();for(I=0;I<ue;I+=1)Z[I].a?.fix()}pause_effects(r,Z,oe)}}c&&queue_micro_task(()=>{if(y!==void 0)for(P of y)P.a?.apply()}),t.first=r.first&&r.first.e,t.last=C&&C.e;for(var ae of i.values())destroy_effect(ae.e);i.clear()}function update_item(t,e,r,i){(i&EACH_ITEM_REACTIVE)!==0&&internal_set(t.v,e),(i&EACH_INDEX_REACTIVE)!==0?internal_set(t.i,r):t.i=r}function create_item(t,e,r,i,n,s,o,a,l,c,u){var d=(l&EACH_ITEM_REACTIVE)!==0,h=(l&EACH_ITEM_IMMUTABLE)===0,f=d?h?mutable_source(n,!1,!1):source(n):n,g=(l&EACH_INDEX_REACTIVE)===0?o:source(o),m={i:g,v:f,k:s,a:null,e:null,prev:r,next:i};try{if(t===null){var C=document.createDocumentFragment();C.append(t=create_text())}return m.e=branch(()=>a(t,f,g,c),hydrating),m.e.prev=r&&r.e,m.e.next=i&&i.e,r===null?u||(e.first=m):(r.next=m,r.e.next=m.e),i!==null&&(i.prev=m,i.e.prev=m.e),m}finally{}}function move(t,e,r){for(var i=t.next?t.next.e.nodes_start:r,n=e?e.e.nodes_start:r,s=t.e.nodes_start;s!==null&&s!==i;){var o=get_next_sibling(s);n.before(s),s=o}}function link(t,e,r){e===null?t.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function html$3(t,e,r=!1,i=!1,n=!1){var s=t,o="";template_effect(()=>{var a=active_effect;if(o!==(o=e()??"")&&(a.nodes_start!==null&&(remove_effect_dom(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),o!=="")){var l=o+"";r?l=`<svg>${l}</svg>`:i&&(l=`<math>${l}</math>`);var c=create_fragment_from_html(l);if((r||i)&&(c=get_first_child(c)),assign_nodes(get_first_child(c),c.lastChild),r||i)for(;get_first_child(c);)s.before(get_first_child(c));else s.before(c)}})}function to_class(t,e,r){var i=t==null?"":""+t;return e&&(i=i?i+" "+e:e),i===""?null:i}function to_style(t,e){return t==null?null:String(t)}function set_class(t,e,r,i,n,s){var o=t.__className;if(o!==r||o===void 0){var a=to_class(r,i);a==null?t.removeAttribute("class"):t.className=a,t.__className=r}return s}function set_style(t,e,r,i){var n=t.__style;if(n!==e){var s=to_style(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return i}const IS_CUSTOM_ELEMENT=Symbol("is custom element"),IS_HTML=Symbol("is html");function set_attribute(t,e,r,i){var n=get_attributes(t);n[e]!==(n[e]=r)&&(r==null?t.removeAttribute(e):typeof r!="string"&&get_setters(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function get_attributes(t){return t.__attributes??={[IS_CUSTOM_ELEMENT]:t.nodeName.includes("-"),[IS_HTML]:t.namespaceURI===NAMESPACE_HTML}}var setters_cache=new Map;function get_setters(t){var e=setters_cache.get(t.nodeName);if(e)return e;setters_cache.set(t.nodeName,e=[]);for(var r,i=t,n=Element.prototype;n!==i;){r=get_descriptors(i);for(var s in r)r[s].set&&e.push(s);i=get_prototype_of(i)}return e}function is_bound_this(t,e){return t===e||t?.[STATE_SYMBOL]===e}function bind_this(t={},e,r,i){return effect(()=>{var n,s;return render_effect(()=>{n=s,s=[],untrack(()=>{t!==r(...s)&&(e(t,...s),n&&is_bound_this(r(...n),t)&&e(null,...n))})}),()=>{queue_micro_task(()=>{s&&is_bound_this(r(...s),t)&&e(null,...s)})}}),t}function subscribe_to_store(t,e,r){if(t==null)return e(void 0),r&&r(void 0),noop;const i=untrack(()=>t.subscribe(e,r));return i.unsubscribe?()=>i.unsubscribe():i}const subscriber_queue=[];function readable(t,e){return{subscribe:writable(t,e).subscribe}}function writable(t,e=noop){let r=null;const i=new Set;function n(a){if(safe_not_equal(t,a)&&(t=a,r)){const l=!subscriber_queue.length;for(const c of i)c[1](),subscriber_queue.push(c,t);if(l){for(let c=0;c<subscriber_queue.length;c+=2)subscriber_queue[c][0](subscriber_queue[c+1]);subscriber_queue.length=0}}}function s(a){n(a(t))}function o(a,l=noop){const c=[a,l];return i.add(c),i.size===1&&(r=e(n,s)||noop),a(t),()=>{i.delete(c),i.size===0&&r&&(r(),r=null)}}return{set:n,update:s,subscribe:o}}function derived(t,e,r){const i=!Array.isArray(t),n=i?[t]:t;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return readable(r,(o,a)=>{let l=!1;const c=[];let u=0,d=noop;const h=()=>{if(u)return;d();const g=e(i?c[0]:c,o,a);s?o(g):d=typeof g=="function"?g:noop},f=n.map((g,m)=>subscribe_to_store(g,C=>{c[m]=C,u&=~(1<<m),l&&h()},()=>{u|=1<<m}));return l=!0,h(),function(){run_all(f),d(),l=!1}})}function get$3(t){let e;return subscribe_to_store(t,r=>e=r)(),e}let is_store_binding=!1,IS_UNMOUNTED=Symbol();function store_get(t,e,r){const i=r[e]??={store:null,source:mutable_source(void 0),unsubscribe:noop};if(i.store!==t&&!(IS_UNMOUNTED in r))if(i.unsubscribe(),i.store=t??null,t==null)i.source.v=void 0,i.unsubscribe=noop;else{var n=!0;i.unsubscribe=subscribe_to_store(t,s=>{n?i.source.v=s:set$2(i.source,s)}),n=!1}return t&&IS_UNMOUNTED in r?get$3(t):get$4(i.source)}function store_set(t,e){return t.set(e),e}function setup_stores(){const t={};function e(){teardown(()=>{for(var r in t)t[r].unsubscribe();define_property(t,IS_UNMOUNTED,{enumerable:!1,value:!0})})}return[t,e]}function capture_store_binding(t){var e=is_store_binding;try{return is_store_binding=!1,[t(),is_store_binding]}finally{is_store_binding=e}}function prop(t,e,r,i){var n=(r&PROPS_IS_BINDABLE)!==0,s=(r&PROPS_IS_LAZY_INITIAL)!==0,o=i,a=!0,l=()=>(a&&(a=!1,o=s?untrack(i):i),o),c;if(n){var u=STATE_SYMBOL in t||LEGACY_PROPS in t;c=get_descriptor(t,e)?.set??(u&&e in t?v=>t[e]=v:void 0)}var d,h=!1;n?[d,h]=capture_store_binding(()=>t[e]):d=t[e],d===void 0&&i!==void 0&&(d=l(),c&&(props_invalid_value(),c(d)));var f;if(f=()=>{var v=t[e];return v===void 0?l():(a=!0,v)},(r&PROPS_IS_UPDATED)===0)return f;if(c){var g=t.$$legacy;return function(v,E){return arguments.length>0?((!E||g||h)&&c(E?f():v),v):f()}}var m=!1,C=((r&PROPS_IS_IMMUTABLE)!==0?derived$1:derived_safe_equal)(()=>(m=!1,f()));n&&get$4(C);var y=active_effect;return function(v,E){if(arguments.length>0){const $=E?get$4(C):n?proxy(v):v;return set$2(C,$),m=!0,o!==void 0&&(o=$),v}return is_destroying_effect&&m||(y.f&DESTROYED)!==0?C.v:get$4(C)}}function getDefaults(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let defaults$2=getDefaults();function changeDefaults(t){defaults$2=t}const escapeTest=/[&<>"']/,escapeReplace=new RegExp(escapeTest.source,"g"),escapeTestNoEncode=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode=new RegExp(escapeTestNoEncode.source,"g"),escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=t=>escapeReplacements[t];function escape(t,e){if(e){if(escapeTest.test(t))return t.replace(escapeReplace,getEscapeReplacement)}else if(escapeTestNoEncode.test(t))return t.replace(escapeReplaceNoEncode,getEscapeReplacement);return t}const unescapeTest=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function unescape(t){return t.replace(unescapeTest,(e,r)=>(r=r.toLowerCase(),r==="colon"?":":r.charAt(0)==="#"?r.charAt(1)==="x"?String.fromCharCode(parseInt(r.substring(2),16)):String.fromCharCode(+r.substring(1)):""))}const caret=/(^|[^\[])\^/g;function edit(t,e){t=typeof t=="string"?t:t.source,e=e||"";const r={replace:(i,n)=>(n=n.source||n,n=n.replace(caret,"$1"),t=t.replace(i,n),r),getRegex:()=>new RegExp(t,e)};return r}const nonWordAndColonTest=/[^\w:]/g,originIndependentUrl=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function cleanUrl(t,e,r){if(t){let i;try{i=decodeURIComponent(unescape(r)).replace(nonWordAndColonTest,"").toLowerCase()}catch{return null}if(i.indexOf("javascript:")===0||i.indexOf("vbscript:")===0||i.indexOf("data:")===0)return null}e&&!originIndependentUrl.test(r)&&(r=resolveUrl(e,r));try{r=encodeURI(r).replace(/%25/g,"%")}catch{return null}return r}const baseUrls={},justDomain=/^[^:]+:\/*[^/]*$/,protocol=/^([^:]+:)[\s\S]*$/,domain=/^([^:]+:\/*[^/]*)[\s\S]*$/;function resolveUrl(t,e){baseUrls[" "+t]||(justDomain.test(t)?baseUrls[" "+t]=t+"/":baseUrls[" "+t]=rtrim(t,"/",!0)),t=baseUrls[" "+t];const r=t.indexOf(":")===-1;return e.substring(0,2)==="//"?r?e:t.replace(protocol,"$1")+e:e.charAt(0)==="/"?r?e:t.replace(domain,"$1")+e:t+e}const noopTest={exec:function(){}};function splitCells(t,e){const r=t.replace(/\|/g,(s,o,a)=>{let l=!1,c=o;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),i=r.split(/ \|/);let n=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i}function rtrim(t,e,r){const i=t.length;if(i===0)return"";let n=0;for(;n<i;){const s=t.charAt(i-n-1);if(s===e&&!r)n++;else if(s!==e&&r)n++;else break}return t.slice(0,i-n)}function findClosingBracket(t,e){if(t.indexOf(e[1])===-1)return-1;const r=t.length;let i=0,n=0;for(;n<r;n++)if(t[n]==="\\")n++;else if(t[n]===e[0])i++;else if(t[n]===e[1]&&(i--,i<0))return n;return-1}function checkSanitizeDeprecation(t){t&&t.sanitize&&!t.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function repeatString(t,e){if(e<1)return"";let r="";for(;e>1;)e&1&&(r+=t),e>>=1,t+=t;return r+t}function outputLink(t,e,r,i){const n=e.href,s=e.title?escape(e.title):null,o=t[1].replace(/\\([\[\]])/g,"$1");if(t[0].charAt(0)!=="!"){i.state.inLink=!0;const a={type:"link",raw:r,href:n,title:s,text:o,tokens:i.inlineTokens(o)};return i.state.inLink=!1,a}return{type:"image",raw:r,href:n,title:s,text:escape(o)}}function indentCodeCompensation(t,e){const r=t.match(/^(\s+)(?:```)/);if(r===null)return e;const i=r[1];return e.split(`
`).map(n=>{const s=n.match(/^\s+/);if(s===null)return n;const[o]=s;return o.length>=i.length?n.slice(i.length):n}).join(`
`)}class Tokenizer{constructor(e){this.options=e||defaults$2}space(e){const r=this.rules.block.newline.exec(e);if(r&&r[0].length>0)return{type:"space",raw:r[0]}}code(e){const r=this.rules.block.code.exec(e);if(r){const i=r[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:r[0],codeBlockStyle:"indented",text:this.options.pedantic?i:rtrim(i,`
`)}}}fences(e){const r=this.rules.block.fences.exec(e);if(r){const i=r[0],n=indentCodeCompensation(i,r[3]||"");return{type:"code",raw:i,lang:r[2]?r[2].trim().replace(this.rules.inline._escapes,"$1"):r[2],text:n}}}heading(e){const r=this.rules.block.heading.exec(e);if(r){let i=r[2].trim();if(/#$/.test(i)){const n=rtrim(i,"#");(this.options.pedantic||!n||/ $/.test(n))&&(i=n.trim())}return{type:"heading",raw:r[0],depth:r[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const r=this.rules.block.hr.exec(e);if(r)return{type:"hr",raw:r[0]}}blockquote(e){const r=this.rules.block.blockquote.exec(e);if(r){const i=r[0].replace(/^ *>[ \t]?/gm,""),n=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(i);return this.lexer.state.top=n,{type:"blockquote",raw:r[0],tokens:s,text:i}}}list(e){let r=this.rules.block.list.exec(e);if(r){let i,n,s,o,a,l,c,u,d,h,f,g,m=r[1].trim();const C=m.length>1,y={type:"list",raw:"",ordered:C,start:C?+m.slice(0,-1):"",loose:!1,items:[]};m=C?`\\d{1,9}\\${m.slice(-1)}`:`\\${m}`,this.options.pedantic&&(m=C?m:"[*+-]");const v=new RegExp(`^( {0,3}${m})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;e&&(g=!1,!(!(r=v.exec(e))||this.rules.block.hr.test(e)));){if(i=r[0],e=e.substring(i.length),u=r[2].split(`
`,1)[0].replace(/^\t+/,$=>" ".repeat(3*$.length)),d=e.split(`
`,1)[0],this.options.pedantic?(o=2,f=u.trimLeft()):(o=r[2].search(/[^ ]/),o=o>4?1:o,f=u.slice(o),o+=r[1].length),l=!1,!u&&/^ *$/.test(d)&&(i+=d+`
`,e=e.substring(d.length+1),g=!0),!g){const $=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),O=new RegExp(`^ {0,${Math.min(3,o-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),P=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:\`\`\`|~~~)`),I=new RegExp(`^ {0,${Math.min(3,o-1)}}#`);for(;e&&(h=e.split(`
`,1)[0],d=h,this.options.pedantic&&(d=d.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(P.test(d)||I.test(d)||$.test(d)||O.test(e)));){if(d.search(/[^ ]/)>=o||!d.trim())f+=`
`+d.slice(o);else{if(l||u.search(/[^ ]/)>=4||P.test(u)||I.test(u)||O.test(u))break;f+=`
`+d}!l&&!d.trim()&&(l=!0),i+=h+`
`,e=e.substring(h.length+1),u=d.slice(o)}}y.loose||(c?y.loose=!0:/\n *\n *$/.test(i)&&(c=!0)),this.options.gfm&&(n=/^\[[ xX]\] /.exec(f),n&&(s=n[0]!=="[ ] ",f=f.replace(/^\[[ xX]\] +/,""))),y.items.push({type:"list_item",raw:i,task:!!n,checked:s,loose:!1,text:f}),y.raw+=i}y.items[y.items.length-1].raw=i.trimRight(),y.items[y.items.length-1].text=f.trimRight(),y.raw=y.raw.trimRight();const E=y.items.length;for(a=0;a<E;a++)if(this.lexer.state.top=!1,y.items[a].tokens=this.lexer.blockTokens(y.items[a].text,[]),!y.loose){const $=y.items[a].tokens.filter(P=>P.type==="space"),O=$.length>0&&$.some(P=>/\n.*\n/.test(P.raw));y.loose=O}if(y.loose)for(a=0;a<E;a++)y.items[a].loose=!0;return y}}html(e){const r=this.rules.block.html.exec(e);if(r){const i={type:"html",raw:r[0],pre:!this.options.sanitizer&&(r[1]==="pre"||r[1]==="script"||r[1]==="style"),text:r[0]};if(this.options.sanitize){const n=this.options.sanitizer?this.options.sanitizer(r[0]):escape(r[0]);i.type="paragraph",i.text=n,i.tokens=this.lexer.inline(n)}return i}}def(e){const r=this.rules.block.def.exec(e);if(r){const i=r[1].toLowerCase().replace(/\s+/g," "),n=r[2]?r[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",s=r[3]?r[3].substring(1,r[3].length-1).replace(this.rules.inline._escapes,"$1"):r[3];return{type:"def",tag:i,raw:r[0],href:n,title:s}}}table(e){const r=this.rules.block.table.exec(e);if(r){const i={type:"table",header:splitCells(r[1]).map(n=>({text:n})),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:r[3]&&r[3].trim()?r[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(i.header.length===i.align.length){i.raw=r[0];let n=i.align.length,s,o,a,l;for(s=0;s<n;s++)/^ *-+: *$/.test(i.align[s])?i.align[s]="right":/^ *:-+: *$/.test(i.align[s])?i.align[s]="center":/^ *:-+ *$/.test(i.align[s])?i.align[s]="left":i.align[s]=null;for(n=i.rows.length,s=0;s<n;s++)i.rows[s]=splitCells(i.rows[s],i.header.length).map(c=>({text:c}));for(n=i.header.length,o=0;o<n;o++)i.header[o].tokens=this.lexer.inline(i.header[o].text);for(n=i.rows.length,o=0;o<n;o++)for(l=i.rows[o],a=0;a<l.length;a++)l[a].tokens=this.lexer.inline(l[a].text);return i}}}lheading(e){const r=this.rules.block.lheading.exec(e);if(r)return{type:"heading",raw:r[0],depth:r[2].charAt(0)==="="?1:2,text:r[1],tokens:this.lexer.inline(r[1])}}paragraph(e){const r=this.rules.block.paragraph.exec(e);if(r){const i=r[1].charAt(r[1].length-1)===`
`?r[1].slice(0,-1):r[1];return{type:"paragraph",raw:r[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const r=this.rules.block.text.exec(e);if(r)return{type:"text",raw:r[0],text:r[0],tokens:this.lexer.inline(r[0])}}escape(e){const r=this.rules.inline.escape.exec(e);if(r)return{type:"escape",raw:r[0],text:escape(r[1])}}tag(e){const r=this.rules.inline.tag.exec(e);if(r)return!this.lexer.state.inLink&&/^<a /i.test(r[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(r[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:r[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):escape(r[0]):r[0]}}link(e){const r=this.rules.inline.link.exec(e);if(r){const i=r[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const o=rtrim(i.slice(0,-1),"\\");if((i.length-o.length)%2===0)return}else{const o=findClosingBracket(r[2],"()");if(o>-1){const l=(r[0].indexOf("!")===0?5:4)+r[1].length+o;r[2]=r[2].substring(0,o),r[0]=r[0].substring(0,l).trim(),r[3]=""}}let n=r[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);o&&(n=o[1],s=o[3])}else s=r[3]?r[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(this.options.pedantic&&!/>$/.test(i)?n=n.slice(1):n=n.slice(1,-1)),outputLink(r,{href:n&&n.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},r[0],this.lexer)}}reflink(e,r){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){let n=(i[2]||i[1]).replace(/\s+/g," ");if(n=r[n.toLowerCase()],!n){const s=i[0].charAt(0);return{type:"text",raw:s,text:s}}return outputLink(i,n,i[0],this.lexer)}}emStrong(e,r,i=""){let n=this.rules.inline.emStrong.lDelim.exec(e);if(!n||n[3]&&i.match(/[\p{L}\p{N}]/u))return;const s=n[1]||n[2]||"";if(!s||s&&(i===""||this.rules.inline.punctuation.exec(i))){const o=n[0].length-1;let a,l,c=o,u=0;const d=n[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(d.lastIndex=0,r=r.slice(-1*e.length+o);(n=d.exec(r))!=null;){if(a=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!a)continue;if(l=a.length,n[3]||n[4]){c+=l;continue}else if((n[5]||n[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);const h=e.slice(0,o+n.index+(n[0].length-a.length)+l);if(Math.min(o,l)%2){const g=h.slice(1,-1);return{type:"em",raw:h,text:g,tokens:this.lexer.inlineTokens(g)}}const f=h.slice(2,-2);return{type:"strong",raw:h,text:f,tokens:this.lexer.inlineTokens(f)}}}}codespan(e){const r=this.rules.inline.code.exec(e);if(r){let i=r[2].replace(/\n/g," ");const n=/[^ ]/.test(i),s=/^ /.test(i)&&/ $/.test(i);return n&&s&&(i=i.substring(1,i.length-1)),i=escape(i,!0),{type:"codespan",raw:r[0],text:i}}}br(e){const r=this.rules.inline.br.exec(e);if(r)return{type:"br",raw:r[0]}}del(e){const r=this.rules.inline.del.exec(e);if(r)return{type:"del",raw:r[0],text:r[2],tokens:this.lexer.inlineTokens(r[2])}}autolink(e,r){const i=this.rules.inline.autolink.exec(e);if(i){let n,s;return i[2]==="@"?(n=escape(this.options.mangle?r(i[1]):i[1]),s="mailto:"+n):(n=escape(i[1]),s=n),{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}url(e,r){let i;if(i=this.rules.inline.url.exec(e)){let n,s;if(i[2]==="@")n=escape(this.options.mangle?r(i[0]):i[0]),s="mailto:"+n;else{let o;do o=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0];while(o!==i[0]);n=escape(i[0]),i[1]==="www."?s="http://"+i[0]:s=i[0]}return{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e,r){const i=this.rules.inline.text.exec(e);if(i){let n;return this.lexer.state.inRawBlock?n=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):escape(i[0]):i[0]:n=escape(this.options.smartypants?r(i[0]):i[0]),{type:"text",raw:i[0],text:n}}}}const block={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:noopTest,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};block._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;block._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;block.def=edit(block.def).replace("label",block._label).replace("title",block._title).getRegex();block.bullet=/(?:[*+-]|\d{1,9}[.)])/;block.listItemStart=edit(/^( *)(bull) */).replace("bull",block.bullet).getRegex();block.list=edit(block.list).replace(/bull/g,block.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+block.def.source+")").getRegex();block._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";block._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;block.html=edit(block.html,"i").replace("comment",block._comment).replace("tag",block._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();block.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.blockquote=edit(block.blockquote).replace("paragraph",block.paragraph).getRegex();block.normal={...block};block.gfm={...block.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};block.gfm.table=edit(block.gfm.table).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.gfm.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",block.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.pedantic={...block.normal,html:edit(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",block._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:noopTest,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:edit(block.normal._paragraph).replace("hr",block.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",block.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const inline={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:noopTest,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:noopTest,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};inline._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";inline.punctuation=edit(inline.punctuation).replace(/punctuation/g,inline._punctuation).getRegex();inline.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;inline.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;inline._comment=edit(block._comment).replace("(?:-->|$)","-->").getRegex();inline.emStrong.lDelim=edit(inline.emStrong.lDelim).replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimAst=edit(inline.emStrong.rDelimAst,"g").replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimUnd=edit(inline.emStrong.rDelimUnd,"g").replace(/punct/g,inline._punctuation).getRegex();inline._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;inline._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;inline._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;inline.autolink=edit(inline.autolink).replace("scheme",inline._scheme).replace("email",inline._email).getRegex();inline._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;inline.tag=edit(inline.tag).replace("comment",inline._comment).replace("attribute",inline._attribute).getRegex();inline._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;inline._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;inline._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;inline.link=edit(inline.link).replace("label",inline._label).replace("href",inline._href).replace("title",inline._title).getRegex();inline.reflink=edit(inline.reflink).replace("label",inline._label).replace("ref",block._label).getRegex();inline.nolink=edit(inline.nolink).replace("ref",block._label).getRegex();inline.reflinkSearch=edit(inline.reflinkSearch,"g").replace("reflink",inline.reflink).replace("nolink",inline.nolink).getRegex();inline.normal={...inline};inline.pedantic={...inline.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",inline._label).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",inline._label).getRegex()};inline.gfm={...inline.normal,escape:edit(inline.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};inline.gfm.url=edit(inline.gfm.url,"i").replace("email",inline.gfm._extended_email).getRegex();inline.breaks={...inline.gfm,br:edit(inline.br).replace("{2,}","*").getRegex(),text:edit(inline.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function smartypants(t){return t.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function mangle(t){let e="",r,i;const n=t.length;for(r=0;r<n;r++)i=t.charCodeAt(r),Math.random()>.5&&(i="x"+i.toString(16)),e+="&#"+i+";";return e}class Lexer{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||defaults$2,this.options.tokenizer=this.options.tokenizer||new Tokenizer,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const r={block:block.normal,inline:inline.normal};this.options.pedantic?(r.block=block.pedantic,r.inline=inline.pedantic):this.options.gfm&&(r.block=block.gfm,this.options.breaks?r.inline=inline.breaks:r.inline=inline.gfm),this.tokenizer.rules=r}static get rules(){return{block,inline}}static lex(e,r){return new Lexer(r).lex(e)}static lexInline(e,r){return new Lexer(r).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let r;for(;r=this.inlineQueue.shift();)this.inlineTokens(r.src,r.tokens);return this.tokens}blockTokens(e,r=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,c)=>l+"    ".repeat(c.length));let i,n,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(i=a.call({lexer:this},e,r))?(e=e.substring(i.raw.length),r.push(i),!0):!1))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),i.raw.length===1&&r.length>0?r[r.length-1].raw+=`
`:r.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),n=r[r.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text):r.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),n=r[r.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+i.raw,n.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),r.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(function(u){c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){n=r[r.length-1],o&&n.type==="paragraph"?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):r.push(i),o=s.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),n=r[r.length-1],n&&n.type==="text"?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):r.push(i);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){let i,n,s,o=e,a,l,c;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+repeatString("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+repeatString("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,a.index+a[0].length-2)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;e;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(i=u.call({lexer:this},e,r))?(e=e.substring(i.raw.length),r.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),n=r[r.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):r.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),n=r[r.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):r.push(i);continue}if(i=this.tokenizer.emStrong(e,o,c)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.autolink(e,mangle)){e=e.substring(i.raw.length),r.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e,mangle))){e=e.substring(i.raw.length),r.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=e.slice(1);let h;this.options.extensions.startInline.forEach(function(f){h=f.call({lexer:this},d),typeof h=="number"&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(i=this.tokenizer.inlineText(s,smartypants)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(c=i.raw.slice(-1)),l=!0,n=r[r.length-1],n&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):r.push(i);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return r}}let Renderer$1=class{constructor(e){this.options=e||defaults$2}code(e,r,i){const n=(r||"").match(/\S*/)[0];if(this.options.highlight){const s=this.options.highlight(e,n);s!=null&&s!==e&&(i=!0,e=s)}return e=e.replace(/\n$/,"")+`
`,n?'<pre><code class="'+this.options.langPrefix+escape(n)+'">'+(i?e:escape(e,!0))+`</code></pre>
`:"<pre><code>"+(i?e:escape(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e){return e}heading(e,r,i,n){if(this.options.headerIds){const s=this.options.headerPrefix+n.slug(i);return`<h${r} id="${s}">${e}</h${r}>
`}return`<h${r}>${e}</h${r}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,r,i){const n=r?"ol":"ul",s=r&&i!==1?' start="'+i+'"':"";return"<"+n+s+`>
`+e+"</"+n+`>
`}listitem(e){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return`<p>${e}</p>
`}table(e,r){return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,r){const i=r.header?"th":"td";return(r.align?`<${i} align="${r.align}">`:`<${i}>`)+e+`</${i}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return`<del>${e}</del>`}link(e,r,i){if(e=cleanUrl(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let n='<a href="'+e+'"';return r&&(n+=' title="'+r+'"'),n+=">"+i+"</a>",n}image(e,r,i){if(e=cleanUrl(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let n=`<img src="${e}" alt="${i}"`;return r&&(n+=` title="${r}"`),n+=this.options.xhtml?"/>":">",n}text(e){return e}};class TextRenderer{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,r,i){return""+i}image(e,r,i){return""+i}br(){return""}}class Slugger{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,r){let i=e,n=0;if(this.seen.hasOwnProperty(i)){n=this.seen[e];do n++,i=e+"-"+n;while(this.seen.hasOwnProperty(i))}return r||(this.seen[e]=n,this.seen[i]=0),i}slug(e,r={}){const i=this.serialize(e);return this.getNextSafeSlug(i,r.dryrun)}}class Parser{constructor(e){this.options=e||defaults$2,this.options.renderer=this.options.renderer||new Renderer$1,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new TextRenderer,this.slugger=new Slugger}static parse(e,r){return new Parser(r).parse(e)}static parseInline(e,r){return new Parser(r).parseInline(e)}parse(e,r=!0){let i="",n,s,o,a,l,c,u,d,h,f,g,m,C,y,v,E,$,O,P;const I=e.length;for(n=0;n<I;n++){if(f=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[f.type]&&(P=this.options.extensions.renderers[f.type].call({parser:this},f),P!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(f.type))){i+=P||"";continue}switch(f.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue}case"heading":{i+=this.renderer.heading(this.parseInline(f.tokens),f.depth,unescape(this.parseInline(f.tokens,this.textRenderer)),this.slugger);continue}case"code":{i+=this.renderer.code(f.text,f.lang,f.escaped);continue}case"table":{for(d="",u="",a=f.header.length,s=0;s<a;s++)u+=this.renderer.tablecell(this.parseInline(f.header[s].tokens),{header:!0,align:f.align[s]});for(d+=this.renderer.tablerow(u),h="",a=f.rows.length,s=0;s<a;s++){for(c=f.rows[s],u="",l=c.length,o=0;o<l;o++)u+=this.renderer.tablecell(this.parseInline(c[o].tokens),{header:!1,align:f.align[o]});h+=this.renderer.tablerow(u)}i+=this.renderer.table(d,h);continue}case"blockquote":{h=this.parse(f.tokens),i+=this.renderer.blockquote(h);continue}case"list":{for(g=f.ordered,m=f.start,C=f.loose,a=f.items.length,h="",s=0;s<a;s++)v=f.items[s],E=v.checked,$=v.task,y="",v.task&&(O=this.renderer.checkbox(E),C?v.tokens.length>0&&v.tokens[0].type==="paragraph"?(v.tokens[0].text=O+" "+v.tokens[0].text,v.tokens[0].tokens&&v.tokens[0].tokens.length>0&&v.tokens[0].tokens[0].type==="text"&&(v.tokens[0].tokens[0].text=O+" "+v.tokens[0].tokens[0].text)):v.tokens.unshift({type:"text",text:O}):y+=O),y+=this.parse(v.tokens,C),h+=this.renderer.listitem(y,$,E);i+=this.renderer.list(h,g,m);continue}case"html":{i+=this.renderer.html(f.text);continue}case"paragraph":{i+=this.renderer.paragraph(this.parseInline(f.tokens));continue}case"text":{for(h=f.tokens?this.parseInline(f.tokens):f.text;n+1<I&&e[n+1].type==="text";)f=e[++n],h+=`
`+(f.tokens?this.parseInline(f.tokens):f.text);i+=r?this.renderer.paragraph(h):h;continue}default:{const W='Token with "'+f.type+'" type was not found.';if(this.options.silent){console.error(W);return}else throw new Error(W)}}}return i}parseInline(e,r){r=r||this.renderer;let i="",n,s,o;const a=e.length;for(n=0;n<a;n++){if(s=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]&&(o=this.options.extensions.renderers[s.type].call({parser:this},s),o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type))){i+=o||"";continue}switch(s.type){case"escape":{i+=r.text(s.text);break}case"html":{i+=r.html(s.text);break}case"link":{i+=r.link(s.href,s.title,this.parseInline(s.tokens,r));break}case"image":{i+=r.image(s.href,s.title,s.text);break}case"strong":{i+=r.strong(this.parseInline(s.tokens,r));break}case"em":{i+=r.em(this.parseInline(s.tokens,r));break}case"codespan":{i+=r.codespan(s.text);break}case"br":{i+=r.br();break}case"del":{i+=r.del(this.parseInline(s.tokens,r));break}case"text":{i+=r.text(s.text);break}default:{const l='Token with "'+s.type+'" type was not found.';if(this.options.silent){console.error(l);return}else throw new Error(l)}}}return i}}let Hooks$1=class{constructor(e){this.options=e||defaults$2}static passThroughHooks=new Set(["preprocess","postprocess"]);preprocess(e){return e}postprocess(e){return e}};function onError(t,e,r){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const n="<p>An error occurred:</p><pre>"+escape(i.message+"",!0)+"</pre>";if(e)return Promise.resolve(n);if(r){r(null,n);return}return n}if(e)return Promise.reject(i);if(r){r(i);return}throw i}}function parseMarkdown(t,e){return(r,i,n)=>{typeof i=="function"&&(n=i,i=null);const s={...i};i={...marked.defaults,...s};const o=onError(i.silent,i.async,n);if(typeof r>"u"||r===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(checkSanitizeDeprecation(i),i.hooks&&(i.hooks.options=i),n){const a=i.highlight;let l;try{i.hooks&&(r=i.hooks.preprocess(r)),l=t(r,i)}catch(d){return o(d)}const c=function(d){let h;if(!d)try{i.walkTokens&&marked.walkTokens(l,i.walkTokens),h=e(l,i),i.hooks&&(h=i.hooks.postprocess(h))}catch(f){d=f}return i.highlight=a,d?o(d):n(null,h)};if(!a||a.length<3||(delete i.highlight,!l.length))return c();let u=0;marked.walkTokens(l,function(d){d.type==="code"&&(u++,setTimeout(()=>{a(d.text,d.lang,function(h,f){if(h)return c(h);f!=null&&f!==d.text&&(d.text=f,d.escaped=!0),u--,u===0&&c()})},0))}),u===0&&c();return}if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(r):r).then(a=>t(a,i)).then(a=>i.walkTokens?Promise.all(marked.walkTokens(a,i.walkTokens)).then(()=>a):a).then(a=>e(a,i)).then(a=>i.hooks?i.hooks.postprocess(a):a).catch(o);try{i.hooks&&(r=i.hooks.preprocess(r));const a=t(r,i);i.walkTokens&&marked.walkTokens(a,i.walkTokens);let l=e(a,i);return i.hooks&&(l=i.hooks.postprocess(l)),l}catch(a){return o(a)}}}function marked(t,e,r){return parseMarkdown(Lexer.lex,Parser.parse)(t,e,r)}marked.options=marked.setOptions=function(t){return marked.defaults={...marked.defaults,...t},changeDefaults(marked.defaults),marked};marked.getDefaults=getDefaults;marked.defaults=defaults$2;marked.use=function(...t){const e=marked.defaults.extensions||{renderers:{},childTokens:{}};t.forEach(r=>{const i={...r};if(i.async=marked.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(n=>{if(!n.name)throw new Error("extension name required");if(n.renderer){const s=e.renderers[n.name];s?e.renderers[n.name]=function(...o){let a=n.renderer.apply(this,o);return a===!1&&(a=s.apply(this,o)),a}:e.renderers[n.name]=n.renderer}if(n.tokenizer){if(!n.level||n.level!=="block"&&n.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");e[n.level]?e[n.level].unshift(n.tokenizer):e[n.level]=[n.tokenizer],n.start&&(n.level==="block"?e.startBlock?e.startBlock.push(n.start):e.startBlock=[n.start]:n.level==="inline"&&(e.startInline?e.startInline.push(n.start):e.startInline=[n.start]))}n.childTokens&&(e.childTokens[n.name]=n.childTokens)}),i.extensions=e),r.renderer){const n=marked.defaults.renderer||new Renderer$1;for(const s in r.renderer){const o=n[s];n[s]=(...a)=>{let l=r.renderer[s].apply(n,a);return l===!1&&(l=o.apply(n,a)),l}}i.renderer=n}if(r.tokenizer){const n=marked.defaults.tokenizer||new Tokenizer;for(const s in r.tokenizer){const o=n[s];n[s]=(...a)=>{let l=r.tokenizer[s].apply(n,a);return l===!1&&(l=o.apply(n,a)),l}}i.tokenizer=n}if(r.hooks){const n=marked.defaults.hooks||new Hooks$1;for(const s in r.hooks){const o=n[s];Hooks$1.passThroughHooks.has(s)?n[s]=a=>{if(marked.defaults.async)return Promise.resolve(r.hooks[s].call(n,a)).then(c=>o.call(n,c));const l=r.hooks[s].call(n,a);return o.call(n,l)}:n[s]=(...a)=>{let l=r.hooks[s].apply(n,a);return l===!1&&(l=o.apply(n,a)),l}}i.hooks=n}if(r.walkTokens){const n=marked.defaults.walkTokens;i.walkTokens=function(s){let o=[];return o.push(r.walkTokens.call(this,s)),n&&(o=o.concat(n.call(this,s))),o}}marked.setOptions(i)})};marked.walkTokens=function(t,e){let r=[];for(const i of t)switch(r=r.concat(e.call(marked,i)),i.type){case"table":{for(const n of i.header)r=r.concat(marked.walkTokens(n.tokens,e));for(const n of i.rows)for(const s of n)r=r.concat(marked.walkTokens(s.tokens,e));break}case"list":{r=r.concat(marked.walkTokens(i.items,e));break}default:marked.defaults.extensions&&marked.defaults.extensions.childTokens&&marked.defaults.extensions.childTokens[i.type]?marked.defaults.extensions.childTokens[i.type].forEach(function(n){r=r.concat(marked.walkTokens(i[n],e))}):i.tokens&&(r=r.concat(marked.walkTokens(i.tokens,e)))}return r};marked.parseInline=parseMarkdown(Lexer.lexInline,Parser.parseInline);marked.Parser=Parser;marked.parser=Parser.parse;marked.Renderer=Renderer$1;marked.TextRenderer=TextRenderer;marked.Lexer=Lexer;marked.lexer=Lexer.lex;marked.Tokenizer=Tokenizer;marked.Slugger=Slugger;marked.Hooks=Hooks$1;marked.parse=marked;marked.options;marked.setOptions;marked.use;marked.walkTokens;marked.parseInline;Parser.parse;Lexer.lex;var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},es_error_cause={},globalThis_1,hasRequiredGlobalThis;function requireGlobalThis(){if(hasRequiredGlobalThis)return globalThis_1;hasRequiredGlobalThis=1;var t=function(e){return e&&e.Math===Math&&e};return globalThis_1=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof commonjsGlobal$1=="object"&&commonjsGlobal$1)||t(typeof globalThis_1=="object"&&globalThis_1)||function(){return this}()||Function("return this")(),globalThis_1}var objectGetOwnPropertyDescriptor={},fails,hasRequiredFails;function requireFails(){return hasRequiredFails||(hasRequiredFails=1,fails=function(t){try{return!!t()}catch{return!0}}),fails}var descriptors,hasRequiredDescriptors;function requireDescriptors(){if(hasRequiredDescriptors)return descriptors;hasRequiredDescriptors=1;var t=requireFails();return descriptors=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),descriptors}var functionBindNative,hasRequiredFunctionBindNative;function requireFunctionBindNative(){if(hasRequiredFunctionBindNative)return functionBindNative;hasRequiredFunctionBindNative=1;var t=requireFails();return functionBindNative=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),functionBindNative}var functionCall,hasRequiredFunctionCall;function requireFunctionCall(){if(hasRequiredFunctionCall)return functionCall;hasRequiredFunctionCall=1;var t=requireFunctionBindNative(),e=Function.prototype.call;return functionCall=t?e.bind(e):function(){return e.apply(e,arguments)},functionCall}var objectPropertyIsEnumerable={},hasRequiredObjectPropertyIsEnumerable;function requireObjectPropertyIsEnumerable(){if(hasRequiredObjectPropertyIsEnumerable)return objectPropertyIsEnumerable;hasRequiredObjectPropertyIsEnumerable=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return objectPropertyIsEnumerable.f=r?function(n){var s=e(this,n);return!!s&&s.enumerable}:t,objectPropertyIsEnumerable}var createPropertyDescriptor,hasRequiredCreatePropertyDescriptor;function requireCreatePropertyDescriptor(){return hasRequiredCreatePropertyDescriptor||(hasRequiredCreatePropertyDescriptor=1,createPropertyDescriptor=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),createPropertyDescriptor}var functionUncurryThis,hasRequiredFunctionUncurryThis;function requireFunctionUncurryThis(){if(hasRequiredFunctionUncurryThis)return functionUncurryThis;hasRequiredFunctionUncurryThis=1;var t=requireFunctionBindNative(),e=Function.prototype,r=e.call,i=t&&e.bind.bind(r,r);return functionUncurryThis=t?i:function(n){return function(){return r.apply(n,arguments)}},functionUncurryThis}var classofRaw,hasRequiredClassofRaw;function requireClassofRaw(){if(hasRequiredClassofRaw)return classofRaw;hasRequiredClassofRaw=1;var t=requireFunctionUncurryThis(),e=t({}.toString),r=t("".slice);return classofRaw=function(i){return r(e(i),8,-1)},classofRaw}var indexedObject,hasRequiredIndexedObject;function requireIndexedObject(){if(hasRequiredIndexedObject)return indexedObject;hasRequiredIndexedObject=1;var t=requireFunctionUncurryThis(),e=requireFails(),r=requireClassofRaw(),i=Object,n=t("".split);return indexedObject=e(function(){return!i("z").propertyIsEnumerable(0)})?function(s){return r(s)==="String"?n(s,""):i(s)}:i,indexedObject}var isNullOrUndefined,hasRequiredIsNullOrUndefined;function requireIsNullOrUndefined(){return hasRequiredIsNullOrUndefined||(hasRequiredIsNullOrUndefined=1,isNullOrUndefined=function(t){return t==null}),isNullOrUndefined}var requireObjectCoercible,hasRequiredRequireObjectCoercible;function requireRequireObjectCoercible(){if(hasRequiredRequireObjectCoercible)return requireObjectCoercible;hasRequiredRequireObjectCoercible=1;var t=requireIsNullOrUndefined(),e=TypeError;return requireObjectCoercible=function(r){if(t(r))throw new e("Can't call method on "+r);return r},requireObjectCoercible}var toIndexedObject,hasRequiredToIndexedObject;function requireToIndexedObject(){if(hasRequiredToIndexedObject)return toIndexedObject;hasRequiredToIndexedObject=1;var t=requireIndexedObject(),e=requireRequireObjectCoercible();return toIndexedObject=function(r){return t(e(r))},toIndexedObject}var isCallable,hasRequiredIsCallable;function requireIsCallable(){if(hasRequiredIsCallable)return isCallable;hasRequiredIsCallable=1;var t=typeof document=="object"&&document.all;return isCallable=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},isCallable}var isObject$2,hasRequiredIsObject;function requireIsObject(){if(hasRequiredIsObject)return isObject$2;hasRequiredIsObject=1;var t=requireIsCallable();return isObject$2=function(e){return typeof e=="object"?e!==null:t(e)},isObject$2}var getBuiltIn,hasRequiredGetBuiltIn;function requireGetBuiltIn(){if(hasRequiredGetBuiltIn)return getBuiltIn;hasRequiredGetBuiltIn=1;var t=requireGlobalThis(),e=requireIsCallable(),r=function(i){return e(i)?i:void 0};return getBuiltIn=function(i,n){return arguments.length<2?r(t[i]):t[i]&&t[i][n]},getBuiltIn}var objectIsPrototypeOf,hasRequiredObjectIsPrototypeOf;function requireObjectIsPrototypeOf(){if(hasRequiredObjectIsPrototypeOf)return objectIsPrototypeOf;hasRequiredObjectIsPrototypeOf=1;var t=requireFunctionUncurryThis();return objectIsPrototypeOf=t({}.isPrototypeOf),objectIsPrototypeOf}var environmentUserAgent,hasRequiredEnvironmentUserAgent;function requireEnvironmentUserAgent(){if(hasRequiredEnvironmentUserAgent)return environmentUserAgent;hasRequiredEnvironmentUserAgent=1;var t=requireGlobalThis(),e=t.navigator,r=e&&e.userAgent;return environmentUserAgent=r?String(r):"",environmentUserAgent}var environmentV8Version,hasRequiredEnvironmentV8Version;function requireEnvironmentV8Version(){if(hasRequiredEnvironmentV8Version)return environmentV8Version;hasRequiredEnvironmentV8Version=1;var t=requireGlobalThis(),e=requireEnvironmentUserAgent(),r=t.process,i=t.Deno,n=r&&r.versions||i&&i.version,s=n&&n.v8,o,a;return s&&(o=s.split("."),a=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!a&&e&&(o=e.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=e.match(/Chrome\/(\d+)/),o&&(a=+o[1]))),environmentV8Version=a,environmentV8Version}var symbolConstructorDetection,hasRequiredSymbolConstructorDetection;function requireSymbolConstructorDetection(){if(hasRequiredSymbolConstructorDetection)return symbolConstructorDetection;hasRequiredSymbolConstructorDetection=1;var t=requireEnvironmentV8Version(),e=requireFails(),r=requireGlobalThis(),i=r.String;return symbolConstructorDetection=!!Object.getOwnPropertySymbols&&!e(function(){var n=Symbol("symbol detection");return!i(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&t&&t<41}),symbolConstructorDetection}var useSymbolAsUid,hasRequiredUseSymbolAsUid;function requireUseSymbolAsUid(){if(hasRequiredUseSymbolAsUid)return useSymbolAsUid;hasRequiredUseSymbolAsUid=1;var t=requireSymbolConstructorDetection();return useSymbolAsUid=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",useSymbolAsUid}var isSymbol,hasRequiredIsSymbol;function requireIsSymbol(){if(hasRequiredIsSymbol)return isSymbol;hasRequiredIsSymbol=1;var t=requireGetBuiltIn(),e=requireIsCallable(),r=requireObjectIsPrototypeOf(),i=requireUseSymbolAsUid(),n=Object;return isSymbol=i?function(s){return typeof s=="symbol"}:function(s){var o=t("Symbol");return e(o)&&r(o.prototype,n(s))},isSymbol}var tryToString,hasRequiredTryToString;function requireTryToString(){if(hasRequiredTryToString)return tryToString;hasRequiredTryToString=1;var t=String;return tryToString=function(e){try{return t(e)}catch{return"Object"}},tryToString}var aCallable,hasRequiredACallable;function requireACallable(){if(hasRequiredACallable)return aCallable;hasRequiredACallable=1;var t=requireIsCallable(),e=requireTryToString(),r=TypeError;return aCallable=function(i){if(t(i))return i;throw new r(e(i)+" is not a function")},aCallable}var getMethod,hasRequiredGetMethod;function requireGetMethod(){if(hasRequiredGetMethod)return getMethod;hasRequiredGetMethod=1;var t=requireACallable(),e=requireIsNullOrUndefined();return getMethod=function(r,i){var n=r[i];return e(n)?void 0:t(n)},getMethod}var ordinaryToPrimitive,hasRequiredOrdinaryToPrimitive;function requireOrdinaryToPrimitive(){if(hasRequiredOrdinaryToPrimitive)return ordinaryToPrimitive;hasRequiredOrdinaryToPrimitive=1;var t=requireFunctionCall(),e=requireIsCallable(),r=requireIsObject(),i=TypeError;return ordinaryToPrimitive=function(n,s){var o,a;if(s==="string"&&e(o=n.toString)&&!r(a=t(o,n))||e(o=n.valueOf)&&!r(a=t(o,n))||s!=="string"&&e(o=n.toString)&&!r(a=t(o,n)))return a;throw new i("Can't convert object to primitive value")},ordinaryToPrimitive}var sharedStore={exports:{}},isPure,hasRequiredIsPure;function requireIsPure(){return hasRequiredIsPure||(hasRequiredIsPure=1,isPure=!1),isPure}var defineGlobalProperty,hasRequiredDefineGlobalProperty;function requireDefineGlobalProperty(){if(hasRequiredDefineGlobalProperty)return defineGlobalProperty;hasRequiredDefineGlobalProperty=1;var t=requireGlobalThis(),e=Object.defineProperty;return defineGlobalProperty=function(r,i){try{e(t,r,{value:i,configurable:!0,writable:!0})}catch{t[r]=i}return i},defineGlobalProperty}var hasRequiredSharedStore;function requireSharedStore(){if(hasRequiredSharedStore)return sharedStore.exports;hasRequiredSharedStore=1;var t=requireIsPure(),e=requireGlobalThis(),r=requireDefineGlobalProperty(),i="__core-js_shared__",n=sharedStore.exports=e[i]||r(i,{});return(n.versions||(n.versions=[])).push({version:"3.45.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.0/LICENSE",source:"https://github.com/zloirock/core-js"}),sharedStore.exports}var shared,hasRequiredShared;function requireShared(){if(hasRequiredShared)return shared;hasRequiredShared=1;var t=requireSharedStore();return shared=function(e,r){return t[e]||(t[e]=r||{})},shared}var toObject$1,hasRequiredToObject;function requireToObject(){if(hasRequiredToObject)return toObject$1;hasRequiredToObject=1;var t=requireRequireObjectCoercible(),e=Object;return toObject$1=function(r){return e(t(r))},toObject$1}var hasOwnProperty_1,hasRequiredHasOwnProperty;function requireHasOwnProperty(){if(hasRequiredHasOwnProperty)return hasOwnProperty_1;hasRequiredHasOwnProperty=1;var t=requireFunctionUncurryThis(),e=requireToObject(),r=t({}.hasOwnProperty);return hasOwnProperty_1=Object.hasOwn||function(n,s){return r(e(n),s)},hasOwnProperty_1}var uid,hasRequiredUid;function requireUid(){if(hasRequiredUid)return uid;hasRequiredUid=1;var t=requireFunctionUncurryThis(),e=0,r=Math.random(),i=t(1.1.toString);return uid=function(n){return"Symbol("+(n===void 0?"":n)+")_"+i(++e+r,36)},uid}var wellKnownSymbol,hasRequiredWellKnownSymbol;function requireWellKnownSymbol(){if(hasRequiredWellKnownSymbol)return wellKnownSymbol;hasRequiredWellKnownSymbol=1;var t=requireGlobalThis(),e=requireShared(),r=requireHasOwnProperty(),i=requireUid(),n=requireSymbolConstructorDetection(),s=requireUseSymbolAsUid(),o=t.Symbol,a=e("wks"),l=s?o.for||o:o&&o.withoutSetter||i;return wellKnownSymbol=function(c){return r(a,c)||(a[c]=n&&r(o,c)?o[c]:l("Symbol."+c)),a[c]},wellKnownSymbol}var toPrimitive,hasRequiredToPrimitive;function requireToPrimitive(){if(hasRequiredToPrimitive)return toPrimitive;hasRequiredToPrimitive=1;var t=requireFunctionCall(),e=requireIsObject(),r=requireIsSymbol(),i=requireGetMethod(),n=requireOrdinaryToPrimitive(),s=requireWellKnownSymbol(),o=TypeError,a=s("toPrimitive");return toPrimitive=function(l,c){if(!e(l)||r(l))return l;var u=i(l,a),d;if(u){if(c===void 0&&(c="default"),d=t(u,l,c),!e(d)||r(d))return d;throw new o("Can't convert object to primitive value")}return c===void 0&&(c="number"),n(l,c)},toPrimitive}var toPropertyKey,hasRequiredToPropertyKey;function requireToPropertyKey(){if(hasRequiredToPropertyKey)return toPropertyKey;hasRequiredToPropertyKey=1;var t=requireToPrimitive(),e=requireIsSymbol();return toPropertyKey=function(r){var i=t(r,"string");return e(i)?i:i+""},toPropertyKey}var documentCreateElement,hasRequiredDocumentCreateElement;function requireDocumentCreateElement(){if(hasRequiredDocumentCreateElement)return documentCreateElement;hasRequiredDocumentCreateElement=1;var t=requireGlobalThis(),e=requireIsObject(),r=t.document,i=e(r)&&e(r.createElement);return documentCreateElement=function(n){return i?r.createElement(n):{}},documentCreateElement}var ie8DomDefine,hasRequiredIe8DomDefine;function requireIe8DomDefine(){if(hasRequiredIe8DomDefine)return ie8DomDefine;hasRequiredIe8DomDefine=1;var t=requireDescriptors(),e=requireFails(),r=requireDocumentCreateElement();return ie8DomDefine=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),ie8DomDefine}var hasRequiredObjectGetOwnPropertyDescriptor;function requireObjectGetOwnPropertyDescriptor(){if(hasRequiredObjectGetOwnPropertyDescriptor)return objectGetOwnPropertyDescriptor;hasRequiredObjectGetOwnPropertyDescriptor=1;var t=requireDescriptors(),e=requireFunctionCall(),r=requireObjectPropertyIsEnumerable(),i=requireCreatePropertyDescriptor(),n=requireToIndexedObject(),s=requireToPropertyKey(),o=requireHasOwnProperty(),a=requireIe8DomDefine(),l=Object.getOwnPropertyDescriptor;return objectGetOwnPropertyDescriptor.f=t?l:function(u,d){if(u=n(u),d=s(d),a)try{return l(u,d)}catch{}if(o(u,d))return i(!e(r.f,u,d),u[d])},objectGetOwnPropertyDescriptor}var objectDefineProperty={},v8PrototypeDefineBug,hasRequiredV8PrototypeDefineBug;function requireV8PrototypeDefineBug(){if(hasRequiredV8PrototypeDefineBug)return v8PrototypeDefineBug;hasRequiredV8PrototypeDefineBug=1;var t=requireDescriptors(),e=requireFails();return v8PrototypeDefineBug=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),v8PrototypeDefineBug}var anObject,hasRequiredAnObject;function requireAnObject(){if(hasRequiredAnObject)return anObject;hasRequiredAnObject=1;var t=requireIsObject(),e=String,r=TypeError;return anObject=function(i){if(t(i))return i;throw new r(e(i)+" is not an object")},anObject}var hasRequiredObjectDefineProperty;function requireObjectDefineProperty(){if(hasRequiredObjectDefineProperty)return objectDefineProperty;hasRequiredObjectDefineProperty=1;var t=requireDescriptors(),e=requireIe8DomDefine(),r=requireV8PrototypeDefineBug(),i=requireAnObject(),n=requireToPropertyKey(),s=TypeError,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",c="configurable",u="writable";return objectDefineProperty.f=t?r?function(h,f,g){if(i(h),f=n(f),i(g),typeof h=="function"&&f==="prototype"&&"value"in g&&u in g&&!g[u]){var m=a(h,f);m&&m[u]&&(h[f]=g.value,g={configurable:c in g?g[c]:m[c],enumerable:l in g?g[l]:m[l],writable:!1})}return o(h,f,g)}:o:function(h,f,g){if(i(h),f=n(f),i(g),e)try{return o(h,f,g)}catch{}if("get"in g||"set"in g)throw new s("Accessors not supported");return"value"in g&&(h[f]=g.value),h},objectDefineProperty}var createNonEnumerableProperty,hasRequiredCreateNonEnumerableProperty;function requireCreateNonEnumerableProperty(){if(hasRequiredCreateNonEnumerableProperty)return createNonEnumerableProperty;hasRequiredCreateNonEnumerableProperty=1;var t=requireDescriptors(),e=requireObjectDefineProperty(),r=requireCreatePropertyDescriptor();return createNonEnumerableProperty=t?function(i,n,s){return e.f(i,n,r(1,s))}:function(i,n,s){return i[n]=s,i},createNonEnumerableProperty}var makeBuiltIn={exports:{}},functionName,hasRequiredFunctionName;function requireFunctionName(){if(hasRequiredFunctionName)return functionName;hasRequiredFunctionName=1;var t=requireDescriptors(),e=requireHasOwnProperty(),r=Function.prototype,i=t&&Object.getOwnPropertyDescriptor,n=e(r,"name"),s=n&&(function(){}).name==="something",o=n&&(!t||t&&i(r,"name").configurable);return functionName={EXISTS:n,PROPER:s,CONFIGURABLE:o},functionName}var inspectSource,hasRequiredInspectSource;function requireInspectSource(){if(hasRequiredInspectSource)return inspectSource;hasRequiredInspectSource=1;var t=requireFunctionUncurryThis(),e=requireIsCallable(),r=requireSharedStore(),i=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(n){return i(n)}),inspectSource=r.inspectSource,inspectSource}var weakMapBasicDetection,hasRequiredWeakMapBasicDetection;function requireWeakMapBasicDetection(){if(hasRequiredWeakMapBasicDetection)return weakMapBasicDetection;hasRequiredWeakMapBasicDetection=1;var t=requireGlobalThis(),e=requireIsCallable(),r=t.WeakMap;return weakMapBasicDetection=e(r)&&/native code/.test(String(r)),weakMapBasicDetection}var sharedKey,hasRequiredSharedKey;function requireSharedKey(){if(hasRequiredSharedKey)return sharedKey;hasRequiredSharedKey=1;var t=requireShared(),e=requireUid(),r=t("keys");return sharedKey=function(i){return r[i]||(r[i]=e(i))},sharedKey}var hiddenKeys,hasRequiredHiddenKeys;function requireHiddenKeys(){return hasRequiredHiddenKeys||(hasRequiredHiddenKeys=1,hiddenKeys={}),hiddenKeys}var internalState,hasRequiredInternalState;function requireInternalState(){if(hasRequiredInternalState)return internalState;hasRequiredInternalState=1;var t=requireWeakMapBasicDetection(),e=requireGlobalThis(),r=requireIsObject(),i=requireCreateNonEnumerableProperty(),n=requireHasOwnProperty(),s=requireSharedStore(),o=requireSharedKey(),a=requireHiddenKeys(),l="Object already initialized",c=e.TypeError,u=e.WeakMap,d,h,f,g=function(v){return f(v)?h(v):d(v,{})},m=function(v){return function(E){var $;if(!r(E)||($=h(E)).type!==v)throw new c("Incompatible receiver, "+v+" required");return $}};if(t||s.state){var C=s.state||(s.state=new u);C.get=C.get,C.has=C.has,C.set=C.set,d=function(v,E){if(C.has(v))throw new c(l);return E.facade=v,C.set(v,E),E},h=function(v){return C.get(v)||{}},f=function(v){return C.has(v)}}else{var y=o("state");a[y]=!0,d=function(v,E){if(n(v,y))throw new c(l);return E.facade=v,i(v,y,E),E},h=function(v){return n(v,y)?v[y]:{}},f=function(v){return n(v,y)}}return internalState={set:d,get:h,has:f,enforce:g,getterFor:m},internalState}var hasRequiredMakeBuiltIn;function requireMakeBuiltIn(){if(hasRequiredMakeBuiltIn)return makeBuiltIn.exports;hasRequiredMakeBuiltIn=1;var t=requireFunctionUncurryThis(),e=requireFails(),r=requireIsCallable(),i=requireHasOwnProperty(),n=requireDescriptors(),s=requireFunctionName().CONFIGURABLE,o=requireInspectSource(),a=requireInternalState(),l=a.enforce,c=a.get,u=String,d=Object.defineProperty,h=t("".slice),f=t("".replace),g=t([].join),m=n&&!e(function(){return d(function(){},"length",{value:8}).length!==8}),C=String(String).split("String"),y=makeBuiltIn.exports=function(v,E,$){h(u(E),0,7)==="Symbol("&&(E="["+f(u(E),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),$&&$.getter&&(E="get "+E),$&&$.setter&&(E="set "+E),(!i(v,"name")||s&&v.name!==E)&&(n?d(v,"name",{value:E,configurable:!0}):v.name=E),m&&$&&i($,"arity")&&v.length!==$.arity&&d(v,"length",{value:$.arity});try{$&&i($,"constructor")&&$.constructor?n&&d(v,"prototype",{writable:!1}):v.prototype&&(v.prototype=void 0)}catch{}var O=l(v);return i(O,"source")||(O.source=g(C,typeof E=="string"?E:"")),v};return Function.prototype.toString=y(function(){return r(this)&&c(this).source||o(this)},"toString"),makeBuiltIn.exports}var defineBuiltIn,hasRequiredDefineBuiltIn;function requireDefineBuiltIn(){if(hasRequiredDefineBuiltIn)return defineBuiltIn;hasRequiredDefineBuiltIn=1;var t=requireIsCallable(),e=requireObjectDefineProperty(),r=requireMakeBuiltIn(),i=requireDefineGlobalProperty();return defineBuiltIn=function(n,s,o,a){a||(a={});var l=a.enumerable,c=a.name!==void 0?a.name:s;if(t(o)&&r(o,c,a),a.global)l?n[s]=o:i(s,o);else{try{a.unsafe?n[s]&&(l=!0):delete n[s]}catch{}l?n[s]=o:e.f(n,s,{value:o,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return n},defineBuiltIn}var objectGetOwnPropertyNames={},mathTrunc,hasRequiredMathTrunc;function requireMathTrunc(){if(hasRequiredMathTrunc)return mathTrunc;hasRequiredMathTrunc=1;var t=Math.ceil,e=Math.floor;return mathTrunc=Math.trunc||function(i){var n=+i;return(n>0?e:t)(n)},mathTrunc}var toIntegerOrInfinity,hasRequiredToIntegerOrInfinity;function requireToIntegerOrInfinity(){if(hasRequiredToIntegerOrInfinity)return toIntegerOrInfinity;hasRequiredToIntegerOrInfinity=1;var t=requireMathTrunc();return toIntegerOrInfinity=function(e){var r=+e;return r!==r||r===0?0:t(r)},toIntegerOrInfinity}var toAbsoluteIndex,hasRequiredToAbsoluteIndex;function requireToAbsoluteIndex(){if(hasRequiredToAbsoluteIndex)return toAbsoluteIndex;hasRequiredToAbsoluteIndex=1;var t=requireToIntegerOrInfinity(),e=Math.max,r=Math.min;return toAbsoluteIndex=function(i,n){var s=t(i);return s<0?e(s+n,0):r(s,n)},toAbsoluteIndex}var toLength,hasRequiredToLength;function requireToLength(){if(hasRequiredToLength)return toLength;hasRequiredToLength=1;var t=requireToIntegerOrInfinity(),e=Math.min;return toLength=function(r){var i=t(r);return i>0?e(i,9007199254740991):0},toLength}var lengthOfArrayLike,hasRequiredLengthOfArrayLike;function requireLengthOfArrayLike(){if(hasRequiredLengthOfArrayLike)return lengthOfArrayLike;hasRequiredLengthOfArrayLike=1;var t=requireToLength();return lengthOfArrayLike=function(e){return t(e.length)},lengthOfArrayLike}var arrayIncludes,hasRequiredArrayIncludes;function requireArrayIncludes(){if(hasRequiredArrayIncludes)return arrayIncludes;hasRequiredArrayIncludes=1;var t=requireToIndexedObject(),e=requireToAbsoluteIndex(),r=requireLengthOfArrayLike(),i=function(n){return function(s,o,a){var l=t(s),c=r(l);if(c===0)return!n&&-1;var u=e(a,c),d;if(n&&o!==o){for(;c>u;)if(d=l[u++],d!==d)return!0}else for(;c>u;u++)if((n||u in l)&&l[u]===o)return n||u||0;return!n&&-1}};return arrayIncludes={includes:i(!0),indexOf:i(!1)},arrayIncludes}var objectKeysInternal,hasRequiredObjectKeysInternal;function requireObjectKeysInternal(){if(hasRequiredObjectKeysInternal)return objectKeysInternal;hasRequiredObjectKeysInternal=1;var t=requireFunctionUncurryThis(),e=requireHasOwnProperty(),r=requireToIndexedObject(),i=requireArrayIncludes().indexOf,n=requireHiddenKeys(),s=t([].push);return objectKeysInternal=function(o,a){var l=r(o),c=0,u=[],d;for(d in l)!e(n,d)&&e(l,d)&&s(u,d);for(;a.length>c;)e(l,d=a[c++])&&(~i(u,d)||s(u,d));return u},objectKeysInternal}var enumBugKeys,hasRequiredEnumBugKeys;function requireEnumBugKeys(){return hasRequiredEnumBugKeys||(hasRequiredEnumBugKeys=1,enumBugKeys=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),enumBugKeys}var hasRequiredObjectGetOwnPropertyNames;function requireObjectGetOwnPropertyNames(){if(hasRequiredObjectGetOwnPropertyNames)return objectGetOwnPropertyNames;hasRequiredObjectGetOwnPropertyNames=1;var t=requireObjectKeysInternal(),e=requireEnumBugKeys(),r=e.concat("length","prototype");return objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(n){return t(n,r)},objectGetOwnPropertyNames}var objectGetOwnPropertySymbols={},hasRequiredObjectGetOwnPropertySymbols;function requireObjectGetOwnPropertySymbols(){return hasRequiredObjectGetOwnPropertySymbols||(hasRequiredObjectGetOwnPropertySymbols=1,objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols),objectGetOwnPropertySymbols}var ownKeys,hasRequiredOwnKeys;function requireOwnKeys(){if(hasRequiredOwnKeys)return ownKeys;hasRequiredOwnKeys=1;var t=requireGetBuiltIn(),e=requireFunctionUncurryThis(),r=requireObjectGetOwnPropertyNames(),i=requireObjectGetOwnPropertySymbols(),n=requireAnObject(),s=e([].concat);return ownKeys=t("Reflect","ownKeys")||function(a){var l=r.f(n(a)),c=i.f;return c?s(l,c(a)):l},ownKeys}var copyConstructorProperties,hasRequiredCopyConstructorProperties;function requireCopyConstructorProperties(){if(hasRequiredCopyConstructorProperties)return copyConstructorProperties;hasRequiredCopyConstructorProperties=1;var t=requireHasOwnProperty(),e=requireOwnKeys(),r=requireObjectGetOwnPropertyDescriptor(),i=requireObjectDefineProperty();return copyConstructorProperties=function(n,s,o){for(var a=e(s),l=i.f,c=r.f,u=0;u<a.length;u++){var d=a[u];!t(n,d)&&!(o&&t(o,d))&&l(n,d,c(s,d))}},copyConstructorProperties}var isForced_1,hasRequiredIsForced;function requireIsForced(){if(hasRequiredIsForced)return isForced_1;hasRequiredIsForced=1;var t=requireFails(),e=requireIsCallable(),r=/#|\.prototype\./,i=function(l,c){var u=s[n(l)];return u===a?!0:u===o?!1:e(c)?t(c):!!c},n=i.normalize=function(l){return String(l).replace(r,".").toLowerCase()},s=i.data={},o=i.NATIVE="N",a=i.POLYFILL="P";return isForced_1=i,isForced_1}var _export,hasRequired_export;function require_export(){if(hasRequired_export)return _export;hasRequired_export=1;var t=requireGlobalThis(),e=requireObjectGetOwnPropertyDescriptor().f,r=requireCreateNonEnumerableProperty(),i=requireDefineBuiltIn(),n=requireDefineGlobalProperty(),s=requireCopyConstructorProperties(),o=requireIsForced();return _export=function(a,l){var c=a.target,u=a.global,d=a.stat,h,f,g,m,C,y;if(u?f=t:d?f=t[c]||n(c,{}):f=t[c]&&t[c].prototype,f)for(g in l){if(C=l[g],a.dontCallGetSet?(y=e(f,g),m=y&&y.value):m=f[g],h=o(u?g:c+(d?".":"#")+g,a.forced),!h&&m!==void 0){if(typeof C==typeof m)continue;s(C,m)}(a.sham||m&&m.sham)&&r(C,"sham",!0),i(f,g,C,a)}},_export}var functionApply,hasRequiredFunctionApply;function requireFunctionApply(){if(hasRequiredFunctionApply)return functionApply;hasRequiredFunctionApply=1;var t=requireFunctionBindNative(),e=Function.prototype,r=e.apply,i=e.call;return functionApply=typeof Reflect=="object"&&Reflect.apply||(t?i.bind(r):function(){return i.apply(r,arguments)}),functionApply}var functionUncurryThisAccessor,hasRequiredFunctionUncurryThisAccessor;function requireFunctionUncurryThisAccessor(){if(hasRequiredFunctionUncurryThisAccessor)return functionUncurryThisAccessor;hasRequiredFunctionUncurryThisAccessor=1;var t=requireFunctionUncurryThis(),e=requireACallable();return functionUncurryThisAccessor=function(r,i,n){try{return t(e(Object.getOwnPropertyDescriptor(r,i)[n]))}catch{}},functionUncurryThisAccessor}var isPossiblePrototype,hasRequiredIsPossiblePrototype;function requireIsPossiblePrototype(){if(hasRequiredIsPossiblePrototype)return isPossiblePrototype;hasRequiredIsPossiblePrototype=1;var t=requireIsObject();return isPossiblePrototype=function(e){return t(e)||e===null},isPossiblePrototype}var aPossiblePrototype,hasRequiredAPossiblePrototype;function requireAPossiblePrototype(){if(hasRequiredAPossiblePrototype)return aPossiblePrototype;hasRequiredAPossiblePrototype=1;var t=requireIsPossiblePrototype(),e=String,r=TypeError;return aPossiblePrototype=function(i){if(t(i))return i;throw new r("Can't set "+e(i)+" as a prototype")},aPossiblePrototype}var objectSetPrototypeOf,hasRequiredObjectSetPrototypeOf;function requireObjectSetPrototypeOf(){if(hasRequiredObjectSetPrototypeOf)return objectSetPrototypeOf;hasRequiredObjectSetPrototypeOf=1;var t=requireFunctionUncurryThisAccessor(),e=requireIsObject(),r=requireRequireObjectCoercible(),i=requireAPossiblePrototype();return objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var n=!1,s={},o;try{o=t(Object.prototype,"__proto__","set"),o(s,[]),n=s instanceof Array}catch{}return function(l,c){return r(l),i(c),e(l)&&(n?o(l,c):l.__proto__=c),l}}():void 0),objectSetPrototypeOf}var proxyAccessor,hasRequiredProxyAccessor;function requireProxyAccessor(){if(hasRequiredProxyAccessor)return proxyAccessor;hasRequiredProxyAccessor=1;var t=requireObjectDefineProperty().f;return proxyAccessor=function(e,r,i){i in e||t(e,i,{configurable:!0,get:function(){return r[i]},set:function(n){r[i]=n}})},proxyAccessor}var inheritIfRequired,hasRequiredInheritIfRequired;function requireInheritIfRequired(){if(hasRequiredInheritIfRequired)return inheritIfRequired;hasRequiredInheritIfRequired=1;var t=requireIsCallable(),e=requireIsObject(),r=requireObjectSetPrototypeOf();return inheritIfRequired=function(i,n,s){var o,a;return r&&t(o=n.constructor)&&o!==s&&e(a=o.prototype)&&a!==s.prototype&&r(i,a),i},inheritIfRequired}var toStringTagSupport,hasRequiredToStringTagSupport;function requireToStringTagSupport(){if(hasRequiredToStringTagSupport)return toStringTagSupport;hasRequiredToStringTagSupport=1;var t=requireWellKnownSymbol(),e=t("toStringTag"),r={};return r[e]="z",toStringTagSupport=String(r)==="[object z]",toStringTagSupport}var classof,hasRequiredClassof;function requireClassof(){if(hasRequiredClassof)return classof;hasRequiredClassof=1;var t=requireToStringTagSupport(),e=requireIsCallable(),r=requireClassofRaw(),i=requireWellKnownSymbol(),n=i("toStringTag"),s=Object,o=r(function(){return arguments}())==="Arguments",a=function(l,c){try{return l[c]}catch{}};return classof=t?r:function(l){var c,u,d;return l===void 0?"Undefined":l===null?"Null":typeof(u=a(c=s(l),n))=="string"?u:o?r(c):(d=r(c))==="Object"&&e(c.callee)?"Arguments":d},classof}var toString$1,hasRequiredToString;function requireToString(){if(hasRequiredToString)return toString$1;hasRequiredToString=1;var t=requireClassof(),e=String;return toString$1=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},toString$1}var normalizeStringArgument,hasRequiredNormalizeStringArgument;function requireNormalizeStringArgument(){if(hasRequiredNormalizeStringArgument)return normalizeStringArgument;hasRequiredNormalizeStringArgument=1;var t=requireToString();return normalizeStringArgument=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},normalizeStringArgument}var installErrorCause,hasRequiredInstallErrorCause;function requireInstallErrorCause(){if(hasRequiredInstallErrorCause)return installErrorCause;hasRequiredInstallErrorCause=1;var t=requireIsObject(),e=requireCreateNonEnumerableProperty();return installErrorCause=function(r,i){t(i)&&"cause"in i&&e(r,"cause",i.cause)},installErrorCause}var errorStackClear,hasRequiredErrorStackClear;function requireErrorStackClear(){if(hasRequiredErrorStackClear)return errorStackClear;hasRequiredErrorStackClear=1;var t=requireFunctionUncurryThis(),e=Error,r=t("".replace),i=function(o){return String(new e(o).stack)}("zxcasd"),n=/\n\s*at [^:]*:[^\n]*/,s=n.test(i);return errorStackClear=function(o,a){if(s&&typeof o=="string"&&!e.prepareStackTrace)for(;a--;)o=r(o,n,"");return o},errorStackClear}var errorStackInstallable,hasRequiredErrorStackInstallable;function requireErrorStackInstallable(){if(hasRequiredErrorStackInstallable)return errorStackInstallable;hasRequiredErrorStackInstallable=1;var t=requireFails(),e=requireCreatePropertyDescriptor();return errorStackInstallable=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),errorStackInstallable}var errorStackInstall,hasRequiredErrorStackInstall;function requireErrorStackInstall(){if(hasRequiredErrorStackInstall)return errorStackInstall;hasRequiredErrorStackInstall=1;var t=requireCreateNonEnumerableProperty(),e=requireErrorStackClear(),r=requireErrorStackInstallable(),i=Error.captureStackTrace;return errorStackInstall=function(n,s,o,a){r&&(i?i(n,s):t(n,"stack",e(o,a)))},errorStackInstall}var wrapErrorConstructorWithCause,hasRequiredWrapErrorConstructorWithCause;function requireWrapErrorConstructorWithCause(){if(hasRequiredWrapErrorConstructorWithCause)return wrapErrorConstructorWithCause;hasRequiredWrapErrorConstructorWithCause=1;var t=requireGetBuiltIn(),e=requireHasOwnProperty(),r=requireCreateNonEnumerableProperty(),i=requireObjectIsPrototypeOf(),n=requireObjectSetPrototypeOf(),s=requireCopyConstructorProperties(),o=requireProxyAccessor(),a=requireInheritIfRequired(),l=requireNormalizeStringArgument(),c=requireInstallErrorCause(),u=requireErrorStackInstall(),d=requireDescriptors(),h=requireIsPure();return wrapErrorConstructorWithCause=function(f,g,m,C){var y="stackTraceLimit",v=C?2:1,E=f.split("."),$=E[E.length-1],O=t.apply(null,E);if(O){var P=O.prototype;if(!h&&e(P,"cause")&&delete P.cause,!m)return O;var I=t("Error"),W=g(function(q,M){var Y=l(C?M:q,void 0),z=C?new O(q):new O;return Y!==void 0&&r(z,"message",Y),u(z,W,z.stack,2),this&&i(P,this)&&a(z,this,W),arguments.length>v&&c(z,arguments[v]),z});if(W.prototype=P,$!=="Error"?n?n(W,I):s(W,I,{name:!0}):d&&y in O&&(o(W,O,y),o(W,O,"prepareStackTrace")),s(W,O),!h)try{P.name!==$&&r(P,"name",$),P.constructor=W}catch{}return W}},wrapErrorConstructorWithCause}var hasRequiredEs_error_cause;function requireEs_error_cause(){if(hasRequiredEs_error_cause)return es_error_cause;hasRequiredEs_error_cause=1;var t=require_export(),e=requireGlobalThis(),r=requireFunctionApply(),i=requireWrapErrorConstructorWithCause(),n="WebAssembly",s=e[n],o=new Error("e",{cause:7}).cause!==7,a=function(c,u){var d={};d[c]=i(c,u,o),t({global:!0,constructor:!0,arity:1,forced:o},d)},l=function(c,u){if(s&&s[c]){var d={};d[c]=i(n+"."+c,u,o),t({target:n,stat:!0,constructor:!0,arity:1,forced:o},d)}};return a("Error",function(c){return function(d){return r(c,this,arguments)}}),a("EvalError",function(c){return function(d){return r(c,this,arguments)}}),a("RangeError",function(c){return function(d){return r(c,this,arguments)}}),a("ReferenceError",function(c){return function(d){return r(c,this,arguments)}}),a("SyntaxError",function(c){return function(d){return r(c,this,arguments)}}),a("TypeError",function(c){return function(d){return r(c,this,arguments)}}),a("URIError",function(c){return function(d){return r(c,this,arguments)}}),l("CompileError",function(c){return function(d){return r(c,this,arguments)}}),l("LinkError",function(c){return function(d){return r(c,this,arguments)}}),l("RuntimeError",function(c){return function(d){return r(c,this,arguments)}}),es_error_cause}requireEs_error_cause();var es_array_push={},isArray$2,hasRequiredIsArray;function requireIsArray(){if(hasRequiredIsArray)return isArray$2;hasRequiredIsArray=1;var t=requireClassofRaw();return isArray$2=Array.isArray||function(r){return t(r)==="Array"},isArray$2}var arraySetLength,hasRequiredArraySetLength;function requireArraySetLength(){if(hasRequiredArraySetLength)return arraySetLength;hasRequiredArraySetLength=1;var t=requireDescriptors(),e=requireIsArray(),r=TypeError,i=Object.getOwnPropertyDescriptor,n=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}}();return arraySetLength=n?function(s,o){if(e(s)&&!i(s,"length").writable)throw new r("Cannot set read only .length");return s.length=o}:function(s,o){return s.length=o},arraySetLength}var doesNotExceedSafeInteger,hasRequiredDoesNotExceedSafeInteger;function requireDoesNotExceedSafeInteger(){if(hasRequiredDoesNotExceedSafeInteger)return doesNotExceedSafeInteger;hasRequiredDoesNotExceedSafeInteger=1;var t=TypeError,e=9007199254740991;return doesNotExceedSafeInteger=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},doesNotExceedSafeInteger}var hasRequiredEs_array_push;function requireEs_array_push(){if(hasRequiredEs_array_push)return es_array_push;hasRequiredEs_array_push=1;var t=require_export(),e=requireToObject(),r=requireLengthOfArrayLike(),i=requireArraySetLength(),n=requireDoesNotExceedSafeInteger(),s=requireFails(),o=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(c){return c instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(u){var d=e(this),h=r(d),f=arguments.length;n(h+f);for(var g=0;g<f;g++)d[h]=arguments[g],h++;return i(d,h),h}}),es_array_push}requireEs_array_push();var es_object_fromEntries={},functionUncurryThisClause,hasRequiredFunctionUncurryThisClause;function requireFunctionUncurryThisClause(){if(hasRequiredFunctionUncurryThisClause)return functionUncurryThisClause;hasRequiredFunctionUncurryThisClause=1;var t=requireClassofRaw(),e=requireFunctionUncurryThis();return functionUncurryThisClause=function(r){if(t(r)==="Function")return e(r)},functionUncurryThisClause}var functionBindContext,hasRequiredFunctionBindContext;function requireFunctionBindContext(){if(hasRequiredFunctionBindContext)return functionBindContext;hasRequiredFunctionBindContext=1;var t=requireFunctionUncurryThisClause(),e=requireACallable(),r=requireFunctionBindNative(),i=t(t.bind);return functionBindContext=function(n,s){return e(n),s===void 0?n:r?i(n,s):function(){return n.apply(s,arguments)}},functionBindContext}var iterators,hasRequiredIterators;function requireIterators(){return hasRequiredIterators||(hasRequiredIterators=1,iterators={}),iterators}var isArrayIteratorMethod,hasRequiredIsArrayIteratorMethod;function requireIsArrayIteratorMethod(){if(hasRequiredIsArrayIteratorMethod)return isArrayIteratorMethod;hasRequiredIsArrayIteratorMethod=1;var t=requireWellKnownSymbol(),e=requireIterators(),r=t("iterator"),i=Array.prototype;return isArrayIteratorMethod=function(n){return n!==void 0&&(e.Array===n||i[r]===n)},isArrayIteratorMethod}var getIteratorMethod,hasRequiredGetIteratorMethod;function requireGetIteratorMethod(){if(hasRequiredGetIteratorMethod)return getIteratorMethod;hasRequiredGetIteratorMethod=1;var t=requireClassof(),e=requireGetMethod(),r=requireIsNullOrUndefined(),i=requireIterators(),n=requireWellKnownSymbol(),s=n("iterator");return getIteratorMethod=function(o){if(!r(o))return e(o,s)||e(o,"@@iterator")||i[t(o)]},getIteratorMethod}var getIterator,hasRequiredGetIterator;function requireGetIterator(){if(hasRequiredGetIterator)return getIterator;hasRequiredGetIterator=1;var t=requireFunctionCall(),e=requireACallable(),r=requireAnObject(),i=requireTryToString(),n=requireGetIteratorMethod(),s=TypeError;return getIterator=function(o,a){var l=arguments.length<2?n(o):a;if(e(l))return r(t(l,o));throw new s(i(o)+" is not iterable")},getIterator}var iteratorClose,hasRequiredIteratorClose;function requireIteratorClose(){if(hasRequiredIteratorClose)return iteratorClose;hasRequiredIteratorClose=1;var t=requireFunctionCall(),e=requireAnObject(),r=requireGetMethod();return iteratorClose=function(i,n,s){var o,a;e(i);try{if(o=r(i,"return"),!o){if(n==="throw")throw s;return s}o=t(o,i)}catch(l){a=!0,o=l}if(n==="throw")throw s;if(a)throw o;return e(o),s},iteratorClose}var iterate,hasRequiredIterate;function requireIterate(){if(hasRequiredIterate)return iterate;hasRequiredIterate=1;var t=requireFunctionBindContext(),e=requireFunctionCall(),r=requireAnObject(),i=requireTryToString(),n=requireIsArrayIteratorMethod(),s=requireLengthOfArrayLike(),o=requireObjectIsPrototypeOf(),a=requireGetIterator(),l=requireGetIteratorMethod(),c=requireIteratorClose(),u=TypeError,d=function(f,g){this.stopped=f,this.result=g},h=d.prototype;return iterate=function(f,g,m){var C=m&&m.that,y=!!(m&&m.AS_ENTRIES),v=!!(m&&m.IS_RECORD),E=!!(m&&m.IS_ITERATOR),$=!!(m&&m.INTERRUPTED),O=t(g,C),P,I,W,q,M,Y,z,Q=function(Z){return P&&c(P,"normal"),new d(!0,Z)},K=function(Z){return y?(r(Z),$?O(Z[0],Z[1],Q):O(Z[0],Z[1])):$?O(Z,Q):O(Z)};if(v)P=f.iterator;else if(E)P=f;else{if(I=l(f),!I)throw new u(i(f)+" is not iterable");if(n(I)){for(W=0,q=s(f);q>W;W++)if(M=K(f[W]),M&&o(h,M))return M;return new d(!1)}P=a(f,I)}for(Y=v?f.next:P.next;!(z=e(Y,P)).done;){try{M=K(z.value)}catch(Z){c(P,"throw",Z)}if(typeof M=="object"&&M&&o(h,M))return M}return new d(!1)},iterate}var createProperty,hasRequiredCreateProperty;function requireCreateProperty(){if(hasRequiredCreateProperty)return createProperty;hasRequiredCreateProperty=1;var t=requireDescriptors(),e=requireObjectDefineProperty(),r=requireCreatePropertyDescriptor();return createProperty=function(i,n,s){t?e.f(i,n,r(0,s)):i[n]=s},createProperty}var hasRequiredEs_object_fromEntries;function requireEs_object_fromEntries(){if(hasRequiredEs_object_fromEntries)return es_object_fromEntries;hasRequiredEs_object_fromEntries=1;var t=require_export(),e=requireIterate(),r=requireCreateProperty();return t({target:"Object",stat:!0},{fromEntries:function(n){var s={};return e(n,function(o,a){r(s,o,a)},{AS_ENTRIES:!0}),s}}),es_object_fromEntries}requireEs_object_fromEntries();var es_set_difference_v2={},setHelpers,hasRequiredSetHelpers;function requireSetHelpers(){if(hasRequiredSetHelpers)return setHelpers;hasRequiredSetHelpers=1;var t=requireFunctionUncurryThis(),e=Set.prototype;return setHelpers={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},setHelpers}var aSet,hasRequiredASet;function requireASet(){if(hasRequiredASet)return aSet;hasRequiredASet=1;var t=requireSetHelpers().has;return aSet=function(e){return t(e),e},aSet}var iterateSimple,hasRequiredIterateSimple;function requireIterateSimple(){if(hasRequiredIterateSimple)return iterateSimple;hasRequiredIterateSimple=1;var t=requireFunctionCall();return iterateSimple=function(e,r,i){for(var n=i?e:e.iterator,s=e.next,o,a;!(o=t(s,n)).done;)if(a=r(o.value),a!==void 0)return a},iterateSimple}var setIterate,hasRequiredSetIterate;function requireSetIterate(){if(hasRequiredSetIterate)return setIterate;hasRequiredSetIterate=1;var t=requireFunctionUncurryThis(),e=requireIterateSimple(),r=requireSetHelpers(),i=r.Set,n=r.proto,s=t(n.forEach),o=t(n.keys),a=o(new i).next;return setIterate=function(l,c,u){return u?e({iterator:o(l),next:a},c):s(l,c)},setIterate}var setClone,hasRequiredSetClone;function requireSetClone(){if(hasRequiredSetClone)return setClone;hasRequiredSetClone=1;var t=requireSetHelpers(),e=requireSetIterate(),r=t.Set,i=t.add;return setClone=function(n){var s=new r;return e(n,function(o){i(s,o)}),s},setClone}var setSize,hasRequiredSetSize;function requireSetSize(){if(hasRequiredSetSize)return setSize;hasRequiredSetSize=1;var t=requireFunctionUncurryThisAccessor(),e=requireSetHelpers();return setSize=t(e.proto,"size","get")||function(r){return r.size},setSize}var getIteratorDirect,hasRequiredGetIteratorDirect;function requireGetIteratorDirect(){return hasRequiredGetIteratorDirect||(hasRequiredGetIteratorDirect=1,getIteratorDirect=function(t){return{iterator:t,next:t.next,done:!1}}),getIteratorDirect}var getSetRecord,hasRequiredGetSetRecord;function requireGetSetRecord(){if(hasRequiredGetSetRecord)return getSetRecord;hasRequiredGetSetRecord=1;var t=requireACallable(),e=requireAnObject(),r=requireFunctionCall(),i=requireToIntegerOrInfinity(),n=requireGetIteratorDirect(),s="Invalid size",o=RangeError,a=TypeError,l=Math.max,c=function(u,d){this.set=u,this.size=l(d,0),this.has=t(u.has),this.keys=t(u.keys)};return c.prototype={getIterator:function(){return n(e(r(this.keys,this.set)))},includes:function(u){return r(this.has,this.set,u)}},getSetRecord=function(u){e(u);var d=+u.size;if(d!==d)throw new a(s);var h=i(d);if(h<0)throw new o(s);return new c(u,h)},getSetRecord}var setDifference,hasRequiredSetDifference;function requireSetDifference(){if(hasRequiredSetDifference)return setDifference;hasRequiredSetDifference=1;var t=requireASet(),e=requireSetHelpers(),r=requireSetClone(),i=requireSetSize(),n=requireGetSetRecord(),s=requireSetIterate(),o=requireIterateSimple(),a=e.has,l=e.remove;return setDifference=function(u){var d=t(this),h=n(u),f=r(d);return i(d)<=h.size?s(d,function(g){h.includes(g)&&l(f,g)}):o(h.getIterator(),function(g){a(f,g)&&l(f,g)}),f},setDifference}var setMethodAcceptSetLike,hasRequiredSetMethodAcceptSetLike;function requireSetMethodAcceptSetLike(){if(hasRequiredSetMethodAcceptSetLike)return setMethodAcceptSetLike;hasRequiredSetMethodAcceptSetLike=1;var t=requireGetBuiltIn(),e=function(i){return{size:i,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(i){return{size:i,has:function(){return!0},keys:function(){throw new Error("e")}}};return setMethodAcceptSetLike=function(i,n){var s=t("Set");try{new s()[i](e(0));try{return new s()[i](e(-1)),!1}catch{if(!n)return!0;try{return new s()[i](r(-1/0)),!1}catch{var o=new s;return o.add(1),o.add(2),n(o[i](r(1/0)))}}}catch{return!1}},setMethodAcceptSetLike}var hasRequiredEs_set_difference_v2;function requireEs_set_difference_v2(){if(hasRequiredEs_set_difference_v2)return es_set_difference_v2;hasRequiredEs_set_difference_v2=1;var t=require_export(),e=requireSetDifference(),r=requireFails(),i=requireSetMethodAcceptSetLike(),n=!i("difference",function(o){return o.size===0}),s=n||r(function(){var o={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var c=l++>1;return a.has(1)&&a.clear(),{done:c,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(o).size!==3});return t({target:"Set",proto:!0,real:!0,forced:s},{difference:e}),es_set_difference_v2}requireEs_set_difference_v2();var es_set_intersection_v2={},setIntersection,hasRequiredSetIntersection;function requireSetIntersection(){if(hasRequiredSetIntersection)return setIntersection;hasRequiredSetIntersection=1;var t=requireASet(),e=requireSetHelpers(),r=requireSetSize(),i=requireGetSetRecord(),n=requireSetIterate(),s=requireIterateSimple(),o=e.Set,a=e.add,l=e.has;return setIntersection=function(u){var d=t(this),h=i(u),f=new o;return r(d)>h.size?s(h.getIterator(),function(g){l(d,g)&&a(f,g)}):n(d,function(g){h.includes(g)&&a(f,g)}),f},setIntersection}var hasRequiredEs_set_intersection_v2;function requireEs_set_intersection_v2(){if(hasRequiredEs_set_intersection_v2)return es_set_intersection_v2;hasRequiredEs_set_intersection_v2=1;var t=require_export(),e=requireFails(),r=requireSetIntersection(),i=requireSetMethodAcceptSetLike(),n=!i("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:n},{intersection:r}),es_set_intersection_v2}requireEs_set_intersection_v2();var es_set_isDisjointFrom_v2={},setIsDisjointFrom,hasRequiredSetIsDisjointFrom;function requireSetIsDisjointFrom(){if(hasRequiredSetIsDisjointFrom)return setIsDisjointFrom;hasRequiredSetIsDisjointFrom=1;var t=requireASet(),e=requireSetHelpers().has,r=requireSetSize(),i=requireGetSetRecord(),n=requireSetIterate(),s=requireIterateSimple(),o=requireIteratorClose();return setIsDisjointFrom=function(l){var c=t(this),u=i(l);if(r(c)<=u.size)return n(c,function(h){if(u.includes(h))return!1},!0)!==!1;var d=u.getIterator();return s(d,function(h){if(e(c,h))return o(d,"normal",!1)})!==!1},setIsDisjointFrom}var hasRequiredEs_set_isDisjointFrom_v2;function requireEs_set_isDisjointFrom_v2(){if(hasRequiredEs_set_isDisjointFrom_v2)return es_set_isDisjointFrom_v2;hasRequiredEs_set_isDisjointFrom_v2=1;var t=require_export(),e=requireSetIsDisjointFrom(),r=requireSetMethodAcceptSetLike(),i=!r("isDisjointFrom",function(n){return!n});return t({target:"Set",proto:!0,real:!0,forced:i},{isDisjointFrom:e}),es_set_isDisjointFrom_v2}requireEs_set_isDisjointFrom_v2();var es_set_isSubsetOf_v2={},setIsSubsetOf,hasRequiredSetIsSubsetOf;function requireSetIsSubsetOf(){if(hasRequiredSetIsSubsetOf)return setIsSubsetOf;hasRequiredSetIsSubsetOf=1;var t=requireASet(),e=requireSetSize(),r=requireSetIterate(),i=requireGetSetRecord();return setIsSubsetOf=function(s){var o=t(this),a=i(s);return e(o)>a.size?!1:r(o,function(l){if(!a.includes(l))return!1},!0)!==!1},setIsSubsetOf}var hasRequiredEs_set_isSubsetOf_v2;function requireEs_set_isSubsetOf_v2(){if(hasRequiredEs_set_isSubsetOf_v2)return es_set_isSubsetOf_v2;hasRequiredEs_set_isSubsetOf_v2=1;var t=require_export(),e=requireSetIsSubsetOf(),r=requireSetMethodAcceptSetLike(),i=!r("isSubsetOf",function(n){return n});return t({target:"Set",proto:!0,real:!0,forced:i},{isSubsetOf:e}),es_set_isSubsetOf_v2}requireEs_set_isSubsetOf_v2();var es_set_isSupersetOf_v2={},setIsSupersetOf,hasRequiredSetIsSupersetOf;function requireSetIsSupersetOf(){if(hasRequiredSetIsSupersetOf)return setIsSupersetOf;hasRequiredSetIsSupersetOf=1;var t=requireASet(),e=requireSetHelpers().has,r=requireSetSize(),i=requireGetSetRecord(),n=requireIterateSimple(),s=requireIteratorClose();return setIsSupersetOf=function(a){var l=t(this),c=i(a);if(r(l)<c.size)return!1;var u=c.getIterator();return n(u,function(d){if(!e(l,d))return s(u,"normal",!1)})!==!1},setIsSupersetOf}var hasRequiredEs_set_isSupersetOf_v2;function requireEs_set_isSupersetOf_v2(){if(hasRequiredEs_set_isSupersetOf_v2)return es_set_isSupersetOf_v2;hasRequiredEs_set_isSupersetOf_v2=1;var t=require_export(),e=requireSetIsSupersetOf(),r=requireSetMethodAcceptSetLike(),i=!r("isSupersetOf",function(n){return!n});return t({target:"Set",proto:!0,real:!0,forced:i},{isSupersetOf:e}),es_set_isSupersetOf_v2}requireEs_set_isSupersetOf_v2();var es_set_symmetricDifference_v2={},setSymmetricDifference,hasRequiredSetSymmetricDifference;function requireSetSymmetricDifference(){if(hasRequiredSetSymmetricDifference)return setSymmetricDifference;hasRequiredSetSymmetricDifference=1;var t=requireASet(),e=requireSetHelpers(),r=requireSetClone(),i=requireGetSetRecord(),n=requireIterateSimple(),s=e.add,o=e.has,a=e.remove;return setSymmetricDifference=function(c){var u=t(this),d=i(c).getIterator(),h=r(u);return n(d,function(f){o(u,f)?a(h,f):s(h,f)}),h},setSymmetricDifference}var setMethodGetKeysBeforeCloningDetection,hasRequiredSetMethodGetKeysBeforeCloningDetection;function requireSetMethodGetKeysBeforeCloningDetection(){return hasRequiredSetMethodGetKeysBeforeCloningDetection||(hasRequiredSetMethodGetKeysBeforeCloningDetection=1,setMethodGetKeysBeforeCloningDetection=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},i=e[t](r);return i.size===1&&i.values().next().value===4}catch{return!1}}),setMethodGetKeysBeforeCloningDetection}var hasRequiredEs_set_symmetricDifference_v2;function requireEs_set_symmetricDifference_v2(){if(hasRequiredEs_set_symmetricDifference_v2)return es_set_symmetricDifference_v2;hasRequiredEs_set_symmetricDifference_v2=1;var t=require_export(),e=requireSetSymmetricDifference(),r=requireSetMethodGetKeysBeforeCloningDetection(),i=requireSetMethodAcceptSetLike(),n=!i("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:n},{symmetricDifference:e}),es_set_symmetricDifference_v2}requireEs_set_symmetricDifference_v2();var es_set_union_v2={},setUnion,hasRequiredSetUnion;function requireSetUnion(){if(hasRequiredSetUnion)return setUnion;hasRequiredSetUnion=1;var t=requireASet(),e=requireSetHelpers().add,r=requireSetClone(),i=requireGetSetRecord(),n=requireIterateSimple();return setUnion=function(o){var a=t(this),l=i(o).getIterator(),c=r(a);return n(l,function(u){e(c,u)}),c},setUnion}var hasRequiredEs_set_union_v2;function requireEs_set_union_v2(){if(hasRequiredEs_set_union_v2)return es_set_union_v2;hasRequiredEs_set_union_v2=1;var t=require_export(),e=requireSetUnion(),r=requireSetMethodGetKeysBeforeCloningDetection(),i=requireSetMethodAcceptSetLike(),n=!i("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:n},{union:e}),es_set_union_v2}requireEs_set_union_v2();var esnext_iterator_constructor={},es_iterator_constructor={},anInstance,hasRequiredAnInstance;function requireAnInstance(){if(hasRequiredAnInstance)return anInstance;hasRequiredAnInstance=1;var t=requireObjectIsPrototypeOf(),e=TypeError;return anInstance=function(r,i){if(t(i,r))return r;throw new e("Incorrect invocation")},anInstance}var correctPrototypeGetter,hasRequiredCorrectPrototypeGetter;function requireCorrectPrototypeGetter(){if(hasRequiredCorrectPrototypeGetter)return correctPrototypeGetter;hasRequiredCorrectPrototypeGetter=1;var t=requireFails();return correctPrototypeGetter=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),correctPrototypeGetter}var objectGetPrototypeOf,hasRequiredObjectGetPrototypeOf;function requireObjectGetPrototypeOf(){if(hasRequiredObjectGetPrototypeOf)return objectGetPrototypeOf;hasRequiredObjectGetPrototypeOf=1;var t=requireHasOwnProperty(),e=requireIsCallable(),r=requireToObject(),i=requireSharedKey(),n=requireCorrectPrototypeGetter(),s=i("IE_PROTO"),o=Object,a=o.prototype;return objectGetPrototypeOf=n?o.getPrototypeOf:function(l){var c=r(l);if(t(c,s))return c[s];var u=c.constructor;return e(u)&&c instanceof u?u.prototype:c instanceof o?a:null},objectGetPrototypeOf}var defineBuiltInAccessor,hasRequiredDefineBuiltInAccessor;function requireDefineBuiltInAccessor(){if(hasRequiredDefineBuiltInAccessor)return defineBuiltInAccessor;hasRequiredDefineBuiltInAccessor=1;var t=requireMakeBuiltIn(),e=requireObjectDefineProperty();return defineBuiltInAccessor=function(r,i,n){return n.get&&t(n.get,i,{getter:!0}),n.set&&t(n.set,i,{setter:!0}),e.f(r,i,n)},defineBuiltInAccessor}var objectDefineProperties={},objectKeys,hasRequiredObjectKeys;function requireObjectKeys(){if(hasRequiredObjectKeys)return objectKeys;hasRequiredObjectKeys=1;var t=requireObjectKeysInternal(),e=requireEnumBugKeys();return objectKeys=Object.keys||function(i){return t(i,e)},objectKeys}var hasRequiredObjectDefineProperties;function requireObjectDefineProperties(){if(hasRequiredObjectDefineProperties)return objectDefineProperties;hasRequiredObjectDefineProperties=1;var t=requireDescriptors(),e=requireV8PrototypeDefineBug(),r=requireObjectDefineProperty(),i=requireAnObject(),n=requireToIndexedObject(),s=requireObjectKeys();return objectDefineProperties.f=t&&!e?Object.defineProperties:function(a,l){i(a);for(var c=n(l),u=s(l),d=u.length,h=0,f;d>h;)r.f(a,f=u[h++],c[f]);return a},objectDefineProperties}var html$2,hasRequiredHtml;function requireHtml(){if(hasRequiredHtml)return html$2;hasRequiredHtml=1;var t=requireGetBuiltIn();return html$2=t("document","documentElement"),html$2}var objectCreate,hasRequiredObjectCreate;function requireObjectCreate(){if(hasRequiredObjectCreate)return objectCreate;hasRequiredObjectCreate=1;var t=requireAnObject(),e=requireObjectDefineProperties(),r=requireEnumBugKeys(),i=requireHiddenKeys(),n=requireHtml(),s=requireDocumentCreateElement(),o=requireSharedKey(),a=">",l="<",c="prototype",u="script",d=o("IE_PROTO"),h=function(){},f=function(v){return l+u+a+v+l+"/"+u+a},g=function(v){v.write(f("")),v.close();var E=v.parentWindow.Object;return v=null,E},m=function(){var v=s("iframe"),E="java"+u+":",$;return v.style.display="none",n.appendChild(v),v.src=String(E),$=v.contentWindow.document,$.open(),$.write(f("document.F=Object")),$.close(),$.F},C,y=function(){try{C=new ActiveXObject("htmlfile")}catch{}y=typeof document<"u"?document.domain&&C?g(C):m():g(C);for(var v=r.length;v--;)delete y[c][r[v]];return y()};return i[d]=!0,objectCreate=Object.create||function(E,$){var O;return E!==null?(h[c]=t(E),O=new h,h[c]=null,O[d]=E):O=y(),$===void 0?O:e.f(O,$)},objectCreate}var iteratorsCore,hasRequiredIteratorsCore;function requireIteratorsCore(){if(hasRequiredIteratorsCore)return iteratorsCore;hasRequiredIteratorsCore=1;var t=requireFails(),e=requireIsCallable(),r=requireIsObject(),i=requireObjectCreate(),n=requireObjectGetPrototypeOf(),s=requireDefineBuiltIn(),o=requireWellKnownSymbol(),a=requireIsPure(),l=o("iterator"),c=!1,u,d,h;[].keys&&(h=[].keys(),"next"in h?(d=n(n(h)),d!==Object.prototype&&(u=d)):c=!0);var f=!r(u)||t(function(){var g={};return u[l].call(g)!==g});return f?u={}:a&&(u=i(u)),e(u[l])||s(u,l,function(){return this}),iteratorsCore={IteratorPrototype:u,BUGGY_SAFARI_ITERATORS:c},iteratorsCore}var hasRequiredEs_iterator_constructor;function requireEs_iterator_constructor(){if(hasRequiredEs_iterator_constructor)return es_iterator_constructor;hasRequiredEs_iterator_constructor=1;var t=require_export(),e=requireGlobalThis(),r=requireAnInstance(),i=requireAnObject(),n=requireIsCallable(),s=requireObjectGetPrototypeOf(),o=requireDefineBuiltInAccessor(),a=requireCreateProperty(),l=requireFails(),c=requireHasOwnProperty(),u=requireWellKnownSymbol(),d=requireIteratorsCore().IteratorPrototype,h=requireDescriptors(),f=requireIsPure(),g="constructor",m="Iterator",C=u("toStringTag"),y=TypeError,v=e[m],E=f||!n(v)||v.prototype!==d||!l(function(){v({})}),$=function(){if(r(this,d),s(this)===d)throw new y("Abstract class Iterator not directly constructable")},O=function(P,I){h?o(d,P,{configurable:!0,get:function(){return I},set:function(W){if(i(this),this===d)throw new y("You can't redefine this property");c(this,P)?this[P]=W:a(this,P,W)}}):d[P]=I};return c(d,C)||O(C,m),(E||!c(d,g)||d[g]===Object)&&O(g,$),$.prototype=d,t({global:!0,constructor:!0,forced:E},{Iterator:$}),es_iterator_constructor}var hasRequiredEsnext_iterator_constructor;function requireEsnext_iterator_constructor(){return hasRequiredEsnext_iterator_constructor||(hasRequiredEsnext_iterator_constructor=1,requireEs_iterator_constructor()),esnext_iterator_constructor}requireEsnext_iterator_constructor();var esnext_iterator_filter={},es_iterator_filter={},defineBuiltIns,hasRequiredDefineBuiltIns;function requireDefineBuiltIns(){if(hasRequiredDefineBuiltIns)return defineBuiltIns;hasRequiredDefineBuiltIns=1;var t=requireDefineBuiltIn();return defineBuiltIns=function(e,r,i){for(var n in r)t(e,n,r[n],i);return e},defineBuiltIns}var createIterResultObject,hasRequiredCreateIterResultObject;function requireCreateIterResultObject(){return hasRequiredCreateIterResultObject||(hasRequiredCreateIterResultObject=1,createIterResultObject=function(t,e){return{value:t,done:e}}),createIterResultObject}var iteratorCloseAll,hasRequiredIteratorCloseAll;function requireIteratorCloseAll(){if(hasRequiredIteratorCloseAll)return iteratorCloseAll;hasRequiredIteratorCloseAll=1;var t=requireIteratorClose();return iteratorCloseAll=function(e,r,i){for(var n=e.length-1;n>=0;n--)if(e[n]!==void 0)try{i=t(e[n].iterator,r,i)}catch(s){r="throw",i=s}if(r==="throw")throw i;return i},iteratorCloseAll}var iteratorCreateProxy,hasRequiredIteratorCreateProxy;function requireIteratorCreateProxy(){if(hasRequiredIteratorCreateProxy)return iteratorCreateProxy;hasRequiredIteratorCreateProxy=1;var t=requireFunctionCall(),e=requireObjectCreate(),r=requireCreateNonEnumerableProperty(),i=requireDefineBuiltIns(),n=requireWellKnownSymbol(),s=requireInternalState(),o=requireGetMethod(),a=requireIteratorsCore().IteratorPrototype,l=requireCreateIterResultObject(),c=requireIteratorClose(),u=requireIteratorCloseAll(),d=n("toStringTag"),h="IteratorHelper",f="WrapForValidIterator",g="normal",m="throw",C=s.set,y=function($){var O=s.getterFor($?f:h);return i(e(a),{next:function(){var I=O(this);if($)return I.nextHandler();if(I.done)return l(void 0,!0);try{var W=I.nextHandler();return I.returnHandlerResult?W:l(W,I.done)}catch(q){throw I.done=!0,q}},return:function(){var P=O(this),I=P.iterator;if(P.done=!0,$){var W=o(I,"return");return W?t(W,I):l(void 0,!0)}if(P.inner)try{c(P.inner.iterator,g)}catch(q){return c(I,m,q)}if(P.openIters)try{u(P.openIters,g)}catch(q){return c(I,m,q)}return I&&c(I,g),l(void 0,!0)}})},v=y(!0),E=y(!1);return r(E,d,"Iterator Helper"),iteratorCreateProxy=function($,O,P){var I=function(q,M){M?(M.iterator=q.iterator,M.next=q.next):M=q,M.type=O?f:h,M.returnHandlerResult=!!P,M.nextHandler=$,M.counter=0,M.done=!1,C(this,M)};return I.prototype=O?v:E,I},iteratorCreateProxy}var callWithSafeIterationClosing,hasRequiredCallWithSafeIterationClosing;function requireCallWithSafeIterationClosing(){if(hasRequiredCallWithSafeIterationClosing)return callWithSafeIterationClosing;hasRequiredCallWithSafeIterationClosing=1;var t=requireAnObject(),e=requireIteratorClose();return callWithSafeIterationClosing=function(r,i,n,s){try{return s?i(t(n)[0],n[1]):i(n)}catch(o){e(r,"throw",o)}},callWithSafeIterationClosing}var iteratorHelperThrowsOnInvalidIterator,hasRequiredIteratorHelperThrowsOnInvalidIterator;function requireIteratorHelperThrowsOnInvalidIterator(){return hasRequiredIteratorHelperThrowsOnInvalidIterator||(hasRequiredIteratorHelperThrowsOnInvalidIterator=1,iteratorHelperThrowsOnInvalidIterator=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),iteratorHelperThrowsOnInvalidIterator}var iteratorHelperWithoutClosingOnEarlyError,hasRequiredIteratorHelperWithoutClosingOnEarlyError;function requireIteratorHelperWithoutClosingOnEarlyError(){if(hasRequiredIteratorHelperWithoutClosingOnEarlyError)return iteratorHelperWithoutClosingOnEarlyError;hasRequiredIteratorHelperWithoutClosingOnEarlyError=1;var t=requireGlobalThis();return iteratorHelperWithoutClosingOnEarlyError=function(e,r){var i=t.Iterator,n=i&&i.prototype,s=n&&n[e],o=!1;if(s)try{s.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(a){a instanceof r||(o=!1)}if(!o)return s},iteratorHelperWithoutClosingOnEarlyError}var hasRequiredEs_iterator_filter;function requireEs_iterator_filter(){if(hasRequiredEs_iterator_filter)return es_iterator_filter;hasRequiredEs_iterator_filter=1;var t=require_export(),e=requireFunctionCall(),r=requireACallable(),i=requireAnObject(),n=requireGetIteratorDirect(),s=requireIteratorCreateProxy(),o=requireCallWithSafeIterationClosing(),a=requireIsPure(),l=requireIteratorClose(),c=requireIteratorHelperThrowsOnInvalidIterator(),u=requireIteratorHelperWithoutClosingOnEarlyError(),d=!a&&!c("filter",function(){}),h=!a&&!d&&u("filter",TypeError),f=a||d||h,g=s(function(){for(var m=this.iterator,C=this.predicate,y=this.next,v,E,$;;){if(v=i(e(y,m)),E=this.done=!!v.done,E)return;if($=v.value,o(m,C,[$,this.counter++],!0))return $}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(C){i(this);try{r(C)}catch(y){l(this,"throw",y)}return h?e(h,this,C):new g(n(this),{predicate:C})}}),es_iterator_filter}var hasRequiredEsnext_iterator_filter;function requireEsnext_iterator_filter(){return hasRequiredEsnext_iterator_filter||(hasRequiredEsnext_iterator_filter=1,requireEs_iterator_filter()),esnext_iterator_filter}requireEsnext_iterator_filter();var esnext_iterator_forEach={},es_iterator_forEach={},hasRequiredEs_iterator_forEach;function requireEs_iterator_forEach(){if(hasRequiredEs_iterator_forEach)return es_iterator_forEach;hasRequiredEs_iterator_forEach=1;var t=require_export(),e=requireFunctionCall(),r=requireIterate(),i=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect(),o=requireIteratorClose(),a=requireIteratorHelperWithoutClosingOnEarlyError(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(u){n(this);try{i(u)}catch(f){o(this,"throw",f)}if(l)return e(l,this,u);var d=s(this),h=0;r(d,function(f){u(f,h++)},{IS_RECORD:!0})}}),es_iterator_forEach}var hasRequiredEsnext_iterator_forEach;function requireEsnext_iterator_forEach(){return hasRequiredEsnext_iterator_forEach||(hasRequiredEsnext_iterator_forEach=1,requireEs_iterator_forEach()),esnext_iterator_forEach}requireEsnext_iterator_forEach();var esnext_iterator_map={},es_iterator_map={},hasRequiredEs_iterator_map;function requireEs_iterator_map(){if(hasRequiredEs_iterator_map)return es_iterator_map;hasRequiredEs_iterator_map=1;var t=require_export(),e=requireFunctionCall(),r=requireACallable(),i=requireAnObject(),n=requireGetIteratorDirect(),s=requireIteratorCreateProxy(),o=requireCallWithSafeIterationClosing(),a=requireIteratorClose(),l=requireIteratorHelperThrowsOnInvalidIterator(),c=requireIteratorHelperWithoutClosingOnEarlyError(),u=requireIsPure(),d=!u&&!l("map",function(){}),h=!u&&!d&&c("map",TypeError),f=u||d||h,g=s(function(){var m=this.iterator,C=i(e(this.next,m)),y=this.done=!!C.done;if(!y)return o(m,this.mapper,[C.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(C){i(this);try{r(C)}catch(y){a(this,"throw",y)}return h?e(h,this,C):new g(n(this),{mapper:C})}}),es_iterator_map}var hasRequiredEsnext_iterator_map;function requireEsnext_iterator_map(){return hasRequiredEsnext_iterator_map||(hasRequiredEsnext_iterator_map=1,requireEs_iterator_map()),esnext_iterator_map}requireEsnext_iterator_map();var web_immediate={},web_clearImmediate={},arraySlice,hasRequiredArraySlice;function requireArraySlice(){if(hasRequiredArraySlice)return arraySlice;hasRequiredArraySlice=1;var t=requireFunctionUncurryThis();return arraySlice=t([].slice),arraySlice}var validateArgumentsLength,hasRequiredValidateArgumentsLength;function requireValidateArgumentsLength(){if(hasRequiredValidateArgumentsLength)return validateArgumentsLength;hasRequiredValidateArgumentsLength=1;var t=TypeError;return validateArgumentsLength=function(e,r){if(e<r)throw new t("Not enough arguments");return e},validateArgumentsLength}var environmentIsIos,hasRequiredEnvironmentIsIos;function requireEnvironmentIsIos(){if(hasRequiredEnvironmentIsIos)return environmentIsIos;hasRequiredEnvironmentIsIos=1;var t=requireEnvironmentUserAgent();return environmentIsIos=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),environmentIsIos}var environment,hasRequiredEnvironment;function requireEnvironment(){if(hasRequiredEnvironment)return environment;hasRequiredEnvironment=1;var t=requireGlobalThis(),e=requireEnvironmentUserAgent(),r=requireClassofRaw(),i=function(n){return e.slice(0,n.length)===n};return environment=function(){return i("Bun/")?"BUN":i("Cloudflare-Workers")?"CLOUDFLARE":i("Deno/")?"DENO":i("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),environment}var environmentIsNode,hasRequiredEnvironmentIsNode;function requireEnvironmentIsNode(){if(hasRequiredEnvironmentIsNode)return environmentIsNode;hasRequiredEnvironmentIsNode=1;var t=requireEnvironment();return environmentIsNode=t==="NODE",environmentIsNode}var task,hasRequiredTask;function requireTask(){if(hasRequiredTask)return task;hasRequiredTask=1;var t=requireGlobalThis(),e=requireFunctionApply(),r=requireFunctionBindContext(),i=requireIsCallable(),n=requireHasOwnProperty(),s=requireFails(),o=requireHtml(),a=requireArraySlice(),l=requireDocumentCreateElement(),c=requireValidateArgumentsLength(),u=requireEnvironmentIsIos(),d=requireEnvironmentIsNode(),h=t.setImmediate,f=t.clearImmediate,g=t.process,m=t.Dispatch,C=t.Function,y=t.MessageChannel,v=t.String,E=0,$={},O="onreadystatechange",P,I,W,q;s(function(){P=t.location});var M=function(K){if(n($,K)){var Z=$[K];delete $[K],Z()}},Y=function(K){return function(){M(K)}},z=function(K){M(K.data)},Q=function(K){t.postMessage(v(K),P.protocol+"//"+P.host)};return(!h||!f)&&(h=function(Z){c(arguments.length,1);var ue=i(Z)?Z:C(Z),oe=a(arguments,1);return $[++E]=function(){e(ue,void 0,oe)},I(E),E},f=function(Z){delete $[Z]},d?I=function(K){g.nextTick(Y(K))}:m&&m.now?I=function(K){m.now(Y(K))}:y&&!u?(W=new y,q=W.port2,W.port1.onmessage=z,I=r(q.postMessage,q)):t.addEventListener&&i(t.postMessage)&&!t.importScripts&&P&&P.protocol!=="file:"&&!s(Q)?(I=Q,t.addEventListener("message",z,!1)):O in l("script")?I=function(K){o.appendChild(l("script"))[O]=function(){o.removeChild(this),M(K)}}:I=function(K){setTimeout(Y(K),0)}),task={set:h,clear:f},task}var hasRequiredWeb_clearImmediate;function requireWeb_clearImmediate(){if(hasRequiredWeb_clearImmediate)return web_clearImmediate;hasRequiredWeb_clearImmediate=1;var t=require_export(),e=requireGlobalThis(),r=requireTask().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),web_clearImmediate}var web_setImmediate={},schedulersFix,hasRequiredSchedulersFix;function requireSchedulersFix(){if(hasRequiredSchedulersFix)return schedulersFix;hasRequiredSchedulersFix=1;var t=requireGlobalThis(),e=requireFunctionApply(),r=requireIsCallable(),i=requireEnvironment(),n=requireEnvironmentUserAgent(),s=requireArraySlice(),o=requireValidateArgumentsLength(),a=t.Function,l=/MSIE .\./.test(n)||i==="BUN"&&function(){var c=t.Bun.version.split(".");return c.length<3||c[0]==="0"&&(c[1]<3||c[1]==="3"&&c[2]==="0")}();return schedulersFix=function(c,u){var d=u?2:1;return l?function(h,f){var g=o(arguments.length,1)>d,m=r(h)?h:a(h),C=g?s(arguments,d):[],y=g?function(){e(m,this,C)}:m;return u?c(y,f):c(y)}:c},schedulersFix}var hasRequiredWeb_setImmediate;function requireWeb_setImmediate(){if(hasRequiredWeb_setImmediate)return web_setImmediate;hasRequiredWeb_setImmediate=1;var t=require_export(),e=requireGlobalThis(),r=requireTask().set,i=requireSchedulersFix(),n=e.setImmediate?i(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==n},{setImmediate:n}),web_setImmediate}var hasRequiredWeb_immediate;function requireWeb_immediate(){return hasRequiredWeb_immediate||(hasRequiredWeb_immediate=1,requireWeb_clearImmediate(),requireWeb_setImmediate()),web_immediate}requireWeb_immediate();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries,setPrototypeOf,isFrozen,getPrototypeOf,getOwnPropertyDescriptor}=Object;let{freeze,seal,create}=Object,{apply,construct}=typeof Reflect<"u"&&Reflect;freeze||(freeze=function(e){return e});seal||(seal=function(e){return e});apply||(apply=function(e,r,i){return e.apply(r,i)});construct||(construct=function(e,r){return new e(...r)});const arrayForEach=unapply(Array.prototype.forEach),arrayLastIndexOf=unapply(Array.prototype.lastIndexOf),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),arraySplice=unapply(Array.prototype.splice),stringToLowerCase=unapply(String.prototype.toLowerCase),stringToString=unapply(String.prototype.toString),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),objectHasOwnProperty=unapply(Object.prototype.hasOwnProperty),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];return apply(t,e,i)}}function unconstruct(t){return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return construct(t,r)}}function addToSet(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:stringToLowerCase;setPrototypeOf&&setPrototypeOf(t,null);let i=e.length;for(;i--;){let n=e[i];if(typeof n=="string"){const s=r(n);s!==n&&(isFrozen(e)||(e[i]=s),n=s)}t[n]=!0}return t}function cleanArray(t){for(let e=0;e<t.length;e++)objectHasOwnProperty(t,e)||(t[e]=null);return t}function clone$2(t){const e=create(null);for(const[r,i]of entries(t))objectHasOwnProperty(t,r)&&(Array.isArray(i)?e[r]=cleanArray(i):i&&typeof i=="object"&&i.constructor===Object?e[r]=clone$2(i):e[r]=i);return e}function lookupGetter(t,e){for(;t!==null;){const i=getOwnPropertyDescriptor(t,e);if(i){if(i.get)return unapply(i.get);if(typeof i.value=="function")return unapply(i.value)}t=getPrototypeOf(t)}function r(){return null}return r}const html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze(["#text"]),html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),svg=freeze(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm),TMPLIT_EXPR=seal(/\$\{[\w\W]*/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]+$/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DOCTYPE_NAME=seal(/^html$/i),CUSTOM_ELEMENT=seal(/^[a-z][.\w]*(-[.\w]+)+$/i);var EXPRESSIONS=Object.freeze({__proto__:null,ARIA_ATTR,ATTR_WHITESPACE,CUSTOM_ELEMENT,DATA_ATTR,DOCTYPE_NAME,ERB_EXPR,IS_ALLOWED_URI,IS_SCRIPT_OR_DATA,MUSTACHE_EXPR,TMPLIT_EXPR});const NODE_TYPE={element:1,text:3,progressingInstruction:7,comment:8,document:9},getGlobal=function(){return typeof window>"u"?null:window},_createTrustedTypesPolicy=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const n="data-tt-policy-suffix";r&&r.hasAttribute(n)&&(i=r.getAttribute(n));const s="dompurify"+(i?"#"+i:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},_createHooksMap=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function createDOMPurify(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal();const e=re=>createDOMPurify(re);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==NODE_TYPE.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const i=r,n=i.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:f}=t,g=l.prototype,m=lookupGetter(g,"cloneNode"),C=lookupGetter(g,"remove"),y=lookupGetter(g,"nextSibling"),v=lookupGetter(g,"childNodes"),E=lookupGetter(g,"parentNode");if(typeof o=="function"){const re=r.createElement("template");re.content&&re.content.ownerDocument&&(r=re.content.ownerDocument)}let $,O="";const{implementation:P,createNodeIterator:I,createDocumentFragment:W,getElementsByTagName:q}=r,{importNode:M}=i;let Y=_createHooksMap();e.isSupported=typeof entries=="function"&&typeof E=="function"&&P&&P.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:z,ERB_EXPR:Q,TMPLIT_EXPR:K,DATA_ATTR:Z,ARIA_ATTR:ue,IS_SCRIPT_OR_DATA:oe,ATTR_WHITESPACE:ae,CUSTOM_ELEMENT:pe}=EXPRESSIONS;let{IS_ALLOWED_URI:fe}=EXPRESSIONS,ge=null;const ye=addToSet({},[...html$1,...svg$1,...svgFilters,...mathMl$1,...text]);let p=null;const _=addToSet({},[...html,...svg,...mathMl,...xml]);let w=Object.seal(create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),x=null,k=null,G=!0,j=!0,S=!1,b=!0,R=!1,T=!0,A=!1,D=!1,B=!1,N=!1,H=!1,L=!1,U=!0,V=!1;const J="user-content-";let ee=!0,ne=!1,le={},ce=null;const se=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ie=null;const he=addToSet({},["audio","video","img","source","image","track"]);let Te=null;const Ae=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Oe="http://www.w3.org/1998/Math/MathML",Se="http://www.w3.org/2000/svg",_e="http://www.w3.org/1999/xhtml";let ve=_e,me=!1,de=null;const $e=addToSet({},[Oe,Se,_e],stringToString);let Pe=addToSet({},["mi","mo","mn","ms","mtext"]),Fe=addToSet({},["annotation-xml"]);const Be=addToSet({},["title","style","font","a","script"]);let ke=null;const it=["application/xhtml+xml","text/html"],nt="text/html";let be=null,De=null;const st=r.createElement("form"),Ve=function(F){return F instanceof RegExp||F instanceof Function},Ge=function(){let F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(De&&De===F)){if((!F||typeof F!="object")&&(F={}),F=clone$2(F),ke=it.indexOf(F.PARSER_MEDIA_TYPE)===-1?nt:F.PARSER_MEDIA_TYPE,be=ke==="application/xhtml+xml"?stringToString:stringToLowerCase,ge=objectHasOwnProperty(F,"ALLOWED_TAGS")?addToSet({},F.ALLOWED_TAGS,be):ye,p=objectHasOwnProperty(F,"ALLOWED_ATTR")?addToSet({},F.ALLOWED_ATTR,be):_,de=objectHasOwnProperty(F,"ALLOWED_NAMESPACES")?addToSet({},F.ALLOWED_NAMESPACES,stringToString):$e,Te=objectHasOwnProperty(F,"ADD_URI_SAFE_ATTR")?addToSet(clone$2(Ae),F.ADD_URI_SAFE_ATTR,be):Ae,ie=objectHasOwnProperty(F,"ADD_DATA_URI_TAGS")?addToSet(clone$2(he),F.ADD_DATA_URI_TAGS,be):he,ce=objectHasOwnProperty(F,"FORBID_CONTENTS")?addToSet({},F.FORBID_CONTENTS,be):se,x=objectHasOwnProperty(F,"FORBID_TAGS")?addToSet({},F.FORBID_TAGS,be):clone$2({}),k=objectHasOwnProperty(F,"FORBID_ATTR")?addToSet({},F.FORBID_ATTR,be):clone$2({}),le=objectHasOwnProperty(F,"USE_PROFILES")?F.USE_PROFILES:!1,G=F.ALLOW_ARIA_ATTR!==!1,j=F.ALLOW_DATA_ATTR!==!1,S=F.ALLOW_UNKNOWN_PROTOCOLS||!1,b=F.ALLOW_SELF_CLOSE_IN_ATTR!==!1,R=F.SAFE_FOR_TEMPLATES||!1,T=F.SAFE_FOR_XML!==!1,A=F.WHOLE_DOCUMENT||!1,N=F.RETURN_DOM||!1,H=F.RETURN_DOM_FRAGMENT||!1,L=F.RETURN_TRUSTED_TYPE||!1,B=F.FORCE_BODY||!1,U=F.SANITIZE_DOM!==!1,V=F.SANITIZE_NAMED_PROPS||!1,ee=F.KEEP_CONTENT!==!1,ne=F.IN_PLACE||!1,fe=F.ALLOWED_URI_REGEXP||IS_ALLOWED_URI,ve=F.NAMESPACE||_e,Pe=F.MATHML_TEXT_INTEGRATION_POINTS||Pe,Fe=F.HTML_INTEGRATION_POINTS||Fe,w=F.CUSTOM_ELEMENT_HANDLING||{},F.CUSTOM_ELEMENT_HANDLING&&Ve(F.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(w.tagNameCheck=F.CUSTOM_ELEMENT_HANDLING.tagNameCheck),F.CUSTOM_ELEMENT_HANDLING&&Ve(F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(w.attributeNameCheck=F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),F.CUSTOM_ELEMENT_HANDLING&&typeof F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(w.allowCustomizedBuiltInElements=F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),R&&(j=!1),H&&(N=!0),le&&(ge=addToSet({},text),p=[],le.html===!0&&(addToSet(ge,html$1),addToSet(p,html)),le.svg===!0&&(addToSet(ge,svg$1),addToSet(p,svg),addToSet(p,xml)),le.svgFilters===!0&&(addToSet(ge,svgFilters),addToSet(p,svg),addToSet(p,xml)),le.mathMl===!0&&(addToSet(ge,mathMl$1),addToSet(p,mathMl),addToSet(p,xml))),F.ADD_TAGS&&(ge===ye&&(ge=clone$2(ge)),addToSet(ge,F.ADD_TAGS,be)),F.ADD_ATTR&&(p===_&&(p=clone$2(p)),addToSet(p,F.ADD_ATTR,be)),F.ADD_URI_SAFE_ATTR&&addToSet(Te,F.ADD_URI_SAFE_ATTR,be),F.FORBID_CONTENTS&&(ce===se&&(ce=clone$2(ce)),addToSet(ce,F.FORBID_CONTENTS,be)),ee&&(ge["#text"]=!0),A&&addToSet(ge,["html","head","body"]),ge.table&&(addToSet(ge,["tbody"]),delete x.tbody),F.TRUSTED_TYPES_POLICY){if(typeof F.TRUSTED_TYPES_POLICY.createHTML!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof F.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');$=F.TRUSTED_TYPES_POLICY,O=$.createHTML("")}else $===void 0&&($=_createTrustedTypesPolicy(f,n)),$!==null&&typeof O=="string"&&(O=$.createHTML(""));freeze&&freeze(F),De=F}},qe=addToSet({},[...svg$1,...svgFilters,...svgDisallowed]),je=addToSet({},[...mathMl$1,...mathMlDisallowed]),ot=function(F){let X=E(F);(!X||!X.tagName)&&(X={namespaceURI:ve,tagName:"template"});const te=stringToLowerCase(F.tagName),Ce=stringToLowerCase(X.tagName);return de[F.namespaceURI]?F.namespaceURI===Se?X.namespaceURI===_e?te==="svg":X.namespaceURI===Oe?te==="svg"&&(Ce==="annotation-xml"||Pe[Ce]):!!qe[te]:F.namespaceURI===Oe?X.namespaceURI===_e?te==="math":X.namespaceURI===Se?te==="math"&&Fe[Ce]:!!je[te]:F.namespaceURI===_e?X.namespaceURI===Se&&!Fe[Ce]||X.namespaceURI===Oe&&!Pe[Ce]?!1:!je[te]&&(Be[te]||!qe[te]):!!(ke==="application/xhtml+xml"&&de[F.namespaceURI]):!1},Me=function(F){arrayPush(e.removed,{element:F});try{E(F).removeChild(F)}catch{C(F)}},He=function(F,X){try{arrayPush(e.removed,{attribute:X.getAttributeNode(F),from:X})}catch{arrayPush(e.removed,{attribute:null,from:X})}if(X.removeAttribute(F),F==="is")if(N||H)try{Me(X)}catch{}else try{X.setAttribute(F,"")}catch{}},Ye=function(F){let X=null,te=null;if(B)F="<remove></remove>"+F;else{const we=stringMatch(F,/^[\r\n\t ]+/);te=we&&we[0]}ke==="application/xhtml+xml"&&ve===_e&&(F='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+F+"</body></html>");const Ce=$?$.createHTML(F):F;if(ve===_e)try{X=new h().parseFromString(Ce,ke)}catch{}if(!X||!X.documentElement){X=P.createDocument(ve,"template",null);try{X.documentElement.innerHTML=me?O:Ce}catch{}}const Ee=X.body||X.documentElement;return F&&te&&Ee.insertBefore(r.createTextNode(te),Ee.childNodes[0]||null),ve===_e?q.call(X,A?"html":"body")[0]:A?X.documentElement:Ee},ze=function(F){return I.call(F.ownerDocument||F,F,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Ue=function(F){return F instanceof d&&(typeof F.nodeName!="string"||typeof F.textContent!="string"||typeof F.removeChild!="function"||!(F.attributes instanceof u)||typeof F.removeAttribute!="function"||typeof F.setAttribute!="function"||typeof F.namespaceURI!="string"||typeof F.insertBefore!="function"||typeof F.hasChildNodes!="function")},Ke=function(F){return typeof a=="function"&&F instanceof a};function Ne(re,F,X){arrayForEach(re,te=>{te.call(e,F,X,De)})}const Xe=function(F){let X=null;if(Ne(Y.beforeSanitizeElements,F,null),Ue(F))return Me(F),!0;const te=be(F.nodeName);if(Ne(Y.uponSanitizeElement,F,{tagName:te,allowedTags:ge}),T&&F.hasChildNodes()&&!Ke(F.firstElementChild)&&regExpTest(/<[/\w!]/g,F.innerHTML)&&regExpTest(/<[/\w!]/g,F.textContent)||F.nodeType===NODE_TYPE.progressingInstruction||T&&F.nodeType===NODE_TYPE.comment&&regExpTest(/<[/\w]/g,F.data))return Me(F),!0;if(!ge[te]||x[te]){if(!x[te]&&Qe(te)&&(w.tagNameCheck instanceof RegExp&&regExpTest(w.tagNameCheck,te)||w.tagNameCheck instanceof Function&&w.tagNameCheck(te)))return!1;if(ee&&!ce[te]){const Ce=E(F)||F.parentNode,Ee=v(F)||F.childNodes;if(Ee&&Ce){const we=Ee.length;for(let Ie=we-1;Ie>=0;--Ie){const xe=m(Ee[Ie],!0);xe.__removalCount=(F.__removalCount||0)+1,Ce.insertBefore(xe,y(F))}}}return Me(F),!0}return F instanceof l&&!ot(F)||(te==="noscript"||te==="noembed"||te==="noframes")&&regExpTest(/<\/no(script|embed|frames)/i,F.innerHTML)?(Me(F),!0):(R&&F.nodeType===NODE_TYPE.text&&(X=F.textContent,arrayForEach([z,Q,K],Ce=>{X=stringReplace(X,Ce," ")}),F.textContent!==X&&(arrayPush(e.removed,{element:F.cloneNode()}),F.textContent=X)),Ne(Y.afterSanitizeElements,F,null),!1)},Ze=function(F,X,te){if(U&&(X==="id"||X==="name")&&(te in r||te in st))return!1;if(!(j&&!k[X]&&regExpTest(Z,X))){if(!(G&&regExpTest(ue,X))){if(!p[X]||k[X]){if(!(Qe(F)&&(w.tagNameCheck instanceof RegExp&&regExpTest(w.tagNameCheck,F)||w.tagNameCheck instanceof Function&&w.tagNameCheck(F))&&(w.attributeNameCheck instanceof RegExp&&regExpTest(w.attributeNameCheck,X)||w.attributeNameCheck instanceof Function&&w.attributeNameCheck(X))||X==="is"&&w.allowCustomizedBuiltInElements&&(w.tagNameCheck instanceof RegExp&&regExpTest(w.tagNameCheck,te)||w.tagNameCheck instanceof Function&&w.tagNameCheck(te))))return!1}else if(!Te[X]){if(!regExpTest(fe,stringReplace(te,ae,""))){if(!((X==="src"||X==="xlink:href"||X==="href")&&F!=="script"&&stringIndexOf(te,"data:")===0&&ie[F])){if(!(S&&!regExpTest(oe,stringReplace(te,ae,"")))){if(te)return!1}}}}}}return!0},Qe=function(F){return F!=="annotation-xml"&&stringMatch(F,pe)},Je=function(F){Ne(Y.beforeSanitizeAttributes,F,null);const{attributes:X}=F;if(!X||Ue(F))return;const te={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:p,forceKeepAttr:void 0};let Ce=X.length;for(;Ce--;){const Ee=X[Ce],{name:we,namespaceURI:Ie,value:xe}=Ee,Le=be(we),We=xe;let Re=we==="value"?We:stringTrim(We);if(te.attrName=Le,te.attrValue=Re,te.keepAttr=!0,te.forceKeepAttr=void 0,Ne(Y.uponSanitizeAttribute,F,te),Re=te.attrValue,V&&(Le==="id"||Le==="name")&&(He(we,F),Re=J+Re),T&&regExpTest(/((--!?|])>)|<\/(style|title)/i,Re)){He(we,F);continue}if(te.forceKeepAttr)continue;if(!te.keepAttr){He(we,F);continue}if(!b&&regExpTest(/\/>/i,Re)){He(we,F);continue}R&&arrayForEach([z,Q,K],tt=>{Re=stringReplace(Re,tt," ")});const et=be(F.nodeName);if(!Ze(et,Le,Re)){He(we,F);continue}if($&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Ie)switch(f.getAttributeType(et,Le)){case"TrustedHTML":{Re=$.createHTML(Re);break}case"TrustedScriptURL":{Re=$.createScriptURL(Re);break}}if(Re!==We)try{Ie?F.setAttributeNS(Ie,we,Re):F.setAttribute(we,Re),Ue(F)?Me(F):arrayPop(e.removed)}catch{He(we,F)}}Ne(Y.afterSanitizeAttributes,F,null)},at=function re(F){let X=null;const te=ze(F);for(Ne(Y.beforeSanitizeShadowDOM,F,null);X=te.nextNode();)Ne(Y.uponSanitizeShadowNode,X,null),Xe(X),Je(X),X.content instanceof s&&re(X.content);Ne(Y.afterSanitizeShadowDOM,F,null)};return e.sanitize=function(re){let F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=null,te=null,Ce=null,Ee=null;if(me=!re,me&&(re="<!-->"),typeof re!="string"&&!Ke(re))if(typeof re.toString=="function"){if(re=re.toString(),typeof re!="string")throw typeErrorCreate("dirty is not a string, aborting")}else throw typeErrorCreate("toString is not a function");if(!e.isSupported)return re;if(D||Ge(F),e.removed=[],typeof re=="string"&&(ne=!1),ne){if(re.nodeName){const xe=be(re.nodeName);if(!ge[xe]||x[xe])throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}else if(re instanceof a)X=Ye("<!---->"),te=X.ownerDocument.importNode(re,!0),te.nodeType===NODE_TYPE.element&&te.nodeName==="BODY"||te.nodeName==="HTML"?X=te:X.appendChild(te);else{if(!N&&!R&&!A&&re.indexOf("<")===-1)return $&&L?$.createHTML(re):re;if(X=Ye(re),!X)return N?null:L?O:""}X&&B&&Me(X.firstChild);const we=ze(ne?re:X);for(;Ce=we.nextNode();)Xe(Ce),Je(Ce),Ce.content instanceof s&&at(Ce.content);if(ne)return re;if(N){if(H)for(Ee=W.call(X.ownerDocument);X.firstChild;)Ee.appendChild(X.firstChild);else Ee=X;return(p.shadowroot||p.shadowrootmode)&&(Ee=M.call(i,Ee,!0)),Ee}let Ie=A?X.outerHTML:X.innerHTML;return A&&ge["!doctype"]&&X.ownerDocument&&X.ownerDocument.doctype&&X.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,X.ownerDocument.doctype.name)&&(Ie="<!DOCTYPE "+X.ownerDocument.doctype.name+`>
`+Ie),R&&arrayForEach([z,Q,K],xe=>{Ie=stringReplace(Ie,xe," ")}),$&&L?$.createHTML(Ie):Ie},e.setConfig=function(){let re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(re),D=!0},e.clearConfig=function(){De=null,D=!1},e.isValidAttribute=function(re,F,X){De||Ge({});const te=be(re),Ce=be(F);return Ze(te,Ce,X)},e.addHook=function(re,F){typeof F=="function"&&arrayPush(Y[re],F)},e.removeHook=function(re,F){if(F!==void 0){const X=arrayLastIndexOf(Y[re],F);return X===-1?void 0:arraySplice(Y[re],X,1)[0]}return arrayPop(Y[re])},e.removeHooks=function(re){Y[re]=[]},e.removeAllHooks=function(){Y=_createHooksMap()},e}var purify=createDOMPurify();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var hookCallback;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(t){hookCallback=t}function isArray$1(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function isObject$1(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function hasOwnProp(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function isObjectEmpty(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(hasOwnProp(t,e))return!1;return!0}function isUndefined$1(t){return t===void 0}function isNumber(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function isDate$2(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function map(t,e){var r=[],i,n=t.length;for(i=0;i<n;++i)r.push(e(t[i],i));return r}function extend$2(t,e){for(var r in e)hasOwnProp(e,r)&&(t[r]=e[r]);return hasOwnProp(e,"toString")&&(t.toString=e.toString),hasOwnProp(e,"valueOf")&&(t.valueOf=e.valueOf),t}function createUTC(t,e,r,i){return createLocalOrUTC(t,e,r,i,!0).utc()}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function getParsingFlags(t){return t._pf==null&&(t._pf=defaultParsingFlags()),t._pf}var some;Array.prototype.some?some=Array.prototype.some:some=function(t){var e=Object(this),r=e.length>>>0,i;for(i=0;i<r;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function isValid(t){var e=null,r=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=getParsingFlags(t),r=some.call(e.parsedDateParts,function(n){return n!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function createInvalid(t){var e=createUTC(NaN);return t!=null?extend$2(getParsingFlags(e),t):getParsingFlags(e).userInvalidated=!0,e}var momentProperties=hooks.momentProperties=[],updateInProgress=!1;function copyConfig(t,e){var r,i,n,s=momentProperties.length;if(isUndefined$1(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),isUndefined$1(e._i)||(t._i=e._i),isUndefined$1(e._f)||(t._f=e._f),isUndefined$1(e._l)||(t._l=e._l),isUndefined$1(e._strict)||(t._strict=e._strict),isUndefined$1(e._tzm)||(t._tzm=e._tzm),isUndefined$1(e._isUTC)||(t._isUTC=e._isUTC),isUndefined$1(e._offset)||(t._offset=e._offset),isUndefined$1(e._pf)||(t._pf=getParsingFlags(e)),isUndefined$1(e._locale)||(t._locale=e._locale),s>0)for(r=0;r<s;r++)i=momentProperties[r],n=e[i],isUndefined$1(n)||(t[i]=n);return t}function Moment(t){copyConfig(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),updateInProgress===!1&&(updateInProgress=!0,hooks.updateOffset(this),updateInProgress=!1)}function isMoment(t){return t instanceof Moment||t!=null&&t._isAMomentObject!=null}function warn$1(t){hooks.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function deprecate(t,e){var r=!0;return extend$2(function(){if(hooks.deprecationHandler!=null&&hooks.deprecationHandler(null,t),r){var i=[],n,s,o,a=arguments.length;for(s=0;s<a;s++){if(n="",typeof arguments[s]=="object"){n+=`
[`+s+"] ";for(o in arguments[0])hasOwnProp(arguments[0],o)&&(n+=o+": "+arguments[0][o]+", ");n=n.slice(0,-2)}else n=arguments[s];i.push(n)}warn$1(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var deprecations={};function deprecateSimple(t,e){hooks.deprecationHandler!=null&&hooks.deprecationHandler(t,e),deprecations[t]||(warn$1(e),deprecations[t]=!0)}hooks.suppressDeprecationWarnings=!1;hooks.deprecationHandler=null;function isFunction$1(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function set$1(t){var e,r;for(r in t)hasOwnProp(t,r)&&(e=t[r],isFunction$1(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(t,e){var r=extend$2({},t),i;for(i in e)hasOwnProp(e,i)&&(isObject$1(t[i])&&isObject$1(e[i])?(r[i]={},extend$2(r[i],t[i]),extend$2(r[i],e[i])):e[i]!=null?r[i]=e[i]:delete r[i]);for(i in t)hasOwnProp(t,i)&&!hasOwnProp(e,i)&&isObject$1(t[i])&&(r[i]=extend$2({},r[i]));return r}function Locale(t){t!=null&&this.set(t)}var keys;Object.keys?keys=Object.keys:keys=function(t){var e,r=[];for(e in t)hasOwnProp(t,e)&&r.push(e);return r};var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(t,e,r){var i=this._calendar[t]||this._calendar.sameElse;return isFunction$1(i)?i.call(e,r):i}function zeroFill(t,e,r){var i=""+Math.abs(t),n=e-i.length,s=t>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+i}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(t,e,r,i){var n=i;typeof i=="string"&&(n=function(){return this[i]()}),t&&(formatTokenFunctions[t]=n),e&&(formatTokenFunctions[e[0]]=function(){return zeroFill(n.apply(this,arguments),e[1],e[2])}),r&&(formatTokenFunctions[r]=function(){return this.localeData().ordinal(n.apply(this,arguments),t)})}function removeFormattingTokens(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function makeFormatFunction(t){var e=t.match(formattingTokens),r,i;for(r=0,i=e.length;r<i;r++)formatTokenFunctions[e[r]]?e[r]=formatTokenFunctions[e[r]]:e[r]=removeFormattingTokens(e[r]);return function(n){var s="",o;for(o=0;o<i;o++)s+=isFunction$1(e[o])?e[o].call(n,t):e[o];return s}}function formatMoment(t,e){return t.isValid()?(e=expandFormat(e,t.localeData()),formatFunctions[e]=formatFunctions[e]||makeFormatFunction(e),formatFunctions[e](t)):t.localeData().invalidDate()}function expandFormat(t,e){var r=5;function i(n){return e.longDateFormat(n)||n}for(localFormattingTokens.lastIndex=0;r>=0&&localFormattingTokens.test(t);)t=t.replace(localFormattingTokens,i),localFormattingTokens.lastIndex=0,r-=1;return t}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(formattingTokens).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d",defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(t){return this._ordinal.replace("%d",t)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(t,e,r,i){var n=this._relativeTime[r];return isFunction$1(n)?n(t,e,r,i):n.replace(/%d/i,t)}function pastFuture(t,e){var r=this._relativeTime[t>0?"future":"past"];return isFunction$1(r)?r(e):r.replace(/%s/i,e)}var aliases={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function normalizeUnits(t){return typeof t=="string"?aliases[t]||aliases[t.toLowerCase()]:void 0}function normalizeObjectUnits(t){var e={},r,i;for(i in t)hasOwnProp(t,i)&&(r=normalizeUnits(i),r&&(e[r]=t[i]));return e}var priorities={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function getPrioritizedUnits(t){var e=[],r;for(r in t)hasOwnProp(t,r)&&e.push({unit:r,priority:priorities[r]});return e.sort(function(i,n){return i.priority-n.priority}),e}var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,match1to2NoLeadingZero=/^[1-9]\d?/,match1to2HasZero=/^([1-9]\d|\d)/,regexes;regexes={};function addRegexToken(t,e,r){regexes[t]=isFunction$1(e)?e:function(i,n){return i&&r?r:e}}function getParseRegexForToken(t,e){return hasOwnProp(regexes,t)?regexes[t](e._strict,e._locale):new RegExp(unescapeFormat(t))}function unescapeFormat(t){return regexEscape(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,i,n,s){return r||i||n||s}))}function regexEscape(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function absFloor(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function toInt(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=absFloor(e)),r}var tokens={};function addParseToken(t,e){var r,i=e,n;for(typeof t=="string"&&(t=[t]),isNumber(e)&&(i=function(s,o){o[e]=toInt(s)}),n=t.length,r=0;r<n;r++)tokens[t[r]]=i}function addWeekParseToken(t,e){addParseToken(t,function(r,i,n,s){n._w=n._w||{},e(r,n._w,n,s)})}function addTimeToArrayFromToken(t,e,r){e!=null&&hasOwnProp(tokens,t)&&tokens[t](e,r._a,r,t)}function isLeapYear$1(t){return t%4===0&&t%100!==0||t%400===0}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;addFormatToken("Y",0,0,function(){var t=this.year();return t<=9999?zeroFill(t,4):"+"+t});addFormatToken(0,["YY",2],0,function(){return this.year()%100});addFormatToken(0,["YYYY",4],0,"year");addFormatToken(0,["YYYYY",5],0,"year");addFormatToken(0,["YYYYYY",6,!0],0,"year");addRegexToken("Y",matchSigned);addRegexToken("YY",match1to2,match2);addRegexToken("YYYY",match1to4,match4);addRegexToken("YYYYY",match1to6,match6);addRegexToken("YYYYYY",match1to6,match6);addParseToken(["YYYYY","YYYYYY"],YEAR);addParseToken("YYYY",function(t,e){e[YEAR]=t.length===2?hooks.parseTwoDigitYear(t):toInt(t)});addParseToken("YY",function(t,e){e[YEAR]=hooks.parseTwoDigitYear(t)});addParseToken("Y",function(t,e){e[YEAR]=parseInt(t,10)});function daysInYear(t){return isLeapYear$1(t)?366:365}hooks.parseTwoDigitYear=function(t){return toInt(t)+(toInt(t)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",!0);function getIsLeapYear(){return isLeapYear$1(this.year())}function makeGetSet(t,e){return function(r){return r!=null?(set$1$1(this,t,r),hooks.updateOffset(this,e),this):get(this,t)}}function get(t,e){if(!t.isValid())return NaN;var r=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return i?r.getUTCSeconds():r.getSeconds();case"Minutes":return i?r.getUTCMinutes():r.getMinutes();case"Hours":return i?r.getUTCHours():r.getHours();case"Date":return i?r.getUTCDate():r.getDate();case"Day":return i?r.getUTCDay():r.getDay();case"Month":return i?r.getUTCMonth():r.getMonth();case"FullYear":return i?r.getUTCFullYear():r.getFullYear();default:return NaN}}function set$1$1(t,e,r){var i,n,s,o,a;if(!(!t.isValid()||isNaN(r))){switch(i=t._d,n=t._isUTC,e){case"Milliseconds":return void(n?i.setUTCMilliseconds(r):i.setMilliseconds(r));case"Seconds":return void(n?i.setUTCSeconds(r):i.setSeconds(r));case"Minutes":return void(n?i.setUTCMinutes(r):i.setMinutes(r));case"Hours":return void(n?i.setUTCHours(r):i.setHours(r));case"Date":return void(n?i.setUTCDate(r):i.setDate(r));case"FullYear":break;default:return}s=r,o=t.month(),a=t.date(),a=a===29&&o===1&&!isLeapYear$1(s)?28:a,n?i.setUTCFullYear(s,o,a):i.setFullYear(s,o,a)}}function stringGet(t){return t=normalizeUnits(t),isFunction$1(this[t])?this[t]():this}function stringSet(t,e){if(typeof t=="object"){t=normalizeObjectUnits(t);var r=getPrioritizedUnits(t),i,n=r.length;for(i=0;i<n;i++)this[r[i].unit](t[r[i].unit])}else if(t=normalizeUnits(t),isFunction$1(this[t]))return this[t](e);return this}function mod(t,e){return(t%e+e)%e}var indexOf;Array.prototype.indexOf?indexOf=Array.prototype.indexOf:indexOf=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function daysInMonth(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=mod(e,12);return t+=(e-r)/12,r===1?isLeapYear$1(t)?29:28:31-r%7%2}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1});addFormatToken("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});addFormatToken("MMMM",0,0,function(t){return this.localeData().months(this,t)});addRegexToken("M",match1to2,match1to2NoLeadingZero);addRegexToken("MM",match1to2,match2);addRegexToken("MMM",function(t,e){return e.monthsShortRegex(t)});addRegexToken("MMMM",function(t,e){return e.monthsRegex(t)});addParseToken(["M","MM"],function(t,e){e[MONTH]=toInt(t)-1});addParseToken(["MMM","MMMM"],function(t,e,r,i){var n=r._locale.monthsParse(t,i,r._strict);n!=null?e[MONTH]=n:getParsingFlags(r).invalidMonth=t});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function localeMonths(t,e){return t?isArray$1(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(e)?"format":"standalone"][t.month()]:isArray$1(this._months)?this._months:this._months.standalone}function localeMonthsShort(t,e){return t?isArray$1(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(e)?"format":"standalone"][t.month()]:isArray$1(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function handleStrictParse(t,e,r){var i,n,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)s=createUTC([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(s,"").toLocaleLowerCase();return r?e==="MMM"?(n=indexOf.call(this._shortMonthsParse,o),n!==-1?n:null):(n=indexOf.call(this._longMonthsParse,o),n!==-1?n:null):e==="MMM"?(n=indexOf.call(this._shortMonthsParse,o),n!==-1?n:(n=indexOf.call(this._longMonthsParse,o),n!==-1?n:null)):(n=indexOf.call(this._longMonthsParse,o),n!==-1?n:(n=indexOf.call(this._shortMonthsParse,o),n!==-1?n:null))}function localeMonthsParse(t,e,r){var i,n,s;if(this._monthsParseExact)return handleStrictParse.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(n=createUTC([2e3,i]),r&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),!r&&!this._monthsParse[i]&&(s="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(r&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!r&&this._monthsParse[i].test(t))return i}}function setMonth(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=toInt(e);else if(e=t.localeData().monthsParse(e),!isNumber(e))return t}var r=e,i=t.date();return i=i<29?i:Math.min(i,daysInMonth(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,i):t._d.setMonth(r,i),t}function getSetMonth(t){return t!=null?(setMonth(this,t),hooks.updateOffset(this,!0),this):get(this,"Month")}function getDaysInMonth$1(){return daysInMonth(this.year(),this.month())}function monthsShortRegex(t){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(hasOwnProp(this,"_monthsShortRegex")||(this._monthsShortRegex=defaultMonthsShortRegex),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function monthsRegex(t){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),t?this._monthsStrictRegex:this._monthsRegex):(hasOwnProp(this,"_monthsRegex")||(this._monthsRegex=defaultMonthsRegex),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function computeMonthsParse(){function t(l,c){return c.length-l.length}var e=[],r=[],i=[],n,s,o,a;for(n=0;n<12;n++)s=createUTC([2e3,n]),o=regexEscape(this.monthsShort(s,"")),a=regexEscape(this.months(s,"")),e.push(o),r.push(a),i.push(a),i.push(o);e.sort(t),r.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function createDate(t,e,r,i,n,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,i,n,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,i,n,s,o),a}function createUTCDate(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function firstWeekOffset(t,e,r){var i=7+e-r,n=(7+createUTCDate(t,0,i).getUTCDay()-e)%7;return-n+i-1}function dayOfYearFromWeeks(t,e,r,i,n){var s=(7+r-i)%7,o=firstWeekOffset(t,i,n),a=1+7*(e-1)+s+o,l,c;return a<=0?(l=t-1,c=daysInYear(l)+a):a>daysInYear(t)?(l=t+1,c=a-daysInYear(t)):(l=t,c=a),{year:l,dayOfYear:c}}function weekOfYear(t,e,r){var i=firstWeekOffset(t.year(),e,r),n=Math.floor((t.dayOfYear()-i-1)/7)+1,s,o;return n<1?(o=t.year()-1,s=n+weeksInYear(o,e,r)):n>weeksInYear(t.year(),e,r)?(s=n-weeksInYear(t.year(),e,r),o=t.year()+1):(o=t.year(),s=n),{week:s,year:o}}function weeksInYear(t,e,r){var i=firstWeekOffset(t,e,r),n=firstWeekOffset(t+1,e,r);return(daysInYear(t)-i+n)/7}addFormatToken("w",["ww",2],"wo","week");addFormatToken("W",["WW",2],"Wo","isoWeek");addRegexToken("w",match1to2,match1to2NoLeadingZero);addRegexToken("ww",match1to2,match2);addRegexToken("W",match1to2,match1to2NoLeadingZero);addRegexToken("WW",match1to2,match2);addWeekParseToken(["w","ww","W","WW"],function(t,e,r,i){e[i.substr(0,1)]=toInt(t)});function localeWeek(t){return weekOfYear(t,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function getSetISOWeek(t){var e=weekOfYear(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}addFormatToken("d",0,"do","day");addFormatToken("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});addFormatToken("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});addFormatToken("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});addFormatToken("e",0,0,"weekday");addFormatToken("E",0,0,"isoWeekday");addRegexToken("d",match1to2);addRegexToken("e",match1to2);addRegexToken("E",match1to2);addRegexToken("dd",function(t,e){return e.weekdaysMinRegex(t)});addRegexToken("ddd",function(t,e){return e.weekdaysShortRegex(t)});addRegexToken("dddd",function(t,e){return e.weekdaysRegex(t)});addWeekParseToken(["dd","ddd","dddd"],function(t,e,r,i){var n=r._locale.weekdaysParse(t,i,r._strict);n!=null?e.d=n:getParsingFlags(r).invalidWeekday=t});addWeekParseToken(["d","e","E"],function(t,e,r,i){e[i]=toInt(t)});function parseWeekday(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function parseIsoWeekday(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function shiftWeekdays(t,e){return t.slice(e,7).concat(t.slice(0,e))}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function localeWeekdays(t,e){var r=isArray$1(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?shiftWeekdays(r,this._week.dow):t?r[t.day()]:r}function localeWeekdaysShort(t){return t===!0?shiftWeekdays(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function localeWeekdaysMin(t){return t===!0?shiftWeekdays(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function handleStrictParse$1(t,e,r){var i,n,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)s=createUTC([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(s,"").toLocaleLowerCase();return r?e==="dddd"?(n=indexOf.call(this._weekdaysParse,o),n!==-1?n:null):e==="ddd"?(n=indexOf.call(this._shortWeekdaysParse,o),n!==-1?n:null):(n=indexOf.call(this._minWeekdaysParse,o),n!==-1?n:null):e==="dddd"?(n=indexOf.call(this._weekdaysParse,o),n!==-1||(n=indexOf.call(this._shortWeekdaysParse,o),n!==-1)?n:(n=indexOf.call(this._minWeekdaysParse,o),n!==-1?n:null)):e==="ddd"?(n=indexOf.call(this._shortWeekdaysParse,o),n!==-1||(n=indexOf.call(this._weekdaysParse,o),n!==-1)?n:(n=indexOf.call(this._minWeekdaysParse,o),n!==-1?n:null)):(n=indexOf.call(this._minWeekdaysParse,o),n!==-1||(n=indexOf.call(this._weekdaysParse,o),n!==-1)?n:(n=indexOf.call(this._shortWeekdaysParse,o),n!==-1?n:null))}function localeWeekdaysParse(t,e,r){var i,n,s;if(this._weekdaysParseExact)return handleStrictParse$1.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(n=createUTC([2e3,1]).day(i),r&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(s="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[i]=new RegExp(s.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(r&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(r&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!r&&this._weekdaysParse[i].test(t))return i}}function getSetDayOfWeek(t){if(!this.isValid())return t!=null?this:NaN;var e=get(this,"Day");return t!=null?(t=parseWeekday(t,this.localeData()),this.add(t-e,"d")):e}function getSetLocaleDayOfWeek(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function getSetISODayOfWeek(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=parseIsoWeekday(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function weekdaysRegex(t){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(hasOwnProp(this,"_weekdaysRegex")||(this._weekdaysRegex=defaultWeekdaysRegex),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function weekdaysShortRegex(t){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hasOwnProp(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=defaultWeekdaysShortRegex),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function weekdaysMinRegex(t){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hasOwnProp(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=defaultWeekdaysMinRegex),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function computeWeekdaysParse(){function t(u,d){return d.length-u.length}var e=[],r=[],i=[],n=[],s,o,a,l,c;for(s=0;s<7;s++)o=createUTC([2e3,1]).day(s),a=regexEscape(this.weekdaysMin(o,"")),l=regexEscape(this.weekdaysShort(o,"")),c=regexEscape(this.weekdays(o,"")),e.push(a),r.push(l),i.push(c),n.push(a),n.push(l),n.push(c);e.sort(t),r.sort(t),i.sort(t),n.sort(t),this._weekdaysRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}addFormatToken("H",["HH",2],0,"hour");addFormatToken("h",["hh",2],0,hFormat);addFormatToken("k",["kk",2],0,kFormat);addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)});addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)});addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});function meridiem(t,e){addFormatToken(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}meridiem("a",!0);meridiem("A",!1);function matchMeridiem(t,e){return e._meridiemParse}addRegexToken("a",matchMeridiem);addRegexToken("A",matchMeridiem);addRegexToken("H",match1to2,match1to2HasZero);addRegexToken("h",match1to2,match1to2NoLeadingZero);addRegexToken("k",match1to2,match1to2NoLeadingZero);addRegexToken("HH",match1to2,match2);addRegexToken("hh",match1to2,match2);addRegexToken("kk",match1to2,match2);addRegexToken("hmm",match3to4);addRegexToken("hmmss",match5to6);addRegexToken("Hmm",match3to4);addRegexToken("Hmmss",match5to6);addParseToken(["H","HH"],HOUR);addParseToken(["k","kk"],function(t,e,r){var i=toInt(t);e[HOUR]=i===24?0:i});addParseToken(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});addParseToken(["h","hh"],function(t,e,r){e[HOUR]=toInt(t),getParsingFlags(r).bigHour=!0});addParseToken("hmm",function(t,e,r){var i=t.length-2;e[HOUR]=toInt(t.substr(0,i)),e[MINUTE]=toInt(t.substr(i)),getParsingFlags(r).bigHour=!0});addParseToken("hmmss",function(t,e,r){var i=t.length-4,n=t.length-2;e[HOUR]=toInt(t.substr(0,i)),e[MINUTE]=toInt(t.substr(i,2)),e[SECOND]=toInt(t.substr(n)),getParsingFlags(r).bigHour=!0});addParseToken("Hmm",function(t,e,r){var i=t.length-2;e[HOUR]=toInt(t.substr(0,i)),e[MINUTE]=toInt(t.substr(i))});addParseToken("Hmmss",function(t,e,r){var i=t.length-4,n=t.length-2;e[HOUR]=toInt(t.substr(0,i)),e[MINUTE]=toInt(t.substr(i,2)),e[SECOND]=toInt(t.substr(n))});function localeIsPM(t){return(t+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",!0);function localeMeridiem(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse},locales={},localeFamilies={},globalLocale;function commonPrefix(t,e){var r,i=Math.min(t.length,e.length);for(r=0;r<i;r+=1)if(t[r]!==e[r])return r;return i}function normalizeLocale(t){return t&&t.toLowerCase().replace("_","-")}function chooseLocale(t){for(var e=0,r,i,n,s;e<t.length;){for(s=normalizeLocale(t[e]).split("-"),r=s.length,i=normalizeLocale(t[e+1]),i=i?i.split("-"):null;r>0;){if(n=loadLocale(s.slice(0,r).join("-")),n)return n;if(i&&i.length>=r&&commonPrefix(s,i)>=r-1)break;r--}e++}return globalLocale}function isLocaleNameSane(t){return!!(t&&t.match("^[^/\\\\]*$"))}function loadLocale(t){var e=null,r;if(locales[t]===void 0&&typeof module<"u"&&module&&module.exports&&isLocaleNameSane(t))try{e=globalLocale._abbr,r=require,r("./locale/"+t),getSetGlobalLocale(e)}catch{locales[t]=null}return locales[t]}function getSetGlobalLocale(t,e){var r;return t&&(isUndefined$1(e)?r=getLocale(t):r=defineLocale(t,e),r?globalLocale=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),globalLocale._abbr}function defineLocale(t,e){if(e!==null){var r,i=baseConfig;if(e.abbr=t,locales[t]!=null)deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=locales[t]._config;else if(e.parentLocale!=null)if(locales[e.parentLocale]!=null)i=locales[e.parentLocale]._config;else if(r=loadLocale(e.parentLocale),r!=null)i=r._config;else return localeFamilies[e.parentLocale]||(localeFamilies[e.parentLocale]=[]),localeFamilies[e.parentLocale].push({name:t,config:e}),null;return locales[t]=new Locale(mergeConfigs(i,e)),localeFamilies[t]&&localeFamilies[t].forEach(function(n){defineLocale(n.name,n.config)}),getSetGlobalLocale(t),locales[t]}else return delete locales[t],null}function updateLocale(t,e){if(e!=null){var r,i,n=baseConfig;locales[t]!=null&&locales[t].parentLocale!=null?locales[t].set(mergeConfigs(locales[t]._config,e)):(i=loadLocale(t),i!=null&&(n=i._config),e=mergeConfigs(n,e),i==null&&(e.abbr=t),r=new Locale(e),r.parentLocale=locales[t],locales[t]=r),getSetGlobalLocale(t)}else locales[t]!=null&&(locales[t].parentLocale!=null?(locales[t]=locales[t].parentLocale,t===getSetGlobalLocale()&&getSetGlobalLocale(t)):locales[t]!=null&&delete locales[t]);return locales[t]}function getLocale(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return globalLocale;if(!isArray$1(t)){if(e=loadLocale(t),e)return e;t=[t]}return chooseLocale(t)}function listLocales(){return keys(locales)}function checkOverflow(t){var e,r=t._a;return r&&getParsingFlags(t).overflow===-2&&(e=r[MONTH]<0||r[MONTH]>11?MONTH:r[DATE]<1||r[DATE]>daysInMonth(r[YEAR],r[MONTH])?DATE:r[HOUR]<0||r[HOUR]>24||r[HOUR]===24&&(r[MINUTE]!==0||r[SECOND]!==0||r[MILLISECOND]!==0)?HOUR:r[MINUTE]<0||r[MINUTE]>59?MINUTE:r[SECOND]<0||r[SECOND]>59?SECOND:r[MILLISECOND]<0||r[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(t)._overflowDayOfYear&&(e<YEAR||e>DATE)&&(e=DATE),getParsingFlags(t)._overflowWeeks&&e===-1&&(e=WEEK),getParsingFlags(t)._overflowWeekday&&e===-1&&(e=WEEKDAY),getParsingFlags(t).overflow=e),t}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function configFromISO(t){var e,r,i=t._i,n=extendedIsoRegex.exec(i)||basicIsoRegex.exec(i),s,o,a,l,c=isoDates.length,u=isoTimes.length;if(n){for(getParsingFlags(t).iso=!0,e=0,r=c;e<r;e++)if(isoDates[e][1].exec(n[1])){o=isoDates[e][0],s=isoDates[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(n[3]){for(e=0,r=u;e<r;e++)if(isoTimes[e][1].exec(n[3])){a=(n[2]||" ")+isoTimes[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(n[4])if(tzRegex.exec(n[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),configFromStringAndFormat(t)}else t._isValid=!1}function extractFromRFC2822Strings(t,e,r,i,n,s){var o=[untruncateYear(t),defaultLocaleMonthsShort.indexOf(e),parseInt(r,10),parseInt(i,10),parseInt(n,10)];return s&&o.push(parseInt(s,10)),o}function untruncateYear(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function preprocessRFC2822(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(t,e,r){if(t){var i=defaultLocaleWeekdaysShort.indexOf(t),n=new Date(e[0],e[1],e[2]).getDay();if(i!==n)return getParsingFlags(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function calculateOffset(t,e,r){if(t)return obsOffsets[t];if(e)return 0;var i=parseInt(r,10),n=i%100,s=(i-n)/100;return s*60+n}function configFromRFC2822(t){var e=rfc2822.exec(preprocessRFC2822(t._i)),r;if(e){if(r=extractFromRFC2822Strings(e[4],e[3],e[2],e[5],e[6],e[7]),!checkWeekday(e[1],r,t))return;t._a=r,t._tzm=calculateOffset(e[8],e[9],e[10]),t._d=createUTCDate.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),getParsingFlags(t).rfc2822=!0}else t._isValid=!1}function configFromString(t){var e=aspNetJsonRegex.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(configFromISO(t),t._isValid===!1)delete t._isValid;else return;if(configFromRFC2822(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:hooks.createFromInputFallback(t)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function defaults$1(t,e,r){return t??e??r}function currentDateArray(t){var e=new Date(hooks.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function configFromArray(t){var e,r,i=[],n,s,o;if(!t._d){for(n=currentDateArray(t),t._w&&t._a[DATE]==null&&t._a[MONTH]==null&&dayOfYearFromWeekInfo(t),t._dayOfYear!=null&&(o=defaults$1(t._a[YEAR],n[YEAR]),(t._dayOfYear>daysInYear(o)||t._dayOfYear===0)&&(getParsingFlags(t)._overflowDayOfYear=!0),r=createUTCDate(o,0,t._dayOfYear),t._a[MONTH]=r.getUTCMonth(),t._a[DATE]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=n[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[HOUR]===24&&t._a[MINUTE]===0&&t._a[SECOND]===0&&t._a[MILLISECOND]===0&&(t._nextDay=!0,t._a[HOUR]=0),t._d=(t._useUTC?createUTCDate:createDate).apply(null,i),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[HOUR]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(getParsingFlags(t).weekdayMismatch=!0)}}function dayOfYearFromWeekInfo(t){var e,r,i,n,s,o,a,l,c;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,r=defaults$1(e.GG,t._a[YEAR],weekOfYear(createLocal(),1,4).year),i=defaults$1(e.W,1),n=defaults$1(e.E,1),(n<1||n>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,c=weekOfYear(createLocal(),s,o),r=defaults$1(e.gg,t._a[YEAR],c.year),i=defaults$1(e.w,c.week),e.d!=null?(n=e.d,(n<0||n>6)&&(l=!0)):e.e!=null?(n=e.e+s,(e.e<0||e.e>6)&&(l=!0)):n=s),i<1||i>weeksInYear(r,s,o)?getParsingFlags(t)._overflowWeeks=!0:l!=null?getParsingFlags(t)._overflowWeekday=!0:(a=dayOfYearFromWeeks(r,i,n,s,o),t._a[YEAR]=a.year,t._dayOfYear=a.dayOfYear)}hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(t){if(t._f===hooks.ISO_8601){configFromISO(t);return}if(t._f===hooks.RFC_2822){configFromRFC2822(t);return}t._a=[],getParsingFlags(t).empty=!0;var e=""+t._i,r,i,n,s,o,a=e.length,l=0,c,u;for(n=expandFormat(t._f,t._locale).match(formattingTokens)||[],u=n.length,r=0;r<u;r++)s=n[r],i=(e.match(getParseRegexForToken(s,t))||[])[0],i&&(o=e.substr(0,e.indexOf(i)),o.length>0&&getParsingFlags(t).unusedInput.push(o),e=e.slice(e.indexOf(i)+i.length),l+=i.length),formatTokenFunctions[s]?(i?getParsingFlags(t).empty=!1:getParsingFlags(t).unusedTokens.push(s),addTimeToArrayFromToken(s,i,t)):t._strict&&!i&&getParsingFlags(t).unusedTokens.push(s);getParsingFlags(t).charsLeftOver=a-l,e.length>0&&getParsingFlags(t).unusedInput.push(e),t._a[HOUR]<=12&&getParsingFlags(t).bigHour===!0&&t._a[HOUR]>0&&(getParsingFlags(t).bigHour=void 0),getParsingFlags(t).parsedDateParts=t._a.slice(0),getParsingFlags(t).meridiem=t._meridiem,t._a[HOUR]=meridiemFixWrap(t._locale,t._a[HOUR],t._meridiem),c=getParsingFlags(t).era,c!==null&&(t._a[YEAR]=t._locale.erasConvertYear(c,t._a[YEAR])),configFromArray(t),checkOverflow(t)}function meridiemFixWrap(t,e,r){var i;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(i=t.isPM(r),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function configFromStringAndArray(t){var e,r,i,n,s,o,a=!1,l=t._f.length;if(l===0){getParsingFlags(t).invalidFormat=!0,t._d=new Date(NaN);return}for(n=0;n<l;n++)s=0,o=!1,e=copyConfig({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[n],configFromStringAndFormat(e),isValid(e)&&(o=!0),s+=getParsingFlags(e).charsLeftOver,s+=getParsingFlags(e).unusedTokens.length*10,getParsingFlags(e).score=s,a?s<i&&(i=s,r=e):(i==null||s<i||o)&&(i=s,r=e,o&&(a=!0));extend$2(t,r||e)}function configFromObject(t){if(!t._d){var e=normalizeObjectUnits(t._i),r=e.day===void 0?e.date:e.day;t._a=map([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),configFromArray(t)}}function createFromConfig(t){var e=new Moment(checkOverflow(prepareConfig(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function prepareConfig(t){var e=t._i,r=t._f;return t._locale=t._locale||getLocale(t._l),e===null||r===void 0&&e===""?createInvalid({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),isMoment(e)?new Moment(checkOverflow(e)):(isDate$2(e)?t._d=e:isArray$1(r)?configFromStringAndArray(t):r?configFromStringAndFormat(t):configFromInput(t),isValid(t)||(t._d=null),t))}function configFromInput(t){var e=t._i;isUndefined$1(e)?t._d=new Date(hooks.now()):isDate$2(e)?t._d=new Date(e.valueOf()):typeof e=="string"?configFromString(t):isArray$1(e)?(t._a=map(e.slice(0),function(r){return parseInt(r,10)}),configFromArray(t)):isObject$1(e)?configFromObject(t):isNumber(e)?t._d=new Date(e):hooks.createFromInputFallback(t)}function createLocalOrUTC(t,e,r,i,n){var s={};return(e===!0||e===!1)&&(i=e,e=void 0),(r===!0||r===!1)&&(i=r,r=void 0),(isObject$1(t)&&isObjectEmpty(t)||isArray$1(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=n,s._l=r,s._i=t,s._f=e,s._strict=i,createFromConfig(s)}function createLocal(t,e,r,i){return createLocalOrUTC(t,e,r,i,!1)}var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=createLocal.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:createInvalid()}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=createLocal.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:createInvalid()});function pickBy(t,e){var r,i;if(e.length===1&&isArray$1(e[0])&&(e=e[0]),!e.length)return createLocal();for(r=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](r))&&(r=e[i]);return r}function min(){var t=[].slice.call(arguments,0);return pickBy("isBefore",t)}function max(){var t=[].slice.call(arguments,0);return pickBy("isAfter",t)}var now=function(){return Date.now?Date.now():+new Date},ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(t){var e,r=!1,i,n=ordering.length;for(e in t)if(hasOwnProp(t,e)&&!(indexOf.call(ordering,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<n;++i)if(t[ordering[i]]){if(r)return!1;parseFloat(t[ordering[i]])!==toInt(t[ordering[i]])&&(r=!0)}return!0}function isValid$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(t){var e=normalizeObjectUnits(t),r=e.year||0,i=e.quarter||0,n=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,c=e.second||0,u=e.millisecond||0;this._isValid=isDurationValid(e),this._milliseconds=+u+c*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+n+i*3+r*12,this._data={},this._locale=getLocale(),this._bubble()}function isDuration(t){return t instanceof Duration}function absRound(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function compareArrays(t,e,r){var i=Math.min(t.length,e.length),n=Math.abs(t.length-e.length),s=0,o;for(o=0;o<i;o++)toInt(t[o])!==toInt(e[o])&&s++;return s+n}function offset$1(t,e){addFormatToken(t,0,0,function(){var r=this.utcOffset(),i="+";return r<0&&(r=-r,i="-"),i+zeroFill(~~(r/60),2)+e+zeroFill(~~r%60,2)})}offset$1("Z",":");offset$1("ZZ","");addRegexToken("Z",matchShortOffset);addRegexToken("ZZ",matchShortOffset);addParseToken(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=offsetFromString(matchShortOffset,t)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(t,e){var r=(e||"").match(t),i,n,s;return r===null?null:(i=r[r.length-1]||[],n=(i+"").match(chunkOffset)||["-",0,0],s=+(n[1]*60)+toInt(n[2]),s===0?0:n[0]==="+"?s:-s)}function cloneWithOffset(t,e){var r,i;return e._isUTC?(r=e.clone(),i=(isMoment(t)||isDate$2(t)?t.valueOf():createLocal(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+i),hooks.updateOffset(r,!1),r):createLocal(t).local()}function getDateOffset(t){return-Math.round(t._d.getTimezoneOffset())}hooks.updateOffset=function(){};function getSetOffset(t,e,r){var i=this._offset||0,n;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=offsetFromString(matchShortOffset,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(n=getDateOffset(this)),this._offset=t,this._isUTC=!0,n!=null&&this.add(n,"m"),i!==t&&(!e||this._changeInProgress?addSubtract(this,createDuration(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,hooks.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:getDateOffset(this)}function getSetZone(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function setOffsetToUTC(t){return this.utcOffset(0,t)}function setOffsetToLocal(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(getDateOffset(this),"m")),this}function setOffsetToParsedOffset(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=offsetFromString(matchOffset,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function hasAlignedHourOffset(t){return this.isValid()?(t=t?createLocal(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined$1(this._isDSTShifted))return this._isDSTShifted;var t={},e;return copyConfig(t,this),t=prepareConfig(t),t._a?(e=t._isUTC?createUTC(t._a):createLocal(t._a),this._isDSTShifted=this.isValid()&&compareArrays(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function isLocal(){return this.isValid()?!this._isUTC:!1}function isUtcOffset(){return this.isValid()?this._isUTC:!1}function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:!1}var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(t,e){var r=t,i=null,n,s,o;return isDuration(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:isNumber(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(i=aspNetRegex.exec(t))?(n=i[1]==="-"?-1:1,r={y:0,d:toInt(i[DATE])*n,h:toInt(i[HOUR])*n,m:toInt(i[MINUTE])*n,s:toInt(i[SECOND])*n,ms:toInt(absRound(i[MILLISECOND]*1e3))*n}):(i=isoRegex.exec(t))?(n=i[1]==="-"?-1:1,r={y:parseIso(i[2],n),M:parseIso(i[3],n),w:parseIso(i[4],n),d:parseIso(i[5],n),h:parseIso(i[6],n),m:parseIso(i[7],n),s:parseIso(i[8],n)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=momentsDifference(createLocal(r.from),createLocal(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),s=new Duration(r),isDuration(t)&&hasOwnProp(t,"_locale")&&(s._locale=t._locale),isDuration(t)&&hasOwnProp(t,"_isValid")&&(s._isValid=t._isValid),s}createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function positiveMomentsDifference(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function momentsDifference(t,e){var r;return t.isValid()&&e.isValid()?(e=cloneWithOffset(e,t),t.isBefore(e)?r=positiveMomentsDifference(t,e):(r=positiveMomentsDifference(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function createAdder(t,e){return function(r,i){var n,s;return i!==null&&!isNaN(+i)&&(deprecateSimple(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=i,i=s),n=createDuration(r,i),addSubtract(this,n,t),this}}function addSubtract(t,e,r,i){var n=e._milliseconds,s=absRound(e._days),o=absRound(e._months);t.isValid()&&(i=i??!0,o&&setMonth(t,get(t,"Month")+o*r),s&&set$1$1(t,"Date",get(t,"Date")+s*r),n&&t._d.setTime(t._d.valueOf()+n*r),i&&hooks.updateOffset(t,s||o))}var add$1=createAdder(1,"add"),subtract$1=createAdder(-1,"subtract");function isString(t){return typeof t=="string"||t instanceof String}function isMomentInput(t){return isMoment(t)||isDate$2(t)||isString(t)||isNumber(t)||isNumberOrStringArray(t)||isMomentInputObject(t)||t===null||t===void 0}function isMomentInputObject(t){var e=isObject$1(t)&&!isObjectEmpty(t),r=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],n,s,o=i.length;for(n=0;n<o;n+=1)s=i[n],r=r||hasOwnProp(t,s);return e&&r}function isNumberOrStringArray(t){var e=isArray$1(t),r=!1;return e&&(r=t.filter(function(i){return!isNumber(i)&&isString(t)}).length===0),e&&r}function isCalendarSpec(t){var e=isObject$1(t)&&!isObjectEmpty(t),r=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],n,s;for(n=0;n<i.length;n+=1)s=i[n],r=r||hasOwnProp(t,s);return e&&r}function getCalendarFormat(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function calendar$1(t,e){arguments.length===1&&(arguments[0]?isMomentInput(arguments[0])?(t=arguments[0],e=void 0):isCalendarSpec(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||createLocal(),i=cloneWithOffset(r,this).startOf("day"),n=hooks.calendarFormat(this,i)||"sameElse",s=e&&(isFunction$1(e[n])?e[n].call(this,r):e[n]);return this.format(s||this.localeData().calendar(n,this,createLocal(r)))}function clone$1(){return new Moment(this)}function isAfter(t,e){var r=isMoment(t)?t:createLocal(t);return this.isValid()&&r.isValid()?(e=normalizeUnits(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function isBefore(t,e){var r=isMoment(t)?t:createLocal(t);return this.isValid()&&r.isValid()?(e=normalizeUnits(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function isBetween(t,e,r,i){var n=isMoment(t)?t:createLocal(t),s=isMoment(e)?e:createLocal(e);return this.isValid()&&n.isValid()&&s.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(n,r):!this.isBefore(n,r))&&(i[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function isSame(t,e){var r=isMoment(t)?t:createLocal(t),i;return this.isValid()&&r.isValid()?(e=normalizeUnits(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(i=r.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function isSameOrAfter(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function isSameOrBefore(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function diff(t,e,r){var i,n,s;if(!this.isValid())return NaN;if(i=cloneWithOffset(t,this),!i.isValid())return NaN;switch(n=(i.utcOffset()-this.utcOffset())*6e4,e=normalizeUnits(e),e){case"year":s=monthDiff(this,i)/12;break;case"month":s=monthDiff(this,i);break;case"quarter":s=monthDiff(this,i)/3;break;case"second":s=(this-i)/1e3;break;case"minute":s=(this-i)/6e4;break;case"hour":s=(this-i)/36e5;break;case"day":s=(this-i-n)/864e5;break;case"week":s=(this-i-n)/6048e5;break;default:s=this-i}return r?s:absFloor(s)}function monthDiff(t,e){if(t.date()<e.date())return-monthDiff(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(r,"months"),n,s;return e-i<0?(n=t.clone().add(r-1,"months"),s=(e-i)/(i-n)):(n=t.clone().add(r+1,"months"),s=(e-i)/(n-i)),-(r+s)||0}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?formatMoment(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):isFunction$1(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",formatMoment(r,"Z")):formatMoment(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,i,n,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(r+i+n+s)}function format$1(t){t||(t=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat);var e=formatMoment(this,t);return this.localeData().postformat(e)}function from(t,e){return this.isValid()&&(isMoment(t)&&t.isValid()||createLocal(t).isValid())?createDuration({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function fromNow(t){return this.from(createLocal(),t)}function to(t,e){return this.isValid()&&(isMoment(t)&&t.isValid()||createLocal(t).isValid())?createDuration({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function toNow(t){return this.to(createLocal(),t)}function locale(t){var e;return t===void 0?this._locale._abbr:(e=getLocale(t),e!=null&&(this._locale=e),this)}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=(365*400+97)*24*MS_PER_HOUR;function mod$1(t,e){return(t%e+e)%e}function localStartOfDate(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-MS_PER_400_YEARS:new Date(t,e,r).valueOf()}function utcStartOfDate(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-MS_PER_400_YEARS:Date.UTC(t,e,r)}function startOf(t){var e,r;if(t=normalizeUnits(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?utcStartOfDate:localStartOfDate,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=mod$1(e+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":e=this._d.valueOf(),e-=mod$1(e,MS_PER_MINUTE);break;case"second":e=this._d.valueOf(),e-=mod$1(e,MS_PER_SECOND);break}return this._d.setTime(e),hooks.updateOffset(this,!0),this}function endOf(t){var e,r;if(t=normalizeUnits(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?utcStartOfDate:localStartOfDate,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=MS_PER_HOUR-mod$1(e+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":e=this._d.valueOf(),e+=MS_PER_MINUTE-mod$1(e,MS_PER_MINUTE)-1;break;case"second":e=this._d.valueOf(),e+=MS_PER_SECOND-mod$1(e,MS_PER_SECOND)-1;break}return this._d.setTime(e),hooks.updateOffset(this,!0),this}function valueOf(){return this._d.valueOf()-(this._offset||0)*6e4}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function toObject(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid(this)}function parsingFlags(){return extend$2({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}addFormatToken("N",0,0,"eraAbbr");addFormatToken("NN",0,0,"eraAbbr");addFormatToken("NNN",0,0,"eraAbbr");addFormatToken("NNNN",0,0,"eraName");addFormatToken("NNNNN",0,0,"eraNarrow");addFormatToken("y",["y",1],"yo","eraYear");addFormatToken("y",["yy",2],0,"eraYear");addFormatToken("y",["yyy",3],0,"eraYear");addFormatToken("y",["yyyy",4],0,"eraYear");addRegexToken("N",matchEraAbbr);addRegexToken("NN",matchEraAbbr);addRegexToken("NNN",matchEraAbbr);addRegexToken("NNNN",matchEraName);addRegexToken("NNNNN",matchEraNarrow);addParseToken(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,i){var n=r._locale.erasParse(t,i,r._strict);n?getParsingFlags(r).era=n:getParsingFlags(r).invalidEra=t});addRegexToken("y",matchUnsigned);addRegexToken("yy",matchUnsigned);addRegexToken("yyy",matchUnsigned);addRegexToken("yyyy",matchUnsigned);addRegexToken("yo",matchEraYearOrdinal);addParseToken(["y","yy","yyy","yyyy"],YEAR);addParseToken(["yo"],function(t,e,r,i){var n;r._locale._eraYearOrdinalRegex&&(n=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[YEAR]=r._locale.eraYearOrdinalParse(t,n):e[YEAR]=parseInt(t,10)});function localeEras(t,e){var r,i,n,s=this._eras||getLocale("en")._eras;for(r=0,i=s.length;r<i;++r){switch(typeof s[r].since){case"string":n=hooks(s[r].since).startOf("day"),s[r].since=n.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":n=hooks(s[r].until).startOf("day").valueOf(),s[r].until=n.valueOf();break}}return s}function localeErasParse(t,e,r){var i,n,s=this.eras(),o,a,l;for(t=t.toUpperCase(),i=0,n=s.length;i<n;++i)if(o=s[i].name.toUpperCase(),a=s[i].abbr.toUpperCase(),l=s[i].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[i];break;case"NNNN":if(o===t)return s[i];break;case"NNNNN":if(l===t)return s[i];break}else if([o,a,l].indexOf(t)>=0)return s[i]}function localeErasConvertYear(t,e){var r=t.since<=t.until?1:-1;return e===void 0?hooks(t.since).year():hooks(t.since).year()+(e-t.offset)*r}function getEraName(){var t,e,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return i[t].name;return""}function getEraNarrow(){var t,e,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return i[t].narrow;return""}function getEraAbbr(){var t,e,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return i[t].abbr;return""}function getEraYear(){var t,e,r,i,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=n[t].since<=n[t].until?1:-1,i=this.clone().startOf("day").valueOf(),n[t].since<=i&&i<=n[t].until||n[t].until<=i&&i<=n[t].since)return(this.year()-hooks(n[t].since).year())*r+n[t].offset;return this.year()}function erasNameRegex(t){return hasOwnProp(this,"_erasNameRegex")||computeErasParse.call(this),t?this._erasNameRegex:this._erasRegex}function erasAbbrRegex(t){return hasOwnProp(this,"_erasAbbrRegex")||computeErasParse.call(this),t?this._erasAbbrRegex:this._erasRegex}function erasNarrowRegex(t){return hasOwnProp(this,"_erasNarrowRegex")||computeErasParse.call(this),t?this._erasNarrowRegex:this._erasRegex}function matchEraAbbr(t,e){return e.erasAbbrRegex(t)}function matchEraName(t,e){return e.erasNameRegex(t)}function matchEraNarrow(t,e){return e.erasNarrowRegex(t)}function matchEraYearOrdinal(t,e){return e._eraYearOrdinalRegex||matchUnsigned}function computeErasParse(){var t=[],e=[],r=[],i=[],n,s,o,a,l,c=this.eras();for(n=0,s=c.length;n<s;++n)o=regexEscape(c[n].name),a=regexEscape(c[n].abbr),l=regexEscape(c[n].narrow),e.push(o),t.push(a),r.push(l),i.push(o),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100});addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(t,e){addFormatToken(0,[t,t.length],0,e)}addWeekYearFormatToken("gggg","weekYear");addWeekYearFormatToken("ggggg","weekYear");addWeekYearFormatToken("GGGG","isoWeekYear");addWeekYearFormatToken("GGGGG","isoWeekYear");addRegexToken("G",matchSigned);addRegexToken("g",matchSigned);addRegexToken("GG",match1to2,match2);addRegexToken("gg",match1to2,match2);addRegexToken("GGGG",match1to4,match4);addRegexToken("gggg",match1to4,match4);addRegexToken("GGGGG",match1to6,match6);addRegexToken("ggggg",match1to6,match6);addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,i){e[i.substr(0,2)]=toInt(t)});addWeekParseToken(["gg","GG"],function(t,e,r,i){e[i]=hooks.parseTwoDigitYear(t)});function getSetWeekYear(t){return getSetWeekYearHelper.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(t){return getSetWeekYearHelper.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getISOWeeksInISOWeekYear(){return weeksInYear(this.isoWeekYear(),1,4)}function getWeeksInYear(){var t=this.localeData()._week;return weeksInYear(this.year(),t.dow,t.doy)}function getWeeksInWeekYear(){var t=this.localeData()._week;return weeksInYear(this.weekYear(),t.dow,t.doy)}function getSetWeekYearHelper(t,e,r,i,n){var s;return t==null?weekOfYear(this,i,n).year:(s=weeksInYear(t,i,n),e>s&&(e=s),setWeekAll.call(this,t,e,r,i,n))}function setWeekAll(t,e,r,i,n){var s=dayOfYearFromWeeks(t,e,r,i,n),o=createUTCDate(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}addFormatToken("Q",0,"Qo","quarter");addRegexToken("Q",match1);addParseToken("Q",function(t,e){e[MONTH]=(toInt(t)-1)*3});function getSetQuarter(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date");addRegexToken("D",match1to2,match1to2NoLeadingZero);addRegexToken("DD",match1to2,match2);addRegexToken("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});addParseToken(["D","DD"],DATE);addParseToken("Do",function(t,e){e[DATE]=toInt(t.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",!0);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear");addRegexToken("DDD",match1to3);addRegexToken("DDDD",match3);addParseToken(["DDD","DDDD"],function(t,e,r){r._dayOfYear=toInt(t)});function getSetDayOfYear(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}addFormatToken("m",["mm",2],0,"minute");addRegexToken("m",match1to2,match1to2HasZero);addRegexToken("mm",match1to2,match2);addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second");addRegexToken("s",match1to2,match1to2HasZero);addRegexToken("ss",match1to2,match2);addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",!1);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)});addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)});addFormatToken(0,["SSS",3],0,"millisecond");addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10});addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100});addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});addRegexToken("S",match1to3,match1);addRegexToken("SS",match1to3,match2);addRegexToken("SSS",match1to3,match3);var token,getSetMillisecond;for(token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);function parseMs(t,e){e[MILLISECOND]=toInt(("0."+t)*1e3)}for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);getSetMillisecond=makeGetSet("Milliseconds",!1);addFormatToken("z",0,0,"zoneAbbr");addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var proto=Moment.prototype;proto.add=add$1;proto.calendar=calendar$1;proto.clone=clone$1;proto.diff=diff;proto.endOf=endOf;proto.format=format$1;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$2;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract$1;proto.toArray=toArray;proto.toObject=toObject;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;typeof Symbol<"u"&&Symbol.for!=null&&(proto[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});proto.toJSON=toJSON;proto.toString=toString;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.eraName=getEraName;proto.eraNarrow=getEraNarrow;proto.eraAbbr=getEraAbbr;proto.eraYear=getEraYear;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth$1;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.weeksInWeekYear=getWeeksInWeekYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.isoWeeksInISOWeekYear=getISOWeeksInISOWeekYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth);proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth);proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear);proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone);proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);function createUnix(t){return createLocal(t*1e3)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(t){return t}var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set$1;proto$1.eras=localeEras;proto$1.erasParse=localeErasParse;proto$1.erasConvertYear=localeErasConvertYear;proto$1.erasAbbrRegex=erasAbbrRegex;proto$1.erasNameRegex=erasNameRegex;proto$1.erasNarrowRegex=erasNarrowRegex;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1(t,e,r,i){var n=getLocale(),s=createUTC().set(i,e);return n[r](s,t)}function listMonthsImpl(t,e,r){if(isNumber(t)&&(e=t,t=void 0),t=t||"",e!=null)return get$1(t,e,r,"month");var i,n=[];for(i=0;i<12;i++)n[i]=get$1(t,i,r,"month");return n}function listWeekdaysImpl(t,e,r,i){typeof t=="boolean"?(isNumber(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,isNumber(e)&&(r=e,e=void 0),e=e||"");var n=getLocale(),s=t?n._week.dow:0,o,a=[];if(r!=null)return get$1(e,(r+s)%7,i,"day");for(o=0;o<7;o++)a[o]=get$1(e,(o+s)%7,i,"day");return a}function listMonths(t,e){return listMonthsImpl(t,e,"months")}function listMonthsShort(t,e){return listMonthsImpl(t,e,"monthsShort")}function listWeekdays(t,e,r){return listWeekdaysImpl(t,e,r,"weekdays")}function listWeekdaysShort(t,e,r){return listWeekdaysImpl(t,e,r,"weekdaysShort")}function listWeekdaysMin(t,e,r){return listWeekdaysImpl(t,e,r,"weekdaysMin")}getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=toInt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale);hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs(){var t=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),t.milliseconds=mathAbs(t.milliseconds),t.seconds=mathAbs(t.seconds),t.minutes=mathAbs(t.minutes),t.hours=mathAbs(t.hours),t.months=mathAbs(t.months),t.years=mathAbs(t.years),this}function addSubtract$1(t,e,r,i){var n=createDuration(e,r);return t._milliseconds+=i*n._milliseconds,t._days+=i*n._days,t._months+=i*n._months,t._bubble()}function add$1$1(t,e){return addSubtract$1(this,t,e,1)}function subtract$1$1(t,e){return addSubtract$1(this,t,e,-1)}function absCeil(t){return t<0?Math.floor(t):Math.ceil(t)}function bubble(){var t=this._milliseconds,e=this._days,r=this._months,i=this._data,n,s,o,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=absCeil(monthsToDays(r)+e)*864e5,e=0,r=0),i.milliseconds=t%1e3,n=absFloor(t/1e3),i.seconds=n%60,s=absFloor(n/60),i.minutes=s%60,o=absFloor(s/60),i.hours=o%24,e+=absFloor(o/24),l=absFloor(daysToMonths(e)),r+=l,e-=absCeil(monthsToDays(l)),a=absFloor(r/12),r%=12,i.days=e,i.months=r,i.years=a,this}function daysToMonths(t){return t*4800/146097}function monthsToDays(t){return t*146097/4800}function as(t){if(!this.isValid())return NaN;var e,r,i=this._milliseconds;if(t=normalizeUnits(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,r=this._months+daysToMonths(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(monthsToDays(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function makeAs(t){return function(){return this.as(t)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y"),valueOf$1=asMilliseconds;function clone$1$1(){return createDuration(this)}function get$2(t){return t=normalizeUnits(t),this.isValid()?this[t+"s"]():NaN}function makeGetter(t){return function(){return this.isValid()?this._data[t]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function substituteTimeAgo(t,e,r,i,n){return n.relativeTime(e||1,!!r,t,i)}function relativeTime$1(t,e,r,i){var n=createDuration(t).abs(),s=round(n.as("s")),o=round(n.as("m")),a=round(n.as("h")),l=round(n.as("d")),c=round(n.as("M")),u=round(n.as("w")),d=round(n.as("y")),h=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||o<=1&&["m"]||o<r.m&&["mm",o]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(h=h||u<=1&&["w"]||u<r.w&&["ww",u]),h=h||c<=1&&["M"]||c<r.M&&["MM",c]||d<=1&&["y"]||["yy",d],h[2]=e,h[3]=+t>0,h[4]=i,substituteTimeAgo.apply(null,h)}function getSetRelativeTimeRounding(t){return t===void 0?round:typeof t=="function"?(round=t,!0):!1}function getSetRelativeTimeThreshold(t,e){return thresholds[t]===void 0?!1:e===void 0?thresholds[t]:(thresholds[t]=e,t==="s"&&(thresholds.ss=e-1),!0)}function humanize(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,i=thresholds,n,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(i=Object.assign({},thresholds,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),n=this.localeData(),s=relativeTime$1(this,!r,i,n),r&&(s=n.pastFuture(+this,s)),n.postformat(s)}var abs$1=Math.abs;function sign(t){return(t>0)-(t<0)||+t}function toISOString$1(){if(!this.isValid())return this.localeData().invalidDate();var t=abs$1(this._milliseconds)/1e3,e=abs$1(this._days),r=abs$1(this._months),i,n,s,o,a=this.asSeconds(),l,c,u,d;return a?(i=absFloor(t/60),n=absFloor(i/60),t%=60,i%=60,s=absFloor(r/12),r%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",c=sign(this._months)!==sign(a)?"-":"",u=sign(this._days)!==sign(a)?"-":"",d=sign(this._milliseconds)!==sign(a)?"-":"",l+"P"+(s?c+s+"Y":"")+(r?c+r+"M":"")+(e?u+e+"D":"")+(n||i||t?"T":"")+(n?d+n+"H":"")+(i?d+i+"M":"")+(t?d+o+"S":"")):"P0D"}var proto$2=Duration.prototype;proto$2.isValid=isValid$1;proto$2.abs=abs;proto$2.add=add$1$1;proto$2.subtract=subtract$1$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asQuarters=asQuarters;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$1$1;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1);proto$2.lang=lang;addFormatToken("X",0,0,"unix");addFormatToken("x",0,0,"valueOf");addRegexToken("x",matchSigned);addRegexToken("X",matchTimestamp);addParseToken("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});addParseToken("x",function(t,e,r){r._d=new Date(toInt(t))});//! moment.js
hooks.version="2.30.1";setHookCallback(createLocal);hooks.fn=proto;hooks.min=min;hooks.max=max;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate$2;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function to2dArray(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function extendArray(t,e){const r=e.length;let i=0;for(;i<r;)t.push(e[i]),i+=1}function pivot(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,i=t[0].length;for(let n=0;n<r;n++)for(let s=0;s<i;s++)e[s]||(e[s]=[]),e[s][n]=t[n][s];return e}function arrayReduce(t,e,r,i){let n=-1,s=t,o=r;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(i&&a&&(n+=1,o=s[n]),n+=1;n<a;)o=e(o,s[n],n,s),n+=1;return o}function arrayFilter(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));const n=i.length,s=[];let o=-1;for(;r<n;){const a=i[r];e(a,r,i)&&(o+=1,s[o]=a),r+=1}return s}function arrayMap(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));const n=i.length,s=[];let o=-1;for(;r<n;){const a=i[r];o+=1,s[o]=e(a,r,i),r+=1}return s}function arrayEach(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));const n=i.length;for(;r<n&&e(i[r],r,i)!==!1;)r+=1;return t}function arraySum(t){return arrayReduce(t,(e,r)=>e+r,0)}function arrayMax(t){return arrayReduce(t,(e,r)=>e>r?e:r,Array.isArray(t)?t[0]:void 0)}function arrayMin(t){return arrayReduce(t,(e,r)=>e<r?e:r,Array.isArray(t)?t[0]:void 0)}function arrayAvg(t){return t.length?arraySum(t)/t.length:0}function arrayFlatten(t){return arrayReduce(t,(e,r)=>e.concat(Array.isArray(r)?arrayFlatten(r):r),[])}function arrayUnique(t){const e=[];return arrayEach(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function getDifferenceOfArrays(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[i,...n]=[...e];let s=i;return arrayEach(n,o=>{s=s.filter(a=>!o.includes(a))}),s}function getIntersectionOfArrays(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[i,...n]=[...e];let s=i;return arrayEach(n,o=>{s=s.filter(a=>o.includes(a))}),s}function getUnionOfArrays(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[i,...n]=[...e],s=new Set(i);return arrayEach(n,o=>{arrayEach(o,a=>{s.has(a)||s.add(a)})}),Array.from(s)}function stringToArray(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const arrayHelpers=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg,arrayEach,arrayFilter,arrayFlatten,arrayMap,arrayMax,arrayMin,arrayReduce,arraySum,arrayUnique,extendArray,getDifferenceOfArrays,getIntersectionOfArrays,getUnionOfArrays,pivot,stringToArray,to2dArray},Symbol.toStringTag,{value:"Module"}));function toSingleLine(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return arrayReduce(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),c=r[a]?r[a]:"";return s+l+c},"").trim()}function stringify$1(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function isDefined(t){return typeof t<"u"}function isUndefined(t){return typeof t>"u"}function isEmpty(t){return t===null||t===""||isUndefined(t)}function isRegExp(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const _m="length",_hd=t=>parseInt(t,16),_pi=t=>parseInt(t,10),_ss=(t,e,r)=>t.substr(e,r),_cp=t=>t.codePointAt(0)-65,_norm=t=>`${t}`.replace(/\-/g,""),_extractTime=t=>_hd(_ss(_norm(t),_hd("12"),_cp("F")))/(_hd(_ss(_norm(t),_cp("B"),~~![][_m]))||9),_ignored=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let _notified=!1;const consoleMessages={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return toSingleLine`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},domMessages={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return toSingleLine`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function _injectProductInfo(t,e){const r=!isEmpty(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",n="16.0.1";let s,o="invalid",a="invalid";t=_norm(t||"");const l=_checkKeySchema(t);if(r||i||l)if(l){const c=hooks("10/07/2025","DD/MM/YYYY"),u=Math.floor(c.toDate().getTime()/864e5),d=_extractTime(t);s=hooks((d+1)*864e5,"x").format("MMMM DD, YYYY"),u>d?(o="expired",a="expired"):(o="valid",a="valid")}else i?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(_ignored()&&(o="valid",a="valid"),!_notified&&o!=="valid"&&(consoleMessages[o]({keyValidityDate:s,hotVersion:n})&&console[o==="non_commercial"?"info":"warn"](consoleMessages[o]({keyValidityDate:s,hotVersion:n})),_notified=!0),a!=="valid"&&e&&domMessages[a]({keyValidityDate:s,hotVersion:n})){const u=document.createElement("div");u.className="handsontable hot-display-license-info",u.innerHTML=domMessages[a]({keyValidityDate:s,hotVersion:n}),e.appendChild(u)}}function _checkKeySchema(t){let e=[][_m],r=e;if(t[_m]!==_cp("Z"))return!1;for(let i="",n="B<H4P+".split(""),s=_cp(n.shift());s;s=_cp(n.shift()||"A"))--s<""[_m]?r=r|(_pi(`${_pi(_hd(i)+(_hd(_ss(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=_ss(t,s,s?n[_m]===1?9:8:6);return r===e}const mixedHelpers=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo,isDefined,isEmpty,isRegExp,isUndefined,stringify:stringify$1},Symbol.toStringTag,{value:"Module"}));function toUpperCaseFirst(t){return t[0].toUpperCase()+t.substr(1)}function equalsIgnoreCase(){const t=[];for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];let n=r.length;for(;n;){n-=1;const s=stringify$1(r[n]).toLowerCase();t.indexOf(s)===-1&&t.push(s)}return t.length===1}function randomString(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function isPercentValue(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function substitute(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,i)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[i]===void 0?"":e[i])}function stripTags(t){return sanitize(`${t}`,{ALLOWED_TAGS:[]})}function sanitize(t,e){return purify.sanitize(t,e)}const stringHelpers=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase,isPercentValue,randomString,sanitize,stripTags,substitute,toUpperCaseFirst},Symbol.toStringTag,{value:"Module"})),A11Y_TABINDEX=t=>["tabindex",t],A11Y_TREEGRID=()=>["role","treegrid"],A11Y_PRESENTATION=()=>["role","presentation"],A11Y_GRIDCELL=()=>["role","gridcell"],A11Y_GRIDCELL_BUTTON=()=>["role","gridcell button"],A11Y_ROWHEADER=()=>["role","rowheader"],A11Y_ROWGROUP=()=>["role","rowgroup"],A11Y_COLUMNHEADER=()=>["role","columnheader"],A11Y_ROW=()=>["role","row"],A11Y_MENU=()=>["role","menu"],A11Y_MENU_ITEM=()=>["role","menuitem"],A11Y_MENU_ITEM_CHECKBOX=()=>["role","menuitemcheckbox"],A11Y_COMBOBOX=()=>["role","combobox"],A11Y_LISTBOX=()=>["role","listbox"],A11Y_OPTION=()=>["role","option"],A11Y_CHECKBOX=()=>["role","checkbox"],A11Y_SCOPE_COL=()=>["scope","col"],A11Y_SCOPE_ROW=()=>["scope","row"],A11Y_TEXT=()=>["type","text"],A11Y_LABEL=t=>["aria-label",t],A11Y_HIDDEN=()=>["aria-hidden","true"],A11Y_DISABLED=()=>["aria-disabled","true"],A11Y_MULTISELECTABLE=()=>["aria-multiselectable","true"],A11Y_HASPOPUP=t=>["aria-haspopup",t],A11Y_ROWCOUNT=t=>["aria-rowcount",t],A11Y_COLCOUNT=t=>["aria-colcount",t],A11Y_ROWINDEX=t=>["aria-rowindex",t],A11Y_COLINDEX=t=>["aria-colindex",t],A11Y_EXPANDED=t=>["aria-expanded",t],A11Y_SORT=t=>["aria-sort",t],A11Y_READONLY=()=>["aria-readonly","true"],A11Y_INVALID=()=>["aria-invalid","true"],A11Y_CHECKED=t=>["aria-checked",t],A11Y_SELECTED=()=>["aria-selected","true"],A11Y_AUTOCOMPLETE=()=>["aria-autocomplete","list"],A11Y_CONTROLS=t=>["aria-controls",t],A11Y_ACTIVEDESCENDANT=t=>["aria-activedescendant",t],A11Y_LIVE=t=>["aria-live",t],A11Y_RELEVANT=t=>["aria-relevant",t],A11Y_SETSIZE=t=>["aria-setsize",t],A11Y_POSINSET=t=>["aria-posinset",t];var es_json_stringify={},getJsonReplacerFunction,hasRequiredGetJsonReplacerFunction;function requireGetJsonReplacerFunction(){if(hasRequiredGetJsonReplacerFunction)return getJsonReplacerFunction;hasRequiredGetJsonReplacerFunction=1;var t=requireFunctionUncurryThis(),e=requireIsArray(),r=requireIsCallable(),i=requireClassofRaw(),n=requireToString(),s=t([].push);return getJsonReplacerFunction=function(o){if(r(o))return o;if(e(o)){for(var a=o.length,l=[],c=0;c<a;c++){var u=o[c];typeof u=="string"?s(l,u):(typeof u=="number"||i(u)==="Number"||i(u)==="String")&&s(l,n(u))}var d=l.length,h=!0;return function(f,g){if(h)return h=!1,g;if(e(this))return g;for(var m=0;m<d;m++)if(l[m]===f)return g}}},getJsonReplacerFunction}var hasRequiredEs_json_stringify;function requireEs_json_stringify(){if(hasRequiredEs_json_stringify)return es_json_stringify;hasRequiredEs_json_stringify=1;var t=require_export(),e=requireGetBuiltIn(),r=requireFunctionApply(),i=requireFunctionCall(),n=requireFunctionUncurryThis(),s=requireFails(),o=requireIsCallable(),a=requireIsSymbol(),l=requireArraySlice(),c=requireGetJsonReplacerFunction(),u=requireSymbolConstructorDetection(),d=String,h=e("JSON","stringify"),f=n(/./.exec),g=n("".charAt),m=n("".charCodeAt),C=n("".replace),y=n(1.1.toString),v=/[\uD800-\uDFFF]/g,E=/^[\uD800-\uDBFF]$/,$=/^[\uDC00-\uDFFF]$/,O=!u||s(function(){var q=e("Symbol")("stringify detection");return h([q])!=="[null]"||h({a:q})!=="{}"||h(Object(q))!=="{}"}),P=s(function(){return h("\uDF06\uD834")!=='"\\udf06\\ud834"'||h("\uDEAD")!=='"\\udead"'}),I=function(q,M){var Y=l(arguments),z=c(M);if(!(!o(z)&&(q===void 0||a(q))))return Y[1]=function(Q,K){if(o(z)&&(K=i(z,this,d(Q),K)),!a(K))return K},r(h,null,Y)},W=function(q,M,Y){var z=g(Y,M-1),Q=g(Y,M+1);return f(E,q)&&!f($,Q)||f($,q)&&!f(E,z)?"\\u"+y(m(q,0),16):q};return h&&t({target:"JSON",stat:!0,arity:3,forced:O||P},{stringify:function(M,Y,z){var Q=l(arguments),K=r(O?I:h,null,Q);return P&&typeof K=="string"?C(K,v,W):K}}),es_json_stringify}requireEs_json_stringify();function duckSchema(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},objectEach(t,(r,i)=>{i!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[i]=duckSchema(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[i]=[duckSchema(r[0])]:e[i]=[]:e[i]=null)})),e}function inherit(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function extend$1(t,e,r){const i=Array.isArray(r);return objectEach(e,(n,s)=>{(i===!1||r.includes(s))&&(t[s]=n)}),t}function deepExtend(t,e){objectEach(e,(r,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),deepExtend(t[i],e[i])):t[i]=e[i]})}function deepClone(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function clone(t){const e={};return objectEach(t,(r,i)=>{e[i]=r}),e}function mixin(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return arrayEach(r,n=>{t.MIXINS.push(n.MIXIN_NAME),objectEach(n,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(u,d){const h=`_${u}`,f=g=>{let m=g;return(Array.isArray(m)||isObject(m))&&(m=deepClone(m)),m};return function(){return this[h]===void 0&&(this[h]=f(d)),this[h]}},l=function(u){const d=`_${u}`;return function(h){this[d]=h}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function isObjectEqual(t,e){return JSON.stringify(t)===JSON.stringify(e)}function isObject(t){return Object.prototype.toString.call(t)==="[object Object]"}function defineGetter(t,e,r,i){i.value=r,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function objectEach(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function getProperty(t,e){const r=e.split(".");let i=t;return objectEach(r,n=>{if(i=i[n],i===void 0)return i=void 0,!1}),i}function setProperty(t,e,r){if(typeof e!="string")return;const i=e.split(".");let n=t;i.forEach((s,o)=>{s==="__proto__"||s==="constructor"||s==="prototype"||(o!==i.length-1?(hasOwnProperty(n,s)||(n[s]={}),n=n[s]):n[s]=r)})}function deepObjectSize(t){if(!isObject(t))return 0;const e=function(r){let i=0;return isObject(r)?objectEach(r,(n,s)=>{s!=="__children"&&(i+=e(n))}):i+=1,i};return e(t)}function createObjectPropListener(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,i={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[r]},set(n){this._touched=!0,this[r]=n},enumerable:!0,configurable:!0}),i}function hasOwnProperty(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const objectHelpers=Object.freeze(Object.defineProperty({__proto__:null,clone,createObjectPropListener,deepClone,deepExtend,deepObjectSize,defineGetter,duckSchema,extend:extend$1,getProperty,hasOwnProperty,inherit,isObject,isObjectEqual,mixin,objectEach,setProperty},Symbol.toStringTag,{value:"Module"}));function requestAnimationFrame$1(t){return window.requestAnimationFrame(t)}function cancelAnimationFrame(t){window.cancelAnimationFrame(t)}function isTouchSupported(){return"ontouchstart"in window}function isCSR(){return typeof window<"u"}let comparisonFunction;function getComparisonFunction(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return comparisonFunction||(typeof Intl=="object"?comparisonFunction=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?comparisonFunction=(r,i)=>`${r}`.localeCompare(i):comparisonFunction=(r,i)=>r===i?0:r>i?-1:1,comparisonFunction)}const featureHelpers=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame,getComparisonFunction,isCSR,isTouchSupported,requestAnimationFrame:requestAnimationFrame$1},Symbol.toStringTag,{value:"Module"})),tester=t=>{const e={value:!1};return e.test=(r,i)=>{e.value=t(r,i)},e},browsers={chrome:tester((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:tester(t=>/CriOS/.test(t)),edge:tester(t=>/Edge/.test(t)),edgeWebKit:tester(t=>/EdgiOS/.test(t)),firefox:tester(t=>/Firefox/.test(t)),firefoxWebKit:tester(t=>/FxiOS/.test(t)),mobile:tester(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:tester((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},platforms={mac:tester(t=>/^Mac/.test(t)),win:tester(t=>/^Win/.test(t)),linux:tester(t=>/^Linux/.test(t)),ios:tester(t=>/iPhone|iPad|iPod/i.test(t))};function setBrowserMeta(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(browsers,r=>{let{test:i}=r;return void i(t,e)})}function setPlatformMeta(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(platforms,e=>{let{test:r}=e;return void r(t)})}isCSR()&&(setBrowserMeta(),setPlatformMeta());function isChrome(){return browsers.chrome.value}function isChromeWebKit(){return browsers.chromeWebKit.value}function isFirefox(){return browsers.firefox.value}function isFirefoxWebKit(){return browsers.firefoxWebKit.value}function isSafari(){return browsers.safari.value}function isEdge(){return browsers.edge.value}function isEdgeWebKit(){return browsers.edgeWebKit.value}function isMobileBrowser(){return browsers.mobile.value}function isIOS(){return platforms.ios.value}function isIpadOS(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&platforms.mac.value}function isWindowsOS(){return platforms.win.value}function isMacOS(){return platforms.mac.value}function isLinuxOS(){return platforms.linux.value}const browserHelpers=Object.freeze(Object.defineProperty({__proto__:null,isChrome,isChromeWebKit,isEdge,isEdgeWebKit,isFirefox,isFirefoxWebKit,isIOS,isIpadOS,isLinuxOS,isMacOS,isMobileBrowser,isSafari,isWindowsOS,setBrowserMeta,setPlatformMeta},Symbol.toStringTag,{value:"Module"}));function getParent(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,i=null,n=t;for(;n!==null;){if(r===e){i=n;break}n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:(r+=1,n=n.parentNode)}return i}function isInternalElement(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function getFrameElement(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function getParentWindow(t){return getFrameElement(t)&&t.parent}function hasAccessToParentWindow(t){return!!Object.getPrototypeOf(t.parent)}function closest(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:n}=Node;let s=t;for(;s!=null&&s!==r;){const{nodeType:o,nodeName:a}=s;if(o===i&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===n?s=l:s=s.parentNode}return null}function closestDown(t,e,r){const i=[];let n=t;for(;n&&(n=closest(n,e,r),!(!n||r&&!r.contains(n)));)i.push(n),n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:n=n.parentNode;const s=i.length;return s?i[s-1]:null}function findFirstParentWithClass(t,e){const r={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&i.classList.contains(e))r.element=i,r.classNames.push(e);else if(e instanceof RegExp){const n=Array.from(i.classList).filter(s=>e.test(s));n.length&&(r.element=i,r.classNames.push(...n))}i=i.parentElement}return r}function isChildOf(t,e){let r=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);r!==null;){if(i.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function index(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function overlayContainsElement(t,e,r){const i=r.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function filterEmptyClassNames(t){return!t||!t.length?[]:t.filter(e=>!!e)}function filterRegexes(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],i=[];return i.push(...t.filter(n=>{const s=n instanceof RegExp;return s&&e&&r.push(n),!s})),{regexFree:i,regexes:r}}function hasClass$1(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function addClass$1(t,e){typeof e=="string"&&(e=e.split(" ")),e=filterEmptyClassNames(e),e.length>0&&t.classList.add(...e)}function removeClass$1(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:i}=filterRegexes(e,!0);r=filterEmptyClassNames(r),r.length>0&&t.classList.remove(...r),i.forEach(n=>{t.classList.forEach(s=>{n.test(s)&&t.classList.remove(s)})})}function setAttribute(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function removeAttribute(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:i}=filterRegexes(e,!0);r.forEach(n=>{n!==""&&t.removeAttribute(n)}),i.forEach(n=>{t.getAttributeNames().forEach(s=>{n.test(s)&&t.removeAttribute(s)})})}function removeTextNodes(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)removeTextNodes(e[r])}}function empty(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const HTML_CHARACTERS=/(<(.*)>|&(.*);)/;function fastInnerHTML(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;HTML_CHARACTERS.test(e)?t.innerHTML=r?sanitize(e):e:fastInnerText(t,e)}function fastInnerText(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(empty(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function isVisible(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return isVisible(i.host.impl);if(i.host)return isVisible(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function hasZeroHeight(t){const r=t.ownerDocument.defaultView;let i=t;for(;i.parentNode;){if(i.style.height==="0px"||i.style.height==="0")return r.getComputedStyle(i).overflow==="hidden";i=i.parentNode}return!1}function offset(t){const e=t.ownerDocument,r=e.defaultView,i=e.documentElement;let n=t,s,o,a;for(s=n.offsetLeft,o=n.offsetTop,a=n;(n=n.offsetParent)&&!(n===e.body||!("offsetLeft"in n));)s+=n.offsetLeft,o+=n.offsetTop,a=n;return a&&a.style.position==="fixed"&&(s+=r.pageXOffset||i.scrollLeft,o+=r.pageYOffset||i.scrollTop),{left:s,top:o}}function getWindowScrollTop(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function getWindowScrollLeft(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function getScrollTop(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?getWindowScrollTop(e):t.scrollTop}function getScrollLeft(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?getWindowScrollLeft(e):t.scrollLeft}function getScrollableElement(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const i=["auto","scroll"];let n=t.parentNode;for(;n&&n.style&&e.body!==n;){let{overflow:s,overflowX:o,overflowY:a}=n.style;if([s,o,a].includes("scroll"))return n;if({overflow:s,overflowX:o,overflowY:a}=r.getComputedStyle(n),i.includes(s)||i.includes(o)||i.includes(a)||n.clientHeight<=n.scrollHeight+1&&(i.includes(a)||i.includes(s))||n.clientWidth<=n.scrollWidth+1&&(i.includes(o)||i.includes(s)))return n;n=n.parentNode}return r}function getMaximumScrollTop(t){return t.scrollHeight-t.clientHeight}function getMaximumScrollLeft(t){return t.scrollWidth-t.clientWidth}function getTrimmingContainer(t){const e=t.ownerDocument,r=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const n=r.getComputedStyle(i),s=["scroll","hidden","auto"],o=n.getPropertyValue("overflow"),a=n.getPropertyValue("overflow-y"),l=n.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return i;i=i.parentNode}return r}function getStyle(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const n=r.getComputedStyle(t);if(n[e]!==""&&n[e]!==void 0)return n[e]}function matchesCSSRules(t,e){const{selectorText:r}=e;let i=!1;return e.type===CSSRule.STYLE_RULE&&r&&(t.msMatchesSelector?i=t.msMatchesSelector(r):t.matches&&(i=t.matches(r))),i}function outerWidth(t){return t.offsetWidth}function outerHeight(t){return t.offsetHeight}function innerHeight(t){return t.clientHeight||t.innerHeight}function innerWidth(t){return t.clientWidth||t.innerWidth}function addEvent$1(t,e,r){t.addEventListener(e,r,!1)}function removeEvent$1(t,e,r){t.removeEventListener(e,r,!1)}function getCaretPosition(t){return t.selectionStart?t.selectionStart:0}function getSelectionEndPosition(t){return t.selectionEnd?t.selectionEnd:0}function getSelectionText(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let r="";return t.getSelection?r=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(r=e.selection.createRange().text),r}function clearTextSelection(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function setCaretPosition(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const n=t.parentNode,s=n.style.display;n.style.display="block",t.setSelectionRange(e,r),n.style.display=s}}}let cachedScrollbarWidth;function getFractionalScalingCompensation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return isWindowsOS()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function walkontableCalculateScrollbarWidth(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");isSafari()&&!isMobileBrowser()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const i=e.offsetWidth;r.style.overflow="scroll";let n=e.offsetWidth;return i===n&&(n=r.clientWidth),(t.body||t.documentElement).removeChild(r),i-n+getFractionalScalingCompensation(t)}function getScrollbarWidth(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return cachedScrollbarWidth===void 0&&(cachedScrollbarWidth=walkontableCalculateScrollbarWidth(t)),cachedScrollbarWidth}function hasVerticalScrollbar(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function hasHorizontalScrollbar(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function setOverlayPosition(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function getCssTransform(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function resetCssTransform(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function isInput(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function isOutsideInput(t){return isInput(t)&&t.hasAttribute("data-hot-input")===!1}function selectElementIfAllowed(t){const e=t.ownerDocument.activeElement;isOutsideInput(e)||t.select()}function isDetached(t){return!t.parentNode}function observeVisibilityChangeOnce(t,e){new IntersectionObserver((i,n)=>{i.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),n.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function makeElementContentEditableAndSelectItsContent(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,n=i.createRange(),s=i.defaultView.getSelection();setAttribute(t,"contenteditable",!0),r&&setAttribute(t,...A11Y_HIDDEN()),e&&addClass$1(t,"invisibleSelection"),n.selectNodeContents(t),s.removeAllRanges(),s.addRange(n)}function removeContentEditableFromElementAndDeselect(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&removeClass$1(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function runWithSelectedContendEditableElement(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;makeElementContentEditableAndSelectItsContent(t,r),e(),removeContentEditableFromElementAndDeselect(t,r)}function isHTMLElement(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}const domHelpers=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS,addClass:addClass$1,addEvent:addEvent$1,clearTextSelection,closest,closestDown,empty,fastInnerHTML,fastInnerText,findFirstParentWithClass,getCaretPosition,getCssTransform,getFractionalScalingCompensation,getFrameElement,getMaximumScrollLeft,getMaximumScrollTop,getParent,getParentWindow,getScrollLeft,getScrollTop,getScrollableElement,getScrollbarWidth,getSelectionEndPosition,getSelectionText,getStyle,getTrimmingContainer,getWindowScrollLeft,getWindowScrollTop,hasAccessToParentWindow,hasClass:hasClass$1,hasHorizontalScrollbar,hasVerticalScrollbar,hasZeroHeight,index,innerHeight,innerWidth,isChildOf,isDetached,isHTMLElement,isInput,isInternalElement,isOutsideInput,isVisible,makeElementContentEditableAndSelectItsContent,matchesCSSRules,observeVisibilityChangeOnce,offset,outerHeight,outerWidth,overlayContainsElement,removeAttribute,removeClass:removeClass$1,removeContentEditableFromElementAndDeselect,removeEvent:removeEvent$1,removeTextNodes,resetCssTransform,runWithSelectedContendEditableElement,selectElementIfAllowed,setAttribute,setCaretPosition,setOverlayPosition},Symbol.toStringTag,{value:"Module"}));function isFunction(t){return typeof t=="function"}function throttle(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0;const i={lastCallThrottled:!0};let n=null;function s(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];const c=Date.now();let u=!1;i.lastCallThrottled=!0,r||(r=c,u=!0);const d=e-(c-r);return u?(i.lastCallThrottled=!1,t.apply(this,a)):(n&&clearTimeout(n),n=setTimeout(()=>{i.lastCallThrottled=!1,t.apply(this,a),r=0,n=void 0},d)),i}return s}function throttleAfterHits(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const i=throttle(t,e);let n=r;function s(){n=r}function o(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return n?(n-=1,t.apply(this,l)):i.apply(this,l)}return o.clearHits=s,o}function debounce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,i;function n(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{i=t.apply(this,o)},e),i}return n}function pipe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[i,...n]=e;return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return arrayReduce(n,(c,u)=>u(c),i.apply(this,a))}}function partial(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,r.concat(o))}}function curry(t){const e=t.length;function r(i){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=i.concat(o);let c;return l.length>=e?c=t.apply(this,l):c=r(l),c}}return r([])}function curryRight(t){const e=t.length;function r(i){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=i.concat(o.reverse());let c;return l.length>=e?c=t.apply(this,l):c=r(l),c}}return r([])}function fastCall(t,e,r,i,n,s,o,a){return isDefined(a)?t.call(e,r,i,n,s,o,a):isDefined(o)?t.call(e,r,i,n,s,o):isDefined(s)?t.call(e,r,i,n,s):isDefined(n)?t.call(e,r,i,n):isDefined(i)?t.call(e,r,i):isDefined(r)?t.call(e,r):t.call(e)}const functionHelpers=Object.freeze(Object.defineProperty({__proto__:null,curry,curryRight,debounce,fastCall,isFunction,partial,pipe,throttle,throttleAfterHits},Symbol.toStringTag,{value:"Module"})),KEY_CODES={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:isFirefox()?182:174,AUDIO_MUTE:isFirefox()?181:173,AUDIO_UP:isFirefox()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},FUNCTION_KEYS=[KEY_CODES.ALT,KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_LEFT,KEY_CODES.ARROW_RIGHT,KEY_CODES.ARROW_UP,KEY_CODES.AUDIO_DOWN,KEY_CODES.AUDIO_MUTE,KEY_CODES.AUDIO_UP,KEY_CODES.BACKSPACE,KEY_CODES.CAPS_LOCK,KEY_CODES.DELETE,KEY_CODES.END,KEY_CODES.ENTER,KEY_CODES.ESCAPE,KEY_CODES.F1,KEY_CODES.F2,KEY_CODES.F3,KEY_CODES.F4,KEY_CODES.F5,KEY_CODES.F6,KEY_CODES.F7,KEY_CODES.F8,KEY_CODES.F9,KEY_CODES.F10,KEY_CODES.F11,KEY_CODES.F12,KEY_CODES.F13,KEY_CODES.F14,KEY_CODES.F15,KEY_CODES.F16,KEY_CODES.F17,KEY_CODES.F18,KEY_CODES.F19,KEY_CODES.HOME,KEY_CODES.INSERT,KEY_CODES.MEDIA_NEXT,KEY_CODES.MEDIA_PLAY_PAUSE,KEY_CODES.MEDIA_PREV,KEY_CODES.MEDIA_STOP,KEY_CODES.NULL,KEY_CODES.NUM_LOCK,KEY_CODES.PAGE_DOWN,KEY_CODES.PAGE_UP,KEY_CODES.PAUSE,KEY_CODES.SCROLL_LOCK,KEY_CODES.SHIFT,KEY_CODES.TAB];function isPrintableChar(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function isFunctionKey(t){return FUNCTION_KEYS.includes(t)}function isCtrlKey(t){const e=[];return isMacOS()?e.push(KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX):e.push(KEY_CODES.CONTROL),e.includes(t)}function isCtrlMetaKey(t){return[KEY_CODES.CONTROL,KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX].includes(t)}function isKey(t,e){const r=e.split("|");let i=!1;return arrayEach(r,n=>{if(t===KEY_CODES[n])return i=!0,!1}),i}const unicodeHelpers=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES,isCtrlKey,isCtrlMetaKey,isFunctionKey,isKey,isPrintableChar},Symbol.toStringTag,{value:"Module"}));function stopImmediatePropagation(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function isImmediatePropagationStopped(t){return t.isImmediatePropagationEnabled===!1}function isRightClick(t){return t.button===2}function isLeftClick(t){return t.button===0}function isTouchEvent(t){return t instanceof TouchEvent}function offsetRelativeTo(t,e){const r={x:t.offsetX,y:t.offsetY};let i=t.target;if(!isHTMLElement(e)||i!==e&&i.contains(e))return r;for(;i!==e;)r.x+=i.offsetLeft,r.y+=i.offsetTop,i=i.offsetParent;return r}const domEventHelpers=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped,isLeftClick,isRightClick,isTouchEvent,offsetRelativeTo,stopImmediatePropagation},Symbol.toStringTag,{value:"Module"}));function warn(){isDefined(console)&&console.warn(...arguments)}function error(){isDefined(console)&&console.error(...arguments)}const REGISTERED_HOOKS=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],REMOVED_HOOKS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),DEPRECATED_HOOKS=new Map([[]]);var es_array_toSorted={},arrayFromConstructorAndList,hasRequiredArrayFromConstructorAndList;function requireArrayFromConstructorAndList(){if(hasRequiredArrayFromConstructorAndList)return arrayFromConstructorAndList;hasRequiredArrayFromConstructorAndList=1;var t=requireLengthOfArrayLike();return arrayFromConstructorAndList=function(e,r,i){for(var n=0,s=arguments.length>2?i:t(r),o=new e(s);s>n;)o[n]=r[n++];return o},arrayFromConstructorAndList}var getBuiltInPrototypeMethod,hasRequiredGetBuiltInPrototypeMethod;function requireGetBuiltInPrototypeMethod(){if(hasRequiredGetBuiltInPrototypeMethod)return getBuiltInPrototypeMethod;hasRequiredGetBuiltInPrototypeMethod=1;var t=requireGlobalThis();return getBuiltInPrototypeMethod=function(e,r){var i=t[e],n=i&&i.prototype;return n&&n[r]},getBuiltInPrototypeMethod}var addToUnscopables,hasRequiredAddToUnscopables;function requireAddToUnscopables(){if(hasRequiredAddToUnscopables)return addToUnscopables;hasRequiredAddToUnscopables=1;var t=requireWellKnownSymbol(),e=requireObjectCreate(),r=requireObjectDefineProperty().f,i=t("unscopables"),n=Array.prototype;return n[i]===void 0&&r(n,i,{configurable:!0,value:e(null)}),addToUnscopables=function(s){n[i][s]=!0},addToUnscopables}var hasRequiredEs_array_toSorted;function requireEs_array_toSorted(){if(hasRequiredEs_array_toSorted)return es_array_toSorted;hasRequiredEs_array_toSorted=1;var t=require_export(),e=requireFunctionUncurryThis(),r=requireACallable(),i=requireToIndexedObject(),n=requireArrayFromConstructorAndList(),s=requireGetBuiltInPrototypeMethod(),o=requireAddToUnscopables(),a=Array,l=e(s("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(u){u!==void 0&&r(u);var d=i(this),h=n(a,d);return l(h,u)}}),o("toSorted"),es_array_toSorted}requireEs_array_toSorted();var esnext_iterator_find={},es_iterator_find={},hasRequiredEs_iterator_find;function requireEs_iterator_find(){if(hasRequiredEs_iterator_find)return es_iterator_find;hasRequiredEs_iterator_find=1;var t=require_export(),e=requireFunctionCall(),r=requireIterate(),i=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect(),o=requireIteratorClose(),a=requireIteratorHelperWithoutClosingOnEarlyError(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(u){n(this);try{i(u)}catch(f){o(this,"throw",f)}if(l)return e(l,this,u);var d=s(this),h=0;return r(d,function(f,g){if(u(f,h++))return g(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),es_iterator_find}var hasRequiredEsnext_iterator_find;function requireEsnext_iterator_find(){return hasRequiredEsnext_iterator_find||(hasRequiredEsnext_iterator_find=1,requireEs_iterator_find()),esnext_iterator_find}requireEsnext_iterator_find();function _classPrivateMethodInitSpec$V(t,e){_checkPrivateRedeclaration$1e(t,e),e.add(t)}function _classPrivateFieldInitSpec$U(t,e,r){_checkPrivateRedeclaration$1e(t,e),e.set(t,r)}function _checkPrivateRedeclaration$1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$Q(t,e,r){return t.set(_assertClassBrand$1e(t,e),r),r}function _classPrivateFieldGet$U(t,e){return t.get(_assertClassBrand$1e(t,e))}function _assertClassBrand$1e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const MAX_SKIPPED_HOOKS_COUNT=100;var _hooks$1=new WeakMap,_skippedHooksCount=new WeakMap,_needsSort=new WeakMap,_HooksBucket_brand=new WeakSet;class HooksBucket{constructor(){_classPrivateMethodInitSpec$V(this,_HooksBucket_brand),_classPrivateFieldInitSpec$U(this,_hooks$1,new Map),_classPrivateFieldInitSpec$U(this,_skippedHooksCount,new Map),_classPrivateFieldInitSpec$U(this,_needsSort,new Set),REGISTERED_HOOKS.forEach(e=>_assertClassBrand$1e(_HooksBucket_brand,this,_createHooksCollection).call(this,e))}getHooks(e){var r;return(r=_classPrivateFieldGet$U(_hooks$1,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};_classPrivateFieldGet$U(_hooks$1,this).has(e)||(_assertClassBrand$1e(_HooksBucket_brand,this,_createHooksCollection).call(this,e),REGISTERED_HOOKS.push(e));const n=_classPrivateFieldGet$U(_hooks$1,this).get(e);if(n.find(c=>c.callback===r))return;const s=Number.isInteger(i.orderIndex)?i.orderIndex:0,o=!!i.runOnce,a=!!i.initialHook;let l=!1;if(a){const c=n.find(u=>u.initialHook);c&&(c.callback=r,l=!0)}if(!l){n.push({callback:r,orderIndex:s,runOnce:o,initialHook:a,skip:!1});let c=_classPrivateFieldGet$U(_needsSort,this).has(e);!c&&s!==0&&(c=!0,_classPrivateFieldGet$U(_needsSort,this).add(e)),c&&n.length>1&&_classPrivateFieldGet$U(_hooks$1,this).set(e,n.toSorted((u,d)=>u.orderIndex-d.orderIndex))}}has(e){return _classPrivateFieldGet$U(_hooks$1,this).has(e)&&_classPrivateFieldGet$U(_hooks$1,this).get(e).length>0}remove(e,r){if(!_classPrivateFieldGet$U(_hooks$1,this).has(e))return!1;const i=_classPrivateFieldGet$U(_hooks$1,this).get(e),n=i.find(s=>s.callback===r);if(n){let s=_classPrivateFieldGet$U(_skippedHooksCount,this).get(e);return n.skip=!0,s+=1,s>MAX_SKIPPED_HOOKS_COUNT&&(_classPrivateFieldGet$U(_hooks$1,this).set(e,i.filter(o=>!o.skip)),s=0),_classPrivateFieldGet$U(_skippedHooksCount,this).set(e,s),!0}return!1}destroy(){_classPrivateFieldGet$U(_hooks$1,this).clear(),_classPrivateFieldGet$U(_skippedHooksCount,this).clear(),_classPrivateFieldSet$Q(_hooks$1,this,null),_classPrivateFieldSet$Q(_skippedHooksCount,this,null)}}function _createHooksCollection(t){_classPrivateFieldGet$U(_hooks$1,this).set(t,[]),_classPrivateFieldGet$U(_skippedHooksCount,this).set(t,0)}function _defineProperty$2b(t,e,r){return(e=_toPropertyKey$2b(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$2b(t){var e=_toPrimitive$2b(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$2b(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const REMOVED_MESSAGE=toSingleLine`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Hooks{constructor(){_defineProperty$2b(this,"globalBucket",new HooksBucket)}static getSingleton(){return getGlobalSingleton()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new HooksBucket),e.pluginHookBucket):this.globalBucket}add(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?arrayEach(r,s=>this.add(e,s,i)):(REMOVED_HOOKS.has(e)&&warn(substitute(REMOVED_MESSAGE,{hookName:e,removedInVersion:REMOVED_HOOKS.get(e)})),DEPRECATED_HOOKS.has(e)&&warn(DEPRECATED_HOOKS.get(e)),this.getBucket(i).add(e,r,{orderIndex:n,runOnce:!1})),this}once(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?arrayEach(r,s=>this.once(e,s,i)):this.getBucket(i).add(e,r,{orderIndex:n,runOnce:!0}),this}addAsFixed(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?arrayEach(r,n=>this.addAsFixed(e,n,i)):this.getBucket(i).add(e,r,{initialHook:!0}),this}remove(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,i,n,s,o,a,l){{const c=this.getBucket().getHooks(r),u=c?c.length:0;let d=0;if(u)for(;d<u;){if(!c[d]||c[d].skip){d+=1;continue}const h=fastCall(c[d].callback,e,i,n,s,o,a,l);h!==void 0&&(i=h),c[d]&&c[d].runOnce&&this.remove(r,c[d].callback),d+=1}}{const c=this.getBucket(e).getHooks(r),u=c?c.length:0;let d=0;if(u)for(;d<u;){if(!c[d]||c[d].skip){d+=1;continue}const h=fastCall(c[d].callback,e,i,n,s,o,a,l);h!==void 0&&(i=h),c[d]&&c[d].runOnce&&this.remove(r,c[d].callback,e),d+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||REGISTERED_HOOKS.push(e)}deregister(e){this.isRegistered(e)&&REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(e),1)}isDeprecated(e){return DEPRECATED_HOOKS.has(e)||REMOVED_HOOKS.has(e)}isRegistered(e){return REGISTERED_HOOKS.indexOf(e)>=0}getRegistered(){return REGISTERED_HOOKS}}const globalSingleton=new Hooks;function getGlobalSingleton(){return globalSingleton}const collection=new Map;function staticRegister(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";collection.has(t)||collection.set(t,new Map);const e=collection.get(t);function r(l,c){e.set(l,c)}function i(l){return e.get(l)}function n(l){return e.has(l)}function s(){return[...e.keys()]}function o(){return[...e.values()]}function a(){collection.delete(t),e.clear()}return{register:r,getItem:i,hasItem:n,getNames:s,getValues:o,clear:a}}function resolveWithInstance(t,e){var r;return collection==null||(r=collection.get(t.guid))===null||r===void 0?void 0:r.get(e)}const registeredEditorClasses=new WeakMap,{register:register$4,getItem:getItem$3,hasItem:hasItem$3,getNames:getNames$3,getValues:getValues$3}=staticRegister("editors");function RegisteredEditor(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new r(i)),e[i.guid]},Hooks.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function _getEditorInstance(t,e){let r;if(typeof t=="function")registeredEditorClasses.get(t)||_register$3(null,t),r=registeredEditorClasses.get(t);else if(typeof t=="string")r=getItem$3(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function _getItem$3(t){if(typeof t=="function")return t;if(!hasItem$3(t))throw Error(`No registered editor found under "${t}" name`);return getItem$3(t).getConstructor()}function _register$3(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new RegisteredEditor(e);typeof t=="string"&&register$4(t,r),registeredEditorClasses.set(e,r)}function _defineProperty$2a(t,e,r){return(e=_toPropertyKey$2a(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$2a(t){var e=_toPrimitive$2a(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$2a(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let listenersCounter=0;class EventManager{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty$2a(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,i){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){i.call(this,extendEvent(o))}return this.context.eventListeners.push({element:e,event:r,callback:i,callbackProxy:s,options:n,eventManager:this}),e.addEventListener(r,s,n),listenersCounter+=1,()=>{this.removeEventListener(e,r,i)}}removeEventListener(e,r,i){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===r&&o.element===e){if(i&&i!==o.callback||n&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),listenersCounter-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const i=this.context.eventListeners[r];e&&i.eventManager!==this||(this.context.eventListeners.splice(r,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),listenersCounter-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let i=e.document,n=e;i||(i=e.ownerDocument?e.ownerDocument:e,n=i.defaultView);const s={bubbles:!0,cancelable:r!=="mousemove",view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;i.createEvent?(o=i.createEvent("MouseEvents"),o.initMouseEvent(r,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,i.body.parentNode)):o=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${r}`,o)}}function extendEvent(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),stopImmediatePropagation(this)},t}function getListenersCounter(){return listenersCounter}function _classPrivateMethodInitSpec$U(t,e){_checkPrivateRedeclaration$1d(t,e),e.add(t)}function _checkPrivateRedeclaration$1d(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$29(t,e,r){return(e=_toPropertyKey$29(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$29(t){var e=_toPrimitive$29(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$29(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$1d(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _EditorManager_brand=new WeakSet;class EditorManager{constructor(e,r,i){_classPrivateMethodInitSpec$U(this,_EditorManager_brand),_defineProperty$29(this,"hot",void 0),_defineProperty$29(this,"tableMeta",void 0),_defineProperty$29(this,"selection",void 0),_defineProperty$29(this,"eventManager",void 0),_defineProperty$29(this,"destroyed",!1),_defineProperty$29(this,"activeEditor",void 0),_defineProperty$29(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=i,this.eventManager=new EventManager(e),this.hot.addHook("afterDocumentKeyDown",n=>_assertClassBrand$1d(_EditorManager_brand,this,_onAfterDocumentKeyDown$1).call(this,n)),this.hot.addHook("beforeCompositionStart",n=>_assertClassBrand$1d(_EditorManager_brand,this,_onAfterDocumentKeyDown$1).call(this,n)),this.hot.view._wt.update("onCellDblClick",(n,s,o)=>_assertClassBrand$1d(_EditorManager_brand,this,_onCellDblClick).call(this,n,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,c=>{c&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:i,col:n}=r,s=this.hot.runHooks("modifyGetCellCoords",i,n,!1,"meta");let o=i,a=n;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(i,n,!0);if(l){const c=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(a),d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=_getEditorInstance(c,this.hot),this.activeEditor.prepare(i,n,u,l,d,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const n=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",n.highlight.row,n.highlight.col,e,r,i);if(r instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&n.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,i){this.activeEditor?this.activeEditor.finishEditing(e,r,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:i,col:n}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(i))||o.isHidden(this.hot.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function _onAfterDocumentKeyDown$1(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||isImmediatePropagationStopped(t))return;const{keyCode:r}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!isFunctionKey(r)&&!isCtrlMetaKey(r)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function _onCellDblClick(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const instances=new WeakMap;EditorManager.getInstance=function(t,e,r){let i=instances.get(t);return i||(i=new EditorManager(t,e,r),instances.set(t,i)),i};function _classPrivateMethodInitSpec$T(t,e){_checkPrivateRedeclaration$1c(t,e),e.add(t)}function _classPrivateFieldInitSpec$T(t,e,r){_checkPrivateRedeclaration$1c(t,e),e.set(t,r)}function _checkPrivateRedeclaration$1c(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$T(t,e){return t.get(_assertClassBrand$1c(t,e))}function _classPrivateFieldSet$P(t,e,r){return t.set(_assertClassBrand$1c(t,e),r),r}function _assertClassBrand$1c(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const FOCUS_MODES=Object.freeze({CELL:"cell",MIXED:"mixed"});var _hot$1=new WeakMap,_focusMode=new WeakMap,_refocusDelay=new WeakMap,_refocusElementGetter=new WeakMap,_debouncedSelect=new WeakMap,_FocusManager_brand=new WeakSet;class FocusManager{constructor(e){var r=this;_classPrivateMethodInitSpec$T(this,_FocusManager_brand),_classPrivateFieldInitSpec$T(this,_hot$1,void 0),_classPrivateFieldInitSpec$T(this,_focusMode,void 0),_classPrivateFieldInitSpec$T(this,_refocusDelay,1),_classPrivateFieldInitSpec$T(this,_refocusElementGetter,null),_classPrivateFieldInitSpec$T(this,_debouncedSelect,new Map);const i=e.getSettings();_classPrivateFieldSet$P(_hot$1,this,e),_classPrivateFieldSet$P(_focusMode,this,i.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL),_classPrivateFieldGet$T(_hot$1,this).addHook("afterUpdateSettings",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$1c(_FocusManager_brand,r,_onUpdateSettings).call(r,...s)}),_classPrivateFieldGet$T(_hot$1,this).addHook("afterSelection",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$1c(_FocusManager_brand,r,_focusCell).call(r,...s)}),_classPrivateFieldGet$T(_hot$1,this).addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$1c(_FocusManager_brand,r,_focusCell).call(r,...s)}),_classPrivateFieldGet$T(_hot$1,this).addHook("afterSelectionEnd",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$1c(_FocusManager_brand,r,_focusEditorElement).call(r,...s)})}getFocusMode(){return _classPrivateFieldGet$T(_focusMode,this)}setFocusMode(e){Object.values(FOCUS_MODES).includes(e)?_classPrivateFieldSet$P(_focusMode,this,e):warn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return _classPrivateFieldGet$T(_refocusDelay,this)}setRefocusDelay(e){_classPrivateFieldSet$P(_refocusDelay,this,e)}setRefocusElementGetter(e){_classPrivateFieldSet$P(_refocusElementGetter,this,e)}getRefocusElement(){var e;return typeof _classPrivateFieldGet$T(_refocusElementGetter,this)=="function"?_classPrivateFieldGet$T(_refocusElementGetter,this).call(this):(e=_classPrivateFieldGet$T(_hot$1,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=i=>{var n,s;const o=(n=_classPrivateFieldGet$T(_hot$1,this).getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;if(!o)return;let a=_classPrivateFieldGet$T(_hot$1,this).runHooks("modifyFocusedElement",o.row,o.col,i);isHTMLElement(a)||(a=i),a&&!((s=_classPrivateFieldGet$T(_hot$1,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?r(e):_assertClassBrand$1c(_FocusManager_brand,this,_getSelectedCell).call(this,i=>r(i))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_classPrivateFieldGet$T(_refocusDelay,this);if(_classPrivateFieldGet$T(_hot$1,this).getSettings().imeFastEdit&&!((e=_classPrivateFieldGet$T(_hot$1,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var i,n;(i=_classPrivateFieldGet$T(_hot$1,this).getActiveEditor())===null||i===void 0||(n=i.refreshValue)===null||n===void 0||n.call(i),_classPrivateFieldGet$T(_debouncedSelect,this).has(r)||_classPrivateFieldGet$T(_debouncedSelect,this).set(r,debounce(()=>{if(!_classPrivateFieldGet$T(_hot$1,this).isDestroyed){var s;(s=this.getRefocusElement())===null||s===void 0||s.select()}},r)),_classPrivateFieldGet$T(_debouncedSelect,this).get(r)()}}}function _getSelectedCell(t){var e;const r=(e=_classPrivateFieldGet$T(_hot$1,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!_classPrivateFieldGet$T(_hot$1,this).selection.isCellVisible(r)){t(null);return}const i=_classPrivateFieldGet$T(_hot$1,this).getCell(r.row,r.col,!0);i===null?_classPrivateFieldGet$T(_hot$1,this).addHookOnce("afterScroll",()=>{t(_classPrivateFieldGet$T(_hot$1,this).getCell(r.row,r.col,!0))}):t(i)}function _focusCell(){_assertClassBrand$1c(_FocusManager_brand,this,_getSelectedCell).call(this,t=>{const{activeElement:e}=_classPrivateFieldGet$T(_hot$1,this).rootDocument;e&&isOutsideInput(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function _focusEditorElement(){_assertClassBrand$1c(_FocusManager_brand,this,_getSelectedCell).call(this,t=>{this.getFocusMode()===FOCUS_MODES.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function _onUpdateSettings(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL)}var es_string_replaceAll={},isRegexp,hasRequiredIsRegexp;function requireIsRegexp(){if(hasRequiredIsRegexp)return isRegexp;hasRequiredIsRegexp=1;var t=requireIsObject(),e=requireClassofRaw(),r=requireWellKnownSymbol(),i=r("match");return isRegexp=function(n){var s;return t(n)&&((s=n[i])!==void 0?!!s:e(n)==="RegExp")},isRegexp}var regexpFlagsDetection,hasRequiredRegexpFlagsDetection;function requireRegexpFlagsDetection(){if(hasRequiredRegexpFlagsDetection)return regexpFlagsDetection;hasRequiredRegexpFlagsDetection=1;var t=requireGlobalThis(),e=requireFails(),r=t.RegExp,i=!e(function(){var n=!0;try{r(".","d")}catch{n=!1}var s={},o="",a=n?"dgimsy":"gimsy",l=function(h,f){Object.defineProperty(s,h,{get:function(){return o+=f,!0}})},c={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};n&&(c.hasIndices="d");for(var u in c)l(u,c[u]);var d=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(s);return d!==a||o!==a});return regexpFlagsDetection={correct:i},regexpFlagsDetection}var regexpFlags,hasRequiredRegexpFlags;function requireRegexpFlags(){if(hasRequiredRegexpFlags)return regexpFlags;hasRequiredRegexpFlags=1;var t=requireAnObject();return regexpFlags=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},regexpFlags}var regexpGetFlags,hasRequiredRegexpGetFlags;function requireRegexpGetFlags(){if(hasRequiredRegexpGetFlags)return regexpGetFlags;hasRequiredRegexpGetFlags=1;var t=requireFunctionCall(),e=requireHasOwnProperty(),r=requireObjectIsPrototypeOf(),i=requireRegexpFlagsDetection(),n=requireRegexpFlags(),s=RegExp.prototype;return regexpGetFlags=i.correct?function(o){return o.flags}:function(o){return!i.correct&&r(s,o)&&!e(o,"flags")?t(n,o):o.flags},regexpGetFlags}var getSubstitution,hasRequiredGetSubstitution;function requireGetSubstitution(){if(hasRequiredGetSubstitution)return getSubstitution;hasRequiredGetSubstitution=1;var t=requireFunctionUncurryThis(),e=requireToObject(),r=Math.floor,i=t("".charAt),n=t("".replace),s=t("".slice),o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return getSubstitution=function(l,c,u,d,h,f){var g=u+l.length,m=d.length,C=a;return h!==void 0&&(h=e(h),C=o),n(f,C,function(y,v){var E;switch(i(v,0)){case"$":return"$";case"&":return l;case"`":return s(c,0,u);case"'":return s(c,g);case"<":E=h[s(v,1,-1)];break;default:var $=+v;if($===0)return y;if($>m){var O=r($/10);return O===0?y:O<=m?d[O-1]===void 0?i(v,1):d[O-1]+i(v,1):y}E=d[$-1]}return E===void 0?"":E})},getSubstitution}var hasRequiredEs_string_replaceAll;function requireEs_string_replaceAll(){if(hasRequiredEs_string_replaceAll)return es_string_replaceAll;hasRequiredEs_string_replaceAll=1;var t=require_export(),e=requireFunctionCall(),r=requireFunctionUncurryThis(),i=requireRequireObjectCoercible(),n=requireIsCallable(),s=requireIsObject(),o=requireIsRegexp(),a=requireToString(),l=requireGetMethod(),c=requireRegexpGetFlags(),u=requireGetSubstitution(),d=requireWellKnownSymbol(),h=requireIsPure(),f=d("replace"),g=TypeError,m=r("".indexOf),C=r("".replace),y=r("".slice),v=Math.max;return t({target:"String",proto:!0},{replaceAll:function($,O){var P=i(this),I,W,q,M,Y,z,Q,K,Z,ue,oe=0,ae="";if(s($)){if(I=o($),I&&(W=a(i(c($))),!~m(W,"g")))throw new g("`.replaceAll` does not allow non-global regexes");if(q=l($,f),q)return e(q,$,P,O);if(h&&I)return C(a(P),$,O)}for(M=a(P),Y=a($),z=n(O),z||(O=a(O)),Q=Y.length,K=v(1,Q),Z=m(M,Y);Z!==-1;)ue=z?a(O(Y,Z,M)):u(Y,M,Z,[],void 0,O),ae+=y(M,oe,Z)+ue,oe=Z+Q,Z=Z+K>M.length?-1:m(M,Y,Z+K);return oe<M.length&&(ae+=y(M,oe)),ae}}),es_string_replaceAll}requireEs_string_replaceAll();var esnext_iterator_reduce={},es_iterator_reduce={},hasRequiredEs_iterator_reduce;function requireEs_iterator_reduce(){if(hasRequiredEs_iterator_reduce)return es_iterator_reduce;hasRequiredEs_iterator_reduce=1;var t=require_export(),e=requireIterate(),r=requireACallable(),i=requireAnObject(),n=requireGetIteratorDirect(),s=requireIteratorClose(),o=requireIteratorHelperWithoutClosingOnEarlyError(),a=requireFunctionApply(),l=requireFails(),c=TypeError,u=l(function(){[].keys().reduce(function(){},void 0)}),d=!u&&o("reduce",c);return t({target:"Iterator",proto:!0,real:!0,forced:u||d},{reduce:function(f){i(this);try{r(f)}catch(v){s(this,"throw",v)}var g=arguments.length<2,m=g?void 0:arguments[1];if(d)return a(d,this,g?[f]:[f,m]);var C=n(this),y=0;if(e(C,function(v){g?(g=!1,m=v):m=f(m,v,y),y++},{IS_RECORD:!0}),g)throw new c("Reduce of empty iterator with no initial value");return m}}),es_iterator_reduce}var hasRequiredEsnext_iterator_reduce;function requireEsnext_iterator_reduce(){return hasRequiredEsnext_iterator_reduce||(hasRequiredEsnext_iterator_reduce=1,requireEs_iterator_reduce()),esnext_iterator_reduce}requireEsnext_iterator_reduce();const ESCAPED_HTML_CHARS={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},regEscapedChars=new RegExp(Object.keys(ESCAPED_HTML_CHARS).map(t=>`(${t})`).join("|"),"gi");function isHTMLTable(t){return(t&&t.nodeName||"")==="TABLE"}function instanceToHTML(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),i=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],n=t.getData(...i),s=n.length,o=s>0?n[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=r?1:0,d=e?1:0;for(let h=0;h<s;h+=1){const f=e&&h===0,g=[];for(let C=0;C<o;C+=1){const y=!f&&r&&C===0;let v="";if(f)v=`<th>${t.getColHeader(C-u)}</th>`;else if(y)v=`<th>${t.getRowHeader(h-d)}</th>`;else{const E=n[h][C],{hidden:$,rowspan:O,colspan:P}=t.getCellMeta(h-d,C-u);if(!$){const I=[];if(O&&I.push(`rowspan="${O}"`),P&&I.push(`colspan="${P}"`),isEmpty(E))v=`<td ${I.join(" ")}></td>`;else{const W=E.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${I.join(" ")}>${W}</td>`}}}g.push(v)}const m=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,m):c.splice(-1,0,m)}return a.splice(1,0,l.join(""),c.join("")),a.join("")}function _dataToHTML(t){const e=t.length,r=["<table>"];for(let i=0;i<e;i+=1){const n=t[i],s=n.length,o=[];i===0&&r.push("<tbody>");for(let a=0;a<s;a+=1){const l=n[a],c=isEmpty(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${c}</td>`)}r.push("<tr>",...o,"</tr>"),i+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function htmlToGridSettings(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},i=e.createDocumentFragment(),n=e.createElement("div");i.appendChild(n);let s=t;if(typeof s=="string"){const E=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,$=>{const O=$.match(/<td\b[^>]*?>/g)[0],P=/<p.*?>/g,I=$.substring(O.length,$.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(P,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${O}${I}</td>`});n.insertAdjacentHTML("afterbegin",`${E}`),s=n.querySelector("table")}if(!s||!isHTMLTable(s))return;const o=n.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),c=l?Array.from(l.cells).reduce((E,$)=>E+$.colSpan,0)-(a?1:0):0,u=s.tFoot&&Array.from(s.tFoot.rows)||[],d=[];let h=!1,f=0,g=0;if(s.tHead){const E=Array.from(s.tHead.rows).filter($=>{const O=$.querySelector("td")!==null;return O&&d.push($),!O});f=E.length,h=f>0,f>1?r.nestedHeaders=Array.from(E).reduce(($,O)=>{const P=Array.from(O.cells).reduce((I,W,q)=>{if(a&&q===0)return I;const{colSpan:M,innerHTML:Y}=W,z=M>1?{label:Y,colspan:M}:Y;return I.push(z),I},[]);return $.push(P),$},[]):h&&(r.colHeaders=Array.from(E[0].children).reduce(($,O,P)=>(a&&P===0||$.push(O.innerHTML),$),[]))}d.length&&(r.fixedRowsTop=d.length),u.length&&(r.fixedRowsBottom=u.length);const m=[...d,...Array.from(s.tBodies).reduce((E,$)=>(E.push(...Array.from($.rows)),E),[]),...u];g=m.length;const C=new Array(g);for(let E=0;E<g;E++)C[E]=new Array(c);const y=[],v=[];for(let E=0;E<g;E++){const $=m[E],O=Array.from($.cells),P=O.length;for(let I=0;I<P;I++){const W=O[I],{nodeName:q,innerHTML:M,rowSpan:Y,colSpan:z}=W,Q=C[E].findIndex(K=>K===void 0);if(q==="TD"){if(Y>1||z>1){for(let oe=E;oe<E+Y;oe++)if(oe<g)for(let ae=Q;ae<Q+z;ae++)C[oe][ae]=null;const Z=W.getAttribute("style");Z&&Z.includes("mso-ignore:colspan")||y.push({col:Q,row:E,rowspan:Y,colspan:z})}let K="";o&&/excel/gi.test(o.content)?K=M.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):K=M.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[E][Q]=K.replace(regEscapedChars,Z=>ESCAPED_HTML_CHARS[Z])}else v.push(M)}}return y.length&&(r.mergeCells=y),v.length&&(r.rowHeaders=v),C.length&&(r.data=C),r}const parseTableHelpers=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML,htmlToGridSettings,instanceToHTML},Symbol.toStringTag,{value:"Module"}));function isNumeric(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(n=>`\\${n}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function isNumericLike(t){return isNumeric(t,[","])}function rangeEach(t,e,r){let i=-1;for(typeof e=="function"?(r=e,e=t):i=t-1;++i<=e&&r(i)!==!1;);}function rangeEachReverse(t,e,r){let i=t+1;for(typeof e=="function"&&(r=e,e=0);--i>=e&&r(i)!==!1;);}function valueAccordingPercent(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function clamp(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const numberHelpers=Object.freeze(Object.defineProperty({__proto__:null,clamp,isNumeric,isNumericLike,rangeEach,rangeEachReverse,valueAccordingPercent},Symbol.toStringTag,{value:"Module"})),ASC="asc",DESC="desc",ORDER_MAP=new Map([[ASC,[-1,1]],[DESC,[1,-1]]]),DEFAULT_ERROR_PRIORITY_EXISTS=t=>`The priority '${t}' is already declared in a map.`,DEFAULT_ERROR_PRIORITY_NAN=t=>`The priority '${t}' is not a number.`;function createPriorityMap(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=isFunction(t)?t:DEFAULT_ERROR_PRIORITY_EXISTS,e=isFunction(e)?e:DEFAULT_ERROR_PRIORITY_NAN;function i(s,o){if(!isNumeric(s))throw new Error(e(s));if(r.has(s))throw new Error(t(s));r.set(s,o)}function n(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ASC;const[o,a]=ORDER_MAP.get(s)||ORDER_MAP.get(ASC);return[...r].sort((l,c)=>l[0]<c[0]?o:a).map(l=>l[1])}return{addItem:i,getItems:n}}const DEFAULT_ERROR_ID_EXISTS=t=>`The id '${t}' is already declared in a map.`;function createUniqueMap(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=isFunction(t)?t:DEFAULT_ERROR_ID_EXISTS;function r(c,u){if(l(c))throw new Error(t(c));e.set(c,u)}function i(c){return e.delete(c)}function n(){e.clear()}function s(c){const[u]=a().find(d=>{let[h,f]=d;return c===f?h:!1})||[null];return u}function o(c){return e.get(c)}function a(){return[...e]}function l(c){return e.has(c)}return{addItem:r,clear:n,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:i}}const DEFAULT_ERROR_ITEM_EXISTS=t=>`'${t}' value is already declared in a unique set.`;function createUniqueSet(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=isFunction(t)?t:DEFAULT_ERROR_ITEM_EXISTS;function r(s){if(e.has(s))throw new Error(t(s));e.add(s)}function i(){return[...e]}function n(){e.clear()}return{addItem:r,clear:n,getItems:i}}const ERROR_PLUGIN_REGISTERED=t=>`There is already registered "${t}" plugin.`,ERROR_PRIORITY_REGISTERED=t=>`There is already registered plugin on priority "${t}".`,ERROR_PRIORITY_NAN=t=>`The priority "${t}" is not a number.`,priorityPluginsQueue=createPriorityMap({errorPriorityExists:ERROR_PRIORITY_REGISTERED,errorPriorityNaN:ERROR_PRIORITY_NAN}),uniquePluginsQueue=createUniqueSet({errorItemExists:ERROR_PLUGIN_REGISTERED}),uniquePluginsList=createUniqueMap({errorIdExists:ERROR_PLUGIN_REGISTERED});function getPluginsNames(){return[...priorityPluginsQueue.getItems(),...uniquePluginsQueue.getItems()]}function getPlugin(t){const e=toUpperCaseFirst(t);return uniquePluginsList.getItem(e)}function hasPlugin(t){return!!getPlugin(t)}function registerPlugin(t,e,r){[t,e,r]=unifyPluginArguments(t,e,r),getPlugin(t)===void 0&&_registerPlugin(t,e,r)}function _registerPlugin(t,e,r){const i=toUpperCaseFirst(t);if(uniquePluginsList.hasItem(i))throw new Error(ERROR_PLUGIN_REGISTERED(i));r===void 0?uniquePluginsQueue.addItem(i):priorityPluginsQueue.addItem(r,i),uniquePluginsList.addItem(i,e)}function unifyPluginArguments(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:register$3,getItem:getItem$2,hasItem:hasItem$2,getNames:getNames$2,getValues:getValues$2}=staticRegister("renderers");function _getItem$2(t){if(typeof t=="function")return t;if(!hasItem$2(t))throw Error(`No registered renderer found under "${t}" name`);return getItem$2(t)}function _register$2(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),register$3(t,e)}const{register:register$2,getItem:getItem$1,hasItem:hasItem$1,getNames:getNames$1,getValues:getValues$1}=staticRegister("validators");function _getItem$1(t){if(typeof t=="function")return t;if(!hasItem$1(t))throw Error(`No registered validator found under "${t}" name`);return getItem$1(t)}function _register$1(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),register$2(t,e)}var es_array_at={},hasRequiredEs_array_at;function requireEs_array_at(){if(hasRequiredEs_array_at)return es_array_at;hasRequiredEs_array_at=1;var t=require_export(),e=requireToObject(),r=requireLengthOfArrayLike(),i=requireToIntegerOrInfinity(),n=requireAddToUnscopables();return t({target:"Array",proto:!0},{at:function(o){var a=e(this),l=r(a),c=i(o),u=c>=0?c:l+c;return u<0||u>=l?void 0:a[u]}}),n("at"),es_array_at}requireEs_array_at();var es_string_atAlternative={},hasRequiredEs_string_atAlternative;function requireEs_string_atAlternative(){if(hasRequiredEs_string_atAlternative)return es_string_atAlternative;hasRequiredEs_string_atAlternative=1;var t=require_export(),e=requireFunctionUncurryThis(),r=requireRequireObjectCoercible(),i=requireToIntegerOrInfinity(),n=requireToString(),s=requireFails(),o=e("".charAt),a=s(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(c){var u=n(r(this)),d=u.length,h=i(c),f=h>=0?h:d+h;return f<0||f>=d?void 0:o(u,f)}}),es_string_atAlternative}requireEs_string_atAlternative();function _defineProperty$28(t,e,r){return(e=_toPropertyKey$28(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$28(t){var e=_toPrimitive$28(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$28(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FullyVisibleColumnsCalculationType{constructor(){_defineProperty$28(this,"count",0),_defineProperty$28(this,"startColumn",null),_defineProperty$28(this,"endColumn",null),_defineProperty$28(this,"startPosition",null),_defineProperty$28(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:i,zeroBasedScrollOffset:n,viewportWidth:s,columnWidth:o}=r,a=n>0?s+1:s;i>=n&&i+o<=n+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:i,viewportWidth:n,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:c,columnWidth:u}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=c[this.endColumn]+u-c[this.startColumn-1];if(g<=n&&(this.startColumn-=1),g>=n)break}this.startPosition=(r=c[this.startColumn])!==null&&r!==void 0?r:null;const d=o>0?n+1:n,h=i+n-d,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);h<-1*s||i>c.at(-1)||-1*i-n>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$27(t,e,r){return(e=_toPropertyKey$27(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$27(t){var e=_toPrimitive$27(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$27(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FullyVisibleRowsCalculationType{constructor(){_defineProperty$27(this,"count",0),_defineProperty$27(this,"startRow",null),_defineProperty$27(this,"endRow",null),_defineProperty$27(this,"startPosition",null),_defineProperty$27(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:i,zeroBasedScrollOffset:n,innerViewportHeight:s,rowHeight:o}=r;i>=n&&i+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:i,viewportHeight:n,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:c}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+c-l[this.startRow-1];if(h<=n-s&&(this.startRow-=1),h>=n-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const u=i+n-s,d=this.startRow===null?0:e.getRowHeight(this.startRow);u<d||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$26(t,e,r){return(e=_toPropertyKey$26(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$26(t){var e=_toPrimitive$26(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$26(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PartiallyVisibleColumnsCalculationType{constructor(){_defineProperty$26(this,"count",0),_defineProperty$26(this,"startColumn",null),_defineProperty$26(this,"endColumn",null),_defineProperty$26(this,"startPosition",null),_defineProperty$26(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:i,zeroBasedScrollOffset:n,viewportWidth:s}=r;i<=n&&(this.startColumn=e);const o=n>0?s+1:s;i>=n&&i<=n+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:i,viewportWidth:n,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:c,columnWidth:u}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=c[this.endColumn]+u-c[this.startColumn-1];if(this.startColumn-=1,f>n)break}this.startPosition=(r=c[this.startColumn])!==null&&r!==void 0?r:null;const d=o>0?n+1:n;i+n-d<-1*s||i>c.at(-1)+u||-1*i-n>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$25(t,e,r){return(e=_toPropertyKey$25(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$25(t){var e=_toPrimitive$25(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$25(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PartiallyVisibleRowsCalculationType{constructor(){_defineProperty$25(this,"count",0),_defineProperty$25(this,"startRow",null),_defineProperty$25(this,"endRow",null),_defineProperty$25(this,"startPosition",null),_defineProperty$25(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:i,zeroBasedScrollOffset:n,innerViewportHeight:s}=r;i<=n&&(this.startRow=e),i>=n&&i<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:i,viewportHeight:n,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:c}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+c-l[this.startRow-1];if(this.startRow-=1,d>=n-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,i+n-s<0||i>l.at(-1)+c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$24(t,e,r){return(e=_toPropertyKey$24(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$24(t){var e=_toPrimitive$24(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$24(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RenderedAllColumnsCalculationType{constructor(){_defineProperty$24(this,"count",0),_defineProperty$24(this,"startColumn",0),_defineProperty$24(this,"endColumn",0),_defineProperty$24(this,"startPosition",0),_defineProperty$24(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function _defineProperty$23(t,e,r){return(e=_toPropertyKey$23(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$23(t){var e=_toPrimitive$23(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$23(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RenderedAllRowsCalculationType{constructor(){_defineProperty$23(this,"count",0),_defineProperty$23(this,"startRow",0),_defineProperty$23(this,"endRow",0),_defineProperty$23(this,"startPosition",0),_defineProperty$23(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function _defineProperty$22(t,e,r){return(e=_toPropertyKey$22(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$22(t){var e=_toPrimitive$22(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$22(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RenderedColumnsCalculationType extends PartiallyVisibleColumnsCalculationType{constructor(){super(...arguments),_defineProperty$22(this,"columnStartOffset",0),_defineProperty$22(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:i,totalColumns:n,startPositions:s}=e;if(this.startColumn!==null&&typeof i=="function"){const o=this.startColumn,a=this.endColumn;i(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=s[this.startColumn])!==null&&r!==void 0?r:null,n<this.endColumn&&(this.endColumn=n-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$21(t,e,r){return(e=_toPropertyKey$21(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$21(t){var e=_toPrimitive$21(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$21(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RenderedRowsCalculationType extends PartiallyVisibleRowsCalculationType{constructor(){super(...arguments),_defineProperty$21(this,"rowStartOffset",0),_defineProperty$21(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:i,totalRows:n,startPositions:s}=e;if(this.startRow!==null&&typeof i=="function"){const o=this.startRow,a=this.endRow;i(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=s[this.startRow])!==null&&r!==void 0?r:null,n<this.endRow&&(this.endRow=n-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$20(t,e,r){return(e=_toPropertyKey$20(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$20(t){var e=_toPrimitive$20(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$20(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ViewportBaseCalculator{constructor(e){_defineProperty$20(this,"calculationTypes",[]),_defineProperty$20(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[i,n]=r;this.calculationResults.set(i,n),n.initialize(e)})}_process(e,r){this.calculationTypes.forEach(i=>{let[,n]=i;return n.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,i]=r;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function _defineProperty$1$(t,e,r){return(e=_toPropertyKey$1$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1$(t){var e=_toPrimitive$1$(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const DEFAULT_WIDTH=50;class ViewportColumnsCalculator extends ViewportBaseCalculator{constructor(e){let{calculationTypes:r,viewportWidth:i,scrollOffset:n,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(r),_defineProperty$1$(this,"viewportWidth",0),_defineProperty$1$(this,"scrollOffset",0),_defineProperty$1$(this,"zeroBasedScrollOffset",0),_defineProperty$1$(this,"totalColumns",0),_defineProperty$1$(this,"columnWidthFn",null),_defineProperty$1$(this,"columnWidth",0),_defineProperty$1$(this,"overrideFn",null),_defineProperty$1$(this,"inlineStartOffset",0),_defineProperty$1$(this,"totalCalculatedWidth",0),_defineProperty$1$(this,"startPositions",[]),_defineProperty$1$(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=n,this.zeroBasedScrollOffset=Math.max(n,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?DEFAULT_WIDTH:r}}function _defineProperty$1_(t,e,r){return(e=_toPropertyKey$1_(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1_(t){var e=_toPrimitive$1_(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1_(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ViewportRowsCalculator extends ViewportBaseCalculator{constructor(e){let{calculationTypes:r,viewportHeight:i,scrollOffset:n,totalRows:s,defaultRowHeight:o,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:c}=e;super(r),_defineProperty$1_(this,"viewportHeight",0),_defineProperty$1_(this,"scrollOffset",0),_defineProperty$1_(this,"zeroBasedScrollOffset",0),_defineProperty$1_(this,"totalRows",0),_defineProperty$1_(this,"rowHeightFn",null),_defineProperty$1_(this,"rowHeight",0),_defineProperty$1_(this,"overrideFn",null),_defineProperty$1_(this,"horizontalScrollbarHeight",0),_defineProperty$1_(this,"innerViewportHeight",0),_defineProperty$1_(this,"totalCalculatedHeight",0),_defineProperty$1_(this,"startPositions",[]),_defineProperty$1_(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=i,this.scrollOffset=n,this.zeroBasedScrollOffset=Math.max(n,0),this.totalRows=s,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=c??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function _classPrivateFieldInitSpec$S(t,e,r){_checkPrivateRedeclaration$1b(t,e),e.set(t,r)}function _checkPrivateRedeclaration$1b(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1Z(t,e,r){return(e=_toPropertyKey$1Z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1Z(t){var e=_toPrimitive$1Z(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1Z(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$S(t,e){return t.get(_assertClassBrand$1b(t,e))}function _classPrivateFieldSet$O(t,e,r){return t.set(_assertClassBrand$1b(t,e),r),r}function _assertClassBrand$1b(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _isRtl$2=new WeakMap;class CellCoords{constructor(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_defineProperty$1Z(this,"row",null),_defineProperty$1Z(this,"col",null),_classPrivateFieldInitSpec$S(this,_isRtl$2,!1),_classPrivateFieldSet$O(_isRtl$2,this,i),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:i,countRowHeaders:n,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-n||this.row>=r||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return _classPrivateFieldGet$S(_isRtl$2,this)}isSouthEastOf(e){return this.row>=e.row&&(_classPrivateFieldGet$S(_isRtl$2,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(_classPrivateFieldGet$S(_isRtl$2,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(_classPrivateFieldGet$S(_isRtl$2,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(_classPrivateFieldGet$S(_isRtl$2,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof CellCoords&&_classPrivateFieldSet$O(_isRtl$2,this,e.isRtl()),this}clone(){return new CellCoords(this.row,this.col,_classPrivateFieldGet$S(_isRtl$2,this))}toObject(){return{row:this.row,col:this.col}}}function _classPrivateFieldInitSpec$R(t,e,r){_checkPrivateRedeclaration$1a(t,e),e.set(t,r)}function _checkPrivateRedeclaration$1a(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1Y(t,e,r){return(e=_toPropertyKey$1Y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1Y(t){var e=_toPrimitive$1Y(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1Y(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$R(t,e){return t.get(_assertClassBrand$1a(t,e))}function _classPrivateFieldSet$N(t,e,r){return t.set(_assertClassBrand$1a(t,e),r),r}function _assertClassBrand$1a(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _isRtl$1=new WeakMap;class CellRange{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;_defineProperty$1Y(this,"highlight",null),_defineProperty$1Y(this,"from",null),_defineProperty$1Y(this,"to",null),_classPrivateFieldInitSpec$R(this,_isRtl$1,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=i.clone(),_classPrivateFieldSet$N(_isRtl$1,this,n)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:i}=e,n=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return n.row<=r&&s.row>=r&&n.col<=i&&s.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(i.row,o.row),c=Math.min(i.col,o.col),u=Math.max(n.row,a.row),d=Math.max(n.col,a.col),h=this._createCellCoords(l,c),f=this._createCellCoords(u,d);return this.from=h,this.to=f,this.setDirection(s),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return _classPrivateFieldGet$R(_isRtl$1,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return _classPrivateFieldGet$R(_isRtl$1,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return _classPrivateFieldGet$R(_isRtl$1,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return _classPrivateFieldGet$R(_isRtl$1,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return _classPrivateFieldGet$R(_isRtl$1,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return _classPrivateFieldGet$R(_isRtl$1,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return _classPrivateFieldGet$R(_isRtl$1,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return _classPrivateFieldGet$R(_isRtl$1,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof CellCoords))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},n=[];return r.top===i.top&&n.push("top"),r.right===i.right&&n.push(_classPrivateFieldGet$R(_isRtl$1,this)?"left":"right"),r.bottom===i.bottom&&n.push("bottom"),r.left===i.left&&n.push(_classPrivateFieldGet$R(_isRtl$1,this)?"right":"left"),n}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=[];for(let n=e.row;n<=r.row;n++)for(let s=e.col;s<=r.col;s++)!(this.from.row===n&&this.from.col===s)&&!(this.to.row===n&&this.to.col===s)&&i.push(this._createCellCoords(n,s));return i}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=[];for(let n=e.row;n<=r.row;n++)for(let s=e.col;s<=r.col;s++)e.row===n&&e.col===s?i.push(e):r.row===n&&r.col===s?i.push(r):i.push(this._createCellCoords(n,s));return i}forAll(e){const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let n=r.row;n<=i.row;n++)for(let s=r.col;s<=i.col;s++)if(e(n,s)===!1)return}clone(){return new CellRange(this.highlight,this.from,this.to,_classPrivateFieldGet$R(_isRtl$1,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new CellCoords(e,r,_classPrivateFieldGet$R(_isRtl$1,this))}}function _classPrivateFieldInitSpec$Q(t,e,r){_checkPrivateRedeclaration$19(t,e),e.set(t,r)}function _checkPrivateRedeclaration$19(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$Q(t,e){return t.get(_assertClassBrand$19(t,e))}function _classPrivateFieldSet$M(t,e,r){return t.set(_assertClassBrand$19(t,e),r),r}function _assertClassBrand$19(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _wtSettings=new WeakMap,_domBindings=new WeakMap,_wtTable=new WeakMap,_selectionManager=new WeakMap,_parent=new WeakMap,_eventManager=new WeakMap,_facadeGetter=new WeakMap,_selectedCellBeforeTouchEnd=new WeakMap,_dblClickTimeout=new WeakMap,_dblClickOrigin=new WeakMap;let Event$1=class{constructor(e,r,i,n,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;_classPrivateFieldInitSpec$Q(this,_wtSettings,void 0),_classPrivateFieldInitSpec$Q(this,_domBindings,void 0),_classPrivateFieldInitSpec$Q(this,_wtTable,void 0),_classPrivateFieldInitSpec$Q(this,_selectionManager,void 0),_classPrivateFieldInitSpec$Q(this,_parent,void 0),_classPrivateFieldInitSpec$Q(this,_eventManager,void 0),_classPrivateFieldInitSpec$Q(this,_facadeGetter,void 0),_classPrivateFieldInitSpec$Q(this,_selectedCellBeforeTouchEnd,void 0),_classPrivateFieldInitSpec$Q(this,_dblClickTimeout,[null,null]),_classPrivateFieldInitSpec$Q(this,_dblClickOrigin,[null,null]),_classPrivateFieldSet$M(_wtSettings,this,i),_classPrivateFieldSet$M(_domBindings,this,r),_classPrivateFieldSet$M(_wtTable,this,s),_classPrivateFieldSet$M(_selectionManager,this,o),_classPrivateFieldSet$M(_parent,this,a),_classPrivateFieldSet$M(_eventManager,this,n),_classPrivateFieldSet$M(_facadeGetter,this,e),this.registerEvents()}registerEvents(){_classPrivateFieldGet$Q(_eventManager,this).addEventListener(_classPrivateFieldGet$Q(_wtTable,this).holder,"contextmenu",i=>this.onContextMenu(i)),_classPrivateFieldGet$Q(_eventManager,this).addEventListener(_classPrivateFieldGet$Q(_wtTable,this).TABLE,"mouseover",i=>this.onMouseOver(i)),_classPrivateFieldGet$Q(_eventManager,this).addEventListener(_classPrivateFieldGet$Q(_wtTable,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{_classPrivateFieldGet$Q(_eventManager,this).addEventListener(_classPrivateFieldGet$Q(_wtTable,this).holder,"touchstart",i=>this.onTouchStart(i)),_classPrivateFieldGet$Q(_eventManager,this).addEventListener(_classPrivateFieldGet$Q(_wtTable,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),_classPrivateFieldGet$Q(_eventManager,this).addEventListener(_classPrivateFieldGet$Q(_wtTable,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||_classPrivateFieldGet$Q(_wtSettings,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,_classPrivateFieldGet$Q(_wtSettings,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{_classPrivateFieldGet$Q(_eventManager,this).addEventListener(_classPrivateFieldGet$Q(_wtTable,this).holder,"mouseup",i=>this.onMouseUp(i)),_classPrivateFieldGet$Q(_eventManager,this).addEventListener(_classPrivateFieldGet$Q(_wtTable,this).holder,"mousedown",i=>this.onMouseDown(i))};isMobileBrowser()?e():(isTouchSupported()&&e(),r())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(_classPrivateFieldGet$Q(_selectedCellBeforeTouchEnd,this)&&i){const[n,s]=[i.row,_classPrivateFieldGet$Q(_selectedCellBeforeTouchEnd,this).from.row],[o,a]=[i.col,_classPrivateFieldGet$Q(_selectedCellBeforeTouchEnd,this).from.col];return n===s&&o===a}return!1}parentCell(e){const r={},i=_classPrivateFieldGet$Q(_wtTable,this).TABLE,n=closestDown(e,["TD","TH"],i);return n?(r.coords=_classPrivateFieldGet$Q(_wtTable,this).getCoords(n),r.TD=n):hasClass$1(e,"wtBorder")&&hasClass$1(e,"current")?(r.coords=_classPrivateFieldGet$Q(_selectionManager,this).getFocusSelection().cellRange.highlight,r.TD=_classPrivateFieldGet$Q(_wtTable,this).getCell(r.coords)):hasClass$1(e,"wtBorder")&&hasClass$1(e,"area")&&_classPrivateFieldGet$Q(_selectionManager,this).getAreaSelection().cellRange&&(r.coords=_classPrivateFieldGet$Q(_selectionManager,this).getAreaSelection().cellRange.to,r.TD=_classPrivateFieldGet$Q(_wtTable,this).getCell(r.coords)),r}onMouseDown(e){const r=_classPrivateFieldGet$Q(_domBindings,this).rootDocument.activeElement,i=partial(getParent,e.target),n=e.target;if(!["TD","TH"].includes(r.nodeName)&&(n===r||i(0)===r||i(1)===r))return;const s=this.parentCell(n);hasClass$1(n,"corner")?_classPrivateFieldGet$Q(_wtSettings,this).getSetting("onCellCornerMouseDown",e,n):s.TD&&_classPrivateFieldGet$Q(_wtSettings,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(_classPrivateFieldGet$Q(_dblClickOrigin,this)[0]=s.TD,clearTimeout(_classPrivateFieldGet$Q(_dblClickTimeout,this)[0]),_classPrivateFieldGet$Q(_dblClickTimeout,this)[0]=setTimeout(()=>{_classPrivateFieldGet$Q(_dblClickOrigin,this)[0]=null},1e3))}onContextMenu(e){if(_classPrivateFieldGet$Q(_wtSettings,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!_classPrivateFieldGet$Q(_wtSettings,this).has("onCellMouseOver"))return;const r=_classPrivateFieldGet$Q(_wtTable,this).TABLE,i=closestDown(e.target,["TD","TH"],r),n=_classPrivateFieldGet$Q(_parent,this)||this;i&&i!==n.lastMouseOver&&isChildOf(i,r)&&(n.lastMouseOver=i,this.callListener("onCellMouseOver",e,_classPrivateFieldGet$Q(_wtTable,this).getCoords(i),i))}onMouseOut(e){if(!_classPrivateFieldGet$Q(_wtSettings,this).has("onCellMouseOut"))return;const r=_classPrivateFieldGet$Q(_wtTable,this).TABLE,i=closestDown(e.target,["TD","TH"],r),n=closestDown(e.relatedTarget,["TD","TH"],r),s=_classPrivateFieldGet$Q(_parent,this)||this;i&&i!==n&&isChildOf(i,r)&&(this.callListener("onCellMouseOut",e,_classPrivateFieldGet$Q(_wtTable,this).getCoords(i),i),n===null&&(s.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&_classPrivateFieldGet$Q(_wtSettings,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===_classPrivateFieldGet$Q(_dblClickOrigin,this)[0]&&r.TD===_classPrivateFieldGet$Q(_dblClickOrigin,this)[1]?(hasClass$1(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),_classPrivateFieldGet$Q(_dblClickOrigin,this)[0]=null,_classPrivateFieldGet$Q(_dblClickOrigin,this)[1]=null):r.TD===_classPrivateFieldGet$Q(_dblClickOrigin,this)[0]&&(_classPrivateFieldGet$Q(_dblClickOrigin,this)[1]=r.TD,clearTimeout(_classPrivateFieldGet$Q(_dblClickTimeout,this)[1]),_classPrivateFieldGet$Q(_dblClickTimeout,this)[1]=setTimeout(()=>{_classPrivateFieldGet$Q(_dblClickOrigin,this)[1]=null},500)))}onTouchStart(e){_classPrivateFieldSet$M(_selectedCellBeforeTouchEnd,this,_classPrivateFieldGet$Q(_selectionManager,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const i=e.target,n=(r=this.parentCell(i))===null||r===void 0?void 0:r.coords,s=isDefined(n)&&n.row>=0&&n.col>=0;if(e.cancelable&&s&&_classPrivateFieldGet$Q(_wtSettings,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];isIOS()&&(isChromeWebKit()||isFirefoxWebKit())&&this.selectedCellWasTouched(i)&&!a.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,i,n){const s=_classPrivateFieldGet$Q(_wtSettings,this).getSettingPure(e);s&&s(r,i,n,_classPrivateFieldGet$Q(_facadeGetter,this).call(this))}destroy(){clearTimeout(_classPrivateFieldGet$Q(_dblClickTimeout,this)[0]),clearTimeout(_classPrivateFieldGet$Q(_dblClickTimeout,this)[1]),_classPrivateFieldGet$Q(_eventManager,this).destroy()}};function _defineProperty$1X(t,e,r){return(e=_toPropertyKey$1X(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1X(t){var e=_toPrimitive$1X(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1X(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ColumnFilter{constructor(e,r,i){_defineProperty$1X(this,"offset",void 0),_defineProperty$1X(this,"total",void 0),_defineProperty$1X(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function _defineProperty$1W(t,e,r){return(e=_toPropertyKey$1W(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1W(t){var e=_toPrimitive$1W(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1W(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RowFilter{constructor(e,r,i){_defineProperty$1W(this,"offset",void 0),_defineProperty$1W(this,"total",void 0),_defineProperty$1W(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function _defineProperty$1V(t,e,r){return(e=_toPropertyKey$1V(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1V(t){var e=_toPrimitive$1V(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1V(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ViewSize{constructor(){_defineProperty$1V(this,"currentSize",0),_defineProperty$1V(this,"nextSize",0),_defineProperty$1V(this,"currentOffset",0),_defineProperty$1V(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const WORKING_SPACE_ALL=0,WORKING_SPACE_TOP=1,WORKING_SPACE_BOTTOM=2;function _defineProperty$1U(t,e,r){return(e=_toPropertyKey$1U(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1U(t){var e=_toPrimitive$1U(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1U(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ViewSizeSet{constructor(){_defineProperty$1U(this,"size",new ViewSize),_defineProperty$1U(this,"workingSpace",WORKING_SPACE_ALL),_defineProperty$1U(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=WORKING_SPACE_TOP,e.workingSpace=WORKING_SPACE_BOTTOM,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=WORKING_SPACE_BOTTOM,e.workingSpace=WORKING_SPACE_TOP,this.sharedSize=e.getViewSize()}}var es_array_unshift={},deletePropertyOrThrow,hasRequiredDeletePropertyOrThrow;function requireDeletePropertyOrThrow(){if(hasRequiredDeletePropertyOrThrow)return deletePropertyOrThrow;hasRequiredDeletePropertyOrThrow=1;var t=requireTryToString(),e=TypeError;return deletePropertyOrThrow=function(r,i){if(!delete r[i])throw new e("Cannot delete property "+t(i)+" of "+t(r))},deletePropertyOrThrow}var hasRequiredEs_array_unshift;function requireEs_array_unshift(){if(hasRequiredEs_array_unshift)return es_array_unshift;hasRequiredEs_array_unshift=1;var t=require_export(),e=requireToObject(),r=requireLengthOfArrayLike(),i=requireArraySetLength(),n=requireDeletePropertyOrThrow(),s=requireDoesNotExceedSafeInteger(),o=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(c){return c instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(u){var d=e(this),h=r(d),f=arguments.length;if(f){s(h+f);for(var g=h;g--;){var m=g+f;g in d?d[m]=d[g]:n(d,m)}for(var C=0;C<f;C++)d[C]=arguments[C]}return i(d,h+f)}}),es_array_unshift}requireEs_array_unshift();function _defineProperty$1T(t,e,r){return(e=_toPropertyKey$1T(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1T(t){var e=_toPrimitive$1T(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1T(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ViewOrder{constructor(e,r){_defineProperty$1T(this,"order",[]),this.order=[...Array(r).keys()].map(i=>e+i)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function _defineProperty$1S(t,e,r){return(e=_toPropertyKey$1S(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1S(t){var e=_toPrimitive$1S(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1S(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ViewDiffer{constructor(e){_defineProperty$1S(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:i}=e.getViewSize();let n=Math.max(i,r);if(n===0)return[];const{currentOffset:s,nextOffset:o}=e.getViewSize(),a=new ViewOrder(s,r),l=new ViewOrder(o,i),c=[];for(let u=0;u<n;u++){const d=a.get(u),h=l.get(u);if(h===-1)c.push(["remove",d]);else if(d===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(WORKING_SPACE_BOTTOM)?c.push(["append",h]):c.push(["prepend",h]);else if(h>d)a.has(h)&&(a.remove(h),i<=a.length&&(n-=1)),c.push(["replace",h,d]);else if(h<d){const f=a.prepend(h);c.push(["insert_before",h,d,f])}else c.push(["none",h])}return c}}function _defineProperty$1R(t,e,r){return(e=_toPropertyKey$1R(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1R(t){var e=_toPrimitive$1R(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1R(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OrderView{constructor(e,r){_defineProperty$1R(this,"rootNode",void 0),_defineProperty$1R(this,"nodesPool",void 0),_defineProperty$1R(this,"sizeSet",new ViewSizeSet),_defineProperty$1R(this,"collectedNodes",[]),_defineProperty$1R(this,"viewDiffer",new ViewDiffer(this.sizeSet)),_defineProperty$1R(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[i,n,s,o]=e,a=this.nodesPool(n);switch(this.collectedNodes.push(a),i){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(s)),r.removeChild(this.nodesPool(o));break;case"replace":r.replaceChild(a,this.nodesPool(s));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class SharedOrderView extends OrderView{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function _defineProperty$1Q(t,e,r){return(e=_toPropertyKey$1Q(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1Q(t){var e=_toPrimitive$1Q(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1Q(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NodesPool{constructor(e){_defineProperty$1Q(this,"nodeType",void 0),_defineProperty$1Q(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const n=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(n))return this.pool.get(n);const s=this.rootDocument.createElement(this.nodeType);return this.pool.set(n,s),s}}function _defineProperty$1P(t,e,r){return(e=_toPropertyKey$1P(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1P(t){var e=_toPrimitive$1P(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1P(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BaseRenderer{constructor(e,r){_defineProperty$1P(this,"nodesPool",null),_defineProperty$1P(this,"nodeType",void 0),_defineProperty$1P(this,"rootNode",void 0),_defineProperty$1P(this,"table",null),_defineProperty$1P(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new NodesPool(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function _defineProperty$1O(t,e,r){return(e=_toPropertyKey$1O(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1O(t){var e=_toPrimitive$1O(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1O(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RowHeadersRenderer extends BaseRenderer{constructor(){super("TH"),_defineProperty$1O(this,"orderViews",new WeakMap),_defineProperty$1O(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new SharedOrderView(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:i,rows:n,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=n.getRenderedNode(o);this.sourceRowIndex=a;const c=this.obtainOrderView(l),u=s.obtainOrderView(l);c.appendView(u).setSize(i).setOffset(0).start();for(let d=i-1;d>=0;d--){c.render();const h=c.getCurrentNode();h.className="",h.removeAttribute("style"),removeAttribute(h,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(h,[A11Y_ROWHEADER(),A11Y_SCOPE_ROW(),A11Y_COLINDEX(d+1),A11Y_TABINDEX(-1)]),r[d](a,h,d)}c.end()}}}class ColumnHeadersRenderer extends BaseRenderer{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:n}=this.table,s=n+r;for(let a=0,l=e;a<l;a++){for(i=this.rootNode.childNodes[a],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<s;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)i.removeChild(i.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&empty(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:i,columnsToRender:n,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&setAttribute(o,[A11Y_ROW(),A11Y_ROWINDEX(r+1)]);for(let a=-1*s;a<n;a+=1){const l=this.table.renderedColumnToSource(a),c=o.childNodes[a+s];c.className="",c.removeAttribute("style"),removeAttribute(c,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(c,[A11Y_COLINDEX(a+1+this.table.rowHeadersCount),A11Y_TABINDEX(-1),A11Y_COLUMNHEADER(),...a>=0?[A11Y_SCOPE_COL()]:[A11Y_GRIDCELL_BUTTON(),A11Y_LABEL("Select whole grid")]]),i[r](l,c,r)}}}}let performanceWarningAppeared$1=!1;class ColGroupRenderer extends BaseRenderer{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,i=e+r;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!performanceWarningAppeared$1&&e>1e3&&(performanceWarningAppeared$1=!0,warn(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let n=0;n<r;n++){const s=this.table.renderedColumnToSource(n),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[n].style.width=`${o}px`}for(let n=0;n<e;n++){const s=this.table.renderedColumnToSource(n),o=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[n+r].style.width=`${o}px`}const i=this.rootNode.firstChild;i&&addClass$1(i,"rowHeader")}}function _defineProperty$1N(t,e,r){return(e=_toPropertyKey$1N(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1N(t){var e=_toPrimitive$1N(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1N(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ROW_CLASSNAMES={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let performanceWarningAppeared=!1;class RowsRenderer extends BaseRenderer{constructor(e){super("TR",e),_defineProperty$1N(this,"orderView",void 0),this.orderView=new OrderView(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!performanceWarningAppeared&&e>1e3&&(performanceWarningAppeared=!0,warn(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<e;n++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(n);if(this.table.isAriaEnabled()){var r,i;setAttribute(s,[A11Y_ROW(),A11Y_ROWINDEX(o+((r=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(o+1)%2===0?hasClass$1(s,ROW_CLASSNAMES.rowEven)||(removeClass$1(s,ROW_CLASSNAMES.rowOdd),addClass$1(s,ROW_CLASSNAMES.rowEven)):hasClass$1(s,ROW_CLASSNAMES.rowOdd)||(removeClass$1(s,ROW_CLASSNAMES.rowEven),addClass$1(s,ROW_CLASSNAMES.rowOdd))}this.orderView.end()}}function _defineProperty$1M(t,e,r){return(e=_toPropertyKey$1M(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1M(t){var e=_toPrimitive$1M(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1M(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CellsRenderer extends BaseRenderer{constructor(){super("TD"),_defineProperty$1M(this,"orderViews",new WeakMap),_defineProperty$1M(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new SharedOrderView(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:i,rowHeaders:n}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),c=i.getRenderedNode(a);this.sourceRowIndex=l;const u=this.obtainOrderView(c),d=n.obtainOrderView(c);u.prependView(d).setSize(r).setOffset(0).start();for(let h=0;h<r;h++){u.render();const f=this.table.renderedColumnToSource(h),g=u.getCurrentNode();if(hasClass$1(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),removeAttribute(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var s,o;setAttribute(g,[...g.hasAttribute("role")?[]:[A11Y_GRIDCELL()],A11Y_TABINDEX(-1),A11Y_COLINDEX(f+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}u.end()}}}function _defineProperty$1L(t,e,r){return(e=_toPropertyKey$1L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1L(t){var e=_toPrimitive$1L(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1L(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TableRenderer{constructor(e){let{cellRenderer:r,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_defineProperty$1L(this,"rootNode",void 0),_defineProperty$1L(this,"rootDocument",void 0),_defineProperty$1L(this,"rowHeaders",null),_defineProperty$1L(this,"columnHeaders",null),_defineProperty$1L(this,"colGroup",null),_defineProperty$1L(this,"rows",null),_defineProperty$1L(this,"cells",null),_defineProperty$1L(this,"rowFilter",null),_defineProperty$1L(this,"columnFilter",null),_defineProperty$1L(this,"rowUtils",null),_defineProperty$1L(this,"columnUtils",null),_defineProperty$1L(this,"rowsToRender",0),_defineProperty$1L(this,"columnsToRender",0),_defineProperty$1L(this,"rowHeaderFunctions",[]),_defineProperty$1L(this,"rowHeadersCount",0),_defineProperty$1L(this,"columnHeaderFunctions",[]),_defineProperty$1L(this,"columnHeadersCount",0),_defineProperty$1L(this,"cellRenderer",void 0),_defineProperty$1L(this,"activeOverlayName",void 0),_defineProperty$1L(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:i,rows:n,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),i.setTable(this),n.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=i,this.rows=n,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let i=0;i<e;i++){const n=r.getRenderedNode(i),s=this.rowUtils;if(n.firstChild){const o=this.renderedRowToSource(i),a=s.getHeightByOverlayName(o,this.activeOverlayName),c=this.stylesHandler.areCellsBorderBox()?0:1;a?n.firstChild.style.height=`${a-c}px`:n.firstChild.style.height=""}}}}class Renderer{constructor(){let{TABLE:e,THEAD:r,COLGROUP:i,TBODY:n,rowUtils:s,columnUtils:o,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new TableRenderer(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new RowHeadersRenderer,columnHeaders:new ColumnHeadersRenderer(r),colGroup:new ColGroupRenderer(i),rows:new RowsRenderer(n),cells:new CellsRenderer}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function _defineProperty$1K(t,e,r){return(e=_toPropertyKey$1K(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1K(t){var e=_toPrimitive$1K(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1K(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ColumnUtils{constructor(e,r){_defineProperty$1K(this,"dataAccessObject",void 0),_defineProperty$1K(this,"wtSettings",void 0),_defineProperty$1K(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(r=r?Math.max(r,i):i),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const i=e.getSetting("rowHeaders").length,n=e.getSetting("defaultColumnWidth");for(let s=0;s<i;s++){let o=Array.isArray(r)?r[s]:r;o=o??n,this.headerWidths.set(s,o)}}}}function _defineProperty$1J(t,e,r){return(e=_toPropertyKey$1J(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1J(t){var e=_toPrimitive$1J(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1J(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RowUtils{constructor(e,r){_defineProperty$1J(this,"dataAccessObject",void 0),_defineProperty$1J(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}getHeightByOverlayName(e,r){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(i=i===void 0?n:Math.max(i,n)),i}}function _defineProperty$1I(t,e,r){return(e=_toPropertyKey$1I(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1I(t){var e=_toPrimitive$1I(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1I(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Table{constructor(e,r,i,n,s){_defineProperty$1I(this,"wtSettings",null),_defineProperty$1I(this,"domBindings",void 0),_defineProperty$1I(this,"TBODY",null),_defineProperty$1I(this,"THEAD",null),_defineProperty$1I(this,"COLGROUP",null),_defineProperty$1I(this,"hasTableHeight",!0),_defineProperty$1I(this,"hasTableWidth",!0),_defineProperty$1I(this,"isTableVisible",!1),_defineProperty$1I(this,"tableOffset",0),_defineProperty$1I(this,"holderOffset",0),this.domBindings=i,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,removeTextNodes(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new RowUtils(this.dataAccessObject,this.wtSettings),this.columnUtils=new ColumnUtils(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let i;return(!r||r.nodeType!==Node.ELEMENT_NODE||!hasClass$1(r,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",r&&r.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&setAttribute(i,[A11Y_PRESENTATION()]),i}createHider(e){const r=e.parentNode;let i;return(!r||r.nodeType!==Node.ELEMENT_NODE||!hasClass$1(r,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",r&&r.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&setAttribute(i,[A11Y_PRESENTATION()]),i}createHolder(e){const r=e.parentNode;let i;return(!r||r.nodeType!==Node.ELEMENT_NODE||!hasClass$1(r,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",this.isMaster&&setAttribute(i,[A11Y_TABINDEX(-1)]),r&&r.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&setAttribute(i.parentNode,[A11Y_PRESENTATION()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&setAttribute(i,[A11Y_PRESENTATION()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:i,wtViewport:n}=this.dataAccessObject,s=r.getSetting("totalRows"),o=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,c=r.getSetting("columnHeaders"),u=c.length;let d=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=offset(this.holder),d=n.createCalculators(d),l&&!r.getSetting("fixedColumnsStart"))){const f=i.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(d=!1)}if(d)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=offset(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new RowFilter(f,s,u),this.columnFilter=new ColumnFilter(g,o,l);let m=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),m=C.skipRender!==!0}m&&(this.tableRenderer.setHeaderContentRenderers(a,c),(this.is(CLONE_BOTTOM)||this.is(CLONE_BOTTOM_INLINE_START_CORNER))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(CLONE_BOTTOM))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||n.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(CLONE_BOTTOM)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let h=!1;return this.isMaster&&(h=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(h=i.bottomOverlay.resetFixedPosition()||h),h=i.inlineStartOverlay.resetFixedPosition()||h,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),h?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,s=this.getColumnHeaderHeight(i),o=this.getColumnHeader(r,i),o&&(a=innerHeight(o),(!s&&n<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),Array.isArray(l)?l[i]!==null&&l[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,n=e.getSetting("columnHeaders");for(let s=0,o=n.length;s<o;s++)if(i[s]){if(!r[s]||r[s].childNodes.length===0)return;r[s].childNodes[0].style.height=`${i[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(CLONE_BOTTOM))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let n=0;n<i;n++){const s=this.rowFilter.renderedToSource(n);r.oversizedRows&&r.oversizedRows[s]&&(r.oversizedRows[s]=void 0)}}}getCell(e){let r=e.row,i=e.col;const n=this.wtSettings.getSetting("onModifyGetCellCoords",r,i,!this.isMaster,"render");if(n&&Array.isArray(n)&&([r,i]=n),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const s=this.getRow(r);if(!s&&r>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!o&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let r=null,i=null;if(e<0){var n;r=(n=this.rowFilter)===null||n===void 0?void 0:n.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),i=this.TBODY}return r!==void 0&&i!==void 0?i.childNodes.length<r+1?!1:i.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[r];return i?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(n=>{const s=n.childNodes[i];s&&r.push(s)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(r>=i)return;const n=this.rowFilter.sourceToRendered(e),s=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):n,a=(n<0?this.THEAD:this.TBODY).childNodes[s];return a?.childNodes[r]}getRowHeaders(e){const r=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let n=0;n<i;n++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s?.childNodes[n];o&&r.push(o)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=closest(r,["TD","TH"])),r===null)return null;const i=r.parentNode;if(!i)return null;const n=i.parentNode;let s=index(i),o=r.cellIndex;overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,r,this.wtRootElement)||overlayContainsElement(CLONE_TOP,r,this.wtRootElement)?n.nodeName==="THEAD"&&(s-=n.childNodes.length):overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,r,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM,r,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-n.childNodes.length+s:n===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):this.rowFilter&&(s=this.rowFilter.renderedToSource(s)),overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,r,this.wtRootElement)||overlayContainsElement(CLONE_INLINE_START,r,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,r,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",s,o);return a&&Array.isArray(a)&&([s,o]=a),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),i=e*r.getDefaultRowHeight(),n=innerHeight(this.TBODY)-1,s=r.areCellsBorderBox(),o=s?outerHeight:innerHeight,a=s?0:1,l=s?1:0;let c,u,d,h,f;if(!(i===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,d=this.rowFilter.renderedToSource(e),c=this.getRowHeight(d),h=this.getTrForRow(d),f=h.querySelector("th");const g=d===0?l:0;f?u=o(f):u=o(h)-a,(!c&&r.getDefaultRowHeight()<u-g||c<u)&&(s||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[d]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return outerWidth(this.TABLE)}getHeight(){return outerHeight(this.TABLE)}getTotalWidth(){const e=outerWidth(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=outerHeight(this.hider);return e!==0?e:this.getHeight()}isVisible(){return isVisible(this.TABLE)}_modifyRowHeaderWidth(e){let r=isFunction(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const MIXIN_NAME$6="stickyRowsBottom",stickyRowsBottom={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};defineGetter(stickyRowsBottom,"MIXIN_NAME",MIXIN_NAME$6,{writable:!1,enumerable:!1});const MIXIN_NAME$5="stickyColumnsStart",stickyColumnsStart={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(stickyColumnsStart,"MIXIN_NAME",MIXIN_NAME$5,{writable:!1,enumerable:!1});class BottomInlineStartCornerOverlayTable extends Table{constructor(e,r,i,n){super(e,r,i,n,CLONE_BOTTOM_INLINE_START_CORNER)}}mixin(BottomInlineStartCornerOverlayTable,stickyRowsBottom);mixin(BottomInlineStartCornerOverlayTable,stickyColumnsStart);const CLONE_TOP="top",CLONE_BOTTOM="bottom",CLONE_INLINE_START="inline_start",CLONE_TOP_INLINE_START_CORNER="top_inline_start_corner",CLONE_BOTTOM_INLINE_START_CORNER="bottom_inline_start_corner",CLONE_TYPES=[CLONE_TOP,CLONE_BOTTOM,CLONE_INLINE_START,CLONE_TOP_INLINE_START_CORNER,CLONE_BOTTOM_INLINE_START_CORNER],CLONE_CLASS_NAMES=new Map([[CLONE_TOP,`ht_clone_${CLONE_TOP}`],[CLONE_BOTTOM,`ht_clone_${CLONE_BOTTOM}`],[CLONE_INLINE_START,`ht_clone_${CLONE_INLINE_START} ht_clone_left`],[CLONE_TOP_INLINE_START_CORNER,`ht_clone_${CLONE_TOP_INLINE_START_CORNER} ht_clone_top_left_corner`],[CLONE_BOTTOM_INLINE_START_CORNER,`ht_clone_${CLONE_BOTTOM_INLINE_START_CORNER} ht_clone_bottom_left_corner`]]);function _classPrivateMethodInitSpec$S(t,e){_checkPrivateRedeclaration$18(t,e),e.add(t)}function _checkPrivateRedeclaration$18(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1H(t,e,r){return(e=_toPropertyKey$1H(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1H(t){var e=_toPrimitive$1H(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1H(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$18(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _Scroll_brand=new WeakSet;class Scroll{constructor(e){_classPrivateMethodInitSpec$S(this,_Scroll_brand),_defineProperty$1H(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,i){if(e.col<0||e.row<0)return!1;const n=this.scrollViewportHorizontally(e.col,r),s=this.scrollViewportVertically(e.row,i);return n||s}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:n}=this.dataAccessObject;if(!i)return!1;const s=createObjectPropListener(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>n)return!1;r=s.value;const{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<o)return!1;const c=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn();let d=!1;return(l&&(e<c||e>u)||!l)&&(d=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),d}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:n}=this.dataAccessObject;if(!i)return!1;const s=createObjectPropListener(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>n)return!1;r=s.value;const{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,c=r==="auto";if(c&&(e<a||e>n-o-1))return!1;const u=this.getFirstVisibleRow(),d=this.getLastVisibleRow();let h=!1;return(c&&(e<u||e>d)||!c)&&(h=l.scrollTo(e,c?e>=this.getLastPartiallyVisibleRow():r==="bottom")),h}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return _assertClassBrand$18(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return _assertClassBrand$18(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return _assertClassBrand$18(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return _assertClassBrand$18(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function _getLastColumnIndex(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:i,wtViewport:n,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(r.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const u=i.TABLE.getBoundingClientRect(),h=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(u.right-h)}else l=offset(i.wtRootElement).left;const c=Math.abs(getScrollLeft(o,o));if(l>c){const u=innerWidth(o);let d=n.getRowHeaderWidth();for(let h=1;h<=s;h++)if(d+=r.sumCellSizes(h-1,h),l+d-c>=u){t=h-2;break}}}return t}function _getLastRowIndex(t){const{topOverlay:e,wtTable:r,wtViewport:i,totalRows:n,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=offset(r.wtRootElement),a=getScrollTop(s,s);if(o.top>a){const l=innerHeight(s);let c=i.getColumnHeaderHeight();for(let u=1;u<=n;u++)if(c+=e.sumCellSizes(u-1,u),o.top+c-a>=l){t=u-2;break}}}return t}function _defineProperty$1G(t,e,r){return(e=_toPropertyKey$1G(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1G(t){var e=_toPrimitive$1G(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1G(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CoreAbstract{get eventManager(){return new EventManager(this)}constructor(e,r){_defineProperty$1G(this,"wtTable",void 0),_defineProperty$1G(this,"wtScroll",void 0),_defineProperty$1G(this,"wtViewport",void 0),_defineProperty$1G(this,"wtOverlays",void 0),_defineProperty$1G(this,"selectionManager",void 0),_defineProperty$1G(this,"wtEvent",void 0),_defineProperty$1G(this,"guid",`wt_${randomString()}`),_defineProperty$1G(this,"drawInterrupted",!1),_defineProperty$1G(this,"drawn",!1),_defineProperty$1G(this,"activeOverlayName","master"),_defineProperty$1G(this,"domBindings",void 0),_defineProperty$1G(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Scroll(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;r<i;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,i){fastInnerText(i,e[r])}])}}createCellCoords(e,r){return new CellCoords(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,i){return new CellRange(e,r,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||hasZeroHeight(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<n&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=i-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,i){return this.wtScroll.scrollViewport(e,r,i)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function _defineProperty$1F(t,e,r){return(e=_toPropertyKey$1F(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1F(t){var e=_toPrimitive$1F(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1F(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Clone extends CoreAbstract{constructor(e,r,i){super(e,r),_defineProperty$1F(this,"cloneSource",void 0),_defineProperty$1F(this,"cloneOverlay",void 0);const n=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new Event$1(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function _defineProperty$1E(t,e,r){return(e=_toPropertyKey$1E(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1E(t){var e=_toPrimitive$1E(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1E(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Overlay{constructor(e,r,i,n,s){_defineProperty$1E(this,"wtSettings",null),defineGetter(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=r,this.wtSettings=n;const{TABLE:o,hider:a,spreader:l,holder:c,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=c,this.wtRootElement=u,this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=getScrollableElement(e.TABLE)}getRelativeCellPosition(e,r,i){if(this.clone.wtTable.holder.contains(e)===!1){warn(`The provided element is not a child of the ${this.type} overlay`);return}const n=this.mainTableScrollableElement===this.domBindings.rootWindow,s=i<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return n?d=this.getRelativeCellPositionWithinWindow(o,s,u,c):d=this.getRelativeCellPositionWithinHolder(o,a,s,u,c),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,i,n){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!r)o=n.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+getScrollbarWidth())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=n.top,{start:i.start+o,top:i.top+a}}getRelativeCellPositionWithinHolder(e,r,i,n,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(i||(a=o.horizontal-s.start),r){const c=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(l=o.vertical-s.top);return{start:n.start-a,top:n.top-l}}makeClone(){if(CLONE_TYPES.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,s=i.createElement("div"),o=i.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${CLONE_CLASS_NAMES.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,r.getSetting("ariaTags")&&setAttribute(s,[A11Y_PRESENTATION()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const c=this.wtSettings.getSetting("preventOverflow");return c===!0||c==="horizontal"&&this.type===CLONE_TOP||c==="vertical"&&this.type===CLONE_INLINE_START?this.mainTableScrollableElement=n:n.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=getScrollableElement(e.TABLE),new Clone(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,i=e.style,n=r.style,s=e.parentNode.style;[i,n,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class BottomInlineStartCornerOverlay extends Overlay{constructor(e,r,i,n,s,o){super(e,r,CLONE_BOTTOM_INLINE_START_CORNER,i,n),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new BottomInlineStartCornerOverlayTable(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${s}px`,r.style.bottom=`${o}px`}else resetCssTransform(r),this.repositionOverlay();let i=outerHeight(this.clone.wtTable.TABLE);const n=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),r.style.height=`${i}px`,r.style.width=`${n}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=getScrollbarWidth(i)),n.style.bottom=`${s}px`}}const MIXIN_NAME$4="calculatedColumns",calculatedColumns={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(calculatedColumns,"MIXIN_NAME",MIXIN_NAME$4,{writable:!1,enumerable:!1});class BottomOverlayTable extends Table{constructor(e,r,i,n){super(e,r,i,n,CLONE_BOTTOM)}}mixin(BottomOverlayTable,stickyRowsBottom);mixin(BottomOverlayTable,calculatedColumns);function _defineProperty$1D(t,e,r){return(e=_toPropertyKey$1D(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1D(t){var e=_toPrimitive$1D(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1D(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BottomOverlay extends Overlay{constructor(e,r,i,n){super(e,r,CLONE_BOTTOM,i,n),_defineProperty$1D(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new BottomOverlayTable(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let i=0;const n=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!n||n!=="vertical")?(i=this.getOverlayOffset(),r.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=getScrollbarWidth(i)),n.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,i=this.mainTableScrollableElement;let n=!1;if(i===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo(getWindowScrollLeft(r),top),n=s!==r.scrollY}else if(e!==i.scrollTop){const s=i.scrollTop;i.scrollTop=e,n=s!==i.scrollTop}return n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:i,wtSettings:n}=this.wot,s=n.getSetting("stylesHandler").getDefaultRowHeight();let o=e,a=0;for(;o<r;){const l=i.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="horizontal"){let c=r.getWorkspaceWidth();r.hasVerticalScroll()&&(c-=getScrollbarWidth(i)),c=Math.min(c,e.wtRootElement.scrollWidth),o.width=`${c}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=outerHeight(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let i=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;r&&s.offsetHeight!==s.clientHeight&&(o=getScrollbarWidth(this.domBindings.rootDocument)),r?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=o,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const n=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=n-s,a=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+n,0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==r,n=this.wtSettings.getSetting("columnHeaders");let s=!1;if((i||r===0)&&n.length>0){const o=this.wot.wtTable.holder.parentNode,a=hasClass$1(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(addClass$1(o,"innerBorderBottom"),s=!a):(removeClass$1(o,"innerBorderBottom"),s=a)}return s}}const MIXIN_NAME$3="calculatedRows",calculatedRows={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(calculatedRows,"MIXIN_NAME",MIXIN_NAME$3,{writable:!1,enumerable:!1});class InlineStartOverlayTable extends Table{constructor(e,r,i,n){super(e,r,i,n,CLONE_INLINE_START)}}mixin(InlineStartOverlayTable,calculatedRows);mixin(InlineStartOverlayTable,stickyColumnsStart);const MIXIN_NAME$2="localHooks",localHooks={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,i,n,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)fastCall(this._localHooks[t][l],this,e,r,i,n,s,o)}},clearLocalHooks(){return this._localHooks={},this}};defineGetter(localHooks,"MIXIN_NAME",MIXIN_NAME$2,{writable:!1,enumerable:!1});let Selection$1=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};mixin(Selection$1,localHooks);const ACTIVE_HEADER_TYPE="active-header",HEADER_TYPE="header",AREA_TYPE="area",FOCUS_TYPE="focus",FILL_TYPE="fill",ROW_TYPE="row",COLUMN_TYPE="column",CUSTOM_SELECTION_TYPE="custom-selection",getCornerStyle=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),n=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:i,borderStyle:"solid",borderColor:n})};var es_array_unscopables_flat={},hasRequiredEs_array_unscopables_flat;function requireEs_array_unscopables_flat(){if(hasRequiredEs_array_unscopables_flat)return es_array_unscopables_flat;hasRequiredEs_array_unscopables_flat=1;var t=requireAddToUnscopables();return t("flat"),es_array_unscopables_flat}requireEs_array_unscopables_flat();function _classPrivateMethodInitSpec$R(t,e){_checkPrivateRedeclaration$17(t,e),e.add(t)}function _classPrivateFieldInitSpec$P(t,e,r){_checkPrivateRedeclaration$17(t,e),e.set(t,r)}function _checkPrivateRedeclaration$17(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$P(t,e){return t.get(_assertClassBrand$17(t,e))}function _classPrivateFieldSet$L(t,e,r){return t.set(_assertClassBrand$17(t,e),r),r}function _assertClassBrand$17(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _selection=new WeakMap,_activeOverlaysWot$1=new WeakMap,_SelectionScanner_brand=new WeakSet;class SelectionScanner{constructor(){_classPrivateMethodInitSpec$R(this,_SelectionScanner_brand),_classPrivateFieldInitSpec$P(this,_selection,void 0),_classPrivateFieldInitSpec$P(this,_activeOverlaysWot$1,void 0)}setActiveOverlay(e){return _classPrivateFieldSet$L(_activeOverlaysWot$1,this,e),this}setActiveSelection(e){return _classPrivateFieldSet$L(_selection,this,e),this}scan(){const e=_classPrivateFieldGet$P(_selection,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanRowsInHeadersRange(i=>r.add(i))):e==="area"?this.scanCellsRange(i=>r.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanRowsInHeadersRange(i=>r.add(i)),this.scanCellsRange(i=>r.add(i))):e==="fill"?this.scanCellsRange(i=>r.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanRowsInHeadersRange(i=>r.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>r.add(i)),this.scanRowsInCellsRange(i=>r.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanColumnsInCellsRange(i=>r.add(i))),r}scanColumnsInHeadersRange(e){const[r,i,n,s]=_classPrivateFieldGet$P(_selection,this).getCorners(),{wtTable:o}=_classPrivateFieldGet$P(_activeOverlaysWot$1,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let c=0;for(let u=-o.getRowHeadersCount();u<a;u++){const d=o.columnFilter.renderedToSource(u);if(!(d<i||d>s)){for(let h=-l;h<0;h++){if(h<r||h>n)continue;const f=h+l;let g=o.getColumnHeader(d,f);const m=_classPrivateFieldGet$P(_activeOverlaysWot$1,this).getSetting("onBeforeHighlightingColumnHeader",d,f,{selectionType:_classPrivateFieldGet$P(_selection,this).settings.selectionType,columnCursor:c,selectionWidth:s-i+1});m!==null&&(m!==d&&(g=o.getColumnHeader(m,f)),e(g))}c+=1}}}scanRowsInHeadersRange(e){const[r,i,n,s]=_classPrivateFieldGet$P(_selection,this).getCorners(),{wtTable:o}=_classPrivateFieldGet$P(_activeOverlaysWot$1,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let c=0;for(let u=-o.getColumnHeadersCount();u<a;u++){const d=o.rowFilter.renderedToSource(u);if(!(d<r||d>n)){for(let h=-l;h<0;h++){if(h<i||h>s)continue;const f=h+l;let g=o.getRowHeader(d,f);const m=_classPrivateFieldGet$P(_activeOverlaysWot$1,this).getSetting("onBeforeHighlightingRowHeader",d,f,{selectionType:_classPrivateFieldGet$P(_selection,this).settings.selectionType,rowCursor:c,selectionHeight:n-r+1});m!==null&&(m!==d&&(g=o.getRowHeader(m,f)),e(g))}c+=1}}}scanCellsRange(e){const{wtTable:r}=_classPrivateFieldGet$P(_activeOverlaysWot$1,this);_assertClassBrand$17(_SelectionScanner_brand,this,_scanCellsRange).call(this,(i,n)=>{const s=r.getCell(_classPrivateFieldGet$P(_activeOverlaysWot$1,this).createCellCoords(i,n)),o=_classPrivateFieldGet$P(_activeOverlaysWot$1,this).getSetting("onAfterDrawSelection",i,n,_classPrivateFieldGet$P(_selection,this).settings.layerLevel);typeof o=="string"&&addClass$1(s,o),e(s)})}scanRowsInCellsRange(e){const[r,,i]=_classPrivateFieldGet$P(_selection,this).getCorners(),{wtTable:n}=_classPrivateFieldGet$P(_activeOverlaysWot$1,this);_assertClassBrand$17(_SelectionScanner_brand,this,_scanViewportRange).call(this,(s,o)=>{if(s>=r&&s<=i){const a=n.getCell(_classPrivateFieldGet$P(_activeOverlaysWot$1,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,r,,i]=_classPrivateFieldGet$P(_selection,this).getCorners(),{wtTable:n}=_classPrivateFieldGet$P(_activeOverlaysWot$1,this);_assertClassBrand$17(_SelectionScanner_brand,this,_scanViewportRange).call(this,(s,o)=>{if(o>=r&&o<=i){const a=n.getCell(_classPrivateFieldGet$P(_activeOverlaysWot$1,this).createCellCoords(s,o));e(a)}})}}function _scanCellsRange(t){let[e,r,i,n]=_classPrivateFieldGet$P(_selection,this).getCorners();if(e<0&&i<0||r<0&&n<0)return;const{wtTable:s}=_classPrivateFieldGet$P(_activeOverlaysWot$1,this),o=e!==i||r!==n;if(r=Math.max(r,0),n=Math.max(n,0),e=Math.max(e,0),i=Math.max(i,0),o){if(r=Math.max(r,s.getFirstRenderedColumn()),n=Math.min(n,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),i=Math.min(i,s.getLastRenderedRow()),n<r||i<e)return}else{const a=s.getCell(_classPrivateFieldGet$P(_activeOverlaysWot$1,this).createCellCoords(e,r));if(!isHTMLElement(a))return}for(let a=e;a<=i;a+=1)for(let l=r;l<=n;l+=1)t(a,l)}function _scanViewportRange(t){const{wtTable:e}=_classPrivateFieldGet$P(_activeOverlaysWot$1,this),r=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let n=0;n<r;n+=1){const s=e.rowFilter.renderedToSource(n);for(let o=0;o<i;o+=1)t(s,e.columnFilter.renderedToSource(o))}}class Border{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=getCornerStyle(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,i=this.main.childNodes.length;r<i;r++){const n=this.main.childNodes[r];this.eventManager.addEventListener(n,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),stopImmediatePropagation(e);const i=this,n=this.wot.rootDocument.body,s=r.getBoundingClientRect();r.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(i.eventManager.removeEventListener(n,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(n,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const i=["top","start","bottom","end","corner"];let n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(let a=0;a<5;a++){const l=i[a],c=r.createElement("div");c.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(c.className+=" hidden"),n=c.style,n.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,n.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,n.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=r.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,i=r.getSetting("stylesHandler"),n=i.getCSSVariableValue("cell-mobile-handle-size"),s=i.getCSSVariableValue("cell-mobile-handle-border-radius"),o=i.getCSSVariableValue("cell-mobile-handle-background-color"),a=i.getCSSVariableValue("cell-mobile-handle-border-width"),l=i.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const c=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const d={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};objectEach(d,(f,g)=>{this.selectionHandles.styles.bottomHitArea[g]=f,this.selectionHandles.styles.topHitArea[g]=f});const h=i.isClassicTheme()?{position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${s}px`,background:`${o}`,border:`${a}px solid ${l}`};objectEach(h,(f,g)=>{this.selectionHandles.styles.bottom[g]=f,this.selectionHandles.styles.top[g]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||r!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,i,n,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:u,bottom:d,bottomHitArea:h}=this.selectionHandles.styles,f=parseInt(c.borderWidth,10),g=parseInt(c.width,10),m=parseInt(u.width,10),C=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();c.top=`${parseInt(i-g-1,10)}px`,c[l]=`${parseInt(n-g-1,10)}px`,u.top=`${parseInt(i-m/4*3,10)}px`,u[l]=`${parseInt(n-m/4*3,10)}px`;const v=Math.min(parseInt(n+s,10),C-g-f*2),E=Math.min(parseInt(n+s-m/4,10),C-m-f*2);d[l]=`${v}px`,h[l]=`${E}px`;const $=Math.min(parseInt(i+o,10),y-g-f*2),O=Math.min(parseInt(i+o-m/4,10),y-m-f*2);d.top=`${$}px`,h.top=`${O}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",u.display="block",this.isPartRange(e,r)?(d.display="none",h.display="none"):(d.display="block",h.display="block")):(c.display="none",d.display="none",u.display="none",h.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",u.zIndex="9999"):(c.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;let[r,i,n,s]=e;if(r<0&&n<0||i<0&&s<0){this.disappear();return}const{wtTable:o,rootDocument:a,rootWindow:l}=this.wot,c=r!==n||i!==s,u=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),d=o.getFirstRenderedRow(),h=o.getLastRenderedRow(),f=o.getFirstRenderedColumn(),g=o.getLastRenderedColumn();if(f<0&&g<0||d<0&&h<0){this.disappear();return}let m;if(c){if(i=Math.max(i,f),s=Math.min(s,g),r=Math.max(r,d),n=Math.min(n,h),s<i||n<r){this.disappear();return}m=o.getCell(this.wot.createCellCoords(r,i))}else if(m=o.getCell(this.wot.createCellCoords(r,i)),!isHTMLElement(m)){this.disappear();return}const C=c?o.getCell(this.wot.createCellCoords(n,s)):m,y=offset(m),v=c?offset(C):y,E=offset(o.TABLE),$=y.top,O=y.left,P=this.wot.wtSettings.getSetting("rtlMode");let I=0,W=0;if(P){const ae=outerWidth(o.TABLE),pe=outerWidth(m),fe=l.innerWidth-E.left-ae;W=O+pe-v.left,I=l.innerWidth-O-pe-fe-1}else W=v.left+outerWidth(C)-O,I=O-E.left-1;if(this.isEntireColumnSelected(r,n)){const ae=r,pe=this.getDimensionsFromHeader("columns",i,s,ae,E);let fe=null;pe&&([fe,I,W]=pe),fe&&(m=fe)}let q=$-E.top-1,M=v.top+outerHeight(C)-$;if(this.isEntireRowSelected(i,s)){const ae=i,pe=this.getDimensionsFromHeader("rows",r,n,ae,E);let fe=null;pe&&([fe,q,M]=pe),fe&&(m=fe)}const Y=l.getComputedStyle(m);parseInt(Y.borderTopWidth,10)>0&&(q+=1,M=M>0?M-1:0),parseInt(Y[P?"borderRightWidth":"borderLeftWidth"],10)>0&&(I+=1,W=W>0?W-1:0);const z=P?"right":"left",Q=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${q}px`,this.topStyle[z]=`${I}px`,this.topStyle.width=`${W+Q}px`,this.topStyle.display="block",this.startStyle.top=`${q}px`,this.startStyle[z]=`${I}px`,this.startStyle.height=`${M+Q}px`,this.startStyle.display="block",this.bottomStyle.top=`${q+M-parseInt(this.bottomStyle.height,10)+Q}px`,this.bottomStyle[z]=`${I}px`,this.bottomStyle.width=`${W+Q}px`,this.bottomStyle.display="block",this.endStyle.top=`${q}px`,this.endStyle[z]=`${I+W-parseInt(this.endStyle.width,10)+Q}px`,this.endStyle.height=`${M+Q}px`,this.endStyle.display="block";let K=this.settings.border.cornerVisible;K=typeof K=="function"?K(this.settings.layerLevel):K;const Z=this.wot.getSetting("onModifyGetCellCoords",n,s,!1,"render");let[ue,oe]=[n,s];if(Z&&Array.isArray(Z)&&([,,ue,oe]=Z),isMobileBrowser()||!K||this.isPartRange(ue,oe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${q+M+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[z]=`${I+W+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ae=getTrimmingContainer(o.TABLE);const pe=ae===l;pe&&(ae=a.documentElement);const fe=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,ge=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),ye=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const p=pe?C.getBoundingClientRect().left:C.offsetLeft;let _=!1,w=0;if(P?(w=p-parseInt(this.cornerDefaultStyle.width,10)/2,_=w<0):(w=p+outerWidth(C)+parseInt(this.cornerDefaultStyle.width,10)/2,_=w>=innerWidth(ae)),_){const x=Math.floor(I+W+this.cornerCenterPointOffset-ge-fe);u?(this.cornerStyle[z]=`${x}px`,this.cornerStyle[P?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[z]=`${x-1}px`}}if(n===this.wot.getSetting("totalRows")-1&&(pe?C.getBoundingClientRect().top:C.offsetTop)+outerHeight(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=innerHeight(ae)){const x=Math.floor(q+M+this.cornerCenterPointOffset-ye-fe);u?(this.cornerStyle.top=`${x}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${x-1}px`}this.cornerStyle.display="block"}isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(n,s,q,I,W,M)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,i,n,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,c=null,u=null,d=null,h=null,f=null,g=null,m=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},c=function(){return outerHeight(...arguments)},u="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},c=function(){return outerWidth(...arguments)},u="ht__selection--columns",f="left";break}if(a.classList.contains(u)){const C=this.wot.getSetting("columnHeaders").length;if(g=l(r,C-n),m=l(i,C-n),!g||!m)return!1;const y=offset(g),v=offset(m);return g&&m&&(d=y[f]-s[f]-1,h=v[f]+c(m)-y[f]),[g,d,h]}return!1}changeBorderStyle(e,r){const i=this[e].style,n=r[e];!n||n.hide?addClass$1(this[e],"hidden"):(hasClass$1(this[e],"hidden")&&removeClass$1(this[e],"hidden"),i.backgroundColor=n.color,(e==="top"||e==="bottom")&&(i.height=`${n.width}px`),(e==="start"||e==="end")&&(i.width=`${n.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},i=this[e].style;i.backgroundColor=r.color,i.width=`${r.width}px`,i.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?addClass$1(this[e],"hidden"):removeClass$1(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function _classPrivateMethodInitSpec$Q(t,e){_checkPrivateRedeclaration$16(t,e),e.add(t)}function _classPrivateFieldInitSpec$O(t,e,r){_checkPrivateRedeclaration$16(t,e),e.set(t,r)}function _checkPrivateRedeclaration$16(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$O(t,e){return t.get(_assertClassBrand$16(t,e))}function _classPrivateFieldSet$K(t,e,r){return t.set(_assertClassBrand$16(t,e),r),r}function _assertClassBrand$16(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _activeOverlaysWot=new WeakMap,_selections=new WeakMap,_scanner=new WeakMap,_appliedClasses=new WeakMap,_destroyListeners=new WeakMap,_selectionBorders=new WeakMap,_SelectionManager_brand=new WeakSet;class SelectionManager{constructor(e){_classPrivateMethodInitSpec$Q(this,_SelectionManager_brand),_classPrivateFieldInitSpec$O(this,_activeOverlaysWot,void 0),_classPrivateFieldInitSpec$O(this,_selections,void 0),_classPrivateFieldInitSpec$O(this,_scanner,new SelectionScanner),_classPrivateFieldInitSpec$O(this,_appliedClasses,new WeakMap),_classPrivateFieldInitSpec$O(this,_destroyListeners,new WeakSet),_classPrivateFieldInitSpec$O(this,_selectionBorders,new Map),_classPrivateFieldSet$K(_selections,this,e)}setActiveOverlay(e){return _classPrivateFieldSet$K(_activeOverlaysWot,this,e),_classPrivateFieldGet$O(_scanner,this).setActiveOverlay(_classPrivateFieldGet$O(_activeOverlaysWot,this)),_classPrivateFieldGet$O(_appliedClasses,this).has(_classPrivateFieldGet$O(_activeOverlaysWot,this))||_classPrivateFieldGet$O(_appliedClasses,this).set(_classPrivateFieldGet$O(_activeOverlaysWot,this),new Set),this}getFocusSelection(){return _classPrivateFieldGet$O(_selections,this)!==null?_classPrivateFieldGet$O(_selections,this).getFocus():null}getAreaSelection(){return _classPrivateFieldGet$O(_selections,this)!==null?_classPrivateFieldGet$O(_selections,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(_classPrivateFieldGet$O(_selectionBorders,this).has(e)){const i=_classPrivateFieldGet$O(_selectionBorders,this).get(e);if(i.has(_classPrivateFieldGet$O(_activeOverlaysWot,this)))return i.get(_classPrivateFieldGet$O(_activeOverlaysWot,this));const n=new Border(_classPrivateFieldGet$O(_activeOverlaysWot,this),e.settings);return i.set(_classPrivateFieldGet$O(_activeOverlaysWot,this),n),n}const r=new Border(_classPrivateFieldGet$O(_activeOverlaysWot,this),e.settings);return _classPrivateFieldGet$O(_selectionBorders,this).set(e,new Map([[_classPrivateFieldGet$O(_activeOverlaysWot,this),r]])),r}getBorderInstances(e){var r,i;return Array.from((r=(i=_classPrivateFieldGet$O(_selectionBorders,this).get(e))===null||i===void 0?void 0:i.values())!==null&&r!==void 0?r:[])}destroyBorders(e){_classPrivateFieldGet$O(_selectionBorders,this).get(e).forEach(r=>r.destroy()),_classPrivateFieldGet$O(_selectionBorders,this).delete(e)}render(e){if(_classPrivateFieldGet$O(_selections,this)===null)return;e&&_assertClassBrand$16(_SelectionManager_brand,this,_resetCells).call(this);const r=Array.from(_classPrivateFieldGet$O(_selections,this)),i=new Map,n=new Map;for(let s=0;s<r.length;s++){const o=r[s],{className:a,headerAttributes:l,createLayers:c,selectionType:u}=o.settings;_classPrivateFieldGet$O(_destroyListeners,this).has(o)||(_classPrivateFieldGet$O(_destroyListeners,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const d=this.getBorderInstance(o);if(o.isEmpty()){d?.disappear();continue}a&&_classPrivateFieldGet$O(_scanner,this).setActiveSelection(o).scan().forEach(g=>{if(i.has(g)){const m=i.get(g);m.has(a)&&c===!0?m.set(a,m.get(a)+1):m.set(a,1)}else i.set(g,new Map([[a,1]]));l&&(n.has(g)||n.set(g,[]),g.nodeName==="TH"&&n.get(g).push(...l))});const h=o.getCorners();_classPrivateFieldGet$O(_activeOverlaysWot,this).getSetting("onBeforeDrawBorders",h,u),d?.appear(h)}i.forEach((s,o)=>{var a;const l=Array.from(s).map(c=>{let[u,d]=c;return d===1?u:[u,...Array.from({length:d-1},(h,f)=>`${u}-${f+1}`)]}).flat();l.forEach(c=>_classPrivateFieldGet$O(_appliedClasses,this).get(_classPrivateFieldGet$O(_activeOverlaysWot,this)).add(c)),addClass$1(o,l),o.nodeName==="TD"&&Array.isArray((a=_classPrivateFieldGet$O(_selections,this).options)===null||a===void 0?void 0:a.cellAttributes)&&setAttribute(o,_classPrivateFieldGet$O(_selections,this).options.cellAttributes)}),Array.from(n.keys()).forEach(s=>{setAttribute(s,[...n.get(s)])})}}function _resetCells(){const t=_classPrivateFieldGet$O(_appliedClasses,this).get(_classPrivateFieldGet$O(_activeOverlaysWot,this)),e=_classPrivateFieldGet$O(_activeOverlaysWot,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var i,n;const s=_classPrivateFieldGet$O(_activeOverlaysWot,this).wtTable.TABLE.querySelectorAll(`.${r}`);let o=[];Array.isArray((i=_classPrivateFieldGet$O(_selections,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(o=_classPrivateFieldGet$O(_selections,this).options.cellAttributes.map(a=>a[0])),Array.isArray((n=_classPrivateFieldGet$O(_selections,this).options)===null||n===void 0?void 0:n.headerAttributes)&&(o=[...o,..._classPrivateFieldGet$O(_selections,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)removeClass$1(s[a],r),removeAttribute(s[a],o)}),t.clear()}class InlineStartOverlay extends Overlay{constructor(e,r,i,n){super(e,r,CLONE_INLINE_START,i,n)}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new InlineStartOverlayTable(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===r&&(!n||n!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),setOverlayPosition(i,`${s}px`,"0px")):(s=this.getScrollPosition(),resetCssTransform(i));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let i=!1;this.isRtl()&&(e=-e);const n=this.mainTableScrollableElement;if(n===r&&e!==r.scrollX){const s=r.scrollX;r.scrollTo(e,getWindowScrollTop(r)),i=s!==r.scrollX}else if(e!==n.scrollLeft){const s=n.scrollLeft;n.scrollLeft=e,i=s!==n.scrollLeft}return i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const i=this.wtSettings.getSetting("defaultColumnWidth");let n=e,s=0;for(;n<r;)s+=this.wot.wtTable.getColumnWidth(n)||i,n+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="vertical"){let c=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(c-=getScrollbarWidth(i)),c=Math.min(c,e.wtRootElement.scrollHeight),o.height=`${c}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=outerWidth(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=getCornerStyle(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:i}=this,n=i.getSetting("rowHeaders"),s=i.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&n.length>0&&!hasClass$1(a.parentNode,"innerBorderInlineStart")?1:0;let c=this.getTableParentOffset(),u=0;if(r){const d=this.wot.wtTable.getColumnWidth(e),h=this.wot.wtViewport.getViewportWidth();d>h&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(u=getScrollbarWidth(this.domBindings.rootDocument)),r?(c+=this.sumCellSizes(0,e+1),c-=this.wot.wtViewport.getViewportWidth(),c+=l):c+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),c+=u,getMaximumScrollLeft(this.mainTableScrollableElement)===c-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(c)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(getScrollLeft(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const n=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=n-s;i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,n=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),o=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";o?removeClass$1(i,"emptyRows"):addClass$1(i,"emptyRows");let l=!1;if(!a){if(s&&!n.length)addClass$1(i,"innerBorderLeft innerBorderInlineStart");else if(!s&&n.length){const c=hasClass$1(i,"innerBorderInlineStart");e?(addClass$1(i,"innerBorderLeft innerBorderInlineStart"),l=!c):(removeClass$1(i,"innerBorderLeft innerBorderInlineStart"),l=c)}}return l}}const MIXIN_NAME$1="stickyRowsTop",stickyRowsTop={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(stickyRowsTop,"MIXIN_NAME",MIXIN_NAME$1,{writable:!1,enumerable:!1});class TopInlineStartCornerOverlayTable extends Table{constructor(e,r,i,n){super(e,r,i,n,CLONE_TOP_INLINE_START_CORNER)}}mixin(TopInlineStartCornerOverlayTable,stickyRowsTop);mixin(TopInlineStartCornerOverlayTable,stickyColumnsStart);function _defineProperty$1C(t,e,r){return(e=_toPropertyKey$1C(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1C(t){var e=_toPrimitive$1C(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1C(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TopInlineStartCornerOverlay extends Overlay{constructor(e,r,i,n,s,o){super(e,r,CLONE_TOP_INLINE_START_CORNER,i,n),_defineProperty$1C(this,"topOverlay",void 0),_defineProperty$1C(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new TopInlineStartCornerOverlayTable(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const n=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();setOverlayPosition(e,`${n}px`,`${s}px`)}else resetCssTransform(e);let r=outerHeight(this.clone.wtTable.TABLE);const i=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${i}px`,!1}}class TopOverlayTable extends Table{constructor(e,r,i,n){super(e,r,i,n,CLONE_TOP)}}mixin(TopOverlayTable,stickyRowsTop);mixin(TopOverlayTable,calculatedColumns);function _defineProperty$1B(t,e,r){return(e=_toPropertyKey$1B(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1B(t){var e=_toPrimitive$1B(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1B(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TopOverlay extends Overlay{constructor(e,r,i,n){super(e,r,CLONE_TOP,i,n),_defineProperty$1B(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new TopOverlayTable(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let n=0,s=!1;if(this.trimmingContainer===r&&(!i||i!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),c=Math.ceil(l.bottom),u=e.offsetHeight;s=c===u,n=this.getOverlayOffset(),setOverlayPosition(e,"0px",`${n}px`)}else n=this.getScrollPosition(),resetCssTransform(e);const o=this.adjustHeaderBordersPosition(n,s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings,i=this.mainTableScrollableElement;let n=!1;if(i===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo(getWindowScrollLeft(r),e),n=s!==r.scrollY}else if(e!==i.scrollTop){const s=i.scrollTop;i.scrollTop=e,n=s!==i.scrollTop}return n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let n=e,s=0;for(;n<r;){const o=this.wot.wtTable.getRowHeight(n);s+=o===void 0?i:o,n+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="horizontal"){let c=r.getWorkspaceWidth();r.hasVerticalScroll()&&(c-=getScrollbarWidth(i)),c=Math.min(c,e.wtRootElement.scrollWidth),o.width=`${c}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=outerHeight(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=getCornerStyle(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:i,wtSettings:n}=this,o=(i.cloneSource?i.cloneSource:i).wtTable.holder,a=n.getSetting("columnHeaders"),c=n.getSetting("fixedRowsTop")===0&&a.length>0&&!hasClass$1(o.parentNode,"innerBorderTop")?1:0;let u=this.getTableParentOffset(),d=0;if(r){const h=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();h>f&&(r=!1)}if(r&&o.offsetHeight!==o.clientHeight&&(d=getScrollbarWidth(this.domBindings.rootDocument)),r){const h=n.getSetting("fixedRowsBottom"),f=n.getSetting("totalRows");u+=this.sumCellSizes(0,e+1),u-=i.wtViewport.getViewportHeight()-this.sumCellSizes(f-h,f),u+=1,u+=c}else u+=this.sumCellSizes(n.getSetting("fixedRowsTop"),e);return u+=d,getMaximumScrollTop(this.mainTableScrollableElement)===u-c&&c>0&&this.wot.wtOverlays.expandHiderVerticallyBy(c),this.setScrollPosition(u)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const n=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=n-s;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,n=this.wot.wtTable.holder.parentNode,s=i.getSetting("totalColumns"),o=i.getSetting("preventOverflow")==="horizontal";s?removeClass$1(n,"emptyColumns"):addClass$1(n,"emptyColumns");let a=!1;if(!r&&!o){const l=i.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==l,u=i.getSetting("columnHeaders");if((c||l===0)&&u.length>0){const d=hasClass$1(n,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(addClass$1(n,"innerBorderTop"),a=!d):(removeClass$1(n,"innerBorderTop"),a=d)}}return a}}function _classPrivateFieldInitSpec$N(t,e,r){_checkPrivateRedeclaration$15(t,e),e.set(t,r)}function _checkPrivateRedeclaration$15(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1A(t,e,r){return(e=_toPropertyKey$1A(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1A(t){var e=_toPrimitive$1A(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1A(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldSet$J(t,e,r){return t.set(_assertClassBrand$15(t,e),r),r}function _classPrivateFieldGet$N(t,e){return t.get(_assertClassBrand$15(t,e))}function _assertClassBrand$15(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _overlays=new WeakMap,_hasRenderingStateChanged=new WeakMap,_containerDomResizeCount=new WeakMap,_containerDomResizeCountTimeout=new WeakMap;class Overlays{constructor(e,r,i,n,s,o){_defineProperty$1A(this,"wot",null),_classPrivateFieldInitSpec$N(this,_overlays,[]),_defineProperty$1A(this,"topOverlay",null),_defineProperty$1A(this,"bottomOverlay",null),_defineProperty$1A(this,"inlineStartOverlay",null),_defineProperty$1A(this,"topInlineStartCornerOverlay",null),_defineProperty$1A(this,"bottomInlineStartCornerOverlay",null),_defineProperty$1A(this,"browserLineHeight",void 0),_defineProperty$1A(this,"wtSettings",null),_classPrivateFieldInitSpec$N(this,_hasRenderingStateChanged,!1),_classPrivateFieldInitSpec$N(this,_containerDomResizeCount,0),_classPrivateFieldInitSpec$N(this,_containerDomResizeCountTimeout,null),_defineProperty$1A(this,"resizeObserver",new ResizeObserver(u=>{requestAnimationFrame$1(()=>{!Array.isArray(u)||!u.length||(_classPrivateFieldSet$J(_containerDomResizeCount,this,_classPrivateFieldGet$N(_containerDomResizeCount,this)+1),_classPrivateFieldGet$N(_containerDomResizeCount,this)===100&&(warn("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),_classPrivateFieldGet$N(_containerDomResizeCountTimeout,this)!==null&&clearTimeout(_classPrivateFieldGet$N(_containerDomResizeCountTimeout,this)),_classPrivateFieldSet$J(_containerDomResizeCountTimeout,this,setTimeout(()=>{_classPrivateFieldSet$J(_containerDomResizeCount,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=n,this.domBindings=i,this.facadeGetter=r,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=getScrollbarWidth(a);const c=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?o.holder:getScrollableElement(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[..._classPrivateFieldGet$N(_overlays,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,i=e.getComputedStyle(r.body),n=parseInt(i.lineHeight,10),s=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=n||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new TopOverlay(...e),this.bottomOverlay=new BottomOverlay(...e),this.inlineStartOverlay=new InlineStartOverlay(...e),this.topInlineStartCornerOverlay=new TopInlineStartCornerOverlay(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BottomInlineStartCornerOverlay(...e,this.bottomOverlay,this.inlineStartOverlay),_classPrivateFieldSet$J(_overlays,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){_classPrivateFieldSet$J(_hasRenderingStateChanged,this,_classPrivateFieldGet$N(_overlays,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),_classPrivateFieldGet$N(_overlays,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),_classPrivateFieldGet$N(_overlays,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0}),i!==n&&this.eventManager.addEventListener(n,"scroll",d=>this.onTableScroll(d),{passive:!0});const s=r.devicePixelRatio&&r.devicePixelRatio>1,o=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!isChrome())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{this.eventManager.addEventListener(d.clone.wtTable.holder,"wheel",h=>this.onCloneWheel(h,a),l)});let u;this.eventManager.addEventListener(r,"resize",()=>{requestAnimationFrame$1(()=>{clearTimeout(u),this.wtSettings.getSetting("onWindowResize"),u=setTimeout(()=>{_classPrivateFieldSet$J(_containerDomResizeCount,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(n!==r&&s!==r&&!e.target.contains(n)||i!==r&&s!==r&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:i}=this.domBindings,n=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==i&&o!==i&&!o.contains(s),l=n!==i&&o!==i&&!o.contains(n);if(this.keyPressed&&(a||l)||this.scrollableElement===i)return;const c=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==i&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=isKey(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,r+=r*this.browserLineHeight);const n=this.scrollVertically(r),s=this.scrollHorizontally(i);return n||s}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let i=this.scrollableElement.scrollLeft,n=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(i=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(n=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==i,this.verticalScrolling=this.lastScrollY!==n,this.lastScrollX=i,this.lastScrollY=n,this.horizontalScrolling){e.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=n),this.refreshAll()}syncScrollWithMaster(){if(!_classPrivateFieldGet$N(_hasRenderingStateChanged,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),_classPrivateFieldSet$J(_hasRenderingStateChanged,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=getScrollableElement(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,i=e.clientHeight,n=r!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=i),n}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:i}=this.domBindings,n=this.scrollableElement===i,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),c=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,u=a+this.inlineStartOverlay.sumCellSizes(0,s),h=r.hider.style,f=()=>n?!1:this.scrollableElement.scrollTop>Math.max(0,c-r.holder.clientHeight),g=()=>n?!1:this.scrollableElement.scrollLeft>Math.max(0,u-r.holder.clientWidth),m=f()?1:0,C=g()?1:0;h.width=`${u+C}px`,h.height=`${c+m}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return arrayEach(r,n=>{n&&n.clone&&n.clone.wtTable.TABLE.contains(e)&&(i=n.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];arrayEach(r,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function _defineProperty$1z(t,e,r){return(e=_toPropertyKey$1z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1z(t){var e=_toPrimitive$1z(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1z(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Settings{constructor(e){_defineProperty$1z(this,"settings",{}),_defineProperty$1z(this,"defaults",Object.freeze(this.getDefaults())),objectEach(this.defaults,(r,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(r===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,i)=>{const n=this.getSetting("data",e,r);fastInnerText(i,n??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?objectEach(e,(i,n)=>{this.settings[n]=i}):this.settings[e]=r,this}getSetting(e,r,i,n,s){return typeof this.settings[e]=="function"?this.settings[e](r,i,n,s):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class MasterTable extends Table{constructor(e,r,i,n){super(e,r,i,n,"master")}alignOverlaysWithTrimmingContainer(){const e=getTrimmingContainer(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,n=getStyle(e,"height",r),s=getStyle(e,"overflow",r),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let c=e.offsetWidth,u=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(s)){const h=e.cloneNode(!1);h.style.overflow="auto",h.style.position="absolute",e.nextElementSibling?i.insertBefore(h,e.nextElementSibling):i.appendChild(h);const f=parseInt(r.getComputedStyle(h).height,10);i.removeChild(h),f===0&&(u=0)}u=Math.min(u,l),o.height=n==="auto"?"auto":`${u}px`,c=Math.min(c,a),o.width=`${c}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:u>0,this.hasTableWidth=c>0}this.isTableVisible=isVisible(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,i="master",s=e.getSetting("columnHeaders").length;if(s&&!r.hasOversizedColumnHeadersMarked[i]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let c=0;c<s;c++)for(let u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);r.hasOversizedColumnHeadersMarked[i]=!0}}}mixin(MasterTable,calculatedRows);mixin(MasterTable,calculatedColumns);class Viewport{constructor(e,r,i,n,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=i,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new RenderedAllRowsCalculationType:new RenderedRowsCalculationType],["fullyVisible",()=>new FullyVisibleRowsCalculationType],["partiallyVisible",()=>new PartiallyVisibleRowsCalculationType]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new RenderedAllColumnsCalculationType:new RenderedColumnsCalculationType],["fullyVisible",()=>new FullyVisibleColumnsCalculationType],["partiallyVisible",()=>new PartiallyVisibleColumnsCalculationType]]),this.eventManager=n,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return r===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=outerHeight(r)>0&&r.clientHeight>0?r.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let n;if(i===r){const s=this.wtSettings.getSetting("totalColumns");n=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>n&&(n=e.documentElement.clientWidth)}else n=i.clientWidth;return n}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollHeight>s.clientHeight}const{holder:e,hider:r}=this.wtTable,i=e.clientHeight,n=r.offsetHeight;return i<n?!0:n>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollWidth>s.clientWidth}const{holder:e,hider:r}=this.wtTable,i=e.clientWidth,n=r.offsetWidth;return i<n?!0:n>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let i=0,n=e;for(;n<r;)i+=this.wtTable.getColumnWidth(n),n+=1;return i}getWorkspaceOffset(){return offset(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=outerHeight(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,n=r.length;i<n;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,s=r.length;n<s;n++)i?(this.rowHeaderWidth+=outerWidth(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:i}=this;let n=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),c=r.getSetting("fixedRowsBottom"),u=r.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,n-=o),c&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(u-c,u),n-=o),i.holder.clientHeight===i.holder.offsetHeight?s=0:s=getScrollbarWidth(this.domBindings.rootDocument),new ViewportRowsCalculator({calculationTypes:e.map(d=>[d,this.rowsCalculatorTypes.get(d)()]),viewportHeight:n,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:d=>i.getRowHeight(d),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:i}=this;let n=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=r.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,n-=a}return i.holder.clientWidth!==i.holder.offsetWidth&&(n-=getScrollbarWidth(this.domBindings.rootDocument)),new ViewportColumnsCalculator({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:n,scrollOffset:s,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>i.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,i=this.createRowsCalculator(),n=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!r.getSetting("renderAllColumns")){const s=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=n.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:i}=e;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:n,endRow:s,rowStartOffset:o,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,c=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(c)&&c>0?(r=Math.max(0,r-Math.min(o,c)),i=Math.min(l,i+Math.min(a,c))):c==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),i=Math.min(l,i+Math.ceil(a/2))),r<n||r===n&&r>0?!1:!(i>s||i===s&&i<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:i}=e;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:n,endColumn:s,columnStartOffset:o,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,c=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(c)&&c>0?(r=Math.max(0,r-Math.min(o,c)),i=Math.min(l,i+Math.min(a,c))):c==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),i=Math.min(l,i+Math.ceil(a/2))),r<n||r===n&&r>0?!1:!(i>s||i===s&&i<l)}resetHasOversizedColumnHeadersMarked(){objectEach(this.hasOversizedColumnHeadersMarked,(e,r,i)=>{i[r]=void 0})}}class Walkontable extends CoreAbstract{constructor(e,r){super(e,new Settings(r));const i=this.wtSettings.getSetting("facade",this);this.wtTable=new MasterTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new Viewport(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new SelectionManager(this.wtSettings.getSetting("selections")),this.wtEvent=new Event$1(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Overlays(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],i=[];objectEach(e,(n,s)=>{this.wtSettings.getSetting(s).length&&i.push(n),r.push(n)}),removeClass$1(this.wtTable.wtRootElement.parentNode,r),addClass$1(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var r;if(!CLONE_TYPES.includes(e))return null;const i=e.replace(/_([a-z])/g,n=>n[1].toUpperCase());return(r=this.wtOverlays[`${i}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class WalkontableFacade{constructor(e){e instanceof CoreAbstract?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const i=new WalkontableFacade(r);return()=>i},this._wot=new Walkontable(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,i){return this._wot.createCellRange(e,r,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,i){return this._wot.scrollViewport(e,r,i)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,i,n,s){return this._wot.wtSettings.getSetting(e,r,i,n,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function mouseDown(t){let{isShiftKey:e,isLeftClick:r,isRightClick:i,coords:n,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,c=s.isSelectedByCorner(),u=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)n.row>=0&&n.col>=0&&!o.cell?s.setRangeEnd(n):(c||u)&&n.row>=0&&n.col>=0&&!o.cell?s.setRangeEnd(a(n.row,n.col)):c&&n.row<0&&!o.column?s.setRangeEnd(a(l.to.row,n.col)):u&&n.col<0&&!o.row?s.setRangeEnd(a(n.row,l.to.col)):(!c&&!u&&n.col<0||c&&n.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),n.row,n.col):(!c&&!u&&n.row<0||u&&n.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),n.col,n.row);else{const d=!s.inInSelection(n),h=r||i&&d;n.row<0&&n.col>=0&&!o.column?h&&s.selectColumns(n.col,n.col,n.row):n.col<0&&n.row>=0&&!o.row?h&&s.selectRows(n.row,n.row,n.col):n.col>=0&&n.row>=0&&!o.cell?h&&s.setRangeStart(n):n.col<0&&n.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function mouseOver(t){let{isLeftClick:e,coords:r,selection:i,controller:n,cellCoordsFactory:s}=t;if(!e)return;const o=i.isSelectedByRowHeader(),a=i.isSelectedByColumnHeader(),l=i.tableProps.countCols(),c=i.tableProps.countRows();i.markSource("mouse"),a&&!n.column?i.setRangeEnd(s(c-1,r.col)):o&&!n.row?i.setRangeEnd(s(r.row,l-1)):n.cell||i.setRangeEnd(r),i.markEndSource()}function mouseUp(t){let{isLeftClick:e,selection:r,cellRangeMapper:i}=t;if(!e||r.settings.selectionMode!=="multiple")return;const n=r.getSelectedRange(),s=n.clone().map(a=>i.toRenderable(a)),o=s.current();if(s.size()>1&&!o.isHeader()&&!r.isMultiple(o)){const a=s.findAll(o);a.length===s.size()?(n.pop(),r.refresh()):a.length>1&&(n.removeLayers(a.map(l=>{let{layer:c}=l;return c})),r.refresh())}}const handlers=new Map([["touchstart",mouseDown],["touchend",mouseUp],["mousedown",mouseDown],["mouseover",mouseOver],["mouseup",mouseUp]]);function handleMouseEvent(t,e){handlers.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:isLeftClick(t)||t.type==="touchstart",isRightClick:isRightClick(t),...e})}const holder=new WeakMap,rootInstanceSymbol=Symbol("rootInstance");function registerAsRootInstance(t){holder.set(t,!0)}function hasValidParameter(t){return t===rootInstanceSymbol}function isRootInstance(t){return holder.has(t)}function _classPrivateMethodInitSpec$P(t,e){_checkPrivateRedeclaration$14(t,e),e.add(t)}function _classPrivateFieldInitSpec$M(t,e,r){_checkPrivateRedeclaration$14(t,e),e.set(t,r)}function _checkPrivateRedeclaration$14(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1y(t,e,r){return(e=_toPropertyKey$1y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1y(t){var e=_toPrimitive$1y(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1y(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$M(t,e){return t.get(_assertClassBrand$14(t,e))}function _classPrivateFieldSet$I(t,e,r){return t.set(_assertClassBrand$14(t,e),r),r}function _assertClassBrand$14(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _columnHeadersCount=new WeakMap,_rowHeadersCount=new WeakMap,_selectionMouseDown=new WeakMap,_mouseDown=new WeakMap,_table=new WeakMap,_lastWidth=new WeakMap,_lastHeight=new WeakMap,_mouseDownLastPos=new WeakMap,_TableView_brand=new WeakSet;class TableView{constructor(e){_classPrivateMethodInitSpec$P(this,_TableView_brand),_defineProperty$1y(this,"hot",void 0),_defineProperty$1y(this,"eventManager",void 0),_defineProperty$1y(this,"settings",void 0),_defineProperty$1y(this,"THEAD",void 0),_defineProperty$1y(this,"TBODY",void 0),_defineProperty$1y(this,"_wt",void 0),_defineProperty$1y(this,"activeWt",void 0),_classPrivateFieldInitSpec$M(this,_columnHeadersCount,0),_classPrivateFieldInitSpec$M(this,_rowHeadersCount,0),_defineProperty$1y(this,"postponedAdjustElementsSize",!1),_classPrivateFieldInitSpec$M(this,_selectionMouseDown,!1),_classPrivateFieldInitSpec$M(this,_mouseDown,void 0),_classPrivateFieldInitSpec$M(this,_table,void 0),_classPrivateFieldInitSpec$M(this,_lastWidth,0),_classPrivateFieldInitSpec$M(this,_lastHeight,0),_classPrivateFieldInitSpec$M(this,_mouseDownLastPos,null),this.hot=e,this.eventManager=new EventManager(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),_assertClassBrand$14(_TableView_brand,this,_updateScrollbarClassNames).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const i=this._wt.getCell(e,r);return i<0?null:i}scrollViewport(e,r,i){return this._wt.scrollViewport(e,r,i)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),addClass$1(e,"handsontable"),_classPrivateFieldSet$I(_table,this,r.createElement("TABLE")),addClass$1(_classPrivateFieldGet$M(_table,this),"htCore"),this.hot.getSettings().tableClassName&&addClass$1(_classPrivateFieldGet$M(_table,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(setAttribute(_classPrivateFieldGet$M(_table,this),[A11Y_PRESENTATION()]),setAttribute(e,[A11Y_TREEGRID(),A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(this.hot.countCols()),A11Y_MULTISELECTABLE()])),this.THEAD=r.createElement("THEAD"),_classPrivateFieldGet$M(_table,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),_classPrivateFieldGet$M(_table,this).appendChild(this.TBODY),this.hot.table=_classPrivateFieldGet$M(_table,this),this.hot.container.insertBefore(_classPrivateFieldGet$M(_table,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:i,rootWindow:n}=this.hot,s=r.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{_classPrivateFieldSet$I(_selectionMouseDown,this,!0),this.isTextSelectionAllowed(a.target)||(clearTextSelection(n),a.preventDefault(),n.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{_classPrivateFieldSet$I(_selectionMouseDown,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{_classPrivateFieldGet$M(_selectionMouseDown,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&clearTextSelection(n),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{i.isInProgress()&&!a.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{i.isInProgress()&&isLeftClick(a)&&i.finish(),_classPrivateFieldSet$I(_mouseDown,this,!1);const l=isOutsideInput(r.activeElement);isInput(r.activeElement)&&!l||(l||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(a.target)&&!isRightClick(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{i.isInProgress()&&isRightClick(a)&&(i.finish(),_classPrivateFieldSet$I(_mouseDown,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),_classPrivateFieldSet$I(_mouseDown,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,c=a.x||a.clientX,u=a.y||a.clientY;let d=a.target;if(_classPrivateFieldGet$M(_mouseDown,this)||!e||!this.hot.view)return;const{holder:h}=this._wt.wtTable;if(d===h){const g=getScrollbarWidth(r);if(r.elementFromPoint(c+g,u)!==h||r.elementFromPoint(c,u+g)!==h)return}else for(;d!==s;){if(d===null){if(a.isTargetWebComponent)break;return}if(d===e)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=getParentWindow(n);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=getParentWindow(o);this.eventManager.addEventListener(_classPrivateFieldGet$M(_table,this),"selectstart",a=>{this.settings.fragmentSelection||isInput(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,i))}translateFromRenderableToVisualIndex(e,r){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,n=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return i===null&&(i=e),n===null&&(n=r),[i,n]}countRenderableIndexes(e,r){const i=Math.min(e.getNotTrimmedIndexesLength(),r),n=e.getNearestNotHiddenIndex(i-1,-1);return n===null?0:e.getRenderableFromVisualIndex(n)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,i,n){if(isNaN(e)||e<0)return 0;const s=i.getNearestNotHiddenIndex(e,r),o=i.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return r<0?a=o+1:r>0&&(a=n-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let i=0;for(let n=e;n<=r;n++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(n)!==null&&(i+=1);return i}countRenderableRowsInRange(e,r){let i=0;for(let n=e;n<=r;n++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(n)!==null&&(i+=1);return i}addClassNameToLicenseElement(e){var r;const i=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");i&&addClass$1(i,e)}removeClassNameFromLicenseElement(e){var r;const i=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");i&&removeClass$1(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:_classPrivateFieldGet$M(_table,this),isDataViewInstance:()=>isRootInstance(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),_classPrivateFieldSet$I(_rowHeadersCount,this,s.length),this.hot.getSettings().ariaTags&&_assertClassBrand$14(_TableView_brand,this,_getAriaColcount).call(this)===this.hot.countCols()&&_assertClassBrand$14(_TableView_brand,this,_updateAriaColcount).call(this,_classPrivateFieldGet$M(_rowHeadersCount,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),_classPrivateFieldSet$I(_columnHeadersCount,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,c]=this.translateFromRenderableToVisualIndex(s,o),u=this.hot.runHooks("modifyGetCellCoords",l,c,!1,"meta");let d=l,h=c;Array.isArray(u)&&([d,h]=u);const f=this.hot.getCellMeta(d,h),g=this.hot.colToProp(h);let m=this.hot.getDataAtRowProp(d,g);this.hot.hasHook("beforeValueRender")&&(m=this.hot.runHooks("beforeValueRender",m,f)),this.hot.runHooks("beforeRenderer",a,l,c,g,m,f),this.hot.getCellRenderer(f)(this.hot,a,l,c,g,m,f),this.hot.runHooks("afterRenderer",a,l,c,g,m,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&isVisible(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o),u={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,_classPrivateFieldSet$I(_mouseDown,this,!0),_classPrivateFieldSet$I(_mouseDownLastPos,this,{x:s.clientX,y:s.clientY}),this.hot.runHooks("beforeOnCellMouseDown",s,c,a,u),!isImmediatePropagationStopped(s)&&(handleMouseEvent(s,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(d,h)=>this.hot._createCellCoords(d,h)}),this.hot.runHooks("afterOnCellMouseDown",s,c,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,_classPrivateFieldSet$I(_mouseDown,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,c,a),!isImmediatePropagationStopped(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,c,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,c,a),!isImmediatePropagationStopped(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,c,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o),u={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,c,a,u),!isImmediatePropagationStopped(s)&&(_classPrivateFieldGet$M(_mouseDown,this)&&(!_classPrivateFieldGet$M(_mouseDownLastPos,this)||_classPrivateFieldGet$M(_mouseDownLastPos,this).x!==s.clientX||_classPrivateFieldGet$M(_mouseDownLastPos,this).y!==s.clientY)&&handleMouseEvent(s,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(d,h)=>this.hot._createCellCoords(d,h)}),this.hot.runHooks("afterOnCellMouseOver",s,c,a),this.activeWt=this._wt,_classPrivateFieldSet$I(_mouseDownLastPos,this,null))},onCellMouseUp:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,c,a),!(isImmediatePropagationStopped(s)||this.hot.isDestroyed)&&(handleMouseEvent(s,{coords:c,selection:this.hot.selection,cellRangeMapper:resolveWithInstance(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",s,c,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,o)=>{const a=this.hot.rowIndexMapper,l=s<0;let c=s;return!l&&(c=a.getVisualFromRenderableIndex(s),c===null)?s:(c=this.hot.runHooks("beforeViewportScrollVertically",c,o),this.hot.runHooks("beforeViewportScroll"),l?c:a.getRenderableFromVisualIndex(c))},onBeforeViewportScrollHorizontally:(s,o)=>{const a=this.hot.columnIndexMapper,l=s<0;let c=s;return!l&&(c=a.getVisualFromRenderableIndex(s),c===null)?s:(c=this.hot.runHooks("beforeViewportScrollHorizontally",c,o),this.hot.runHooks("beforeViewportScroll"),l?c:a.getRenderableFromVisualIndex(c))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,c=s<0;let u=s;c||(u=l.getVisualFromRenderableIndex(s));const d=this.hot.runHooks("beforeHighlightingRowHeader",u,o,a);return c?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,c=s<0;let u=s;c||(u=l.getVisualFromRenderableIndex(s));const d=this.hot.runHooks("beforeHighlightingColumnHeader",u,o,a);return c?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[c,u]=this.translateFromRenderableToVisualIndex(s,o),d=this.hot.selection.getSelectedRange();if(d.size()>0){const f=d.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",c,u,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,c,u]=s,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u)];return this.hot.runHooks("beforeDrawBorders",d,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a,l)=>{const c=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,d=o>=0?u.getVisualFromRenderableIndex(o):o,h=s>=0?c.getVisualFromRenderableIndex(s):s,f=this.hot.runHooks("modifyGetCellCoords",h,d,a,l);if(Array.isArray(f)){const[g,m,C,y]=f;return[g>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(g,1)):g,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,C>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(C,-1)):C,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y]}},onModifyGetCoordsElement:(s,o)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,c=o>=0?l.getVisualFromRenderableIndex(o):o,u=s>=0?a.getVisualFromRenderableIndex(s):s,d=this.hot.runHooks("modifyGetCoordsElement",u,c);if(Array.isArray(d)){const[h,f]=d;return[h>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(h,1)):h,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,c=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(c+o,a-1);else if(o==="auto"){const u=Math.max(1,Math.ceil(c/a*12));s.startRow=Math.max(l-u,0),s.endRow=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,c=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(c+o,a-1)),o==="auto"){const u=Math.max(1,Math.ceil(c/a*6));s.startColumn=Math.max(l-u,0),s.endColumn=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new WalkontableFacade(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:i,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,n),this.eventManager.addEventListener(r,"mousedown",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(isInput(e))return!0;const r=isChildOf(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return _classPrivateFieldGet$M(_mouseDown,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const i=r.firstChild;if(!hasClass$1(i,"relative")){empty(r),this.appendRowHeader(e,r);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:n}=this.hot,s=i.createElement("div"),o=i.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,n),s.appendChild(o),r.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(r.firstChild){const o=r.firstChild;hasClass$1(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,i,n),o.className="",addClass$1(o,["relative",...s()])):(empty(r),this.appendColHeader(e,r,i,n))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),c=s();a.classList.add("relative",...c),l.className="colHeader",this.settings.ariaTags&&(setAttribute(a,...A11Y_PRESENTATION()),setAttribute(l,...A11Y_PRESENTATION())),this.updateCellHeader(l,e,i,n),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,n)}updateCellHeader(e,r,i){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=r;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(hasClass$1(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(r):hasClass$1(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(r))),s>-1?fastInnerHTML(e,i(r,n)):(fastInnerText(e," "),addClass$1(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,r){_classPrivateFieldSet$I(_lastWidth,this,e),_classPrivateFieldSet$I(_lastHeight,this,r)}getLastSize(){return{width:_classPrivateFieldGet$M(_lastWidth,this),height:_classPrivateFieldGet$M(_lastHeight,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return _classPrivateFieldGet$M(_columnHeadersCount,this)}getRowHeadersCount(){return _classPrivateFieldGet$M(_rowHeadersCount,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function _getAriaColcount(){return parseInt(this.hot.rootElement.getAttribute(A11Y_COLCOUNT()[0]),10)}function _updateAriaColcount(t){const e=_assertClassBrand$14(_TableView_brand,this,_getAriaColcount).call(this)+t;setAttribute(this.hot.rootElement,...A11Y_COLCOUNT(e))}function _updateScrollbarClassNames(){const t=this.hot.rootElement;this.hasVerticalScroll()?addClass$1(t,"htHasScrollY"):removeClass$1(t,"htHasScrollY"),this.hasHorizontalScroll()?addClass$1(t,"htHasScrollX"):removeClass$1(t,"htHasScrollX")}var esnext_iterator_every={},es_iterator_every={},hasRequiredEs_iterator_every;function requireEs_iterator_every(){if(hasRequiredEs_iterator_every)return es_iterator_every;hasRequiredEs_iterator_every=1;var t=require_export(),e=requireFunctionCall(),r=requireIterate(),i=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect(),o=requireIteratorClose(),a=requireIteratorHelperWithoutClosingOnEarlyError(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(u){n(this);try{i(u)}catch(f){o(this,"throw",f)}if(l)return e(l,this,u);var d=s(this),h=0;return!r(d,function(f,g){if(!u(f,h++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_every}var hasRequiredEsnext_iterator_every;function requireEsnext_iterator_every(){return hasRequiredEsnext_iterator_every||(hasRequiredEsnext_iterator_every=1,requireEs_iterator_every()),esnext_iterator_every}requireEsnext_iterator_every();const COLUMN_LABEL_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZ",COLUMN_LABEL_BASE_LENGTH=COLUMN_LABEL_BASE.length;function spreadsheetColumnLabel(t){let e=t+1,r="",i;for(;e>0;)i=(e-1)%COLUMN_LABEL_BASE_LENGTH,r=String.fromCharCode(65+i)+r,e=parseInt((e-i)/COLUMN_LABEL_BASE_LENGTH,10);return r}function spreadsheetColumnIndex(t){let e=0;if(t)for(let r=0,i=t.length-1;r<t.length;r+=1,i-=1)e+=COLUMN_LABEL_BASE_LENGTH**i*(COLUMN_LABEL_BASE.indexOf(t[r])+1);return e-=1,e}function createSpreadsheetData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let i,n;for(i=0;i<t;i++){const s=[];for(n=0;n<e;n++)s.push(spreadsheetColumnLabel(n)+(i+1));r.push(s)}return r}function createSpreadsheetObjectData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let i,n;for(i=0;i<t;i++){const s={};for(n=0;n<e;n++)s[`prop${n}`]=spreadsheetColumnLabel(n)+(i+1);r.push(s)}return r}function createEmptySpreadsheetData(t,e){const r=[];let i;for(let n=0;n<t;n++){i=[];for(let s=0;s<e;s++)i.push("");r.push(i)}return r}function dataRowToChangesArray(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((n,s)=>{Array.isArray(n)?n.forEach((o,a)=>{i.push([s+e,a,o])}):Object.keys(n).forEach(o=>{i.push([s+e,o,n[o]])})}),i}function countFirstRowKeys(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&isObject(t[0])&&(e=deepObjectSize(t[0]))),e}function isArrayOfArrays(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function isArrayOfObjects(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const dataHelpers=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys,createEmptySpreadsheetData,createSpreadsheetData,createSpreadsheetObjectData,dataRowToChangesArray,isArrayOfArrays,isArrayOfObjects,spreadsheetColumnIndex,spreadsheetColumnLabel},Symbol.toStringTag,{value:"Module"}));function _defineProperty$1x(t,e,r){return(e=_toPropertyKey$1x(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1x(t){var e=_toPrimitive$1x(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1x(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DataSource{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];_defineProperty$1x(this,"hot",void 0),_defineProperty$1x(this,"data",void 0),_defineProperty$1x(this,"dataType","array"),_defineProperty$1x(this,"colToProp",()=>{}),_defineProperty$1x(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return arrayEach(this.data,(i,n)=>{const s=this.getAtCell(n,e);r.push(s)}),r}getAtRow(e,r,i){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=r===void 0&&i===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((c,u)=>{l[u]=this.getAtPhysicalCell(e,u,a)}):rangeEach(r,i,c=>{l[c-r]=this.getAtPhysicalCell(e,c,a)});else if(isObject(a)||isFunction(a))if(n?l=[]:l={},!s||n){const u=this.countFirstRowKeys()-1;rangeEach(0,u,d=>{const h=this.colToProp(d);if(d>=(r||0)&&d<=(i||u)&&!Number.isInteger(h)){const f=this.getAtPhysicalCell(e,h,a);n?l.push(f):o?setProperty(l,h,f):l[h]=f}})}else objectEach(a,(c,u)=>{const d=this.getAtPhysicalCell(e,u,a);o?setProperty(l,u,d):l[u]=d});return l}setAtCell(e,r,i){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const n=createObjectPropListener(i);this.hot.runHooks("modifySourceData",e,r,n,"set"),n.isTouched()&&(i=n.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=i:setProperty(this.data[e],r,i))}}getAtPhysicalCell(e,r,i){let n=null;if(i)if(typeof r=="string"){const{dataDotNotation:s}=this.hot.getSettings();n=s?getProperty(i,r):i[r]}else typeof r=="function"?n=r(i):n=i[r];if(this.hot.hasHook("modifySourceData")){const s=createObjectPropListener(n);this.hot.runHooks("modifySourceData",e,r,s,"get"),s.isTouched()&&(n=s.value)}return n}getAtCell(e,r){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=!1,s=null,o=null,a=null,l=null;e===null||r===null?(n=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,r.row),o=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const c=[];return rangeEach(s,a,u=>{c.push(n?this.getAtRow(u,void 0,void 0,i):this.getAtRow(u,o,l,i))}),c}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return countFirstRowKeys(this.data)}destroy(){this.data=null,this.hot=null}}var esnext_iterator_some={},es_iterator_some={},hasRequiredEs_iterator_some;function requireEs_iterator_some(){if(hasRequiredEs_iterator_some)return es_iterator_some;hasRequiredEs_iterator_some=1;var t=require_export(),e=requireFunctionCall(),r=requireIterate(),i=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect(),o=requireIteratorClose(),a=requireIteratorHelperWithoutClosingOnEarlyError(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(u){n(this);try{i(u)}catch(f){o(this,"throw",f)}if(l)return e(l,this,u);var d=s(this),h=0;return r(d,function(f,g){if(u(f,h++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_some}var hasRequiredEsnext_iterator_some;function requireEsnext_iterator_some(){return hasRequiredEsnext_iterator_some||(hasRequiredEsnext_iterator_some=1,requireEs_iterator_some()),esnext_iterator_some}requireEsnext_iterator_some();function _defineProperty$1w(t,e,r){return(e=_toPropertyKey$1w(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1w(t){var e=_toPrimitive$1w(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1w(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IndexMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty$1w(this,"indexedValues",[]),_defineProperty$1w(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,isFunction(this.initValueOrFn)?rangeEach(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):rangeEach(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}mixin(IndexMap,localHooks);function getListWithInsertedItems$3(t,e,r,i){const n=r.length?r[0]:void 0;return[...t.slice(0,n),...r.map((s,o)=>isFunction(i)?i(s,o):i),...n===void 0?[]:t.slice(n)]}function getListWithRemovedItems$3(t,e){return arrayFilter(t,(r,i)=>e.includes(i)===!1)}class PhysicalIndexToValueMap extends IndexMap{insert(e,r){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,e),super.remove(e)}}class HidingMap extends PhysicalIndexToValueMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return arrayReduce(this.getValues(),(e,r,i)=>(r&&e.push(i),e),[])}}function getListWithInsertedItems$2(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function getListWithRemovedItems$2(t,e){return arrayFilter(t,r=>e.includes(r)===!1)}function getDecreasedIndexes(t,e){return arrayMap(t,r=>r-e.filter(i=>i<r).length)}function getIncreasedIndexes(t,e){const r=e[0],i=e.length;return arrayMap(t,n=>n>=r?n+i:n)}function _defineProperty$1v(t,e,r){return(e=_toPropertyKey$1v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1v(t){var e=_toPrimitive$1v(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1v(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LinkedPhysicalIndexToValueMap extends IndexMap{constructor(){super(...arguments),_defineProperty$1v(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,[e]),isFunction(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=getIncreasedIndexes(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,e),this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,e),this.orderOfIndexes=getDecreasedIndexes(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class TrimmingMap extends PhysicalIndexToValueMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return arrayReduce(this.getValues(),(e,r,i)=>(r&&e.push(i),e),[])}}const alterStrategies=new Map([["indexesSequence",{getListWithInsertedItems:getListWithInsertedItems$2,getListWithRemovedItems:getListWithRemovedItems$2}],["physicallyIndexed",{getListWithInsertedItems:getListWithInsertedItems$3,getListWithRemovedItems:getListWithRemovedItems$3}]]),alterUtilsFactory=t=>{if(alterStrategies.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return alterStrategies.get(t)};class IndexesSequence extends IndexMap{constructor(){super(e=>e)}insert(e,r){const i=getIncreasedIndexes(this.indexedValues,r);this.indexedValues=getListWithInsertedItems$2(i,e,r),super.insert(e,r)}remove(e){const r=getListWithRemovedItems$2(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(r,e),super.remove(e)}}const availableIndexMapTypes=new Map([["hiding",HidingMap],["index",IndexMap],["linkedPhysicalIndexToValue",LinkedPhysicalIndexToValueMap],["physicalIndexToValue",PhysicalIndexToValueMap],["trimming",TrimmingMap]]);function createIndexMap(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!availableIndexMapTypes.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(availableIndexMapTypes.get(t))(e)}function _defineProperty$1u(t,e,r){return(e=_toPropertyKey$1u(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1u(t){var e=_toPrimitive$1u(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1u(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let registeredMaps=0;class MapCollection{constructor(){_defineProperty$1u(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)),registeredMaps+=1)}unregister(e){const r=this.collection.get(e);isDefined(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r),registeredMaps-=1)}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return isUndefined(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(i=>{i.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}mixin(MapCollection,localHooks);function getRegisteredMapsCounter(){return registeredMaps}function _defineProperty$1t(t,e,r){return(e=_toPropertyKey$1t(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1t(t){var e=_toPrimitive$1t(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1t(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AggregatedCollection extends MapCollection{constructor(e,r){super(),_defineProperty$1t(this,"mergedValuesCache",[]),_defineProperty$1t(this,"aggregationFunction",void 0),_defineProperty$1t(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=arrayMap(this.get(),s=>s.getValues()),i=[],n=isDefined(r[0])&&r[0].length||0;for(let s=0;s<n;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(r[a][s]);i.push(o)}return arrayMap(i,this.aggregationFunction)}getMergedValueAtIndex(e,r){const i=this.getMergedValues(r)[e];return isDefined(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function _classPrivateFieldInitSpec$L(t,e,r){_checkPrivateRedeclaration$13(t,e),e.set(t,r)}function _checkPrivateRedeclaration$13(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$H(t,e,r){return t.set(_assertClassBrand$13(t,e),r),r}function _classPrivateFieldGet$L(t,e){return t.get(_assertClassBrand$13(t,e))}function _assertClassBrand$13(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _currentInitialChanges=new WeakMap;class ChangesObserver{constructor(){_classPrivateFieldInitSpec$L(this,_currentInitialChanges,[])}subscribe(e){return this.addLocalHook("change",e),this._write(_classPrivateFieldGet$L(_currentInitialChanges,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){_classPrivateFieldSet$H(_currentInitialChanges,this,e)}}mixin(ChangesObserver,localHooks);function arrayDiff(t,e){const r=[];let i=0,n=0;for(;i<t.length&&n<e.length;i++,n++)t[i]!==e[n]&&r.push({op:"replace",index:n,oldValue:t[i],newValue:e[n]});for(;i<e.length;i++)r.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;n<t.length;n++)r.push({op:"remove",index:n,oldValue:t[n],newValue:void 0});return r}function _classPrivateFieldInitSpec$K(t,e,r){_checkPrivateRedeclaration$12(t,e),e.set(t,r)}function _checkPrivateRedeclaration$12(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$K(t,e){return t.get(_assertClassBrand$12(t,e))}function _classPrivateFieldSet$G(t,e,r){return t.set(_assertClassBrand$12(t,e),r),r}function _assertClassBrand$12(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _observers=new WeakMap,_indexMatrix=new WeakMap,_currentIndexState=new WeakMap,_isMatrixIndexesInitialized=new WeakMap,_initialIndexValue=new WeakMap;class ChangesObservable{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_classPrivateFieldInitSpec$K(this,_observers,new Set),_classPrivateFieldInitSpec$K(this,_indexMatrix,[]),_classPrivateFieldInitSpec$K(this,_currentIndexState,[]),_classPrivateFieldInitSpec$K(this,_isMatrixIndexesInitialized,!1),_classPrivateFieldInitSpec$K(this,_initialIndexValue,!1),_classPrivateFieldSet$G(_initialIndexValue,this,e??!1)}createObserver(){const e=new ChangesObserver;return _classPrivateFieldGet$K(_observers,this).add(e),e.addLocalHook("unsubscribe",()=>{_classPrivateFieldGet$K(_observers,this).delete(e)}),e._writeInitialChanges(arrayDiff(_classPrivateFieldGet$K(_indexMatrix,this),_classPrivateFieldGet$K(_currentIndexState,this))),e}emit(e){let r=_classPrivateFieldGet$K(_currentIndexState,this);(!_classPrivateFieldGet$K(_isMatrixIndexesInitialized,this)||_classPrivateFieldGet$K(_indexMatrix,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(_classPrivateFieldGet$K(_initialIndexValue,this)):_classPrivateFieldSet$G(_indexMatrix,this,new Array(e.length).fill(_classPrivateFieldGet$K(_initialIndexValue,this))),_classPrivateFieldGet$K(_isMatrixIndexesInitialized,this)||(_classPrivateFieldSet$G(_isMatrixIndexesInitialized,this,!0),r=_classPrivateFieldGet$K(_indexMatrix,this)));const i=arrayDiff(r,e);_classPrivateFieldGet$K(_observers,this).forEach(n=>n._write(i)),_classPrivateFieldSet$G(_currentIndexState,this,e)}}function _defineProperty$1s(t,e,r){return(e=_toPropertyKey$1s(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1s(t){var e=_toPrimitive$1s(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1s(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IndexMapper{constructor(){_defineProperty$1s(this,"indexesSequence",new IndexesSequence),_defineProperty$1s(this,"trimmingMapsCollection",new AggregatedCollection(e=>e.some(r=>r===!0),!1)),_defineProperty$1s(this,"hidingMapsCollection",new AggregatedCollection(e=>e.some(r=>r===!0),!1)),_defineProperty$1s(this,"variousMapsCollection",new MapCollection),_defineProperty$1s(this,"hidingChangesObservable",new ChangesObservable({initialIndexValue:!1})),_defineProperty$1s(this,"notTrimmedIndexesCache",[]),_defineProperty$1s(this,"notHiddenIndexesCache",[]),_defineProperty$1s(this,"isBatched",!1),_defineProperty$1s(this,"indexesSequenceChanged",!1),_defineProperty$1s(this,"indexesChangeSource",void 0),_defineProperty$1s(this,"trimmedIndexesChanged",!1),_defineProperty$1s(this,"hiddenIndexesChanged",!1),_defineProperty$1s(this,"renderablePhysicalIndexesCache",[]),_defineProperty$1s(this,"fromPhysicalToVisualIndexesCache",new Map),_defineProperty$1s(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,i){return this.registerMap(e,createIndexMap(r,i))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof TrimmingMap?this.trimmingMapsCollection.register(e,r):r instanceof HidingMap?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const i=this.getNumberOfIndexes();return i>0&&r.init(i),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return isDefined(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return isDefined(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return isDefined(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return isDefined(r)?r:null}getNearestNotHiddenIndex(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return r>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?i?this.getNearestNotHiddenIndex(e,-r,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(n=>n+e);this.removeIndexes(i)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const i=arrayMap(e,c=>this.getPhysicalFromVisualIndex(c)),n=this.getNotTrimmedIndexesLength(),s=e.length,o=getListWithRemovedItems$2(this.getIndexesSequence(),i),a=o.filter(c=>this.isTrimmed(c)===!1);let l=o.indexOf(a[a.length-1])+1;if(r+s<n){const c=a[r];l=o.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(getListWithInsertedItems$2(o,l,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const n=this.getNotTrimmedIndexes()[e],s=isDefined(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),a=arrayMap(new Array(r).fill(s),(c,u)=>c+u);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0;const l=i==="end"?a.map(c=>c+1):a;this.trimmingMapsCollection.insertToEvery(o,l),this.hidingMapsCollection.insertToEvery(o,l),this.variousMapsCollection.insertToEvery(o,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const i=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(i,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const i=this.getPhysicalFromRenderableIndex(r),n=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(n,r)}}}mixin(IndexMapper,localHooks);function extendNotExistingKeys(t,e){return objectEach(e,(r,i)=>{isUndefined(t[i])&&(t[i]=r)}),t}function normalizeLanguageCode(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function warnUserAboutLanguageRegistration(t){isDefined(t)&&error(toSingleLine`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function pluralize(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:registerGloballyPhraseFormatter,getValues:getGlobalPhraseFormatters}=staticRegister("phraseFormatters");function register$1(t,e){registerGloballyPhraseFormatter(t,e)}function getAll(){return getGlobalPhraseFormatters()}register$1("pluralize",pluralize);const CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",CM_ALIAS=CONTEXT_MENU_ITEMS_NAMESPACE,CONTEXTMENU_ITEMS_NO_ITEMS=`${CM_ALIAS}.noItems`,CONTEXTMENU_ITEMS_ROW_ABOVE=`${CM_ALIAS}.insertRowAbove`,CONTEXTMENU_ITEMS_ROW_BELOW=`${CM_ALIAS}.insertRowBelow`,CONTEXTMENU_ITEMS_INSERT_LEFT=`${CM_ALIAS}.insertColumnOnTheLeft`,CONTEXTMENU_ITEMS_INSERT_RIGHT=`${CM_ALIAS}.insertColumnOnTheRight`,CONTEXTMENU_ITEMS_REMOVE_ROW=`${CM_ALIAS}.removeRow`,CONTEXTMENU_ITEMS_REMOVE_COLUMN=`${CM_ALIAS}.removeColumn`,CONTEXTMENU_ITEMS_UNDO=`${CM_ALIAS}.undo`,CONTEXTMENU_ITEMS_REDO=`${CM_ALIAS}.redo`,CONTEXTMENU_ITEMS_READ_ONLY=`${CM_ALIAS}.readOnly`,CONTEXTMENU_ITEMS_CLEAR_COLUMN=`${CM_ALIAS}.clearColumn`,CONTEXTMENU_ITEMS_COPY=`${CM_ALIAS}.copy`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS=`${CM_ALIAS}.copyWithHeaders`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS=`${CM_ALIAS}.copyWithGroupHeaders`,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY=`${CM_ALIAS}.copyHeadersOnly`,CONTEXTMENU_ITEMS_CUT=`${CM_ALIAS}.cut`,CONTEXTMENU_ITEMS_FREEZE_COLUMN=`${CM_ALIAS}.freezeColumn`,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=`${CM_ALIAS}.unfreezeColumn`,CONTEXTMENU_ITEMS_MERGE_CELLS=`${CM_ALIAS}.mergeCells`,CONTEXTMENU_ITEMS_UNMERGE_CELLS=`${CM_ALIAS}.unmergeCells`,CONTEXTMENU_ITEMS_ADD_COMMENT=`${CM_ALIAS}.addComment`,CONTEXTMENU_ITEMS_EDIT_COMMENT=`${CM_ALIAS}.editComment`,CONTEXTMENU_ITEMS_REMOVE_COMMENT=`${CM_ALIAS}.removeComment`,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=`${CM_ALIAS}.readOnlyComment`,CONTEXTMENU_ITEMS_ALIGNMENT=`${CM_ALIAS}.align`,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=`${CM_ALIAS}.align.left`,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=`${CM_ALIAS}.align.center`,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=`${CM_ALIAS}.align.right`,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=`${CM_ALIAS}.align.justify`,CONTEXTMENU_ITEMS_ALIGNMENT_TOP=`${CM_ALIAS}.align.top`,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=`${CM_ALIAS}.align.middle`,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=`${CM_ALIAS}.align.bottom`,CONTEXTMENU_ITEMS_BORDERS=`${CM_ALIAS}.borders`,CONTEXTMENU_ITEMS_BORDERS_TOP=`${CM_ALIAS}.borders.top`,CONTEXTMENU_ITEMS_BORDERS_RIGHT=`${CM_ALIAS}.borders.right`,CONTEXTMENU_ITEMS_BORDERS_BOTTOM=`${CM_ALIAS}.borders.bottom`,CONTEXTMENU_ITEMS_BORDERS_LEFT=`${CM_ALIAS}.borders.left`,CONTEXTMENU_ITEMS_REMOVE_BORDERS=`${CM_ALIAS}.borders.remove`,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=`${CM_ALIAS}.nestedHeaders.insertChildRow`,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=`${CM_ALIAS}.nestedHeaders.detachFromParent`,CONTEXTMENU_ITEMS_HIDE_COLUMN=`${CM_ALIAS}.hideColumn`,CONTEXTMENU_ITEMS_SHOW_COLUMN=`${CM_ALIAS}.showColumn`,CONTEXTMENU_ITEMS_HIDE_ROW=`${CM_ALIAS}.hideRow`,CONTEXTMENU_ITEMS_SHOW_ROW=`${CM_ALIAS}.showRow`,FILTERS_NAMESPACE="Filters:",FILTERS_CONDITIONS_NAMESPACE=`${FILTERS_NAMESPACE}conditions`,FILTERS_CONDITIONS_NONE=`${FILTERS_CONDITIONS_NAMESPACE}.none`,FILTERS_CONDITIONS_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isEmpty`,FILTERS_CONDITIONS_NOT_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEmpty`,FILTERS_CONDITIONS_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isEqualTo`,FILTERS_CONDITIONS_NOT_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEqualTo`,FILTERS_CONDITIONS_BEGINS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.beginsWith`,FILTERS_CONDITIONS_ENDS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.endsWith`,FILTERS_CONDITIONS_CONTAINS=`${FILTERS_CONDITIONS_NAMESPACE}.contains`,FILTERS_CONDITIONS_NOT_CONTAIN=`${FILTERS_CONDITIONS_NAMESPACE}.doesNotContain`,FILTERS_CONDITIONS_BY_VALUE=`${FILTERS_CONDITIONS_NAMESPACE}.byValue`,FILTERS_CONDITIONS_GREATER_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThan`,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThanOrEqualTo`,FILTERS_CONDITIONS_LESS_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.lessThan`,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.lessThanOrEqualTo`,FILTERS_CONDITIONS_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isBetween`,FILTERS_CONDITIONS_NOT_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isNotBetween`,FILTERS_CONDITIONS_AFTER=`${FILTERS_CONDITIONS_NAMESPACE}.after`,FILTERS_CONDITIONS_BEFORE=`${FILTERS_CONDITIONS_NAMESPACE}.before`,FILTERS_CONDITIONS_TODAY=`${FILTERS_CONDITIONS_NAMESPACE}.today`,FILTERS_CONDITIONS_TOMORROW=`${FILTERS_CONDITIONS_NAMESPACE}.tomorrow`,FILTERS_CONDITIONS_YESTERDAY=`${FILTERS_CONDITIONS_NAMESPACE}.yesterday`,FILTERS_DIVS_FILTER_BY_CONDITION=`${FILTERS_NAMESPACE}labels.filterByCondition`,FILTERS_DIVS_FILTER_BY_VALUE=`${FILTERS_NAMESPACE}labels.filterByValue`,FILTERS_LABELS_CONJUNCTION=`${FILTERS_NAMESPACE}labels.conjunction`,FILTERS_LABELS_DISJUNCTION=`${FILTERS_NAMESPACE}labels.disjunction`,FILTERS_VALUES_BLANK_CELLS=`${FILTERS_NAMESPACE}values.blankCells`,FILTERS_BUTTONS_SELECT_ALL=`${FILTERS_NAMESPACE}buttons.selectAll`,FILTERS_BUTTONS_CLEAR=`${FILTERS_NAMESPACE}buttons.clear`,FILTERS_BUTTONS_OK=`${FILTERS_NAMESPACE}buttons.ok`,FILTERS_BUTTONS_CANCEL=`${FILTERS_NAMESPACE}buttons.cancel`,FILTERS_BUTTONS_PLACEHOLDER_SEARCH=`${FILTERS_NAMESPACE}buttons.placeholder.search`,FILTERS_BUTTONS_PLACEHOLDER_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.value`,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.secondValue`,CHECKBOX_RENDERER_NAMESPACE="CheckboxRenderer:",CHECKBOX_CHECKED=`${CHECKBOX_RENDERER_NAMESPACE}checked`,CHECKBOX_UNCHECKED=`${CHECKBOX_RENDERER_NAMESPACE}unchecked`,_dictionaryKeys=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED,CHECKBOX_RENDERER_NAMESPACE,CHECKBOX_UNCHECKED,CONTEXTMENU_ITEMS_ADD_COMMENT,CONTEXTMENU_ITEMS_ALIGNMENT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP,CONTEXTMENU_ITEMS_BORDERS,CONTEXTMENU_ITEMS_BORDERS_BOTTOM,CONTEXTMENU_ITEMS_BORDERS_LEFT,CONTEXTMENU_ITEMS_BORDERS_RIGHT,CONTEXTMENU_ITEMS_BORDERS_TOP,CONTEXTMENU_ITEMS_CLEAR_COLUMN,CONTEXTMENU_ITEMS_COPY,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,CONTEXTMENU_ITEMS_CUT,CONTEXTMENU_ITEMS_EDIT_COMMENT,CONTEXTMENU_ITEMS_FREEZE_COLUMN,CONTEXTMENU_ITEMS_HIDE_COLUMN,CONTEXTMENU_ITEMS_HIDE_ROW,CONTEXTMENU_ITEMS_INSERT_LEFT,CONTEXTMENU_ITEMS_INSERT_RIGHT,CONTEXTMENU_ITEMS_MERGE_CELLS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,CONTEXTMENU_ITEMS_NO_ITEMS,CONTEXTMENU_ITEMS_READ_ONLY,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,CONTEXTMENU_ITEMS_REDO,CONTEXTMENU_ITEMS_REMOVE_BORDERS,CONTEXTMENU_ITEMS_REMOVE_COLUMN,CONTEXTMENU_ITEMS_REMOVE_COMMENT,CONTEXTMENU_ITEMS_REMOVE_ROW,CONTEXTMENU_ITEMS_ROW_ABOVE,CONTEXTMENU_ITEMS_ROW_BELOW,CONTEXTMENU_ITEMS_SHOW_COLUMN,CONTEXTMENU_ITEMS_SHOW_ROW,CONTEXTMENU_ITEMS_UNDO,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,CONTEXTMENU_ITEMS_UNMERGE_CELLS,CONTEXT_MENU_ITEMS_NAMESPACE,FILTERS_BUTTONS_CANCEL,FILTERS_BUTTONS_CLEAR,FILTERS_BUTTONS_OK,FILTERS_BUTTONS_PLACEHOLDER_SEARCH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,FILTERS_BUTTONS_PLACEHOLDER_VALUE,FILTERS_BUTTONS_SELECT_ALL,FILTERS_CONDITIONS_AFTER,FILTERS_CONDITIONS_BEFORE,FILTERS_CONDITIONS_BEGINS_WITH,FILTERS_CONDITIONS_BETWEEN,FILTERS_CONDITIONS_BY_VALUE,FILTERS_CONDITIONS_CONTAINS,FILTERS_CONDITIONS_EMPTY,FILTERS_CONDITIONS_ENDS_WITH,FILTERS_CONDITIONS_EQUAL,FILTERS_CONDITIONS_GREATER_THAN,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,FILTERS_CONDITIONS_LESS_THAN,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,FILTERS_CONDITIONS_NAMESPACE,FILTERS_CONDITIONS_NONE,FILTERS_CONDITIONS_NOT_BETWEEN,FILTERS_CONDITIONS_NOT_CONTAIN,FILTERS_CONDITIONS_NOT_EMPTY,FILTERS_CONDITIONS_NOT_EQUAL,FILTERS_CONDITIONS_TODAY,FILTERS_CONDITIONS_TOMORROW,FILTERS_CONDITIONS_YESTERDAY,FILTERS_DIVS_FILTER_BY_CONDITION,FILTERS_DIVS_FILTER_BY_VALUE,FILTERS_LABELS_CONJUNCTION,FILTERS_LABELS_DISJUNCTION,FILTERS_NAMESPACE,FILTERS_VALUES_BLANK_CELLS},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const dictionary={languageCode:"en-US",[CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[CONTEXTMENU_ITEMS_UNDO]:"Undo",[CONTEXTMENU_ITEMS_REDO]:"Redo",[CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[CONTEXTMENU_ITEMS_BORDERS]:"Borders",[CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[CONTEXTMENU_ITEMS_COPY]:"Copy",[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[CONTEXTMENU_ITEMS_CUT]:"Cut",[CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[FILTERS_CONDITIONS_NONE]:"None",[FILTERS_CONDITIONS_EMPTY]:"Is empty",[FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[FILTERS_CONDITIONS_EQUAL]:"Is equal to",[FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[FILTERS_CONDITIONS_CONTAINS]:"Contains",[FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[FILTERS_CONDITIONS_LESS_THAN]:"Less than",[FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[FILTERS_CONDITIONS_BETWEEN]:"Is between",[FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[FILTERS_CONDITIONS_AFTER]:"After",[FILTERS_CONDITIONS_BEFORE]:"Before",[FILTERS_CONDITIONS_TODAY]:"Today",[FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[FILTERS_LABELS_CONJUNCTION]:"And",[FILTERS_LABELS_DISJUNCTION]:"Or",[FILTERS_BUTTONS_SELECT_ALL]:"Select all",[FILTERS_BUTTONS_CLEAR]:"Clear",[FILTERS_BUTTONS_OK]:"OK",[FILTERS_BUTTONS_CANCEL]:"Cancel",[FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[CHECKBOX_CHECKED]:"Checked",[CHECKBOX_UNCHECKED]:"Unchecked"},dictionaryKeys=_dictionaryKeys,DEFAULT_LANGUAGE_CODE=dictionary.languageCode,{register:registerGloballyLanguageDictionary,getItem:getGlobalLanguageDictionary,hasItem:hasGlobalLanguageDictionary,getValues:getGlobalLanguagesDictionaries}=staticRegister("languagesDictionaries");registerLanguageDictionary(dictionary);function registerLanguageDictionary(t,e){let r=t,i=e;return isObject(t)&&(i=t,r=i.languageCode),extendLanguageDictionary(r,i),registerGloballyLanguageDictionary(r,deepClone(i)),deepClone(i)}function extendLanguageDictionary(t,e){t!==DEFAULT_LANGUAGE_CODE&&extendNotExistingKeys(e,getGlobalLanguageDictionary(DEFAULT_LANGUAGE_CODE))}function getLanguageDictionary(t){return hasLanguageDictionary(t)?deepClone(getGlobalLanguageDictionary(t)):null}function hasLanguageDictionary(t){return hasGlobalLanguageDictionary(t)}function getLanguagesDictionaries(){return getGlobalLanguagesDictionaries()}function getTranslatedPhrase(t,e,r){const i=getLanguageDictionary(t);if(i===null)return null;const n=i[e];if(isUndefined(n))return null;const s=getFormattedPhrase(n,r);return Array.isArray(s)?s[0]:s}function getFormattedPhrase(t,e){let r=t;return arrayEach(getAll(),i=>{r=i(t,e)}),r}function getValidLanguageCode(t){let e=normalizeLanguageCode(t);return hasLanguageDictionary(e)||(e=DEFAULT_LANGUAGE_CODE,warnUserAboutLanguageRegistration(t)),e}function _defineProperty$1r(t,e,r){return(e=_toPropertyKey$1r(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1r(t){var e=_toPrimitive$1r(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1r(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VisualSelection extends Selection$1{constructor(e,r){super(e,null),_defineProperty$1r(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:i}=e,n=this.getNearestNotHiddenCoords(r,1),s=this.getNearestNotHiddenCoords(i,-1);return n===null||s===null?null:((n.row>s.row||n.col>s.col)&&(n=r,s=i),this.settings.createCellRange(n,n,s))}getNearestNotHiddenCoords(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const n=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(n===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return s===null?null:this.settings.createCellCoords(n,s)}getNearestNotHiddenIndex(e,r,i){return r<0?r:e.getNearestNotHiddenIndex(r,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(r,i,n)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const i=this.settings.visualToRenderableCoords(e),n=this.settings.visualToRenderableCoords(r);return i.row===null||i.col===null||n.row===null||n.col===null?null:this.settings.createCellRange(i,i,n)}}function createHighlight$8(t){let{activeHeaderClassName:e,...r}=t;return new VisualSelection({className:e,...r,selectionType:ACTIVE_HEADER_TYPE})}function createHighlight$7(t){let{areaCornerVisible:e,...r}=t;return new VisualSelection({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:AREA_TYPE})}function createHighlight$6(t){let{...e}=t;return new VisualSelection({className:"highlight",...e,selectionType:AREA_TYPE})}function createHighlight$5(t){let{columnClassName:e,...r}=t;return new VisualSelection({className:e,...r,selectionType:COLUMN_TYPE})}function createHighlight$4(t){let{cellCornerVisible:e,...r}=t;return new VisualSelection({className:"current",headerAttributes:[A11Y_SELECTED()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:FOCUS_TYPE})}function createHighlight$3(t){let{border:e,visualCellRange:r,...i}=t;return new VisualSelection({...e,...i,selectionType:CUSTOM_SELECTION_TYPE},r)}function createHighlight$2(t){let{...e}=t;return new VisualSelection({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:FILL_TYPE})}function createHighlight$1(t){let{headerClassName:e,...r}=t;return new VisualSelection({className:e,...r,selectionType:HEADER_TYPE})}function createHighlight(t){let{rowClassName:e,...r}=t;return new VisualSelection({className:e,...r,selectionType:ROW_TYPE})}function _classPrivateMethodInitSpec$O(t,e){_checkPrivateRedeclaration$11(t,e),e.add(t)}function _checkPrivateRedeclaration$11(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1q(t,e,r){return(e=_toPropertyKey$1q(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1q(t){var e=_toPrimitive$1q(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1q(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$11(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _Highlight_brand=new WeakSet;class Highlight{constructor(e){_classPrivateMethodInitSpec$O(this,_Highlight_brand),_defineProperty$1q(this,"options",void 0),_defineProperty$1q(this,"layerLevel",0),_defineProperty$1q(this,"focus",void 0),_defineProperty$1q(this,"fill",void 0),_defineProperty$1q(this,"layeredAreas",new Map),_defineProperty$1q(this,"areas",new Map),_defineProperty$1q(this,"rowHeaders",new Map),_defineProperty$1q(this,"columnHeaders",new Map),_defineProperty$1q(this,"activeRowHeaders",new Map),_defineProperty$1q(this,"activeColumnHeaders",new Map),_defineProperty$1q(this,"activeCornerHeaders",new Map),_defineProperty$1q(this,"rowHighlights",new Map),_defineProperty$1q(this,"columnHighlights",new Map),_defineProperty$1q(this,"customSelections",[]),this.options=e,this.focus=createHighlight$4(e),this.fill=createHighlight$2(e)}isEnabledFor(e,r){let i=e;e===FOCUS_TYPE&&(i="current");let n=this.options.disabledCellSelection(r.row,r.col);return typeof n=="string"&&(n=[n]),n===!1||Array.isArray(n)&&!n.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return _assertClassBrand$11(_Highlight_brand,this,_createHighlight).call(this,this.layeredAreas,createHighlight$7)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return _assertClassBrand$11(_Highlight_brand,this,_createHighlight).call(this,this.areas,createHighlight$6)}getAreas(){return[...this.areas.values()]}createRowHeader(){return _assertClassBrand$11(_Highlight_brand,this,_createHighlight).call(this,this.rowHeaders,createHighlight$1)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return _assertClassBrand$11(_Highlight_brand,this,_createHighlight).call(this,this.columnHeaders,createHighlight$1)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return _assertClassBrand$11(_Highlight_brand,this,_createHighlight).call(this,this.activeRowHeaders,createHighlight$8)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return _assertClassBrand$11(_Highlight_brand,this,_createHighlight).call(this,this.activeColumnHeaders,createHighlight$8)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return _assertClassBrand$11(_Highlight_brand,this,_createHighlight).call(this,this.activeCornerHeaders,createHighlight$8)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return _assertClassBrand$11(_Highlight_brand,this,_createHighlight).call(this,this.rowHighlights,createHighlight)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return _assertClassBrand$11(_Highlight_brand,this,_createHighlight).call(this,this.columnHighlights,createHighlight$5)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(createHighlight$3({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),arrayEach(this.areas.values(),e=>void e.clear()),arrayEach(this.layeredAreas.values(),e=>void e.clear()),arrayEach(this.rowHeaders.values(),e=>void e.clear()),arrayEach(this.columnHeaders.values(),e=>void e.clear()),arrayEach(this.activeRowHeaders.values(),e=>void e.clear()),arrayEach(this.activeColumnHeaders.values(),e=>void e.clear()),arrayEach(this.activeCornerHeaders.values(),e=>void e.clear()),arrayEach(this.rowHighlights.values(),e=>void e.clear()),arrayEach(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function _createHighlight(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const i=e({layerLevel:r,...this.options});return t.set(r,i),i}function _defineProperty$1p(t,e,r){return(e=_toPropertyKey$1p(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1p(t){var e=_toPrimitive$1p(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1p(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SelectionRange{constructor(e){_defineProperty$1p(this,"ranges",[]),_defineProperty$1p(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((i,n)=>i.includes(e)&&r(i,n))}findAll(e){const r=[];return this.ranges.forEach((i,n)=>{i.isEqual(e)&&r.push({range:i,layer:n})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(i=>i.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,i)=>!e.includes(i)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new SelectionRange(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,i)=>e(r,i)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function _classPrivateMethodInitSpec$N(t,e){_checkPrivateRedeclaration$10(t,e),e.add(t)}function _classPrivateFieldInitSpec$J(t,e,r){_checkPrivateRedeclaration$10(t,e),e.set(t,r)}function _checkPrivateRedeclaration$10(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$J(t,e){return t.get(_assertClassBrand$10(t,e))}function _classPrivateFieldSet$F(t,e,r){return t.set(_assertClassBrand$10(t,e),r),r}function _assertClassBrand$10(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _range=new WeakMap,_options=new WeakMap,_offset$1=new WeakMap,_Transformation_brand=new WeakSet;class Transformation{constructor(e,r){_classPrivateMethodInitSpec$N(this,_Transformation_brand),_classPrivateFieldInitSpec$J(this,_range,void 0),_classPrivateFieldInitSpec$J(this,_options,void 0),_classPrivateFieldInitSpec$J(this,_offset$1,{x:0,y:0}),_classPrivateFieldSet$F(_range,this,e),_classPrivateFieldSet$F(_options,this,r)}transformStart(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=_classPrivateFieldGet$J(_options,this).createCellCoords(e,r);let s=_classPrivateFieldGet$J(_range,this).current().highlight;const o=_classPrivateFieldGet$J(_options,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",n),o.row!==null&&o.col!==null){const{width:c,height:u}=_assertClassBrand$10(_Transformation_brand,this,_getTableSize).call(this),{row:d,col:h}=_assertClassBrand$10(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,s),f=_classPrivateFieldGet$J(_options,this).fixedRowsBottom(),g=_classPrivateFieldGet$J(_options,this).minSpareRows(),m=_classPrivateFieldGet$J(_options,this).minSpareCols(),C=_classPrivateFieldGet$J(_options,this).autoWrapRow(),y=_classPrivateFieldGet$J(_options,this).autoWrapCol(),v=_classPrivateFieldGet$J(_options,this).createCellCoords(d+n.row,h+n.col);if(v.row>=u){const O=createObjectPropListener(i&&g>0&&f===0),P=v.col+1,I=_classPrivateFieldGet$J(_options,this).createCellCoords(v.row-u,P>=c?P-c:P);this.runLocalHooks("beforeColumnWrap",O,_assertClassBrand$10(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,I),P>=c),O.value?this.runLocalHooks("insertRowRequire",_classPrivateFieldGet$J(_options,this).countRenderableRows()):y&&v.assign(I)}else if(v.row<0){const O=createObjectPropListener(y),P=v.col-1,I=_classPrivateFieldGet$J(_options,this).createCellCoords(u+v.row,P<0?c+P:P);this.runLocalHooks("beforeColumnWrap",O,_assertClassBrand$10(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,I),P<0),y&&v.assign(I)}if(v.col>=c){const O=createObjectPropListener(i&&m>0),P=v.row+1,I=_classPrivateFieldGet$J(_options,this).createCellCoords(P>=u?P-u:P,v.col-c);this.runLocalHooks("beforeRowWrap",O,_assertClassBrand$10(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,I),P>=u),O.value?this.runLocalHooks("insertColRequire",_classPrivateFieldGet$J(_options,this).countRenderableColumns()):C&&v.assign(I)}else if(v.col<0){const O=createObjectPropListener(C),P=v.row-1,I=_classPrivateFieldGet$J(_options,this).createCellCoords(P<0?u+P:P,c+v.col);this.runLocalHooks("beforeRowWrap",O,_assertClassBrand$10(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,I),P<0),C&&v.assign(I)}const{rowDir:E,colDir:$}=_assertClassBrand$10(_Transformation_brand,this,_clampCoords).call(this,v);a=E,l=$,s=_assertClassBrand$10(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,v)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,r){const i=_classPrivateFieldGet$J(_options,this).createCellCoords(e,r),n=_classPrivateFieldGet$J(_range,this).current(),s=_classPrivateFieldGet$J(_options,this).visualToRenderableCoords(n.highlight),o=_assertClassBrand$10(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,n.to.row,n.from.row),a=_assertClassBrand$10(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,n.to.col,n.from.col),l=n.to.clone();let c=0,u=0;if(this.runLocalHooks("beforeTransformEnd",i),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:d,col:h}=_assertClassBrand$10(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,n.highlight),f=_classPrivateFieldGet$J(_options,this).createCellCoords(o+i.row,a+i.col),g=n.getTopStartCorner(),m=n.getTopEndCorner(),C=n.getBottomEndCorner();if(i.col<0&&a>=h&&f.col<h){const $=f.col-h;f.col=_assertClassBrand$10(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,g.col,m.col)+$}else if(i.col>0&&a<=h&&f.col>h){const $=_assertClassBrand$10(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,m.col,g.col),O=Math.max(f.col-$,1);f.col=$+O}if(i.row<0&&o>=d&&f.row<d){const $=f.row-d;f.row=_assertClassBrand$10(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,g.row,C.row)+$}else if(i.row>0&&o<=d&&f.row>d){const $=_assertClassBrand$10(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,C.row,g.row),O=Math.max(f.row-$,1);f.row=$+O}const{rowDir:y,colDir:v}=_assertClassBrand$10(_Transformation_brand,this,_clampCoords).call(this,f);c=y,u=v;const E=_assertClassBrand$10(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,f);i.row===0&&i.col!==0?l.col=E.col:i.row!==0&&i.col===0?l.row=E.row:(l.row=E.row,l.col=E.col)}return this.runLocalHooks("afterTransformEnd",l,c,u),l}setOffsetSize(e){let{x:r,y:i}=e;_classPrivateFieldSet$F(_offset$1,this,{x:r,y:i})}resetOffsetSize(){_classPrivateFieldSet$F(_offset$1,this,{x:0,y:0})}}function _clampCoords(t){const{width:e,height:r}=_assertClassBrand$10(_Transformation_brand,this,_getTableSize).call(this);let i=0,n=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=r&&(i=1,t.row=r-1),t.col<0?(n=-1,t.col=0):t.col>0&&t.col>=e&&(n=1,t.col=e-1),{rowDir:i,colDir:n}}function _getTableSize(){return{width:_classPrivateFieldGet$J(_offset$1,this).x+_classPrivateFieldGet$J(_options,this).countRenderableColumns(),height:_classPrivateFieldGet$J(_offset$1,this).y+_classPrivateFieldGet$J(_options,this).countRenderableRows()}}function _findFirstNonHiddenZeroBasedRow(t,e){const r=_classPrivateFieldGet$J(_options,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:_classPrivateFieldGet$J(_offset$1,this).y+r}function _findFirstNonHiddenZeroBasedColumn(t,e){const r=_classPrivateFieldGet$J(_options,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:_classPrivateFieldGet$J(_offset$1,this).x+r}function _visualToZeroBasedCoords(t){const{row:e,col:r}=_classPrivateFieldGet$J(_options,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return _classPrivateFieldGet$J(_options,this).createCellCoords(_classPrivateFieldGet$J(_offset$1,this).y+e,_classPrivateFieldGet$J(_offset$1,this).x+r)}function _zeroBasedToVisualCoords(t){const e=t.clone();return e.col=t.col-_classPrivateFieldGet$J(_offset$1,this).x,e.row=t.row-_classPrivateFieldGet$J(_offset$1,this).y,_classPrivateFieldGet$J(_options,this).renderableToVisualCoords(e)}mixin(Transformation,localHooks);const SELECTION_TYPE_UNRECOGNIZED=0,SELECTION_TYPE_EMPTY=1,SELECTION_TYPE_ARRAY=2,SELECTION_TYPE_OBJECT=3,SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY],ARRAY_TYPE_PATTERN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],rootCall=Symbol("root"),childCall=Symbol("child");function detectSelectionType(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rootCall;if(e!==rootCall&&e!==childCall)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),i=e===rootCall;let n=SELECTION_TYPE_UNRECOGNIZED;if(r){const s=t[0];t.length===0?n=SELECTION_TYPE_EMPTY:i&&s instanceof CellRange?n=SELECTION_TYPE_OBJECT:i&&Array.isArray(s)?n=detectSelectionType(s,childCall):t.length>=2&&t.length<=4&&!t.some((a,l)=>!ARRAY_TYPE_PATTERN[l].includes(typeof a))&&(n=SELECTION_TYPE_ARRAY)}return n}function normalizeSelectionFactory(t){let{createCellCoords:e,createCellRange:r,keepDirection:i=!1,propToCol:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!SELECTION_TYPES.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===SELECTION_TYPE_OBJECT;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],c=o?s.to.row:s[2],u=o?s.to.col:s[3];if(typeof n=="function"&&(typeof l=="string"&&(l=n(l)),typeof u=="string"&&(u=n(u))),isUndefined(c)&&(c=a),isUndefined(u)&&(u=l),!i){const f=a,g=l,m=c,C=u;a=Math.min(f,m),l=Math.min(g,C),c=Math.max(f,m),u=Math.max(g,C)}const d=e(a,l),h=e(c,u);return r(d,d,h)}}function transformSelectionToColumnDistance(t){const e=detectSelectionType(t.getSelected());if(e===SELECTION_TYPE_UNRECOGNIZED||e===SELECTION_TYPE_EMPTY)return[];const r=normalizeSelectionFactory(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;arrayEach(t.getSelected(),o=>{const{from:a,to:l}=r(o),c=Math.max(a.col,0),u=l.col-c+1;arrayEach(Array.from(new Array(u),(d,h)=>c+h),d=>{i.has(d)||i.add(d)})});const n=Array.from(i).sort((o,a)=>o-a);return arrayReduce(n,(o,a,l,c)=>(l!==0&&a===c[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function transformSelectionToRowDistance(t){const e=detectSelectionType(t.getSelected());if(e===SELECTION_TYPE_UNRECOGNIZED||e===SELECTION_TYPE_EMPTY)return[];const r=normalizeSelectionFactory(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;arrayEach(t.getSelected(),o=>{const{from:a,to:l}=r(o),c=Math.max(a.row,0),u=l.row-c+1;arrayEach(Array.from(new Array(u),(d,h)=>c+h),d=>{i.has(d)||i.add(d)})});const n=Array.from(i).sort((o,a)=>o-a);return arrayReduce(n,(o,a,l,c)=>(l!==0&&a===c[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function _classPrivateFieldInitSpec$I(t,e,r){_checkPrivateRedeclaration$$(t,e),e.set(t,r)}function _checkPrivateRedeclaration$$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1o(t,e,r){return(e=_toPropertyKey$1o(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1o(t){var e=_toPrimitive$1o(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1o(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$I(t,e){return t.get(_assertClassBrand$$(t,e))}function _classPrivateFieldSet$E(t,e,r){return t.set(_assertClassBrand$$(t,e),r),r}function _assertClassBrand$$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _transformation=new WeakMap,_focusTransformation=new WeakMap,_isFocusSelectionChanged=new WeakMap,_disableHeadersHighlight=new WeakMap,_selectionSource=new WeakMap,_expectedLayersCount=new WeakMap;class Selection{constructor(e,r){var i=this;_defineProperty$1o(this,"settings",void 0),_defineProperty$1o(this,"tableProps",void 0),_defineProperty$1o(this,"inProgress",!1),_defineProperty$1o(this,"selectedRange",new SelectionRange((n,s,o)=>this.tableProps.createCellRange(n,s,o))),_defineProperty$1o(this,"highlight",void 0),_classPrivateFieldInitSpec$I(this,_transformation,void 0),_classPrivateFieldInitSpec$I(this,_focusTransformation,void 0),_defineProperty$1o(this,"selectedByRowHeader",new Set),_defineProperty$1o(this,"selectedByColumnHeader",new Set),_classPrivateFieldInitSpec$I(this,_isFocusSelectionChanged,!1),_classPrivateFieldInitSpec$I(this,_disableHeadersHighlight,!1),_classPrivateFieldInitSpec$I(this,_selectionSource,"unknown"),_classPrivateFieldInitSpec$I(this,_expectedLayersCount,-1),this.settings=e,this.tableProps=r,this.highlight=new Highlight({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[A11Y_SELECTED()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(n,s)=>this.tableProps.isDisabledCellSelection(n,s),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:n=>this.tableProps.visualToRenderableCoords(n),renderableToVisualCoords:n=>this.tableProps.renderableToVisualCoords(n),createCellCoords:(n,s)=>this.tableProps.createCellCoords(n,s),createCellRange:(n,s,o)=>this.tableProps.createCellRange(n,s,o)}),_classPrivateFieldSet$E(_transformation,this,new Transformation(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:n=>this.tableProps.visualToRenderableCoords(n),renderableToVisualCoords:n=>this.tableProps.renderableToVisualCoords(n),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(n,s)=>this.tableProps.createCellCoords(n,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),_classPrivateFieldSet$E(_focusTransformation,this,new Transformation(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const n=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,n.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const n=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,n.getOuterBottomEndCorner().col)},visualToRenderableCoords:n=>this.tableProps.visualToRenderableCoords(n),renderableToVisualCoords:n=>this.tableProps.renderableToVisualCoords(n),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(n,s)=>this.tableProps.createCellCoords(n,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),_classPrivateFieldGet$I(_transformation,this).addLocalHook("beforeTransformStart",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformStart",...s)}),_classPrivateFieldGet$I(_transformation,this).addLocalHook("afterTransformStart",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformStart",...s)}),_classPrivateFieldGet$I(_transformation,this).addLocalHook("beforeTransformEnd",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformEnd",...s)}),_classPrivateFieldGet$I(_transformation,this).addLocalHook("afterTransformEnd",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformEnd",...s)}),_classPrivateFieldGet$I(_transformation,this).addLocalHook("insertRowRequire",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return i.runLocalHooks("insertRowRequire",...s)}),_classPrivateFieldGet$I(_transformation,this).addLocalHook("insertColRequire",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return i.runLocalHooks("insertColRequire",...s)}),_classPrivateFieldGet$I(_transformation,this).addLocalHook("beforeRowWrap",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return i.runLocalHooks("beforeRowWrap",...s)}),_classPrivateFieldGet$I(_transformation,this).addLocalHook("beforeColumnWrap",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return i.runLocalHooks("beforeColumnWrap",...s)}),_classPrivateFieldGet$I(_focusTransformation,this).addLocalHook("beforeTransformStart",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformFocus",...s)}),_classPrivateFieldGet$I(_focusTransformation,this).addLocalHook("afterTransformStart",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){_classPrivateFieldSet$E(_selectionSource,this,e)}markEndSource(){_classPrivateFieldSet$E(_selectionSource,this,"unknown")}getSelectionSource(){return _classPrivateFieldGet$I(_selectionSource,this)}setExpectedLayers(e){_classPrivateFieldSet$E(_expectedLayersCount,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,_classPrivateFieldSet$E(_expectedLayersCount,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=isUndefined(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();_classPrivateFieldSet$E(_isFocusSelectionChanged,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,a),(!s||s&&!o&&isUndefined(r))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(n.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),i=this.tableProps.countRows(),n=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||n>0)&&(i===0&&r.col<0&&!s||n===0&&r.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),c=o.getVerticalDirection(),u=this.isMultiple();o.setTo(r),u&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),u&&(c!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}i>0&&n>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=_classPrivateFieldGet$I(_expectedLayersCount,this)===-1||this.selectedRange.size()===_classPrivateFieldGet$I(_expectedLayersCount,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),n=this.tableProps.countCols();r<this.highlight.layerLevel&&(arrayEach(this.highlight.getAreas(),g=>void g.clear()),arrayEach(this.highlight.getLayeredAreas(),g=>void g.clear()),arrayEach(this.highlight.getRowHeaders(),g=>void g.clear()),arrayEach(this.highlight.getColumnHeaders(),g=>void g.clear()),arrayEach(this.highlight.getActiveRowHeaders(),g=>void g.clear()),arrayEach(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),arrayEach(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),arrayEach(this.highlight.getRowHighlights(),g=>void g.clear()),arrayEach(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),h=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),c.clear(),u.clear(),d.clear(),h.clear(),f.clear(),this.highlight.isEnabledFor(AREA_TYPE,e.highlight)&&(this.isMultiple()||r>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),r===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(HEADER_TYPE,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),y=this.tableProps.createCellCoords(e.to.row,-1),v=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),E=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(v).commit(),h.add(C).commit(),f.add(v).commit()):(a.add(C).add(y).commit(),l.add(v).add(E).commit(),h.add(C).add(y).commit(),f.add(v).add(E).commit())}const g=!_classPrivateFieldGet$I(_disableHeadersHighlight,this)&&this.isEntireRowSelected()&&(n>0&&n===e.getWidth()||n===0&&this.isSelectedByRowHeader()),m=!_classPrivateFieldGet$I(_disableHeadersHighlight,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());g&&c.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),m&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&m&&d.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(FOCUS_TYPE,r.highlight)&&i.add(r.highlight).commit().syncWith(r),this.inProgress||(_classPrivateFieldSet$E(_isFocusSelectionChanged,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?_classPrivateFieldGet$I(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_classPrivateFieldGet$I(_transformation,this).resetOffsetSize(),this.setRangeStart(_classPrivateFieldGet$I(_transformation,this).transformStart(e,r,i))}transformEnd(e,r){this.settings.navigableHeaders?_classPrivateFieldGet$I(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_classPrivateFieldGet$I(_transformation,this).resetOffsetSize(),this.setRangeEnd(_classPrivateFieldGet$I(_transformation,this).transformEnd(e,r))}transformFocus(e,r){const i=this.selectedRange.current(),{row:n,col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,n-1);i.highlight.isHeader()?_classPrivateFieldGet$I(_focusTransformation,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:n<0?Math.abs(n):-a}):_classPrivateFieldGet$I(_focusTransformation,this).setOffsetSize({x:s<0?0:-o,y:n<0?0:-a});const l=_classPrivateFieldGet$I(_focusTransformation,this).transformStart(e,r);this.setRangeFocus(l.normalize())}shiftRows(e,r){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:n,to:s,highlight:o}=i,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),u=c?-1:0,d=c?0:r;this.getSelectedRange().pop();const h=this.tableProps.createCellCoords(clamp(n.row+d,u,a-1),n.col),f=this.tableProps.createCellCoords(clamp(s.row+r,u,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(h,!0,this.tableProps.createCellCoords(clamp(o.row+r,0,a-1),o.col)):this.setRangeStartOnly(h,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:n,to:s,highlight:o}=i,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),u=l?-1:0,d=l?0:r;this.getSelectedRange().pop();const h=this.tableProps.createCellCoords(n.row,clamp(n.col+d,u,a-1)),f=this.tableProps.createCellCoords(s.row,clamp(s.col+r,u,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(h,!0,this.tableProps.createCellCoords(o.row,clamp(o.col+r,0,a-1))):this.setRangeStartOnly(h,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const r=createObjectPropListener(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&_classPrivateFieldGet$I(_isFocusSelectionChanged,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=n=>{const{col:s}=n.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&n.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(n=>r(n));const i=this.selectedRange.peekByIndex(e);return i?r(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=n=>{const{row:s}=n.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&n.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(n=>r(n));const i=this.selectedRange.peekByIndex(e);return i?r(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),c=i?-l:0,u=r?-a:0;if(c===0&&u===0&&(s===0||o===0))return;let d=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:h,disableHeadersHighlight:f}=n;_classPrivateFieldSet$E(_disableHeadersHighlight,this,f),h&&Number.isInteger(h?.row)&&Number.isInteger(h?.col)&&(d=this.tableProps.createCellCoords(clamp(h.row,c,s-1),clamp(h.col,u,o-1)));const g=this.tableProps.createCellCoords(c,u),m=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(g,void 0,d),u<0&&this.selectedByRowHeader.add(this.getLayerLevel()),c<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.finish(),_classPrivateFieldSet$E(_disableHeadersHighlight,this,!1)}selectCells(e){var r=this;const i=detectSelectionType(e);if(i===SELECTION_TYPE_EMPTY)return!1;if(i===SELECTION_TYPE_UNRECOGNIZED)throw new Error(toSingleLine`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const n=normalizeSelectionFactory(i,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const c=n(l),u=c.isValid(o);return!(u&&!c.containsHeaders()||u&&c.containsHeaders()&&c.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),arrayEach(e,l=>{const{from:c,to:u}=n(l);this.setRangeStartOnly(c.clone(),!1),this.setRangeEnd(u.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof r=="string"?this.tableProps.propToCol(r):r,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),c=l===0?0:-l,u=this.tableProps.createCellCoords(c,n),d=this.tableProps.createCellCoords(o-1,s),h=this.tableProps.createCellRange(u,u,d).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(h){let f=0,g=0;Number.isInteger(i?.row)&&Number.isInteger(i?.col)?(f=clamp(i.row,c,o-1),g=clamp(i.col,Math.min(n,s),Math.max(n,s))):(f=clamp(i,c,o-1),g=n);const m=this.tableProps.createCellCoords(f,g),C=l===0?0:clamp(m.row,c,-1),y=o-1,v=this.tableProps.createCellCoords(C,n),E=this.tableProps.createCellCoords(y,s);this.runLocalHooks("beforeSelectColumns",v,E,m),v.row=C,E.row=y,this.setRangeStartOnly(v,void 0,m),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",v,E,m),this.finish()}return h}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),c=this.tableProps.createCellCoords(r,s-1),u=this.tableProps.createCellRange(l,l,c).isValid({countRows:n,countCols:s,countRowHeaders:o,countColHeaders:0});if(u){let d=0,h=0;Number.isInteger(i?.row)&&Number.isInteger(i?.col)?(d=clamp(i.row,Math.min(e,r),Math.max(e,r)),h=clamp(i.col,a,s-1)):(d=e,h=clamp(i,a,s-1));const f=this.tableProps.createCellCoords(d,h),g=o===0?0:clamp(f.col,a,-1),m=s-1,C=this.tableProps.createCellCoords(e,g),y=this.tableProps.createCellCoords(r,m);this.runLocalHooks("beforeSelectRows",C,y,f),C.col=g,y.col=m,this.setRangeStartOnly(C,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectRows",C,y,f),this.finish()}return u}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const i=this.selectedRange.ranges.map(o=>o.clone());this.markSource("refresh");const n=new Set(this.selectedByRowHeader),s=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(i.length),i.forEach(o=>{const{from:a,to:l,highlight:c}=o,u=e-1,d=r-1;c.assign({row:clamp(c.row,this.settings.navigableHeaders?-1/0:0,u),col:clamp(c.col,this.settings.navigableHeaders?-1/0:0,d)}),a.assign({row:clamp(a.row,-1/0,u),col:clamp(a.col,-1/0,d)}),l.assign({row:clamp(l.row,-1/0,u),col:clamp(l.col,-1/0,d)}),this.setRangeStartOnly(a,!0,c),this.setRangeEnd(l)}),this.selectedByRowHeader=n,this.selectedByColumnHeader=s,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(n=>{n.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),i=this.selectedRange.current();this.highlight.isEnabledFor(FOCUS_TYPE,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),h=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),c.commit(),u.commit(),d.commit(),h.commit(),f.commit()}this.highlight.useLayerLevel(r)}}mixin(Selection,localHooks);const regUniversalNewLine=/^(\r\n|\n\r|\r|\n)/,regNextCellNoQuotes=/^[^\t\r\n]+/,regNextEmptyCell=/^\t/;function parse(t){const e=[[""]];if(t.length===0)return e;let r=0,i=0,n;for(;t.length>0&&n!==t.length;)if(n=t.length,t.match(regNextEmptyCell))t=t.replace(regNextEmptyCell,""),r+=1,e[i][r]="";else if(t.match(regUniversalNewLine))t=t.replace(regUniversalNewLine,""),r=0,i+=1,e[i]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(o+=1),s+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=t.match(regNextCellNoQuotes);s=o?o[0]:"",t=t.slice(s.length)}e[i][r]=s}return e}function stringify(t){let e,r,i,n,s="",o;for(e=0,r=t.length;e<r;e+=1){for(n=t[e].length,i=0;i<n;i+=1)i>0&&(s+="	"),o=t[e][i],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==r-1&&(s+=`
`)}return s}function _defineProperty$1n(t,e,r){return(e=_toPropertyKey$1n(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1n(t){var e=_toPrimitive$1n(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1n(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DataMap{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,i){_defineProperty$1n(this,"hot",void 0),_defineProperty$1n(this,"metaManager",void 0),_defineProperty$1n(this,"tableMeta",void 0),_defineProperty$1n(this,"dataSource",void 0),_defineProperty$1n(this,"duckSchema",void 0),_defineProperty$1n(this,"colToPropCache",void 0),_defineProperty$1n(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,r){let n=0,s=0,o=!1;if(typeof r=="function"){const a=deepObjectSize(e);n=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;n=Math.min(a,r.length)}for(i=0;i<n;i++){const a=o?r(i):r[i];if(isObject(a)){if(typeof a.data<"u"){const l=o?s:i;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return countFirstRowKeys(this.dataSource)}recursiveDuckColumns(e,r,i){let n=r,s=i,o;return typeof n>"u"&&(n=0,s=""),typeof e=="object"&&!Array.isArray(e)&&objectEach(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,n),n+=1):n=this.recursiveDuckColumns(a,n,`${l}.`)}),n}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&isDefined(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(isDefined(r))return this.hot.toVisualColumn(r);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?duckSchema(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:n="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,i)===!1||o===null)return{delta:0};const u=this.tableMeta.maxRows,d=this.getSchema().length,h=[];for(;a<r&&s+a<u;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=deepClone(this.getSchema()):(g=[],rangeEach(d-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},deepExtend(g,this.getSchema())),h.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),n==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,h);const f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===h.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):i!=="auto"&&this.metaManager.createRow(o,r)),this.hot.runHooks("afterCreateRow",f,a,i),{delta:a,startPhysicalIndex:o}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:n="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),c=this.hot.countSourceRows(),u=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",u,r,i)===!1)return{delta:0};const d=u<l?this.hot.toPhysicalColumn(u):a,h=n==="end"?Math.min(d+1,a):d;let f=0;for(let g=h;f<r&&l+f<o;g++){if(typeof u!="number"||u>=l+f)if(c>0)for(let m=0;m<c;m+=1)typeof s[m]>"u"&&(s[m]=[]),s[m].push(null);else s.push([null]);else for(let m=0;m<c;m++)s[m].splice(g,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):i!=="auto"&&this.metaManager.createColumn(h,r)),this.hot.columnIndexMapper.insertIndexes(u,f,n),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(h),f,i),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:h}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(e)?e:-r;const s=this.visualRowsToPhysical(n,r),o=this.hot.countSourceRows();if(n=(o+n)%o,this.hot.runHooks("beforeRemoveRow",n,s.length,s,i)===!1)return!1;const l=s.length;if(this.filterData(n,l,s),n<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const u=isDefined(this.tableMeta.columns)||isDefined(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!u&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((u,d)=>d-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.hot.runHooks("afterRemoveRow",n,l,s,i),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let n=typeof e!="number"?-r:e;n=(this.hot.countCols()+n)%this.hot.countCols();const s=this.visualColumnsToPhysical(n,r),o=s.slice(0).sort((d,h)=>h-d);if(this.hot.runHooks("beforeRemoveCol",n,r,s,i)===!1)return!1;let l=!0;const c=o.length,u=this.dataSource;for(let d=0;d<c;d++)l&&s[0]!==s[d]-d&&(l=!1);if(l)for(let d=0,h=this.hot.countSourceRows();d<h;d++)u[d].splice(s[0],r),d===0&&this.metaManager.removeColumn(s[0],r);else for(let d=0,h=this.hot.countSourceRows();d<h;d++)for(let f=0;f<c;f++)u[d].splice(o[f],1),d===0&&this.metaManager.removeColumn(o[f],1);return n<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",n,r,s,i),this.refreshDuckSchema(),!0}spliceCol(e,r,i){const n=this.hot.getDataAtCol(e),s=n.slice(r,r+i),o=n.slice(r+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];extendArray(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return to2dArray(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),s}spliceRow(e,r,i){const n=this.hot.getSourceDataAtRow(e),s=n.slice(r,r+i),o=n.slice(r+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];extendArray(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),s}spliceData(e,r,i){if(this.hot.runHooks("beforeDataSplice",e,r,i)!==!1){const s=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,r,i){let n=this.hot.runHooks("filterData",e,r,i);Array.isArray(n)===!1&&(n=this.dataSource.filter((s,o)=>i.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}get(e,r){const i=this.hot.toPhysicalRow(e);let n=this.dataSource[i];const s=this.hot.runHooks("modifyRowData",i);n=isNaN(s)?s:n;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(n&&n.hasOwnProperty&&hasOwnProperty(n,r))a=n[r];else if(o&&typeof r=="string"&&r.indexOf(".")>-1){let l=n;if(!l)return null;const c=r.split(".");for(let u=0,d=c.length;u<d;u++)if(l=l[c[u]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const l=createObjectPropListener(a);this.hot.runHooks("modifyData",e,this.propToCol(r),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,i){const n=this.hot.toPhysicalRow(e);let s=i,o=this.dataSource[n];const a=this.hot.runHooks("modifyRowData",n);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const c=createObjectPropListener(s);this.hot.runHooks("modifyData",e,this.propToCol(r),c,"set"),c.isTouched()&&(s=c.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&hasOwnProperty(o,r))o[r]=s;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let c=o,u=0,d;const h=r.split(".");for(u=0,d=h.length-1;u<d;u++){if(h[u]==="__proto__"||h[u]==="constructor"||h[u]==="prototype")return;typeof c[h[u]]>"u"&&(c[h[u]]={}),c=c[h[u]]}c[h[u]]=s}else if(typeof r=="function")r(this.dataSource.slice(n,n+1)[0],s);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;o[r]=s}}visualRowsToPhysical(e,r){const i=this.hot.countSourceRows(),n=[];let s=(i+e)%i,o=r,a;for(;s<i&&o;)a=this.hot.toPhysicalRow(s),n.push(a),o-=1,s+=1;return n}visualColumnsToPhysical(e,r){const i=this.hot.countCols(),n=[];let s=(i+e)%i,o=r;for(;s<i&&o;){const a=this.hot.toPhysicalColumn(s);n.push(a),o-=1,s+=1}return n}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,DataMap.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,i){const n=[];let s,o,a;const l=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(l===0||c===0)return[];const u=i===DataMap.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),h=Math.min(Math.max(c-1,0),Math.max(e.col,r.col));for(s=Math.min(e.row,r.row);s<=d;s++){a=[];const f=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,r.col);o<=h&&f!==null;o++)a.push(u.call(this,s,this.colToProp(o)));f!==null&&n.push(a)}return n}getText(e,r){return stringify(this.getRange(e,r,DataMap.DESTINATION_RENDERER))}getCopyableText(e,r){return stringify(this.getRange(e,r,DataMap.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register,getItem,hasItem,getNames,getValues}=staticRegister("cellTypes");function _getItem(t){if(!hasItem(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return getItem(t)}function _register(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:i,validator:n}=e;r&&_register$3(t,r),i&&_register$2(t,i),n&&_register$1(t,n),register(t,e)}function canBeOverwritten(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!hasOwnProperty(e,t)}function extendByMetaType(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?_getItem(e.type):e.type;if(t._automaticallyAssignedMetaProps&&objectEach(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!isObject(i))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const n={};objectEach(i,(s,o)=>{if(canBeOverwritten(o,r)){var a;n[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),extend$1(t,n)}function columnFactory(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}inherit(r,t);for(let i=0;i<e.length;i++)r.prototype[e[i]]=void 0;return r}function isUnsignedNumber(t){return Number.isInteger(t)&&t>=0}function assert(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function isNullish(t){return t==null}const metaSchemaFactory=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,i;for(e=0,r=this.countRows();e<r;e++)if(i=this.getDataAtCell(e,t),isEmpty(i)===!1)return!1;return!0},isEmptyRow(t){let e,r,i,n;for(e=0,r=this.countCols();e<r;e++)if(i=this.getDataAtCell(t,e),isEmpty(i)===!1)return typeof i=="object"?(n=this.getCellMeta(t,e),isObjectEqual(this.getSchema()[n.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function _defineProperty$1m(t,e,r){return(e=_toPropertyKey$1m(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1m(t){var e=_toPrimitive$1m(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1m(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function createTableMetaEmptyClass(){return class{}}class GlobalMeta{constructor(e){_defineProperty$1m(this,"metaCtor",createTableMetaEmptyClass()),_defineProperty$1m(this,"meta",void 0),this.meta=this.metaCtor.prototype,extend$1(this.meta,metaSchemaFactory()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;extend$1(this.meta,e),extendByMetaType(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function _defineProperty$1l(t,e,r){return(e=_toPropertyKey$1l(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1l(t){var e=_toPrimitive$1l(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1l(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TableMeta{constructor(e){_defineProperty$1l(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){extend$1(this.meta,e),extendByMetaType(this.meta,e,e)}}function _defineProperty$1k(t,e,r){return(e=_toPropertyKey$1k(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1k(t){var e=_toPrimitive$1k(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1k(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LazyFactoryMap{constructor(e){_defineProperty$1k(this,"valueFactory",void 0),_defineProperty$1k(this,"data",[]),_defineProperty$1k(this,"index",[]),_defineProperty$1k(this,"holes",new Set),this.valueFactory=e}obtain(e){assert(()=>isUnsignedNumber(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let i;if(r>=0)i=this.data[r],i===void 0&&(i=this.valueFactory(e),this.data[r]=i);else if(i=this.valueFactory(e),this.holes.size>0){const n=this.holes.values().next().value;this.holes.delete(n),this.data[n]=i,this.index[e]=n}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(e)||isNullish(e),"Expecting an unsigned number or null/undefined argument.");const i=[],n=this.data.length;for(let o=0;o<r;o++)i.push(n+o),this.data.push(void 0);const s=isNullish(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...i,...this.index.slice(s)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(e)||isNullish(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(isNullish(e)?this.index.length-r:e,r);for(let n=0;n<i.length;n++){const s=i[n];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const n=this._getKeyByStorageIndex(i);n!==-1&&this.data[i]!==void 0&&e.push([n,this.data[i]])}let r=0;return{next:()=>{if(r<e.length){const i=e[r];return r+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function _defineProperty$1j(t,e,r){return(e=_toPropertyKey$1j(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1j(t){var e=_toPrimitive$1j(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1j(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const COLUMNS_PROPS_CONFLICTS=["data","width"];class ColumnMeta{constructor(e){_defineProperty$1j(this,"globalMeta",void 0),_defineProperty$1j(this,"metas",new LazyFactoryMap(()=>this._createMeta())),this.globalMeta=e,this.metas=new LazyFactoryMap(()=>this._createMeta())}updateMeta(e,r){const i=this.getMeta(e);extend$1(i,r),extendByMetaType(i,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return columnFactory(this.globalMeta.getMetaConstructor(),COLUMNS_PROPS_CONFLICTS).prototype}}function _defineProperty$1i(t,e,r){return(e=_toPropertyKey$1i(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1i(t){var e=_toPrimitive$1i(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1i(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CellMeta{constructor(e){_defineProperty$1i(this,"columnMeta",void 0),_defineProperty$1i(this,"metas",new LazyFactoryMap(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,i){const n=this.getMeta(e,r);extend$1(n,i),extendByMetaType(n,i)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,r)}getMeta(e,r,i){const n=this.metas.obtain(e).obtain(r);return i===void 0?n:n[i]}setMeta(e,r,i,n){var s;const o=this.metas.obtain(e).obtain(r);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(i),o[i]=n}removeMeta(e,r,i){const n=this.metas.obtain(e).obtain(r);delete n[i]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let i=0;i<r.length;i++)isDefined(r[i])&&e.push(...r[i].values());return e}getMetasAtRow(e){assert(()=>isUnsignedNumber(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new LazyFactoryMap(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class MetaManager{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new GlobalMeta(e),this.tableMeta=new TableMeta(this.globalMeta),this.columnMeta=new ColumnMeta(this.globalMeta),this.cellMeta=new CellMeta(this.columnMeta),i.forEach(n=>new n(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,i){const n=this.cellMeta.getMeta(e,r);return n.visualRow=i.visualRow,n.visualCol=i.visualColumn,n.row=e,n.col=r,i.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",n),n}getCellMetaKeyValue(e,r,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,i)}setCellMeta(e,r,i,n){this.cellMeta.setMeta(e,r,i,n)}updateCellMeta(e,r,i){this.cellMeta.updateMeta(e,r,i)}removeCellMeta(e,r,i){this.cellMeta.removeMeta(e,r,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}mixin(MetaManager,localHooks);function replaceData(t,e,r,i){const{hotInstance:n,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:c,firstRun:u}=i,d=toUpperCaseFirst(a),h=n.getSettings();Array.isArray(h.dataSchema)?n.dataType="array":isFunction(h.dataSchema)?n.dataType="function":n.dataType="object",s&&s.destroy(),t=n.runHooks(`before${d}`,t,u,l);const f=new DataMap(n,t,c);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let m,C=0,y=0;for(C=0,y=h.startRows;C<y;C++)if((n.dataType==="object"||n.dataType==="function")&&h.dataSchema)m=deepClone(g),t.push(m);else if(n.dataType==="array")m=deepClone(g[0]),t.push(m);else{m=[];for(let v=0,E=h.startCols;v<E;v++)m.push(null);t.push(m)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(n.dataType="array"),h.data=t,f.dataSource=t,o.data=t,o.dataType=n.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),r(f),n.runHooks(`after${d}`,t,u,l),u||(n.runHooks("afterChange",null,a),n.render()),n.getSettings().ariaTags&&setAttribute(n.rootElement,[A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(n.countCols()+(n.view?n.countRowHeaders():0))])}function _defineProperty$1h(t,e,r){return(e=_toPropertyKey$1h(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1h(t){var e=_toPrimitive$1h(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1h(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DynamicCellMetaMod{constructor(e){var r=this;_defineProperty$1h(this,"metaManager",void 0),_defineProperty$1h(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),Hooks.getSingleton().add("beforeRender",i=>{i&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:i,col:n}=e;if((r=this.metaSyncMemo.get(i))!==null&&r!==void 0&&r.has(n))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const c=hasOwnProperty(e,"type")?e.type:null;let u=isFunction(e.cells)?e.cells(i,n,l):null;if(c)if(u){var d;u.type=(d=u.type)!==null&&d!==void 0?d:c}else u={type:c};u&&this.metaManager.updateCellMeta(i,n,u),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(n)}}function _classPrivateFieldInitSpec$H(t,e,r){_checkPrivateRedeclaration$_(t,e),e.set(t,r)}function _checkPrivateRedeclaration$_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1g(t,e,r){return(e=_toPropertyKey$1g(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1g(t){var e=_toPrimitive$1g(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1g(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$H(t,e){return t.get(_assertClassBrand$_(t,e))}function _assertClassBrand$_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _initOnlyCallback=new WeakMap;class ExtendMetaPropertiesMod{constructor(e){_defineProperty$1g(this,"metaManager",void 0),_defineProperty$1g(this,"usageTracker",new Set),_defineProperty$1g(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),_classPrivateFieldInitSpec$H(this,_initOnlyCallback,(r,i,n)=>{if(!n)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:i,target:n,onChange:s}=e,o=typeof n=="string",a=o?n:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(r,l,s),o&&this.installPropWatcher(n,l,s)):i&&(this.installPropWatcher(r,l,_classPrivateFieldGet$H(_initOnlyCallback,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,i){const n=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(s){const o=!n.usageTracker.has(e);n.usageTracker.add(e),i.call(n,e,s,o),this[r]=s},enumerable:!0,configurable:!0})}}const GRID_GROUP="gridDefault",EDITOR_EDIT_GROUP="editorManager.handlingEditor",command$E={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},MIXIN_NAME="hooksRefRegisterer",hooksRefRegisterer={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){arrayEach(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){objectEach(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};defineGetter(hooksRefRegisterer,"MIXIN_NAME",MIXIN_NAME,{writable:!1,enumerable:!1});function _defineProperty$1f(t,e,r){return(e=_toPropertyKey$1f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1f(t){var e=_toPrimitive$1f(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1f(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const EDITOR_TYPE$a="base",EDITOR_STATE=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$a}constructor(e){_defineProperty$1f(this,"hot",void 0),_defineProperty$1f(this,"state",EDITOR_STATE.VIRGIN),_defineProperty$1f(this,"_opened",!1),_defineProperty$1f(this,"_fullEditMode",!1),_defineProperty$1f(this,"_closeCallback",null),_defineProperty$1f(this,"TD",null),_defineProperty$1f(this,"row",null),_defineProperty$1f(this,"col",null),_defineProperty$1f(this,"prop",null),_defineProperty$1f(this,"originalValue",null),_defineProperty$1f(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,i,n,s,o){this.TD=n,this.row=e,this.col=r,this.prop=i,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:EDITOR_STATE.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let i,n,s,o;if(r){const l=this.hot.getSelectedLast();i=Math.max(Math.min(l[0],l[2]),0),n=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[i,n,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",i,n,!1,"meta");Array.isArray(a)&&([i,n]=a),this.hot.populateFromArray(i,n,e,s,o,"edit")}beginEditing(e,r){if(this.state!==EDITOR_STATE.VIRGIN)return;const i=this.hot,n=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=EDITOR_STATE.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:stringify$1(this.originalValue);this.setValue(l)}this.open(r),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),i.view.scrollViewport(i._createCellCoords(n,s))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,r,i){let n;if(i){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),i(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===EDITOR_STATE.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===EDITOR_STATE.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?n=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:n=[[s]],this.state=EDITOR_STATE.WAITING,this.saveValue(n,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=EDITOR_STATE.FINISHED,this.discardEditor(o)}):(this.state=EDITOR_STATE.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=EDITOR_STATE.FINISHED,this.discardEditor()}discardEditor(e){this.state===EDITOR_STATE.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=EDITOR_STATE.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=EDITOR_STATE.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===EDITOR_STATE.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:i,wtViewport:n}=this.hot.view._wt,s=this.hot.rootWindow,o=offset(r),a=outerWidth(r),l=offset(this.hot.rootElement),c=outerWidth(this.hot.rootElement),u=i.topOverlay.holder,d=i.inlineStartOverlay.holder,h=u!==s?u.scrollTop:0,f=d!==s?d.scrollLeft:0,g=s.innerWidth-l.left-c,{wtTable:m}=(e=i.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,C=m.name,y=["master","inline_start"].includes(C)?h:0,v=["master","top","bottom"].includes(C)?f:0,E=o.top===l.top?0:1;let $=o.top-l.top-E-y,O=0;this.hot.isRtl()?O=s.innerWidth-o.left-a-g-1+v:O=o.left-l.left-1-v,["top","top_inline_start_corner"].includes(C)&&($+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(O+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const P=this.hot.hasColHeaders(),I=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),W=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),M=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(P&&I<=0||I===M)&&($+=1),W<=0&&(O+=1);const Y=n.rowsRenderCalculator.startPosition,z=n.columnsRenderCalculator.startPosition,Q=Math.abs(i.inlineStartOverlay.getScrollPosition()),K=i.topOverlay.getScrollPosition(),Z=getScrollbarWidth(this.hot.rootDocument);let ue=r.offsetTop;if(["inline_start","master"].includes(C)&&(ue+=Y-K),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:G,wtTable:j}=i.bottomOverlay.clone;ue+=G.getWorkspaceHeight()-j.getHeight()-Z}let oe=r.offsetLeft;this.hot.isRtl()?(oe>=0?oe=m.getWidth()-r.offsetLeft:oe=Math.abs(oe),oe+=z-Q-a):["top","master","bottom"].includes(C)&&(oe+=z-Q);const ae=s.getComputedStyle(this.TD),pe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",fe=parseInt(ae[pe],10)>0?0:1,ge=parseInt(ae.borderTopWidth,10)>0?0:1,ye=outerWidth(r)+fe,p=outerHeight(r)+ge,_=hasVerticalScrollbar(u)?Z:0,w=hasHorizontalScrollbar(d)?Z:0,x=this.hot.view.maximumVisibleElementWidth(oe)-_+fe,k=Math.max(this.hot.view.maximumVisibleElementHeight(ue)-w+ge,this.hot.stylesHandler.getDefaultRowHeight());return{top:$,start:O,height:p,maxHeight:k,width:ye,maxWidth:x}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}mixin(BaseEditor,hooksRefRegisterer);const command$D={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const i=t._getEditorManager(),n=i.getActiveEditor();n.isInFullEditMode()&&n.state===EDITOR_STATE.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},command$C={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},command$B={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},command$A={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},command$z={name:"editorOpen",callback(t,e,r){const i=t._getEditorManager(),n=t.getSelectedRangeLast(),{highlight:s}=n;if(t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;r.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),stopImmediatePropagation(e))}};function getAllCommands$2(){return[command$E,command$D,command$C,command$B,command$A,command$z]}const command$y={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},command$x={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:i}=t.getSelectedRangeLast(),n=Math.min(i.row+t.countVisibleRows(),t.countRows()-1),s=r.getNearestNotHiddenIndex(n,-1);if(s!==null){const o=t._createCellCoords(s,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.min(o.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(o),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},command$w={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},command$v={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},command$u={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:i,to:n}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(i.col,n.col,r),e.markEndSource()}},command$t={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:i,from:n,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||o){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=n.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},command$s={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:n,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const o=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=n.clone();a.col=i.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(s.row,o)),e.markEndSource()}}},command$r={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:n,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(o,1),l=n.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},command$q={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:n,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=n.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},command$p={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:n,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=n.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},command$o={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:i,from:n,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||o){const a=r.getNearestNotHiddenIndex(0,1),l=n.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},command$n={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:i,to:n}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(i.row,n.row,r),e.markEndSource()}},command$m={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},command$l={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:i}=t.getSelectedRangeLast(),n=Math.max(i.row-t.countVisibleRows(),0),s=r.getNearestNotHiddenIndex(n,1);if(s!==null){const o=t._createCellCoords(s,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.max(o.row-a,0);e.markSource("keyboard"),e.setRangeEnd(o),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function getAllCommands$1(){return[command$y,command$x,command$w,command$v,command$u,command$t,command$s,command$r,command$q,command$p,command$o,command$n,command$m,command$l]}const command$k={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},command$j={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),i=r?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+i;s=s===0?1:s,n===t.countRows()-1?s=1:n+s>t.countRows()&&(s=t.countRows()-n-1),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},command$i={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,i=t.getSettings(),n=t.getSelectedRangeLast(),s=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-s.row,-s.col):r.transformStart(-s.row,-s.col),r.markEndSource()}},command$h={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,i=t.getSettings(),n=t.getSelectedRangeLast(),s=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(s.row,s.col):r.transformStart(s.row,s.col),r.markEndSource()}},command$g={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},command$f={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},command$e={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);i===null&&(i=-1),e.setRangeStart(t._createCellCoords(i,r))}},command$d={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:i}=t,n=parseInt(t.getSettings().fixedRowsBottom,10),s=r.getNearestNotHiddenIndex(t.countRows()-n-1,-1),o=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,o)),e.markEndSource()}},command$c={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},command$b={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),n=t.getSelectedRangeLast().highlight.row,s=r.getNearestNotHiddenIndex(i,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,s)),e.markEndSource()}},command$a={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,i=t.getSelectedRangeLast().highlight.row;let n=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);n===null&&(n=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,n)),e.markEndSource()}},command$9={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:i}=t.getSelectedRangeLast().highlight;let n=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);n===null&&(n=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,n)),e.markEndSource()}},command$8={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);i===null&&(i=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},command$7={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:i}=t,n=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=r.getNearestNotHiddenIndex(n,1),a=i.getNearestNotHiddenIndex(s,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,a)),e.markEndSource()}},command$6={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},command$5={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),i=r?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+i;s=s===0?-1:-s,n===-i?s=-1:n+s<i&&(s=-(n+i)),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function getAllCommands(){return[command$k,command$j,command$i,command$h,command$g,command$f,command$e,command$d,command$c,command$b,command$a,command$9,command$8,command$7,command$6,command$5]}const command$4={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},command$3={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,n=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(r,i),a=t._createCellCoords(n,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const c={};if(e.col>=0){const u=Math.floor(t.countVisibleCols()/2);c.col=Math.max(e.col-u,0)}if(e.row>=0){const u=Math.floor(t.countVisibleRows()/2);c.row=Math.max(e.row-u,0)}t.scrollViewportTo({...c,verticalSnap:"top",horizontalSnap:"start"})}}},command$2={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},command$1={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},command={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:i}=e[e.length-1].highlight.normalize(),n=t.getDataAtCell(r,i),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==i)){const{readOnly:c}=t.getCellMeta(a,l);c||s.set(`${a}x${l}`,[a,l,n])}});t.setDataAtCell(Array.from(s.values()))}},allCommands=[...getAllCommands$2(),...getAllCommands$1(),...getAllCommands(),command$4,command$3,command$2,command$1,command];function createKeyboardShortcutCommandsPool(t){const e={};return allCommands.forEach(r=>{let{name:i,callback:n}=r;e[i]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n(t,...o)}}),e}function shortcutsEditorContext(t){const e=t.getShortcutManager().addContext("editor"),r=createKeyboardShortcutCommandsPool(t),i={group:EDITOR_EDIT_GROUP};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(n,s)=>r.editorCloseAndSaveByEnter(n,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(n,s)=>r.editorCloseAndSaveByEnter(n,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(n,s)=>r.editorCloseAndSave(n,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(n,s)=>r.editorCloseAndSaveByArrowKeys(n,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],i)}function shortcutsGridContext(t){const e=t.getShortcutManager().addContext("grid"),r=createKeyboardShortcutCommandsPool(t),i={runOnlyIf:()=>{const{navigableHeaders:n}=t.getSettings();return isDefined(t.getSelected())&&(n||!n&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:GRID_GROUP};e.addShortcuts([{keys:[["F2"]],callback:n=>r.editorFastOpen(n)},{keys:[["Enter"],["Enter","Shift"]],callback:(n,s)=>r.editorOpen(n,s)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:EDITOR_EDIT_GROUP,runOnlyIf:()=>isDefined(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var n;return!((n=t.getSelectedRangeLast())!==null&&n!==void 0&&n.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var n;return(n=t.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var n,s;return!((n=t.getSelectedRangeLast())!==null&&n!==void 0&&n.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:n=>r.moveCellSelectionInlineStart(n)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:n=>r.moveCellSelectionInlineEnd(n)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],i)}function registerAllShortcutContexts(t){[shortcutsGridContext,shortcutsEditorContext].forEach(e=>e(t))}function installFocusDetector(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,i=createInputElement(t),n=createInputElement(t);return i.addEventListener("focus",()=>e?.onFocusFromTop()),n.addEventListener("focus",()=>e?.onFocusFromBottom()),r.before(i),r.after(n),{activate(){t._registerTimeout(()=>{i.tabIndex=0,n.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,n.tabIndex=-1},10)}}}function createInputElement(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&setAttribute(r,[A11Y_LABEL("Focus catcher")]),r}function installFocusCatcher(t){const e=normalizeCoordsIfNeeded(t);let r;const{activate:i,deactivate:n}=installFocusDetector(t,{onFocusFromTop(){var d;const h=(d=e(r))!==null&&d!==void 0?d:getMostTopStartPosition(t);h&&(t.runHooks("modifyFocusOnTabNavigation","from_above",h),t.selectCell(h.row,h.col)),t.listen()},onFocusFromBottom(){var d;const h=(d=e(r))!==null&&d!==void 0?d:getMostBottomEndPosition(t);h&&(t.runHooks("modifyFocusOnTabNavigation","from_below",h),t.selectCell(h.row,h.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;t.addHook("afterListen",()=>n()),t.addHook("afterUnlisten",()=>i()),t.addHook("afterSelection",(d,h,f,g,m)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,m.value=!0),o){var C;r=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(d,h,f)=>{s.wrapped=!0,s.flipped=f});function c(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const u={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:GRID_GROUP,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...u,callback:()=>{const{tabNavigation:d}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!d&&(o=!1),d||(l=!0)},position:"before"},{...u,callback:d=>{const{tabNavigation:h,autoWrapRow:f}=t.getSettings();if(a=!1,o=!0,!h||!t.selection.isSelected()||f&&s.wrapped&&s.flipped||!f&&s.wrapped)return f&&s.wrapped&&s.flipped&&(r=d.shiftKey?getMostTopStartPosition(t):getMostBottomEndPosition(t)),c(),!1;d.preventDefault()},position:"after"}])}function getMostTopStartPosition(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:i}=t.getSettings();let n=i&&t.countColHeaders()>0?-t.countColHeaders():0,s=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return n===0&&(n=e.getVisualFromRenderableIndex(n)),s===0&&(s=r.getVisualFromRenderableIndex(s)),n===null||s===null?null:t._createCellCoords(n,s)}function getMostBottomEndPosition(t){var e,r;const{rowIndexMapper:i,columnIndexMapper:n}=t,{navigableHeaders:s}=t.getSettings();let o=i.getRenderableIndexesLength()-1,a=n.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(r=n.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function normalizeCoordsIfNeeded(t){return e=>{if(!e)return null;const r=getMostTopStartPosition(t),i=getMostBottomEndPosition(t);return e.col<r.col&&(e.col=r.col),e.col>i.col&&(e.col=i.col),e.row<r.row&&(e.row=r.row),e.row>i.row&&(e.row=i.row),e}}function scrollWindowToCell(t){isHTMLElement(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function createScrollTargetCalculator(t){const{selection:e,view:r}=t,i=t.getSelectedRangeLast(),n=e.getSelectionSource(),s=r.getFirstFullyVisibleColumn(),o=r.getLastFullyVisibleColumn(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,c=a<=s,u=l>=o,d=r.getFirstFullyVisibleRow(),h=r.getLastFullyVisibleRow(),f=i.getTopStartCorner().row,g=i.getBottomEndCorner().row,m=f<=d,C=g>=h;return{getComputedColumnTarget(y){return n==="mouse"||n==="keyboard"?y.col:c&&u?i.highlight.col:c?a:u?l:y.col},getComputedRowTarget(y){return n==="mouse"||n==="keyboard"?y.row:m&&C?i.highlight.row:m?f:C?g:y.row}}}function columnHeaderScrollStrategy(t){return e=>{const r=createScrollTargetCalculator(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const i=!!t.getSettings().colHeaders;scrollWindowToCell(t.getCell(i?-1:0,r,!0))})}}function cornerHeaderScrollStrategy(){return()=>{}}function focusScrollStrategy(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:r,col:i}=t.getSelectedRangeLast().highlight;scrollWindowToCell(t.getCell(r,i,!0))})}}function multipleScrollStrategy(t){return e=>{const r=createScrollTargetCalculator(t),i={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:n,col:s}=i;scrollWindowToCell(t.getCell(n,s,!0))})}}function noncontiguousScrollStrategy(t){return e=>{const r=createScrollTargetCalculator(t),i={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:n,col:s}=i;scrollWindowToCell(t.getCell(n,s,!0))})}}function rowHeaderScrollStrategy(t){return e=>{const r=createScrollTargetCalculator(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const i=!!t.getSettings().rowHeaders;scrollWindowToCell(t.getCell(r,i?-1:0,!0))})}}function singleScrollStrategy(t){return e=>{const r=t.selection.getSelectionSource(),{row:i,col:n}=e,s=()=>{scrollWindowToCell(t.getCell(i,n,!0))};if(i<0&&n>=0)t.scrollViewportTo({col:n},s);else if(n<0&&i>=0)t.scrollViewportTo({row:i},s);else{if(r==="mouse"&&(n===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:n},s)}}}function createViewportScroller(t){const{selection:e}=t;let r=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){r=!0},scrollTo(n){var s;if(r||i){r=!1;return}let o;e.isFocusSelectionChanged()?o=focusScrollStrategy(t):e.isSelectedByCorner()?o=cornerHeaderScrollStrategy():e.isSelectedByRowHeader()?o=rowHeaderScrollStrategy(t):e.isSelectedByColumnHeader()?o=columnHeaderScrollStrategy(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=multipleScrollStrategy(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=singleScrollStrategy(t):e.getSelectedRange().size()>1&&(o=noncontiguousScrollStrategy(t)),(s=o)===null||s===void 0||s(n)}}}const mappings=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),normalizeKeys=t=>t.map(e=>{const r=e.toLowerCase();return mappings.has(r)?mappings.get(r):r}).sort().join("+"),getKeysList=t=>t.split("+"),specialCharactersSet=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),normalizeEventKey=t=>{let{which:e,key:r}=t;if(specialCharactersSet.has(e))return specialCharactersSet.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:r.toLowerCase()},__kindOf=Symbol("shortcut-context");function isContextObject(t){return isObject(t)&&t.__kindOf===__kindOf}const createContext=t=>{const e=createUniqueMap({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:c,group:u,runOnlyIf:d=()=>!0,captureCtrl:h=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:m,position:C,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(isUndefined(u))throw new Error("You need to define the shortcut's group.");if(isFunction(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(toSingleLine`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const v={callback:c,group:u,runOnlyIf:d,captureCtrl:h,preventDefault:f,stopPropagation:g};isDefined(m)&&(v.relativeToGroup=m,v.position=C),isContextObject(y)&&(v.forwardToContext=y),l.forEach(E=>{const $=normalizeKeys(E);if(e.hasItem($)){const P=e.getItem($);let I=P.findIndex(W=>W.group===m);I!==-1?C==="before"?I-=1:I+=1:I=P.length,P.splice(I,0,v)}else e.addItem($,[v])})},i=function(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(u=>{objectEach(c,(d,h)=>{Object.prototype.hasOwnProperty.call(u,h)===!1&&(u[h]=c[h])}),r(u)})},n=l=>{const c=normalizeKeys(l);e.removeItem(c)};return{__kindOf,addShortcut:r,addShortcuts:i,getShortcuts:l=>{const c=normalizeKeys(l),u=e.getItem(c);return isDefined(u)?u.slice():[]},hasShortcut:l=>{const c=normalizeKeys(l);return e.hasItem(c)},removeShortcutsByKeys:n,removeShortcutsByGroup:l=>{e.getItems().forEach(u=>{let[d,h]=u;const f=h.filter(g=>g.group!==l);f.length===0?n(getKeysList(d)):(h.length=0,h.push(...f))})}}};function createKeysObserver(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const MODIFIER_KEYS=["meta","alt","shift","control"],modifierKeysObserver=createKeysObserver(),modKeyListeners=[];let instanceCounter=0;function useRecorder(t,e,r,i,n){const s=f=>MODIFIER_KEYS.includes(f),o=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=[];return f.altKey&&m.push("alt"),g&&(f.ctrlKey||f.metaKey)?m.push("control/meta"):(f.ctrlKey&&m.push("control"),f.metaKey&&m.push("meta")),f.shiftKey&&m.push("shift"),m},a=f=>{if(e(f)===!1||r(f)===!1||f.keyCode===229||typeof f.key!="string"||isImmediatePropagationStopped(f))return;const m=normalizeEventKey(f);let C=[];s(m)||(C=o(f));const y=[m].concat(C);!n(f,y)&&(isMacOS()&&C.includes("meta")||!isMacOS()&&C.includes("control"))&&n(f,[m].concat(o(f,!0))),i(f)},l=f=>{if(typeof f.key=="string"){const g=normalizeEventKey(f);s(g)&&modifierKeysObserver.press(g)}},c=f=>{if(typeof f.key=="string"){const g=normalizeEventKey(f);s(g)&&modifierKeysObserver.release(g)}},u=()=>{modifierKeysObserver.releaseAll()};return{mount:()=>{let f=t;for(instanceCounter+=1;f;)instanceCounter===1&&(f.document.documentElement.addEventListener("keydown",l),modKeyListeners.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",c),modKeyListeners.push({event:"keyup",listener:c})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",u),f=getParentWindow(f)},unmount:()=>{let f=t;for(instanceCounter-=1;f;){if(instanceCounter===0){for(let g=0;g<modKeyListeners.length;g++){const{event:m,listener:C}=modKeyListeners[g];f.document.documentElement.removeEventListener(m,C)}modKeyListeners.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",u),f=getParentWindow(f)}},isPressed:f=>modifierKeysObserver.isPressed(f),releasePressedKeys:()=>modifierKeysObserver.releaseAll()}}const createShortcutManager=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:i,afterKeyDown:n}=t;const s=createUniqueMap({errorIdExists:g=>`The "${g}" context name is already registered.`});let o="grid";const a=g=>{const m=createContext(g);return s.addItem(g,m),m},l=()=>o,c=g=>s.getItem(g),u=g=>{if(!s.hasItem(g))throw new Error(toSingleLine`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=g};let d=!1;const h=function(g,m){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=isContextObject(C)?C:c(C);let v=!1;if(!y.hasShortcut(m))return v;const E=y.getShortcuts(m);for(let $=0;$<E.length;$++){const{callback:O,runOnlyIf:P,preventDefault:I,stopPropagation:W,captureCtrl:q,forwardToContext:M}=E[$];if(P(g)===!0){if(d=q,v=O(g,m)===!1,d=!1,I&&g.preventDefault(),W&&(stopImmediatePropagation(g),g.stopPropagation()),v)break;M&&h(g,m,M)}}return v},f=useRecorder(e,r,i,n,h);return f.mount(),{addContext:a,getActiveContextName:l,getContext:c,setActiveContextName:u,isCtrlPressed:()=>!d&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function getThemeClassName(t){const{classNames:e}=findFirstParentWithClass(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function _classPrivateMethodInitSpec$M(t,e){_checkPrivateRedeclaration$Z(t,e),e.add(t)}function _classPrivateFieldInitSpec$G(t,e,r){_checkPrivateRedeclaration$Z(t,e),e.set(t,r)}function _checkPrivateRedeclaration$Z(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$G(t,e){return t.get(_assertClassBrand$Z(t,e))}function _classPrivateFieldSet$D(t,e,r){return t.set(_assertClassBrand$Z(t,e),r),r}function _assertClassBrand$Z(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const CLASSIC_THEME_DEFAULT_HEIGHT=23;var _themeName=new WeakMap,_rootElement=new WeakMap,_rootComputedStyle=new WeakMap,_rootDocument$1=new WeakMap,_isClassicTheme=new WeakMap,_cssVars=new WeakMap,_computedStyles=new WeakMap,_StylesHandler_brand=new WeakSet;class StylesHandler{constructor(e,r){_classPrivateMethodInitSpec$M(this,_StylesHandler_brand),_classPrivateFieldInitSpec$G(this,_themeName,void 0),_classPrivateFieldInitSpec$G(this,_rootElement,void 0),_classPrivateFieldInitSpec$G(this,_rootComputedStyle,void 0),_classPrivateFieldInitSpec$G(this,_rootDocument$1,void 0),_classPrivateFieldInitSpec$G(this,_isClassicTheme,!0),_classPrivateFieldInitSpec$G(this,_cssVars,{}),_classPrivateFieldInitSpec$G(this,_computedStyles,{}),_classPrivateFieldSet$D(_rootElement,this,e),_classPrivateFieldSet$D(_rootDocument$1,this,r)}isClassicTheme(){return _classPrivateFieldGet$G(_isClassicTheme,this)}getCSSVariableValue(e){var r;if(_classPrivateFieldGet$G(_isClassicTheme,this))return null;if(_classPrivateFieldGet$G(_cssVars,this)[`--ht-${e}`])return _classPrivateFieldGet$G(_cssVars,this)[`--ht-${e}`];const i=(r=_assertClassBrand$Z(_StylesHandler_brand,this,_getParsedNumericCSSValue).call(this,`--ht-${e}`))!==null&&r!==void 0?r:_assertClassBrand$Z(_StylesHandler_brand,this,_getCSSValue).call(this,`--ht-${e}`);if(i!==null)return _classPrivateFieldGet$G(_cssVars,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var r;return(r=_classPrivateFieldGet$G(_computedStyles,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(_classPrivateFieldGet$G(_isClassicTheme,this))return CLASSIC_THEME_DEFAULT_HEIGHT;const e=_assertClassBrand$Z(_StylesHandler_brand,this,_calculateRowHeight).call(this);return e||CLASSIC_THEME_DEFAULT_HEIGHT}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){_classPrivateFieldSet$D(_themeName,this,void 0),_classPrivateFieldSet$D(_isClassicTheme,this,!0),_assertClassBrand$Z(_StylesHandler_brand,this,_cacheStylesheetValues).call(this);return}if(e&&e!==_classPrivateFieldGet$G(_themeName,this)){if(!/ht-theme-.*/.test(e)){warn(`Invalid theme name: ${e}. Please provide a valid theme name.`),_classPrivateFieldSet$D(_themeName,this,void 0),_classPrivateFieldSet$D(_isClassicTheme,this,!1),_assertClassBrand$Z(_StylesHandler_brand,this,_cacheStylesheetValues).call(this);return}_classPrivateFieldGet$G(_themeName,this)&&_assertClassBrand$Z(_StylesHandler_brand,this,_clearCachedValues).call(this),_classPrivateFieldSet$D(_themeName,this,e),_classPrivateFieldSet$D(_isClassicTheme,this,!1),_assertClassBrand$Z(_StylesHandler_brand,this,_cacheStylesheetValues).call(this)}}getThemeName(){return _classPrivateFieldGet$G(_themeName,this)}}function _calculateRowHeight(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function _cacheStylesheetValues(){this.isClassicTheme()||_classPrivateFieldSet$D(_rootComputedStyle,this,getComputedStyle(_classPrivateFieldGet$G(_rootElement,this)));const t=_assertClassBrand$Z(_StylesHandler_brand,this,_getStylesForTD).call(this,["box-sizing","border-bottom-width"]);_classPrivateFieldGet$G(_computedStyles,this).td={..._classPrivateFieldGet$G(_computedStyles,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function _getStylesForTD(t){const e=_classPrivateFieldGet$G(_rootDocument$1,this),r=_classPrivateFieldGet$G(_rootElement,this),i=e.createElement("table"),n=e.createElement("tbody"),s=e.createElement("tr"),o=e.createElement("tr"),a=e.createElement("td");o.appendChild(a),n.appendChild(s),n.appendChild(o),i.appendChild(n),r.appendChild(i);const l=getComputedStyle(a),c={};return t.forEach(u=>{c[u]=l.getPropertyValue(u)}),r.removeChild(i),c}function _getParsedNumericCSSValue(t){const e=Math.ceil(parseFloat(_assertClassBrand$Z(_StylesHandler_brand,this,_getCSSValue).call(this,t)));return Number.isNaN(e)?null:e}function _getCSSValue(t){const e=_classPrivateFieldGet$G(_rootComputedStyle,this).getPropertyValue(t);return e===""?null:e}function _clearCachedValues(){_classPrivateFieldSet$D(_computedStyles,this,{}),_classPrivateFieldSet$D(_cssVars,this,{}),_classPrivateFieldSet$D(_isClassicTheme,this,!0)}function _classPrivateMethodInitSpec$L(t,e){_checkPrivateRedeclaration$Y(t,e),e.add(t)}function _classPrivateFieldInitSpec$F(t,e,r){_checkPrivateRedeclaration$Y(t,e),e.set(t,r)}function _checkPrivateRedeclaration$Y(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$F(t,e){return t.get(_assertClassBrand$Y(t,e))}function _classPrivateFieldSet$C(t,e,r){return t.set(_assertClassBrand$Y(t,e),r),r}function _assertClassBrand$Y(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _rowIndexMapper$1=new WeakMap,_columnIndexMapper$1=new WeakMap,_CellRangeToRenderableMapper_brand=new WeakSet;class CellRangeToRenderableMapper{constructor(e){let{rowIndexMapper:r,columnIndexMapper:i}=e;_classPrivateMethodInitSpec$L(this,_CellRangeToRenderableMapper_brand),_classPrivateFieldInitSpec$F(this,_rowIndexMapper$1,void 0),_classPrivateFieldInitSpec$F(this,_columnIndexMapper$1,void 0),_classPrivateFieldSet$C(_rowIndexMapper$1,this,r),_classPrivateFieldSet$C(_columnIndexMapper$1,this,i)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,n=_assertClassBrand$Y(_CellRangeToRenderableMapper_brand,this,_getNearestNotHiddenCoords).call(this,e.from,r,i);if(n===null)return null;const s=_assertClassBrand$Y(_CellRangeToRenderableMapper_brand,this,_getNearestNotHiddenCoords).call(this,e.to,-r,-i);if(s===null)return null;const o=e.clone();return o.from=n,o.to=s,o.includes(e.highlight)||(o.highlight=n),o}}function _getNearestNotHiddenCoords(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const i=_assertClassBrand$Y(_CellRangeToRenderableMapper_brand,this,_getNearestNotHiddenIndex).call(this,_classPrivateFieldGet$F(_rowIndexMapper$1,this),t.row,e);if(i===null)return null;const n=_assertClassBrand$Y(_CellRangeToRenderableMapper_brand,this,_getNearestNotHiddenIndex).call(this,_classPrivateFieldGet$F(_columnIndexMapper$1,this),t.col,r);return n===null?null:t.clone().assign({row:i,col:n})}function _getNearestNotHiddenIndex(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}let activeGuid=null;const foreignHotInstances=new Map;function Core(t,e){var r,i=this;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new EventManager(s);let a,l,c,u,d,h,f=!0;hasValidParameter(n)&&registerAsRootInstance(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=isRootInstance(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,isRootInstance(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),addClass$1(this.rootElement,"ht-wrapper"),addClass$1(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),addClass$1(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(r=e?.layoutDirection)!==null&&r!==void 0?r:"inherit",m=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return m==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new StylesHandler(s.rootElement,s.rootDocument),e.language=getValidLanguageCode(e.language);const C=Object.fromEntries(Object.entries(e).filter(p=>{let[_]=p;return!(Hooks.getSingleton().isRegistered(_)||Hooks.getSingleton().isDeprecated(_))})),y=new MetaManager(s,C,[DynamicCellMetaMod,ExtendMetaPropertiesMod]),v=y.getTableMeta(),E=y.getGlobalMeta(),$=createUniqueMap();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),isRootInstance(this)&&_injectProductInfo(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${randomString()}`,foreignHotInstances.set(this.guid,this),this.columnIndexMapper=new IndexMapper,this.rowIndexMapper=new IndexMapper,this.columnIndexMapper.addLocalHook("indexesSequenceChange",p=>{s.runHooks("afterColumnSequenceChange",p)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",p=>{s.runHooks("afterRowSequenceChange",p)}),o.addEventListener(this.rootDocument.documentElement,"compositionstart",p=>{s.runHooks("beforeCompositionStart",p)}),l=new DataSource(s);const O=staticRegister(this.guid);O.register("cellRangeMapper",new CellRangeToRenderableMapper({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const P=p=>{const{row:_,col:w}=p;return s._createCellCoords(_>=0?s.rowIndexMapper.getRenderableFromVisualIndex(_):_,w>=0?s.columnIndexMapper.getRenderableFromVisualIndex(w):w)},I=p=>{const{row:_,col:w}=p;return s._createCellCoords(_>=0?s.rowIndexMapper.getVisualFromRenderableIndex(_):_,w>=0?s.columnIndexMapper.getVisualFromRenderableIndex(w):w)},W=(p,_)=>{const w=_>p?1:-1,x=Math.min(p,_),k=Math.max(p,_),G=s.rowIndexMapper.getNearestNotHiddenIndex(p,w);return G===null||w===1&&G>k||w===-1&&G<x?null:G>=0?s.rowIndexMapper.getRenderableFromVisualIndex(G):G},q=(p,_)=>{const w=_>p?1:-1,x=Math.min(p,_),k=Math.max(p,_),G=s.columnIndexMapper.getNearestNotHiddenIndex(p,w);return G===null||w===1&&G>k||w===-1&&G<x?null:G>=0?s.columnIndexMapper.getRenderableFromVisualIndex(G):G};let M=new Selection(v,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:p=>a.propToCol(p),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(p,_)=>s._createCellCoords(p,_),createCellRange:(p,_,w)=>s._createCellRange(p,_,w),visualToRenderableCoords:P,renderableToVisualCoords:I,findFirstNonHiddenRenderableRow:W,findFirstNonHiddenRenderableColumn:q,isDisabledCellSelection:(p,_)=>p<0||_<0?s.getSettings().disableVisualSelection:s.getCellMeta(p,_).disableVisualSelection});this.selection=M;const Y=p=>{let{hiddenIndexesChanged:_}=p;this.forceFullRender=!0,_&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Y),this.rowIndexMapper.addLocalHook("cacheUpdated",Y),this.selection.addLocalHook("afterSetRangeEnd",(p,_)=>{const w=createObjectPropListener(!1),x=this.selection.getSelectedRange(),{from:k,to:G}=x.current(),j=x.size()-1;this.runHooks("afterSelection",k.row,k.col,G.row,G.col,w,j),this.runHooks("afterSelectionByProp",k.row,s.colToProp(k.col),G.row,s.colToProp(G.col),w,j),_&&(!w.isTouched()||w.isTouched()&&!w.value)&&h.scrollTo(p);const S=M.isSelectedByRowHeader(),b=M.isSelectedByColumnHeader();S&&b?addClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]):S?(removeClass$1(this.rootElement,"ht__selection--columns"),addClass$1(this.rootElement,"ht__selection--rows")):b?(removeClass$1(this.rootElement,"ht__selection--rows"),addClass$1(this.rootElement,"ht__selection--columns")):removeClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(M.getSelectionSource())||u.closeEditor(null),M.getSelectionSource()!=="refresh"&&(s.view.render(),u.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",p=>{this.runHooks("beforeSelectionFocusSet",p.row,p.col)}),this.selection.addLocalHook("afterSetFocus",p=>{const _=createObjectPropListener(!1);this.runHooks("afterSelectionFocusSet",p.row,p.col,_),(!_.isTouched()||_.isTouched()&&!_.value)&&h.scrollTo(p),u.closeEditor(),s.view.render(),u.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",p=>{const _=p.length-1,{from:w,to:x}=p[_];this.runHooks("afterSelectionEnd",w.row,w.col,x.row,x.col,_),this.runHooks("afterSelectionEndByProp",w.row,s.colToProp(w.col),x.row,s.colToProp(x.col),_),M.getSelectionSource()==="refresh"&&(s.view.render(),u.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",p=>{const _=this.runHooks("afterIsMultipleSelection",p.value);p.value&&(p.value=_)}),this.selection.addLocalHook("afterDeselect",()=>{u.closeEditor(),s.view.render(),removeClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("beforeSetRangeStart",..._)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("beforeSetRangeStartOnly",..._)}).addLocalHook("beforeSetRangeEnd",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("beforeSetRangeEnd",..._)}).addLocalHook("beforeSelectColumns",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("beforeSelectColumns",..._)}).addLocalHook("afterSelectColumns",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("afterSelectColumns",..._)}).addLocalHook("beforeSelectRows",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("beforeSelectRows",..._)}).addLocalHook("afterSelectRows",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("afterSelectRows",..._)}).addLocalHook("beforeModifyTransformStart",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("modifyTransformStart",..._)}).addLocalHook("afterModifyTransformStart",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("afterModifyTransformStart",..._)}).addLocalHook("beforeModifyTransformFocus",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("modifyTransformFocus",..._)}).addLocalHook("afterModifyTransformFocus",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("afterModifyTransformFocus",..._)}).addLocalHook("beforeModifyTransformEnd",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("modifyTransformEnd",..._)}).addLocalHook("afterModifyTransformEnd",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("afterModifyTransformEnd",..._)}).addLocalHook("beforeRowWrap",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("beforeRowWrap",..._)}).addLocalHook("beforeColumnWrap",function(){for(var p=arguments.length,_=new Array(p),w=0;w<p;w++)_[w]=arguments[w];return i.runHooks("beforeColumnWrap",..._)}).addLocalHook("insertRowRequire",p=>this.alter("insert_row_above",p,1,"auto")).addLocalHook("insertColRequire",p=>this.alter("insert_col_start",p,1,"auto")),c={alter(p,_){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=arguments.length>3?arguments[3]:void 0,k=arguments.length>4?arguments[4]:void 0;const G=j=>{if(j.length===0)return[];const S=[...j];return S.sort((R,T)=>{let[A]=R,[D]=T;return A===D?0:A>D?1:-1}),arrayReduce(S,(R,T)=>{let[A,D]=T;const B=R[R.length-1],[N,H]=B,L=N+H;if(A<=L){const U=Math.max(D-(L-A),0);B[1]+=U}else R.push([A,D]);return R},[S[0]])};switch(p){case"insert_row_below":case"insert_row_above":const j=s.countSourceRows();if(v.maxRows===j)return;const S=p==="insert_row_below"?"below":"above";_=_??(S==="below"?j:0);const{delta:b,startPhysicalIndex:R}=a.createRow(_,w,{source:x,mode:S});M.shiftRows(s.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const T=p==="insert_col_end"?"end":"start";_=_??(T==="end"?s.countSourceCols():0);const{delta:A,startPhysicalIndex:D}=a.createCol(_,w,{source:x,mode:T});if(A){if(Array.isArray(v.colHeaders)){const H=[s.toVisualColumn(D),0];H.length+=A,Array.prototype.splice.apply(v.colHeaders,H)}M.shiftColumns(s.toVisualColumn(D),A)}break;case"remove_row":const B=H=>{let L=0;arrayEach(H,U=>{let[V,J]=U;const ee=isEmpty(V)?s.countRows()-1:Math.max(V-L,0);if(Number.isInteger(V)&&(V=Math.max(V-L,0)),!a.removeRow(V,J,x))return;if(M.isSelected()){const{row:ie}=s.getSelectedRangeLast().highlight;ie>=V&&ie<=V+J-1&&u.closeEditor(!0)}const le=s.countRows(),ce=v.fixedRowsTop;ce>=ee+1&&(v.fixedRowsTop-=Math.min(J,ce-ee));const se=v.fixedRowsBottom;if(se&&ee>=le-se&&(v.fixedRowsBottom-=Math.min(J,se)),le===0)M.deselect();else if(x==="ContextMenu.removeRow"){const ie=M.getSelectedRange(),he=ie.pop();ie.clear().set(he.from).current().setTo(he.to),M.refresh()}else M.shiftRows(V,-J);L+=J})};Array.isArray(_)?B(G(_)):B([[_,w]]);break;case"remove_col":const N=H=>{let L=0;arrayEach(H,U=>{let[V,J]=U;const ee=isEmpty(V)?s.countCols()-1:Math.max(V-L,0);let ne=s.toPhysicalColumn(ee);if(Number.isInteger(V)&&(V=Math.max(V-L,0)),!a.removeCol(V,J,x))return;if(M.isSelected()){const{col:ie}=s.getSelectedRangeLast().highlight;ie>=V&&ie<=V+J-1&&u.closeEditor(!0)}if(s.countCols()===0)M.deselect();else if(x==="ContextMenu.removeColumn"){const ie=M.getSelectedRange(),he=ie.pop();ie.clear().set(he.from).current().setTo(he.to),M.refresh()}else M.shiftColumns(V,-J);const se=v.fixedColumnsStart;se>=ee+1&&(v.fixedColumnsStart-=Math.min(J,se-ee)),Array.isArray(v.colHeaders)&&(typeof ne>"u"&&(ne=-1),v.colHeaders.splice(ne,J)),L+=J})};Array.isArray(_)?N(G(_)):N([[_,w]]);break;default:throw new Error(`There is no such action "${p}"`)}k||c.adjustRowsAndCols(),s.view.render(),s.view.adjustElementsSize()},adjustRowsAndCols(){const p=v.minRows,_=v.minSpareRows,w=v.minCols,x=v.minSpareCols;if(p){const k=s.countRows();k<p&&a.createRow(k,p-k,{source:"auto"})}if(_){const k=s.countEmptyRows(!0);if(k<_){const G=_-k,j=Math.min(G,v.maxRows-s.countSourceRows());a.createRow(s.countRows(),j,{source:"auto"})}}{let k;(w||x)&&(k=s.countEmptyCols(!0));let G=s.countCols();if(w&&!v.columns&&G<w){const j=w-G;k+=j,a.createCol(G,j,{source:"auto"})}if(x&&!v.columns&&s.dataType==="array"&&k<x){G=s.countCols();const j=x-k,S=Math.min(j,v.maxCols-G);a.createCol(G,S,{source:"auto"})}}},populateFromArray(p,_,w,x,k){let G,j,S,b;const R=[],T={},A=[],D=p.row,B=p.col;if(j=_.length,j===0)return!1;let N=0,H=0;switch(isObject(w)&&(N=w.col-B+1,H=w.row-D+1),k){case"shift_down":const L=pivot(_),U=L.length,V=Math.max(U,N),J=s.getData().slice(D),ee=pivot(J).slice(B,B+V);for(S=0;S<V;S+=1)if(S<U){for(G=0,j=L[S].length;G<H-j;G+=1)L[S].push(L[S][G%j]);S<ee.length?A.push(L[S].concat(ee[S])):A.push(L[S].concat(new Array(J.length).fill(null)))}else A.push(L[S%U].concat(ee[S]));s.populateFromArray(D,B,pivot(A));break;case"shift_right":const ne=_.length,le=Math.max(ne,H),ce=s.getData().slice(D).map(_e=>_e.slice(B));for(G=0;G<le;G+=1)if(G<ne){for(S=0,b=_[G].length;S<N-b;S+=1)_[G].push(_[G][S%b]);if(G<ce.length)for(let _e=0;_e<ce[G].length;_e+=1)_[G].push(ce[G][_e]);else _[G].push(...new Array(ce[0].length).fill(null))}else _.push(_[G%j].slice(0,le).concat(ce[G]));s.populateFromArray(D,B,_);break;case"overwrite":default:T.row=p.row,T.col=p.col;let se=0,ie=0,he=!0,Te;const Ae=function(ve){let me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const de=_[ve%_.length];return me!==null?de[me%de.length]:de},Oe=_.length,Se=w?w.row-p.row+1:0;for(w?j=Se:j=Math.max(Oe,Se),G=0;G<j&&!(w&&T.row>w.row&&Se>Oe||!v.allowInsertRow&&T.row>s.countRows()-1||T.row>=v.maxRows);G++){const _e=G-se,ve=Ae(_e).length,me=w?w.col-p.col+1:0;if(w?b=me:b=Math.max(ve,me),T.col=p.col,Te=s.getCellMeta(T.row,T.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&Te.skipRowOnPaste){se+=1,T.row+=1,j+=1;continue}for(ie=0,S=0;S<b&&!(w&&T.col>w.col&&me>ve||!v.allowInsertColumn&&T.col>s.countCols()-1||T.col>=v.maxCols);S++){if(Te=s.getCellMeta(T.row,T.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&Te.skipColumnOnPaste){ie+=1,T.col+=1,b+=1;continue}if(Te.readOnly&&x!=="UndoRedo.undo"){T.col+=1;continue}const de=S-ie;let $e=Ae(_e,de),Pe=s.getDataAtCell(T.row,T.col);if($e!==null&&typeof $e=="object")if(Array.isArray($e)&&Pe===null&&(Pe=[]),Pe===null||typeof Pe!="object")he=!1;else{const Fe=duckSchema(Array.isArray(Pe)?Pe:Pe[0]||Pe),Be=duckSchema(Array.isArray($e)?$e:$e[0]||$e);isObjectEqual(Fe,Be)||Array.isArray(Fe)&&Array.isArray(Be)?$e=deepClone($e):he=!1}else Pe!==null&&typeof Pe=="object"&&(he=!1);he&&R.push([T.row,T.col,$e]),he=!0,T.col+=1}T.row+=1}s.setDataAtCell(R,null,null,x||"populateFromArray");break}}};function z(p){const _=normalizeLanguageCode(p);hasLanguageDictionary(_)?(s.runHooks("beforeLanguageChange",_),E.language=_,s.runHooks("afterLanguageChange",_)):warnUserAboutLanguageRegistration(p)}function Q(p,_){const w=p==="className"?s.rootElement:s.table;if(f)addClass$1(w,_);else{let x=[],k=[];E[p]&&(x=Array.isArray(E[p])?E[p]:stringToArray(E[p])),_&&(k=Array.isArray(_)?_:stringToArray(_));const G=getDifferenceOfArrays(x,k),j=getDifferenceOfArrays(k,x);G.length&&removeClass$1(w,G),j.length&&addClass$1(w,j)}E[p]=_}this.init=function(){l.setData(v.data),s.runHooks("beforeInit"),(isMobileBrowser()||isIpadOS())&&addClass$1(s.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new TableView(this);const p=v.themeName||getThemeClassName(s.rootContainer);s.useTheme(p),u=EditorManager.getInstance(s,v,M),h=createViewportScroller(s),d=new FocusManager(s),isRootInstance(this)&&installFocusCatcher(s),s.runHooks("init"),this.render(),f&&s.rootElement.offsetParent===null&&observeVisibilityChangeOnce(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function K(){let p=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,p=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&p===!1&&(p=!0,this.onQueueEmpty(this.valid))}}}function Z(p){const _=p.replace(",",".");return isNaN(parseFloat(_))===!1?parseFloat(_):p}function ue(p,_,w){if(!p.length){w();return}const x=s.getActiveEditor(),k=new K;let G=!0;k.onQueueEmpty=()=>{x&&G&&x.cancelChanges(),w()};for(let j=p.length-1;j>=0;j--){const[S,b]=p[j],R=a.propToCol(b);let T;Number.isInteger(R)?T=s.getCellMeta(S,R):T={...Object.getPrototypeOf(v),...v},s.getCellValidator(T)&&(k.addValidatorToQueue(),s.validateCell(p[j][3],T,function(A,D){return function(B){if(typeof B!="boolean")throw new Error("Validation error: result is not boolean");B===!1&&D.allowInvalid===!1&&(G=!1,p.splice(A,1),D.valid=!0),k.removeValidatorFormQueue()}}(j,T),_))}k.checkIfQueueIsEmpty()}function oe(p,_){for(let x=p.length-1;x>=0;x--){let k=!1;if(p[x]===null){p.splice(x,1);continue}if(!((p[x][2]===null||p[x][2]===void 0)&&(p[x][3]===null||p[x][3]===void 0))){if(v.allowInsertRow)for(;p[x][0]>s.countRows()-1;){const{delta:G}=a.createRow(void 0,void 0,{source:"auto"});if(G===0){k=!0;break}}if(s.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;a.propToCol(p[x][1])>s.countCols()-1;){const{delta:G}=a.createCol(void 0,void 0,{source:"auto"});if(G===0){k=!0;break}}k||a.set(p[x][0],p[x][1],p[x][3])}}if(p.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",p,_),u.closeEditor(),s.render(),u.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",p,_||"edit");const x=s.getActiveEditor();x&&isDefined(x.refreshValue)&&x.refreshValue()}else s.render()}this._createCellCoords=function(p,_){return s.view._wt.createCellCoords(p,_)},this._createCellRange=function(p,_,w){return s.view._wt.createCellRange(p,_,w)},this.validateCell=function(p,_,w,x){let k=s.getCellValidator(_);function G(j){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||_.hidden===!0){w(j);return}const b=_.visualCol,R=_.visualRow,T=s.getCell(R,b,!0);if(T&&T.nodeName!=="TH"){const A=s.rowIndexMapper.getRenderableFromVisualIndex(R),D=s.columnIndexMapper.getRenderableFromVisualIndex(b);s.view._wt.getSetting("cellRenderer",A,D,T)}w(j)}isRegExp(k)&&(k=function(j){return function(S,b){b(j.test(S))}}(k)),isFunction(k)?(p=s.runHooks("beforeValidate",p,_.visualRow,_.prop,x),s._registerImmediate(()=>{k.call(_,p,j=>{s&&(j=s.runHooks("afterValidate",j,p,_.visualRow,_.prop,x),_.valid=j,G(j),s.runHooks("postAfterValidate",j,p,_.visualRow,_.prop,x))})})):s._registerImmediate(()=>{_.valid=!0,G(_.valid,!1)})};function ae(p,_,w){return Array.isArray(p)?p:[[p,_,w]]}function pe(p,_){const w=s.runHooks("beforeChange",p,_||"edit"),x=p.filter(G=>G!==null);if(w===!1||x.length===0){var k;return(k=s.getActiveEditor())===null||k===void 0||k.cancelChanges(),[]}for(let G=x.length-1;G>=0;G--){const[j,S,,b]=x[G],R=a.propToCol(S);let T;Number.isInteger(R)?T=s.getCellMeta(j,R):T={...Object.getPrototypeOf(v),...v};const{type:A,checkedTemplate:D,uncheckedTemplate:B}=T;if(A==="numeric"&&typeof b=="string"&&isNumericLike(b)&&(x[G][3]=Z(b)),A==="checkbox"){const N=stringify$1(b),H=N===stringify$1(D),L=N===stringify$1(B);(H||L)&&(x[G][3]=H?D:B)}}return x}this.setDataAtCell=function(p,_,w,x){const k=ae(p,_,w),G=[];let j=x,S,b,R;for(S=0,b=k.length;S<b;S++){if(typeof k[S]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof k[S][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");k[S][1]>=this.countCols()?R=k[S][1]:R=a.colToProp(k[S][1]),G.push([k[S][0],R,l.getAtCell(this.toPhysicalRow(k[S][0]),k[S][1]),k[S][2]])}!j&&typeof p=="object"&&(j=_);const T=pe(G,j);s.runHooks("afterSetDataAtCell",T,j),ue(T,j,()=>{oe(T,j)})},this.setDataAtRowProp=function(p,_,w,x){const k=ae(p,_,w),G=[];let j=x,S,b;for(S=0,b=k.length;S<b;S++)G.push([k[S][0],k[S][1],l.getAtCell(this.toPhysicalRow(k[S][0]),k[S][1]),k[S][2]]);!j&&typeof p=="object"&&(j=_);const R=pe(G,x);s.runHooks("afterSetDataAtRowProp",R,j),ue(R,j,()=>{oe(R,j)})},this.listen=function(){s&&!s.isListening()&&(foreignHotInstances.forEach(p=>{s!==p&&p.unlisten()}),activeGuid=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(activeGuid=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return activeGuid===s.guid},this.destroyEditor=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;u.closeEditor(p),s.view.render(),_&&M.isSelected()&&u.prepareEditor()},this.populateFromArray=function(p,_,w,x,k,G,j){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const S=typeof x=="number"?s._createCellCoords(x,k):null;return c.populateFromArray(s._createCellCoords(p,_),w,S,G,j)},this.spliceCol=function(p,_,w){for(var x=arguments.length,k=new Array(x>3?x-3:0),G=3;G<x;G++)k[G-3]=arguments[G];return a.spliceCol(p,_,w,...k)},this.spliceRow=function(p,_,w){for(var x=arguments.length,k=new Array(x>3?x-3:0),G=3;G<x;G++)k[G-3]=arguments[G];return a.spliceRow(p,_,w,...k)},this.getSelected=function(){if(M.isSelected())return arrayMap(M.getSelectedRange(),p=>{let{from:_,to:w}=p;return[_.row,_.col,w.row,w.col]})},this.getSelectedLast=function(){const p=this.getSelected();let _;return p&&p.length>0&&(_=p[p.length-1]),_},this.getSelectedRange=function(){if(M.isSelected())return Array.from(M.getSelectedRange())},this.getSelectedRangeLast=function(){const p=this.getSelectedRange();let _;return p&&p.length>0&&(_=p[p.length-1]),_},this.emptySelectedCells=function(p){if(!M.isSelected()||this.countRows()===0||this.countCols()===0)return;const _=[];arrayEach(M.getSelectedRange(),w=>{if(w.isSingleHeader())return;const x=w.getTopStartCorner(),k=w.getBottomEndCorner();rangeEach(x.row,k.row,G=>{rangeEach(x.col,k.col,j=>{this.getCellMeta(G,j).readOnly||_.push([G,j,null])})})}),_.length>0&&this.setDataAtCell(_,p)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const p=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(p,0),!this.isRenderSuspended()&&p===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(p){this.suspendRender();const _=p();return this.resumeRender(),_},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const _=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(_,0),(!this.isExecutionSuspended()&&_===this.executionSuspendedCounter||p)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(p){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=p();return this.resumeExecution(_),w},this.batch=function(p){this.suspendRender(),this.suspendExecution();const _=p();return this.resumeExecution(),this.resumeRender(),_},this.refreshDimensions=function(){if(!s.view)return;const p=s.view,{width:_,height:w}=p.getLastSize(),{width:x,height:k}=s.rootElement.getBoundingClientRect(),G=x!==_||k!==w;s.runHooks("beforeRefreshDimensions",{width:_,height:w},{width:x,height:k},G)!==!1&&((G||p._wt.wtOverlays.scrollableElement===s.rootWindow)&&(p.setLastSize(x,k),s.render(),p.adjustElementsSize()),s.runHooks("afterRefreshDimensions",{width:_,height:w},{width:x,height:k},G))},this.updateData=function(p,_){replaceData(p,w=>{a=w},w=>{a=w,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),M.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:_,metaManager:y,firstRun:f})},this.loadData=function(p,_){replaceData(p,w=>{a=w},()=>{y.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),M.refresh(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:_,metaManager:y,firstRun:f})},this.getInitialColumnCount=function(){const p=v.columns;let _=0;if(Array.isArray(p))_=p.length;else if(isFunction(p))if(s.dataType==="array"){const w=this.countSourceCols();for(let x=0;x<w;x+=1)p(x)&&(_+=1)}else(s.dataType==="object"||s.dataType==="function")&&(_=a.colToPropCache.length);else if(isDefined(v.dataSchema)){const w=a.getSchema();_=Array.isArray(w)?w.length:deepObjectSize(w)}else _=this.countSourceCols();return _},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(p,_,w,x){return isUndefined(p)?a.getAll():a.getRange(s._createCellCoords(p,_),s._createCellCoords(w,x),a.DESTINATION_RENDERER)},this.getCopyableText=function(p,_,w,x){return a.getCopyableText(s._createCellCoords(p,_),s._createCellCoords(w,x))},this.getCopyableData=function(p,_){return a.getCopyable(p,a.colToProp(_))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(p){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(f?s.loadData:s.updateData).bind(this);let x=!1,k,G;if(isDefined(p.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(isDefined(p.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(isDefined(p.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');p.language&&z(p.language);for(k in p)if(!(k==="data"||k==="language"))if(k==="className")Q("className",p.className);else if(k==="tableClassName"&&s.table)Q("tableClassName",p.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(Hooks.getSingleton().isRegistered(k)||Hooks.getSingleton().isDeprecated(k)){const T=p[k];isFunction(T)?(Hooks.getSingleton().addAsFixed(k,T,s),v[k]=T):Array.isArray(T)&&(Hooks.getSingleton().add(k,T,s),v[k]=T)}else!_&&hasOwnProperty(p,k)&&(E[k]=p[k]);p.data===void 0&&v.data===void 0?w(null,"updateSettings"):p.data!==void 0?w(p.data,"updateSettings"):p.columns!==void 0&&(a.createMap(),s.initIndexMappers());const j=s.countCols(),S=v.columns;if(S&&isFunction(S)&&(x=!0),(p.cell!==void 0||p.cells!==void 0||p.columns!==void 0)&&y.clearCache(),j>0)for(k=0,G=0;k<j;k++){if(S){const T=x?S(k):S[G];T&&y.updateColumnMeta(G,T)}G+=1}isDefined(p.cell)&&objectEach(p.cell,T=>{s.setCellMetaObject(T.row,T.col,T)}),s.runHooks("afterCellMetaReset");let b=s.rootElement.style.height;b!==""&&(b=parseInt(s.rootElement.style.height,10));let R=p.height;if(isFunction(R)&&(R=R()),_&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),R===null){const T=s.rootElement.getAttribute("data-initialstyle");T&&(T.indexOf("height")>-1||T.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",T):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else R!==void 0&&(s.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,s.rootElement.style.overflow="hidden");if(typeof p.width<"u"){let T=p.width;isFunction(T)&&(T=T()),s.rootElement.style.width=isNaN(T)?`${T}`:`${T}px`}if(!_){if(s.view){s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames();const T=s.getCurrentThemeName();hasOwnProperty(p,"themeName")&&T!==p.themeName&&s.useTheme(p.themeName)}s.runHooks("afterUpdateSettings",p)}c.adjustRowsAndCols(),s.view&&!f&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!_&&s.view&&(b===""||R===""||R===void 0)&&b!==R&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const p=s.getSelectedLast();if(v.getValue){if(isFunction(v.getValue))return v.getValue.call(s);if(p)return s.getData()[p[0][0]][v.getValue]}else if(p)return s.getDataAtCell(p[0],p[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(p,_,w,x,k){c.alter(p,_,w,x,k)},this.getCell=function(p,_){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=_,k=p;if(_>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(_)))return null;x=this.columnIndexMapper.getRenderableFromVisualIndex(_)}if(p>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(p)))return null;k=this.rowIndexMapper.getRenderableFromVisualIndex(p)}return k===null||x===null||k===void 0||x===void 0?null:s.view.getCellAtCoords(s._createCellCoords(k,x),w)},this.getCoords=function(p){const _=this.view._wt.wtTable.getCoords(p);if(_===null)return null;const{row:w,col:x}=_;let k=w,G=x;return w>=0&&(k=this.rowIndexMapper.getVisualFromRenderableIndex(w)),x>=0&&(G=this.columnIndexMapper.getVisualFromRenderableIndex(x)),s._createCellCoords(k,G)},this.colToProp=function(p){return a.colToProp(p)},this.propToCol=function(p){return a.propToCol(p)},this.toVisualRow=p=>this.rowIndexMapper.getVisualFromPhysicalIndex(p),this.toVisualColumn=p=>this.columnIndexMapper.getVisualFromPhysicalIndex(p),this.toPhysicalRow=p=>this.rowIndexMapper.getPhysicalFromVisualIndex(p),this.toPhysicalColumn=p=>this.columnIndexMapper.getPhysicalFromVisualIndex(p),this.getDataAtCell=function(p,_){return a.get(p,a.colToProp(_))},this.getDataAtRowProp=function(p,_){return a.get(p,_)},this.getDataAtCol=function(p){const _=[],w=a.getRange(s._createCellCoords(0,p),s._createCellCoords(v.data.length-1,p),a.DESTINATION_RENDERER);for(let x=0;x<w.length;x+=1)for(let k=0;k<w[x].length;k+=1)_.push(w[x][k]);return _},this.getDataAtProp=function(p){const _=[],w=a.getRange(s._createCellCoords(0,a.propToCol(p)),s._createCellCoords(v.data.length-1,a.propToCol(p)),a.DESTINATION_RENDERER);for(let x=0;x<w.length;x+=1)for(let k=0;k<w[x].length;k+=1)_.push(w[x][k]);return _},this.getSourceData=function(p,_,w,x){let k;return p===void 0?k=l.getData():k=l.getByRange(s._createCellCoords(p,_),s._createCellCoords(w,x)),k},this.getSourceDataArray=function(p,_,w,x){let k;return p===void 0?k=l.getData(!0):k=l.getByRange(s._createCellCoords(p,_),s._createCellCoords(w,x),!0),k},this.getSourceDataAtCol=function(p){return l.getAtColumn(p)},this.setSourceDataAtCell=function(p,_,w,x){const k=ae(p,_,w),G=this.hasHook("afterSetSourceDataAtCell"),j=[];G&&arrayEach(k,b=>{let[R,T,A]=b;j.push([R,T,l.getAtCell(R,T),A])}),arrayEach(k,b=>{let[R,T,A]=b;l.setAtCell(R,T,A)}),G&&this.runHooks("afterSetSourceDataAtCell",j,x),this.render();const S=s.getActiveEditor();S&&isDefined(S.refreshValue)&&S.refreshValue()},this.getSourceDataAtRow=function(p){return l.getAtRow(p)},this.getSourceDataAtCell=function(p,_){return l.getAtCell(p,_)},this.getDataAtRow=function(p){return a.getRange(s._createCellCoords(p,0),s._createCellCoords(p,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(p,_,w,x){const k=p===void 0?[0,0,this.countRows(),this.countCols()]:[p,_,w,x],[G,j]=k;let[,,S,b]=k,R=null,T=null;S===void 0&&(S=G),b===void 0&&(b=j);let A="mixed";return rangeEach(Math.max(Math.min(G,S),0),Math.max(G,S),D=>{let B=!0;return rangeEach(Math.max(Math.min(j,b),0),Math.max(j,b),N=>(T=this.getCellMeta(D,N).type,R?B=R===T:R=T,B)),A=B?T:"mixed",B}),A},this.removeCellMeta=function(p,_,w){const[x,k]=[this.toPhysicalRow(p),this.toPhysicalColumn(_)];let G=y.getCellMetaKeyValue(x,k,w);s.runHooks("beforeRemoveCellMeta",p,_,w,G)!==!1&&(y.removeCellMeta(x,k,w),s.runHooks("afterRemoveCellMeta",p,_,w,G)),G=null},this.spliceCellsMeta=function(p){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,x=new Array(w>2?w-2:0),k=2;k<w;k++)x[k-2]=arguments[k];if(x.length>0&&!Array.isArray(x[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");_>0&&y.removeRow(this.toPhysicalRow(p),_),x.length>0&&arrayEach(x.reverse(),G=>{y.createRow(this.toPhysicalRow(p)),arrayEach(G,(j,S)=>this.setCellMetaObject(p,S,j))}),s.render()},this.setCellMetaObject=function(p,_,w){typeof w=="object"&&objectEach(w,(x,k)=>{this.setCellMeta(p,_,k,x)})},this.setCellMeta=function(p,_,w,x){if(s.runHooks("beforeSetCellMeta",p,_,w,x)===!1)return;let G=p,j=_;p<this.countRows()&&(G=this.toPhysicalRow(p)),_<this.countCols()&&(j=this.toPhysicalColumn(_)),y.setCellMeta(G,j,w,x),s.runHooks("afterSetCellMeta",p,_,w,x)},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(p,_){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},x=this.toPhysicalRow(p),k=this.toPhysicalColumn(_);return x===null&&(x=p),k===null&&(k=_),y.getCellMeta(x,k,{visualRow:p,visualColumn:_,...w})},this.getColumnMeta=function(p){return y.getColumnMeta(this.toPhysicalColumn(p))},this.getCellMetaAtRow=function(p){return y.getCellsMetaAtRow(p)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||v.columns)},this.getCellRenderer=function(p,_){const w=typeof p=="number"?s.getCellMeta(p,_).renderer:p.renderer;return typeof w=="string"?_getItem$2(w):isUndefined(w)?_getItem$2("text"):w},this.getCellEditor=function(p,_){const w=typeof p=="number"?s.getCellMeta(p,_).editor:p.editor;return typeof w=="string"?_getItem$3(w):isUndefined(w)?_getItem$3("text"):w},this.getCellValidator=function(p,_){const w=typeof p=="number"?s.getCellMeta(p,_).validator:p.validator;return typeof w=="string"?_getItem$1(w):w},this.validateCells=function(p){this._validateCells(p)},this.validateRows=function(p,_){if(!Array.isArray(p))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(_,p)},this.validateColumns=function(p,_){if(!Array.isArray(p))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(_,void 0,p)},this._validateCells=function(p,_,w){const x=new K;p&&(x.onQueueEmpty=p);let k=s.countRows()-1;for(;k>=0;){if(_!==void 0&&_.indexOf(k)===-1){k-=1;continue}let G=s.countCols()-1;for(;G>=0;){if(w!==void 0&&w.indexOf(G)===-1){G-=1;continue}x.addValidatorToQueue(),s.validateCell(s.getDataAtCell(k,G),s.getCellMeta(k,G),j=>{if(typeof j!="boolean")throw new Error("Validation error: result is not boolean");j===!1&&(x.valid=!1),x.removeValidatorFormQueue()},"validateCells"),G-=1}k-=1}x.checkIfQueueIsEmpty()},this.getRowHeader=function(p){let _=v.rowHeaders,w=p;return w!==void 0&&(w=s.runHooks("modifyRowHeader",w)),w===void 0?(_=[],rangeEach(s.countRows()-1,x=>{_.push(s.getRowHeader(x))})):Array.isArray(_)&&_[w]!==void 0?_=_[w]:isFunction(_)?_=_(w):_&&typeof _!="string"&&typeof _!="number"&&(_=w+1),_},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let p=0,_=s.countCols();p<_;p++)if(s.getColHeader(p))return!0;return!1},this.getColHeader=function(p){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=s.runHooks("modifyColHeader",p);if(w===void 0){const S=[],b=s.countCols();for(let R=0;R<b;R++)S.push(s.getColHeader(R));return S}let x=v.colHeaders;const k=function(S){const b=[],R=s.countCols();let T=0;for(;T<R;T++)isFunction(v.columns)&&v.columns(T)&&b.push(T);return b[S]},G=s.toPhysicalColumn(w),j=k(G);return v.colHeaders===!1?x=null:v.columns&&isFunction(v.columns)&&v.columns(j)&&v.columns(j).title?x=v.columns(j).title:v.columns&&v.columns[G]&&v.columns[G].title?x=v.columns[G].title:Array.isArray(v.colHeaders)&&v.colHeaders[G]!==void 0?x=v.colHeaders[G]:isFunction(v.colHeaders)?x=v.colHeaders(G):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(x=spreadsheetColumnLabel(w)),x=s.runHooks("modifyColumnHeaderValue",x,p,_),x},this._getColWidthFromSettings=function(p){let _;if(p>=0&&(_=s.getCellMeta(0,p).width),(_===void 0||_===v.width)&&(_=v.colWidths),_!=null){switch(typeof _){case"object":_=_[p];break;case"function":_=_(p);break}typeof _=="string"&&(_=parseInt(_,10))}return _},this.getColWidth=function(p,_){let w=s._getColWidthFromSettings(p);return w=s.runHooks("modifyColWidth",w,p,_),w===void 0&&(w=DEFAULT_WIDTH),w},this._getRowHeightFromSettings=function(p){const _=s.stylesHandler.getDefaultRowHeight();let w=v.rowHeights;if(w!=null){switch(typeof w){case"object":w=w[p];break;case"function":w=w(p);break}typeof w=="string"&&(w=parseInt(w,10))}return w!=null&&w<_?_:w},this.getRowHeight=function(p,_){let w=s._getRowHeightFromSettings(p);return w=s.runHooks("modifyRowHeight",w,p,_),w},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const p=v.maxCols,_=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(p,_)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=0;return rangeEachReverse(s.countRows()-1,w=>{if(s.isEmptyRow(w))_+=1;else if(p===!0)return!1}),_},this.countEmptyCols=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=0;return rangeEachReverse(s.countCols()-1,w=>{if(s.isEmptyCol(w))_+=1;else if(p===!0)return!1}),_},this.isEmptyRow=function(p){return v.isEmptyRow.call(s,p)},this.isEmptyCol=function(p){return v.isEmptyCol.call(s,p)},this.selectCell=function(p,_,w,x){let k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,G=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return isUndefined(p)||isUndefined(_)?!1:this.selectCells([[p,_,w,x]],k,G)},this.selectCells=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;_===!1&&h.suspend();const x=M.selectCells(p);return x&&w&&s.listen(),h.resume(),x},this.selectColumns=function(p){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p,w=arguments.length>2?arguments[2]:void 0;return M.selectColumns(p,_,w)},this.selectRows=function(p){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p,w=arguments.length>2?arguments[2]:void 0;return M.selectRows(p,_,w)},this.deselectCell=function(){M.deselect()},this.selectAll=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p,w=arguments.length>2?arguments[2]:void 0;h.skipNextScrollCycle(),M.selectAll(p,_,w)};const fe=(p,_)=>p.getNearestNotHiddenIndex(_,1,!0);this.scrollViewportTo=function(p,_){if(typeof p=="number"){var w;p={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:x,col:k,considerHiddenIndexes:G}=p??{};let j=x,S=k;if(isFunction(_)&&this.addHookOnce("afterScroll",_),G===void 0||G){const A=Number.isInteger(x)&&x>=0,D=Number.isInteger(k)&&k>=0,B=A?fe(this.rowIndexMapper,x):void 0,N=D?fe(this.columnIndexMapper,k):void 0;if(B===null||N===null)return!1;j=A?s.rowIndexMapper.getRenderableFromVisualIndex(B):x,S=D?s.columnIndexMapper.getRenderableFromVisualIndex(N):k}const b=Number.isInteger(j),R=Number.isInteger(S);let T=!1;return b&&j>=0&&R&&S>=0?T=s.view.scrollViewport(s._createCellCoords(j,S),p.horizontalSnap,p.verticalSnap):b&&j>=0&&(R&&S<0||!R)?T=s.view.scrollViewportVertically(j,p.verticalSnap):R&&S>=0&&(b&&j<0||!b)&&(T=s.view.scrollViewportHorizontally(S,p.horizontalSnap)),isFunction(_)&&(T?this.view.render():(this.removeHook("afterScroll",_),this._registerMicrotask(()=>_()))),T},this.scrollToFocusedCell=function(p){if(!this.selection.isSelected())return!1;isFunction(p)&&this.addHookOnce("afterScroll",p);const{highlight:_}=this.getSelectedRangeLast(),w=this.scrollViewportTo(_.toObject());return w?this.view.render():isFunction(p)&&(this.removeHook("afterScroll",p),this._registerMicrotask(()=>p())),w},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),O.clear(),y.clearCache(),foreignHotInstances.delete(this.guid),o.destroy(),u&&u.destroy(),s.rootContainer&&empty(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),$.getItems().forEach(p=>{let[,_]=p;_.destroy()}),$.clear(),s.runHooks("afterDestroy")},!0),Hooks.getSingleton().destroy(s),objectEach(s,(p,_,w)=>{isFunction(p)?w[_]=ge(_):_!=="guid"&&(w[_]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,c=null,M=null,u=null,s=null};function ge(p){return()=>{throw new Error(`The "${p}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return u.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(p){return $.getItem(toUpperCaseFirst(p))},this.getPluginName=function(p){return p===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:$.getId(p)},this.getInstance=function(){return s},this.addHook=function(p,_,w){Hooks.getSingleton().add(p,_,s,w)},this.hasHook=function(p){return Hooks.getSingleton().has(p,s)||Hooks.getSingleton().has(p)},this.addHookOnce=function(p,_,w){Hooks.getSingleton().once(p,_,s,w)},this.removeHook=function(p,_){Hooks.getSingleton().remove(p,_,s)},this.runHooks=function(p,_,w,x,k,G,j){return Hooks.getSingleton().run(s,p,_,w,x,k,G,j)},this.getTranslatedPhrase=function(p,_){return getTranslatedPhrase(v.language,p,_)},this.toHTML=()=>instanceToHTML(this),this.toTableElement=()=>{const p=this.rootDocument.createElement("div");return p.insertAdjacentHTML("afterbegin",instanceToHTML(this)),p.firstElementChild},this.timeouts=[],this.useTheme=p=>{const _=!!f;this.stylesHandler.useTheme(p);const w=this.stylesHandler.getThemeName();isRootInstance(this)&&(removeClass$1(this.rootWrapperElement,/ht-theme-.*/g),removeClass$1(this.rootPortalElement,/ht-theme-.*/g),w&&(addClass$1(this.rootWrapperElement,w),addClass$1(this.rootPortalElement,w),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||warn(`The "${w}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),_||(s.render(),s.scrollViewportTo(0,0),getThemeClassName(this.rootContainer)&&(removeClass$1(this.rootContainer,/ht-theme-.*/g),w&&addClass$1(this.rootContainer,w))),this.runHooks("afterSetTheme",w,_)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(p){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=p;typeof w=="function"&&(w=setTimeout(w,_)),this.timeouts.push(w)},this._clearTimeouts=function(){arrayEach(this.timeouts,p=>{clearTimeout(p)})},this.immediates=[],this._registerImmediate=function(p){this.immediates.push(setImmediate(p))},this._clearImmediates=function(){arrayEach(this.immediates,p=>{clearImmediate(p)})},this._registerMicrotask=function(p){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||p()})},this._getEditorManager=function(){return u};const ye=createShortcutManager({handleEvent(){return s.isListening()},beforeKeyDown:p=>this.runHooks("beforeKeyDown",p),afterKeyDown:p=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",p)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",p=>{p.ctrlKey===!1&&p.metaKey===!1&&ye.releasePressedKeys()}),this.getShortcutManager=function(){return ye},this.getFocusManager=function(){return d},getPluginsNames().forEach(p=>{const _=getPlugin(p);$.addItem(p,new _(this))}),registerAllShortcutContexts(s),ye.setActiveContextName("grid"),Hooks.getSingleton().run(s,"construct")}function observe(t,e,r){t.addEventListener(e,r,!1)}function unObserve(t,e,r){t.removeEventListener(e,r,!1)}function getComputedStyle$1(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function createInputElementResizer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:d=>d.value,...e},i=t.body,n=t.createTextNode(""),s=t.createElement("span");let o;function a(){var d,h;n.textContent=r.textContent(o),s.style.position="absolute",s.style.fontSize=getComputedStyle$1(o).fontSize,s.style.fontFamily=getComputedStyle$1(o).fontFamily,s.style.whiteSpace="pre",i.appendChild(s);const f=parseInt(((d=getComputedStyle$1(o))===null||d===void 0?void 0:d.paddingInlineStart)||0,10),g=parseInt(((h=getComputedStyle$1(o))===null||h===void 0?void 0:h.paddingInlineEnd)||0,10),m=s.clientWidth+f+g+1;i.removeChild(s);const C=o.style;C.height=`${r.minHeight}px`,r.minWidth>m?C.width=`${r.minWidth}px`:m>r.maxWidth?C.width=`${r.maxWidth}px`:C.width=`${m}px`;const y=o.scrollHeight?o.scrollHeight-1:0;r.minHeight>y?C.height=`${r.minHeight}px`:r.maxHeight<y?(C.height=`${r.maxHeight}px`,C.overflowY="visible"):C.height=`${y}px`}function l(){t.defaultView.setTimeout(a,0)}function c(d){if(d&&d.minHeight)if(d.minHeight==="inherit")r.minHeight=o.clientHeight;else{const h=parseInt(d.minHeight,10);isNaN(h)||(r.minHeight=h)}if(d&&d.maxHeight)if(d.maxHeight==="inherit")r.maxHeight=o.clientHeight;else{const h=parseInt(d.maxHeight,10);isNaN(h)||(r.maxHeight=h)}if(d&&d.minWidth)if(d.minWidth==="inherit")r.minWidth=o.clientWidth;else{const h=parseInt(d.minWidth,10);isNaN(h)||(r.minWidth=h)}if(d&&d.maxWidth)if(d.maxWidth==="inherit")r.maxWidth=o.clientWidth;else{const h=parseInt(d.maxWidth,10);isNaN(h)||(r.maxWidth=h)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(n))}function u(d,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=d,c(h),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${r.minHeight}px`,o.style.minWidth=`${r.minWidth}px`,o.style.maxWidth=`${r.maxWidth}px`,o.style.overflowY="hidden"),f&&(observe(o,"input",a),observe(o,"keydown",l)),a()}return{init:u,resize:a,unObserve(){unObserve(o,"input",a),unObserve(o,"keydown",l)}}}function updateCaretPosition(t,e){const r=getCaretPosition(e),i=e.value.split(`
`);let n=r,s=0;for(let o=0;o<i.length;o++){const a=i[o];o!==0&&(s+=i[o-1].length+1);const l=s+a.length;if(t==="home"?n=s:t==="end"&&(n=l),r<=l)break}setCaretPosition(e,n)}function _defineProperty$1e(t,e,r){return(e=_toPropertyKey$1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1e(t){var e=_toPrimitive$1e(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const EDITOR_VISIBLE_CLASS_NAME$1="ht_editor_visible",EDITOR_HIDDEN_CLASS_NAME="ht_editor_hidden",SHORTCUTS_GROUP$f="textEditor",EDITOR_TYPE$9="text";class TextEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$9}constructor(e){super(e),_defineProperty$1e(this,"eventManager",new EventManager(this)),_defineProperty$1e(this,"autoResize",createInputElementResizer(this.hot.rootDocument)),_defineProperty$1e(this,"TEXTAREA",void 0),_defineProperty$1e(this,"textareaStyle",void 0),_defineProperty$1e(this,"TEXTAREA_PARENT",void 0),_defineProperty$1e(this,"textareaParentStyle",void 0),_defineProperty$1e(this,"layerClass",void 0),this.eventManager=new EventManager(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),isInternalElement(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,i,n,s,o){const a=this.state;if(super.prepare(e,r,i,n,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==EDITOR_STATE.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===EDITOR_STATE.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),setAttribute(this.TEXTAREA,[["data-hot-input",""],A11Y_TABINDEX(-1)]),addClass$1(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),addClass$1(this.TEXTAREA_PARENT,"handsontableInputHolder"),hasClass$1(this.TEXTAREA_PARENT,this.layerClass)&&removeClass$1(this.TEXTAREA_PARENT,this.layerClass),addClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){isEdge()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",removeClass$1(this.TEXTAREA_PARENT,this.layerClass),addClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;rangeEach(e.length-1,i=>{const n=e[i];if(hasClass$1(n,"handsontableEditor"))return r=!0,!1}),hasClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)&&removeClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),r?(this.layerClass=EDITOR_VISIBLE_CLASS_NAME$1,addClass$1(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),addClass$1(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==EDITOR_STATE.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:i,width:n,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(n,s),minHeight:Math.min(o,a),maxWidth:s,maxHeight:a},!0)}bindEvents(){isIOS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>isDefined(this.hot.getSelected()),group:SHORTCUTS_GROUP$f},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(n(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;updateCaretPosition(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;updateCaretPosition(a,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$f)}}const RENDERER_TYPE$b="base",TEXT_ELLIPSIS_CLASS_NAME="htTextEllipsis";function baseRenderer(t,e,r,i,n,s,o){const a=o.ariaTags,l=[],c=[],u=[],d=[];o.className&&addClass$1(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&d.push(A11Y_READONLY())):a&&u.push(A11Y_READONLY()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&d.push(A11Y_INVALID())):(c.push(o.invalidCellClassName),a&&u.push(A11Y_INVALID()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),o.textEllipsis&&l.push(TEXT_ELLIPSIS_CLASS_NAME),removeClass$1(e,c),addClass$1(e,l),removeAttribute(e,u),setAttribute(e,d)}baseRenderer.RENDERER_TYPE=RENDERER_TYPE$b;const RENDERER_TYPE$a="text";function textRenderer(t,e,r,i,n,s,o){baseRenderer.apply(this,[t,e,r,i,n,s,o]);let a=s;!a&&o.placeholder&&(a=o.placeholder),a=stringify$1(a),o.trimWhitespace&&(a=a.trim()),fastInnerText(e,a)}textRenderer.RENDERER_TYPE=RENDERER_TYPE$a;const CELL_TYPE$9="text",TextCellType={CELL_TYPE:CELL_TYPE$9,editor:TextEditor,renderer:textRenderer};_register(TextCellType);Handsontable$1.editors={BaseEditor};function Handsontable$1(t,e){const r=new Core(t,e||{},rootInstanceSymbol);return r.init(),r}Handsontable$1.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Core(t,e,rootInstanceSymbol)};Handsontable$1.DefaultSettings=metaSchemaFactory();Handsontable$1.hooks=Hooks.getSingleton();Handsontable$1.CellCoords=CellCoords;Handsontable$1.CellRange=CellRange;Handsontable$1.packageName="handsontable";Handsontable$1.buildDate="10/07/2025 10:59:01";Handsontable$1.version="16.0.1";Handsontable$1.languages={dictionaryKeys,getLanguageDictionary,getLanguagesDictionaries,registerLanguageDictionary,getTranslatedPhrase};function _defineProperty$1d(t,e,r){return(e=_toPropertyKey$1d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1d(t){var e=_toPrimitive$1d(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1d(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const SHORTCUTS_GROUP$e="handsontableEditor",EDITOR_TYPE$8="handsontable";class HandsontableEditor extends TextEditor{constructor(){super(...arguments),_defineProperty$1d(this,"isFlippedVertically",!1),_defineProperty$1d(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return EDITOR_TYPE$8}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,r,i,n,s,o){super.prepare(e,r,i,n,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(c,u){const d=this.getSourceData(u.row,u.col);d!==void 0&&a.setValue(d),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&extend$1(l,o.handsontable),this.htOptions=l}beginEditing(e,r){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,r)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,r,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const n=this.htEditor.getValue();n!==void 0&&this.setValue(n)}super.finishEditing(e,r,i)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,r=this.getEditedCellRect();let i=r.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;i=Math.max(i+a,0)}const n=this.getDropdownHeight(),s=e.getWorkspaceHeight()-i-r.height,o=n>s&&i>s+r.height;return o?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:o,spaceAbove:i,spaceBelow:s}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,r=this.getEditedCellRect();let i=r.start+r.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;i=Math.max(i+a,0)}const n=this.getDropdownWidth(),s=e.getWorkspaceWidth()-i+r.width,o=n>s&&i>s;return o?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:o,spaceInlineStart:i,spaceInlineEnd:s}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:r}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-r)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.close()})}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:SHORTCUTS_GROUP$e,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"},n=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||this.isFlippedVertically&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),stopImmediatePropagation(o),this.hot.listen(),this.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&this.isFlippedVertically?a=o.countRows()-1:o.getSelectedLast()&&(this.isFlippedVertically?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),n(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!this.isFlippedVertically)a=0;else if(o.getSelectedLast()){if(this.isFlippedVertically)a=o.getSelectedLast()[0]+1;else if(!this.isFlippedVertically){const c=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(c,l+1)}}return n(a,s)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$e)}}function _classPrivateMethodInitSpec$K(t,e){_checkPrivateRedeclaration$X(t,e),e.add(t)}function _classPrivateFieldInitSpec$E(t,e,r){_checkPrivateRedeclaration$X(t,e),e.set(t,r)}function _checkPrivateRedeclaration$X(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1c(t,e,r){return(e=_toPropertyKey$1c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1c(t){var e=_toPrimitive$1c(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1c(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$E(t,e){return t.get(_assertClassBrand$X(t,e))}function _assertClassBrand$X(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const EDITOR_TYPE$7="autocomplete";var _idPrefix=new WeakMap,_focusDebounced=new WeakMap,_AutocompleteEditor_brand=new WeakSet;class AutocompleteEditor extends HandsontableEditor{constructor(){super(...arguments),_classPrivateMethodInitSpec$K(this,_AutocompleteEditor_brand),_defineProperty$1c(this,"query",null),_defineProperty$1c(this,"strippedChoices",[]),_defineProperty$1c(this,"rawChoices",[]),_classPrivateFieldInitSpec$E(this,_idPrefix,this.hot.guid.slice(0,9)),_classPrivateFieldInitSpec$E(this,_focusDebounced,debounce(()=>{this.focus()},100)),_defineProperty$1c(this,"sortByRelevance",function(e,r,i){const n=[],s=[],o=e.length;let a=r.length,l,c,u,d;if(o===0){for(u=0;u<a;u++)s.push(u);return s}for(u=0;u<a;u++){if(c=stripTags(stringify$1(r[u])),i)d=c.indexOf(e);else{const h=this.cellProperties.locale;d=c.toLocaleLowerCase(h).indexOf(e.toLocaleLowerCase(h))}d!==-1&&(l=c.length-d-o,n.push({baseIndex:u,index:d,charsLeft:l,value:c}))}for(n.sort((h,f)=>{if(f.index===-1)return-1;if(h.index===-1)return 1;if(h.index<f.index)return-1;if(f.index<h.index)return 1;if(h.index===f.index){if(h.charsLeft<f.charsLeft)return-1;if(h.charsLeft>f.charsLeft)return 1}return 0}),u=0,a=n.length;u<a;u++)s.push(n[u].baseIndex);return s})}static get EDITOR_TYPE(){return EDITOR_TYPE$7}getValue(){const e=this.rawChoices.find(r=>this.stripValueIfNeeded(r)===this.TEXTAREA.value);return isDefined(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),addClass$1(this.htContainer,"autocompleteEditor"),addClass$1(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_TEXT(),A11Y_COMBOBOX(),A11Y_HASPOPUP("listbox"),A11Y_AUTOCOMPLETE()])}prepare(e,r,i,n,s,o){super.prepare(e,r,i,n,s,o),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false"),A11Y_CONTROLS(`${_classPrivateFieldGet$E(_idPrefix,this)}-listbox-${e}-${r}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,r=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,n=i?.length,{row:s,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",_classPrivateFieldGet$E(_focusDebounced,this)),this.htEditor.updateSettings({colWidths:e?[outerWidth(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,c,u,d,h,f)=>{textRenderer(a,l,c,u,d,h,f);const{filteringCaseSensitive:g,allowHtml:m,locale:C}=this.cellProperties,y=this.query;let v=stringify$1(h),E,$;v&&!m&&(E=g===!0?v.indexOf(y):v.toLocaleLowerCase(C).indexOf(y.toLocaleLowerCase(C)),E!==-1&&($=v.substr(E,y.length),v=v.replace($,`<strong>${$}</strong>`))),r&&setAttribute(l,[A11Y_OPTION(),...i?[A11Y_SETSIZE(n)]:[],...i?[A11Y_POSINSET(i.indexOf(h)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${u}`]]),l.innerHTML=v},afterSelectionEnd:(a,l)=>{if(r){const c=d=>{setAttribute(d,[A11Y_SELECTED()]),setAttribute(this.TEXTAREA,...A11Y_ACTIVEDESCENDANT(d.id))},u=this.htEditor.getCell(a,l,!0);u!==null?c(u):this.htEditor.addHookOnce("afterScrollVertically",()=>{const d=this.htEditor.getCell(a,l,!0);c(d)})}}}),r&&(setAttribute(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...A11Y_PRESENTATION()),setAttribute(this.htEditor.rootElement,[A11Y_LISTBOX(),A11Y_LIVE("polite"),A11Y_RELEVANT("text"),["id",`${_classPrivateFieldGet$E(_idPrefix,this)}-listbox-${s}-${o}`]]),setAttribute(this.TEXTAREA,...A11Y_EXPANDED("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const r=this.cellProperties.source;this.query=e,typeof r=="function"?r.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}updateChoicesList(e){const r=getCaretPosition(this.TEXTAREA),i=getSelectionEndPosition(this.TEXTAREA),n=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;n&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const c=Array.isArray(o)?o.length:0;if(s===!1)c&&(a=o[0]);else{const u=[];for(let d=0,h=l.length;d<h&&!(n&&c<=d);d++)c?u.push(l[o[d]]):u.push(l[d]);a=0,l=u}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(pivot([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),setCaretPosition(this.TEXTAREA,r,r===i?void 0:i)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:r,spaceAbove:i,spaceBelow:n}=e;return this.limitDropdownIfNeeded(r?i:n),e}limitDropdownIfNeeded(e){const r=this.getDropdownHeight();if(r>e){let i=0,n=0,s=null;do n=this.htEditor.stylesHandler.getDefaultRowHeight(),i+=n;while(i<e);s=i-n,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+r-s}px`),this.setDropdownHeight(i-n)}}updateDropdownDimensions(){const e=getFractionalScalingCompensation(),r=this.getTargetEditorWidth()+e,i=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:r,height:i}),_assertClassBrand$X(_AutocompleteEditor_brand,this,_fixDropdownWidth).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),_assertClassBrand$X(_AutocompleteEditor_brand,this,_fixDropdownWidth).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderTopWidth,10)+parseInt(n.borderBottomWidth,10)}const r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(n,s)=>s).reduce((n,s)=>{const o=this.hot.stylesHandler.getDefaultRowHeight()+(s===0?1:0);return n+o},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const r=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(r.borderInlineStartWidth,10)+parseInt(r.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:r}=this.cellProperties,i=arrayMap(e,s=>stringify$1(s));return arrayMap(i,s=>r?s:stripTags(s))}allowKeyEventPropagation(e){const r=this.htEditor.getSelectedRangeLast(),i={row:r?r.from.row:-1};let n=!1;return e===KEY_CODES.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(n=!0),e===KEY_CODES.ARROW_UP&&i.row>-1&&(n=!0),n}onBeforeKeyDown(e){if(isPrintableChar(e.keyCode)||e.keyCode===KEY_CODES.BACKSPACE||e.keyCode===KEY_CODES.DELETE||e.keyCode===KEY_CODES.INSERT){let r=10;if(e.keyCode===KEY_CODES.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},r)}}}function _fixDropdownWidth(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+getScrollbarWidth(this.hot.rootDocument)})}const EDITOR_TYPE$6="checkbox";class CheckboxEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$6}beginEditing(e,r){if(r&&r.type==="mouseup"&&r.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');hasClass$1(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const getWindow=()=>window,getDocument=()=>window.document,sto=(t,e)=>window.setTimeout(t,e),addEvent=function(t,e,r,i){t.addEventListener(e,r,!!i)},removeEvent=function(t,e,r,i){t.removeEventListener(e,r,!!i)},trim=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},hasClass=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},addClass=function(t,e){hasClass(t,e)||(t.className=t.className===""?e:t.className+" "+e)},removeClass=function(t,e){t.className=trim((" "+t.className+" ").replace(" "+e+" "," "))},isArray=function(t){return/Array/.test(Object.prototype.toString.call(t))},isDate$1=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},isWeekend=function(t){let e=t.getDay();return e===0||e===6},isLeapYear=function(t){return t%4===0&&t%100!==0||t%400===0},getDaysInMonth=function(t,e){return[31,isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},setToStartOfDay=function(t){isDate$1(t)&&t.setHours(0,0,0,0)},compareDates=function(t,e){return t.getTime()===e.getTime()},extend=function(t,e,r){let i,n;for(i in e)n=t[i]!==void 0,n&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?isDate$1(e[i])?r&&(t[i]=new Date(e[i].getTime())):isArray(e[i])?r&&(t[i]=e[i].slice(0)):t[i]=extend({},e[i],r):(r||!n)&&(t[i]=e[i]);return t},fireEvent=function(t,e,r){let i=getDocument().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=extend(i,r),t.dispatchEvent(i)},adjustCalendar=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},defaults={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},renderDayName=function(t,e,r){for(e+=t.firstDay;e>=7;)e-=7;return r?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},renderDay=function(t){let e=[],r="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),r="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},isoWeek=function(t,e){t.setHours(0,0,0,0);let r=t.getDate(),i=t.getDay(),n=e,s=n-1,o=7,a=function(h){return(h+o-1)%o};t.setDate(r+s-a(i));let l=new Date(t.getFullYear(),0,n),c=1440*60*1e3,u=(t.getTime()-l.getTime())/c;return 1+Math.round((u-s+a(l.getDay()))/o)},renderWeek=function(t,e,r,i,n){let s=new Date(i,r,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():isoWeek(s,n))+"</td>"},renderRow=function(t,e,r,i){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},renderBody=function(t){return"<tbody>"+t.join("")+"</tbody>"},renderHead=function(t){let e,r=[];for(t.showWeekNumber&&r.push("<th></th>"),e=0;e<7;e++)r.push('<th scope="col"><abbr title="'+renderDayName(t,e)+'">'+renderDayName(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?r.reverse():r).join("")+"</tr></thead>"},renderTitle=function(t,e,r,i,n,s){let o,a,l,c=t._o,u=r===c.minYear,d=r===c.maxYear,h='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',f,g,m=!0,C=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(r===n?o-e:12+o-e)+'"'+(o===i?' selected="selected"':"")+(u&&o<c.minMonth||d&&o>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[o]+"</option>");for(f='<div class="pika-label">'+c.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",isArray(c.yearRange)?(o=c.yearRange[0],a=c.yearRange[1]+1):(o=r-c.yearRange,a=1+r+c.yearRange),l=[];o<a&&o<=c.maxYear;o++)o>=c.minYear&&l.push('<option value="'+o+'"'+(o===r?' selected="selected"':"")+">"+o+"</option>");return g='<div class="pika-label">'+r+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",c.showMonthAfterYear?h+=g+f:h+=f+g,u&&(i===0||c.minMonth>=i)&&(m=!1),d&&(i===11||c.maxMonth<=i)&&(C=!1),e===0&&(h+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(h+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),h+="</div>"},renderTable=function(t,e,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+renderHead(t)+renderBody(e)+"</table>"};function Pikaday(t){let e=this,r=e.config(t);e._onMouseDown=function(n){if(!e._v)return;n=n||getWindow().event;let s=n.target||n.srcElement;if(s)if(hasClass(s,"is-disabled")||(hasClass(s,"pika-button")&&!hasClass(s,"is-empty")&&!hasClass(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),r.bound&&sto(function(){e.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100)):hasClass(s,"pika-prev")?e.prevMonth():hasClass(s,"pika-next")&&e.nextMonth()),hasClass(s,"pika-select"))e._c=!0;else if(n.preventDefault)n.preventDefault();else return n.returnValue=!1,!1},e._onChange=function(n){n=n||getWindow().event;let s=n.target||n.srcElement;s&&(hasClass(s,"pika-select-month")?e.gotoMonth(s.value):hasClass(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(n){if(n=n||getWindow().event,e.isVisible())switch(n.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let n=this.moment(r.field.value,r.format,r.formatStrict);return n&&n.isValid()?n.toDate():null}else return new Date(Date.parse(r.field.value))},e._onInputChange=function(n){let s;n.firedBy!==e&&(s=e._parseFieldValue(),isDate$1(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let n=getDocument().activeElement;do if(hasClass(n,"pika-single"))return;while(n=n.parentNode);e._c||(e._b=sto(function(){e.hide()},50)),e._c=!1},e._onClick=function(n){n=n||getWindow().event;let s=n.target||n.srcElement,o=s;if(s){!hasEventListeners&&hasClass(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),addEvent(s,"change",e._onChange)));do if(hasClass(o,"pika-single")||o===r.trigger)return;while(o=o.parentNode);e._v&&s!==r.trigger&&o!==r.trigger&&e.hide()}},e.el=getDocument().createElement("div"),e.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),addEvent(e.el,"mousedown",e._onMouseDown,!0),addEvent(e.el,"touchend",e._onMouseDown,!0),addEvent(e.el,"change",e._onChange),r.keyboardInput&&addEvent(getDocument(),"keydown",e._onKeyChange),r.field&&(r.container?r.container.appendChild(e.el):r.bound?getDocument().body.appendChild(e.el):r.field.parentNode.insertBefore(e.el,r.field.nextSibling),addEvent(r.field,"change",e._onInputChange),r.defaultDate||(r.defaultDate=e._parseFieldValue(),r.setDefaultDate=!0));let i=r.defaultDate;isDate$1(i)?r.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),r.bound?(this.hide(),e.el.className+=" is-bound",addEvent(r.trigger,"click",e._onInputClick),addEvent(r.trigger,"focus",e._onInputFocus),addEvent(r.trigger,"blur",e._onInputBlur)):this.show()}Pikaday.prototype={config:function(t){this._o||(this._o=extend({},defaults,!0));let e=extend(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let r=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=r>4?4:r,isDate$1(e.minDate)||(e.minDate=!1),isDate$1(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),isArray(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||defaults.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,isDate$1(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return isDate$1(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",fireEvent(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!isDate$1(t))return;let r=this._o.minDate,i=this._o.maxDate;isDate$1(r)&&t<r?t=r:isDate$1(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),setToStartOfDay(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fireEvent(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(isDate$1(t)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),n=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=n<r.getTime()||i.getTime()<n}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let r=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,n;t==="add"?n=new Date(r.valueOf()+i):t==="subtract"&&(n=new Date(r.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=adjustCalendar({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(setToStartOfDay(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=defaults.minDate,this._o.minYear=defaults.minYear,this._o.minMonth=defaults.minMonth,this._o.startRange=defaults.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(setToStartOfDay(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=defaults.maxDate,this._o.maxYear=defaults.maxYear,this._o.maxMonth=defaults.maxMonth,this._o.endRange=defaults.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,r=e.minYear,i=e.maxYear,n=e.minMonth,s=e.maxMonth,o="",a;this._y<=r&&(this._y=r,!isNaN(n)&&this._m<n&&(this._m=n)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+renderTitle(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&sto(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,r,i,n,s,o,a,l,c,u;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,r=this.el.offsetHeight,i=getWindow().innerWidth||getDocument().documentElement.clientWidth,n=getWindow().innerHeight||getDocument().documentElement.clientHeight,s=getDocument().body.scrollTop||getDocument().documentElement.scrollTop,c=!0,u=!0,l=t.getBoundingClientRect(),o=l.left+getWindow().pageXOffset,a=l.bottom+getWindow().pageYOffset,(this._o.reposition&&o+e>i||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,c=!1),(this._o.reposition&&a+r>n+s||this._o.position.indexOf("top")>-1&&a-r-t.offsetHeight>0)&&(a=a-r-t.offsetHeight,u=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",addClass(this.el,c?"left-aligned":"right-aligned"),addClass(this.el,u?"bottom-aligned":"top-aligned"),removeClass(this.el,c?"right-aligned":"left-aligned"),removeClass(this.el,u?"top-aligned":"bottom-aligned"))},render:function(t,e,r){let i=this._o,n=new Date,s=getDaysInMonth(t,e),o=new Date(t,e,1).getDay(),a=[],l=[];setToStartOfDay(n),i.firstDay>0&&(o-=i.firstDay,o<0&&(o+=7));let c=e===0?11:e-1,u=e===11?0:e+1,d=e===0?t-1:t,h=e===11?t+1:t,f=getDaysInMonth(d,c),g=s+o,m=g;for(;m>7;)m-=7;g+=7-m;let C=!1;for(let y=0,v=0;y<g;y++){let E=new Date(t,e,1+(y-o)),$=isDate$1(this._d)?compareDates(E,this._d):!1,O=compareDates(E,n),P=i.events.indexOf(E.toDateString())!==-1,I=y<o||y>=s+o,W=1+(y-o),q=e,M=t,Y=i.startRange&&compareDates(i.startRange,E),z=i.endRange&&compareDates(i.endRange,E),Q=i.startRange&&i.endRange&&i.startRange<E&&E<i.endRange,K=i.minDate&&E<i.minDate||i.maxDate&&E>i.maxDate||i.disableWeekends&&isWeekend(E)||i.disableDayFn&&i.disableDayFn(E);I&&(y<o?(W=f+W,q=c,M=d):(W=W-s,q=u,M=h));let Z={day:W,month:q,year:M,hasEvent:P,isSelected:$,isToday:O,isDisabled:K,isEmpty:I,isStartRange:Y,isEndRange:z,isInRange:Q,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&$&&(C=!0),l.push(renderDay(Z)),++v===7&&(i.showWeekNumber&&l.unshift(renderWeek(this,y-o,e,t,i.firstWeekOfYearMinDays)),a.push(renderRow(l,i.isRTL,i.pickWholeWeek,C)),l=[],v=0,C=!1)}return renderTable(i,a,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),removeClass(this.el,"is-hidden"),this._o.bound&&(addEvent(getDocument(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&removeEvent(getDocument(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),addClass(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),removeEvent(this.el,"mousedown",this._onMouseDown,!0),removeEvent(this.el,"touchend",this._onMouseDown,!0),removeEvent(this.el,"change",this._onChange),t.keyboardInput&&removeEvent(getDocument(),"keydown",this._onKeyChange),t.field&&(removeEvent(t.field,"change",this._onInputChange),t.bound&&(removeEvent(t.trigger,"click",this._onInputClick),removeEvent(t.trigger,"focus",this._onInputFocus),removeEvent(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function _classPrivateMethodInitSpec$J(t,e){_checkPrivateRedeclaration$W(t,e),e.add(t)}function _checkPrivateRedeclaration$W(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1b(t,e,r){return(e=_toPropertyKey$1b(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1b(t){var e=_toPrimitive$1b(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1b(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$W(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const EDITOR_TYPE$5="date",SHORTCUTS_GROUP_EDITOR="dateEditor",DEFAULT_DATE_FORMAT="DD/MM/YYYY";var _DateEditor_brand=new WeakSet;class DateEditor extends TextEditor{constructor(){super(...arguments),_classPrivateMethodInitSpec$J(this,_DateEditor_brand),_defineProperty$1b(this,"parentDestroyed",!1),_defineProperty$1b(this,"$datePicker",null)}static get EDITOR_TYPE(){return EDITOR_TYPE$5}init(){if(typeof hooks!="function")throw new Error("You need to include moment.js to your project.");if(typeof Pikaday!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),addClass$1(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{hasClass$1(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,r,i,n,s,o){super.prepare(e,r,i,n,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:SHORTCUTS_GROUP_EDITOR})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const n=this.hot._getEditorManager();n.closeEditor(),this.hot.view.render(),n.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP_EDITOR),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,r)}showDatepicker(e){const r=_assertClassBrand$W(_DateEditor_brand,this,_getDateFormat).call(this),i=this.hot.view.isMouseDown(),n=e?isFunctionKey(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new Pikaday(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(hooks),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,hooks(s,r,!0).isValid()&&this.$datePicker.setMoment(hooks(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!n&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,hooks(s,r,!0).isValid()&&this.$datePicker.setMoment(hooks(s,r),!0),!n&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const r=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&deepExtend(i,this.cellProperties.datePickerConfig);const n=i.onSelect,s=i.onClose;return i.field=r,i.trigger=r,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=(e=i.format)!==null&&e!==void 0?e:_assertClassBrand$W(_DateEditor_brand,this,_getDateFormat).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=o=>{let a=o;isNaN(a.getTime())||(a=hooks(a).format(_assertClassBrand$W(_DateEditor_brand,this,_getDateFormat).call(this))),this.setValue(a),n&&n(),isMobileBrowser()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},i}refreshDimensions(e){var r;if(super.refreshDimensions(e),this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:n}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(r=s.getParentOverlay(this.TD))!==null&&r!==void 0?r:this.hot.view._wt,a=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),c=n.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),u=n.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=c&&this.col<=u){const d=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+d.top+outerHeight(this.TD)}px`;let h=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?h+=d.right-outerWidth(this.datePicker):h+=d.left,this.datePickerStyle.left=`${h}px`}else this.hideDatepicker()}}function _getDateFormat(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:DEFAULT_DATE_FORMAT}const EDITOR_TYPE$4="dropdown";class DropdownEditor extends AutocompleteEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$4}prepare(e,r,i,n,s,o){o.filter=!1,o.strict=!0,super.prepare(e,r,i,n,s,o)}}const EDITOR_TYPE$3="numeric";class NumericEditor extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$3}}function _defineProperty$1a(t,e,r){return(e=_toPropertyKey$1a(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1a(t){var e=_toPrimitive$1a(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1a(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const EDITOR_TYPE$2="password";class PasswordEditor extends TextEditor{constructor(){super(...arguments),_defineProperty$1a(this,"autoResize",createInputElementResizer(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return EDITOR_TYPE$2}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,empty(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...A11Y_TABINDEX(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const EDITOR_VISIBLE_CLASS_NAME="ht_editor_visible",SHORTCUTS_GROUP$d="selectEditor",EDITOR_TYPE$1="select";class SelectEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$1}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),r=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",r&&e.setAttribute(...A11Y_HIDDEN()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),addClass$1(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",hasClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME)&&removeClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,r,i,n,s,o){super.prepare(e,r,i,n,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),empty(this.select),objectEach(l,(c,u)=>{const d=this.hot.rootDocument.createElement("OPTION");d.value=u,fastInnerHTML(d,c),this.select.appendChild(d)})}prepareOptions(e){let r={};if(Array.isArray(e))for(let i=0,n=e.length;i<n;i++)r[e[i]]=e[i];else typeof e=="object"&&(r=e);return r}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:r,width:i,height:n}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${n}px`,s.width=`${i}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${r}px`,s.margin="0px",addClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),i={group:SHORTCUTS_GROUP$d};this.isInFullEditMode()&&r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const n=this.select.selectedIndex-1;n>=0&&(this.select[n].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const n=this.select.selectedIndex+1;n<=this.select.length-1&&(this.select[n].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$d)}}const EDITOR_TYPE="time";class TimeEditor extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE}prepare(e,r,i,n,s,o){super.prepare(e,r,i,n,s,o),this.TEXTAREA.dir="ltr"}}function registerAllEditors(){_register$3(BaseEditor),_register$3(AutocompleteEditor),_register$3(CheckboxEditor),_register$3(DateEditor),_register$3(DropdownEditor),_register$3(HandsontableEditor),_register$3(NumericEditor),_register$3(PasswordEditor),_register$3(SelectEditor),_register$3(TextEditor),_register$3(TimeEditor)}const RENDERER_TYPE$9="html";function htmlRenderer(t,e,r,i,n,s,o){baseRenderer.apply(this,[t,e,r,i,n,s,o]),fastInnerHTML(e,s??"",!1)}htmlRenderer.RENDERER_TYPE=RENDERER_TYPE$9;const RENDERER_TYPE$8="autocomplete";function autocompleteRenderer(t,e,r,i,n,s,o){const{rootDocument:a}=t,l=o.allowHtml?htmlRenderer:textRenderer,c=a.createElement("DIV"),u=t.getSettings().ariaTags;if(c.className="htAutocompleteArrow",u&&c.setAttribute(...A11Y_HIDDEN()),c.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,r,i,n,s,o]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(c,e.firstChild),addClass$1(e,"htAutocomplete"),!t.acArrowListener){const d=new EventManager(t);t.acArrowListener=function(h){hasClass$1(h.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,i),e)},d.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{d.destroy()})}}autocompleteRenderer.RENDERER_TYPE=RENDERER_TYPE$8;const RENDERER_TYPE$7="dropdown";function dropdownRenderer(t,e,r,i,n,s,o){autocompleteRenderer.apply(this,[t,e,r,i,n,s,o])}dropdownRenderer.RENDERER_TYPE=RENDERER_TYPE$7;const isListeningKeyDownEvent=new WeakMap,isCheckboxListenerAdded=new WeakMap,BAD_VALUE_CLASS="htBadValue",ATTR_ROW="data-row",ATTR_COLUMN="data-col",SHORTCUTS_GROUP$c="checkboxRenderer",RENDERER_TYPE$6="checkbox";Hooks.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){const{label:i,type:n,row:s,column:o,prop:a}=e;if(n===RENDERER_TYPE$6){if(i){const{value:l,property:c}=i;let u=r;if(l)u=typeof l=="function"?l(s,o,a,r):l;else if(c){const d=this.getDataAtRowProp(s,c);u=d!==null?d:r}t=u}return t}});function checkboxRenderer(t,e,r,i,n,s,o){const{rootDocument:a}=t,l=t.getSettings().ariaTags;baseRenderer.apply(this,[t,e,r,i,n,s,o]),registerEvents(t);let c=createInput(a);const u=o.label;let d=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),empty(e),s===o.checkedTemplate||stringify$1(s).toLocaleLowerCase(o.locale)===stringify$1(o.checkedTemplate).toLocaleLowerCase(o.locale)?c.checked=!0:s===o.uncheckedTemplate||stringify$1(s).toLocaleLowerCase(o.locale)===stringify$1(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?c.checked=!1:isEmpty(s)?addClass$1(c,"noValue"):(c.style.display="none",addClass$1(c,BAD_VALUE_CLASS),d=!0),setAttribute(c,[[ATTR_ROW,r],[ATTR_COLUMN,i]]),l&&setAttribute(c,[A11Y_LABEL(c.checked?t.getTranslatedPhrase(CHECKBOX_CHECKED):t.getTranslatedPhrase(CHECKBOX_UNCHECKED)),A11Y_CHECKED(c.checked),A11Y_CHECKBOX()]),!d&&u){let m="";if(u.value)m=typeof u.value=="function"?u.value.call(this,r,i,n,s):u.value;else if(u.property){const y=t.getDataAtRowProp(r,u.property);m=y!==null?y:""}const C=createLabel(a,m,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(C),e.appendChild(c)):(C.appendChild(c),c=C):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(c),e.appendChild(C)):(C.insertBefore(c,C.firstChild),c=C))}(!u||u&&!u.separated)&&e.appendChild(c),d&&e.appendChild(a.createTextNode("#bad-value#")),isListeningKeyDownEvent.has(t)||(isListeningKeyDownEvent.set(t,!0),h());function h(){const C=t.getShortcutManager().getContext("grid"),y={group:SHORTCUTS_GROUP$c,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const v=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&v?.highlight.isCell()&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}}],y)}function f(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=t.getSelectedRange(),y=[],v=new Map;let E=[],$=0;if(C){for(let O=0;O<C.length;O++){const{row:P,col:I}=C[O].getTopStartCorner(),{row:W,col:q}=C[O].getBottomEndCorner();for(let M=P;M<=W;M+=1)for(let Y=I;Y<=q;Y+=1){const z=t.getCellMeta(M,Y);if(z.hidden)continue;const Q={checkedTemplate:z.checkedTemplate,uncheckedTemplate:z.uncheckedTemplate};if(z.type!=="checkbox"){m===!0&&!z.readOnly&&(v.has(y.length)?v.set(y.length,[...v.get(y.length),[M,Y,null]]):v.set(y.length,[[M,Y,null]]));continue}if(z.readOnly===!0)continue;typeof z.checkedTemplate>"u"&&(z.checkedTemplate=!0),typeof z.uncheckedTemplate>"u"&&(z.uncheckedTemplate=!1);const K=t.getDataAtCell(M,Y);m===!1?[z.checkedTemplate,z.checkedTemplate.toString()].includes(K)?E.push([M,Y,z.uncheckedTemplate,Q]):[z.uncheckedTemplate,z.uncheckedTemplate.toString(),null,void 0].includes(K)&&E.push([M,Y,z.checkedTemplate,Q]):E.push([M,Y,z.uncheckedTemplate,Q]),$+=1}y.push($),$=0}E.every(O=>{let[,,P]=O;return P===E[0][2]})?E=E.map(O=>{let[P,I,W]=O;return[P,I,W]}):E=E.map(O=>{let[P,I,,W]=O;return[P,I,W.checkedTemplate]}),E.length>0&&y.forEach((O,P)=>{let I=E.splice(0,O);v.size&&v.has(P)&&(I=[...I,...v.get(P)]),t.setDataAtCell(I)})}}function g(){const m=t.getSelectedRange();if(m){for(let C=0;C<m.length;C++){const y=m[C].getTopStartCorner(),v=m[C].getBottomEndCorner();for(let E=y.row;E<=v.row;E++)for(let $=y.col;$<=v.col;$++){if(t.getCellMeta(E,$).readOnly)continue;const P=t.getCell(E,$);if(isHTMLElement(P)&&P.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}checkboxRenderer.RENDERER_TYPE=RENDERER_TYPE$6;function registerEvents(t){let e=isCheckboxListenerAdded.get(t);if(!e){const{rootElement:r}=t;e=new EventManager(t),e.addEventListener(r,"click",i=>onClick(i,t)),e.addEventListener(r,"mouseup",i=>onMouseUp(i,t)),e.addEventListener(r,"change",i=>onChange(i,t)),isCheckboxListenerAdded.set(t,e)}return e}function createInput(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function createLabel(t,e,r){const i=t.createElement("label");i.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`;const n=t.createTextNode(e);if(r){const s=t.createElement("span");s.appendChild(n),i.appendChild(s)}else i.appendChild(n);return i.cloneNode(!0)}function onMouseUp(t,e){const{target:r}=t;isCheckboxInput(r)&&(!r.hasAttribute(ATTR_ROW)||!r.hasAttribute(ATTR_COLUMN)||setTimeout(e.listen,10))}function onClick(t,e){const{target:r}=t;if(!isCheckboxInput(r)||!r.hasAttribute(ATTR_ROW)||!r.hasAttribute(ATTR_COLUMN))return;const i=parseInt(r.getAttribute(ATTR_ROW),10),n=parseInt(r.getAttribute(ATTR_COLUMN),10);e.getCellMeta(i,n).readOnly&&t.preventDefault()}function onChange(t,e){const{target:r}=t;if(!isCheckboxInput(r)||!r.hasAttribute(ATTR_ROW)||!r.hasAttribute(ATTR_COLUMN))return;const i=parseInt(r.getAttribute(ATTR_ROW),10),n=parseInt(r.getAttribute(ATTR_COLUMN),10),s=e.getCellMeta(i,n);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(i,n,o)}}function isCheckboxInput(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const RENDERER_TYPE$5="handsontable";function handsontableRenderer(t,e,r,i,n,s,o){autocompleteRenderer.apply(this,[t,e,r,i,n,s,o])}handsontableRenderer.RENDERER_TYPE=RENDERER_TYPE$5;var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var enUS,hasRequiredEnUS;function requireEnUS(){return hasRequiredEnUS||(hasRequiredEnUS=1,enUS={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),enUS}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var unformatting,hasRequiredUnformatting;function requireUnformatting(){if(hasRequiredUnformatting)return unformatting;hasRequiredUnformatting=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(l,c,u,d,h,f,g){if(!isNaN(+l))return+l;let m="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*r(C,c,u,d,h,f);for(let P=0;P<t.length;P++){let I=t[P];if(m=l.replace(RegExp(`([0-9 ])(${I.key})$`),"$1"),m!==l)return r(m,c,u,d,h,f)*I.factor}if(m=l.replace("%",""),m!==l)return r(m,c,u,d,h,f)/100;let y=parseFloat(l);if(isNaN(y))return;let v=d(y);if(v&&v!=="."&&(m=l.replace(new RegExp(`${e(v)}$`),""),m!==l))return r(m,c,u,d,h,f);let E={};Object.keys(f).forEach(P=>{E[f[P]]=P});let $=Object.keys(E).sort().reverse(),O=$.length;for(let P=0;P<O;P++){let I=$[P],W=E[I];if(m=l.replace(I,""),m!==l){let q;switch(W){case"thousand":q=Math.pow(10,3);break;case"million":q=Math.pow(10,6);break;case"billion":q=Math.pow(10,9);break;case"trillion":q=Math.pow(10,12);break}return r(m,c,u,d,h,f)*q}}}function i(l,c,u){let d=l.replace(u,"");return d=d.replace(new RegExp(`([0-9])${e(c.thousands)}([0-9])`,"g"),"$1$2"),d=d.replace(c.decimal,"."),d}function n(l,c,u="",d,h,f,g){if(l==="")return;if(l===h)return 0;let m=i(l,c,u);return r(m,c,u,d,h,f)}function s(l,c){if(!(l.indexOf(":")&&c.thousands!==":"))return!1;let d=l.split(":");if(d.length!==3)return!1;let h=+d[0],f=+d[1],g=+d[2];return!isNaN(h)&&!isNaN(f)&&!isNaN(g)}function o(l){let c=l.split(":"),u=+c[0],d=+c[1];return+c[2]+60*d+3600*u}function a(l,c){const u=requireGlobalState();let d=u.currentDelimiters(),h=u.currentCurrency().symbol,f=u.currentOrdinal(),g=u.getZeroFormat(),m=u.currentAbbreviations(),C;if(typeof l=="string")s(l,d)?C=o(l):C=n(l,d,h,f,g,m);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return unformatting={unformat:a},unformatting}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var validating$1,hasRequiredValidating;function requireValidating(){if(hasRequiredValidating)return validating$1;hasRequiredValidating=1;let t=requireUnformatting();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,r=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],n=["prefix","infix","postfix"],s=["sign","parenthesis"],o={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},c={output:{type:"string",validValues:r},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,y)=>y.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,y)=>y.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:n},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,y)=>!y.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,y)=>y.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},u={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:o,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function d(C,y){let v=h(C),E=g(y);return v&&E}function h(C){return t.unformat(C)!==void 0}function f(C,y,v,E=!1){let $=Object.keys(C).map(O=>{if(!y[O])return console.error(`${v} Invalid key: ${O}`),!1;let P=C[O],I=y[O];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!f(P,c,`[Validate ${O}]`,!0))return!1}else if(typeof P!==I.type)return console.error(`${v} ${O} type mismatched: "${I.type}" expected, "${typeof P}" provided`),!1;if(I.restrictions&&I.restrictions.length){let W=I.restrictions.length;for(let q=0;q<W;q++){let{restriction:M,message:Y}=I.restrictions[q];if(!M(P,C))return console.error(`${v} ${O} invalid value: ${Y}`),!1}}return I.restriction&&!I.restriction(P,C)?(console.error(`${v} ${O} invalid value: ${I.message}`),!1):I.validValues&&I.validValues.indexOf(P)===-1?(console.error(`${v} ${O} invalid value: must be among ${JSON.stringify(I.validValues)}, "${P}" provided`),!1):!(I.children&&!f(P,I.children,`[Validate ${O}]`))});return E||$.push(...Object.keys(y).map(O=>{let P=y[O];if(typeof P=="string"&&(P={type:P}),P.mandatory){let I=P.mandatory;if(typeof I=="function"&&(I=I(C)),I&&C[O]===void 0)return console.error(`${v} Missing mandatory key "${O}"`),!1}return!0})),$.reduce((O,P)=>O&&P,!0)}function g(C){return f(C,c,"[Validate format]")}function m(C){return f(C,u,"[Validate language]")}return validating$1={validate:d,validateFormat:g,validateInput:h,validateLanguage:m},validating$1}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function parsePrefix(t,e){let r=t.match(/^{([^}]*)}/);return r?(e.prefix=r[1],t.slice(r[0].length)):t}function parsePostfix(t,e){let r=t.match(/{([^}]*)}$/);return r?(e.postfix=r[1],t.slice(0,-r[0].length)):t}function parseOutput(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function parseThousandSeparated(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function parseSpaceSeparated(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function parseTotalLength(t,e){let r=t.match(/[1-9]+[0-9]*/);r&&(e.totalLength=+r[0])}function parseCharacteristic(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function parseMantissa(t,e){let r=t.split(".")[1];if(r){let i=r.match(/0+/);i&&(e.mantissa=i[0].length)}}function parseTrimMantissa(t,e){const r=t.split(".")[1];r&&(e.trimMantissa=r.indexOf("[")!==-1)}function parseAverage(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function parseForceAverage(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function parseOptionalMantissa(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function parseOptionalCharacteristic(t,e){if(t.indexOf(".")!==-1){let r=t.split(".")[0];e.optionalCharacteristic=r.indexOf("0")===-1}}function parseNegative(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function parseForceSign(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function parseFormat(t,e={}){return typeof t!="string"?t:(t=parsePrefix(t,e),t=parsePostfix(t,e),parseOutput(t,e),parseTotalLength(t,e),parseCharacteristic(t,e),parseOptionalCharacteristic(t,e),parseAverage(t,e),parseForceAverage(t,e),parseMantissa(t,e),parseOptionalMantissa(t,e),parseTrimMantissa(t,e),parseThousandSeparated(t,e),parseSpaceSeparated(t,e),parseNegative(t,e),parseForceSign(t,e),e)}var parsing$2={parseFormat};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var globalState$2,hasRequiredGlobalState;function requireGlobalState(){if(hasRequiredGlobalState)return globalState$2;hasRequiredGlobalState=1;const t=requireEnUS(),e=requireValidating(),r=parsing$2;let i={},n,s={},o=null,a={};function l(u){n=u}function c(){return s[n]}return i.languages=()=>Object.assign({},s),i.currentLanguage=()=>n,i.currentBytes=()=>c().bytes||{},i.currentCurrency=()=>c().currency,i.currentAbbreviations=()=>c().abbreviations,i.currentDelimiters=()=>c().delimiters,i.currentOrdinal=()=>c().ordinal,i.currentDefaults=()=>Object.assign({},c().defaults,a),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().timeFormat),i.setDefaults=u=>{u=r.parseFormat(u),e.validateFormat(u)&&(a=u)},i.getZeroFormat=()=>o,i.setZeroFormat=u=>o=typeof u=="string"?u:null,i.hasZeroFormat=()=>o!==null,i.languageData=u=>{if(u){if(s[u])return s[u];throw new Error(`Unknown tag "${u}"`)}return c()},i.registerLanguage=(u,d=!1)=>{if(!e.validateLanguage(u))throw new Error("Invalid language data");s[u.languageTag]=u,d&&l(u.languageTag)},i.setLanguage=(u,d=t.languageTag)=>{if(!s[u]){let h=u.split("-")[0],f=Object.keys(s).find(g=>g.split("-")[0]===h);if(!s[f]){l(d);return}l(f);return}l(u)},i.registerLanguage(t),n=t.languageTag,globalState$2=i,globalState$2}function commonjsRequire(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function loadLanguagesInNode(t,e){t.forEach(r=>{let i;try{i=commonjsRequire(`../languages/${r}`)}catch{console.error(`Unable to load "${r}". No matching language file found.`)}i&&e.registerLanguage(i)})}var loading=t=>({loadLanguagesInNode:e=>loadLanguagesInNode(e,t)}),bignumber={exports:{}};(function(t){(function(e){var r,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",l=1e14,c=14,u=9007199254740991,d=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,f=1e9;function g(P){var I,W,q,M=_.prototype={constructor:_,toString:null,valueOf:null},Y=new _(1),z=20,Q=4,K=-7,Z=21,ue=-1e7,oe=1e7,ae=!1,pe=1,fe=0,ge={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},ye="0123456789abcdefghijklmnopqrstuvwxyz",p=!0;function _(S,b){var R,T,A,D,B,N,H,L,U=this;if(!(U instanceof _))return new _(S,b);if(b==null){if(S&&S._isBigNumber===!0){U.s=S.s,!S.c||S.e>oe?U.c=U.e=null:S.e<ue?U.c=[U.e=0]:(U.e=S.e,U.c=S.c.slice());return}if((N=typeof S=="number")&&S*0==0){if(U.s=1/S<0?(S=-S,-1):1,S===~~S){for(D=0,B=S;B>=10;B/=10,D++);D>oe?U.c=U.e=null:(U.e=D,U.c=[S]);return}L=String(S)}else{if(!i.test(L=String(S)))return q(U,L,N);U.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}(D=L.indexOf("."))>-1&&(L=L.replace(".","")),(B=L.search(/e/i))>0?(D<0&&(D=B),D+=+L.slice(B+1),L=L.substring(0,B)):D<0&&(D=L.length)}else{if(v(b,2,ye.length,"Base"),b==10&&p)return U=new _(S),G(U,z+U.e+1,Q);if(L=String(S),N=typeof S=="number"){if(S*0!=0)return q(U,L,N,b);if(U.s=1/S<0?(L=L.slice(1),-1):1,_.DEBUG&&L.replace(/^0\.0*|\./,"").length>15)throw Error(a+S)}else U.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(R=ye.slice(0,b),D=B=0,H=L.length;B<H;B++)if(R.indexOf(T=L.charAt(B))<0){if(T=="."){if(B>D){D=H;continue}}else if(!A&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){A=!0,B=-1,D=0;continue}return q(U,String(S),N,b)}N=!1,L=W(L,b,10,U.s),(D=L.indexOf("."))>-1?L=L.replace(".",""):D=L.length}for(B=0;L.charCodeAt(B)===48;B++);for(H=L.length;L.charCodeAt(--H)===48;);if(L=L.slice(B,++H)){if(H-=B,N&&_.DEBUG&&H>15&&(S>u||S!==s(S)))throw Error(a+U.s*S);if((D=D-B-1)>oe)U.c=U.e=null;else if(D<ue)U.c=[U.e=0];else{if(U.e=D,U.c=[],B=(D+1)%c,D<0&&(B+=c),B<H){for(B&&U.c.push(+L.slice(0,B)),H-=c;B<H;)U.c.push(+L.slice(B,B+=c));B=c-(L=L.slice(B)).length}else B-=H;for(;B--;L+="0");U.c.push(+L)}}else U.c=[U.e=0]}_.clone=g,_.ROUND_UP=0,_.ROUND_DOWN=1,_.ROUND_CEIL=2,_.ROUND_FLOOR=3,_.ROUND_HALF_UP=4,_.ROUND_HALF_DOWN=5,_.ROUND_HALF_EVEN=6,_.ROUND_HALF_CEIL=7,_.ROUND_HALF_FLOOR=8,_.EUCLID=9,_.config=_.set=function(S){var b,R;if(S!=null)if(typeof S=="object"){if(S.hasOwnProperty(b="DECIMAL_PLACES")&&(R=S[b],v(R,0,f,b),z=R),S.hasOwnProperty(b="ROUNDING_MODE")&&(R=S[b],v(R,0,8,b),Q=R),S.hasOwnProperty(b="EXPONENTIAL_AT")&&(R=S[b],R&&R.pop?(v(R[0],-f,0,b),v(R[1],0,f,b),K=R[0],Z=R[1]):(v(R,-f,f,b),K=-(Z=R<0?-R:R))),S.hasOwnProperty(b="RANGE"))if(R=S[b],R&&R.pop)v(R[0],-f,-1,b),v(R[1],1,f,b),ue=R[0],oe=R[1];else if(v(R,-f,f,b),R)ue=-(oe=R<0?-R:R);else throw Error(o+b+" cannot be zero: "+R);if(S.hasOwnProperty(b="CRYPTO"))if(R=S[b],R===!!R)if(R)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ae=R;else throw ae=!R,Error(o+"crypto unavailable");else ae=R;else throw Error(o+b+" not true or false: "+R);if(S.hasOwnProperty(b="MODULO_MODE")&&(R=S[b],v(R,0,9,b),pe=R),S.hasOwnProperty(b="POW_PRECISION")&&(R=S[b],v(R,0,f,b),fe=R),S.hasOwnProperty(b="FORMAT"))if(R=S[b],typeof R=="object")ge=R;else throw Error(o+b+" not an object: "+R);if(S.hasOwnProperty(b="ALPHABET"))if(R=S[b],typeof R=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(R))p=R.slice(0,10)=="0123456789",ye=R;else throw Error(o+b+" invalid: "+R)}else throw Error(o+"Object expected: "+S);return{DECIMAL_PLACES:z,ROUNDING_MODE:Q,EXPONENTIAL_AT:[K,Z],RANGE:[ue,oe],CRYPTO:ae,MODULO_MODE:pe,POW_PRECISION:fe,FORMAT:ge,ALPHABET:ye}},_.isBigNumber=function(S){if(!S||S._isBigNumber!==!0)return!1;if(!_.DEBUG)return!0;var b,R,T=S.c,A=S.e,D=S.s;e:if({}.toString.call(T)=="[object Array]"){if((D===1||D===-1)&&A>=-f&&A<=f&&A===s(A)){if(T[0]===0){if(A===0&&T.length===1)return!0;break e}if(b=(A+1)%c,b<1&&(b+=c),String(T[0]).length==b){for(b=0;b<T.length;b++)if(R=T[b],R<0||R>=l||R!==s(R))break e;if(R!==0)return!0}}}else if(T===null&&A===null&&(D===null||D===1||D===-1))return!0;throw Error(o+"Invalid BigNumber: "+S)},_.maximum=_.max=function(){return x(arguments,-1)},_.minimum=_.min=function(){return x(arguments,1)},_.random=function(){var S=9007199254740992,b=Math.random()*S&2097151?function(){return s(Math.random()*S)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(R){var T,A,D,B,N,H=0,L=[],U=new _(Y);if(R==null?R=z:v(R,0,f),B=n(R/c),ae)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(B*=2));H<B;)N=T[H]*131072+(T[H+1]>>>11),N>=9e15?(A=crypto.getRandomValues(new Uint32Array(2)),T[H]=A[0],T[H+1]=A[1]):(L.push(N%1e14),H+=2);H=B/2}else if(crypto.randomBytes){for(T=crypto.randomBytes(B*=7);H<B;)N=(T[H]&31)*281474976710656+T[H+1]*1099511627776+T[H+2]*4294967296+T[H+3]*16777216+(T[H+4]<<16)+(T[H+5]<<8)+T[H+6],N>=9e15?crypto.randomBytes(7).copy(T,H):(L.push(N%1e14),H+=7);H=B/7}else throw ae=!1,Error(o+"crypto unavailable");if(!ae)for(;H<B;)N=b(),N<9e15&&(L[H++]=N%1e14);for(B=L[--H],R%=c,B&&R&&(N=d[c-R],L[H]=s(B/N)*N);L[H]===0;L.pop(),H--);if(H<0)L=[D=0];else{for(D=-1;L[0]===0;L.splice(0,1),D-=c);for(H=1,N=L[0];N>=10;N/=10,H++);H<c&&(D-=c-H)}return U.e=D,U.c=L,U}}(),_.sum=function(){for(var S=1,b=arguments,R=new _(b[0]);S<b.length;)R=R.plus(b[S++]);return R},W=function(){var S="0123456789";function b(R,T,A,D){for(var B,N=[0],H,L=0,U=R.length;L<U;){for(H=N.length;H--;N[H]*=T);for(N[0]+=D.indexOf(R.charAt(L++)),B=0;B<N.length;B++)N[B]>A-1&&(N[B+1]==null&&(N[B+1]=0),N[B+1]+=N[B]/A|0,N[B]%=A)}return N.reverse()}return function(R,T,A,D,B){var N,H,L,U,V,J,ee,ne,le=R.indexOf("."),ce=z,se=Q;for(le>=0&&(U=fe,fe=0,R=R.replace(".",""),ne=new _(T),J=ne.pow(R.length-le),fe=U,ne.c=b(O(C(J.c),J.e,"0"),10,A,S),ne.e=ne.c.length),ee=b(R,T,A,B?(N=ye,S):(N=S,ye)),L=U=ee.length;ee[--U]==0;ee.pop());if(!ee[0])return N.charAt(0);if(le<0?--L:(J.c=ee,J.e=L,J.s=D,J=I(J,ne,ce,se,A),ee=J.c,V=J.r,L=J.e),H=L+ce+1,le=ee[H],U=A/2,V=V||H<0||ee[H+1]!=null,V=se<4?(le!=null||V)&&(se==0||se==(J.s<0?3:2)):le>U||le==U&&(se==4||V||se==6&&ee[H-1]&1||se==(J.s<0?8:7)),H<1||!ee[0])R=V?O(N.charAt(1),-ce,N.charAt(0)):N.charAt(0);else{if(ee.length=H,V)for(--A;++ee[--H]>A;)ee[H]=0,H||(++L,ee=[1].concat(ee));for(U=ee.length;!ee[--U];);for(le=0,R="";le<=U;R+=N.charAt(ee[le++]));R=O(R,L,N.charAt(0))}return R}}(),I=function(){function S(T,A,D){var B,N,H,L,U=0,V=T.length,J=A%h,ee=A/h|0;for(T=T.slice();V--;)H=T[V]%h,L=T[V]/h|0,B=ee*H+L*J,N=J*H+B%h*h+U,U=(N/D|0)+(B/h|0)+ee*L,T[V]=N%D;return U&&(T=[U].concat(T)),T}function b(T,A,D,B){var N,H;if(D!=B)H=D>B?1:-1;else for(N=H=0;N<D;N++)if(T[N]!=A[N]){H=T[N]>A[N]?1:-1;break}return H}function R(T,A,D,B){for(var N=0;D--;)T[D]-=N,N=T[D]<A[D]?1:0,T[D]=N*B+T[D]-A[D];for(;!T[0]&&T.length>1;T.splice(0,1));}return function(T,A,D,B,N){var H,L,U,V,J,ee,ne,le,ce,se,ie,he,Te,Ae,Oe,Se,_e,ve=T.s==A.s?1:-1,me=T.c,de=A.c;if(!me||!me[0]||!de||!de[0])return new _(!T.s||!A.s||(me?de&&me[0]==de[0]:!de)?NaN:me&&me[0]==0||!de?ve*0:ve/0);for(le=new _(ve),ce=le.c=[],L=T.e-A.e,ve=D+L+1,N||(N=l,L=m(T.e/c)-m(A.e/c),ve=ve/c|0),U=0;de[U]==(me[U]||0);U++);if(de[U]>(me[U]||0)&&L--,ve<0)ce.push(1),V=!0;else{for(Ae=me.length,Se=de.length,U=0,ve+=2,J=s(N/(de[0]+1)),J>1&&(de=S(de,J,N),me=S(me,J,N),Se=de.length,Ae=me.length),Te=Se,se=me.slice(0,Se),ie=se.length;ie<Se;se[ie++]=0);_e=de.slice(),_e=[0].concat(_e),Oe=de[0],de[1]>=N/2&&Oe++;do{if(J=0,H=b(de,se,Se,ie),H<0){if(he=se[0],Se!=ie&&(he=he*N+(se[1]||0)),J=s(he/Oe),J>1)for(J>=N&&(J=N-1),ee=S(de,J,N),ne=ee.length,ie=se.length;b(ee,se,ne,ie)==1;)J--,R(ee,Se<ne?_e:de,ne,N),ne=ee.length,H=1;else J==0&&(H=J=1),ee=de.slice(),ne=ee.length;if(ne<ie&&(ee=[0].concat(ee)),R(se,ee,ie,N),ie=se.length,H==-1)for(;b(de,se,Se,ie)<1;)J++,R(se,Se<ie?_e:de,ie,N),ie=se.length}else H===0&&(J++,se=[0]);ce[U++]=J,se[0]?se[ie++]=me[Te]||0:(se=[me[Te]],ie=1)}while((Te++<Ae||se[0]!=null)&&ve--);V=se[0]!=null,ce[0]||ce.splice(0,1)}if(N==l){for(U=1,ve=ce[0];ve>=10;ve/=10,U++);G(le,D+(le.e=U+L*c-1)+1,B,V)}else le.e=L,le.r=+V;return le}}();function w(S,b,R,T){var A,D,B,N,H;if(R==null?R=Q:v(R,0,8),!S.c)return S.toString();if(A=S.c[0],B=S.e,b==null)H=C(S.c),H=T==1||T==2&&(B<=K||B>=Z)?$(H,B):O(H,B,"0");else if(S=G(new _(S),b,R),D=S.e,H=C(S.c),N=H.length,T==1||T==2&&(b<=D||D<=K)){for(;N<b;H+="0",N++);H=$(H,D)}else if(b-=B,H=O(H,D,"0"),D+1>N){if(--b>0)for(H+=".";b--;H+="0");}else if(b+=D-N,b>0)for(D+1==N&&(H+=".");b--;H+="0");return S.s<0&&A?"-"+H:H}function x(S,b){for(var R,T,A=1,D=new _(S[0]);A<S.length;A++)T=new _(S[A]),(!T.s||(R=y(D,T))===b||R===0&&D.s===b)&&(D=T);return D}function k(S,b,R){for(var T=1,A=b.length;!b[--A];b.pop());for(A=b[0];A>=10;A/=10,T++);return(R=T+R*c-1)>oe?S.c=S.e=null:R<ue?S.c=[S.e=0]:(S.e=R,S.c=b),S}q=function(){var S=/^(-?)0([xbo])(?=\w[\w.]*$)/i,b=/^([^.]+)\.$/,R=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,A=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(D,B,N,H){var L,U=N?B:B.replace(A,"");if(T.test(U))D.s=isNaN(U)?null:U<0?-1:1;else{if(!N&&(U=U.replace(S,function(V,J,ee){return L=(ee=ee.toLowerCase())=="x"?16:ee=="b"?2:8,!H||H==L?J:V}),H&&(L=H,U=U.replace(b,"$1").replace(R,"0.$1")),B!=U))return new _(U,L);if(_.DEBUG)throw Error(o+"Not a"+(H?" base "+H:"")+" number: "+B);D.s=null}D.c=D.e=null}}();function G(S,b,R,T){var A,D,B,N,H,L,U,V=S.c,J=d;if(V){e:{for(A=1,N=V[0];N>=10;N/=10,A++);if(D=b-A,D<0)D+=c,B=b,H=V[L=0],U=s(H/J[A-B-1]%10);else if(L=n((D+1)/c),L>=V.length)if(T){for(;V.length<=L;V.push(0));H=U=0,A=1,D%=c,B=D-c+1}else break e;else{for(H=N=V[L],A=1;N>=10;N/=10,A++);D%=c,B=D-c+A,U=B<0?0:s(H/J[A-B-1]%10)}if(T=T||b<0||V[L+1]!=null||(B<0?H:H%J[A-B-1]),T=R<4?(U||T)&&(R==0||R==(S.s<0?3:2)):U>5||U==5&&(R==4||T||R==6&&(D>0?B>0?H/J[A-B]:0:V[L-1])%10&1||R==(S.s<0?8:7)),b<1||!V[0])return V.length=0,T?(b-=S.e+1,V[0]=J[(c-b%c)%c],S.e=-b||0):V[0]=S.e=0,S;if(D==0?(V.length=L,N=1,L--):(V.length=L+1,N=J[c-D],V[L]=B>0?s(H/J[A-B]%J[B])*N:0),T)for(;;)if(L==0){for(D=1,B=V[0];B>=10;B/=10,D++);for(B=V[0]+=N,N=1;B>=10;B/=10,N++);D!=N&&(S.e++,V[0]==l&&(V[0]=1));break}else{if(V[L]+=N,V[L]!=l)break;V[L--]=0,N=1}for(D=V.length;V[--D]===0;V.pop());}S.e>oe?S.c=S.e=null:S.e<ue&&(S.c=[S.e=0])}return S}function j(S){var b,R=S.e;return R===null?S.toString():(b=C(S.c),b=R<=K||R>=Z?$(b,R):O(b,R,"0"),S.s<0?"-"+b:b)}return M.absoluteValue=M.abs=function(){var S=new _(this);return S.s<0&&(S.s=1),S},M.comparedTo=function(S,b){return y(this,new _(S,b))},M.decimalPlaces=M.dp=function(S,b){var R,T,A,D=this;if(S!=null)return v(S,0,f),b==null?b=Q:v(b,0,8),G(new _(D),S+D.e+1,b);if(!(R=D.c))return null;if(T=((A=R.length-1)-m(this.e/c))*c,A=R[A])for(;A%10==0;A/=10,T--);return T<0&&(T=0),T},M.dividedBy=M.div=function(S,b){return I(this,new _(S,b),z,Q)},M.dividedToIntegerBy=M.idiv=function(S,b){return I(this,new _(S,b),0,1)},M.exponentiatedBy=M.pow=function(S,b){var R,T,A,D,B,N,H,L,U,V=this;if(S=new _(S),S.c&&!S.isInteger())throw Error(o+"Exponent not an integer: "+j(S));if(b!=null&&(b=new _(b)),N=S.e>14,!V.c||!V.c[0]||V.c[0]==1&&!V.e&&V.c.length==1||!S.c||!S.c[0])return U=new _(Math.pow(+j(V),N?S.s*(2-E(S)):+j(S))),b?U.mod(b):U;if(H=S.s<0,b){if(b.c?!b.c[0]:!b.s)return new _(NaN);T=!H&&V.isInteger()&&b.isInteger(),T&&(V=V.mod(b))}else{if(S.e>9&&(V.e>0||V.e<-1||(V.e==0?V.c[0]>1||N&&V.c[1]>=24e7:V.c[0]<8e13||N&&V.c[0]<=9999975e7)))return D=V.s<0&&E(S)?-0:0,V.e>-1&&(D=1/D),new _(H?1/D:D);fe&&(D=n(fe/c+2))}for(N?(R=new _(.5),H&&(S.s=1),L=E(S)):(A=Math.abs(+j(S)),L=A%2),U=new _(Y);;){if(L){if(U=U.times(V),!U.c)break;D?U.c.length>D&&(U.c.length=D):T&&(U=U.mod(b))}if(A){if(A=s(A/2),A===0)break;L=A%2}else if(S=S.times(R),G(S,S.e+1,1),S.e>14)L=E(S);else{if(A=+j(S),A===0)break;L=A%2}V=V.times(V),D?V.c&&V.c.length>D&&(V.c.length=D):T&&(V=V.mod(b))}return T?U:(H&&(U=Y.div(U)),b?U.mod(b):D?G(U,fe,Q,B):U)},M.integerValue=function(S){var b=new _(this);return S==null?S=Q:v(S,0,8),G(b,b.e+1,S)},M.isEqualTo=M.eq=function(S,b){return y(this,new _(S,b))===0},M.isFinite=function(){return!!this.c},M.isGreaterThan=M.gt=function(S,b){return y(this,new _(S,b))>0},M.isGreaterThanOrEqualTo=M.gte=function(S,b){return(b=y(this,new _(S,b)))===1||b===0},M.isInteger=function(){return!!this.c&&m(this.e/c)>this.c.length-2},M.isLessThan=M.lt=function(S,b){return y(this,new _(S,b))<0},M.isLessThanOrEqualTo=M.lte=function(S,b){return(b=y(this,new _(S,b)))===-1||b===0},M.isNaN=function(){return!this.s},M.isNegative=function(){return this.s<0},M.isPositive=function(){return this.s>0},M.isZero=function(){return!!this.c&&this.c[0]==0},M.minus=function(S,b){var R,T,A,D,B=this,N=B.s;if(S=new _(S,b),b=S.s,!N||!b)return new _(NaN);if(N!=b)return S.s=-b,B.plus(S);var H=B.e/c,L=S.e/c,U=B.c,V=S.c;if(!H||!L){if(!U||!V)return U?(S.s=-b,S):new _(V?B:NaN);if(!U[0]||!V[0])return V[0]?(S.s=-b,S):new _(U[0]?B:Q==3?-0:0)}if(H=m(H),L=m(L),U=U.slice(),N=H-L){for((D=N<0)?(N=-N,A=U):(L=H,A=V),A.reverse(),b=N;b--;A.push(0));A.reverse()}else for(T=(D=(N=U.length)<(b=V.length))?N:b,N=b=0;b<T;b++)if(U[b]!=V[b]){D=U[b]<V[b];break}if(D&&(A=U,U=V,V=A,S.s=-S.s),b=(T=V.length)-(R=U.length),b>0)for(;b--;U[R++]=0);for(b=l-1;T>N;){if(U[--T]<V[T]){for(R=T;R&&!U[--R];U[R]=b);--U[R],U[T]+=l}U[T]-=V[T]}for(;U[0]==0;U.splice(0,1),--L);return U[0]?k(S,U,L):(S.s=Q==3?-1:1,S.c=[S.e=0],S)},M.modulo=M.mod=function(S,b){var R,T,A=this;return S=new _(S,b),!A.c||!S.s||S.c&&!S.c[0]?new _(NaN):!S.c||A.c&&!A.c[0]?new _(A):(pe==9?(T=S.s,S.s=1,R=I(A,S,0,3),S.s=T,R.s*=T):R=I(A,S,0,pe),S=A.minus(R.times(S)),!S.c[0]&&pe==1&&(S.s=A.s),S)},M.multipliedBy=M.times=function(S,b){var R,T,A,D,B,N,H,L,U,V,J,ee,ne,le,ce,se=this,ie=se.c,he=(S=new _(S,b)).c;if(!ie||!he||!ie[0]||!he[0])return!se.s||!S.s||ie&&!ie[0]&&!he||he&&!he[0]&&!ie?S.c=S.e=S.s=null:(S.s*=se.s,!ie||!he?S.c=S.e=null:(S.c=[0],S.e=0)),S;for(T=m(se.e/c)+m(S.e/c),S.s*=se.s,H=ie.length,V=he.length,H<V&&(ne=ie,ie=he,he=ne,A=H,H=V,V=A),A=H+V,ne=[];A--;ne.push(0));for(le=l,ce=h,A=V;--A>=0;){for(R=0,J=he[A]%ce,ee=he[A]/ce|0,B=H,D=A+B;D>A;)L=ie[--B]%ce,U=ie[B]/ce|0,N=ee*L+U*J,L=J*L+N%ce*ce+ne[D]+R,R=(L/le|0)+(N/ce|0)+ee*U,ne[D--]=L%le;ne[D]=R}return R?++T:ne.splice(0,1),k(S,ne,T)},M.negated=function(){var S=new _(this);return S.s=-S.s||null,S},M.plus=function(S,b){var R,T=this,A=T.s;if(S=new _(S,b),b=S.s,!A||!b)return new _(NaN);if(A!=b)return S.s=-b,T.minus(S);var D=T.e/c,B=S.e/c,N=T.c,H=S.c;if(!D||!B){if(!N||!H)return new _(A/0);if(!N[0]||!H[0])return H[0]?S:new _(N[0]?T:A*0)}if(D=m(D),B=m(B),N=N.slice(),A=D-B){for(A>0?(B=D,R=H):(A=-A,R=N),R.reverse();A--;R.push(0));R.reverse()}for(A=N.length,b=H.length,A-b<0&&(R=H,H=N,N=R,b=A),A=0;b;)A=(N[--b]=N[b]+H[b]+A)/l|0,N[b]=l===N[b]?0:N[b]%l;return A&&(N=[A].concat(N),++B),k(S,N,B)},M.precision=M.sd=function(S,b){var R,T,A,D=this;if(S!=null&&S!==!!S)return v(S,1,f),b==null?b=Q:v(b,0,8),G(new _(D),S,b);if(!(R=D.c))return null;if(A=R.length-1,T=A*c+1,A=R[A]){for(;A%10==0;A/=10,T--);for(A=R[0];A>=10;A/=10,T++);}return S&&D.e+1>T&&(T=D.e+1),T},M.shiftedBy=function(S){return v(S,-u,u),this.times("1e"+S)},M.squareRoot=M.sqrt=function(){var S,b,R,T,A,D=this,B=D.c,N=D.s,H=D.e,L=z+4,U=new _("0.5");if(N!==1||!B||!B[0])return new _(!N||N<0&&(!B||B[0])?NaN:B?D:1/0);if(N=Math.sqrt(+j(D)),N==0||N==1/0?(b=C(B),(b.length+H)%2==0&&(b+="0"),N=Math.sqrt(+b),H=m((H+1)/2)-(H<0||H%2),N==1/0?b="5e"+H:(b=N.toExponential(),b=b.slice(0,b.indexOf("e")+1)+H),R=new _(b)):R=new _(N+""),R.c[0]){for(H=R.e,N=H+L,N<3&&(N=0);;)if(A=R,R=U.times(A.plus(I(D,A,L,1))),C(A.c).slice(0,N)===(b=C(R.c)).slice(0,N))if(R.e<H&&--N,b=b.slice(N-3,N+1),b=="9999"||!T&&b=="4999"){if(!T&&(G(A,A.e+z+2,0),A.times(A).eq(D))){R=A;break}L+=4,N+=4,T=1}else{(!+b||!+b.slice(1)&&b.charAt(0)=="5")&&(G(R,R.e+z+2,1),S=!R.times(R).eq(D));break}}return G(R,R.e+z+1,Q,S)},M.toExponential=function(S,b){return S!=null&&(v(S,0,f),S++),w(this,S,b,1)},M.toFixed=function(S,b){return S!=null&&(v(S,0,f),S=S+this.e+1),w(this,S,b)},M.toFormat=function(S,b,R){var T,A=this;if(R==null)S!=null&&b&&typeof b=="object"?(R=b,b=null):S&&typeof S=="object"?(R=S,S=b=null):R=ge;else if(typeof R!="object")throw Error(o+"Argument not an object: "+R);if(T=A.toFixed(S,b),A.c){var D,B=T.split("."),N=+R.groupSize,H=+R.secondaryGroupSize,L=R.groupSeparator||"",U=B[0],V=B[1],J=A.s<0,ee=J?U.slice(1):U,ne=ee.length;if(H&&(D=N,N=H,H=D,ne-=D),N>0&&ne>0){for(D=ne%N||N,U=ee.substr(0,D);D<ne;D+=N)U+=L+ee.substr(D,N);H>0&&(U+=L+ee.slice(D)),J&&(U="-"+U)}T=V?U+(R.decimalSeparator||"")+((H=+R.fractionGroupSize)?V.replace(new RegExp("\\d{"+H+"}\\B","g"),"$&"+(R.fractionGroupSeparator||"")):V):U}return(R.prefix||"")+T+(R.suffix||"")},M.toFraction=function(S){var b,R,T,A,D,B,N,H,L,U,V,J,ee=this,ne=ee.c;if(S!=null&&(N=new _(S),!N.isInteger()&&(N.c||N.s!==1)||N.lt(Y)))throw Error(o+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+j(N));if(!ne)return new _(ee);for(b=new _(Y),L=R=new _(Y),T=H=new _(Y),J=C(ne),D=b.e=J.length-ee.e-1,b.c[0]=d[(B=D%c)<0?c+B:B],S=!S||N.comparedTo(b)>0?D>0?b:L:N,B=oe,oe=1/0,N=new _(J),H.c[0]=0;U=I(N,b,0,1),A=R.plus(U.times(T)),A.comparedTo(S)!=1;)R=T,T=A,L=H.plus(U.times(A=L)),H=A,b=N.minus(U.times(A=b)),N=A;return A=I(S.minus(R),T,0,1),H=H.plus(A.times(L)),R=R.plus(A.times(T)),H.s=L.s=ee.s,D=D*2,V=I(L,T,D,Q).minus(ee).abs().comparedTo(I(H,R,D,Q).minus(ee).abs())<1?[L,T]:[H,R],oe=B,V},M.toNumber=function(){return+j(this)},M.toPrecision=function(S,b){return S!=null&&v(S,1,f),w(this,S,b,2)},M.toString=function(S){var b,R=this,T=R.s,A=R.e;return A===null?T?(b="Infinity",T<0&&(b="-"+b)):b="NaN":(S==null?b=A<=K||A>=Z?$(C(R.c),A):O(C(R.c),A,"0"):S===10&&p?(R=G(new _(R),z+A+1,Q),b=O(C(R.c),R.e,"0")):(v(S,2,ye.length,"Base"),b=W(O(C(R.c),A,"0"),10,S,T,!0)),T<0&&R.c[0]&&(b="-"+b)),b},M.valueOf=M.toJSON=function(){return j(this)},M._isBigNumber=!0,P!=null&&_.set(P),_}function m(P){var I=P|0;return P>0||P===I?I:I-1}function C(P){for(var I,W,q=1,M=P.length,Y=P[0]+"";q<M;){for(I=P[q++]+"",W=c-I.length;W--;I="0"+I);Y+=I}for(M=Y.length;Y.charCodeAt(--M)===48;);return Y.slice(0,M+1||1)}function y(P,I){var W,q,M=P.c,Y=I.c,z=P.s,Q=I.s,K=P.e,Z=I.e;if(!z||!Q)return null;if(W=M&&!M[0],q=Y&&!Y[0],W||q)return W?q?0:-Q:z;if(z!=Q)return z;if(W=z<0,q=K==Z,!M||!Y)return q?0:!M^W?1:-1;if(!q)return K>Z^W?1:-1;for(Q=(K=M.length)<(Z=Y.length)?K:Z,z=0;z<Q;z++)if(M[z]!=Y[z])return M[z]>Y[z]^W?1:-1;return K==Z?0:K>Z^W?1:-1}function v(P,I,W,q){if(P<I||P>W||P!==s(P))throw Error(o+(q||"Argument")+(typeof P=="number"?P<I||P>W?" out of range: ":" not an integer: ":" not a primitive number: ")+String(P))}function E(P){var I=P.c.length-1;return m(P.e/c)==I&&P.c[I]%2!=0}function $(P,I){return(P.length>1?P.charAt(0)+"."+P.slice(1):P)+(I<0?"e":"e+")+I}function O(P,I,W){var q,M;if(I<0){for(M=W+".";++I;M+=W);P=M+P}else if(q=P.length,++I>q){for(M=W,I-=q;--I;M+=W);P+=M}else I<q&&(P=P.slice(0,I)+"."+P.slice(I));return P}r=g(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(commonjsGlobal)})(bignumber);var bignumberExports=bignumber.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const globalState$1=requireGlobalState(),validating=requireValidating(),parsing$1=parsing$2,BigNumber$1=bignumberExports,powers={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},defaultOptions={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes,decimalSuffixes}=globalState$1.currentBytes(),bytes={general:{scale:1024,suffixes:decimalSuffixes},binary:{scale:1024,suffixes:binarySuffixes},decimal:{scale:1e3,suffixes:decimalSuffixes}};function format(t,e={},r){if(typeof e=="string"&&(e=parsing$1.parseFormat(e)),!validating.validateFormat(e))return"ERROR: invalid format";let n=e.prefix||"",s=e.postfix||"",o=formatNumbro(t,e,r);return o=insertPrefix(o,n),o=insertPostfix(o,s),o}function formatNumbro(t,e,r){switch(e.output){case"currency":return e=formatOrDefault(e,globalState$1.currentCurrencyDefaultFormat()),formatCurrency(t,e,globalState$1);case"percent":return e=formatOrDefault(e,globalState$1.currentPercentageDefaultFormat()),formatPercentage(t,e,globalState$1,r);case"byte":return e=formatOrDefault(e,globalState$1.currentByteDefaultFormat()),formatByte(t,e,globalState$1,r);case"time":return e=formatOrDefault(e,globalState$1.currentTimeDefaultFormat()),formatTime(t);case"ordinal":return e=formatOrDefault(e,globalState$1.currentOrdinalDefaultFormat()),formatOrdinal(t,e,globalState$1);case"number":default:return formatNumber({instance:t,providedFormat:e})}}function getDecimalByteUnit(t){let e=bytes.decimal;return getFormatByteUnits(t._value,e.suffixes,e.scale).suffix}function getBinaryByteUnit(t){let e=bytes.binary;return getFormatByteUnits(t._value,e.suffixes,e.scale).suffix}function getByteUnit(t){let e=bytes.general;return getFormatByteUnits(t._value,e.suffixes,e.scale).suffix}function getFormatByteUnits(t,e,r){let i=e[0],n=Math.abs(t);if(n>=r){for(let s=1;s<e.length;++s){let o=Math.pow(r,s),a=Math.pow(r,s+1);if(n>=o&&n<a){i=e[s],t=t/o;break}}i===e[0]&&(t=t/Math.pow(r,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function formatByte(t,e,r,i){let n=e.base||"binary",s=Object.assign({},defaultOptions,e);const{binarySuffixes:o,decimalSuffixes:a}=r.currentBytes();let c={general:{scale:1024,suffixes:a||decimalSuffixes,marker:"bd"},binary:{scale:1024,suffixes:o||binarySuffixes,marker:"b"},decimal:{scale:1e3,suffixes:a||decimalSuffixes,marker:"d"}}[n],{value:u,suffix:d}=getFormatByteUnits(t._value,c.suffixes,c.scale);return`${formatNumber({instance:i(u),providedFormat:e,state:r,defaults:r.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${d}`}function formatOrdinal(t,e,r){let i=r.currentOrdinal(),n=Object.assign({},defaultOptions,e),s=formatNumber({instance:t,providedFormat:e,state:r}),o=i(t._value);return`${s}${n.spaceSeparated?" ":""}${o}`}function formatTime(t){let e=Math.floor(t._value/60/60),r=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-r*60);return`${e}:${r<10?"0":""}${r}:${i<10?"0":""}${i}`}function formatPercentage(t,e,r,i){let n=e.prefixSymbol,s=formatNumber({instance:i(t._value*100),providedFormat:e,state:r}),o=Object.assign({},defaultOptions,e);return n?`%${o.spaceSeparated?" ":""}${s}`:`${s}${o.spaceSeparated?" ":""}%`}function formatCurrency(t,e,r){const i=r.currentCurrency();let n=Object.assign({},e),s=Object.assign({},defaultOptions,n),o,a="",l=!!s.totalLength||!!s.forceAverage||s.average,c=n.currencyPosition||i.position,u=n.currencySymbol||i.symbol;const d=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;n.lowPrecision===void 0&&(n.lowPrecision=!1),d&&(a=" "),c==="infix"&&(o=a+u+a);let h=formatNumber({instance:t,providedFormat:n,state:r,decimalSeparator:o});return c==="prefix"&&(t._value<0&&s.negative==="sign"?h=`-${a}${u}${h.slice(1)}`:t._value>0&&s.forceSign?h=`+${a}${u}${h.slice(1)}`:h=u+a+h),(!c||c==="postfix")&&(a=!s.spaceSeparatedAbbreviation&&l?"":a,h=h+a+u),h}function computeAverage({value:t,forceAverage:e,lowPrecision:r=!0,abbreviations:i,spaceSeparated:n=!1,totalLength:s=0,roundingFunction:o=Math.round}){let a="",l=Math.abs(t),c=-1;if(e&&i[e]&&powers[e]?(a=i[e],t=t/powers[e]):l>=powers.trillion||r&&o(l/powers.trillion)===1?(a=i.trillion,t=t/powers.trillion):l<powers.trillion&&l>=powers.billion||r&&o(l/powers.billion)===1?(a=i.billion,t=t/powers.billion):l<powers.billion&&l>=powers.million||r&&o(l/powers.million)===1?(a=i.million,t=t/powers.million):(l<powers.million&&l>=powers.thousand||r&&o(l/powers.thousand)===1)&&(a=i.thousand,t=t/powers.thousand),a&&(a=(n?" ":"")+a),s){let d=t<0,h=t.toString().split(".")[0],f=d?h.length-1:h.length;c=Math.max(s-f,0)}return{value:t,abbreviation:a,mantissaPrecision:c}}function computeExponential({value:t,characteristicPrecision:e}){let[r,i]=t.toExponential().split("e"),n=+r;if(!e)return{value:n,abbreviation:`e${i}`};let s=1;return s<e&&(n=n*Math.pow(10,e-s),i=+i-(e-s),i=i>=0?`+${i}`:i),{value:n,abbreviation:`e${i}`}}function zeroes(t){let e="";for(let r=0;r<t;r++)e+="0";return e}function toFixedLarge(t,e){let r=t.toString(),[i,n]=r.split("e"),[s,o=""]=i.split(".");if(+n>0)r=s+o+zeroes(n-o.length);else{let a=".";+s<0?a=`-0${a}`:a=`0${a}`;let l=(zeroes(-n-1)+Math.abs(s)+o).substr(0,e);l.length<e&&(l+=zeroes(e-l.length)),r=a+l}return+n>0&&e>0&&(r+=`.${zeroes(e)}`),r}function toFixed(t,e,r=Math.round){return t.toString().indexOf("e")!==-1?toFixedLarge(t,e):new BigNumber$1(r(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function setMantissaPrecision(t,e,r,i,n,s){if(i===-1)return t;let o=toFixed(e,i,s),[a,l=""]=o.toString().split(".");if(l.match(/^0+$/)&&(r||n))return a;let c=l.match(/0+$/);return n&&c?`${a}.${l.toString().slice(0,c.index)}`:o.toString()}function setCharacteristicPrecision(t,e,r,i){let n=t,[s,o]=n.toString().split(".");if(s.match(/^-?0$/)&&r)return o?`${s.replace("0","")}.${o}`:s.replace("0","");const a=e<0&&s.indexOf("-")===0;if(a&&(s=s.slice(1),n=n.slice(1)),s.length<i){let l=i-s.length;for(let c=0;c<l;c++)n=`0${n}`}return a&&(n=`-${n}`),n.toString()}function indexesOfGroupSpaces(t,e){let r=[],i=0;for(let n=t;n>0;n--)i===e&&(r.unshift(n),i=0),i++;return r}function replaceDelimiters(t,e,r,i,n){let s=i.currentDelimiters(),o=s.thousands;n=n||s.decimal;let a=s.thousandsSize||3,l=t.toString(),c=l.split(".")[0],u=l.split(".")[1];const d=e<0&&c.indexOf("-")===0;return r&&(d&&(c=c.slice(1)),indexesOfGroupSpaces(c.length,a).forEach((f,g)=>{c=c.slice(0,f+g)+o+c.slice(f+g)}),d&&(c=`-${c}`)),u?l=c+n+u:l=c,l}function insertAbbreviation(t,e){return t+e}function insertSign(t,e,r){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:r==="sign"?t:`(${t.replace("-","")})`}function insertPrefix(t,e){return e+t}function insertPostfix(t,e){return t+e}function formatNumber({instance:t,providedFormat:e,state:r=globalState$1,decimalSeparator:i,defaults:n=r.currentDefaults()}){let s=t._value;if(s===0&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(s))return s.toString();let o=Object.assign({},defaultOptions,n,e),a=o.totalLength,l=a?0:o.characteristic,c=o.optionalCharacteristic,u=o.forceAverage,d=o.lowPrecision,h=!!a||!!u||o.average,f=a?-1:h&&e.mantissa===void 0?0:o.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:o.optionalMantissa,m=o.trimMantissa,C=o.thousandSeparated,y=o.spaceSeparated,v=o.negative,E=o.forceSign,$=o.exponential,O=o.roundingFunction,P="";if(h){let W=computeAverage({value:s,forceAverage:u,lowPrecision:d,abbreviations:r.currentAbbreviations(),spaceSeparated:y,roundingFunction:O,totalLength:a});s=W.value,P+=W.abbreviation,a&&(f=W.mantissaPrecision)}if($){let W=computeExponential({value:s,characteristicPrecision:l});s=W.value,P=W.abbreviation+P}let I=setMantissaPrecision(s.toString(),s,g,f,m,O);return I=setCharacteristicPrecision(I,s,c,l),I=replaceDelimiters(I,s,C,r,i),(h||$)&&(I=insertAbbreviation(I,P)),(E||s<0)&&(I=insertSign(I,s,v)),I}function formatOrDefault(t,e){if(!t)return e;let r=Object.keys(t);return r.length===1&&r[0]==="output"?e:t}var formatting=t=>({format:(...e)=>format(...e,t),getByteUnit:(...e)=>getByteUnit(...e,t),getBinaryByteUnit:(...e)=>getBinaryByteUnit(...e,t),getDecimalByteUnit:(...e)=>getDecimalByteUnit(...e,t),formatOrDefault});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const BigNumber=bignumberExports;function add(t,e,r){let i=new BigNumber(t._value),n=e;return r.isNumbro(e)&&(n=e._value),n=new BigNumber(n),t._value=i.plus(n).toNumber(),t}function subtract(t,e,r){let i=new BigNumber(t._value),n=e;return r.isNumbro(e)&&(n=e._value),n=new BigNumber(n),t._value=i.minus(n).toNumber(),t}function multiply(t,e,r){let i=new BigNumber(t._value),n=e;return r.isNumbro(e)&&(n=e._value),n=new BigNumber(n),t._value=i.times(n).toNumber(),t}function divide(t,e,r){let i=new BigNumber(t._value),n=e;return r.isNumbro(e)&&(n=e._value),n=new BigNumber(n),t._value=i.dividedBy(n).toNumber(),t}function set(t,e,r){let i=e;return r.isNumbro(e)&&(i=e._value),t._value=i,t}function difference(t,e,r){let i=r(t._value);return subtract(i,e,r),Math.abs(i._value)}var manipulating=t=>({add:(e,r)=>add(e,r,t),subtract:(e,r)=>subtract(e,r,t),multiply:(e,r)=>multiply(e,r,t),divide:(e,r)=>divide(e,r,t),set:(e,r)=>set(e,r,t),difference:(e,r)=>difference(e,r,t),BigNumber});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const VERSION="2.5.0",globalState=requireGlobalState(),validator=requireValidating(),loader=loading(numbro),unformatter=requireUnformatting();let formatter=formatting(numbro),manipulate=manipulating(numbro);const parsing=parsing$2;class Numbro{constructor(e){this._value=e}clone(){return numbro(this._value)}format(e={}){return formatter.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=parsing.parseFormat(e)),e=formatter.formatOrDefault(e,globalState.currentCurrencyDefaultFormat()),e.output="currency",formatter.format(this,e)}formatTime(e={}){return e.output="time",formatter.format(this,e)}binaryByteUnits(){return formatter.getBinaryByteUnit(this)}decimalByteUnits(){return formatter.getDecimalByteUnit(this)}byteUnits(){return formatter.getByteUnit(this)}difference(e){return manipulate.difference(this,e)}add(e){return manipulate.add(this,e)}subtract(e){return manipulate.subtract(this,e)}multiply(e){return manipulate.multiply(this,e)}divide(e){return manipulate.divide(this,e)}set(e){return manipulate.set(this,normalizeInput(e))}value(){return this._value}valueOf(){return this._value}}function normalizeInput(t){let e=t;return numbro.isNumbro(t)?e=t._value:typeof t=="string"?e=numbro.unformat(t):isNaN(t)&&(e=NaN),e}function numbro(t){return new Numbro(normalizeInput(t))}numbro.version=VERSION;numbro.isNumbro=function(t){return t instanceof Numbro};numbro.language=globalState.currentLanguage;numbro.registerLanguage=globalState.registerLanguage;numbro.setLanguage=globalState.setLanguage;numbro.languages=globalState.languages;numbro.languageData=globalState.languageData;numbro.zeroFormat=globalState.setZeroFormat;numbro.defaultFormat=globalState.currentDefaults;numbro.setDefaults=globalState.setDefaults;numbro.defaultCurrencyFormat=globalState.currentCurrencyDefaultFormat;numbro.validate=validator.validate;numbro.loadLanguagesInNode=loader.loadLanguagesInNode;numbro.unformat=unformatter.unformat;numbro.BigNumber=manipulate.BigNumber;var numbro_1=numbro,numbro$1=getDefaultExportFromCjs(numbro_1);const RENDERER_TYPE$4="numeric";function getRenderedValue(t,e){if(isNumeric(t)){const r=e.numericFormat,i=r&&r.culture||"-",n=r&&r.pattern;if(typeof i<"u"&&!numbro$1.languages()[i]){const s=i.replace("-",""),o=numbro$1.allLanguages?numbro$1.allLanguages[i]:numbro$1[s];o&&numbro$1.registerLanguage(o)}numbro$1.setLanguage(i),t=numbro$1(t).format(n||"0")}return t}function numericRenderer(t,e,r,i,n,s,o){let a=s;if(isNumeric(a)){let c=[];if(Array.isArray(o.className))c=o.className;else{var l;const u=(l=o.className)!==null&&l!==void 0?l:"";u.length&&(c=u.split(" "))}a=getRenderedValue(a,o),c.indexOf("htLeft")<0&&c.indexOf("htCenter")<0&&c.indexOf("htRight")<0&&c.indexOf("htJustify")<0&&c.push("htRight"),c.indexOf("htNumeric")<0&&c.push("htNumeric"),o.className=c.join(" "),e.dir="ltr"}textRenderer(t,e,r,i,n,a,o)}numericRenderer.RENDERER_TYPE=RENDERER_TYPE$4;const RENDERER_TYPE$3="password";function passwordRenderer(t,e,r,i,n,s,o){textRenderer.apply(this,[t,e,r,i,n,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let c="";rangeEach(a-1,()=>{c+=l}),fastInnerHTML(e,c)}passwordRenderer.RENDERER_TYPE=RENDERER_TYPE$3;const RENDERER_TYPE$2="select";function selectRenderer(t,e,r,i,n,s,o){textRenderer.apply(this,[t,e,r,i,n,s,o])}selectRenderer.RENDERER_TYPE=RENDERER_TYPE$2;const RENDERER_TYPE$1="time";function timeRenderer(t,e,r,i,n,s,o){textRenderer.apply(this,[t,e,r,i,n,s,o]),e.dir="ltr"}timeRenderer.RENDERER_TYPE=RENDERER_TYPE$1;function registerAllRenderers(){_register$2(autocompleteRenderer),_register$2(baseRenderer),_register$2(checkboxRenderer),_register$2(dropdownRenderer),_register$2(handsontableRenderer),_register$2(htmlRenderer),_register$2(numericRenderer),_register$2(passwordRenderer),_register$2(selectRenderer),_register$2(textRenderer),_register$2(timeRenderer)}const VALIDATOR_TYPE$4="autocomplete";function autocompleteValidator(t,e){let r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,process(r,e)):process(r,e)(this.source):e(!0)}autocompleteValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$4;function process(t,e){const r=t;return function(i){let n=!1;for(let s=0,o=i.length;s<o;s++)if(r===i[s]){n=!0;break}e(n)}}function getNormalizedDate(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const dateHelpers=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate},Symbol.toStringTag,{value:"Module"})),VALIDATOR_TYPE$3="date";function dateValidator(t,e){const r=_getEditorInstance(EDITOR_TYPE$5,this.instance);let i=t,n=!0;i==null&&(i="");let s=hooks(i,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=hooks(new Date(i)).isValid()||s;if(this.allowEmpty&&i===""&&(o=!0,s=!0),o||(n=!1),!o&&s&&(n=!0),o&&!s)if(this.correctFormat===!0){const a=correctFormat(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),n=!0}else n=!1;e(n)}dateValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$3;function correctFormat(t,e){const r=hooks(getNormalizedDate(t)),i=hooks(t,e),n=t.search(/[A-Za-z]/g)>-1;let s;return r.isValid()&&r.format("x")===i.format("x")||!i.isValid()||n?s=r:s=i,s.format(e)}const VALIDATOR_TYPE$2="dropdown";function dropdownValidator(t,e){autocompleteValidator.apply(this,[t,e])}dropdownValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$2;const VALIDATOR_TYPE$1="numeric";function numericValidator(t,e){let r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:isNumeric(t))}numericValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$1;const STRICT_FORMATS=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],VALIDATOR_TYPE="time";function timeValidator(t,e){const r=this.timeFormat||"h:mm:ss a";let i=!0,n=t;n===null&&(n=""),n=/^\d{3,}$/.test(n)?parseInt(n,10):n;const s=/^\d{1,2}$/.test(n);s&&(n+=":00");const o=hooks(n,STRICT_FORMATS,!0).isValid()?hooks(n):hooks(n,r);let a=o.isValid(),l=hooks(n,r,!0).isValid()&&!s;if(this.allowEmpty&&n===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){const c=o.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,c,"timeValidator"),i=!0}else i=!1;e(i)}timeValidator.VALIDATOR_TYPE=VALIDATOR_TYPE;function registerAllValidators(){_register$1(autocompleteValidator),_register$1(dropdownValidator),_register$1(dateValidator),_register$1(numericValidator),_register$1(timeValidator)}const CELL_TYPE$8="autocomplete",AutocompleteCellType={CELL_TYPE:CELL_TYPE$8,editor:AutocompleteEditor,renderer:autocompleteRenderer,validator:autocompleteValidator},CELL_TYPE$7="checkbox",CheckboxCellType={CELL_TYPE:CELL_TYPE$7,editor:CheckboxEditor,renderer:checkboxRenderer},RENDERER_TYPE="date";function dateRenderer(t,e,r,i,n,s,o){autocompleteRenderer.apply(this,[t,e,r,i,n,s,o])}dateRenderer.RENDERER_TYPE=RENDERER_TYPE;const CELL_TYPE$6="date",DateCellType={CELL_TYPE:CELL_TYPE$6,editor:DateEditor,renderer:dateRenderer,validator:dateValidator},CELL_TYPE$5="dropdown",DropdownCellType={CELL_TYPE:CELL_TYPE$5,editor:DropdownEditor,renderer:dropdownRenderer,validator:dropdownValidator,filter:!1,strict:!0},CELL_TYPE$4="handsontable",HandsontableCellType={CELL_TYPE:CELL_TYPE$4,editor:HandsontableEditor,renderer:handsontableRenderer},CELL_TYPE$3="numeric",NumericCellType={CELL_TYPE:CELL_TYPE$3,editor:NumericEditor,renderer:numericRenderer,validator:numericValidator,dataType:"number"},CELL_TYPE$2="password",PasswordCellType={CELL_TYPE:CELL_TYPE$2,editor:PasswordEditor,renderer:passwordRenderer,copyable:!1},CELL_TYPE$1="select",SelectCellType={CELL_TYPE:CELL_TYPE$1,editor:SelectEditor,renderer:selectRenderer},CELL_TYPE="time",TimeCellType={CELL_TYPE,editor:TimeEditor,renderer:timeRenderer,validator:timeValidator};function registerAllCellTypes(){_register(AutocompleteCellType),_register(CheckboxCellType),_register(DateCellType),_register(DropdownCellType),_register(HandsontableCellType),_register(NumericCellType),_register(PasswordCellType),_register(SelectCellType),_register(TextCellType),_register(TimeCellType)}function _classPrivateMethodInitSpec$I(t,e){_checkPrivateRedeclaration$V(t,e),e.add(t)}function _classPrivateFieldInitSpec$D(t,e,r){_checkPrivateRedeclaration$V(t,e),e.set(t,r)}function _checkPrivateRedeclaration$V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$19(t,e,r){return(e=_toPropertyKey$19(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$19(t){var e=_toPrimitive$19(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$19(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$D(t,e){return t.get(_assertClassBrand$V(t,e))}function _assertClassBrand$V(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const DEPS_TYPE_CHECKERS=new Map([["plugin",hasPlugin],["cell-type",hasItem],["editor",hasItem$3],["renderer",hasItem$2],["validator",hasItem$1]]),defaultMainSettingSymbol=Symbol("mainSetting"),PLUGIN_KEY$y="base",missingDepsMsgs=[];let initializedPlugins=null;var _hooks=new WeakMap,_BasePlugin_brand=new WeakSet;class BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$y}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){_classPrivateMethodInitSpec$I(this,_BasePlugin_brand),_defineProperty$19(this,"eventManager",new EventManager(this)),_defineProperty$19(this,"pluginName",null),_defineProperty$19(this,"pluginsInitializedCallbacks",[]),_defineProperty$19(this,"isPluginsReady",!1),_defineProperty$19(this,"enabled",!1),_defineProperty$19(this,"initialized",!1),_classPrivateFieldInitSpec$D(this,_hooks,{}),defineGetter(this,"hot",e,{writable:!1}),initializedPlugins=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const n=[];if(r.forEach(s=>{const[o,a]=s.split(":");if(!DEPS_TYPE_CHECKERS.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);DEPS_TYPE_CHECKERS.get(o)(a)||n.push(` - ${a} (${o})`)}),n.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${n.join(`
`)}
`].join("");missingDepsMsgs.push(s)}}if(initializedPlugins||(initializedPlugins=getPluginsNames()),initializedPlugins.indexOf(this.pluginName)>=0&&initializedPlugins.splice(initializedPlugins.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),initializedPlugins.length===0){if(missingDepsMsgs.length>0){const n=[`${missingDepsMsgs.join(`
`)}
`,"You have to import and register them manually."].join("");throw missingDepsMsgs.length=0,new Error(n)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return r;const i=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(r)||isObject(r))&&i[defaultMainSettingSymbol]===e){var n;return Array.isArray(r)?r:(n=r[e])!==null&&n!==void 0?n:i[e]}if(isObject(r)){var s;return(s=r[e])!==null&&s!==void 0?s:i[e]}return i[e]}addHook(e,r,i){_classPrivateFieldGet$D(_hooks,this)[e]=_classPrivateFieldGet$D(_hooks,this)[e]||[];const n=_classPrivateFieldGet$D(_hooks,this)[e];this.hot.addHook(e,r,i),n.push(r),_classPrivateFieldGet$D(_hooks,this)[e]=n}removeHooks(e){arrayEach(_classPrivateFieldGet$D(_hooks,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=_classPrivateFieldGet$D(_hooks,this);objectEach(e,(r,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){arrayEach(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=_assertClassBrand$V(_BasePlugin_brand,this,_isRelevantToSettings).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),objectEach(this,(r,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function _isRelevantToSettings(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function _defineProperty$18(t,e,r){return(e=_toPropertyKey$18(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$18(t){var e=_toPrimitive$18(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$18(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let GhostTable$1=class{constructor(e){_defineProperty$18(this,"hot",null),_defineProperty$18(this,"container",null),_defineProperty$18(this,"injected",!1),_defineProperty$18(this,"rows",[]),_defineProperty$18(this,"columns",[]),_defineProperty$18(this,"samples",null),_defineProperty$18(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&addClass$1(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),arrayEach(this.rows,r=>{const{height:i}=r.table.getBoundingClientRect();e(r.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),arrayEach(this.columns,r=>{const{width:i}=r.table.getBoundingClientRect();e(r.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{arrayEach(i.strings,n=>{r.appendChild(this.createColElement(n.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,i=r.createDocumentFragment(),n=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,n),i.appendChild(n)),this.samples.forEach(s=>{arrayEach(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),c=this.hot.getCellRenderer(l),u=r.createElement("td");u.setAttribute("ghost-table",1),c(this.hot,u,e,a,this.hot.colToProp(a),o.value,l),i.appendChild(u)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const n=e.createElement("th");i.push([-1,n]),r.appendChild(n)}this.samples.forEach(n=>{arrayEach(n.strings,s=>{const o=s.col,a=e.createElement("th");i.push([o,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),arrayEach(i,n=>{const[s,o]=n;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:r}=this.hot,i=r.createDocumentFragment();return this.samples.forEach(n=>{arrayEach(n.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),c=r.createElement("td"),u=r.createElement("tr");c.setAttribute("ghost-table",1),l(this.hot,c,o,e,this.hot.colToProp(e),s.value,a),u.appendChild(c),i.appendChild(u)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const i=this.hot.rootDocument.createElement("col");let n=0;r>=0&&e>=0&&(n=this.hot.getCellMeta(r,e).colspan);let s=this.hot.getColWidth(e);if(n>1)for(let o=e+1;o<e+n;o++)s+=this.hot.getColWidth(o);return i.style.width=`${s}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,i=r.createDocumentFragment(),n=r.createElement("table"),s=r.createElement("thead"),o=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),c=r.createElement("th");return this.isVertical()&&n.appendChild(a),this.isHorizontal()&&(l.appendChild(c),s.appendChild(l),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(s),this.isVertical()&&o.appendChild(l),n.appendChild(o),addClass$1(n,e),i.appendChild(n),{fragment:i,table:n,tHead:s,tBody:o,colGroup:a,tr:l,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,i=r.createDocumentFragment(),n=r.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return addClass$1(n,s),i.appendChild(n),{fragment:i,container:n}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function _defineProperty$17(t,e,r){return(e=_toPropertyKey$17(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$17(t){var e=_toPrimitive$17(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$17(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SamplesGenerator{static get SAMPLE_COUNT(){return 3}constructor(e){_defineProperty$17(this,"samples",null),_defineProperty$17(this,"dataFactory",null),_defineProperty$17(this,"customSampleCount",null),_defineProperty$17(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:SamplesGenerator.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,i){const n=new Map,{from:s,to:o}=typeof i=="number"?{from:i,to:i}:i;return rangeEach(s,o,a=>{const l=this.generateSample(e,r,a);n.set(a,l)}),n}generateSample(e,r,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const n=new Map,s=e==="row"?"col":"row",o=[];return rangeEach(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(i,a):this.dataFactory(a,i);if(l===!1)return;const{value:c,bundleSeed:u}=l,d=typeof u=="string"&&u.length>0;let h;d?h=u:isObject(c)?h=`${Object.keys(c).length}`:Array.isArray(c)?h=`${c.length}`:h=`${stringify$1(c).length}`,n.has(h)||n.set(h,{needed:this.getSampleCount(),strings:[]});const f=n.get(h);f.needed&&(!(o.indexOf(c)>-1)||this.allowDuplicates||d)&&(f.strings.push({value:c,[s]:a}),o.push(c),f.needed-=1)}),n}}function _classPrivateMethodInitSpec$H(t,e){_checkPrivateRedeclaration$U(t,e),e.add(t)}function _classPrivateFieldInitSpec$C(t,e,r){_checkPrivateRedeclaration$U(t,e),e.set(t,r)}function _checkPrivateRedeclaration$U(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$16(t,e,r){return(e=_toPropertyKey$16(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$16(t){var e=_toPrimitive$16(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$16(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$C(t,e){return t.get(_assertClassBrand$U(t,e))}function _classPrivateFieldSet$B(t,e,r){return t.set(_assertClassBrand$U(t,e),r),r}function _assertClassBrand$U(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("modifyAutoColumnSizeSeed");const PLUGIN_KEY$x="autoColumnSize",PLUGIN_PRIORITY$x=10,COLUMN_SIZE_MAP_NAME="autoColumnSize";var _isInitialized$1=new WeakMap,_cachedColumnHeaders=new WeakMap,_visualColumnsToRefresh=new WeakMap,_AutoColumnSize_brand=new WeakSet;class AutoColumnSize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$x}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$x}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),_classPrivateMethodInitSpec$H(this,_AutoColumnSize_brand),_defineProperty$16(this,"ghostTable",new GhostTable$1(this.hot)),_defineProperty$16(this,"samplesGenerator",new SamplesGenerator((r,i)=>{const n=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(r,i);let a="";o.spanned||(a=this.hot.getDataAtCell(r,i));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),_defineProperty$16(this,"inProgress",!1),_defineProperty$16(this,"measuredColumns",0),_defineProperty$16(this,"columnWidthsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec$C(this,_isInitialized$1,!1),_classPrivateFieldInitSpec$C(this,_cachedColumnHeaders,[]),_classPrivateFieldInitSpec$C(this,_visualColumnsToRefresh,[]),this.hot.columnIndexMapper.registerMap(COLUMN_SIZE_MAP_NAME,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,i,n)=>_assertClassBrand$U(_AutoColumnSize_brand,this,_onBeforeColumnResize$1).call(this,r,i,n))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$x]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$U(_AutoColumnSize_brand,e,_onAfterLoadData$7).call(e,...n)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$U(_AutoColumnSize_brand,e,_onBeforeChange$1).call(e,...n)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$U(_AutoColumnSize_brand,e,_onAfterFormulasValuesUpdate$1).call(e,...n)}),this.addHook("beforeRender",()=>_assertClassBrand$U(_AutoColumnSize_brand,this,_onBeforeRender$2).call(this)),this.addHook("modifyColWidth",(i,n)=>this.getColumnWidth(n,i)),this.addHook("init",()=>_assertClassBrand$U(_AutoColumnSize_brand,this,_onInit$3).call(this)),super.enablePlugin()}updatePlugin(){_classPrivateFieldSet$B(_visualColumnsToRefresh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,i)=>_assertClassBrand$U(_AutoColumnSize_brand,this,_onBeforeColumnResize$1).call(this,e,r,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const i=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;rangeEach(n.from,n.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&_assertClassBrand$U(_AutoColumnSize_brand,this,_fillGhostTableWithSamples).call(this,o,s)}),this.ghostTable.columns.length&&(_assertClassBrand$U(_AutoColumnSize_brand,this,_updateColumnWidthsMapBasedOnGhostTable).call(this),this.measuredColumns=n.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const n=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){cancelAnimationFrame(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+AutoColumnSize.CALCULATION_STEP,n)},e,r),i=i+AutoColumnSize.CALCULATION_STEP+1,i<n?s=requestAnimationFrame$1(o):(cancelAnimationFrame(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),i=a+1),i<n?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[PLUGIN_KEY$x];let r=AutoColumnSize.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return isObject(e)&&(r=e.syncLimit,isPercentValue(r)?r=valueAccordingPercent(i,r):r>>=0),Math.min(r,i)}getColumnWidth(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=r;return n===void 0&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof n=="number"&&(n=Math.max(n,DEFAULT_WIDTH))),n}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,n,s)=>{const o=_classPrivateFieldGet$C(_cachedColumnHeaders,this).length;return(o-1<s||_classPrivateFieldGet$C(_cachedColumnHeaders,this)[s]!==n)&&i.push(this.hot.toVisualColumn(s)),o-1<s?_classPrivateFieldGet$C(_cachedColumnHeaders,this).push(n):_classPrivateFieldGet$C(_cachedColumnHeaders,this)[s]=n,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _calculateSpecificColumnsWidth(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const i=this.hot.toPhysicalColumn(r);i!==null&&(this.hot._getColWidthFromSettings(i)||_assertClassBrand$U(_AutoColumnSize_brand,this,_fillGhostTableWithSamples).call(this,r,e))}),this.ghostTable.columns.length&&(_assertClassBrand$U(_AutoColumnSize_brand,this,_updateColumnWidthsMapBasedOnGhostTable).call(this),this.ghostTable.clean())}function _fillGhostTableWithSamples(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((i,n)=>this.ghostTable.addColumn(n,i))}function _updateColumnWidthsMapBasedOnGhostTable(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function _onBeforeRender$2(){this.calculateVisibleColumnsWidth(),this.inProgress||(_assertClassBrand$U(_AutoColumnSize_brand,this,_calculateSpecificColumnsWidth).call(this,_classPrivateFieldGet$C(_visualColumnsToRefresh,this)),_classPrivateFieldSet$B(_visualColumnsToRefresh,this,[]))}function _onAfterLoadData$7(t,e){e||this.recalculateAllColumnsWidth()}function _onBeforeChange$1(t){const e=t.reduce((r,i)=>{let[,n]=i;const s=this.hot.propToCol(n);return Number.isInteger(s)&&r.indexOf(s)===-1&&r.push(s),r},[]);_classPrivateFieldGet$C(_visualColumnsToRefresh,this).push(...e)}function _onBeforeColumnResize$1(t,e,r){let i=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function _onInit$3(){_classPrivateFieldSet$B(_cachedColumnHeaders,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),_classPrivateFieldSet$B(_isInitialized$1,this,!0)}function _onAfterFormulasValuesUpdate$1(t){if(!_classPrivateFieldGet$C(_isInitialized$1,this))return;const e=t.reduce((r,i)=>{var n;const s=(n=i.address)===null||n===void 0?void 0:n.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);_classPrivateFieldGet$C(_visualColumnsToRefresh,this).push(...e)}const DIRECTIONS={horizontal:"horizontal",vertical:"vertical"};function getDragDirectionAndRange(t,e,r){let i,n,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",i=r(e[0],e[1]),n=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",i=r(e[0],t[3]+1),n=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",i=r(e[0],e[1]),n=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",i=r(t[2]+1,e[1]),n=r(e[2],e[3])),i&&i.normalize(),n&&n.normalize(),{directionOfDrag:s,startOfDragCoords:i,endOfDragCoords:n}}function getMappedFillHandleSetting(t){const e={};return t===!0?(e.directions=Object.keys(DIRECTIONS),e.autoInsertRow=!0):isObject(t)?(isDefined(t.autoInsertRow)?t.direction===DIRECTIONS.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,isDefined(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(DIRECTIONS)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function _classPrivateMethodInitSpec$G(t,e){_checkPrivateRedeclaration$T(t,e),e.add(t)}function _checkPrivateRedeclaration$T(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$15(t,e,r){return(e=_toPropertyKey$15(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$15(t){var e=_toPrimitive$15(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$15(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$T(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("modifyAutofillRange");Hooks.getSingleton().register("beforeAutofill");Hooks.getSingleton().register("afterAutofill");const PLUGIN_KEY$w="autofill",PLUGIN_PRIORITY$w=20,SETTING_KEYS$3=["fillHandle"],INSERT_ROW_ALTER_ACTION_NAME="insert_row_below",INTERVAL_FOR_ADDING_ROW=200;var _Autofill_brand=new WeakSet;class Autofill extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$G(this,_Autofill_brand),_defineProperty$15(this,"addingStarted",!1),_defineProperty$15(this,"mouseDownOnCellCorner",!1),_defineProperty$15(this,"mouseDragOutside",!1),_defineProperty$15(this,"handleDraggedCells",0),_defineProperty$15(this,"directions",[]),_defineProperty$15(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$w}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$w}static get SETTING_KEYS(){return[PLUGIN_KEY$w,...SETTING_KEYS$3]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>_assertClassBrand$T(_Autofill_brand,this,_onAfterCellCornerMouseDown).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>_assertClassBrand$T(_Autofill_brand,this,_onCellCornerDblClick).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,r)=>_assertClassBrand$T(_Autofill_brand,this,_onBeforeCellMouseOver).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:r,col:i}=e.getTopStartCorner(),{row:n,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:i,endRow:n,endCol:s}]),a=[],l=[],c=[];return arrayEach(o,u=>{for(let d=u.startRow;d<=u.endRow;d+=1)a.indexOf(d)===-1&&a.push(d);for(let d=u.startCol;d<=u.endCol;d+=1)l.indexOf(d)===-1&&l.push(d)}),arrayEach(a,u=>{const d=[];arrayEach(l,h=>{d.push(this.hot.getCopyableData(u,h))}),c.push(d)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,r,i,n]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],c=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,r),Math.max(a.row,i),Math.max(a.col,n)],l),{directionOfDrag:u,startOfDragCoords:d,endOfDragCoords:h}=getDragDirectionAndRange(l,c,(f,g)=>this.hot._createCellCoords(f,g));if(d&&d.row>-1&&d.col>-1){const f=this.getSelectionData(),g=s.clone(),m=this.hot._createCellRange(d,d,h),C=this.hot.runHooks("beforeAutofill",f,g,m,u);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let y=C;const v=C;if(["up","left"].indexOf(u)>-1&&!(v.length===1&&v[0].length===0))if(y=[],u==="up"){const E=h.row-d.row+1,$=E%v.length;for(let O=0;O<E;O++)y.push(v[(O+(v.length-$))%v.length])}else{const E=h.col-d.col+1,$=E%v[0].length;for(let O=0;O<v.length;O++){y.push([]);for(let P=0;P<E;P++)y[O].push(v[O][(P+(v[O].length-$))%v[O].length])}}this.hot.populateFromArray(d.row,d.col,y,h.row,h.col,`${this.pluginName}.fill`,null),this.setSelection(c),this.hot.runHooks("afterAutofill",y,g,m,u),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const r=this.hot.getSelectedRangeLast(),i=r.getBottomEndCorner();let n=e;if(this.directions.includes(DIRECTIONS.vertical)&&this.directions.includes(DIRECTIONS.horizontal)){const s=r.getTopStartCorner();(i.col<=e.col||s.col>=e.col)&&(n=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||s.row>e.row)&&(n=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(DIRECTIONS.vertical))n=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(DIRECTIONS.horizontal))n=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(n)}showBorder(e){const r=this.getCoordsOfDragAndDropBorders(e);r&&this.redrawBorders(r)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(INSERT_ROW_ALTER_ACTION_NAME,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},INTERVAL_FOR_ADDING_ROW)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),r=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&r[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const r=this.hot.getData(),i=this.hot.countRows();let n;for(let s=e[2]+1;s<i;s++){for(let l=e[1];l<=e[3];l++){const c=r[s][l];if(!isEmpty(c))return-1}const o=r[s][e[1]-1],a=r[s][e[3]+1];(!isEmpty(o)||!isEmpty(a))&&(n=s)}return n}addSelectionFromStartAreaToSpecificRowIndex(e,r){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(r,e[3])).commit()}setSelection(e){this.hot.selectCell(...arrayMap(e,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),r=this.getIndexOfLastAdjacentFilledInRow(e);return r===-1||r===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,r),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:r}=this.hot.rootDocument,i=offset(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+outerHeight(this.hot.table),n=offset(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+outerWidth(this.hot.table);return e.clientY>i&&e.clientX<=n}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$T(_Autofill_brand,this,_onMouseUp$5).call(this)),this.eventManager.addEventListener(e,"mousemove",r=>_assertClassBrand$T(_Autofill_brand,this,_onMouseMove$4).call(this,r))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=getMappedFillHandleSetting(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function _onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}function _onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function _onBeforeCellMouseOver(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function _onMouseUp$5(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function _onMouseMove$4(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function _classPrivateMethodInitSpec$F(t,e){_checkPrivateRedeclaration$S(t,e),e.add(t)}function _classPrivateFieldInitSpec$B(t,e,r){_checkPrivateRedeclaration$S(t,e),e.set(t,r)}function _checkPrivateRedeclaration$S(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$14(t,e,r){return(e=_toPropertyKey$14(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$14(t){var e=_toPrimitive$14(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$14(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldSet$A(t,e,r){return t.set(_assertClassBrand$S(t,e),r),r}function _classPrivateFieldGet$B(t,e){return t.get(_assertClassBrand$S(t,e))}function _assertClassBrand$S(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$v="autoRowSize",PLUGIN_PRIORITY$v=40,ROW_WIDTHS_MAP_NAME="autoRowSize";var _visualRowsToRefresh=new WeakMap,_isInitialized=new WeakMap,_AutoRowSize_brand=new WeakSet;class AutoRowSize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$v}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$v}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),_classPrivateMethodInitSpec$F(this,_AutoRowSize_brand),_defineProperty$14(this,"headerHeight",null),_defineProperty$14(this,"ghostTable",new GhostTable$1(this.hot)),_defineProperty$14(this,"samplesGenerator",new SamplesGenerator((r,i)=>{const n=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(s)||r>=0&&i>=0&&this.hot.getCellMeta(r,i).hidden)return!1;let o;return r>=0?o=this.hot.getDataAtCell(r,i):r===-1&&(o=this.hot.getColHeader(i)),{value:o}})),_defineProperty$14(this,"inProgress",!1),_defineProperty$14(this,"measuredRows",0),_defineProperty$14(this,"rowHeightsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec$B(this,_visualRowsToRefresh,[]),_classPrivateFieldInitSpec$B(this,_isInitialized,!1),this.hot.rowIndexMapper.registerMap(ROW_WIDTHS_MAP_NAME,this.rowHeightsMap),this.addHook("beforeRowResize",(r,i,n)=>_assertClassBrand$S(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,r,i,n))}isEnabled(){const e=this.hot.getSettings()[PLUGIN_KEY$v];return e===!0||isObject(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$S(_AutoRowSize_brand,e,_onAfterLoadData$6).call(e,...n)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$S(_AutoRowSize_brand,e,_onBeforeChange).call(e,...n)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$S(_AutoRowSize_brand,e,_onAfterFormulasValuesUpdate).call(e,...n)}),this.addHook("beforeRender",()=>_assertClassBrand$S(_AutoRowSize_brand,this,_onBeforeRender$1).call(this)),this.addHook("modifyRowHeight",(i,n)=>this.getRowHeight(n,i)),this.addHook("init",()=>_assertClassBrand$S(_AutoRowSize_brand,this,_onInit$2).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,r,i)=>_assertClassBrand$S(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,e,r,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(e===-1||r===-1)return;const i=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:r},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}rangeEach(n.from,n.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(i||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((c,u)=>this.ghostTable.addRow(u,c))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=n.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const n=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){cancelAnimationFrame(s),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+AutoRowSize.CALCULATION_STEP,n)},e,r),i=i+AutoRowSize.CALCULATION_STEP+1,i<n?s=requestAnimationFrame$1(o):(cancelAnimationFrame(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,r),i=a+1),i<n?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[PLUGIN_KEY$v];let r=AutoRowSize.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return isObject(e)&&(r=e.syncLimit,isPercentValue(r)?r=valueAccordingPercent(i,r):r>>=0),Math.min(r,i)}getRowHeight(e,r){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let n=r;return i!==null&&i>(r||0)&&(n=i),n}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:r,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{rangeEach(Math.min(r,i),Math.max(r,i),n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _calculateSpecificRowsHeight(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(r=>{this.samplesGenerator.generateRowSamples(r,e).forEach((n,s)=>this.ghostTable.addRow(s,n))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,i)=>{const n=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(n,i)})},!0),this.ghostTable.clean())}function _onBeforeRender$1(){this.calculateVisibleRowsHeight(),this.inProgress||(_assertClassBrand$S(_AutoRowSize_brand,this,_calculateSpecificRowsHeight).call(this,_classPrivateFieldGet$B(_visualRowsToRefresh,this)),_classPrivateFieldSet$A(_visualRowsToRefresh,this,[]))}function _onBeforeRowResize(t,e,r){let i=t;return r&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function _onAfterLoadData$6(t,e){e||this.recalculateAllRowsHeight()}function _onBeforeChange(t){const e=t.reduce((r,i)=>{let[n]=i;return r.indexOf(n)===-1&&r.push(n),r},[]);_classPrivateFieldGet$B(_visualRowsToRefresh,this).push(...e)}function _onInit$2(){this.recalculateAllRowsHeight(),_classPrivateFieldSet$A(_isInitialized,this,!0)}function _onAfterFormulasValuesUpdate(t){if(!_classPrivateFieldGet$B(_isInitialized,this))return;const e=t.reduce((r,i)=>{var n;const s=(n=i.address)===null||n===void 0?void 0:n.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);_classPrivateFieldGet$B(_visualRowsToRefresh,this).push(...e)}const{getListWithInsertedItems:getListWithInsertedItems$1,getListWithRemovedItems:getListWithRemovedItems$1}=alterUtilsFactory("physicallyIndexed");class LooseBindsMap extends IndexMap{constructor(){super(e=>e)}insert(e,r){const i=getIncreasedIndexes(this.indexedValues,r);this.indexedValues=getListWithInsertedItems$1(i,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){const r=getListWithRemovedItems$1(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(r,e),super.remove(e)}}const{getListWithInsertedItems,getListWithRemovedItems}=alterUtilsFactory("physicallyIndexed");class StrictBindsMap extends IndexMap{constructor(){super(e=>e)}insert(e,r){this.indexedValues=getListWithInsertedItems(this.indexedValues,e,r,(i,n)=>this.getNextValue(n)),super.insert(e,r)}remove(e){this.indexedValues=getListWithRemovedItems(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function _classPrivateMethodInitSpec$E(t,e){_checkPrivateRedeclaration$R(t,e),e.add(t)}function _checkPrivateRedeclaration$R(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$13(t,e,r){return(e=_toPropertyKey$13(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$13(t){var e=_toPrimitive$13(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$13(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$R(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$u="bindRowsWithHeaders",PLUGIN_PRIORITY$u=210,DEFAULT_BIND="loose",bindTypeToMapStrategy=new Map([["loose",LooseBindsMap],["strict",StrictBindsMap]]);var _BindRowsWithHeaders_brand=new WeakSet;class BindRowsWithHeaders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$E(this,_BindRowsWithHeaders_brand),_defineProperty$13(this,"headerIndexes",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$u}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$u}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$u]}enablePlugin(){var e;if(this.enabled)return;const r=(e=bindTypeToMapStrategy.get(this.getSetting()))!==null&&e!==void 0?e:bindTypeToMapStrategy.get(DEFAULT_BIND);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",i=>_assertClassBrand$R(_BindRowsWithHeaders_brand,this,_onModifyRowHeader).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function _onModifyRowHeader(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function _classPrivateMethodInitSpec$D(t,e){_checkPrivateRedeclaration$Q(t,e),e.add(t)}function _classPrivateFieldInitSpec$A(t,e,r){_checkPrivateRedeclaration$Q(t,e),e.set(t,r)}function _checkPrivateRedeclaration$Q(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$12(t,e,r){return(e=_toPropertyKey$12(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$12(t){var e=_toPrimitive$12(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$12(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$A(t,e){return t.get(_assertClassBrand$Q(t,e))}function _classPrivateFieldSet$z(t,e,r){return t.set(_assertClassBrand$Q(t,e),r),r}function _assertClassBrand$Q(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$t="collapsibleColumns",PLUGIN_PRIORITY$t=290,SETTING_KEYS$2=["nestedHeaders"],COLLAPSIBLE_ELEMENT_CLASS="collapsibleIndicator",SHORTCUTS_GROUP$b=PLUGIN_KEY$t,actionDictionary=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var _collapsedColumnsMap=new WeakMap,_CollapsibleColumns_brand=new WeakSet;class CollapsibleColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$D(this,_CollapsibleColumns_brand),_defineProperty$12(this,"nestedHeadersPlugin",null),_defineProperty$12(this,"headerStateManager",null),_classPrivateFieldInitSpec$A(this,_collapsedColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$t}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$t}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[PLUGIN_KEY$t,...SETTING_KEYS$2]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$t]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();r||warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),_classPrivateFieldSet$z(_collapsedColumnsMap,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>_assertClassBrand$Q(_CollapsibleColumns_brand,this,_onInit$1).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$Q(_CollapsibleColumns_brand,e,_onAfterLoadData$5).call(e,...n)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$Q(_CollapsibleColumns_brand,e,_onAfterGetColHeader$4).call(e,...n)}),this.addHook("beforeOnCellMouseDown",(i,n,s)=>_assertClassBrand$Q(_CollapsibleColumns_brand,this,_onBeforeOnCellMouseDown$6).call(this,i,n,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$z(_collapsedColumnsMap,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:r,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:n,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(r,i))!==null&&e!==void 0?e:{};if(n)return s?this.expandSection({row:r,col:o}):this.collapseSection({row:r,col:o}),!1},runOnlyIf:()=>{var e,r;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader())},group:SHORTCUTS_GROUP$b,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$b)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,r=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};rangeEach(0,e-1,o=>{const a=r.childNodes[o],l=i.childNodes[o],c=n?n.childNodes[o]:null;rangeEach(0,a.childNodes.length-1,u=>{let d=a.childNodes[u].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);s(d),l&&l.childNodes[u]&&(d=l.childNodes[u].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),s(d)),n&&c&&c.childNodes[u]&&(d=c.childNodes[u].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),s(d))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const r=this.headerStateManager.mapNodes(i=>{const{collapsible:n,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=i;if(n===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(r,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,r){if(!actionDictionary.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(!Array.isArray(e))return;const i=arrayFilter(e,f=>{let{row:g}=f;return g<0});let n=i.length>0;arrayEach(i,f=>{var g;let{row:m,col:C}=f;const{collapsible:y,isCollapsed:v}=(g=this.headerStateManager.getHeaderSettings(m,C))!==null&&g!==void 0?g:{};if(!y||v&&r==="collapse"||!v&&r==="expand")return n=!1,!1});const s=[],o=[];n&&arrayEach(i,f=>{let{row:g,col:m}=f;const{colspanCompensation:C,affectedColumns:y,rollbackModification:v}=this.headerStateManager.triggerNodeModification(r,g,m);C>0&&(o.push(...y),s.push(v))});const a=this.getCollapsedColumns();let l=[];r==="collapse"?l=arrayUnique([...a,...o]):r==="expand"&&(l=arrayFilter(a,f=>!o.includes(f)));const c=actionDictionary.get(r);if(this.hot.runHooks(c.beforeHook,a,l,n)===!1){arrayEach(s,f=>{f()});return}this.hot.batchExecution(()=>{arrayEach(o,f=>{_classPrivateFieldGet$A(_collapsedColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(f),c.hideColumn)})},!0);const d=this.getCollapsedColumns().length!==a.length,h=this.hot.getSelectedRangeLast();if(r==="collapse"&&d&&h){const{row:f,col:g}=h.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&o.includes(g)){const C=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,y=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;C!==null&&y!==null&&this.hot.selectCell(C,y)}}this.hot.runHooks(c.afterHook,a,l,n,d),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return _classPrivateFieldGet$A(_collapsedColumnsMap,this).getHiddenIndexes()}destroy(){_classPrivateFieldSet$z(_collapsedColumnsMap,this,null),super.destroy()}}function _onAfterGetColHeader$4(t,e,r){var i;const{collapsible:n,origColspan:s,isCollapsed:o}=(i=this.headerStateManager.getHeaderSettings(r,t))!==null&&i!==void 0?i:{},a=n&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let c=e.querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);if(removeAttribute(e,[A11Y_EXPANDED("")[0]]),a)c||(c=this.hot.rootDocument.createElement("div"),addClass$1(c,COLLAPSIBLE_ELEMENT_CLASS),e.querySelector("div:first-child").appendChild(c)),removeClass$1(c,["collapsed","expanded"]),o?(addClass$1(c,"collapsed"),fastInnerText(c,"+"),l&&setAttribute(e,...A11Y_EXPANDED(!1))):(addClass$1(c,"expanded"),fastInnerText(c,"-"),l&&setAttribute(e,...A11Y_EXPANDED(!0))),l&&setAttribute(c,...A11Y_HIDDEN());else{var u;(u=c)===null||u===void 0||u.remove()}}function _onBeforeOnCellMouseDown$6(t,e){hasClass$1(t.target,COLLAPSIBLE_ELEMENT_CLASS)&&(hasClass$1(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):hasClass$1(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),stopImmediatePropagation(t))}function _onInit$1(){this.updatePlugin()}function _onAfterLoadData$5(t,e){e||this.updatePlugin()}function _defineProperty$11(t,e,r){return(e=_toPropertyKey$11(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$11(t){var e=_toPrimitive$11(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$11(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const inheritedColumnProperties=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],SORT_EMPTY_CELLS_DEFAULT=!1,SHOW_SORT_INDICATOR_DEFAULT=!0,HEADER_ACTION_DEFAULT=!0;class ColumnStatesManager{constructor(e,r){_defineProperty$11(this,"hot",void 0),_defineProperty$11(this,"sortingStates",new LinkedPhysicalIndexToValueMap),_defineProperty$11(this,"sortEmptyCells",SORT_EMPTY_CELLS_DEFAULT),_defineProperty$11(this,"indicator",SHOW_SORT_INDICATOR_DEFAULT),_defineProperty$11(this,"headerAction",HEADER_ACTION_DEFAULT),_defineProperty$11(this,"compareFunctionFactory",void 0),_defineProperty$11(this,"mapName",void 0),this.hot=e,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}updateAllColumnsProperties(e){isObject(e)&&objectEach(e,(r,i)=>{inheritedColumnProperties.includes(i)&&(this[i]=r)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(r=>{let[i]=r;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return isObject(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(r=>{let[i,n]=r;return{column:this.hot.toVisualColumn(i),...n}})}getColumnSortState(e){const r=this.getSortOrderOfColumn(e);if(isDefined(r))return{column:e,sortOrder:r}}setSortStates(e){this.sortingStates.clear();for(let r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function compareFunctionFactory$4(t,e,r){const i=e.locale;return function(n,s){const{sortEmptyCells:o}=r;return typeof n=="string"&&(n=n.toLocaleLowerCase(i)),typeof s=="string"&&(s=s.toLocaleLowerCase(i)),n===s?DO_NOT_SWAP:isEmpty(n)?isEmpty(s)?DO_NOT_SWAP:o&&t==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:isEmpty(s)?o&&t==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:isNaN(n)&&!isNaN(s)?t==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:!isNaN(n)&&isNaN(s)||(isNaN(n)||isNaN(s)||(n=parseFloat(n),s=parseFloat(s)),n<s)?t==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:n>s?t==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$4="default";function compareFunctionFactory$3(t,e,r){return function(i,n){const s=parseFloat(i),o=parseFloat(n),{sortEmptyCells:a}=r;if(s===o||isNaN(s)&&isNaN(o))return DO_NOT_SWAP;if(a){if(isEmpty(i))return t==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(n))return t==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND}return isNaN(s)?FIRST_AFTER_SECOND:isNaN(o)?FIRST_BEFORE_SECOND:s<o?t==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:s>o?t==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$3="numeric";function compareFunctionFactory$2(t,e,r){const i=e.checkedTemplate,n=e.uncheckedTemplate,{sortEmptyCells:s}=r;return function(o,a){const l=isEmpty(o),c=isEmpty(a),u=l?n:o,d=c?n:a,h=u===n||u===i,f=d===n||d===i;if(s===!1){if(l&&c===!1)return FIRST_AFTER_SECOND;if(l===!1&&c)return FIRST_BEFORE_SECOND}return h===!1&&f?t==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:h&&f===!1?t==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:h===!1&&f===!1?compareFunctionFactory$4(t,e,r)(o,a):u===n&&d===i?t==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:u===i&&d===n?t==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$2="checkbox";function compareFunctionFactory$1(t,e,r){return createDateTimeCompareFunction(t,e.dateFormat,r)}const COLUMN_DATA_TYPE$1="date";function compareFunctionFactory(t,e,r){return createDateTimeCompareFunction(t,e.timeFormat,r)}const COLUMN_DATA_TYPE="time",{register:registerCompareFunctionFactory,getItem:getGloballyCompareFunctionFactory,hasItem:hasGloballyCompareFunctionFactory}=staticRegister("sorting.compareFunctionFactory"),{register:registerRootComparator,getItem:getRootComparator}=staticRegister("sorting.mainSortComparator");function getCompareFunctionFactory(t){return hasGloballyCompareFunctionFactory(t)?getGloballyCompareFunctionFactory(t):getGloballyCompareFunctionFactory(COLUMN_DATA_TYPE$4)}registerCompareFunctionFactory(COLUMN_DATA_TYPE$2,compareFunctionFactory$2);registerCompareFunctionFactory(COLUMN_DATA_TYPE$1,compareFunctionFactory$1);registerCompareFunctionFactory(COLUMN_DATA_TYPE$4,compareFunctionFactory$4);registerCompareFunctionFactory(COLUMN_DATA_TYPE$3,compareFunctionFactory$3);registerCompareFunctionFactory(COLUMN_DATA_TYPE,compareFunctionFactory);const DO_NOT_SWAP=0,FIRST_BEFORE_SECOND=-1,FIRST_AFTER_SECOND=1;function sort(t,e){const r=getRootComparator(e);for(var i=arguments.length,n=new Array(i>2?i-2:0),s=2;s<i;s++)n[s-2]=arguments[s];t.sort(r(...n))}const ASC_SORT_STATE="asc",DESC_SORT_STATE="desc",HEADER_SPAN_CLASS="colHeader";function isValidColumnState(t){if(isObject(t)===!1)return!1;const{column:e,sortOrder:r}=t;return Number.isInteger(e)&&[ASC_SORT_STATE,DESC_SORT_STATE].includes(r)}function areValidSortStates(t){if(t.some(r=>isValidColumnState(r)===!1))return!1;const e=t.map(r=>{let{column:i}=r;return i});return new Set(e).size===e.length}function getNextSortOrder(t){if(t!==DESC_SORT_STATE)return t===ASC_SORT_STATE?DESC_SORT_STATE:ASC_SORT_STATE}function getHeaderSpanElement(t){return t.querySelector(`.${HEADER_SPAN_CLASS}`)}function isFirstLevelColumnHeader(t,e){if(t<0||!e.parentNode)return!1;const r=e.parentNode.parentNode.childNodes;return Array.from(r).indexOf(e.parentNode)-r.length===-1}function wasHeaderClickedProperly(t,e,r){return t===-1&&e>=0&&isRightClick(r)===!1}function createDateTimeCompareFunction(t,e,r){return function(i,n){const{sortEmptyCells:s}=r;if(i===n)return DO_NOT_SWAP;if(isEmpty(i))return isEmpty(n)?DO_NOT_SWAP:s&&t==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(n))return s&&t==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND;const o=hooks(i,e),a=hooks(n,e);return o.isValid()?a.isValid()?a.isAfter(o)?t==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:a.isBefore(o)?t==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP:FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND}}function warnAboutPluginsConflict(t,e){warn(toSingleLine`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const HEADER_CLASS_ASC_SORT="ascending",HEADER_CLASS_DESC_SORT="descending",HEADER_CLASS_INDICATOR_DISABLED="indicatorDisabled",HEADER_SORT_CLASS="columnSorting",HEADER_ACTION_CLASS="sortAction",orderToCssClass=new Map([[ASC_SORT_STATE,HEADER_CLASS_ASC_SORT],[DESC_SORT_STATE,HEADER_CLASS_DESC_SORT]]);function getClassesToAdd$1(t,e,r,i){const n=[HEADER_SORT_CLASS];if(i&&n.push(HEADER_ACTION_CLASS),r===!1)return n.push(HEADER_CLASS_INDICATOR_DISABLED),n;const s=t.getSortOrderOfColumn(e);return isDefined(s)&&n.push(orderToCssClass.get(s)),n}function getClassesToRemove$1(){return Array.from(orderToCssClass.values()).concat(HEADER_ACTION_CLASS,HEADER_CLASS_INDICATOR_DISABLED,HEADER_SORT_CLASS)}function rootComparator$1(t,e){return function(r,i){const[,...n]=r,[,...s]=i;return function(a){const l=t[a],c=e[a],u=n[a],d=s[a],h=c.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:getCompareFunctionFactory(c.type))(l,c,h)(u,d)}(0)}}function _classPrivateMethodInitSpec$C(t,e){_checkPrivateRedeclaration$P(t,e),e.add(t)}function _checkPrivateRedeclaration$P(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$10(t,e,r){return(e=_toPropertyKey$10(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$10(t){var e=_toPrimitive$10(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$10(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$P(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$s="columnSorting",PLUGIN_PRIORITY$s=50,APPEND_COLUMN_CONFIG_STRATEGY="append",REPLACE_COLUMN_CONFIG_STRATEGY="replace",SHORTCUTS_GROUP$a=PLUGIN_KEY$s;registerRootComparator(PLUGIN_KEY$s,rootComparator$1);Hooks.getSingleton().register("beforeColumnSort");Hooks.getSingleton().register("afterColumnSort");const pluginConflictsState=new WeakMap;var _ColumnSorting_brand=new WeakSet;class ColumnSorting extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$C(this,_ColumnSorting_brand),_defineProperty$10(this,"columnStatesManager",null),_defineProperty$10(this,"columnMetaCache",null),_defineProperty$10(this,"pluginKey",PLUGIN_KEY$s),_defineProperty$10(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$s}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$s}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(pluginConflictsState.has(this.hot)&&pluginConflictsState.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),warnAboutPluginsConflict(pluginConflictsState.get(this.hot),this.pluginKey);return}this.enabled||(pluginConflictsState.set(this.hot,this.pluginKey),this.columnStatesManager=new ColumnStatesManager(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new PhysicalIndexToValueMap(r=>{let i=this.hot.toVisualColumn(r);return i===null&&(i=r),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,i)=>_assertClassBrand$P(_ColumnSorting_brand,this,_onAfterGetColHeader$3).call(this,r,i)),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$P(_ColumnSorting_brand,e,_onBeforeOnCellMouseDown$5).call(e,...i)}),this.addHook("afterOnCellMouseDown",(r,i)=>this.onAfterOnCellMouseDown(r,i)),this.addHook("afterInit",()=>_assertClassBrand$P(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$P(_ColumnSorting_brand,e,_onAfterLoadData$4).call(e,...i)}),this.hot.view&&_assertClassBrand$P(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(r,i)=>{const n=getHeaderSpanElement(i);isFirstLevelColumnHeader(r,i)===!1||n===null||this.updateHeaderClasses(n)};pluginConflictsState.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,r;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP$a})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$a)}sort(e){const r=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),n=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",r,i,n)!==!1&&(r.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new IndexesSequence),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),n&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",r,n?i:r,n),n&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return isDefined(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const r=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(r)&&this.columnStatesManager.setSortStates(r)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const r=this.hot.countCols();return areValidSortStates(e)&&e.every(i=>{let{column:n}=i;return n<=r&&n>=0})}saveAllSortSettings(e){const r=this.columnStatesManager.getAllColumnsProperties(),i=n=>{let{column:s,...o}=n;return{column:this.hot.toPhysicalColumn(s),...o}};r.initialConfig=arrayMap(e,i),this.hot.runHooks("persistentStateSave","columnSorting",r)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const r=e.value,i=n=>{let{column:s,...o}=n;return{column:this.hot.toVisualColumn(s),...o}};return isDefined(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=arrayMap(r.initialConfig,i)),r}getColumnNextConfig(e){const r=this.columnStatesManager.getSortOrderOfColumn(e);if(isDefined(r)){const n=getNextSortOrder(r);return isDefined(n)?{column:e,sortOrder:n}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:getNextSortOrder()}}getNextSortConfig(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:APPEND_COLUMN_CONFIG_STRATEGY;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),n=i!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(n){if(isUndefined(o))return[...s.slice(0,i),...s.slice(i+1)];if(r===APPEND_COLUMN_CONFIG_STRATEGY)return[...s.slice(0,i),...s.slice(i+1),o];if(r===REPLACE_COLUMN_CONFIG_STRATEGY)return[...s.slice(0,i),o,...s.slice(i+1)]}return isDefined(o)?s.concat(o):s}getPluginColumnConfig(e){if(isObject(e)){const r=e[this.pluginKey];if(isObject(r))return r}return{}}getMergedPluginSettings(e){const r=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),n=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(n);return Array.isArray(s.columns)?Object.assign(i,r,this.getPluginColumnConfig(s.columns[e])):isFunction(s.columns)?Object.assign(i,r,this.getPluginColumnConfig(s.columns(e))):Object.assign(i,r)}getFirstCellSettings(e){const r=this.hot.getCellMeta(0,e),i=Object.create(r);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const r=this.hot.getSettings();return r.maxRows<=e?r.maxRows:e-r.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const r=[],i=this.hot.countRows(),n=c=>arrayMap(e,u=>this.hot.getDataAtCell(c,u.column));for(let c=0;c<this.getNumberOfRowsToSort(i);c+=1)r.push([this.hot.toPhysicalRow(c)].concat(n(c)));const s=arrayMap(r,c=>c[0]);sort(r,this.pluginKey,arrayMap(e,c=>c.sortOrder),arrayMap(e,c=>this.getFirstCellSettings(c.column)));for(let c=r.length;c<i;c+=1)r.push([c].concat(n(c)));const o=arrayMap(r,c=>c[0]),a=new Map(arrayMap(s,(c,u)=>[c,o[u]])),l=arrayMap(this.hot.rowIndexMapper.getIndexesSequence(),c=>a.has(c)?a.get(c):c);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(isObject(e)){this.columnStatesManager.updateAllColumnsProperties(e);const r=e.initialConfig;(Array.isArray(r)||isObject(r))&&this.sort(r)}else this.hot.render()}updateHeaderClasses(e){if(removeClass$1(e,getClassesToRemove$1()),this.enabled!==!1){for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];addClass$1(e,getClassesToAdd$1(...i))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),isDefined(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,r){return this.getFirstCellSettings(r)[this.pluginKey].headerAction&&hasClass$1(e.target,HEADER_SPAN_CLASS)}onAfterOnCellMouseDown(e,r){if(wasHeaderClickedProperly(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(r.col));const i=this.hot.getActiveEditor(),n=this.getColumnNextConfig(r.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(n)}):this.sort(n)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function _loadOrSortBySettings(){const t=this.getAllSavedSortSettings();if(isObject(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function _onAfterGetColHeader$3(t,e){const r=getHeaderSpanElement(e);if(isFirstLevelColumnHeader(t,e)===!1||r===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],n=i.indicator,s=i.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,t,n,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);setAttribute(e,...A11Y_SORT(o?`${o}ending`:"none"))}}function _onAfterLoadData$4(t){t===!0&&this.hot.view&&_assertClassBrand$P(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)}function _onBeforeOnCellMouseDown$5(t,e,r,i){wasHeaderClickedProperly(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function _defineProperty$$(t,e,r){return(e=_toPropertyKey$$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$$(t){var e=_toPrimitive$$(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Endpoints{constructor(e,r){_defineProperty$$(this,"plugin",void 0),_defineProperty$$(this,"hot",void 0),_defineProperty$$(this,"endpoints",[]),_defineProperty$$(this,"settings",void 0),_defineProperty$$(this,"settingsType","array"),_defineProperty$$(this,"currentEndpoint",null),_defineProperty$$(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=r}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),arrayEach(i,n=>{const s={};this.assignSetting(n,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(n,s,"reversedRowCoords",!1),this.assignSetting(n,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(n,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(n,s,"sourceColumn",n.destinationColumn),this.assignSetting(n,s,"type","sum"),this.assignSetting(n,s,"forceNumeric",!1),this.assignSetting(n,s,"suppressDataTypeErrors",!0),this.assignSetting(n,s,"customFunction",null),this.assignSetting(n,s,"readOnly",!0),this.assignSetting(n,s,"roundFloat",!1),r.push(s)}),r}assignSetting(e,r,i,n){if(i==="ranges"&&e[i]===void 0){r[i]=n;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(n instanceof Error)throw n;r[i]=n}else i==="destinationRow"&&r.reversedRowCoords?r[i]=this.hot.countRows()-e[i]-1:r[i]=e[i]}resetSetupBeforeStructureAlteration(e,r,i){if(this.settingsType!=="function")return;const n=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();arrayEach(s,o=>{n==="row"&&o.destinationRow>=r&&(e==="insert_row"?o.alterRowOffset=i:e==="remove_row"&&(o.alterRowOffset=-1*i)),n==="col"&&o.destinationColumn>=r&&(e==="insert_col"?o.alterColumnOffset=i:e==="remove_col"&&(o.alterColumnOffset=-1*i))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,r,i,n,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const h=()=>(this.hot.removeHook("beforeViewRender",h),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",h);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),u=e.indexOf("move_row")===0,d=r;arrayEach(c,h=>{a==="row"&&h.destinationRow>=d&&(h.alterRowOffset=l*i),a==="col"&&h.destinationColumn>=d&&(h.alterColumnOffset=l*i)}),this.resetAllEndpoints(c,!u),u?arrayEach(c,h=>{this.extendEndpointRanges(h,d,n[0],n.length),this.recreatePhysicalRanges(h),this.clearOffsetInformation(h)}):arrayEach(c,h=>{this.shiftEndpointCoordinates(h,d)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,r,i,n){arrayEach(e.ranges,s=>{s[1]&&(r>=s[0]&&r<=s[1]?i>s[1]?s[1]+=n:i<s[0]&&(s[0]-=n):i>=s[0]&&i<=s[1]&&(s[1]-=n,r<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const r=e.ranges,i=[],n=[];arrayEach(r,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));n.push(o)}),arrayEach(n,s=>{let o=[];arrayEach(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),i.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),i.push(o))})}),e.ranges=i}shiftEndpointCoordinates(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,arrayEach(e.ranges,i=>{arrayEach(i,(n,s)=>{n>=r&&(i[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(n=>{const s=n.alterRowOffset||0,o=n.alterColumnOffset||0;return n.destinationRow+s>=this.hot.countRows()||n.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],arrayEach(e,n=>{this.resetEndpointValue(n,r)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],arrayEach(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const r=[];this.cellsToSetCache=[],arrayEach(e,(i,n,s)=>{`${i[2]||""}`!=`${i[3]}`&&arrayEach(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[n][1])===o.sourceColumn&&r.indexOf(a)===-1&&r.push(a)})}),arrayEach(r,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const i=this.hot.getCellMeta(r,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,n=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?i:0)),this.hot.toVisualColumn(e.destinationColumn+(r?n:0)),""])}setEndpointValue(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(r==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}i?this.hot.setDataAtCell(n,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([n,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){warn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function isNullishOrNaN(t){return t==null||isNaN(t)}function _classPrivateMethodInitSpec$B(t,e){_checkPrivateRedeclaration$O(t,e),e.add(t)}function _checkPrivateRedeclaration$O(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$_(t,e,r){return(e=_toPropertyKey$_(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$_(t){var e=_toPrimitive$_(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$_(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$O(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$r="columnSummary",PLUGIN_PRIORITY$r=220;var _ColumnSummary_brand=new WeakSet;class ColumnSummary extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$B(this,_ColumnSummary_brand),_defineProperty$_(this,"endpoints",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$r}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$r}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$r]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[PLUGIN_KEY$r],this.endpoints=new Endpoints(this,this.settings),this.addHook("afterInit",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$O(_ColumnSummary_brand,e,_onAfterInit$3).call(e,...i)}),this.addHook("afterChange",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$O(_ColumnSummary_brand,e,_onAfterChange$3).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$O(_ColumnSummary_brand,e,_onAfterUpdateSettings).call(e,...i)}),this.addHook("beforeCreateRow",(r,i,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,i,null,n)),this.addHook("beforeCreateCol",(r,i,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,i,null,n)),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(r,i,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,i,null,n)),this.addHook("afterCreateCol",(r,i,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,i,null,n)),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$O(_ColumnSummary_brand,e,_onAfterRowMove).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let r=0;return objectEach(e.ranges,i=>{r+=this.getPartialSum(i,e.sourceColumn)}),r}getPartialSum(e,r){let i=0,n=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(n,r),s=isNullishOrNaN(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}i+=s||0,n-=1}while(n>=e[0]);return Math.round(i*10**o)/10**o}calculateMinMax(e,r){let i=null;return objectEach(e.ranges,n=>{const s=this.getPartialMinMax(n,e.sourceColumn,r);if(i===null&&s!==null&&(i=s),s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}}),i===null?"Not enough data":i}getPartialMinMax(e,r,i){let n=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,r),o=isNullishOrNaN(o)?null:o,n===null)n=o;else if(o!==null)switch(i){case"min":n=Math.min(n,o);break;case"max":n=Math.max(n,o);break}s-=1}while(s>=e[0]);return n}countEmpty(e,r){let i,n=0,s=e[1]||e[0];do i=this.getCellValue(s,r),i=isNullishOrNaN(i)?null:i,i===null&&(n+=1),s-=1;while(s>=e[0]);return n}countEntries(e){let r=0;const i=e.ranges;return objectEach(i,n=>{const s=n[1]===void 0?1:n[1]-n[0]+1,o=this.countEmpty(n,e.sourceColumn);r+=s,r-=o}),r}calculateAverage(e){const r=this.calculateSum(e),i=this.countEntries(e);return r/i}getCellValue(e,r){const i=this.hot.toVisualRow(e),n=this.hot.toVisualColumn(r);let s=this.hot.getSourceDataAtCell(e,r),o="";if(i!==null&&n!==null&&(o=this.hot.getCellMeta(i,n).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(toSingleLine`ColumnSummary plugin: cell at (${e}, ${r}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function _onAfterInit$3(){this.endpoints.initEndpoints()}function _onAfterUpdateSettings(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function _onAfterChange$3(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function _onAfterRowMove(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function _classPrivateMethodInitSpec$A(t,e){_checkPrivateRedeclaration$N(t,e),e.add(t)}function _classPrivateFieldInitSpec$z(t,e,r){_checkPrivateRedeclaration$N(t,e),e.set(t,r)}function _checkPrivateRedeclaration$N(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$z(t,e){return t.get(_assertClassBrand$N(t,e))}function _classPrivateFieldSet$y(t,e,r){return t.set(_assertClassBrand$N(t,e),r),r}function _assertClassBrand$N(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _ignoreInitialCall=new WeakMap,_observedElement=new WeakMap,_observer=new WeakMap,_EditorResizeObserver_brand=new WeakSet;class EditorResizeObserver{constructor(){_classPrivateMethodInitSpec$A(this,_EditorResizeObserver_brand),_classPrivateFieldInitSpec$z(this,_ignoreInitialCall,!0),_classPrivateFieldInitSpec$z(this,_observedElement,null),_classPrivateFieldInitSpec$z(this,_observer,new ResizeObserver(e=>_assertClassBrand$N(_EditorResizeObserver_brand,this,_onResize).call(this,e)))}setObservedElement(e){_classPrivateFieldSet$y(_observedElement,this,e)}unobserve(){_classPrivateFieldGet$z(_observer,this).unobserve(_classPrivateFieldGet$z(_observedElement,this))}observe(){_classPrivateFieldSet$y(_ignoreInitialCall,this,!0),_classPrivateFieldGet$z(_observer,this).observe(_classPrivateFieldGet$z(_observedElement,this))}destroy(){_classPrivateFieldGet$z(_observer,this).disconnect()}}function _onResize(t){if(_classPrivateFieldGet$z(_ignoreInitialCall,this)||!Array.isArray(t)||!t.length){_classPrivateFieldSet$y(_ignoreInitialCall,this,!1);return}t.forEach(e=>{let{borderBoxSize:r}=e;const{inlineSize:i,blockSize:n}=r[0];this.runLocalHooks("resize",i,n)})}mixin(EditorResizeObserver,localHooks);function _classPrivateFieldInitSpec$y(t,e,r){_checkPrivateRedeclaration$M(t,e),e.set(t,r)}function _checkPrivateRedeclaration$M(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$y(t,e){return t.get(_assertClassBrand$M(t,e))}function _classPrivateFieldSet$x(t,e,r){return t.set(_assertClassBrand$M(t,e),r),r}function _assertClassBrand$M(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _rootDocument=new WeakMap,_rootPortalElement=new WeakMap,_isRtl=new WeakMap,_container$1=new WeakMap,_editor$1=new WeakMap,_editorStyle=new WeakMap,_hidden=new WeakMap,_resizeObserver$1=new WeakMap;class CommentEditor{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,r,i){var n=this;_classPrivateFieldInitSpec$y(this,_rootDocument,void 0),_classPrivateFieldInitSpec$y(this,_rootPortalElement,void 0),_classPrivateFieldInitSpec$y(this,_isRtl,!1),_classPrivateFieldInitSpec$y(this,_container$1,null),_classPrivateFieldInitSpec$y(this,_editor$1,void 0),_classPrivateFieldInitSpec$y(this,_editorStyle,void 0),_classPrivateFieldInitSpec$y(this,_hidden,!0),_classPrivateFieldInitSpec$y(this,_resizeObserver$1,new EditorResizeObserver),_classPrivateFieldSet$x(_rootDocument,this,e),_classPrivateFieldSet$x(_rootPortalElement,this,i),_classPrivateFieldSet$x(_isRtl,this,r),_classPrivateFieldSet$x(_editor$1,this,this.createEditor()),_classPrivateFieldSet$x(_editorStyle,this,_classPrivateFieldGet$y(_editor$1,this).style),_classPrivateFieldGet$y(_resizeObserver$1,this).setObservedElement(this.getInputElement()),_classPrivateFieldGet$y(_resizeObserver$1,this).addLocalHook("resize",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,r){_classPrivateFieldGet$y(_editorStyle,this).left=`${e}px`,_classPrivateFieldGet$y(_editorStyle,this).top=`${r}px`}setSize(e,r){if(e&&r){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${r}px`}}getSize(){return{width:outerWidth(this.getInputElement()),height:outerHeight(this.getInputElement())}}observeSize(){_classPrivateFieldGet$y(_resizeObserver$1,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const r=this.getInputElement();r.readOnly=e}show(){_classPrivateFieldGet$y(_editorStyle,this).display="block",_classPrivateFieldSet$x(_hidden,this,!1)}hide(){_classPrivateFieldGet$y(_resizeObserver$1,this).unobserve(),_classPrivateFieldGet$y(_hidden,this)||(_classPrivateFieldGet$y(_editorStyle,this).display="none"),_classPrivateFieldSet$x(_hidden,this,!0)}isVisible(){return _classPrivateFieldGet$y(_editorStyle,this).display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return _classPrivateFieldGet$y(_rootDocument,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=_classPrivateFieldGet$y(_rootDocument,this).createElement("div"),r=_classPrivateFieldGet$y(_rootDocument,this).createElement("textarea");return e.style.display="none",_classPrivateFieldSet$x(_container$1,this,_classPrivateFieldGet$y(_rootDocument,this).createElement("div")),_classPrivateFieldGet$y(_container$1,this).setAttribute("dir",_classPrivateFieldGet$y(_isRtl,this)?"rtl":"ltr"),addClass$1(_classPrivateFieldGet$y(_container$1,this),CommentEditor.CLASS_EDITOR_CONTAINER),_classPrivateFieldGet$y(_rootPortalElement,this).appendChild(_classPrivateFieldGet$y(_container$1,this)),addClass$1(e,CommentEditor.CLASS_EDITOR),addClass$1(r,CommentEditor.CLASS_INPUT),r.setAttribute("data-hot-input",!0),e.appendChild(r),_classPrivateFieldGet$y(_container$1,this).appendChild(e),e}getInputElement(){return _classPrivateFieldGet$y(_editor$1,this).querySelector(`.${CommentEditor.CLASS_INPUT}`)}getEditorElement(){return _classPrivateFieldGet$y(_editor$1,this)}destroy(){const e=_classPrivateFieldGet$y(_container$1,this)?_classPrivateFieldGet$y(_container$1,this).parentNode:null;_classPrivateFieldGet$y(_editor$1,this).parentNode.removeChild(_classPrivateFieldGet$y(_editor$1,this)),_classPrivateFieldSet$x(_editor$1,this,null),_classPrivateFieldSet$x(_editorStyle,this,null),_classPrivateFieldGet$y(_resizeObserver$1,this).destroy(),e&&e.removeChild(_classPrivateFieldGet$y(_container$1,this))}}mixin(CommentEditor,localHooks);function _defineProperty$Z(t,e,r){return(e=_toPropertyKey$Z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$Z(t){var e=_toPrimitive$Z(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$Z(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const DEFAULT_DISPLAY_DELAY=250,DEFAULT_HIDE_DELAY=250;class DisplaySwitch{constructor(e){_defineProperty$Z(this,"wasLastActionShow",!0),_defineProperty$Z(this,"showDebounced",null),_defineProperty$Z(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},DEFAULT_HIDE_DELAY)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DEFAULT_DISPLAY_DELAY;this.showDebounced=debounce(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},e)}destroy(){this.clearLocalHooks()}}mixin(DisplaySwitch,localHooks);function prepareVerticalAlignClass(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function prepareHorizontalAlignClass(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function getAlignmentClasses(t,e){const r={};return arrayEach(t,i=>{i.forAll((n,s)=>{n>=0&&s>=0&&(r[n]||(r[n]=[]),r[n][s]=e(n,s))})}),r}function align(t,e,r,i,n){arrayEach(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&applyAlignClassName(o,a,e,r,i,n)})})}function applyAlignClassName(t,e,r,i,n,s){const o=n(t,e);let a=i;o.className&&(r==="vertical"?a=prepareVerticalAlignClass(o.className,i):a=prepareHorizontalAlignClass(o.className,i)),s(t,e,"className",a)}function markLabelAsSelected(t){return`<span class="selected">✓</span>${t}`}function checkSelectionConsistency(t,e){let r=!1;return Array.isArray(t)&&arrayEach(t,i=>(i.forAll((n,s)=>{if(n>=0&&s>=0&&e(n,s))return r=!0,!1}),r)),r}function getDocumentOffsetByElement(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:n,left:s}=i.getBoundingClientRect();r.top=n,r.left=s}return r}const KEY$c="---------";function separatorItem(){return{name:KEY$c}}const KEY$b="alignment";function alignmentItem(){return{key:KEY$b,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${KEY$b}:left`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_LEFT)},callback(){const t=this.getSelectedRange(),e=getAlignmentClasses(t,(n,s)=>this.getCellMeta(n,s).className),r="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,r,i),align(t,r,i,(n,s)=>this.getCellMeta(n,s),(n,s,o,a)=>this.setCellMeta(n,s,o,a)),this.render()},disabled:!1},{key:`${KEY$b}:center`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_CENTER)},callback(){const t=this.getSelectedRange(),e=getAlignmentClasses(t,(n,s)=>this.getCellMeta(n,s).className),r="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,r,i),align(t,r,i,(n,s)=>this.getCellMeta(n,s),(n,s,o,a)=>this.setCellMeta(n,s,o,a)),this.render()},disabled:!1},{key:`${KEY$b}:right`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT)},callback(){const t=this.getSelectedRange(),e=getAlignmentClasses(t,(n,s)=>this.getCellMeta(n,s).className),r="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,r,i),align(t,r,i,(n,s)=>this.getCellMeta(n,s),(n,s,o,a)=>this.setCellMeta(n,s,o,a)),this.render()},disabled:!1},{key:`${KEY$b}:justify`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY)},callback(){const t=this.getSelectedRange(),e=getAlignmentClasses(t,(n,s)=>this.getCellMeta(n,s).className),r="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,r,i),align(t,r,i,(n,s)=>this.getCellMeta(n,s),(n,s,o,a)=>this.setCellMeta(n,s,o,a)),this.render()},disabled:!1},{name:KEY$c},{key:`${KEY$b}:top`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_TOP)},callback(){const t=this.getSelectedRange(),e=getAlignmentClasses(t,(n,s)=>this.getCellMeta(n,s).className),r="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,r,i),align(t,r,i,(n,s)=>this.getCellMeta(n,s),(n,s,o,a)=>this.setCellMeta(n,s,o,a)),this.render()},disabled:!1},{key:`${KEY$b}:middle`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE)},callback(){const t=this.getSelectedRange(),e=getAlignmentClasses(t,(n,s)=>this.getCellMeta(n,s).className),r="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,i),align(t,r,i,(n,s)=>this.getCellMeta(n,s),(n,s,o,a)=>this.setCellMeta(n,s,o,a)),this.render()},disabled:!1},{key:`${KEY$b}:bottom`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM)},callback(){const t=this.getSelectedRange(),e=getAlignmentClasses(t,(n,s)=>this.getCellMeta(n,s).className),r="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,r,i),align(t,r,i,(n,s)=>this.getCellMeta(n,s),(n,s,o,a)=>this.setCellMeta(n,s,o,a)),this.render()},disabled:!1}]}}}const KEY$a="clear_column";function clearColumnItem(){return{key:KEY$a,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(t,e){const r=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,i)=>{if(r<0||i<0)return!0;const{readOnly:n}=this.getCellMeta(r,i);return n?!0:(e=!0,!1)}),!e}}}const KEY$9="col_left";function columnLeftItem(){return{key:KEY$9,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const KEY$8="col_right";function columnRightItem(){return{key:KEY$8,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const KEY$7="make_read_only";function readOnlyItem(){return{key:KEY$7,checkable:!0,ariaChecked(){return checkSelectionConsistency(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY)},name(){let t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY);return checkSelectionConsistency(this.getSelectedRange(),(r,i)=>this.getCellMeta(r,i).readOnly)&&(t=markLabelAsSelected(t)),t},callback(){const t=this.getSelectedRange(),e=checkSelectionConsistency(t,(r,i)=>this.getCellMeta(r,i).readOnly);arrayEach(t,r=>{r.forAll((i,n)=>{i>=0&&n>=0&&this.setCellMeta(i,n,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const KEY$6="redo";function redoItem(){return{key:KEY$6,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REDO)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const KEY$5="remove_col";function removeColumnItem(){return{key:KEY$5,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,i]=t[0];r-i!==0&&(e=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback(){this.alter("remove_col",transformSelectionToColumnDistance(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const KEY$4="remove_row";function removeRowItem(){return{key:KEY$4,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,i]=t[0];r-i!==0&&(e=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback(){this.alter("remove_row",transformSelectionToRowDistance(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const KEY$3="row_above";function rowAboveItem(){return{key:KEY$3,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const KEY$2="row_below";function rowBelowItem(){return{key:KEY$2,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const KEY$1="no_items";function noItemsItem(){return{key:KEY$1,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}const KEY="undo";function undoItem(){return{key:KEY,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNDO)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const ITEMS=[KEY$3,KEY$2,KEY$9,KEY$8,KEY$a,KEY$4,KEY$5,KEY,KEY$6,KEY$7,KEY$b,KEY$c,KEY$1],_predefinedItems={[KEY$c]:separatorItem,[KEY$1]:noItemsItem,[KEY$3]:rowAboveItem,[KEY$2]:rowBelowItem,[KEY$9]:columnLeftItem,[KEY$8]:columnRightItem,[KEY$a]:clearColumnItem,[KEY$4]:removeRowItem,[KEY$5]:removeColumnItem,[KEY]:undoItem,[KEY$6]:redoItem,[KEY$7]:readOnlyItem,[KEY$b]:alignmentItem};function predefinedItems(){const t={};return objectEach(_predefinedItems,(e,r)=>{t[r]=e()}),t}function addEditCommentItem(t){return{key:"commentsAddEdit",name(){var e;const r=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r!=null&&r.isCell()&&t.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function removeCommentItem(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){this.getSelectedRangeLast().forAll((r,i)=>{r>=0&&i>=0&&t.removeCommentAtCell(r,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function readOnlyCommentItem(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return checkSelectionConsistency(this.getSelectedRange(),(i,n)=>t.getCommentMeta(i,n,META_READONLY))?markLabelAsSelected(e):e},callback(){this.getSelectedRangeLast().forAll((r,i)=>{if(r>=0&&i>=0){const n=!!t.getCommentMeta(r,i,META_READONLY);t.updateCommentMeta(r,i,{[META_READONLY]:!n})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function _classPrivateMethodInitSpec$z(t,e){_checkPrivateRedeclaration$L(t,e),e.add(t)}function _classPrivateFieldInitSpec$x(t,e,r){_checkPrivateRedeclaration$L(t,e),e.set(t,r)}function _checkPrivateRedeclaration$L(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$Y(t,e,r){return(e=_toPropertyKey$Y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$Y(t){var e=_toPrimitive$Y(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$Y(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldSet$w(t,e,r){return t.set(_assertClassBrand$L(t,e),r),r}function _classPrivateFieldGet$x(t,e){return t.get(_assertClassBrand$L(t,e))}function _assertClassBrand$L(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$q="comments",PLUGIN_PRIORITY$q=60,META_COMMENT="comment",META_COMMENT_VALUE="value",META_STYLE="style",META_READONLY="readOnly",SHORTCUTS_GROUP$9=PLUGIN_KEY$q,SHORTCUTS_CONTEXT_NAME=`plugin:${PLUGIN_KEY$q}`;var _editor=new WeakMap,_displaySwitch=new WeakMap,_preventEditorAutoSwitch=new WeakMap,_preventEditorHiding=new WeakMap,_cellBelowCursor=new WeakMap,_commentValueBeforeSave=new WeakMap,_Comments_brand=new WeakSet;class Comments extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$z(this,_Comments_brand),_defineProperty$Y(this,"range",{}),_classPrivateFieldInitSpec$x(this,_editor,null),_classPrivateFieldInitSpec$x(this,_displaySwitch,null),_classPrivateFieldInitSpec$x(this,_preventEditorAutoSwitch,!1),_classPrivateFieldInitSpec$x(this,_preventEditorHiding,!1),_classPrivateFieldInitSpec$x(this,_cellBelowCursor,null),_classPrivateFieldInitSpec$x(this,_commentValueBeforeSave,"")}static get PLUGIN_KEY(){return PLUGIN_KEY$q}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$q}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$q]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldGet$x(_editor,this)||(_classPrivateFieldSet$w(_editor,this,new CommentEditor(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),_classPrivateFieldGet$x(_editor,this).addLocalHook("resize",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$L(_Comments_brand,e,_onEditorResize).call(e,...i)}),this.hot.addHook("afterSetTheme",(r,i)=>{i||this.hide()})),_classPrivateFieldGet$x(_displaySwitch,this)||_classPrivateFieldSet$w(_displaySwitch,this,new DisplaySwitch(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",r=>this.addToContextMenu(r)),this.addHook("afterRenderer",(r,i,n,s,o,a)=>_assertClassBrand$L(_Comments_brand,this,_onAfterRenderer).call(this,r,a)),this.addHook("afterScroll",()=>_assertClassBrand$L(_Comments_brand,this,_onAfterScroll).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",r=>_assertClassBrand$L(_Comments_brand,this,_onAfterDocumentKeyDown).call(this,r)),this.addHook("beforeCompositionStart",r=>_assertClassBrand$L(_Comments_brand,this,_onAfterDocumentKeyDown).call(this,r)),_classPrivateFieldGet$x(_displaySwitch,this).addLocalHook("hide",()=>this.hide()),_classPrivateFieldGet$x(_displaySwitch,this).addLocalHook("show",(r,i)=>this.showAtCell(r,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){_classPrivateFieldGet$x(_displaySwitch,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),r=e.getContext("grid"),i=e.addContext(SHORTCUTS_CONTEXT_NAME);r.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const n=this.hot.getSelectedRangeLast();_classPrivateFieldSet$w(_preventEditorHiding,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(n),this.show(),this.focusEditor(),e.setActiveContextName(SHORTCUTS_CONTEXT_NAME),this.hot._registerTimeout(()=>{_classPrivateFieldSet$w(_preventEditorHiding,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var n;return(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isCell()},group:SHORTCUTS_GROUP$9}),i.addShortcut({keys:[["Escape"]],callback:()=>{_classPrivateFieldGet$x(_editor,this).setValue(_classPrivateFieldGet$x(_commentValueBeforeSave,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet$x(_editor,this).isVisible()&&_classPrivateFieldGet$x(_editor,this).isFocused(),group:SHORTCUTS_GROUP$9}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet$x(_editor,this).isVisible()&&_classPrivateFieldGet$x(_editor,this).isFocused(),group:SHORTCUTS_GROUP$9}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{_classPrivateFieldGet$x(_editor,this).setValue(_classPrivateFieldGet$x(_editor,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:SHORTCUTS_GROUP$9})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$9)}registerListeners(){const{rootDocument:e}=this.hot,r=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>_assertClassBrand$L(_Comments_brand,this,_onMouseOver$2).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>_assertClassBrand$L(_Comments_brand,this,_onMouseDown$2).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$L(_Comments_brand,this,_onMouseUp$4).call(this)),this.eventManager.addEventListener(r,"focus",()=>_assertClassBrand$L(_Comments_brand,this,_onEditorFocus).call(this)),this.eventManager.addEventListener(r,"blur",()=>_assertClassBrand$L(_Comments_brand,this,_onEditorBlur).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",i=>_assertClassBrand$L(_Comments_brand,this,_onInputElementMouseDown).call(this,i))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const r=closest(e.target,"TD","TBODY");return!!(r&&hasClass$1(r,"htCommentCell")&&closest(r,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const r=_classPrivateFieldGet$x(_editor,this).getValue();let i="";e!=null?i=e:r!=null&&(i=r);const n=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(n,s,{[META_COMMENT_VALUE]:i}),this.hot.render()}setCommentAtCell(e,r,i){this.setRange({from:this.hot._createCellCoords(e,r)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,META_COMMENT),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,r)}),this.removeComment(i)}getComment(){const e=this.range.from.row,r=this.range.from.col;return this.getCommentMeta(e,r,META_COMMENT_VALUE)}getCommentAtCell(e,r){return this.getCommentMeta(e,r,META_COMMENT_VALUE)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:r,col:i}}=this.range;if(r<0||r>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return _classPrivateFieldGet$x(_displaySwitch,this).cancelHiding(),_classPrivateFieldGet$x(_editor,this).setValue((e=n[META_COMMENT]?n[META_COMMENT][META_COMMENT_VALUE]:null)!==null&&e!==void 0?e:""),_classPrivateFieldGet$x(_editor,this).show(),this.refreshEditor(!0),!0}showAtCell(e,r){return this.setRange({from:this.hot._createCellCoords(e,r)}),this.show()}hide(){_classPrivateFieldGet$x(_editor,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!_classPrivateFieldGet$x(_editor,this).isVisible()))return;const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{row:n,col:s}=this.range.from;let o=r.getRenderableFromVisualIndex(n),a=i.getRenderableFromVisualIndex(s);const l=o===null;_classPrivateFieldGet$x(_editor,this).setPosition(0,0),o===null&&(o=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(n,-1))),a===null&&(a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)));const c=o===null,u=a===null;o=o??0,a=a??0;const{rootWindow:d,view:{_wt:h}}=this.hot,{wtTable:f}=h,g=h.getCell({row:o,col:a},!0),m=this.getCommentMeta(n,s,META_STYLE);m?_classPrivateFieldGet$x(_editor,this).setSize(m.width,m.height):_classPrivateFieldGet$x(_editor,this).resetSize();const C=u?0:f.getColumnWidth(a),y=l&&!c?outerHeight(g):0,{left:v,top:E,width:$,height:O}=g.getBoundingClientRect(),{width:P,height:I}=_classPrivateFieldGet$x(_editor,this).getSize(),{innerWidth:W,innerHeight:q}=this.hot.rootWindow,M=this.hot.rootDocument.documentElement,Y=getScrollbarWidth(this.hot.rootDocument),z=hasVerticalScrollbar(this.hot.rootWindow)?Y:0,Q=hasHorizontalScrollbar(this.hot.rootWindow)?Y:0;let K=v+d.scrollX+C,Z=E+d.scrollY+y;this.hot.isRtl()&&(K-=P+C),this.hot.isLtr()&&v+$+P>W-z?K=v+d.scrollX-P-1:this.hot.isRtl()&&K<-(M.scrollWidth-M.clientWidth)&&(K=v+d.scrollX+C+1),E+I>q-Q&&(Z-=I-O+1),_classPrivateFieldGet$x(_editor,this).setPosition(K,Z),_classPrivateFieldGet$x(_editor,this).setReadOnlyState(this.getCommentMeta(n,s,META_READONLY)),_classPrivateFieldGet$x(_editor,this).observeSize()}focusEditor(){_classPrivateFieldGet$x(_editor,this).focus()}updateCommentMeta(e,r,i){const n=this.hot.getCellMeta(e,r)[META_COMMENT];let s;n?(s=deepClone(n),deepExtend(s,i)):s=i,this.hot.setCellMeta(e,r,META_COMMENT,s)}getCommentMeta(e,r,i){const n=this.hot.getCellMeta(e,r);if(n[META_COMMENT])return n[META_COMMENT][i]}addToContextMenu(e){e.items.push({name:KEY$c},addEditCommentItem(this),removeCommentItem(this),readOnlyCommentItem(this))}getEditorInputElement(){return _classPrivateFieldGet$x(_editor,this).getInputElement()}destroy(){var e,r;(e=_classPrivateFieldGet$x(_editor,this))===null||e===void 0||e.destroy(),(r=_classPrivateFieldGet$x(_displaySwitch,this))===null||r===void 0||r.destroy(),super.destroy()}}function _onMouseDown$2(t){if(!(!this.hot.view||!this.hot.view._wt)&&!_classPrivateFieldGet$x(_preventEditorAutoSwitch,this)&&!this.targetIsCommentTextArea(t)){const e=closest(t.target,"TD","TBODY");let r=null;e&&(r=this.hot.getCoords(e)),(!e||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function _onInputElementMouseDown(t){t.stopPropagation()}function _onMouseOver$2(t){const{rootDocument:e}=this.hot;if(!(_classPrivateFieldGet$x(_preventEditorAutoSwitch,this)||_classPrivateFieldGet$x(_editor,this).isFocused()||hasClass$1(t.target,"wtBorder")||_classPrivateFieldGet$x(_cellBelowCursor,this)===t.target||!_classPrivateFieldGet$x(_editor,this)))if(_classPrivateFieldSet$w(_cellBelowCursor,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const r=this.hot._createCellRange(this.hot.getCoords(t.target));_classPrivateFieldGet$x(_displaySwitch,this).show(r)}else isChildOf(t.target,e)&&!this.targetIsCommentTextArea(t)&&_classPrivateFieldGet$x(_displaySwitch,this).hide()}function _onMouseUp$4(){_classPrivateFieldSet$w(_preventEditorAutoSwitch,this,!1)}function _onAfterRenderer(t,e){e[META_COMMENT]&&e[META_COMMENT][META_COMMENT_VALUE]&&addClass$1(t,e.commentedCellClassName)}function _onEditorBlur(){_classPrivateFieldSet$w(_commentValueBeforeSave,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function _onEditorFocus(){_classPrivateFieldSet$w(_commentValueBeforeSave,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(SHORTCUTS_CONTEXT_NAME)}function _onEditorResize(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[META_STYLE]:{width:t,height:e}})}function _onAfterDocumentKeyDown(t){_classPrivateFieldGet$x(_editor,this).isFocused()&&stopImmediatePropagation(t)}function _onAfterScroll(){_classPrivateFieldGet$x(_preventEditorHiding,this)||this.hide()}function _defineProperty$X(t,e,r){return(e=_toPropertyKey$X(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$X(t){var e=_toPrimitive$X(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$X(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CommandExecutor{constructor(e){_defineProperty$X(this,"hot",void 0),_defineProperty$X(this,"commands",{}),_defineProperty$X(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=findSubCommand(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||hasOwnProperty(l,"submenu"))return;const c=[];typeof l.callback=="function"&&c.push(l.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(s.join(":")),arrayEach(c,u=>u.apply(this.hot,i))}}function findSubCommand(t,e){let r;return arrayEach(e,i=>{const n=i.key?i.key.split(":"):null;if(Array.isArray(n)&&n[1]===t)return r=i,!1}),r}function _defineProperty$W(t,e,r){return(e=_toPropertyKey$W(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$W(t){var e=_toPrimitive$W(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$W(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ItemsFactory{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;_defineProperty$W(this,"hot",void 0),_defineProperty$W(this,"predefinedItems",predefinedItems()),_defineProperty$W(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,objectEach(e,(i,n)=>{let s="";i.name===KEY$c?(r[KEY$c]=i,s=KEY$c):isNaN(parseInt(n,10))?(i.key=i.key===void 0?n:i.key,r[n]=i,s=i.key):(r[i.key]=i,s=i.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return getItems(e,this.defaultOrderPattern,this.predefinedItems)}}function getItems(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let n=t;return n&&n.items?n=n.items:Array.isArray(n)||(n=e),isObject(n)?objectEach(n,(s,o)=>{let a=r[typeof s=="string"?s:o];a||(a=s),isObject(s)?extend$1(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),i.push(a)}):arrayEach(n,(s,o)=>{let a=r[s];!a&&ITEMS.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),isObject(s)&&extend$1(a,s),a.key===void 0&&(a.key=o),i.push(a))}),i}function _defineProperty$V(t,e,r){return(e=_toPropertyKey$V(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$V(t){var e=_toPrimitive$V(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$V(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cursor{constructor(e,r){_defineProperty$V(this,"top",void 0),_defineProperty$V(this,"topRelative",void 0),_defineProperty$V(this,"left",void 0),_defineProperty$V(this,"leftRelative",void 0),_defineProperty$V(this,"scrollTop",void 0),_defineProperty$V(this,"scrollLeft",void 0),_defineProperty$V(this,"cellHeight",void 0),_defineProperty$V(this,"cellWidth",void 0);const i=r.scrollY,n=r.scrollX;let s,o,a,l,c,u;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),c=e.height||0,u=e.width||0,o=s,l=a,s+=i,a+=n):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),c=e.target.clientHeight,u=e.target.clientWidth,o=s-i,l=a-n),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=n,this.cellHeight=c,this.cellWidth=u}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function _classPrivateFieldInitSpec$w(t,e,r){_checkPrivateRedeclaration$K(t,e),e.set(t,r)}function _checkPrivateRedeclaration$K(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$w(t,e){return t.get(_assertClassBrand$K(t,e))}function _classPrivateFieldSet$v(t,e,r){return t.set(_assertClassBrand$K(t,e),r),r}function _assertClassBrand$K(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _container=new WeakMap,_parentContainer=new WeakMap,_cursor=new WeakMap,_keepInViewport=new WeakMap,_offset=new WeakMap;class Positioner{constructor(e){_classPrivateFieldInitSpec$w(this,_container,void 0),_classPrivateFieldInitSpec$w(this,_parentContainer,void 0),_classPrivateFieldInitSpec$w(this,_cursor,void 0),_classPrivateFieldInitSpec$w(this,_keepInViewport,!1),_classPrivateFieldInitSpec$w(this,_offset,{above:0,below:0,left:0,right:0}),_classPrivateFieldSet$v(_keepInViewport,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return _classPrivateFieldGet$w(_offset,this)[e]=r,this}setElement(e){return _classPrivateFieldSet$v(_container,this,e),this}setParentElement(e){return _classPrivateFieldSet$v(_parentContainer,this,e),this}updatePosition(e){_classPrivateFieldSet$v(_cursor,this,new Cursor(e,_classPrivateFieldGet$w(_container,this).ownerDocument.defaultView)),_classPrivateFieldGet$w(_keepInViewport,this)?(_classPrivateFieldGet$w(_cursor,this).fitsBelow(_classPrivateFieldGet$w(_container,this))?this.setPositionBelowCursor():_classPrivateFieldGet$w(_cursor,this).fitsAbove(_classPrivateFieldGet$w(_container,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){_classPrivateFieldGet$w(_container,this).dir==="rtl"?_classPrivateFieldGet$w(_cursor,this).fitsOnLeft(_classPrivateFieldGet$w(_container,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():_classPrivateFieldGet$w(_cursor,this).fitsOnRight(_classPrivateFieldGet$w(_container,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=_classPrivateFieldGet$w(_offset,this).above+_classPrivateFieldGet$w(_cursor,this).top-_classPrivateFieldGet$w(_container,this).offsetHeight;if(_classPrivateFieldGet$w(_parentContainer,this)){const i=_classPrivateFieldGet$w(_parentContainer,this).ownerDocument.defaultView.getComputedStyle(_classPrivateFieldGet$w(_parentContainer,this).querySelector(".ht_master")),n=Number.parseInt(i.paddingTop,10),s=Number.parseInt(i.borderTop,10);e=_classPrivateFieldGet$w(_cursor,this).top+_classPrivateFieldGet$w(_cursor,this).cellHeight-_classPrivateFieldGet$w(_container,this).scrollHeight+n+s}_classPrivateFieldGet$w(_container,this).style.top=`${e}px`}setPositionBelowCursor(){let e=_classPrivateFieldGet$w(_offset,this).below+_classPrivateFieldGet$w(_cursor,this).top+1;if(_classPrivateFieldGet$w(_parentContainer,this)){const i=_classPrivateFieldGet$w(_parentContainer,this).ownerDocument.defaultView.getComputedStyle(_classPrivateFieldGet$w(_parentContainer,this).querySelector(".ht_master")),n=Number.parseInt(i.paddingTop,10),s=Number.parseInt(i.borderTop,10);e=_classPrivateFieldGet$w(_cursor,this).top-n-s-1}_classPrivateFieldGet$w(_container,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=_classPrivateFieldGet$w(_cursor,this).left;if(_classPrivateFieldGet$w(_parentContainer,this)){const r=_classPrivateFieldGet$w(_parentContainer,this).ownerDocument.defaultView,i=Number.parseInt(r.getComputedStyle(_classPrivateFieldGet$w(_parentContainer,this).querySelector(".htCore")).borderRightWidth,10);e+=_classPrivateFieldGet$w(_cursor,this).cellWidth+i}else e+=_classPrivateFieldGet$w(_offset,this).right;_classPrivateFieldGet$w(_container,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=_classPrivateFieldGet$w(_offset,this).left+_classPrivateFieldGet$w(_cursor,this).left-_classPrivateFieldGet$w(_container,this).offsetWidth;if(_classPrivateFieldGet$w(_parentContainer,this)){const r=_classPrivateFieldGet$w(_parentContainer,this).ownerDocument.defaultView,i=Number.parseInt(r.getComputedStyle(_classPrivateFieldGet$w(_parentContainer,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}_classPrivateFieldGet$w(_container,this).style.left=`${e}px`}}function createPaginator(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:i=()=>{},onClear:n=()=>{}}=t;const s=new Set;let o=clamp(e,-1,m()-1);function a(y,v){const E=m()-1;return y<0&&(y=E),y>E&&(y=0),s.has(y)?-1:(s.add(y),i(y,!1)===!1&&(y=a(v===1?++y:--y,v)),y)}function l(y){y>-1&&y<m()&&i(y,!0)!==!1&&(o=y)}function c(y){y>-1&&y<m()&&(o=y)}function u(){return o}function d(){m()>0&&(s.clear(),o=a(0,1))}function h(){m()>0&&(s.clear(),o=a(m()-1,-1))}function f(){m()>0&&(s.clear(),o=a(++o,1))}function g(){m()>0&&(s.clear(),o=a(--o,-1))}function m(){return Math.max(r(),0)}function C(){s.clear(),o=e,n()}return{setCurrentPage:l,setPageCursorAt:c,getCurrentPage:u,toFirstItem:d,toLastItem:h,toNextItem:f,toPreviousItem:g,getSize:m,clear:C}}function normalizeSelection(t){return arrayMap(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function isItemSubMenu(t){return hasOwnProperty(t,"submenu")}function isItemSeparator(t){return new RegExp(KEY$c,"i").test(t.name)}function isItemDisabled(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function isItemSelectionDisabled(t){return hasOwnProperty(t,"disableSelection")}function isSeparator(t){return hasClass$1(t,"htSeparator")}function hasSubMenu(t){return hasClass$1(t,"htSubmenu")}function isDisabled(t){return hasClass$1(t,"htDisabled")}function isSelectionDisabled(t){return hasClass$1(t,"htSelectionDisabled")}function isItemHidden(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function shiftSeparators(t,e){const r=t.slice(0);for(let i=0;i<r.length&&r[i].name===e;)r.shift();return r}function popSeparators(t,e){let r=t.slice(0);return r.reverse(),r=shiftSeparators(r,e),r.reverse(),r}function removeDuplicatedSeparators(t){const e=[];return arrayEach(t,(r,i)=>{i>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function filterSeparators(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:KEY$c,r=t.slice(0);return r=shiftSeparators(r,e),r=popSeparators(r,e),r=removeDuplicatedSeparators(r),r}function isItemCheckable(t){return t.checkable===!0}function createMenuNavigator(t){return createPaginator({size:()=>t.countRows(),onItemSelect(e,r){const i=t.getCell(e,0);if(!i||isSeparator(i)||isDisabled(i)||isSelectionDisabled(i))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function createDefaultShortcutsList(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,n)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(i):s.tabMoves;n.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const i=r.getSelectedLast();if(i){const n=t.openSubMenu(i[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const n=r.getSelectedLast();n&&(r.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const SHORTCUTS_CONTEXT="menu",SHORTCUTS_GROUP$8=SHORTCUTS_CONTEXT;function createKeyboardShortcutsCtrl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];i(createDefaultShortcutsList(t)),e.forEach(c=>{let{shortcuts:u,contextName:d}=c;n(u,d)});function i(c,u){a(u).addShortcuts(c,{group:SHORTCUTS_CONTEXT})}function n(c,u){const d=a(u);c.forEach(h=>{let{keys:f}=h;f.forEach(g=>d.removeShortcutsByKeys(g))}),r.push({shortcuts:c,contextName:u}),i(c,u)}function s(){return[...r]}function o(c){return c?`${SHORTCUTS_GROUP$8}:${c}`:SHORTCUTS_GROUP$8}function a(c){var u;const d=t.hotMenu.getShortcutManager(),h=o(c);return(u=d.getContext(h))!==null&&u!==void 0?u:d.addContext(h)}function l(c){t.hotMenu.getShortcutManager().setActiveContextName(o(c))}return{addCustomShortcuts:n,getCustomShortcuts:s,getContext:a,listen:l}}function createMenuItemRenderer(t){return(e,r,i,n,s,o)=>{const a=e.getSourceDataAtRow(i),l=t.rootDocument.createElement("div"),c=typeof o=="function"?o.call(t):o,u=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,d=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(empty(r),addClass$1(l,"htItemWrapper"),t.getSettings().ariaTags){const h=!isItemDisabled(a,t)&&!isItemSelectionDisabled(a)&&!isItemSeparator(a);setAttribute(r,[...isItemCheckable(a)?[A11Y_MENU_ITEM_CHECKBOX(),A11Y_LABEL(u),A11Y_CHECKED(d)]:[A11Y_MENU_ITEM(),A11Y_LABEL(c)],...h?[A11Y_TABINDEX(-1)]:[],...isItemDisabled(a,t)?[A11Y_DISABLED()]:[],...isItemSubMenu(a)?[A11Y_EXPANDED(!1)]:[]])}r.className="",r.appendChild(l),isItemSeparator(a)?addClass$1(r,"htSeparator"):typeof a.renderer=="function"?(addClass$1(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,i,n,s,c))):fastInnerHTML(l,c),isItemDisabled(a,t)?addClass$1(r,"htDisabled"):isItemSelectionDisabled(a)?addClass$1(r,"htSelectionDisabled"):isItemSubMenu(a)&&addClass$1(r,"htSubmenu")}}function _classPrivateFieldInitSpec$v(t,e,r){_checkPrivateRedeclaration$J(t,e),e.set(t,r)}function _checkPrivateRedeclaration$J(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$U(t,e,r){return(e=_toPropertyKey$U(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$U(t){var e=_toPrimitive$U(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$U(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldSet$u(t,e,r){return t.set(_assertClassBrand$J(t,e),r),r}function _classPrivateFieldGet$v(t,e){return t.get(_assertClassBrand$J(t,e))}function _assertClassBrand$J(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const MIN_WIDTH=215;var _navigator=new WeakMap,_shortcutsCtrl=new WeakMap,_tableBorderWidth=new WeakMap;class Menu{get tableBorderWidth(){return _classPrivateFieldGet$v(_tableBorderWidth,this)===void 0&&this.hotMenu&&_classPrivateFieldSet$u(_tableBorderWidth,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),_classPrivateFieldGet$v(_tableBorderWidth,this)}constructor(e,r){var i=this;_defineProperty$U(this,"hot",void 0),_defineProperty$U(this,"options",void 0),_defineProperty$U(this,"eventManager",new EventManager(this)),_defineProperty$U(this,"container",void 0),_defineProperty$U(this,"positioner",void 0),_defineProperty$U(this,"hotMenu",null),_defineProperty$U(this,"hotSubMenus",{}),_defineProperty$U(this,"parentMenu",void 0),_defineProperty$U(this,"menuItems",null),_defineProperty$U(this,"origOutsideClickDeselects",null),_classPrivateFieldInitSpec$v(this,_navigator,void 0),_classPrivateFieldInitSpec$v(this,_shortcutsCtrl,void 0),_classPrivateFieldInitSpec$v(this,_tableBorderWidth,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:MIN_WIDTH,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new Positioner(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return i.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(n,s)=>{this.options.container!==this.hot.rootPortalElement&&(removeClass$1(this.options.container,/ht-theme-.*/g),addClass$1(this.options.container,n)),s||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=getParentWindow(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return _classPrivateFieldGet$v(_navigator,this)}getKeyboardShortcutsCtrl(){return _classPrivateFieldGet$v(_shortcutsCtrl,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=debounce(a=>this.openSubMenu(a),300),r=this.options.minWidth||MIN_WIDTH;let i=!1,n=arrayFilter(this.menuItems,a=>(a.key===KEY$1&&(i=!0),isItemHidden(a,this.hot)));if(n.length<1&&!i)n.push(predefinedItems()[KEY$1]);else if(n.length===0)return;n=filterSeparators(n,KEY$c);let s=!1;const o={data:n,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return isDefined(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:createMenuItemRenderer(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?_classPrivateFieldGet$v(_navigator,this).setCurrentPage(l.row):_classPrivateFieldGet$v(_navigator,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),isWindowsOS()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,c,u,d)=>{this.hotMenu.view.isMouseDown()&&(d.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!isWindowsOS()||!isRightClick(a))&&s&&this.hasSelectedItem()&&(isMobileBrowser()||isIpadOS()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),_classPrivateFieldSet$u(_navigator,this,createMenuNavigator(this.hotMenu)),_classPrivateFieldSet$u(_shortcutsCtrl,this,createKeyboardShortcutsCtrl(this)),_classPrivateFieldGet$v(_shortcutsCtrl,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(_classPrivateFieldGet$v(_navigator,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const i=this.parentMenu.hotMenu.getCell(r[0],0);setAttribute(i,[A11Y_EXPANDED(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!hasSubMenu(r))return!1;const i=this.hotMenu.getSourceDataAtRow(e),n=new Menu(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return n.setMenuItems(i.submenu.items),n.open(),n.setPosition(r.getBoundingClientRect()),this.hotSubMenus[i.key]=n,this.hot.getSettings().ariaTags&&setAttribute(r,[A11Y_EXPANDED(!0)]),n}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[r.key];if(i){i.destroy(),delete this.hotSubMenus[r.key];const n=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&setAttribute(n,[A11Y_EXPANDED(!1)])}}closeAllSubMenus(){arrayEach(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const i=this.hot.getSelectedRange(),n=i?normalizeSelection(i):[];this.runLocalHooks("executeCommand",r.key,n,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,n,e)}isCommandPassive(e){return e.isCommand===!1||isItemSeparator(e)||isItemDisabled(e,this.hot)||isItemSubMenu(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=e.hider.style,n=e.holder.style,s=parseInt(i.width,10),o=arrayReduce(r,(a,l,c)=>{const d=this.hotMenu.getCell(c,0)?outerHeight(this.hotMenu.getCell(c,0)):0;return a+(l.name===KEY$c?1:d)},0);this.hotMenu.stylesHandler.isClassicTheme()?(n.width=`${s+3}px`,n.height=`${o+3}px`):(n.width=`${s}px`,n.height=`${o}px`),i.height=n.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let i=e,n;return i&&(isFunction(i)&&(i=i.call(this.hot),i===null||isUndefined(i)?i="":i=i.toString()),i=i.replace(/[^A-Za-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,n=r.querySelector(`.${this.options.className}.${i}`)),n||(n=r.createElement("div"),addClass$1(n,`htMenu handsontable ${this.options.className}`),i&&addClass$1(n,i),this.options.container.appendChild(n)),n}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&setAttribute(this.hotMenu.rootElement,[A11Y_MENU(),A11Y_TABINDEX(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!isChildOf(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!isChildOf(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&hasClass$1(e.target,"htCore")&&isChildOf(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}mixin(Menu,localHooks);function _classPrivateMethodInitSpec$y(t,e){_checkPrivateRedeclaration$I(t,e),e.add(t)}function _checkPrivateRedeclaration$I(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$T(t,e,r){return(e=_toPropertyKey$T(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$T(t){var e=_toPrimitive$T(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$T(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$I(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$p="contextMenu",PLUGIN_PRIORITY$p=70,SHORTCUTS_GROUP$7=PLUGIN_KEY$p;Hooks.getSingleton().register("afterContextMenuDefaultOptions");Hooks.getSingleton().register("beforeContextMenuShow");Hooks.getSingleton().register("afterContextMenuShow");Hooks.getSingleton().register("afterContextMenuHide");Hooks.getSingleton().register("afterContextMenuExecute");var _ContextMenu_brand=new WeakSet;class ContextMenu extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$y(this,_ContextMenu_brand),_defineProperty$T(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty$T(this,"itemsFactory",null),_defineProperty$T(this,"menu",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$p}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$p}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY$3,KEY$2,KEY$c,KEY$9,KEY$8,KEY$c,KEY$4,KEY$5,KEY$c,KEY,KEY$6,KEY$c,KEY$7,KEY$c,KEY$b]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$p]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[PLUGIN_KEY$p];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Menu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand$I(_ContextMenu_brand,this,_onMenuBeforeOpen$1).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand$I(_ContextMenu_brand,this,_onMenuAfterOpen$1).call(this)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand$I(_ContextMenu_brand,this,_onMenuAfterClose$1).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return e.executeCommand.call(e,...n)}),this.addHook("afterOnCellContextMenu",i=>_assertClassBrand$I(_ContextMenu_brand,this,_onAfterOnCellContextMenu).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({left:r.left+i.left,top:r.top+i.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:SHORTCUTS_GROUP$7})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$7)}open(e){var r;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open();const n=this.menu.tableBorderWidth>0;objectEach(i,(s,o)=>{const a=["below","right"].includes(o)?s+1:s-1;this.menu.setOffset(o,n?s:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new ItemsFactory(this.hot,ContextMenu.DEFAULT_ITEMS);const e=this.hot.getSettings()[PLUGIN_KEY$p],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),arrayEach(i,n=>this.commandExecutor.registerCommand(n.key,n))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _onAfterOnCellContextMenu(t){const e=this.hot.getSettings(),r=e.rowHeaders,i=e.colHeaders;function n(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),hasClass$1(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||i)&&!n(s)&&!(hasClass$1(s,"current")&&hasClass$1(s,"wtBorder"))))return;const o=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function _onMenuBeforeOpen$1(){this.hot.runHooks("beforeContextMenuShow",this)}function _onMenuAfterOpen$1(){this.hot.runHooks("afterContextMenuShow",this)}function _onMenuAfterClose$1(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ContextMenu.SEPARATOR={name:KEY$c};function copyItem(t){return{key:"copy",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function copyColumnHeadersOnlyItem(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?clamp(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function copyWithColumnGroupHeadersItem(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?clamp(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function copyWithColumnHeadersItem(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?clamp(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function cutItem(t){return{key:"cut",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CUT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class ClipboardData{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class PasteEvent{constructor(){this.clipboardData=new ClipboardData}preventDefault(){}composedPath(){return[]}}function _classPrivateMethodInitSpec$x(t,e){_checkPrivateRedeclaration$H(t,e),e.add(t)}function _classPrivateFieldInitSpec$u(t,e,r){_checkPrivateRedeclaration$H(t,e),e.set(t,r)}function _checkPrivateRedeclaration$H(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$u(t,e){return t.get(_assertClassBrand$H(t,e))}function _classPrivateFieldSet$t(t,e,r){return t.set(_assertClassBrand$H(t,e),r),r}function _assertClassBrand$H(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _selectedRange=new WeakMap,_countRows=new WeakMap,_countColumns=new WeakMap,_rowsLimit=new WeakMap,_columnsLimit$1=new WeakMap,_countColumnHeaders=new WeakMap,_CopyableRangesFactory_brand=new WeakSet;class CopyableRangesFactory{constructor(e){let{countRows:r,countColumns:i,rowsLimit:n,columnsLimit:s,countColumnHeaders:o}=e;_classPrivateMethodInitSpec$x(this,_CopyableRangesFactory_brand),_classPrivateFieldInitSpec$u(this,_selectedRange,void 0),_classPrivateFieldInitSpec$u(this,_countRows,void 0),_classPrivateFieldInitSpec$u(this,_countColumns,void 0),_classPrivateFieldInitSpec$u(this,_rowsLimit,void 0),_classPrivateFieldInitSpec$u(this,_columnsLimit$1,void 0),_classPrivateFieldInitSpec$u(this,_countColumnHeaders,void 0),_classPrivateFieldSet$t(_countRows,this,r),_classPrivateFieldSet$t(_countColumns,this,i),_classPrivateFieldSet$t(_rowsLimit,this,n),_classPrivateFieldSet$t(_columnsLimit$1,this,s),_classPrivateFieldSet$t(_countColumnHeaders,this,o)}setSelectedRange(e){_classPrivateFieldSet$t(_selectedRange,this,e)}getCellsRange(){if(_classPrivateFieldGet$u(_countRows,this).call(this)===0||_classPrivateFieldGet$u(_countColumns,this).call(this)===0)return null;const{row:e,col:r}=_classPrivateFieldGet$u(_selectedRange,this).getTopStartCorner(),{row:i,col:n}=_classPrivateFieldGet$u(_selectedRange,this).getBottomEndCorner(),s=_assertClassBrand$H(_CopyableRangesFactory_brand,this,_trimRowsRange).call(this,e,i),o=_assertClassBrand$H(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,r,n);return{isRangeTrimmed:i!==s||n!==o,startRow:e,startCol:r,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(_classPrivateFieldGet$u(_countColumns,this).call(this)===0||_classPrivateFieldGet$u(_countColumnHeaders,this).call(this)===0)return null;const{col:e}=_classPrivateFieldGet$u(_selectedRange,this).getTopStartCorner(),{col:r}=_classPrivateFieldGet$u(_selectedRange,this).getBottomEndCorner(),i=_assertClassBrand$H(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,e,r);return{isRangeTrimmed:r!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(_classPrivateFieldGet$u(_countColumns,this).call(this)===0||_classPrivateFieldGet$u(_countColumnHeaders,this).call(this)===0)return null;const{col:e}=_classPrivateFieldGet$u(_selectedRange,this).getTopStartCorner(),{col:r}=_classPrivateFieldGet$u(_selectedRange,this).getBottomEndCorner(),i=_assertClassBrand$H(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,e,r);return{isRangeTrimmed:r!==i,startRow:-_classPrivateFieldGet$u(_countColumnHeaders,this).call(this),startCol:e,endRow:-1,endCol:i}}}function _trimColumnsRange(t,e){return Math.min(e,Math.max(t+_classPrivateFieldGet$u(_columnsLimit$1,this).call(this)-1,t))}function _trimRowsRange(t,e){return Math.min(e,Math.max(t+_classPrivateFieldGet$u(_rowsLimit,this).call(this)-1,t))}function normalizeRanges(t){const e=[],r=[];return arrayEach(t,i=>{const n=Math.min(i.startRow,i.endRow),s=Math.max(i.startRow,i.endRow);rangeEach(n,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);rangeEach(o,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function _classPrivateMethodInitSpec$w(t,e){_checkPrivateRedeclaration$G(t,e),e.add(t)}function _classPrivateFieldInitSpec$t(t,e,r){_checkPrivateRedeclaration$G(t,e),e.set(t,r)}function _checkPrivateRedeclaration$G(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$S(t,e,r){return(e=_toPropertyKey$S(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$S(t){var e=_toPrimitive$S(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$S(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$t(t,e){return t.get(_assertClassBrand$G(t,e))}function _classPrivateFieldSet$s(t,e,r){return t.set(_assertClassBrand$G(t,e),r),r}function _assertClassBrand$G(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("afterCopyLimit");Hooks.getSingleton().register("modifyCopyableRange");Hooks.getSingleton().register("beforeCut");Hooks.getSingleton().register("afterCut");Hooks.getSingleton().register("beforePaste");Hooks.getSingleton().register("afterPaste");Hooks.getSingleton().register("beforeCopy");Hooks.getSingleton().register("afterCopy");const PLUGIN_KEY$o="copyPaste",PLUGIN_PRIORITY$o=80,SETTING_KEYS$1=["fragmentSelection"],META_HEAD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var _enableCopyColumnHeaders=new WeakMap,_enableCopyColumnGroupHeaders=new WeakMap,_enableCopyColumnHeadersOnly=new WeakMap,_copyMode=new WeakMap,_isTriggeredByCopy=new WeakMap,_isTriggeredByCut=new WeakMap,_copyableRangesFactory=new WeakMap,_preventViewportScrollOnPaste=new WeakMap,_CopyPaste_brand=new WeakSet;class CopyPaste extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$w(this,_CopyPaste_brand),_defineProperty$S(this,"columnsLimit",1/0),_defineProperty$S(this,"rowsLimit",1/0),_defineProperty$S(this,"pasteMode","overwrite"),_defineProperty$S(this,"uiContainer",this.hot.rootDocument.body),_classPrivateFieldInitSpec$t(this,_enableCopyColumnHeaders,!1),_classPrivateFieldInitSpec$t(this,_enableCopyColumnGroupHeaders,!1),_classPrivateFieldInitSpec$t(this,_enableCopyColumnHeadersOnly,!1),_classPrivateFieldInitSpec$t(this,_copyMode,"cells-only"),_classPrivateFieldInitSpec$t(this,_isTriggeredByCopy,!1),_classPrivateFieldInitSpec$t(this,_isTriggeredByCut,!1),_classPrivateFieldInitSpec$t(this,_copyableRangesFactory,new CopyableRangesFactory({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),_classPrivateFieldInitSpec$t(this,_preventViewportScrollOnPaste,!1),_defineProperty$S(this,"copyableRanges",[])}static get PLUGIN_KEY(){return PLUGIN_KEY$o}static get SETTING_KEYS(){return[PLUGIN_KEY$o,...SETTING_KEYS$1]}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$o}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$o]}enablePlugin(){var e,r,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),_classPrivateFieldSet$s(_enableCopyColumnHeaders,this,this.getSetting("copyColumnHeaders")),_classPrivateFieldSet$s(_enableCopyColumnGroupHeaders,this,this.getSetting("copyColumnGroupHeaders")),_classPrivateFieldSet$s(_enableCopyColumnHeadersOnly,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",n=>_assertClassBrand$G(_CopyPaste_brand,this,_onAfterContextMenuDefaultOptions$4).call(this,n)),this.addHook("afterSelection",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$G(_CopyPaste_brand,i,_onAfterSelection).call(i,...s)}),this.addHook("afterSelectionEnd",()=>_assertClassBrand$G(_CopyPaste_brand,this,_onAfterSelectionEnd$1).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),isSafari()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$G(_CopyPaste_brand,i,_onSafariMouseEnter).call(i,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$G(_CopyPaste_brand,i,_onSafariMouseLeave).call(i,...s)}),this.addHook("afterSelection",()=>_assertClassBrand$G(_CopyPaste_brand,this,_onSafariAfterSelection).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";_classPrivateFieldSet$s(_copyMode,this,e),_classPrivateFieldSet$s(_isTriggeredByCopy,this,!0),_assertClassBrand$G(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){_classPrivateFieldSet$s(_isTriggeredByCut,this,!0),_assertClassBrand$G(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"cut")}getRangedCopyableData(e){return stringify(this.getRangedData(e))}getRangedData(e){const r=[],{rows:i,columns:n}=normalizeRanges(e);return arrayEach(i,s=>{const o=[];arrayEach(n,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),r.push(o)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const i=new PasteEvent;e&&i.clipboardData.setData("text/plain",e),r&&i.clipboardData.setData("text/html",r),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}_classPrivateFieldGet$t(_copyableRangesFactory,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);_classPrivateFieldGet$t(_copyMode,this)==="column-headers-only"?r.set("headers",_classPrivateFieldGet$t(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):(_classPrivateFieldGet$t(_copyMode,this)==="with-column-headers"?r.set("headers",_classPrivateFieldGet$t(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):_classPrivateFieldGet$t(_copyMode,this)==="with-column-group-headers"&&r.set("headers",_classPrivateFieldGet$t(_copyableRangesFactory,this).getAllColumnHeadersRange()),r.set("cells",_classPrivateFieldGet$t(_copyableRangesFactory,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(n=>n!==null).map(n=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=n;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=r.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:n,startCol:s,endRow:o,endCol:a}=i;this.hot.runHooks("afterCopyLimit",o-n+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,n=e[0].length,s=[],{row:o,col:a}=r.getTopStartCorner(),{row:l,col:c}=r.getBottomEndCorner();let u=o,d=a,h=o,f=a;for(;s.length<i||u<=l;){const{skipRowOnPaste:g,visualRow:m}=this.hot.getCellMeta(u,a);if(u=m+1,g===!0)continue;h=m,d=a;const C=[],y=s.length%i;for(;C.length<n||d<=c;){const{skipColumnOnPaste:v,visualCol:E}=this.hot.getCellMeta(o,d);if(d=E+1,v===!0)continue;f=E;const $=C.length%n;C.push(e[y][$])}s.push(C)}return _classPrivateFieldSet$s(_preventViewportScrollOnPaste,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,h,f]}onCopy(e){const r=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),n=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet$t(_isTriggeredByCopy,this)||this.isEditorOpened()||isHTMLElement(r)&&(n&&r!==i||!n&&r!==this.hot.rootDocument.body&&!isInternalElement(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),_classPrivateFieldSet$s(_isTriggeredByCopy,this,!1);const s=this.getRangedData(this.copyableRanges),o=_assertClassBrand$G(_CopyPaste_brand,this,_countCopiedHeaders).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,o)){const l=stringify(s);if(e&&e.clipboardData){const c=_dataToHTML(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[META_HEAD,c].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",s,this.copyableRanges,o)}_classPrivateFieldSet$s(_copyMode,this,"cells-only")}onCut(e){const r=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),n=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet$t(_isTriggeredByCut,this)||this.isEditorOpened()||isHTMLElement(r)&&(n&&r!==i||!n&&r!==this.hot.rootDocument.body&&!isInternalElement(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),_classPrivateFieldSet$s(_isTriggeredByCut,this,!1);const s=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",s,this.copyableRanges)){const a=stringify(s);if(e&&e.clipboardData){const l=_dataToHTML(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[META_HEAD,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges)}}onPaste(e){const r=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),n=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||isHTMLElement(r)&&(n&&r!==i||!n&&r!==this.hot.rootDocument.body&&!isInternalElement(r,this.hot.rootElement)))return;e.preventDefault();let s;if(e&&typeof e.clipboardData<"u"){const u=sanitize(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});u&&/(<table)|(<TABLE)/g.test(u)?s=htmlToGridSettings(u,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=parse(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[o,a,l,c]=this.populateValues(s);this.hot.selectCell(o,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function _ensureClipboardEventsGetTriggered(t){if(isSafari()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:i}=e.highlight,n=this.hot.getCell(r,i,!0);n&&runWithSelectedContendEditableElement(n,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function _countCopiedHeaders(t){const{rows:e}=normalizeRanges(t);let r=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)r+=1;return{columnHeadersCount:r}}function _addContentEditableToHighlightedCell(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,i=this.hot.getCell(e,r,!0);i&&makeElementContentEditableAndSelectItsContent(i)}}}function _removeContentEditableFromHighlightedCell(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,i=this.hot.getCell(e,r,!0);i!=null&&i.hasAttribute("contenteditable")&&removeContentEditableFromElementAndDeselect(i)}}}function _onAfterContextMenuDefaultOptions$4(t){t.items.push({name:"---------"},copyItem(this)),_classPrivateFieldGet$t(_enableCopyColumnHeaders,this)&&t.items.push(copyWithColumnHeadersItem(this)),_classPrivateFieldGet$t(_enableCopyColumnGroupHeaders,this)&&t.items.push(copyWithColumnGroupHeadersItem(this)),_classPrivateFieldGet$t(_enableCopyColumnHeadersOnly,this)&&t.items.push(copyColumnHeadersOnlyItem(this)),t.items.push(cutItem(this))}function _onAfterSelection(t,e,r,i,n){_classPrivateFieldGet$t(_preventViewportScrollOnPaste,this)&&(n.value=!0),_classPrivateFieldSet$s(_preventViewportScrollOnPaste,this,!1)}function _onAfterSelectionEnd$1(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function _onSafariMouseEnter(){_assertClassBrand$G(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function _onSafariMouseLeave(){_assertClassBrand$G(_CopyPaste_brand,this,_addContentEditableToHighlightedCell).call(this)}function _onSafariAfterSelection(){_assertClassBrand$G(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function createId(t,e){return`border_row${t}col${e}`}function createDefaultCustomBorder(){return{width:1,color:"#000"}}function createSingleEmptyBorder(){return{hide:!0}}function createDefaultHtBorder(){return{width:1,color:"#000",cornerVisible:!1}}function normalizeBorder(t){if(isDefined(t.start)||isDefined(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(isDefined(t.end)||isDefined(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function denormalizeBorder(t){return isDefined(t.start)&&(t.left=t.start),isDefined(t.end)&&(t.right=t.end),t}function createEmptyBorders(t,e){return{id:createId(t,e),border:createDefaultHtBorder(),row:t,col:e,top:createSingleEmptyBorder(),bottom:createSingleEmptyBorder(),start:createSingleEmptyBorder(),end:createSingleEmptyBorder()}}function extendDefaultBorder(t,e){return hasOwnProperty(e,"border")&&e.border&&(t.border=e.border),hasOwnProperty(e,"top")&&isDefined(e.top)&&(e.top?(isObject(e.top)||(e.top=createDefaultCustomBorder()),t.top=e.top):(e.top=createSingleEmptyBorder(),t.top=e.top)),hasOwnProperty(e,"bottom")&&isDefined(e.bottom)&&(e.bottom?(isObject(e.bottom)||(e.bottom=createDefaultCustomBorder()),t.bottom=e.bottom):(e.bottom=createSingleEmptyBorder(),t.bottom=e.bottom)),hasOwnProperty(e,"start")&&isDefined(e.start)&&(e.start?(isObject(e.start)||(e.start=createDefaultCustomBorder()),t.start=e.start):(e.start=createSingleEmptyBorder(),t.start=e.start)),hasOwnProperty(e,"end")&&isDefined(e.end)&&(e.end?(isObject(e.end)||(e.end=createDefaultCustomBorder()),t.end=e.end):(e.end=createSingleEmptyBorder(),t.end=e.end)),t}function checkSelectionBorders(t,e){let r=!1;return arrayEach(t.getSelectedRange(),i=>{i.forAll((n,s)=>{if(n<0||s<0)return;const o=t.getCellMeta(n,s).borders;if(o)if(e){if(!hasOwnProperty(o[e],"hide")||o[e].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function markSelected(t){return`<span class="selected">✓</span>${t}`}function hasLeftRightTypeOptions(t){return t.some(e=>isDefined(e.left)||isDefined(e.right))}function hasStartEndTypeOptions(t){return t.some(e=>isDefined(e.start)||isDefined(e.end))}const physicalToInlinePropNames=new Map([["left","start"],["right","end"]]);function toInlinePropName(t){var e;return(e=physicalToInlinePropNames.get(t))!==null&&e!==void 0?e:t}function bottom(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return checkSelectionBorders(this,"bottom")&&(e=markSelected(e)),e},callback(e,r){const i=checkSelectionBorders(this,"bottom");t.prepareBorder(r,"bottom",i)}}}function left(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_LEFT);return checkSelectionBorders(this,e)&&(r=markSelected(r)),r},callback(r,i){const n=checkSelectionBorders(this,e);t.prepareBorder(i,e,n)}}}function noBorders(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(e,r){t.prepareBorder(r,"noBorders")},disabled(){return!checkSelectionBorders(this)}}}function right(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_RIGHT);return checkSelectionBorders(this,e)&&(r=markSelected(r)),r},callback(r,i){const n=checkSelectionBorders(this,e);t.prepareBorder(i,e,n)}}}function top$1(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_TOP);return checkSelectionBorders(this,"top")&&(e=markSelected(e)),e},callback(e,r){const i=checkSelectionBorders(this,"top");t.prepareBorder(r,"top",i)}}}function _classPrivateMethodInitSpec$v(t,e){_checkPrivateRedeclaration$F(t,e),e.add(t)}function _checkPrivateRedeclaration$F(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$R(t,e,r){return(e=_toPropertyKey$R(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$R(t){var e=_toPrimitive$R(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$R(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$F(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$n="customBorders",PLUGIN_PRIORITY$n=90;var _CustomBorders_brand=new WeakSet;class CustomBorders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$v(this,_CustomBorders_brand),_defineProperty$R(this,"savedBorders",[])}static get PLUGIN_KEY(){return PLUGIN_KEY$n}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$n}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$n]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_assertClassBrand$F(_CustomBorders_brand,this,_onAfterContextMenuDefaultOptions$3).call(this,e)),this.addHook("init",()=>_assertClassBrand$F(_CustomBorders_brand,this,_onAfterInit$2).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,r){let i=["top","bottom","start","end"],n=null;r&&(this.checkSettingsCohesion([r]),i=Object.keys(r),n=normalizeBorder(r));const s=detectSelectionType(e),o=normalizeSelectionFactory(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});arrayEach(e,a=>{o(a).forAll((l,c)=>{arrayEach(i,u=>{this.prepareBorderFromCustomAdded(l,c,n,toInlinePropName(u))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const r=detectSelectionType(e),i=normalizeSelectionFactory(r,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),n=[];return arrayEach(e,s=>{i(s).forAll((o,a)=>{arrayEach(this.savedBorders,l=>{l.row===o&&l.col===a&&n.push(denormalizeBorder(l))})})}),n}clearBorders(e){e?this.setBorders(e):(arrayEach(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,r){this.checkSavedBorders(e)||this.savedBorders.push(e);const n=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,n,r)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:n})}prepareBorderFromCustomAdded(e,r,i,n){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||r>=o)return;let a=createEmptyBorders(e,r);i&&(a=extendDefaultBorder(a,i),arrayEach(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",denormalizeBorder(a)),this.insertBorderIntoSettings(a,n)}prepareBorderFromCustomAddedRange(e,r){const i=Math.min(e.to.row,this.hot.countRows()-1),n=Math.min(e.to.col,this.hot.countCols()-1);rangeEach(e.from.row,i,s=>{rangeEach(e.from.col,n,o=>{const a=createEmptyBorders(s,o);let l=0;s===e.from.row&&hasOwnProperty(r,"top")&&(l+=1,a.top=r.top),s===e.to.row&&hasOwnProperty(r,"bottom")&&(l+=1,a.bottom=r.bottom),o===e.from.col&&hasOwnProperty(r,"start")&&(l+=1,a.start=r.start),o===e.to.col&&hasOwnProperty(r,"end")&&(l+=1,a.end=r.end),l>0&&(this.hot.setCellMeta(s,o,"borders",denormalizeBorder(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,r){const i=createId(e,r);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,r,"borders")}setBorder(e,r,i,n){let s=this.hot.getCellMeta(e,r).borders;!s||s.border===void 0?s=createEmptyBorders(e,r):s=normalizeBorder(s),n?(s[i]=createSingleEmptyBorder(),this.countHide(s)===4?this.removeAllBorders(e,r):(this.checkCustomSelectionsFromContextMenu(s,i,n)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",denormalizeBorder(s)))):(s[i]=createDefaultCustomBorder(),this.checkCustomSelectionsFromContextMenu(s,i,n)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",denormalizeBorder(s)))}prepareBorder(e,r,i){arrayEach(e,n=>{let{start:s,end:o}=n;if(s.row===o.row&&s.col===o.col)r==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,r,i);else switch(r){case"noBorders":rangeEach(s.col,o.col,a=>{rangeEach(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":rangeEach(s.col,o.col,a=>{this.setBorder(s.row,a,r,i)});break;case"bottom":rangeEach(s.col,o.col,a=>{this.setBorder(o.row,a,r,i)});break;case"start":rangeEach(s.row,o.row,a=>{this.setBorder(a,s.col,r,i)});break;case"end":rangeEach(s.row,o.row,a=>{this.setBorder(a,o.col,r,i)});break}})}createCustomBorders(e){arrayEach(e,r=>{const i=normalizeBorder(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,i):this.prepareBorderFromCustomAdded(r.row,r.col,i)})}countHide(e){const{top:r,bottom:i,start:n,end:s}=e;return arrayReduce([r,i,n,s],(a,l)=>{let c=a;return l&&l.hide&&(c+=1),c},0)}clearBordersFromSelectionSettings(e){const r=arrayMap(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);r>-1&&this.hot.selection.highlight.customSelections[r].clear()}clearNullCellRange(){arrayEach(this.hot.selection.highlight.customSelections,(e,r)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[r].destroy(),this.hot.selection.highlight.customSelections.splice(r,1),!1})}hideBorders(){arrayEach(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const r=arrayMap(this.savedBorders,i=>i.id).indexOf(e);r>-1&&this.savedBorders.splice(r,1)}checkSavedBorders(e){let r=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),r=!0):arrayEach(this.savedBorders,(n,s)=>{if(e.id===n.id)return this.savedBorders[s]=e,r=!0,!1}),r}checkCustomSelectionsFromContextMenu(e,r,i){let n=!1;return arrayEach(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return arrayEach(o,a=>{a.toggleHiddenClass(r,i)}),n=!0,!1}}),n}checkCustomSelections(e,r,i){const n=this.countHide(e);let s=!1;return n===4?(this.removeAllBorders(e.row,e.col),s=!0):arrayEach(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=r,o.commit(),i){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);arrayEach(a,l=>{l.changeBorderStyle(i,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[PLUGIN_KEY$n];if(Array.isArray(e)){const r=deepClone(e);this.checkSettingsCohesion(r),r.length||(this.savedBorders=r),this.createCustomBorders(r)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const r=hasLeftRightTypeOptions(e),i=hasStartEndTypeOptions(e);if(r&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&r)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function _onAfterContextMenuDefaultOptions$3(t){this.hot.getSettings()[PLUGIN_KEY$n]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[top$1(this),right(this),bottom(this),left(this),noBorders(this)]}})}function _onAfterInit$2(){this.changeBorderSettings()}function _classPrivateMethodInitSpec$u(t,e){_checkPrivateRedeclaration$E(t,e),e.add(t)}function _checkPrivateRedeclaration$E(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$Q(t,e,r){return(e=_toPropertyKey$Q(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$Q(t){var e=_toPrimitive$Q(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$Q(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$E(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$m="dragToScroll",PLUGIN_PRIORITY$m=100;var _DragToScroll_brand=new WeakSet;class DragToScroll extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$u(this,_DragToScroll_brand),_defineProperty$Q(this,"boundaries",null),_defineProperty$Q(this,"callback",null),_defineProperty$Q(this,"listening",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$m}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$m}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$m]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>_assertClassBrand$E(_DragToScroll_brand,this,_setupListening).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>_assertClassBrand$E(_DragToScroll_brand,this,_setupListening).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,r){let i=0,n=0;r<this.boundaries.top?n=r-this.boundaries.top:r>this.boundaries.bottom&&(n=r-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,n)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let r=e;for(;r;)this.eventManager.addEventListener(r.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mousemove",i=>this.onMouseMove(i)),r=getParentWindow(r)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function _setupListening(t){if(isRightClick(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((r,i)=>{var n,s;const o=(n=e.scrollLeft)!==null&&n!==void 0?n:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(r)*50,a+Math.sign(i)*20)}),this.listen()}function _classPrivateMethodInitSpec$t(t,e){_checkPrivateRedeclaration$D(t,e),e.add(t)}function _classPrivateFieldInitSpec$s(t,e,r){_checkPrivateRedeclaration$D(t,e),e.set(t,r)}function _checkPrivateRedeclaration$D(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$P(t,e,r){return(e=_toPropertyKey$P(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$P(t){var e=_toPrimitive$P(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$P(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$s(t,e){return t.get(_assertClassBrand$D(t,e))}function _classPrivateFieldSet$r(t,e,r){return t.set(_assertClassBrand$D(t,e),r),r}function _assertClassBrand$D(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("afterDropdownMenuDefaultOptions");Hooks.getSingleton().register("beforeDropdownMenuShow");Hooks.getSingleton().register("afterDropdownMenuShow");Hooks.getSingleton().register("afterDropdownMenuHide");Hooks.getSingleton().register("afterDropdownMenuExecute");const PLUGIN_KEY$l="dropdownMenu",PLUGIN_PRIORITY$l=230,BUTTON_CLASS_NAME="changeType",SHORTCUTS_GROUP$6=PLUGIN_KEY$l;var _isButtonClicked=new WeakMap,_DropdownMenu_brand=new WeakSet;class DropdownMenu extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$l}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$l}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY$9,KEY$8,KEY$c,KEY$5,KEY$c,KEY$a,KEY$c,KEY$7,KEY$c,KEY$b]}constructor(e){super(e),_classPrivateMethodInitSpec$t(this,_DropdownMenu_brand),_defineProperty$P(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty$P(this,"itemsFactory",null),_defineProperty$P(this,"menu",null),_classPrivateFieldInitSpec$s(this,_isButtonClicked,!1),this.hot.addHook("afterGetColHeader",(r,i)=>_assertClassBrand$D(_DropdownMenu_brand,this,_onAfterGetColHeader$2).call(this,r,i))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$l]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new ItemsFactory(this.hot,DropdownMenu.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$D(_DropdownMenu_brand,e,_onBeforeOnCellMouseDown$4).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$D(_DropdownMenu_brand,e,_onBeforeViewportScrollHorizontally$1).call(e,...s)});const r=this.hot.getSettings()[PLUGIN_KEY$l],i={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const n=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new Menu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",n),this.menu.setMenuItems(n),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand$D(_DropdownMenu_brand,this,_onMenuBeforeOpen).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand$D(_DropdownMenu_brand,this,_onMenuAfterOpen).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>_assertClassBrand$D(_DropdownMenu_brand,this,_onSubMenuAfterOpen).call(this,s)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand$D(_DropdownMenu_brand,this,_onMenuAfterClose).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),arrayEach(n,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),r=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:n}=this.hot.getSelectedRangeLast(),s=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,n.col,!0).querySelector(`.${BUTTON_CLASS_NAME}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:r,runOnlyIf:()=>{var i;const n=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:SHORTCUTS_GROUP$6},{keys:[["Shift","Alt","ArrowDown"]],callback:r,runOnlyIf:()=>{var i;const n=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isCell()&&!this.menu.isOpened()},group:SHORTCUTS_GROUP$6}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$6)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>_assertClassBrand$D(_DropdownMenu_brand,this,_onTableClick).call(this,e))}open(e){var r;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.menu.open(),objectEach(i,(n,s)=>{this.menu.setOffset(s,n)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _addCustomShortcuts(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function _onTableClick(t){if(hasClass$1(t.target,BUTTON_CLASS_NAME)){const e=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),r=t.target.getBoundingClientRect();t.stopPropagation(),_classPrivateFieldSet$r(_isButtonClicked,this,!1),this.open({left:r.left+e.left,top:r.top+t.target.offsetHeight+e.top},{left:r.width,right:0,above:0,below:3})}}function _onAfterGetColHeader$2(t,e){const r=e.parentNode;if(!r)return;const i=r.parentNode.childNodes,n=Array.prototype.indexOf.call(i,r);if(t<0||n!==i.length-1)return;const s=e.querySelector(`.${BUTTON_CLASS_NAME}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=BUTTON_CLASS_NAME,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(setAttribute(o,[A11Y_HIDDEN(),A11Y_LABEL(" ")]),setAttribute(e,[A11Y_HASPOPUP("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function _onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}function _onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this),_assertClassBrand$D(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,this.menu)}function _onSubMenuAfterOpen(t){_assertClassBrand$D(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,t)}function _onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function _onBeforeViewportScrollHorizontally$1(t){return _classPrivateFieldGet$s(_isButtonClicked,this)?null:t}function _onBeforeOnCellMouseDown$4(t){hasClass$1(t.target,BUTTON_CLASS_NAME)&&_classPrivateFieldSet$r(_isButtonClicked,this,!0)}DropdownMenu.SEPARATOR={name:KEY$c};function _defineProperty$O(t,e,r){return(e=_toPropertyKey$O(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$O(t){var e=_toPrimitive$O(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$O(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DataProvider{constructor(e){_defineProperty$O(this,"hot",void 0),_defineProperty$O(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:i,endCol:n}=this._getDataRange(),s=this.options,o=[];return rangeEach(e,i,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(rangeEach(r,n,c=>{!s.exportHiddenColumns&&this._isHiddenColumn(c)||l.push(this.hot.getDataAtCell(a,c))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:r,endRow:i}=this._getDataRange(),n=this.hot.getRowHeader();rangeEach(r,i,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(n[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:r,endCol:i}=this._getDataRange(),n=this.hot.getColHeader();rangeEach(r,i,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(n[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,r=this.hot.countRows()-1;let[i=0,n=0,s=r,o=e]=this.options.range;return i=Math.max(i,0),n=Math.max(n,0),s=Math.min(s,r),o=Math.min(o,e),{startRow:i,startCol:n,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function _defineProperty$N(t,e,r){return(e=_toPropertyKey$N(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$N(t){var e=_toPrimitive$N(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$N(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BaseType{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,r){_defineProperty$N(this,"dataProvider",void 0),_defineProperty$N(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let r=clone(this.constructor.DEFAULT_OPTIONS);const i=new Date;return r=extend$1(clone(BaseType.DEFAULT_OPTIONS),r),r=extend$1(r,e),r.filename=substitute(r.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),r}}function _classPrivateMethodInitSpec$s(t,e){_checkPrivateRedeclaration$C(t,e),e.add(t)}function _checkPrivateRedeclaration$C(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _assertClassBrand$C(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const CHAR_CARRIAGE_RETURN="\r",CHAR_DOUBLE_QUOTES='"',CHAR_LINE_FEED=`
`,CHAR_EQUAL="=",CHAR_PLUS="+",CHAR_MINUS="-",CHAR_AT="@",CHAR_TAB="	";var _Csv_brand=new WeakSet;class Csv extends BaseType{constructor(){super(...arguments),_classPrivateMethodInitSpec$s(this,_Csv_brand)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,r=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const n=i.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return n&&(i=arrayMap(i,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),o&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),arrayEach(r,(l,c)=>{c>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[c],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const u=l.map(d=>this._escapeCell(d,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=u}),a}_escapeCell(e){let{force:r=!1,sanitizeValue:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=stringify$1(e);return n===""||(i&&(r=!0),i instanceof RegExp?n=_assertClassBrand$C(_Csv_brand,this,_sanitizeValueWithRegExp).call(this,n,i):typeof i=="function"?n=i(n):i&&(n=_assertClassBrand$C(_Csv_brand,this,_sanitizeValueWithOWASP).call(this,n)),(r||n.indexOf(CHAR_CARRIAGE_RETURN)>=0||n.indexOf(CHAR_DOUBLE_QUOTES)>=0||n.indexOf(CHAR_LINE_FEED)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`)),n}}function _sanitizeValueWithOWASP(t){return t.startsWith(CHAR_EQUAL)||t.startsWith(CHAR_PLUS)||t.startsWith(CHAR_MINUS)||t.startsWith(CHAR_AT)||t.startsWith(CHAR_TAB)||t.startsWith(CHAR_CARRIAGE_RETURN)?`'${t}`:t}function _sanitizeValueWithRegExp(t,e){return e.test(t)?`'${t}`:t}const TYPE_CSV="csv",EXPORT_TYPES={[TYPE_CSV]:Csv};function typeFactory(t,e,r){return typeof EXPORT_TYPES[t]=="function"?new EXPORT_TYPES[t](e,r):null}const PLUGIN_KEY$k="exportFile",PLUGIN_PRIORITY$k=240;class ExportFile extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$k}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$k}isEnabled(){return!0}exportAsString(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,r).export()}exportAsBlob(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,r))}downloadFile(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:n}=this.hot,s=this._createTypeFormatter(e,r),o=this._createBlob(s),a=n.URL||n.webkitURL,l=i.createElement("a"),c=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const u=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",u),l.setAttribute("download",c),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,c)}_createTypeFormatter(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!EXPORT_TYPES[e])throw new Error(`Export format type "${e}" is not supported.`);return typeFactory(e,new DataProvider(this.hot),r)}_createBlob(e){let r=null;return typeof Blob<"u"&&(r=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),r}}function _defineProperty$M(t,e,r){return(e=_toPropertyKey$M(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$M(t){var e=_toPrimitive$M(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$M(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BaseComponent{constructor(e,r){let{id:i,stateless:n=!0}=r;_defineProperty$M(this,"hot",void 0),_defineProperty$M(this,"id",void 0),_defineProperty$M(this,"elements",[]),_defineProperty$M(this,"hidden",!1),_defineProperty$M(this,"stateId",""),_defineProperty$M(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=n?null:this.hot.columnIndexMapper.registerMap(this.stateId,new LinkedPhysicalIndexToValueMap)}getElements(){return this.elements}reset(){arrayEach(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),arrayEach(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}mixin(BaseComponent,localHooks);const conditions={};function getCondition(t,e){if(!conditions[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:r,descriptor:i}=conditions[t];let n=e;return i.inputValuesDecorator&&(n=i.inputValuesDecorator(n)),function(s){return r.apply(s.meta.instance,[].concat([s],[n]))}}function getConditionDescriptor(t){if(!conditions[t])throw Error(`Filter condition "${t}" does not exist.`);return conditions[t].descriptor}function registerCondition(t,e,r){r.key=t,conditions[t]={condition:e,descriptor:r}}const CONDITION_NAME$k="none";function condition$k(){return!0}registerCondition(CONDITION_NAME$k,condition$k,{name:FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});const CONDITION_NAME$j="empty";function condition$j(t){return isEmpty(t.value)}registerCondition(CONDITION_NAME$j,condition$j,{name:FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});const CONDITION_NAME$i="not_empty";function condition$i(t,e){return!getCondition(CONDITION_NAME$j,e)(t)}registerCondition(CONDITION_NAME$i,condition$i,{name:FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});const CONDITION_NAME$h="eq";function condition$h(t,e){let[r]=e;return stringify$1(t.value).toLocaleLowerCase(t.meta.locale)===stringify$1(r)}registerCondition(CONDITION_NAME$h,condition$h,{name:FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$g="neq";function condition$g(t,e){return!getCondition(CONDITION_NAME$h,e)(t)}registerCondition(CONDITION_NAME$g,condition$g,{name:FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$f="gt";function condition$f(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}registerCondition(CONDITION_NAME$f,condition$f,{name:FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});const CONDITION_NAME$e="gte";function condition$e(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}registerCondition(CONDITION_NAME$e,condition$e,{name:FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$d="lt";function condition$d(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}registerCondition(CONDITION_NAME$d,condition$d,{name:FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});const CONDITION_NAME$c="lte";function condition$c(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}registerCondition(CONDITION_NAME$c,condition$c,{name:FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$b="date_after";function condition$b(t,e){let[r]=e;const i=hooks(t.value,t.meta.dateFormat),n=hooks(r,t.meta.dateFormat);return!i.isValid()||!n.isValid()?!1:i.diff(n)>=0}registerCondition(CONDITION_NAME$b,condition$b,{name:FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});const CONDITION_NAME$a="date_before";function condition$a(t,e){let[r]=e;const i=hooks(t.value,t.meta.dateFormat),n=hooks(r,t.meta.dateFormat);return!i.isValid()||!n.isValid()?!1:i.diff(n)<=0}registerCondition(CONDITION_NAME$a,condition$a,{name:FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});const CONDITION_NAME$9="between";function condition$9(t,e){let[r,i]=e,n=r,s=i;if(t.meta.type==="numeric"){const o=parseFloat(n,10),a=parseFloat(s,10);n=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=getCondition(CONDITION_NAME$a,[s]),a=getCondition(CONDITION_NAME$b,[n]);return o(t)&&a(t)}return t.value>=n&&t.value<=s}registerCondition(CONDITION_NAME$9,condition$9,{name:FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});const CONDITION_NAME$8="not_between";function condition$8(t,e){return!getCondition(CONDITION_NAME$9,e)(t)}registerCondition(CONDITION_NAME$8,condition$8,{name:FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});const CONDITION_NAME$7="begins_with";function condition$7(t,e){let[r]=e;return stringify$1(t.value).toLocaleLowerCase(t.meta.locale).startsWith(stringify$1(r))}registerCondition(CONDITION_NAME$7,condition$7,{name:FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});const CONDITION_NAME$6="ends_with";function condition$6(t,e){let[r]=e;return stringify$1(t.value).toLocaleLowerCase(t.meta.locale).endsWith(stringify$1(r))}registerCondition(CONDITION_NAME$6,condition$6,{name:FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});const CONDITION_NAME$5="contains";function condition$5(t,e){let[r]=e;return stringify$1(t.value).toLocaleLowerCase(t.meta.locale).indexOf(stringify$1(r))>=0}registerCondition(CONDITION_NAME$5,condition$5,{name:FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});const CONDITION_NAME$4="not_contains";function condition$4(t,e){return!getCondition(CONDITION_NAME$5,e)(t)}registerCondition(CONDITION_NAME$4,condition$4,{name:FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});const CONDITION_NAME$3="date_tomorrow";function condition$3(t){const e=hooks(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(hooks().subtract(-1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$3,condition$3,{name:FILTERS_CONDITIONS_TOMORROW,inputsCount:0});const CONDITION_NAME$2="date_today";function condition$2(t){const e=hooks(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(hooks().startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$2,condition$2,{name:FILTERS_CONDITIONS_TODAY,inputsCount:0});const CONDITION_NAME$1="date_yesterday";function condition$1(t){const e=hooks(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(hooks().subtract(1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$1,condition$1,{name:FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});getComparisonFunction();function toVisualValue(t,e){let r=t;return r===""&&(r=`(${e})`),r}function createArrayAssertion(t){const e=new Set(t);return function(r){return e.has(r)}}function toEmptyString(t){return t??""}function unifyColumnValues(t){return Array.from(new Set(t)).map(e=>toEmptyString(e)).sort((e,r)=>typeof e=="number"&&typeof r=="number"?e-r:e===r?0:e>r?1:-1)}function intersectValues(t,e,r,i){const n=[],s=t===e;let o;return s||(o=createArrayAssertion(e)),t.forEach(a=>{let l=!1;(s||o(a))&&(l=!0);const c={checked:l,value:a,visualValue:toVisualValue(a,r)};i&&i(c),n.push(c)}),n}const CONDITION_NAME="by_value";function condition(t,e){let[r]=e;return r(t.value)}registerCondition(CONDITION_NAME,condition,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[createArrayAssertion(e)]},showOperators:!1});const operations={};function getOperationFunc(t){if(!operations[t])throw Error(`Operation with id "${t}" does not exist.`);const e=operations[t].func;return function(r,i){return e(r,i)}}function getOperationName(t){return operations[t].name}function registerOperation(t,e,r){operations[t]={name:e,func:r}}const OPERATION_ID$2="conjunction",SHORT_NAME_FOR_COMPONENT$2=FILTERS_LABELS_CONJUNCTION;function operationResult$2(t,e){return t.every(r=>r.func(e))}registerOperation(OPERATION_ID$2,SHORT_NAME_FOR_COMPONENT$2,operationResult$2);const OPERATION_ID$1="disjunction",SHORT_NAME_FOR_COMPONENT$1=FILTERS_LABELS_DISJUNCTION;function operationResult$1(t,e){return t.some(r=>r.func(e))}registerOperation(OPERATION_ID$1,SHORT_NAME_FOR_COMPONENT$1,operationResult$1);const OPERATION_ID="disjunctionWithExtraCondition",SHORT_NAME_FOR_COMPONENT=FILTERS_LABELS_DISJUNCTION;function operationResult(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(r=>r.func(e))&&t[t.length-1].func(e)}registerOperation(OPERATION_ID,SHORT_NAME_FOR_COMPONENT,operationResult);const TYPE_NUMERIC="numeric",TYPE_TEXT="text",TYPE_DATE="date",TYPES={[TYPE_NUMERIC]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$f,CONDITION_NAME$e,CONDITION_NAME$d,CONDITION_NAME$c,CONDITION_NAME$9,CONDITION_NAME$8],[TYPE_TEXT]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$7,CONDITION_NAME$6,KEY$c,CONDITION_NAME$5,CONDITION_NAME$4],[TYPE_DATE]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$a,CONDITION_NAME$b,CONDITION_NAME$9,KEY$c,CONDITION_NAME$3,CONDITION_NAME$2,CONDITION_NAME$1]};function getOptionsList(t){const e=[];let r=t;return TYPES[r]||(r=TYPE_TEXT),arrayEach(TYPES[r],i=>{let n;i===KEY$c?n={name:KEY$c}:n=clone(getConditionDescriptor(i)),e.push(n)}),e}function _defineProperty$L(t,e,r){return(e=_toPropertyKey$L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$L(t){var e=_toPrimitive$L(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$L(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const STATE_BUILT$2="built",STATE_BUILDING="building",EVENTS_TO_REGISTER=["click","input","keydown","keypress","keyup","focus","blur","change"];let BaseUI$3=class rt{static get DEFAULTS(){return clone({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,r){_defineProperty$L(this,"hot",void 0),_defineProperty$L(this,"eventManager",new EventManager(this)),_defineProperty$L(this,"options",void 0),_defineProperty$L(this,"_element",void 0),_defineProperty$L(this,"buildState",void 0),this.hot=e,this.options=extend$1(rt.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===STATE_BUILDING?this._element:this.buildState===STATE_BUILT$2?(this.update(),this._element):(this.buildState=STATE_BUILDING,this.build(),this.buildState=STATE_BUILT$2,this._element)}isBuilt(){return this.buildState===STATE_BUILT$2}translateIfPossible(e){return typeof e=="string"&&e.startsWith(FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(e):e}build(){const e=(r,i)=>{this.eventManager.addEventListener(r,i,n=>this.runLocalHooks(i,n,this))};if(this.buildState||(this.buildState=STATE_BUILDING),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&addClass$1(this._element,this.options.className),this.options.children.length)arrayEach(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),objectEach(this.options,(i,n)=>{r[n]!==void 0&&n!=="className"&&n!=="tagName"&&n!=="children"&&(r[n]=this.translateIfPossible(i))}),this._element.appendChild(r),arrayEach(EVENTS_TO_REGISTER,i=>e(r,i))}else arrayEach(EVENTS_TO_REGISTER,r=>e(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mixin(BaseUI$3,localHooks);function _classPrivateMethodInitSpec$r(t,e){_checkPrivateRedeclaration$B(t,e),e.add(t)}function _classPrivateFieldInitSpec$r(t,e,r){_checkPrivateRedeclaration$B(t,e),e.set(t,r)}function _checkPrivateRedeclaration$B(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$r(t,e){return t.get(_assertClassBrand$B(t,e))}function _classPrivateFieldSet$q(t,e,r){return t.set(_assertClassBrand$B(t,e),r),r}function _assertClassBrand$B(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _input$1=new WeakMap,_InputUI_brand=new WeakSet;class InputUI extends BaseUI$3{static get DEFAULTS(){return clone({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,r){super(e,extend$1(InputUI.DEFAULTS,r)),_classPrivateMethodInitSpec$r(this,_InputUI_brand),_classPrivateFieldInitSpec$r(this,_input$1,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>_assertClassBrand$B(_InputUI_brand,this,_onKeyup).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");_classPrivateFieldSet$q(_input$1,this,this._element.firstChild),addClass$1(this._element,"htUIInput"),addClass$1(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet$r(_input$1,this).type=this.options.type,_classPrivateFieldGet$r(_input$1,this).placeholder=this.translateIfPossible(this.options.placeholder),_classPrivateFieldGet$r(_input$1,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&_classPrivateFieldGet$r(_input$1,this).focus()}}function _onKeyup(t){this.options.value=t.target.value}function _classPrivateMethodInitSpec$q(t,e){_checkPrivateRedeclaration$A(t,e),e.add(t)}function _classPrivateFieldInitSpec$q(t,e,r){_checkPrivateRedeclaration$A(t,e),e.set(t,r)}function _checkPrivateRedeclaration$A(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$p(t,e,r){return t.set(_assertClassBrand$A(t,e),r),r}function _classPrivateFieldGet$q(t,e){return t.get(_assertClassBrand$A(t,e))}function _assertClassBrand$A(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _menu=new WeakMap,_items$1=new WeakMap,_caption=new WeakMap,_captionElement=new WeakMap,_dropdown=new WeakMap,_SelectUI_brand=new WeakSet;class SelectUI extends BaseUI$3{static get DEFAULTS(){return clone({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,r){super(e,extend$1(SelectUI.DEFAULTS,r)),_classPrivateMethodInitSpec$q(this,_SelectUI_brand),_classPrivateFieldInitSpec$q(this,_menu,null),_classPrivateFieldInitSpec$q(this,_items$1,[]),_classPrivateFieldInitSpec$q(this,_caption,void 0),_classPrivateFieldInitSpec$q(this,_captionElement,void 0),_classPrivateFieldInitSpec$q(this,_dropdown,void 0),this.registerHooks()}getMenu(){return _classPrivateFieldGet$q(_menu,this)}registerHooks(){this.addLocalHook("click",()=>_assertClassBrand$A(_SelectUI_brand,this,_onClick).call(this))}setItems(e){_classPrivateFieldSet$p(_items$1,this,this.translateNames(e)),_classPrivateFieldGet$q(_menu,this)&&_classPrivateFieldGet$q(_menu,this).setMenuItems(_classPrivateFieldGet$q(_items$1,this))}translateNames(e){return arrayEach(e,r=>{r.name=this.translateIfPossible(r.name)}),e}build(){super.build(),_classPrivateFieldSet$p(_menu,this,new Menu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),_classPrivateFieldGet$q(_menu,this).setMenuItems(_classPrivateFieldGet$q(_items$1,this));const e=new BaseUI$3(this.hot,{className:"htUISelectCaption"}),r=new BaseUI$3(this.hot,{className:"htUISelectDropdown"});_classPrivateFieldSet$p(_caption,this,e),_classPrivateFieldSet$p(_captionElement,this,e.element),_classPrivateFieldSet$p(_dropdown,this,r),this.hot.getSettings().ariaTags&&(setAttribute(r.element,[A11Y_HIDDEN()]),setAttribute(this._element,[A11Y_LISTBOX()])),arrayEach([e,r],i=>this._element.appendChild(i.element)),_classPrivateFieldGet$q(_menu,this).addLocalHook("select",i=>_assertClassBrand$A(_SelectUI_brand,this,_onMenuSelect).call(this,i)),_classPrivateFieldGet$q(_menu,this).addLocalHook("afterClose",()=>_assertClassBrand$A(_SelectUI_brand,this,_onMenuClosed).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=_classPrivateFieldGet$q(_menu,this).hot.getTranslatedPhrase(FILTERS_CONDITIONS_NONE),_classPrivateFieldGet$q(_captionElement,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();_classPrivateFieldGet$q(_menu,this)&&(_classPrivateFieldGet$q(_menu,this).open(),_classPrivateFieldGet$q(_menu,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),_classPrivateFieldGet$q(_menu,this).getNavigator().toFirstItem(),_classPrivateFieldGet$q(_menu,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){_classPrivateFieldGet$q(_menu,this)&&_classPrivateFieldGet$q(_menu,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){_classPrivateFieldGet$q(_menu,this)&&(_classPrivateFieldGet$q(_menu,this).destroy(),_classPrivateFieldSet$p(_menu,this,null)),_classPrivateFieldGet$q(_caption,this)&&_classPrivateFieldGet$q(_caption,this).destroy(),_classPrivateFieldGet$q(_dropdown,this)&&_classPrivateFieldGet$q(_dropdown,this).destroy(),super.destroy()}}function _onMenuSelect(t){t.name!==KEY$c&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function _onMenuClosed(){this.runLocalHooks("afterClose")}function _onClick(){this.openOptions()}function _classPrivateMethodInitSpec$p(t,e){_checkPrivateRedeclaration$z(t,e),e.add(t)}function _checkPrivateRedeclaration$z(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$K(t,e,r){return(e=_toPropertyKey$K(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$K(t){var e=_toPrimitive$K(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$K(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$z(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _ConditionComponent_brand=new WeakSet;class ConditionComponent extends BaseComponent{constructor(e,r){super(e,{id:r.id,stateless:!1}),_classPrivateMethodInitSpec$p(this,_ConditionComponent_brand),_defineProperty$K(this,"name",""),_defineProperty$K(this,"addSeparator",!1),this.name=r.name,this.addSeparator=r.addSeparator,this.elements.push(new SelectUI(this.hot,{menuContainer:r.menuContainer})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>_assertClassBrand$z(_ConditionComponent_brand,this,_onConditionSelect).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),arrayEach(this.getInputElements(),e=>{e.addLocalHook("keydown",r=>_assertClassBrand$z(_ConditionComponent_brand,this,_onInputKeyDown$2).call(this,r))})}setState(e){if(this.reset(),!e)return;const r=clone(e.command);r.name.startsWith(FILTERS_CONDITIONS_NAMESPACE)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),arrayEach(e.args,(i,n)=>{if(n>r.inputsCount-1)return!1;const s=this.getInputElement(n);s.setValue(i),s[r.inputsCount>n?"show":"hide"](),n||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||getConditionDescriptor(CONDITION_NAME$k),r=[];return arrayEach(this.getInputElements(),(i,n)=>{e.inputsCount>n&&r.push(i.getValue())}),{command:e,args:r}}updateState(e,r){const i=getConditionDescriptor(e?e.name:CONDITION_NAME$k);this.state.setValueAtIndex(r,{command:i,args:e?e.args:[]}),e||arrayEach(this.getInputElements(),n=>n.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof SelectUI)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof InputUI)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,i,n,s,o)=>{addClass$1(r.parentNode,"htFiltersMenuCondition"),this.addSeparator&&addClass$1(r.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return addClass$1(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||arrayEach(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let r=[getConditionDescriptor(CONDITION_NAME$k)];if(e!==null){const{visualIndex:i}=e;r=getOptionsList(this.hot.getDataType(0,i,this.hot.countRows(),i))}arrayEach(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(r),super.reset(),this.getSelectElement().setValue(r[0])}}function _onConditionSelect(t){arrayEach(this.getInputElements(),(e,r)=>{e[t.inputsCount>r?"show":"hide"](),r===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function _onInputKeyDown$2(t){isKey(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(t))}function _classPrivateFieldInitSpec$p(t,e,r){_checkPrivateRedeclaration$y(t,e),e.set(t,r)}function _checkPrivateRedeclaration$y(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$p(t,e){return t.get(_assertClassBrand$y(t,e))}function _classPrivateFieldSet$o(t,e,r){return t.set(_assertClassBrand$y(t,e),r),r}function _assertClassBrand$y(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _input=new WeakMap,_label=new WeakMap;class RadioInputUI extends BaseUI$3{static get DEFAULTS(){return clone({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,r){super(e,extend$1(RadioInputUI.DEFAULTS,r)),_classPrivateFieldInitSpec$p(this,_input,void 0),_classPrivateFieldInitSpec$p(this,_label,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),_classPrivateFieldSet$o(_label,this,e),_classPrivateFieldSet$o(_input,this,this._element.firstChild),_classPrivateFieldGet$p(_input,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet$p(_label,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?_classPrivateFieldGet$p(_input,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(_classPrivateFieldGet$p(_input,this).checked=e)}focus(){this.isBuilt()&&_classPrivateFieldGet$p(_input,this).focus()}}function _classPrivateMethodInitSpec$o(t,e){_checkPrivateRedeclaration$x(t,e),e.add(t)}function _checkPrivateRedeclaration$x(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$J(t,e,r){return(e=_toPropertyKey$J(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$J(t){var e=_toPrimitive$J(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$J(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$x(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const SELECTED_AT_START_ELEMENT_INDEX=0;var _OperatorsComponent_brand=new WeakSet;class OperatorsComponent extends BaseComponent{constructor(e,r){super(e,{id:r.id,stateless:!1}),_classPrivateMethodInitSpec$o(this,_OperatorsComponent_brand),_defineProperty$J(this,"name",""),this.name=r.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(addClass$1(r.parentNode,"htFiltersMenuOperators"),arrayEach(this.elements,i=>r.appendChild(i.element)),r)}}buildOperatorsElement(){const e=[OPERATION_ID$2,OPERATION_ID$1];arrayEach(e,r=>{const i=new RadioInputUI(this.hot,{name:"operator",label:{htmlFor:r,textContent:getOperationName(r)},value:r,checked:r===e[SELECTED_AT_START_ELEMENT_INDEX],id:r});i.addLocalHook("change",n=>_assertClassBrand$x(_OperatorsComponent_brand,this,_onRadioInputChange).call(this,n)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(toSingleLine`Radio button with index ${e} doesn't exist.`);arrayEach(this.elements,(r,i)=>{r.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(r=>r instanceof RadioInputUI&&r.isChecked());return e?e.getValue():OPERATION_ID$2}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&arrayEach(this.elements,r=>{r.setChecked(r.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:OPERATION_ID$2,r=arguments.length>1?arguments[1]:void 0,i=e;i===OPERATION_ID&&(i=OPERATION_ID$1),this.state.setValueAtIndex(r,i)}reset(){this.setChecked(SELECTED_AT_START_ELEMENT_INDEX)}}function _onRadioInputChange(t){this.setState(t.target.value)}function _classPrivateFieldInitSpec$o(t,e,r){_checkPrivateRedeclaration$w(t,e),e.set(t,r)}function _checkPrivateRedeclaration$w(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$o(t,e){return t.get(_assertClassBrand$w(t,e))}function _classPrivateFieldSet$n(t,e,r){return t.set(_assertClassBrand$w(t,e),r),r}function _assertClassBrand$w(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _link=new WeakMap;class LinkUI extends BaseUI$3{static get DEFAULTS(){return clone({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,r){super(e,extend$1(LinkUI.DEFAULTS,r)),_classPrivateFieldInitSpec$o(this,_link,void 0)}build(){super.build(),_classPrivateFieldSet$n(_link,this,this._element.firstChild)}update(){this.isBuilt()&&(_classPrivateFieldGet$o(_link,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&_classPrivateFieldGet$o(_link,this).focus()}activate(){_classPrivateFieldGet$o(_link,this).click()}}function _classPrivateMethodInitSpec$n(t,e){_checkPrivateRedeclaration$v(t,e),e.add(t)}function _classPrivateFieldInitSpec$n(t,e,r){_checkPrivateRedeclaration$v(t,e),e.set(t,r)}function _checkPrivateRedeclaration$v(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$n(t,e){return t.get(_assertClassBrand$v(t,e))}function _classPrivateFieldSet$m(t,e,r){return t.set(_assertClassBrand$v(t,e),r),r}function _assertClassBrand$v(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const SHORTCUTS_GROUP$5="multipleSelect.itemBox";var _items=new WeakMap,_itemsBox=new WeakMap,_locale=new WeakMap,_searchInput=new WeakMap,_selectAllUI=new WeakMap,_clearAllUI=new WeakMap,_MultipleSelectUI_brand=new WeakSet;class MultipleSelectUI extends BaseUI$3{static get DEFAULTS(){return clone({className:"htUIMultipleSelect",value:[]})}constructor(e,r){super(e,extend$1(MultipleSelectUI.DEFAULTS,r)),_classPrivateMethodInitSpec$n(this,_MultipleSelectUI_brand),_classPrivateFieldInitSpec$n(this,_items,[]),_classPrivateFieldInitSpec$n(this,_itemsBox,void 0),_classPrivateFieldInitSpec$n(this,_locale,void 0),_classPrivateFieldInitSpec$n(this,_searchInput,void 0),_classPrivateFieldInitSpec$n(this,_selectAllUI,void 0),_classPrivateFieldInitSpec$n(this,_clearAllUI,void 0),_classPrivateFieldSet$m(_searchInput,this,new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),_classPrivateFieldSet$m(_selectAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),_classPrivateFieldSet$m(_clearAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return _classPrivateFieldGet$n(_itemsBox,this)}registerHooks(){_classPrivateFieldGet$n(_searchInput,this).addLocalHook("keydown",e=>_assertClassBrand$v(_MultipleSelectUI_brand,this,_onInputKeyDown$1).call(this,e)),_classPrivateFieldGet$n(_searchInput,this).addLocalHook("input",e=>_assertClassBrand$v(_MultipleSelectUI_brand,this,_onInput).call(this,e)),_classPrivateFieldGet$n(_selectAllUI,this).addLocalHook("click",e=>_assertClassBrand$v(_MultipleSelectUI_brand,this,_onSelectAllClick).call(this,e)),_classPrivateFieldGet$n(_clearAllUI,this).addLocalHook("click",e=>_assertClassBrand$v(_MultipleSelectUI_brand,this,_onClearAllClick).call(this,e))}setItems(e){var r;_classPrivateFieldSet$m(_items,this,e),(r=_classPrivateFieldGet$n(_itemsBox,this))===null||r===void 0||r.loadData(_classPrivateFieldGet$n(_items,this))}setLocale(e){_classPrivateFieldSet$m(_locale,this,e)}getLocale(){return _classPrivateFieldGet$n(_locale,this)}getItems(){return[..._classPrivateFieldGet$n(_items,this)]}getValue(){return itemsToValue(_classPrivateFieldGet$n(_items,this))}getSearchInputElement(){return _classPrivateFieldGet$n(_searchInput,this)}getSelectAllElement(){return _classPrivateFieldGet$n(_selectAllUI,this)}getClearAllElement(){return _classPrivateFieldGet$n(_clearAllUI,this)}isSelectedAllValues(){return _classPrivateFieldGet$n(_items,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,r=e.createElement("div"),i=new BaseUI$3(this.hot,{className:"htUISelectionControls",children:[_classPrivateFieldGet$n(_selectAllUI,this),_classPrivateFieldGet$n(_clearAllUI,this)]});this._element.appendChild(_classPrivateFieldGet$n(_searchInput,this).element),this._element.appendChild(i.element),this._element.appendChild(r);const n=s=>{var o;if(!this._element)return;(o=_classPrivateFieldGet$n(_itemsBox,this))===null||o===void 0||o.destroy(),addClass$1(s,"htUIMultipleSelectHot"),_classPrivateFieldSet$m(_itemsBox,this,new this.hot.constructor(s,{data:_classPrivateFieldGet$n(_items,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(c,u,d,h,f,g)=>{c.title=g.instance.getDataAtRowProp(u,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{_classPrivateFieldGet$n(_itemsBox,this).listen()},modifyColWidth:c=>{const u=_classPrivateFieldGet$n(_itemsBox,this).container.scrollWidth-getScrollbarWidth(e);return c!==void 0&&c<u?u:c},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),_classPrivateFieldGet$n(_itemsBox,this).init();const l=_classPrivateFieldGet$n(_itemsBox,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:c=>{this.runLocalHooks("keydown",c,this)},group:SHORTCUTS_GROUP$5}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:c=>{_classPrivateFieldGet$n(_itemsBox,this).deselectCell(),this.runLocalHooks("keydown",c,this),this.runLocalHooks("listTabKeydown",c,this)},group:SHORTCUTS_GROUP$5})};n(r),this.hot._registerTimeout(()=>n(r),100)}focus(){this.isBuilt()&&_classPrivateFieldGet$n(_itemsBox,this).listen()}reset(){_classPrivateFieldGet$n(_searchInput,this).reset(),_classPrivateFieldGet$n(_selectAllUI,this).reset(),_classPrivateFieldGet$n(_clearAllUI,this).reset()}update(){this.isBuilt()&&(_classPrivateFieldGet$n(_itemsBox,this).loadData(valueToItems(_classPrivateFieldGet$n(_items,this),this.options.value)),super.update())}destroy(){var e;(e=_classPrivateFieldGet$n(_itemsBox,this))===null||e===void 0||e.destroy(),_classPrivateFieldGet$n(_searchInput,this).destroy(),_classPrivateFieldGet$n(_clearAllUI,this).destroy(),_classPrivateFieldGet$n(_selectAllUI,this).destroy(),_classPrivateFieldSet$m(_searchInput,this,null),_classPrivateFieldSet$m(_clearAllUI,this,null),_classPrivateFieldSet$m(_selectAllUI,this,null),_classPrivateFieldSet$m(_itemsBox,this,null),_classPrivateFieldSet$m(_items,this,null),super.destroy()}}function _onInput(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let r;e===""?r=[..._classPrivateFieldGet$n(_items,this)]:r=_classPrivateFieldGet$n(_items,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),_classPrivateFieldGet$n(_itemsBox,this).loadData(r)}function _onInputKeyDown$1(t){this.runLocalHooks("keydown",t,this),partial(isKey,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),stopImmediatePropagation(t),_classPrivateFieldGet$n(_itemsBox,this).listen(),_classPrivateFieldGet$n(_itemsBox,this).selectCell(0,0))}function _onSelectAllClick(t){const e=[];t.preventDefault(),_classPrivateFieldGet$n(_itemsBox,this).getSourceData().forEach((r,i)=>{r.checked=!0,e.push(dataRowToChangesArray(r,i)[0])}),_classPrivateFieldGet$n(_itemsBox,this).setSourceDataAtCell(e)}function _onClearAllClick(t){const e=[];t.preventDefault(),_classPrivateFieldGet$n(_itemsBox,this).getSourceData().forEach((r,i)=>{r.checked=!1,e.push(dataRowToChangesArray(r,i)[0])}),_classPrivateFieldGet$n(_itemsBox,this).setSourceDataAtCell(e)}function valueToItems(t,e){const r=createArrayAssertion(e);return t.map(i=>(i.checked=r(i.value),i))}function itemsToValue(t){const e=[];return t.forEach(r=>{r.checked&&e.push(r.value)}),e}function _classPrivateMethodInitSpec$m(t,e){_checkPrivateRedeclaration$u(t,e),e.add(t)}function _checkPrivateRedeclaration$u(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$I(t,e,r){return(e=_toPropertyKey$I(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$I(t){var e=_toPrimitive$I(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$I(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$u(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _ValueComponent_brand=new WeakSet;class ValueComponent extends BaseComponent{constructor(e,r){super(e,{id:r.id,stateless:!1}),_classPrivateMethodInitSpec$m(this,_ValueComponent_brand),_defineProperty$I(this,"name",""),this.name=r.name,this.elements.push(new MultipleSelectUI(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>_assertClassBrand$u(_ValueComponent_brand,this,_onInputKeyDown).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,r)=>_assertClassBrand$u(_ValueComponent_brand,this,_onModifyDisplayedValue).call(this,e,r))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===CONDITION_NAME){const r=this.getMultipleSelectElement();r.setItems(e.itemsSnapshot),r.setValue(e.args[0]),r.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),r=e.getItems();return{command:{key:e.isSelectedAllValues()||!r.length?CONDITION_NAME$k:CONDITION_NAME},args:[e.getValue()],itemsSnapshot:r}}updateState(e){const r=(i,n,s,o,a)=>{const[l]=arrayFilter(n,d=>d.name===CONDITION_NAME),c={},u=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS);if(l){const d=o(i,a),h=arrayMap(d,v=>v.value),f=new Map(d.map(v=>[v.value,this.hot.getCellMeta(v.meta.visualRow,v.meta.visualCol)])),g=unifyColumnValues(h);s&&(l.args[0]=s);const m=[],C=intersectValues(g,l.args[0],u,v=>{v.checked&&m.push(v.value),_assertClassBrand$u(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,v,f)}),y=e.editedConditionStack.column;c.locale=this.hot.getCellMeta(0,y).locale,c.args=[m],c.command=getConditionDescriptor(CONDITION_NAME),c.itemsSnapshot=C}else c.args=[],c.command=getConditionDescriptor(CONDITION_NAME$k);this.state.setValueAtIndex(i,c)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof MultipleSelectUI)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,i,n,s,o)=>{addClass$1(r.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return addClass$1(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||arrayEach(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS),r=this._getColumnVisibleValues(),i=r.map(l=>l.value),n=new Map(r.map(l=>[l.value,l.meta])),s=unifyColumnValues(i),o=intersectValues(s,s,e,l=>{_assertClassBrand$u(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,l,n)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:arrayMap(this.hot.getDataAtCol(e.visualIndex),(r,i)=>({value:toEmptyString(r),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function _onInputKeyDown(t){isKey(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(t))}function _triggerModifyMultipleSelectionValueHook(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function _onModifyDisplayedValue(t,e){switch(e.type){case"numeric":return getRenderedValue(t,e);default:return t}}var _ActionBarComponent;function _classPrivateMethodInitSpec$l(t,e){_checkPrivateRedeclaration$t(t,e),e.add(t)}function _checkPrivateRedeclaration$t(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$H(t,e,r){return(e=_toPropertyKey$H(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$H(t){var e=_toPrimitive$H(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$H(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$t(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _ActionBarComponent_brand=new WeakSet;class ActionBarComponent extends BaseComponent{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,r){super(e,{id:r.id,stateless:!0}),_classPrivateMethodInitSpec$l(this,_ActionBarComponent_brand),_defineProperty$H(this,"name",""),this.name=r.name,this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:ActionBarComponent.BUTTON_OK})),this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:ActionBarComponent.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){arrayEach(this.elements,e=>{e.addLocalHook("click",(r,i)=>_assertClassBrand$t(_ActionBarComponent_brand,this,_onButtonClick).call(this,r,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(addClass$1(r.parentNode,"htFiltersMenuActionBar"),arrayEach(this.elements,i=>r.appendChild(i.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}_ActionBarComponent=ActionBarComponent;function _onButtonClick(t,e){e.options.identifier===_ActionBarComponent.BUTTON_OK?this.accept():this.cancel()}function _defineProperty$G(t,e,r){return(e=_toPropertyKey$G(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$G(t){var e=_toPrimitive$G(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$G(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const MAP_NAME="ConditionCollection.filteringStates";class ConditionCollection{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;_defineProperty$G(this,"hot",void 0),_defineProperty$G(this,"isMapRegistrable",void 0),_defineProperty$G(this,"filteringStates",new LinkedPhysicalIndexToValueMap),this.hot=e,this.isMapRegistrable=r,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(MAP_NAME,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,r){var i;const n=this.filteringStates.getValueAtIndex(r),s=(i=n?.conditions)!==null&&i!==void 0?i:[],o=n?.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2;return e.length?getOperationFunc(i)(e,r):!0}addCondition(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2,n=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=r.args.map(u=>typeof u=="string"?u.toLocaleLowerCase(s):u),a=r.name||r.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==i)throw Error(toSingleLine`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(isUndefined(operations[i]))throw new Error(toSingleLine`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const c=this.getConditions(e);c.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:o,func:getCondition(a,o)}]},n):c.push({name:a,args:o,func:getCondition(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var r,i;return(r=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&r!==void 0?r:[]}getOperation(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[r]=e;return r})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,r)=>{let[i,{operation:n,conditions:s}]=r;return e.push({column:i,operation:n,conditions:s.map(o=>{let{name:a,args:l}=o;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(r=>{r.conditions.forEach(i=>this.addCondition(r.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,r){const i=this.getConditions(e);return r?i.some(n=>n.name===r):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(MAP_NAME),this.filteringStates=null,this.clearLocalHooks()}}mixin(ConditionCollection,localHooks);function _defineProperty$F(t,e,r){return(e=_toPropertyKey$F(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$F(t){var e=_toPrimitive$F(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$F(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DataFilter{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];_defineProperty$F(this,"conditionCollection",void 0),_defineProperty$F(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=r}filter(){let e=[];return arrayEach(this.conditionCollection.getFilteredColumns(),(r,i)=>{let n=this.columnDataFactory(r);i&&(n=this._getIntersectData(n,e)),e=this.filterByColumn(r,n)}),e}filterByColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return arrayEach(r,n=>{n!==void 0&&this.conditionCollection.isMatch(n,e)&&i.push(n)}),i}_getIntersectData(e,r){const i=[];return arrayEach(r,n=>{const s=n.meta.visualRow;e[s]!==void 0&&(i[s]=e[s])}),i}}function _classPrivateMethodInitSpec$k(t,e){_checkPrivateRedeclaration$s(t,e),e.add(t)}function _checkPrivateRedeclaration$s(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$E(t,e,r){return(e=_toPropertyKey$E(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$E(t){var e=_toPrimitive$E(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$E(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$s(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _ConditionUpdateObserver_brand=new WeakSet;class ConditionUpdateObserver{constructor(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];_classPrivateMethodInitSpec$k(this,_ConditionUpdateObserver_brand),_defineProperty$E(this,"hot",void 0),_defineProperty$E(this,"conditionCollection",void 0),_defineProperty$E(this,"columnDataFactory",void 0),_defineProperty$E(this,"changes",[]),_defineProperty$E(this,"grouping",!1),_defineProperty$E(this,"latestEditedColumnPosition",-1),_defineProperty$E(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=r,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",n=>_assertClassBrand$s(_ConditionUpdateObserver_brand,this,_onConditionBeforeModify).call(this,n)),this.conditionCollection.addLocalHook("afterRemove",n=>this.updateStatesAtColumn(n)),this.conditionCollection.addLocalHook("afterAdd",n=>this.updateStatesAtColumn(n)),this.conditionCollection.addLocalHook("beforeClean",()=>_assertClassBrand$s(_ConditionUpdateObserver_brand,this,_onConditionBeforeClean).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>_assertClassBrand$s(_ConditionUpdateObserver_brand,this,_onConditionAfterClean).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,arrayEach(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,r){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const n=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=n.slice(0,s),a=n.slice(s);a.length&&a[0].column===e&&a.shift();const l=curry(function(u,d){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new ConditionCollection(i.hot,!1),g=[].concat(u,h);f.importAllConditions(g);const m=i.columnDataFactory(d);let C;f.isEmpty()?C=m:C=new DataFilter(f,v=>i.columnDataFactory(v)).filter(),C=arrayMap(C,v=>v.meta.visualRow);const y=createArrayAssertion(C);return f.destroy(),arrayFilter(m,v=>y(v.meta.visualRow))})(o),c=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:c},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:r})}destroy(){this.clearLocalHooks(),objectEach(this,(e,r)=>{this[r]=null})}}function _onConditionBeforeModify(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function _onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function _onConditionAfterClean(){arrayEach(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}mixin(ConditionUpdateObserver,localHooks);function createFocusNavigator(t){return createPaginator({initialPage:0,size:()=>t.length,onItemSelect:(r,i)=>{const n=t[r];if(n instanceof MultipleSelectUI)return i;if(n.element&&!isVisible(n.element))return!1;n.focus()}})}const SHORTCUTS_MENU_CONTEXT="filters";function createMenuFocusController(t,e){let r=-1,i;const n=createFocusNavigator(e),s=d=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT),n.setCurrentPage(e.indexOf(d))};e.forEach(d=>{d instanceof BaseUI$3&&(d.addLocalHook("click",s(d)),d.addLocalHook("focus",s(d)),d.addLocalHook("afterClose",s(d)))}),l(t);function o(d){const h=i.getKeyboardShortcutsCtrl(),f=d.getKeyboardShortcutsCtrl();n.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:h.getContext(SHORTCUTS_MENU_CONTEXT),callback:()=>{d.isSubMenu()&&d.close(),h.listen(SHORTCUTS_MENU_CONTEXT)}}]),!d.isSubMenu()&&h.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const m=i.getNavigator();m.getCurrentPage()>-1&&(r=m.getCurrentPage()),m.clear(),g.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const m=e[n.getCurrentPage()];m instanceof SelectUI&&(m.openOptions(),g.preventDefault()),m instanceof LinkUI&&(m.activate(),g.preventDefault()),m instanceof BaseUI$3||g.preventDefault()}}],SHORTCUTS_MENU_CONTEXT)}function a(){i.focus(),i.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT)}function l(d){d.addLocalHook("afterSelectionChange",h=>{h.key.startsWith("filter_")||n.clear()}),d.addLocalHook("afterSubmenuOpen",o),d.addLocalHook("afterOpen",o),i=d}function c(){return i}function u(){return r}return{...n,listen:a,setMenu:l,getMenu:c,getLastMenuPage:u}}function _classPrivateMethodInitSpec$j(t,e){_checkPrivateRedeclaration$r(t,e),e.add(t)}function _classPrivateFieldInitSpec$m(t,e,r){_checkPrivateRedeclaration$r(t,e),e.set(t,r)}function _checkPrivateRedeclaration$r(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$D(t,e,r){return(e=_toPropertyKey$D(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$D(t){var e=_toPrimitive$D(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$D(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldSet$l(t,e,r){return t.set(_assertClassBrand$r(t,e),r),r}function _classPrivateFieldGet$m(t,e){return t.get(_assertClassBrand$r(t,e))}function _assertClassBrand$r(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$j="filters",PLUGIN_PRIORITY$j=250,SHORTCUTS_GROUP$4=PLUGIN_KEY$j;var _menuFocusNavigator=new WeakMap,_dropdownMenuTraces=new WeakMap,_previousConditionStack=new WeakMap,_Filters_brand=new WeakSet;class Filters extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$j}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$j}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var r;super(e),r=this,_classPrivateMethodInitSpec$j(this,_Filters_brand),_defineProperty$D(this,"dropdownMenuPlugin",null),_defineProperty$D(this,"conditionCollection",null),_defineProperty$D(this,"conditionUpdateObserver",null),_defineProperty$D(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),_defineProperty$D(this,"filtersRowsMap",null),_classPrivateFieldInitSpec$m(this,_menuFocusNavigator,void 0),_classPrivateFieldInitSpec$m(this,_dropdownMenuTraces,new WeakSet),_classPrivateFieldInitSpec$m(this,_previousConditionStack,[]),this.hot.addHook("afterGetColHeader",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$r(_Filters_brand,r,_onAfterGetColHeader$1).call(r,...n)})}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$j]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new TrimmingMap),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const r=this.hot.getSettings().dropdownMenu,i=r&&r.uiContainer||this.hot.rootPortalElement,n=a=>(a.addLocalHook("accept",()=>_assertClassBrand$r(_Filters_brand,this,_onActionBarSubmit).call(this,"accept")),a.addLocalHook("cancel",()=>_assertClassBrand$r(_Filters_brand,this,_onActionBarSubmit).call(this,"cancel")),a.addLocalHook("change",l=>_assertClassBrand$r(_Filters_brand,this,_onComponentChange).call(this,a,l)),a),s=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_CONDITION)}:`,o=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_VALUE)}:`;if(!this.components.get("filter_by_condition")){const a=new ConditionComponent(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:i});a.addLocalHook("afterClose",()=>_assertClassBrand$r(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition",n(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new OperatorsComponent(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new ConditionComponent(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});a.addLocalHook("afterClose",()=>_assertClassBrand$r(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition2",n(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new ValueComponent(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new ActionBarComponent(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new ConditionCollection(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ConditionUpdateObserver(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>_assertClassBrand$r(_Filters_brand,this,_updateComponents).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return _assertClassBrand$r(_Filters_brand,e,_onAfterDropdownMenuDefaultOptions).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>_assertClassBrand$r(_Filters_brand,this,_onBeforeDropdownMenuShow).call(this)),this.addHook("afterDropdownMenuShow",()=>_assertClassBrand$r(_Filters_brand,this,_onAfterDropdownMenuShow).call(this)),this.addHook("afterDropdownMenuHide",()=>_assertClassBrand$r(_Filters_brand,this,_onAfterDropdownMenuHide).call(this)),this.addHook("afterChange",a=>_assertClassBrand$r(_Filters_brand,this,_onAfterChange$2).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!_classPrivateFieldGet$m(_menuFocusNavigator,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const c=_classPrivateFieldGet$m(_menuFocusNavigator,this).getMenu(),u=c.getNavigator(),d=_classPrivateFieldGet$m(_menuFocusNavigator,this).getLastMenuPage();c.focus(),d>0?u.setCurrentPage(d):u.toFirstItem()}},...Array.from(this.components).map(c=>{let[,u]=c;return u.getElements()}).flat()];_classPrivateFieldSet$l(_menuFocusNavigator,this,createMenuFocusController(this.dropdownMenuPlugin.menu,a));const l=c=>{_classPrivateFieldGet$m(_menuFocusNavigator,this).listen(),c.preventDefault(),isKey(c.keyCode,"TAB")&&(c.shiftKey?_classPrivateFieldGet$m(_menuFocusNavigator,this).toPreviousItem():_classPrivateFieldGet$m(_menuFocusNavigator,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,i)=>{r.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:SHORTCUTS_GROUP$4})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$4)}addCondition(e,r,i){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:OPERATION_ID$2;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:r},args:i},n)}removeConditions(e){const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),r=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let n=[];const s=this.exportConditions(),o=this.hot.runHooks("beforeFilter",s,_classPrivateFieldGet$m(_previousConditionStack,this));if(o!==!1&&i){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),n=arrayMap(r.filter(),c=>c.meta.visualRow);const l=createArrayAssertion(n);rangeEach(this.hot.countSourceRows()-1,c=>{l(c)||a.push(c)}),arrayEach(a,c=>{this.filtersRowsMap.setValueAtIndex(c,!0)})},!0),!e&&!n.length&&this.hot.deselectCell(),_classPrivateFieldSet$l(_previousConditionStack,this,this.exportConditions())}else o!==!1&&!i?(_classPrivateFieldSet$l(_previousConditionStack,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(_classPrivateFieldGet$m(_previousConditionStack,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),o!==!1&&(this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r?{visualIndex:r.col,physicalIndex:this.hot.toPhysicalColumn(r.col)}:null}getDataMapAtColumn(e){const r=this.hot.toVisualColumn(e),i=[];return arrayEach(this.hot.getSourceDataAtCol(r),(n,s)=>{var o;const{row:a,col:l,visualCol:c,visualRow:u,type:d,instance:h,dateFormat:f,locale:g}=this.hot.getCellMeta(s,r),m=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),r))!==null&&o!==void 0?o:n;i.push({meta:{row:a,col:l,visualCol:c,visualRow:u,type:d,instance:h,dateFormat:f,locale:g},value:toEmptyString(m)})}),i}updateValueComponentCondition(e){const r=this.hot.getDataAtCol(e),i=unifyColumnValues(r);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var r;const i=(r=this.getSelectedColumn())===null||r===void 0?void 0:r.physicalIndex;e.forEach(n=>{n.isHidden()||n.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,r,i,n){let s=e;return s===OPERATION_ID$1&&r.command.key!==CONDITION_NAME$k&&i.command.key!==CONDITION_NAME$k&&n.command.key!==CONDITION_NAME$k?s=OPERATION_ID:n.command.key!==CONDITION_NAME$k&&(r.command.key===CONDITION_NAME$k||i.command.key===CONDITION_NAME$k)&&(s=OPERATION_ID$2),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:r}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];r.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new DataFilter(e,r=>this.getDataMapAtColumn(r))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const r=this.dropdownMenuPlugin.menu;for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return arrayEach(n,o=>{arrayEach(r.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,n=i.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?n.showRows(l):n.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.changeComponentsVisibility(!1,...r)}showComponents(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.changeComponentsVisibility(!0,...r)}destroy(){this.enabled&&(this.components.forEach((e,r)=>{e!==null&&(e.destroy(),this.components.set(r,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function _onAfterChange$2(t){t&&arrayEach(t,e=>{const[,r]=e,i=this.hot.propToCol(r);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function _onAfterDropdownMenuShow(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function _onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function _onBeforeDropdownMenuShow(){const t=this.dropdownMenuPlugin.menu;_classPrivateFieldGet$m(_dropdownMenuTraces,this).has(t)||_classPrivateFieldGet$m(_menuFocusNavigator,this).setMenu(t),_classPrivateFieldGet$m(_dropdownMenuTraces,this).add(t)}function _onAfterDropdownMenuDefaultOptions(t){t.items.push({name:KEY$c}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function _onActionBarSubmit(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:n}=i,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(n);c===-1&&(c=void 0),this.conditionCollection.removeConditions(n),s.command.key!==CONDITION_NAME$k&&(this.conditionCollection.addCondition(n,s,l,c),o.command.key!==CONDITION_NAME$k&&this.conditionCollection.addCondition(n,o,l,c)),a.command.key!==CONDITION_NAME$k&&this.conditionCollection.addCondition(n,a,l,c),this.conditionUpdateObserver.flush(),this.components.forEach(u=>u.saveState(n)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function _onComponentChange(t,e){const r=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===ConditionComponent&&!e.inputsCount&&this.setListeningDropdownMenu(),r.updateMenuDimensions()}function _onSelectUIClosed(){this.setListeningDropdownMenu()}function _onAfterGetColHeader$1(t,e,r){const i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)&&r===this.hot.view.getColumnHeadersCount()-1?addClass$1(e,"htFiltersActive"):removeClass$1(e,"htFiltersActive")}function _updateComponents(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:r,column:i},conditionArgsChange:n}=t;Array.isArray(n)&&_classPrivateFieldSet$l(_previousConditionStack,this,_classPrivateFieldGet$m(_previousConditionStack,this).map(a=>(a.column===i&&r.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...n]])}),a)));const s=r.filter(a=>a.name===CONDITION_NAME),o=r.filter(a=>a.name!==CONDITION_NAME);if(s.length>=2||o.length>=3)warn(toSingleLine`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(o[0],i),this.components.get("filter_by_condition2").updateState(o[1],i),this.components.get("filter_operators").updateState(a,i),this.components.get("filter_by_value").updateState(t)}}const DEFAULT_LICENSE_KEY="internal-use-in-handsontable",DEFAULT_SETTINGS={licenseKey:DEFAULT_LICENSE_KEY,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function getEngineSettingsOverrides(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[PLUGIN_KEY$i])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function cleanEngineSettings(t){return Object.keys(t).reduce((e,r)=>(r!=="hyperformula"&&(e[r]=t[r]),e),{})}function getEngineSettingsWithDefaultsAndOverrides(t){var e;const r=t[PLUGIN_KEY$i],i=cleanEngineSettings(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),n=getEngineSettingsOverrides(t);return{...DEFAULT_SETTINGS,...i,...n}}function getEngineSettingsWithOverrides(t){var e;const r=t[PLUGIN_KEY$i],i=cleanEngineSettings(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),n=getEngineSettingsOverrides(t);return{...i,...n}}function haveEngineSettingsChanged(t,e){return Object.keys(e).some(r=>e[r]!==void 0&&e[r]!==t[r])}function getEngineRelationshipRegistry(){const t="engine_relationship",e=staticRegister(PLUGIN_KEY$i);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function getSharedEngineUsageRegistry(){const t="shared_engine_usage",e=staticRegister(PLUGIN_KEY$i);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function setupEngine(t){const e=t.getSettings(),r=e[PLUGIN_KEY$i],i=r?.engine;if(r===!0||isUndefined(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var n;return registerEngine((n=i.hyperformula)!==null&&n!==void 0?n:i,e,t)}else if(typeof i=="object"&&isUndefined(i.hyperformula)){const s=getEngineRelationshipRegistry(),o=getSharedEngineUsageRegistry().get(i);return s.has(i)||s.set(i,[]),s.get(i).push(t),o&&o.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:DEFAULT_LICENSE_KEY}),(i.getConfig().leapYear1900!==DEFAULT_SETTINGS.leapYear1900||isObjectEqual(i.getConfig().nullDate,DEFAULT_SETTINGS.nullDate)===!1)&&warn(toSingleLine`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function registerEngine(t,e,r){const i=e[PLUGIN_KEY$i],n=getEngineSettingsWithDefaultsAndOverrides(e),s=getEngineRelationshipRegistry(),o=getSharedEngineUsageRegistry();registerCustomFunctions(t,i.functions),registerLanguage(t,i.language);const a=t.buildEmpty(n);return s.set(a,[r]),o.set(a,[r.guid]),registerNamedExpressions(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function getRegisteredHotInstances(t){var e;const r=getEngineRelationshipRegistry(),i=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(n=>[n.getPlugin("formulas").sheetId,n]))}function unregisterEngine(t,e){if(t){const r=getEngineRelationshipRegistry(),i=r.get(t),n=getSharedEngineUsageRegistry(),s=n.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&r.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(n.delete(t),t.destroy()))}}function registerCustomFunctions(t,e){e&&e.forEach(r=>{const{name:i,plugin:n,translations:s}=r;try{t.registerFunction(i,n,s)}catch(o){warn(o.message)}})}function registerLanguage(t,e){if(e){const{langCode:r}=e;try{t.registerLanguage(r,e)}catch(i){warn(i.message)}}}function registerNamedExpressions(t,e){e&&(t.suspendEvaluation(),e.forEach(r=>{const{name:i,expression:n,scope:s,options:o}=r;try{t.addNamedExpression(i,n,s,o)}catch(a){warn(a.message)}}),t.resumeEvaluation())}function setupSheet(t,e){return(isUndefined(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const DEFAULT_DATE_FORMAT_HYPERFORMULA="DD/MM/YYYY";function isEscapedFormulaExpression(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function unescapeFormulaExpression(t){return isEscapedFormulaExpression(t)?t.substr(1):t}function isFormula(t){return typeof t=="string"&&t.startsWith("=")}function isDate(t,e){return typeof t=="string"&&e==="date"}function isDateValid(t,e){return hooks(t,e,!0).isValid()}function getDateInHfFormat(t,e){return hooks(t,e,!0).format(DEFAULT_DATE_FORMAT_HYPERFORMULA)}function getDateInHotFormat(t,e){return hooks(t,DEFAULT_DATE_FORMAT_HYPERFORMULA,!0).format(e)}function getDateFromExcelDate(t,e){const i=new Date(Date.UTC(0,0,t+-1));return hooks(i).format(e)}function getMoveLine(t,e,r){const i=Array.from(Array(r).keys()).filter(s=>t.includes(s)===!1);if(e===0){var n;return(n=i[e])!==null&&n!==void 0?n:0}return i[e-1]+1}function getInitiallyCalculatedMoves(t,e){const r=[];return t.forEach(i=>{const n={from:i,to:e};r.forEach(s=>{const o=s.from>s.to,a=s.to<=n.from;s.from>n.from&&a&&o&&(n.from+=1)}),n.from>=e&&(e+=1),r.push(n)}),r}function adjustedCalculatedMoves(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(n=>{const s=n.from<n.to;n.from>e.from&&s&&(n.from-=1)})}),t}function getMoves(t,e,r){const i=getInitiallyCalculatedMoves(t,getMoveLine(t,e,r));return adjustedCalculatedMoves(i)}function _classPrivateFieldInitSpec$l(t,e,r){_checkPrivateRedeclaration$q(t,e),e.set(t,r)}function _checkPrivateRedeclaration$q(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$l(t,e){return t.get(_assertClassBrand$q(t,e))}function _classPrivateFieldSet$k(t,e,r){return t.set(_assertClassBrand$q(t,e),r),r}function _assertClassBrand$q(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _axis=new WeakMap,_indexMapper=new WeakMap,_indexSyncer=new WeakMap,_indexesSequence=new WeakMap,_movedIndexes=new WeakMap,_finalIndex=new WeakMap,_removedIndexes=new WeakMap;class AxisSyncer{constructor(e,r,i){_classPrivateFieldInitSpec$l(this,_axis,void 0),_classPrivateFieldInitSpec$l(this,_indexMapper,void 0),_classPrivateFieldInitSpec$l(this,_indexSyncer,void 0),_classPrivateFieldInitSpec$l(this,_indexesSequence,[]),_classPrivateFieldInitSpec$l(this,_movedIndexes,[]),_classPrivateFieldInitSpec$l(this,_finalIndex,void 0),_classPrivateFieldInitSpec$l(this,_removedIndexes,[]),_classPrivateFieldSet$k(_axis,this,e),_classPrivateFieldSet$k(_indexMapper,this,r),_classPrivateFieldSet$k(_indexSyncer,this,i)}setRemovedHfIndexes(e){return _classPrivateFieldSet$k(_removedIndexes,this,e.map(r=>{const i=_classPrivateFieldGet$l(_indexMapper,this).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(i)})),_classPrivateFieldGet$l(_removedIndexes,this)}getRemovedHfIndexes(){return _classPrivateFieldGet$l(_removedIndexes,this)}getHfIndexFromVisualIndex(e){const r=_classPrivateFieldGet$l(_indexMapper,this).getIndexesSequence(),i=_classPrivateFieldGet$l(_indexMapper,this).getNotTrimmedIndexes();return r.indexOf(i[e],e)}syncMoves(e){const i=`move${toUpperCaseFirst(_classPrivateFieldGet$l(_axis,this))}s`;_classPrivateFieldGet$l(_indexSyncer,this).getEngine().batch(()=>{e.forEach(n=>{const s=n.from!==n.to,o=n.from+1!==n.to;s&&o&&_classPrivateFieldGet$l(_indexSyncer,this).getEngine()[i](_classPrivateFieldGet$l(_indexSyncer,this).getSheetId(),n.from,1,n.to)})})}storeMovesInformation(e,r,i){i!==!1&&(_classPrivateFieldSet$k(_movedIndexes,this,e.map(n=>this.getHfIndexFromVisualIndex(n))),_classPrivateFieldSet$k(_finalIndex,this,this.getHfIndexFromVisualIndex(r)))}calculateAndSyncMoves(e,r){if(_classPrivateFieldGet$l(_indexSyncer,this).isPerformingUndoRedo()||e===!1||r===!1)return;const i=getMoves(_classPrivateFieldGet$l(_movedIndexes,this),_classPrivateFieldGet$l(_finalIndex,this),_classPrivateFieldGet$l(_indexMapper,this).getNumberOfIndexes());_classPrivateFieldGet$l(_indexSyncer,this).getSheetId()===null?_classPrivateFieldGet$l(_indexSyncer,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${toUpperCaseFirst(_classPrivateFieldGet$l(_axis,this))}Order`;return r=>{if(_classPrivateFieldGet$l(_indexSyncer,this).isPerformingUndoRedo())return;const i=_classPrivateFieldGet$l(_indexMapper,this).getIndexesSequence();if(r==="update"&&i.length>0){const n=_classPrivateFieldGet$l(_indexesSequence,this).map(l=>i.indexOf(l)),s=_classPrivateFieldGet$l(_indexSyncer,this).getEngine().getSheetDimensions(_classPrivateFieldGet$l(_indexSyncer,this).getSheetId());let o;_classPrivateFieldGet$l(_axis,this)==="row"?o=s.height:o=s.width;const a=n.length;for(let l=a;l<o;l+=1)n.push(l);_classPrivateFieldGet$l(_indexSyncer,this).getEngine()[e](_classPrivateFieldGet$l(_indexSyncer,this).getSheetId(),n)}_classPrivateFieldSet$k(_indexesSequence,this,i)}}init(){_classPrivateFieldSet$k(_indexesSequence,this,_classPrivateFieldGet$l(_indexMapper,this).getIndexesSequence())}}function _classPrivateFieldInitSpec$k(t,e,r){_checkPrivateRedeclaration$p(t,e),e.set(t,r)}function _checkPrivateRedeclaration$p(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$k(t,e){return t.get(_assertClassBrand$p(t,e))}function _classPrivateFieldSet$j(t,e,r){return t.set(_assertClassBrand$p(t,e),r),r}function _assertClassBrand$p(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _rowIndexSyncer=new WeakMap,_columnIndexSyncer=new WeakMap,_postponeAction=new WeakMap,_isPerformingUndo=new WeakMap,_isPerformingRedo=new WeakMap,_engine=new WeakMap,_sheetId=new WeakMap;class IndexSyncer{constructor(e,r,i){_classPrivateFieldInitSpec$k(this,_rowIndexSyncer,void 0),_classPrivateFieldInitSpec$k(this,_columnIndexSyncer,void 0),_classPrivateFieldInitSpec$k(this,_postponeAction,void 0),_classPrivateFieldInitSpec$k(this,_isPerformingUndo,!1),_classPrivateFieldInitSpec$k(this,_isPerformingRedo,!1),_classPrivateFieldInitSpec$k(this,_engine,null),_classPrivateFieldInitSpec$k(this,_sheetId,null),_classPrivateFieldSet$j(_rowIndexSyncer,this,new AxisSyncer("row",e,this)),_classPrivateFieldSet$j(_columnIndexSyncer,this,new AxisSyncer("column",r,this)),_classPrivateFieldSet$j(_postponeAction,this,i)}getForAxis(e){return e==="row"?_classPrivateFieldGet$k(_rowIndexSyncer,this):_classPrivateFieldGet$k(_columnIndexSyncer,this)}setPerformUndo(e){_classPrivateFieldSet$j(_isPerformingUndo,this,e)}setPerformRedo(e){_classPrivateFieldSet$j(_isPerformingRedo,this,e)}isPerformingUndoRedo(){return _classPrivateFieldGet$k(_isPerformingUndo,this)||_classPrivateFieldGet$k(_isPerformingRedo,this)}getSheetId(){return _classPrivateFieldGet$k(_sheetId,this)}getEngine(){return _classPrivateFieldGet$k(_engine,this)}getPostponeAction(){return _classPrivateFieldGet$k(_postponeAction,this)}setupSyncEndpoint(e,r){_classPrivateFieldSet$j(_engine,this,e),_classPrivateFieldSet$j(_sheetId,this,r),_classPrivateFieldGet$k(_rowIndexSyncer,this).init(),_classPrivateFieldGet$k(_columnIndexSyncer,this).init()}}function _classPrivateMethodInitSpec$i(t,e){_checkPrivateRedeclaration$o(t,e),e.add(t)}function _defineProperty$C(t,e,r){return(e=_toPropertyKey$C(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$C(t){var e=_toPrimitive$C(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$C(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldInitSpec$j(t,e,r){_checkPrivateRedeclaration$o(t,e),e.set(t,r)}function _checkPrivateRedeclaration$o(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$i(t,e,r){return t.set(_assertClassBrand$o(t,e),r),r}function _classPrivateFieldGet$j(t,e){return t.get(_assertClassBrand$o(t,e))}function _assertClassBrand$o(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$i="formulas",SETTING_KEYS=["maxRows","maxColumns","language"],PLUGIN_PRIORITY$i=260;Hooks.getSingleton().register("afterNamedExpressionAdded");Hooks.getSingleton().register("afterNamedExpressionRemoved");Hooks.getSingleton().register("afterSheetAdded");Hooks.getSingleton().register("afterSheetRemoved");Hooks.getSingleton().register("afterSheetRenamed");Hooks.getSingleton().register("afterFormulasValuesUpdate");const isBlockedSource=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var _internalOperationPending=new WeakMap,_hotWasInitializedWithEmptyData=new WeakMap,_engineListeners=new WeakMap,_Formulas_brand=new WeakSet;class Formulas extends BasePlugin{constructor(){var e;super(...arguments),e=this,_classPrivateMethodInitSpec$i(this,_Formulas_brand),_classPrivateFieldInitSpec$j(this,_internalOperationPending,!1),_classPrivateFieldInitSpec$j(this,_hotWasInitializedWithEmptyData,!1),_classPrivateFieldInitSpec$j(this,_engineListeners,[["valuesUpdated",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$o(_Formulas_brand,e,_onEngineValuesUpdated).call(e,...i)}],["namedExpressionAdded",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$o(_Formulas_brand,e,_onEngineNamedExpressionsAdded).call(e,...i)}],["namedExpressionRemoved",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$o(_Formulas_brand,e,_onEngineNamedExpressionsRemoved).call(e,...i)}],["sheetAdded",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$o(_Formulas_brand,e,_onEngineSheetAdded).call(e,...i)}],["sheetRenamed",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$o(_Formulas_brand,e,_onEngineSheetRenamed).call(e,...i)}],["sheetRemoved",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$o(_Formulas_brand,e,_onEngineSheetRemoved).call(e,...i)}]]),_defineProperty$C(this,"staticRegister",staticRegister("formulas")),_defineProperty$C(this,"engine",null),_defineProperty$C(this,"sheetId",null),_defineProperty$C(this,"sheetName",null),_defineProperty$C(this,"indexSyncer",null),_defineProperty$C(this,"rowAxisSyncer",null),_defineProperty$C(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$i}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$i}static get SETTING_KEYS(){return[PLUGIN_KEY$i,...SETTING_KEYS]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$i]}enablePlugin(){var e,r=this;if(!this.enabled){if(this.engine=(e=setupEngine(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){warn("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&_assertClassBrand$o(_Formulas_brand,this,_updateSheetNameAndSheetId).call(this,i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onBeforeLoadData$1).call(r,...n)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onAfterLoadData$3).call(r,...n)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onBeforeLoadData$1).call(r,...n)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onAfterLoadData$3).call(r,...n)}),this.addHook("modifyData",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onModifyData).call(r,...n)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onModifySourceData).call(r,...n)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onBeforeValidate).call(r,...n)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onAfterSetSourceDataAtCell).call(r,...n)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onAfterSetDataAtCell).call(r,...n)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onAfterSetDataAtCell).call(r,...n)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onBeforeCreateRow).call(r,...n)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onBeforeCreateCol).call(r,...n)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onAfterCreateRow$2).call(r,...n)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onAfterCreateCol$1).call(r,...n)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onBeforeRemoveRow$1).call(r,...n)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onBeforeRemoveCol).call(r,...n)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onAfterRemoveRow$2).call(r,...n)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onAfterRemoveCol$1).call(r,...n)}),this.indexSyncer=new IndexSyncer(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,n,s,o)=>{this.rowAxisSyncer.storeMovesInformation(i,n,o)}),this.hot.addHook("beforeColumnMove",(i,n,s,o)=>{this.columnAxisSyncer.storeMovesInformation(i,n,o)}),this.hot.addHook("afterRowMove",(i,n,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(i,n,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(i,n)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,n)}),this.hot.addHook("afterColumnFreeze",(i,n)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,n)}),this.hot.addHook("beforeColumnUnfreeze",(i,n)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,n)}),this.hot.addHook("afterColumnUnfreeze",(i,n)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,n)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onAfterCellMetaReset).call(r,...n)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onAfterDetachChild$1).call(r,...n)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$o(_Formulas_brand,r,_onBeforeAutofill).call(r,...n)}),_classPrivateFieldGet$j(_engineListeners,this).forEach(i=>{let[n,s]=i;return this.engine.on(n,s)}),super.enablePlugin()}}disablePlugin(){_classPrivateFieldGet$j(_engineListeners,this).forEach(e=>{let[r,i]=e;return this.engine.off(r,i)}),unregisterEngine(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const r=getEngineSettingsWithOverrides(this.hot.getSettings());haveEngineSettingsChanged(this.engine.getConfig(),r)&&this.engine.updateConfig(r);const i=this.hot.getSettings()[PLUGIN_KEY$i];if(isDefined(i)&&isDefined(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const n=this.hot.getSettings()[PLUGIN_KEY$i].sheetName;if(n&&this.engine.doesSheetExist(n))this.switchSheet(this.sheetName);else{const s=this.addSheet(n??void 0,this.hot.getSourceDataArray());_assertClassBrand$o(_Formulas_brand,this,_updateSheetNameAndSheetId).call(this,s)}}super.updatePlugin(e)}destroy(){_classPrivateFieldGet$j(_engineListeners,this).forEach(e=>{var r;let[i,n]=e;return(r=this.engine)===null||r===void 0?void 0:r.off(i,n)}),_classPrivateFieldSet$i(_engineListeners,this,null),unregisterEngine(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,r){if(isDefined(r)&&!isArrayOfArrays(r))return warn("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return warn("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return r&&this.engine.setSheetContent(this.engine.getSheetId(i),r),i}catch(i){return warn(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){error(`The sheet named \`${e}\` does not exist, switch aborted.`);return}_assertClassBrand$o(_Formulas_brand,this,_updateSheetNameAndSheetId).call(this,e);const r=this.engine.getSheetSerialized(this.sheetId);r.length>0&&this.hot.loadData(r,`${toUpperCaseFirst(PLUGIN_KEY$i)}.switchSheet`)}getCellType(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const n=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(r);return n!==null&&s!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)}):"EMPTY"}isFormulaCellType(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)})}renderDependentSheets(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(n=>{var s;const o=n==null||(s=n.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(i.has(o)||i.add(o))}),getRegisteredHotInstances(this.engine).forEach((n,s)=>{if((r||s!==this.sheetId)&&i.has(s)){var o;n.render(),(o=n.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=s=>{var o;const{row:a,col:l,sheet:c}=(o=s?.address)!==null&&o!==void 0?o:{};return isDefined(c)?`${c}:${a}x${l}`:""},n=new Set(r.map(s=>i(s)));e.forEach(s=>{var o,a;const{row:l,col:c}=(o=s.address)!==null&&o!==void 0?o:{};if(isDefined(l)===!1||isDefined(c)===!1||l>=this.hot.countRows()||c>=this.hot.countCols())return;const u=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,d=i(s);if(u!==void 0&&!n.has(d)){const h=getRegisteredHotInstances(this.engine).get(u);if(!h)return;h.validateCell(h.getDataAtCell(l,c),h.getCellMeta(l,c),()=>{})}})}syncChangeWithEngine(e,r,i){const n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(n)){warn(`Not possible to set cell data at ${JSON.stringify(n)}`);return}const s=this.hot.getCellMeta(e,r);return isDate(i,s.type)&&(isDateValid(i,s.dateFormat)?i=getDateInHfFormat(i,s.dateFormat):isFormula(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(n,i)}}function _updateSheetNameAndSheetId(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function _onBeforeValidate(t,e,r){const i=this.hot.propToCol(r);if(this.isFormulaCellType(e,i)){const n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},s=this.hot.getCellMeta(e,i);let o=this.engine.getCellValue(n);return s.type==="date"&&isNumeric(o)&&(o=getDateFromExcelDate(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function _onBeforeAutofill(t,e,r){const{row:i,col:n}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=r.getTopStartCorner(),{row:c,col:u}=r.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(h)===!1)return!1;const f=this.engine.getFillRangeData(d,h),{row:g,col:m}=d.start,{row:C,col:y}=d.end,v=C-g+1,E=y-m+1;for(let $=0;$<f.length;$+=1)for(let O=0;O<f[$].length;O+=1){const P=f[$][O],I=g+$%v,W=m+O%E,q=this.hot.getCellMeta(I,W);isDate(P,q.type)&&(P.startsWith("'")?f[$][O]=P.slice(1):this.isFormulaCellType(I,W,this.sheetId)===!1&&(f[$][O]=getDateInHotFormat(P,q.dateFormat)))}return f}function _onBeforeLoadData$1(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(toUpperCaseFirst(PLUGIN_KEY$i))||_classPrivateFieldSet$i(_hotWasInitializedWithEmptyData,this,isUndefined(this.hot.getSettings().data))}function _onAfterCellMetaReset(){if(_classPrivateFieldGet$j(_hotWasInitializedWithEmptyData,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((r,i)=>{r.forEach((n,s)=>{const o=this.hot.getCellMeta(i,s,{skipMetaExtension:!0}),a=o.dateFormat;isDate(n,o.type)&&(isDateValid(n,a)?t[i][s]=getDateInHfFormat(n,a):n.startsWith("=")||(t[i][s]=`'${n}`))})}),_classPrivateFieldSet$i(_internalOperationPending,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),_classPrivateFieldSet$i(_internalOperationPending,this,!1)}function _onAfterLoadData$3(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(r.includes(toUpperCaseFirst(PLUGIN_KEY$i)))return;const i=setupSheet(this.engine,this.hot.getSettings()[PLUGIN_KEY$i].sheetName);if(_assertClassBrand$o(_Formulas_brand,this,_updateSheetNameAndSheetId).call(this,i),r!=="updateSettings")if(_classPrivateFieldGet$j(_hotWasInitializedWithEmptyData,this))this.switchSheet(this.sheetName);else{const n=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,n)){_classPrivateFieldSet$i(_internalOperationPending,this,!0);const s=this.engine.setSheetContent(this.sheetId,n);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),_classPrivateFieldSet$i(_internalOperationPending,this,!1)}}}function _onModifyData(t,e,r,i){if(i!=="get"||_classPrivateFieldGet$j(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const n=this.getCellType(t,e);if(n==="VALUE"||n==="EMPTY"){r.value=unescapeFormulaExpression(r.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let o=this.engine.getCellValue(s);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&isNumeric(o)&&(o=getDateFromExcelDate(o,a.dateFormat)),r.value=typeof o=="object"&&o!==null?o.value:o}function _onModifySourceData(t,e,r,i){if(i!=="get"||_classPrivateFieldGet$j(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const n=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(n===null||s===null)return;const o=this.getCellType(n,s);if(o==="VALUE"||o==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};r.value=this.engine.getCellSerialized(l)}function _onAfterSetDataAtCell(t,e){if(isBlockedSource(e))return;const r=[],i=[],n=this.engine.batch(()=>{t.forEach(s=>{let[o,a,,l]=s;const c=this.hot.propToCol(a),u=this.hot.toPhysicalRow(o),d=this.hot.toPhysicalColumn(c),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};u!==null&&d!==null?this.syncChangeWithEngine(o,c,l):r.push([o,c,l]),i.push({address:h})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{r.forEach(o=>{let[a,l,c]=o;this.syncChangeWithEngine(a,l,c)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function _onAfterSetSourceDataAtCell(t,e){if(isBlockedSource(e))return;const r=[],i=[];t.forEach(n=>{let[s,o,,a]=n;const l=this.hot.propToCol(o);if(!isNumeric(l))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){warn(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}i.push({address:c}),r.push(...this.engine.setCellContents(c,a))}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function _onBeforeCreateRow(t,e){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,e]))return!1}function _onBeforeCreateCol(t,e){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,e]))return!1}function _onBeforeRemoveRow$1(t,e,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function _onBeforeRemoveCol(t,e,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function _onAfterCreateRow$2(t,e,r){if(isBlockedSource(r))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function _onAfterCreateCol$1(t,e,r){if(isBlockedSource(r))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function _onAfterRemoveRow$2(t,e,r,i){if(isBlockedSource(i))return;const n=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{n.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function _onAfterRemoveCol$1(t,e,r,i){if(isBlockedSource(i))return;const n=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{n.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function _onAfterDetachChild$1(t,e,r){var i;_classPrivateFieldSet$i(_internalOperationPending,this,!0);const n=this.hot.getSourceDataArray(r,0,r+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());_classPrivateFieldSet$i(_internalOperationPending,this,!1),n.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:r+o,sheet:this.sheetId},[[a]])})})}function _onEngineValuesUpdated(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function _onEngineNamedExpressionsAdded(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function _onEngineNamedExpressionsRemoved(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function _onEngineSheetAdded(t){this.hot.runHooks("afterSheetAdded",t)}function _onEngineSheetRenamed(t,e){_assertClassBrand$o(_Formulas_brand,this,_updateSheetNameAndSheetId).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function _onEngineSheetRemoved(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function hideColumnItem(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[,i,,n]=e;i-n!==0&&(r=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_COLUMN,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,r.col),0),n=Math.max(e.col,r.col),s=[];for(let l=i;l<=n;l+=1)s.push(l);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function showColumnItem(t){const e=[];return{key:"hidden_columns_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_COLUMN,r)},callback(){var r,i;if(e.length===0)return;let n=e[0],s=e[e.length-1];n=(r=this.columnIndexMapper.getNearestNotHiddenIndex(n-1,-1))!==null&&r!==void 0?r:0,s=(i=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-n+1===this.countCols()||this.selectColumns(n,s)},disabled:!1,hidden(){const r=arrayMap(t.getHiddenColumns(),d=>this.toPhysicalColumn(d));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),n=i.getTopStartCorner().col,s=i.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(n),l=o.getRenderableFromVisualIndex(s),c=o.getNotTrimmedIndexes(),u=[];if(n!==s){const d=s-n+1,h=l-a+1;if(d>h){const f=c.slice(n,s+1);u.push(...f.filter(g=>r.includes(g)))}}else if(a===0&&a<n)u.push(...c.slice(0,n));else if(a===null)u.push(...c.slice(0,this.countCols()));else{const d=this.countCols()-1,h=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(d,-1));l===h&&d>s&&u.push(...c.slice(s+1))}return arrayEach(u,d=>{e.push(this.toVisualColumn(d))}),e.length===0}}}function _classPrivateMethodInitSpec$h(t,e){_checkPrivateRedeclaration$n(t,e),e.add(t)}function _classPrivateFieldInitSpec$i(t,e,r){_checkPrivateRedeclaration$n(t,e),e.set(t,r)}function _checkPrivateRedeclaration$n(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$i(t,e){return t.get(_assertClassBrand$n(t,e))}function _classPrivateFieldSet$h(t,e,r){return t.set(_assertClassBrand$n(t,e),r),r}function _assertClassBrand$n(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeHideColumns");Hooks.getSingleton().register("afterHideColumns");Hooks.getSingleton().register("beforeUnhideColumns");Hooks.getSingleton().register("afterUnhideColumns");const PLUGIN_KEY$h="hiddenColumns",PLUGIN_PRIORITY$h=310;var _hiddenColumnsMap=new WeakMap,_HiddenColumns_brand=new WeakSet;class HiddenColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$h(this,_HiddenColumns_brand),_classPrivateFieldInitSpec$i(this,_hiddenColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$h}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$h}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$h]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldSet$h(_hiddenColumnsMap,this,new HidingMap),_classPrivateFieldGet$i(_hiddenColumnsMap,this).addLocalHook("init",()=>_assertClassBrand$n(_HiddenColumns_brand,this,_onMapInit$4).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$i(_hiddenColumnsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$n(_HiddenColumns_brand,e,_onAfterContextMenuDefaultOptions$2).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,n)=>_assertClassBrand$n(_HiddenColumns_brand,this,_onAfterGetCellMeta$2).call(this,r,i,n)),this.addHook("modifyColWidth",(r,i)=>_assertClassBrand$n(_HiddenColumns_brand,this,_onModifyColWidth$3).call(this,r,i),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$n(_HiddenColumns_brand,e,_onAfterGetColHeader).call(e,...i)}),this.addHook("modifyCopyableRange",r=>_assertClassBrand$n(_HiddenColumns_brand,this,_onModifyCopyableRange$1).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const r=this.getHiddenColumns(),i=this.isValidConfig(e);let n=r;const s=_classPrivateFieldGet$i(_hiddenColumnsMap,this).getValues().slice(),o=e.length>0;if(i&&o){const l=e.map(c=>this.hot.toPhysicalColumn(c));arrayEach(l,c=>{s[c]=!1}),n=arrayReduce(s,(c,u,d)=>(u&&c.push(this.hot.toVisualColumn(d)),c),[])}this.hot.runHooks("beforeUnhideColumns",r,n,i&&o)!==!1&&(i&&o&&_classPrivateFieldGet$i(_hiddenColumnsMap,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,n,i&&o,i&&n.length<r.length))}showColumn(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.showColumns(r)}hideColumns(e){const r=this.getHiddenColumns(),i=this.isValidConfig(e);let n=r;i&&(n=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideColumns",r,n,i)!==!1&&(i&&this.hot.batchExecution(()=>{arrayEach(e,o=>{_classPrivateFieldGet$i(_hiddenColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",r,n,i,i&&n.length>r.length))}hideColumn(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.hideColumns(r)}getHiddenColumns(){return arrayMap(_classPrivateFieldGet$i(_hiddenColumnsMap,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return _classPrivateFieldGet$i(_hiddenColumnsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const r=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<r):!1}resetCellsMeta(){arrayEach(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){_classPrivateFieldSet$h(_hiddenColumnsMap,this,null),super.destroy()}}function _onModifyColWidth$3(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function _onAfterGetCellMeta$2(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(r.skipColumnOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const i=r.className.split(" ");if(i.length>0){const n=i.indexOf("afterHiddenColumn");n>-1&&i.splice(n,1),r.className=i.join(" ")}}}function _onModifyCopyableRange$1(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(i,n,s,o)=>{e.push({startRow:i,endRow:n,startCol:s,endCol:o})};return arrayEach(t,i=>{let n=!0,s=0;rangeEach(i.startCol,i.endCol,o=>{this.isHidden(o)?(n||r(i.startRow,i.endRow,s,o-1),n=!0):(n&&(s=o),o===i.endCol&&r(i.startRow,i.endRow,s,o),n=!1)})}),e}function _onAfterGetColHeader(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&r.push("beforeHiddenColumn"),addClass$1(e,r)}function _onAfterContextMenuDefaultOptions$2(t){t.items.push({name:KEY$c},hideColumnItem(this),showColumnItem(this))}function _onMapInit$4(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function hideRowItem(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[i,,n]=e;i-n!==0&&(r=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_ROW,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,r.row),0),n=Math.max(e.row,r.row),s=[];for(let l=i;l<=n;l+=1)s.push(l);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function showRowItem(t){const e=[];return{key:"hidden_rows_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_ROW,r)},callback(){var r,i;if(e.length===0)return;let n=e[0],s=e[e.length-1];n=(r=this.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1))!==null&&r!==void 0?r:0,s=(i=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-n+1===this.countRows()||this.selectRows(n,s)},disabled:!1,hidden(){const r=arrayMap(t.getHiddenRows(),d=>this.toPhysicalRow(d));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),n=i.getTopStartCorner().row,s=i.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(n),l=o.getRenderableFromVisualIndex(s),c=o.getNotTrimmedIndexes(),u=[];if(n!==s){const d=s-n+1,h=l-a+1;if(d>h){const f=c.slice(n,s+1);u.push(...f.filter(g=>r.includes(g)))}}else if(a===0&&a<n)u.push(...c.slice(0,n));else if(a===null)u.push(...c.slice(0,this.countRows()));else{const d=this.countRows()-1,h=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(d,-1));l===h&&d>s&&u.push(...c.slice(s+1))}return arrayEach(u,d=>{e.push(this.toVisualRow(d))}),e.length===0}}}function _classPrivateMethodInitSpec$g(t,e){_checkPrivateRedeclaration$m(t,e),e.add(t)}function _classPrivateFieldInitSpec$h(t,e,r){_checkPrivateRedeclaration$m(t,e),e.set(t,r)}function _checkPrivateRedeclaration$m(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$h(t,e){return t.get(_assertClassBrand$m(t,e))}function _classPrivateFieldSet$g(t,e,r){return t.set(_assertClassBrand$m(t,e),r),r}function _assertClassBrand$m(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeHideRows");Hooks.getSingleton().register("afterHideRows");Hooks.getSingleton().register("beforeUnhideRows");Hooks.getSingleton().register("afterUnhideRows");const PLUGIN_KEY$g="hiddenRows",PLUGIN_PRIORITY$g=320;var _hiddenRowsMap=new WeakMap,_HiddenRows_brand=new WeakSet;class HiddenRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$g(this,_HiddenRows_brand),_classPrivateFieldInitSpec$h(this,_hiddenRowsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$g}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$g}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$g]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldSet$g(_hiddenRowsMap,this,new HidingMap),_classPrivateFieldGet$h(_hiddenRowsMap,this).addLocalHook("init",()=>_assertClassBrand$m(_HiddenRows_brand,this,_onMapInit$3).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$h(_hiddenRowsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$m(_HiddenRows_brand,e,_onAfterContextMenuDefaultOptions$1).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,n)=>_assertClassBrand$m(_HiddenRows_brand,this,_onAfterGetCellMeta$1).call(this,r,i,n)),this.addHook("modifyRowHeight",(r,i)=>_assertClassBrand$m(_HiddenRows_brand,this,_onModifyRowHeight$1).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$m(_HiddenRows_brand,e,_onAfterGetRowHeader$1).call(e,...i)}),this.addHook("modifyCopyableRange",r=>_assertClassBrand$m(_HiddenRows_brand,this,_onModifyCopyableRange).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const r=this.getHiddenRows(),i=this.isValidConfig(e);let n=r;const s=_classPrivateFieldGet$h(_hiddenRowsMap,this).getValues().slice(),o=e.length>0;if(i&&o){const l=e.map(c=>this.hot.toPhysicalRow(c));arrayEach(l,c=>{s[c]=!1}),n=arrayReduce(s,(c,u,d)=>(u&&c.push(this.hot.toVisualRow(d)),c),[])}this.hot.runHooks("beforeUnhideRows",r,n,i&&o)!==!1&&(i&&o&&_classPrivateFieldGet$h(_hiddenRowsMap,this).setValues(s),this.hot.runHooks("afterUnhideRows",r,n,i&&o,i&&n.length<r.length))}showRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.showRows(r)}hideRows(e){const r=this.getHiddenRows(),i=this.isValidConfig(e);let n=r;i&&(n=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideRows",r,n,i)!==!1&&(i&&this.hot.batchExecution(()=>{arrayEach(e,o=>{_classPrivateFieldGet$h(_hiddenRowsMap,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",r,n,i,i&&n.length>r.length))}hideRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.hideRows(r)}getHiddenRows(){return arrayMap(_classPrivateFieldGet$h(_hiddenRowsMap,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return _classPrivateFieldGet$h(_hiddenRowsMap,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const r=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<r):!1}resetCellsMeta(){arrayEach(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){_classPrivateFieldSet$g(_hiddenRowsMap,this,null),super.destroy()}}function _onModifyRowHeight$1(t,e){return this.isHidden(e)?0:t}function _onAfterGetCellMeta$1(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(r.skipRowOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const i=r.className.split(" ");if(i.length>0){const n=i.indexOf("afterHiddenRow");n>-1&&i.splice(n,1),r.className=i.join(" ")}}}function _onModifyCopyableRange(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(i,n,s,o)=>{e.push({startRow:i,endRow:n,startCol:s,endCol:o})};return arrayEach(t,i=>{let n=!0,s=0;rangeEach(i.startRow,i.endRow,o=>{this.isHidden(o)?(n||r(s,o-1,i.startCol,i.endCol),n=!0):(n&&(s=o),o===i.endRow&&r(s,o,i.startCol,i.endCol),n=!1)})}),e}function _onAfterGetRowHeader$1(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&r.push("beforeHiddenRow"),addClass$1(e,r)}function _onAfterContextMenuDefaultOptions$1(t){t.items.push({name:KEY$c},hideRowItem(this),showRowItem(this))}function _onMapInit$3(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function freezeColumnItem(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(e,r){const[{start:{col:i}}]=r;t.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function unfreezeColumnItem(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(e,r){const[{start:{col:i}}]=r;t.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function _classPrivateMethodInitSpec$f(t,e){_checkPrivateRedeclaration$l(t,e),e.add(t)}function _classPrivateFieldInitSpec$g(t,e,r){_checkPrivateRedeclaration$l(t,e),e.set(t,r)}function _checkPrivateRedeclaration$l(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$g(t,e){return t.get(_assertClassBrand$l(t,e))}function _classPrivateFieldSet$f(t,e,r){return t.set(_assertClassBrand$l(t,e),r),r}function _assertClassBrand$l(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeColumnFreeze");Hooks.getSingleton().register("afterColumnFreeze");Hooks.getSingleton().register("beforeColumnUnfreeze");Hooks.getSingleton().register("afterColumnUnfreeze");const PLUGIN_KEY$f="manualColumnFreeze",PLUGIN_PRIORITY$f=110;var _afterFirstUse=new WeakMap,_ManualColumnFreeze_brand=new WeakSet;class ManualColumnFreeze extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$f(this,_ManualColumnFreeze_brand),_classPrivateFieldInitSpec$g(this,_afterFirstUse,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$f}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$f}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$f]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_assertClassBrand$l(_ManualColumnFreeze_brand,this,_addContextMenuEntry).call(this,e)),this.addHook("beforeColumnMove",(e,r)=>_assertClassBrand$l(_ManualColumnFreeze_brand,this,_onBeforeColumnMove).call(this,e,r)),super.enablePlugin())}disablePlugin(){_classPrivateFieldSet$f(_afterFirstUse,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const r=this.hot.getSettings(),i=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;_classPrivateFieldGet$g(_afterFirstUse,this)||_classPrivateFieldSet$f(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const r=this.hot.getSettings(),i=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;_classPrivateFieldGet$g(_afterFirstUse,this)||_classPrivateFieldSet$f(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function _addContextMenuEntry(t){t.items.push({name:"---------"},freezeColumnItem(this),unfreezeColumnItem(this))}function _onBeforeColumnMove(t,e){if(_classPrivateFieldGet$g(_afterFirstUse,this)){const r=this.hot.getSettings().fixedColumnsStart;if(e<r||t.some(i=>i<r))return!1}}function _defineProperty$B(t,e,r){return(e=_toPropertyKey$B(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$B(t){var e=_toPrimitive$B(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$B(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const STATE_INITIALIZED$1=0,STATE_BUILT$1=1,STATE_APPENDED$1=2,UNIT$1="px";let BaseUI$2=class{constructor(e){_defineProperty$B(this,"hot",void 0),_defineProperty$B(this,"_element",null),_defineProperty$B(this,"state",STATE_INITIALIZED$1),_defineProperty$B(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=STATE_APPENDED$1}build(){this.state===STATE_INITIALIZED$1&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT$1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED$1}isAppended(){return this.state===STATE_APPENDED$1}isBuilt(){return this.state>=STATE_BUILT$1}setPosition(e,r){isNumeric(e)&&(this._element.style.top=e+UNIT$1),isNumeric(r)&&(this._element.style[this.inlineProperty]=r+UNIT$1)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,r){isNumeric(e)&&(this._element.style.width=e+UNIT$1),isNumeric(r)&&(this._element.style.height=r+UNIT$1)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){isNumeric(e)&&(this._element.style.marginTop=e+UNIT$1),isNumeric(r)&&(this._element.style[`margin${toUpperCaseFirst(this.inlineProperty)}`]=r+UNIT$1)}getOffset(){const e=this._element.style,r=`margin${toUpperCaseFirst(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}};const CSS_CLASSNAME$3="ht__manualColumnMove--backlight";let BacklightUI$1=class extends BaseUI$2{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$3)}};const CSS_CLASSNAME$2="ht__manualColumnMove--guideline";let GuidelineUI$1=class extends BaseUI$2{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$2)}};function _classPrivateMethodInitSpec$e(t,e){_checkPrivateRedeclaration$k(t,e),e.add(t)}function _classPrivateFieldInitSpec$f(t,e,r){_checkPrivateRedeclaration$k(t,e),e.set(t,r)}function _checkPrivateRedeclaration$k(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$e(t,e,r){return t.set(_assertClassBrand$k(t,e),r),r}function _classPrivateFieldGet$f(t,e){return t.get(_assertClassBrand$k(t,e))}function _assertClassBrand$k(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeColumnMove");Hooks.getSingleton().register("afterColumnMove");const PLUGIN_KEY$e="manualColumnMove",PLUGIN_PRIORITY$e=120,CSS_PLUGIN$1="ht__manualColumnMove",CSS_SHOW_UI$1="show-ui",CSS_ON_MOVING$1="on-moving--columns",CSS_AFTER_SELECTION$1="after-selection--columns";var _backlight$1=new WeakMap,_guideline$1=new WeakMap,_columnsToMove=new WeakMap,_countCols=new WeakMap,_pressed$3=new WeakMap,_target$1=new WeakMap,_cachedDropIndex$1=new WeakMap,_hoveredColumn=new WeakMap,_rootElementOffset=new WeakMap,_hasRowHeaders=new WeakMap,_fixedColumnsStart=new WeakMap,_ManualColumnMove_brand=new WeakSet;class ManualColumnMove extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$e(this,_ManualColumnMove_brand),_classPrivateFieldInitSpec$f(this,_backlight$1,new BacklightUI$1(this.hot)),_classPrivateFieldInitSpec$f(this,_guideline$1,new GuidelineUI$1(this.hot)),_classPrivateFieldInitSpec$f(this,_columnsToMove,[]),_classPrivateFieldInitSpec$f(this,_countCols,0),_classPrivateFieldInitSpec$f(this,_pressed$3,!1),_classPrivateFieldInitSpec$f(this,_target$1,{}),_classPrivateFieldInitSpec$f(this,_cachedDropIndex$1,void 0),_classPrivateFieldInitSpec$f(this,_hoveredColumn,void 0),_classPrivateFieldInitSpec$f(this,_rootElementOffset,void 0),_classPrivateFieldInitSpec$f(this,_hasRowHeaders,void 0),_classPrivateFieldInitSpec$f(this,_fixedColumnsStart,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$e}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$e}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$e]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$k(_ManualColumnMove_brand,e,_onBeforeOnCellMouseDown$3).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$k(_ManualColumnMove_brand,e,_onBeforeOnCellMouseOver$2).call(e,...i)}),this.addHook("afterScrollVertically",()=>_assertClassBrand$k(_ManualColumnMove_brand,this,_onAfterScrollVertically).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$k(_ManualColumnMove_brand,e,_onAfterLoadData$2).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),addClass$1(this.hot.rootElement,CSS_PLUGIN$1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass$1(this.hot.rootElement,CSS_PLUGIN$1),this.unregisterEvents(),_classPrivateFieldGet$f(_backlight$1,this).destroy(),_classPrivateFieldGet$f(_guideline$1,this).destroy(),super.disablePlugin()}moveColumn(e,r){return this.moveColumns([e],r)}moveColumns(e,r){const i=_classPrivateFieldGet$f(_cachedDropIndex$1,this),n=this.isMovePossible(e,r),s=this.hot.runHooks("beforeColumnMove",e,r,i,n);if(_classPrivateFieldSet$e(_cachedDropIndex$1,this,void 0),s===!1)return;n&&this.hot.columnIndexMapper.moveIndexes(e,r);const o=n&&this.isColumnOrderChanged(e,r);return this.hot.runHooks("afterColumnMove",e,r,i,n,o),o}dragColumn(e,r){return this.dragColumns([e],r)}dragColumns(e,r){const i=this.countFinalIndex(e,r);return _classPrivateFieldSet$e(_cachedDropIndex$1,this,r),this.moveColumns(e,i)}isMovePossible(e,r){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),n=e.length+r>i,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=i);return!(n||s||o||a)}isColumnOrderChanged(e,r){return e.some((i,n)=>i-n!==r)}countFinalIndex(e,r){const i=arrayReduce(e,(n,s)=>(s<r&&(n+=1),n),0);return r-i}getColumnsWidth(e,r){const i=this.hot.columnIndexMapper;let n=0;for(let s=e;s<=r;s+=1){const o=i.getRenderableFromVisualIndex(s);s<0?n+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(n+=this.hot.view._wt.wtTable.getColumnWidth(o)||0)}return n}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PLUGIN_KEY$e];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,r){const i=[];return rangeEach(e,r,n=>{i.push(n)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(_classPrivateFieldGet$f(_hoveredColumn,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const r=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,n=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,_classPrivateFieldGet$f(_hoveredColumn,this)-1);const o=r.hider.offsetWidth,a=r.TBODY.offsetLeft,l=_classPrivateFieldGet$f(_backlight$1,this).getOffset().start,c=_classPrivateFieldGet$f(_backlight$1,this).getSize().width;let u=0,d=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,m=outerWidth(this.hot.rootElement),C=g.innerWidth-_classPrivateFieldGet$f(_rootElementOffset,this)-m;d=g.innerWidth-_classPrivateFieldGet$f(_target$1,this).eventPageX-C-(i.scrollX===void 0?n:0)}else d=_classPrivateFieldGet$f(_target$1,this).eventPageX-(_classPrivateFieldGet$f(_rootElementOffset,this)-(i.scrollX===void 0?n:0));if(_classPrivateFieldGet$f(_hasRowHeaders,this)&&(u=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(_classPrivateFieldGet$f(_hoveredColumn,this))&&(s+=n),s+=u,_classPrivateFieldGet$f(_hoveredColumn,this)<0)_classPrivateFieldGet$f(_fixedColumnsStart,this)>0?_classPrivateFieldGet$f(_target$1,this).col=0:_classPrivateFieldGet$f(_target$1,this).col=e>0?e-1:e;else if(_classPrivateFieldGet$f(_target$1,this).TD.offsetWidth/2+s<=d){const g=_classPrivateFieldGet$f(_hoveredColumn,this)>=_classPrivateFieldGet$f(_countCols,this)?_classPrivateFieldGet$f(_countCols,this)-1:_classPrivateFieldGet$f(_hoveredColumn,this);_classPrivateFieldGet$f(_target$1,this).col=g+1,s+=_classPrivateFieldGet$f(_target$1,this).TD.offsetWidth}else _classPrivateFieldGet$f(_target$1,this).col=_classPrivateFieldGet$f(_hoveredColumn,this);let h=d,f=s;d+c+l>=o?h=o-c-l:d+l<a+u&&(h=a+u+Math.abs(l)),s>=o-1?f=o-1:f===0?f=1:i.scrollX!==void 0&&_classPrivateFieldGet$f(_hoveredColumn,this)<_classPrivateFieldGet$f(_fixedColumnsStart,this)&&(f-=_classPrivateFieldGet$f(_rootElementOffset,this)<=i.scrollX?_classPrivateFieldGet$f(_rootElementOffset,this):0),_classPrivateFieldGet$f(_backlight$1,this).setPosition(null,h),_classPrivateFieldGet$f(_guideline$1,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>_assertClassBrand$k(_ManualColumnMove_brand,this,_onMouseMove$3).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$k(_ManualColumnMove_brand,this,_onMouseUp$3).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet$f(_backlight$1,this).build(),_classPrivateFieldGet$f(_guideline$1,this).build()}destroy(){_classPrivateFieldGet$f(_backlight$1,this).destroy(),_classPrivateFieldGet$f(_guideline$1,this).destroy(),super.destroy()}}function _onBeforeOnCellMouseDown$3(t,e,r,i){const n=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=hasClass$1(t.target,"sortAction");if(!o||!s||_classPrivateFieldGet$f(_pressed$3,this)||t.button!==0||a){_classPrivateFieldSet$e(_pressed$3,this,!1),_classPrivateFieldGet$f(_columnsToMove,this).length=0,removeClass$1(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1]);return}const l=_classPrivateFieldGet$f(_guideline$1,this).isBuilt()&&!_classPrivateFieldGet$f(_guideline$1,this).isAppended(),c=_classPrivateFieldGet$f(_backlight$1,this).isBuilt()&&!_classPrivateFieldGet$f(_backlight$1,this).isAppended();l&&c&&(_classPrivateFieldGet$f(_guideline$1,this).appendTo(n.hider),_classPrivateFieldGet$f(_backlight$1,this).appendTo(n.hider));const{from:u,to:d}=o,h=Math.min(u.col,d.col),f=Math.max(u.col,d.col);if(e.row<0&&e.col>=h&&e.col<=f){i.column=!0,_classPrivateFieldSet$e(_pressed$3,this,!0);const g=r.firstChild?offsetRelativeTo(t,r.firstChild).x:t.offsetX;_classPrivateFieldGet$f(_target$1,this).eventPageX=t.pageX,_classPrivateFieldSet$e(_hoveredColumn,this,e.col),_classPrivateFieldGet$f(_target$1,this).TD=r,_classPrivateFieldGet$f(_target$1,this).col=e.col,_classPrivateFieldSet$e(_columnsToMove,this,this.prepareColumnsToMoving(h,f)),_classPrivateFieldSet$e(_hasRowHeaders,this,!!this.hot.getSettings().rowHeaders),_classPrivateFieldSet$e(_countCols,this,this.hot.countCols()),_classPrivateFieldSet$e(_fixedColumnsStart,this,this.hot.getSettings().fixedColumnsStart),_classPrivateFieldSet$e(_rootElementOffset,this,offset(this.hot.rootElement).left);const m=_classPrivateFieldGet$f(_hasRowHeaders,this)?-1:0,C=n.holder.scrollTop+n.getColumnHeaderHeight(0)+1,y=e.col<_classPrivateFieldGet$f(_fixedColumnsStart,this),v=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),E=Math.abs(g-(this.hot.isRtl()?r.offsetWidth:0)),$=this.getColumnsWidth(h,e.col-1)+E,O=this.getColumnsWidth(m,h-1)+(y?v:0)+$;_classPrivateFieldGet$f(_backlight$1,this).setPosition(C,O),_classPrivateFieldGet$f(_backlight$1,this).setSize(this.getColumnsWidth(h,f),n.hider.offsetHeight-C),_classPrivateFieldGet$f(_backlight$1,this).setOffset(null,-$),addClass$1(this.hot.rootElement,CSS_ON_MOVING$1)}else removeClass$1(this.hot.rootElement,CSS_AFTER_SELECTION$1),_classPrivateFieldSet$e(_pressed$3,this,!1),_classPrivateFieldGet$f(_columnsToMove,this).length=0}function _onMouseMove$3(t){_classPrivateFieldGet$f(_pressed$3,this)&&(_classPrivateFieldGet$f(_target$1,this).eventPageX=t.pageX,this.refreshPositions())}function _onBeforeOnCellMouseOver$2(t,e,r,i){!this.hot.getSelectedRangeLast()||!_classPrivateFieldGet$f(_pressed$3,this)||(_classPrivateFieldGet$f(_columnsToMove,this).indexOf(e.col)>-1?removeClass$1(this.hot.rootElement,CSS_SHOW_UI$1):addClass$1(this.hot.rootElement,CSS_SHOW_UI$1),i.row=!0,i.column=!0,i.cell=!0,_classPrivateFieldSet$e(_hoveredColumn,this,e.col),_classPrivateFieldGet$f(_target$1,this).TD=r)}function _onMouseUp$3(){const t=_classPrivateFieldGet$f(_target$1,this).col,e=_classPrivateFieldGet$f(_columnsToMove,this).length;if(_classPrivateFieldSet$e(_hoveredColumn,this,void 0),_classPrivateFieldSet$e(_pressed$3,this,!1),removeClass$1(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1,CSS_AFTER_SELECTION$1]),this.hot.selection.isSelectedByColumnHeader()&&addClass$1(this.hot.rootElement,CSS_AFTER_SELECTION$1),e<1||t===void 0)return;const r=_classPrivateFieldGet$f(_columnsToMove,this)[0],i=this.hot.toPhysicalColumn(r),n=this.dragColumns(_classPrivateFieldGet$f(_columnsToMove,this),t);if(_classPrivateFieldGet$f(_columnsToMove,this).length=0,n===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(i),o=s+e-1;this.hot.selectColumns(s,o)}}function _onAfterScrollVertically(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,r=t.holder.scrollTop,i=e+r;_classPrivateFieldGet$f(_backlight$1,this).setPosition(i),_classPrivateFieldGet$f(_backlight$1,this).setSize(null,t.hider.offsetHeight-i)}function _onAfterLoadData$2(){this.moveBySettingsOrLoad()}function _classPrivateMethodInitSpec$d(t,e){_checkPrivateRedeclaration$j(t,e),e.add(t)}function _classPrivateFieldInitSpec$e(t,e,r){_checkPrivateRedeclaration$j(t,e),e.set(t,r)}function _checkPrivateRedeclaration$j(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$d(t,e,r){return t.set(_assertClassBrand$j(t,e),r),r}function _classPrivateFieldGet$e(t,e){return t.get(_assertClassBrand$j(t,e))}function _assertClassBrand$j(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$d="manualColumnResize",PLUGIN_PRIORITY$d=130,PERSISTENT_STATE_KEY$1="manualColumnWidths";var _currentTH$1=new WeakMap,_currentCol=new WeakMap,_selectedCols=new WeakMap,_currentWidth=new WeakMap,_newSize$1=new WeakMap,_startY$1=new WeakMap,_startWidth=new WeakMap,_startOffset$1=new WeakMap,_handle$1=new WeakMap,_guide$1=new WeakMap,_pressed$2=new WeakMap,_isTriggeredByRMB$1=new WeakMap,_dblclick$1=new WeakMap,_autoresizeTimeout$1=new WeakMap,_columnWidthsMap=new WeakMap,_config$1=new WeakMap,_ManualColumnResize_brand=new WeakSet;class ManualColumnResize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$d}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$d}constructor(e){super(e),_classPrivateMethodInitSpec$d(this,_ManualColumnResize_brand),_classPrivateFieldInitSpec$e(this,_currentTH$1,null),_classPrivateFieldInitSpec$e(this,_currentCol,null),_classPrivateFieldInitSpec$e(this,_selectedCols,[]),_classPrivateFieldInitSpec$e(this,_currentWidth,null),_classPrivateFieldInitSpec$e(this,_newSize$1,null),_classPrivateFieldInitSpec$e(this,_startY$1,null),_classPrivateFieldInitSpec$e(this,_startWidth,null),_classPrivateFieldInitSpec$e(this,_startOffset$1,null),_classPrivateFieldInitSpec$e(this,_handle$1,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$e(this,_guide$1,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$e(this,_pressed$2,null),_classPrivateFieldInitSpec$e(this,_isTriggeredByRMB$1,!1),_classPrivateFieldInitSpec$e(this,_dblclick$1,0),_classPrivateFieldInitSpec$e(this,_autoresizeTimeout$1,null),_classPrivateFieldInitSpec$e(this,_columnWidthsMap,void 0),_classPrivateFieldInitSpec$e(this,_config$1,void 0),addClass$1(_classPrivateFieldGet$e(_handle$1,this),"manualColumnResizer"),addClass$1(_classPrivateFieldGet$e(_guide$1,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$d]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldSet$d(_columnWidthsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet$e(_columnWidthsMap,this).addLocalHook("init",()=>_assertClassBrand$j(_ManualColumnResize_brand,this,_onMapInit$2).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$e(_columnWidthsMap,this)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$j(_ManualColumnResize_brand,e,_onModifyColWidth$2).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$j(_ManualColumnResize_brand,e,_onBeforeStretchingColumnWidth).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$j(_ManualColumnResize_brand,e,_onBeforeColumnResize).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet$d(_config$1,this,_classPrivateFieldGet$e(_columnWidthsMap,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY$1,_classPrivateFieldGet$e(_columnWidthsMap,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY$1,e),e.value}setManualSize(e,r){const i=Math.max(r,20),n=this.hot.toPhysicalColumn(e);return _classPrivateFieldGet$e(_columnWidthsMap,this).setValueAtIndex(n,i),i}clearManualSize(e){const r=this.hot.toPhysicalColumn(e);_classPrivateFieldGet$e(_columnWidthsMap,this).setValueAtIndex(r,null)}setupHandlePosition(e){if(!e.parentNode)return;_classPrivateFieldSet$d(_currentTH$1,this,e);const{_wt:r}=this.hot.view,i=r.wtTable.getCoords(_classPrivateFieldGet$e(_currentTH$1,this)),n=i.col;if(n<0)return;const s=outerHeight(_classPrivateFieldGet$e(_currentTH$1,this)),o=_classPrivateFieldGet$e(_currentTH$1,this).getBoundingClientRect(),a=n<r.getSetting("fixedColumnsStart");let l;a&&(l=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$e(_currentTH$1,this),i.row,i.col)),l||(l=r.wtOverlays.topOverlay.getRelativeCellPosition(_classPrivateFieldGet$e(_currentTH$1,this),i.row,i.col)),_classPrivateFieldSet$d(_currentCol,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)),_classPrivateFieldSet$d(_selectedCols,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){const u=this.hot.getSelectedRange();arrayEach(u,d=>{const h=d.getTopStartCorner().col,f=d.getBottomEndCorner().col;rangeEach(h,f,g=>{_classPrivateFieldGet$e(_selectedCols,this).includes(g)||_classPrivateFieldGet$e(_selectedCols,this).push(g)})})}_classPrivateFieldGet$e(_selectedCols,this).includes(_classPrivateFieldGet$e(_currentCol,this))||_classPrivateFieldSet$d(_selectedCols,this,[_classPrivateFieldGet$e(_currentCol,this)]),_classPrivateFieldSet$d(_startOffset$1,this,l.start-6),_classPrivateFieldSet$d(_startWidth,this,parseInt(o.width,10)),_classPrivateFieldGet$e(_handle$1,this).style.top=`${l.top}px`,_classPrivateFieldGet$e(_handle$1,this).style[this.inlineDir]=`${_classPrivateFieldGet$e(_startOffset$1,this)+_classPrivateFieldGet$e(_startWidth,this)}px`,_classPrivateFieldGet$e(_handle$1,this).style.height=`${s}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$e(_handle$1,this))}refreshHandlePosition(){_classPrivateFieldGet$e(_handle$1,this).style[this.inlineDir]=`${_classPrivateFieldGet$e(_startOffset$1,this)+_classPrivateFieldGet$e(_currentWidth,this)}px`}setupGuidePosition(){const e=parseInt(outerHeight(_classPrivateFieldGet$e(_handle$1,this)),10),r=parseInt(_classPrivateFieldGet$e(_handle$1,this).style.top,10)+e,i=this.hot.view.getTableHeight();addClass$1(_classPrivateFieldGet$e(_handle$1,this),"active"),addClass$1(_classPrivateFieldGet$e(_guide$1,this),"active"),_classPrivateFieldGet$e(_guide$1,this).style.top=`${r}px`,this.refreshGuidePosition(),_classPrivateFieldGet$e(_guide$1,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$e(_guide$1,this))}refreshGuidePosition(){_classPrivateFieldGet$e(_guide$1,this).style[this.inlineDir]=_classPrivateFieldGet$e(_handle$1,this).style[this.inlineDir]}hideHandleAndGuide(){removeClass$1(_classPrivateFieldGet$e(_handle$1,this),"active"),removeClass$1(_classPrivateFieldGet$e(_guide$1,this),"active")}checkIfColumnHeader(e){const r=closest(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,n.clone.wtTable.THEAD].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},r=(i,n)=>{const s=this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet$e(_newSize$1,this),i,!0);s!==void 0&&_classPrivateFieldSet$d(_newSize$1,this,s),this.setManualSize(i,_classPrivateFieldGet$e(_newSize$1,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet$e(_newSize$1,this),i,!0),n&&e()};_classPrivateFieldGet$e(_dblclick$1,this)>=2&&(_classPrivateFieldGet$e(_selectedCols,this).length>1?(arrayEach(_classPrivateFieldGet$e(_selectedCols,this),n=>{r(n)}),e()):arrayEach(_classPrivateFieldGet$e(_selectedCols,this),n=>{r(n,!0)})),_classPrivateFieldSet$d(_dblclick$1,this,0),_classPrivateFieldSet$d(_autoresizeTimeout$1,this,null)}bindEvents(){const{rootWindow:e,rootElement:r}=this.hot;this.eventManager.addEventListener(r,"mouseover",i=>_assertClassBrand$j(_ManualColumnResize_brand,this,_onMouseOver$1).call(this,i)),this.eventManager.addEventListener(r,"mousedown",i=>_assertClassBrand$j(_ManualColumnResize_brand,this,_onMouseDown$1).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>_assertClassBrand$j(_ManualColumnResize_brand,this,_onMouseMove$2).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$j(_ManualColumnResize_brand,this,_onMouseUp$2).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet$e(_handle$1,this),"contextmenu",()=>_assertClassBrand$j(_ManualColumnResize_brand,this,_onContextMenu$1).call(this))}destroy(){super.destroy()}}function _onMapInit$2(){const t=this.hot.getSettings()[PLUGIN_KEY$d],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((r,i)=>{_classPrivateFieldGet$e(_columnWidthsMap,this).setValueAtIndex(i,r)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((r,i)=>{_classPrivateFieldGet$e(_columnWidthsMap,this).setValueAtIndex(i,r)})},!0),_classPrivateFieldSet$d(_config$1,this,t)):t===!0&&Array.isArray(_classPrivateFieldGet$e(_config$1,this))&&this.hot.batchExecution(()=>{_classPrivateFieldGet$e(_config$1,this).forEach((r,i)=>{_classPrivateFieldGet$e(_columnWidthsMap,this).setValueAtIndex(i,r)})},!0)}function _onMouseOver$1(t){if(!isDetached(t.target)&&_classPrivateFieldGet$e(_isTriggeredByRMB$1,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const r=e.getAttribute("colspan");e&&(r===null||r==="1")&&(_classPrivateFieldGet$e(_pressed$2,this)||this.setupHandlePosition(e))}}function _onMouseDown$1(t){t.target.parentNode===this.hot.rootElement&&hasClass$1(t.target,"manualColumnResizer")&&(this.setupHandlePosition(_classPrivateFieldGet$e(_currentTH$1,this)),this.setupGuidePosition(),_classPrivateFieldSet$d(_pressed$2,this,!0),_classPrivateFieldGet$e(_autoresizeTimeout$1,this)===null&&(_classPrivateFieldSet$d(_autoresizeTimeout$1,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet$e(_autoresizeTimeout$1,this))),_classPrivateFieldSet$d(_dblclick$1,this,_classPrivateFieldGet$e(_dblclick$1,this)+1),this.startX=t.pageX,_classPrivateFieldSet$d(_newSize$1,this,_classPrivateFieldGet$e(_startWidth,this)))}function _onMouseMove$2(t){if(_classPrivateFieldGet$e(_pressed$2,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();_classPrivateFieldSet$d(_currentWidth,this,_classPrivateFieldGet$e(_startWidth,this)+e),arrayEach(_classPrivateFieldGet$e(_selectedCols,this),r=>{_classPrivateFieldSet$d(_newSize$1,this,this.setManualSize(r,_classPrivateFieldGet$e(_currentWidth,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function _onMouseUp$2(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(r,i)=>{this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet$e(_newSize$1,this),r,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet$e(_newSize$1,this),r,!1)};_classPrivateFieldGet$e(_pressed$2,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet$d(_pressed$2,this,!1),_classPrivateFieldGet$e(_newSize$1,this)!==_classPrivateFieldGet$e(_startWidth,this)&&(_classPrivateFieldGet$e(_selectedCols,this).length>1?(arrayEach(_classPrivateFieldGet$e(_selectedCols,this),i=>{e(i)}),t()):arrayEach(_classPrivateFieldGet$e(_selectedCols,this),i=>{e(i,!0)})),this.setupHandlePosition(_classPrivateFieldGet$e(_currentTH$1,this)))}function _onContextMenu$1(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet$e(_handle$1,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet$e(_guide$1,this)),_classPrivateFieldSet$d(_pressed$2,this,!1),_classPrivateFieldSet$d(_isTriggeredByRMB$1,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet$d(_isTriggeredByRMB$1,this,!1)})}function _onModifyColWidth$2(t,e){let r=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),n=_classPrivateFieldGet$e(_columnWidthsMap,this).getValueAtIndex(i);this.hot.getSettings()[PLUGIN_KEY$d]&&n&&(r=n)}return r}function _onBeforeStretchingColumnWidth(t,e){const r=_classPrivateFieldGet$e(_columnWidthsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof r=="number"?r:t}function _onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function _defineProperty$A(t,e,r){return(e=_toPropertyKey$A(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$A(t){var e=_toPrimitive$A(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$A(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const STATE_INITIALIZED=0,STATE_BUILT=1,STATE_APPENDED=2,UNIT="px";let BaseUI$1=class{constructor(e){_defineProperty$A(this,"hot",void 0),_defineProperty$A(this,"_element",null),_defineProperty$A(this,"state",STATE_INITIALIZED),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=STATE_APPENDED}build(){this.state===STATE_INITIALIZED&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED}isAppended(){return this.state===STATE_APPENDED}isBuilt(){return this.state>=STATE_BUILT}setPosition(e,r){e!==void 0&&(this._element.style.top=e+UNIT),r!==void 0&&(this._element.style.left=r+UNIT)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,r){e&&(this._element.style.width=e+UNIT),r&&(this._element.style.height=r+UNIT)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){e&&(this._element.style.marginTop=e+UNIT),r&&(this._element.style.marginLeft=r+UNIT)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const CSS_CLASSNAME$1="ht__manualRowMove--backlight";class BacklightUI extends BaseUI$1{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$1)}}const CSS_CLASSNAME="ht__manualRowMove--guideline";class GuidelineUI extends BaseUI$1{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME)}}function _classPrivateMethodInitSpec$c(t,e){_checkPrivateRedeclaration$i(t,e),e.add(t)}function _classPrivateFieldInitSpec$d(t,e,r){_checkPrivateRedeclaration$i(t,e),e.set(t,r)}function _checkPrivateRedeclaration$i(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$c(t,e,r){return t.set(_assertClassBrand$i(t,e),r),r}function _classPrivateFieldGet$d(t,e){return t.get(_assertClassBrand$i(t,e))}function _assertClassBrand$i(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeRowMove");Hooks.getSingleton().register("afterRowMove");const PLUGIN_KEY$c="manualRowMove",PLUGIN_PRIORITY$c=140,CSS_PLUGIN="ht__manualRowMove",CSS_SHOW_UI="show-ui",CSS_ON_MOVING="on-moving--rows",CSS_AFTER_SELECTION="after-selection--rows";var _backlight=new WeakMap,_guideline=new WeakMap,_rowsToMove=new WeakMap,_pressed$1=new WeakMap,_target=new WeakMap,_cachedDropIndex=new WeakMap,_ManualRowMove_brand=new WeakSet;class ManualRowMove extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$c(this,_ManualRowMove_brand),_classPrivateFieldInitSpec$d(this,_backlight,new BacklightUI(this.hot)),_classPrivateFieldInitSpec$d(this,_guideline,new GuidelineUI(this.hot)),_classPrivateFieldInitSpec$d(this,_rowsToMove,[]),_classPrivateFieldInitSpec$d(this,_pressed$1,void 0),_classPrivateFieldInitSpec$d(this,_target,{}),_classPrivateFieldInitSpec$d(this,_cachedDropIndex,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$c}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$c}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$c]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$i(_ManualRowMove_brand,e,_onBeforeOnCellMouseDown$2).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$i(_ManualRowMove_brand,e,_onBeforeOnCellMouseOver$1).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>_assertClassBrand$i(_ManualRowMove_brand,this,_onAfterScrollHorizontally).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$i(_ManualRowMove_brand,e,_onAfterLoadData$1).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),addClass$1(this.hot.rootElement,CSS_PLUGIN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass$1(this.hot.rootElement,CSS_PLUGIN),this.unregisterEvents(),_classPrivateFieldGet$d(_backlight,this).destroy(),_classPrivateFieldGet$d(_guideline,this).destroy(),super.disablePlugin()}moveRow(e,r){return this.moveRows([e],r)}moveRows(e,r){const i=_classPrivateFieldGet$d(_cachedDropIndex,this),n=this.isMovePossible(e,r),s=this.hot.runHooks("beforeRowMove",e,r,i,n);if(_classPrivateFieldSet$c(_cachedDropIndex,this,void 0),s===!1)return;n&&this.hot.rowIndexMapper.moveIndexes(e,r);const o=n&&this.isRowOrderChanged(e,r);return this.hot.runHooks("afterRowMove",e,r,i,n,o),o}dragRow(e,r){return this.dragRows([e],r)}dragRows(e,r){const i=this.countFinalIndex(e,r);return _classPrivateFieldSet$c(_cachedDropIndex,this,r),this.moveRows(e,i)}isMovePossible(e,r){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),n=e.length+r>i,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=i);return!(n||s||o||a)}isRowOrderChanged(e,r){return e.some((i,n)=>i-n!==r)}countFinalIndex(e,r){const i=arrayReduce(e,(n,s)=>(s<r&&(n+=1),n),0);return r-i}getRowsHeight(e,r){const i=this.hot.rowIndexMapper;let n=0;for(let s=e;s<=r;s++){const o=i.getRenderableFromVisualIndex(s);o!==null&&(n+=this.hot.view._wt.wtTable.getRowHeight(o)||this.hot.stylesHandler.getDefaultRowHeight())}return n}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PLUGIN_KEY$c];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),r=[];if(!e)return r;const{from:i,to:n}=e,s=Math.min(i.row,n.row),o=Math.max(i.row,n.row);return rangeEach(s,o,a=>{r.push(a)}),r}refreshPositions(){const e=_classPrivateFieldGet$d(_target,this).coords,r=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),n=this.hot.countRows();this.isFixedRowTop(e.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(e.row)&&i<n&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=_classPrivateFieldGet$d(_target,this).TD,a=this.hot.rootElement,l=offset(a),c=getTrimmingContainer(a),u=s.holder.scrollTop,d=this.hot.rootWindow!==c?c.scrollTop:0,h=l.top-d,f=_classPrivateFieldGet$d(_target,this).eventPageY-h+u,g=s.hider.offsetHeight,m=s.TBODY.offsetTop,C=_classPrivateFieldGet$d(_backlight,this).getOffset().top,y=_classPrivateFieldGet$d(_backlight,this).getSize().height,v=o.offsetHeight/2,E=o.offsetHeight;let $=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const O=f>=$+v;this.isFixedRowTop(e.row)&&($+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?_classPrivateFieldGet$d(_target,this).row=r>0?r-1:r:O?(_classPrivateFieldGet$d(_target,this).row=e.row+1,$+=e.row===0?E-1:E):_classPrivateFieldGet$d(_target,this).row=e.row;let P=f,I=$;f+y+C>=g?P=g-y-C:f+C<m&&(P=m+Math.abs(C)),$>=g-1&&(I=g-1),_classPrivateFieldGet$d(_backlight,this).setPosition(P),_classPrivateFieldGet$d(_guideline,this).setPosition(I)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>_assertClassBrand$i(_ManualRowMove_brand,this,_onMouseMove$1).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$i(_ManualRowMove_brand,this,_onMouseUp$1).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet$d(_backlight,this).build(),_classPrivateFieldGet$d(_guideline,this).build()}destroy(){_classPrivateFieldGet$d(_backlight,this).destroy(),_classPrivateFieldGet$d(_guideline,this).destroy(),super.destroy()}}function _onBeforeOnCellMouseDown$2(t,e,r,i){const{wtTable:n,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||_classPrivateFieldGet$d(_pressed$1,this)||t.button!==0){_classPrivateFieldSet$c(_pressed$1,this,!1),_classPrivateFieldGet$d(_rowsToMove,this).length=0,removeClass$1(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI]);return}const l=_classPrivateFieldGet$d(_guideline,this).isBuilt()&&!_classPrivateFieldGet$d(_guideline,this).isAppended(),c=_classPrivateFieldGet$d(_backlight,this).isBuilt()&&!_classPrivateFieldGet$d(_backlight,this).isAppended();l&&c&&(_classPrivateFieldGet$d(_guideline,this).appendTo(n.hider),_classPrivateFieldGet$d(_backlight,this).appendTo(n.hider));const{from:u,to:d}=a,h=Math.min(u.row,d.row),f=Math.max(u.row,d.row);if(e.col<0&&e.row>=h&&e.row<=f){i.row=!0,_classPrivateFieldSet$c(_pressed$1,this,!0),_classPrivateFieldGet$d(_target,this).eventPageY=t.pageY,_classPrivateFieldGet$d(_target,this).coords=e,_classPrivateFieldGet$d(_target,this).TD=r,_classPrivateFieldSet$c(_rowsToMove,this,this.prepareRowsToMoving());const g=n.holder.scrollLeft+s.getRowHeaderWidth(),m=this.getRowsHeight(h,e.row-1)+(t.clientY-r.getBoundingClientRect().top);_classPrivateFieldGet$d(_backlight,this).setPosition(null,g),_classPrivateFieldGet$d(_backlight,this).setSize(n.hider.offsetWidth-g,this.getRowsHeight(h,f)),_classPrivateFieldGet$d(_backlight,this).setOffset(-m,null),addClass$1(this.hot.rootElement,CSS_ON_MOVING),this.refreshPositions()}else removeClass$1(this.hot.rootElement,CSS_AFTER_SELECTION),_classPrivateFieldSet$c(_pressed$1,this,!1),_classPrivateFieldGet$d(_rowsToMove,this).length=0}function _onMouseMove$1(t){_classPrivateFieldGet$d(_pressed$1,this)&&(_classPrivateFieldGet$d(_target,this).eventPageY=t.pageY,this.refreshPositions())}function _onBeforeOnCellMouseOver$1(t,e,r,i){!this.hot.getSelectedRangeLast()||!_classPrivateFieldGet$d(_pressed$1,this)||(_classPrivateFieldGet$d(_rowsToMove,this).indexOf(e.row)>-1?removeClass$1(this.hot.rootElement,CSS_SHOW_UI):addClass$1(this.hot.rootElement,CSS_SHOW_UI),i.row=!0,i.column=!0,i.cell=!0,_classPrivateFieldGet$d(_target,this).coords=e,_classPrivateFieldGet$d(_target,this).TD=r)}function _onMouseUp$1(){const t=_classPrivateFieldGet$d(_target,this).row,e=_classPrivateFieldGet$d(_rowsToMove,this).length;if(_classPrivateFieldSet$c(_pressed$1,this,!1),removeClass$1(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI,CSS_AFTER_SELECTION]),this.hot.selection.isSelectedByRowHeader()&&addClass$1(this.hot.rootElement,CSS_AFTER_SELECTION),e<1||t===void 0)return;const r=_classPrivateFieldGet$d(_rowsToMove,this)[0],i=this.hot.toPhysicalRow(r),n=this.dragRows(_classPrivateFieldGet$d(_rowsToMove,this),t);if(_classPrivateFieldGet$d(_rowsToMove,this).length=0,n===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(i),o=s+e-1;this.hot.selectRows(s,o)}}function _onAfterScrollHorizontally(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=t.holder.scrollLeft,i=e+r;_classPrivateFieldGet$d(_backlight,this).setPosition(null,i),_classPrivateFieldGet$d(_backlight,this).setSize(t.hider.offsetWidth-i)}function _onAfterLoadData$1(){this.moveBySettingsOrLoad()}function _classPrivateMethodInitSpec$b(t,e){_checkPrivateRedeclaration$h(t,e),e.add(t)}function _classPrivateFieldInitSpec$c(t,e,r){_checkPrivateRedeclaration$h(t,e),e.set(t,r)}function _checkPrivateRedeclaration$h(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$b(t,e,r){return t.set(_assertClassBrand$h(t,e),r),r}function _classPrivateFieldGet$c(t,e){return t.get(_assertClassBrand$h(t,e))}function _assertClassBrand$h(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$b="manualRowResize",PLUGIN_PRIORITY$b=30,PERSISTENT_STATE_KEY="manualRowHeights";var _currentTH=new WeakMap,_currentRow=new WeakMap,_selectedRows=new WeakMap,_currentHeight=new WeakMap,_newSize=new WeakMap,_startY=new WeakMap,_startHeight=new WeakMap,_startOffset=new WeakMap,_handle=new WeakMap,_guide=new WeakMap,_pressed=new WeakMap,_isTriggeredByRMB=new WeakMap,_dblclick=new WeakMap,_autoresizeTimeout=new WeakMap,_rowHeightsMap=new WeakMap,_config=new WeakMap,_ManualRowResize_brand=new WeakSet;class ManualRowResize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$b}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$b}constructor(e){super(e),_classPrivateMethodInitSpec$b(this,_ManualRowResize_brand),_classPrivateFieldInitSpec$c(this,_currentTH,null),_classPrivateFieldInitSpec$c(this,_currentRow,null),_classPrivateFieldInitSpec$c(this,_selectedRows,[]),_classPrivateFieldInitSpec$c(this,_currentHeight,null),_classPrivateFieldInitSpec$c(this,_newSize,null),_classPrivateFieldInitSpec$c(this,_startY,null),_classPrivateFieldInitSpec$c(this,_startHeight,null),_classPrivateFieldInitSpec$c(this,_startOffset,null),_classPrivateFieldInitSpec$c(this,_handle,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$c(this,_guide,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$c(this,_pressed,!1),_classPrivateFieldInitSpec$c(this,_isTriggeredByRMB,!1),_classPrivateFieldInitSpec$c(this,_dblclick,0),_classPrivateFieldInitSpec$c(this,_autoresizeTimeout,null),_classPrivateFieldInitSpec$c(this,_rowHeightsMap,void 0),_classPrivateFieldInitSpec$c(this,_config,void 0),addClass$1(_classPrivateFieldGet$c(_handle,this),"manualRowResizer"),addClass$1(_classPrivateFieldGet$c(_guide,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$b]}enablePlugin(){this.enabled||(_classPrivateFieldSet$b(_rowHeightsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet$c(_rowHeightsMap,this).addLocalHook("init",()=>_assertClassBrand$h(_ManualRowResize_brand,this,_onMapInit$1).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$c(_rowHeightsMap,this)),this.addHook("modifyRowHeight",(e,r)=>_assertClassBrand$h(_ManualRowResize_brand,this,_onModifyRowHeight).call(this,e,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet$b(_config,this,_classPrivateFieldGet$c(_rowHeightsMap,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY,_classPrivateFieldGet$c(_rowHeightsMap,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY,e),e.value}setManualSize(e,r){const i=this.hot.toPhysicalRow(e),n=Math.max(r,this.hot.stylesHandler.getDefaultRowHeight());return _classPrivateFieldGet$c(_rowHeightsMap,this).setValueAtIndex(i,n),n}getLastDesiredRowHeight(){return _classPrivateFieldGet$c(_currentHeight,this)}setupHandlePosition(e){_classPrivateFieldSet$b(_currentTH,this,e);const{view:r}=this.hot,{_wt:i}=r,n=i.wtTable.getCoords(_classPrivateFieldGet$c(_currentTH,this)),s=n.row;if(s<0)return;const o=outerWidth(_classPrivateFieldGet$c(_currentTH,this)),a=_classPrivateFieldGet$c(_currentTH,this).getBoundingClientRect(),l=s<i.getSetting("fixedRowsTop"),c=s>=r.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let u;l?u=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$c(_currentTH,this),n.row,n.col):c&&(u=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$c(_currentTH,this),n.row,n.col)),u||(u=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(_classPrivateFieldGet$c(_currentTH,this),n.row,n.col)),_classPrivateFieldSet$b(_currentRow,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),_classPrivateFieldSet$b(_selectedRows,this,[]);const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&d){const h=this.hot.getSelectedRange();arrayEach(h,f=>{const g=f.getTopStartCorner().row,m=f.getBottomStartCorner().row;rangeEach(g,m,C=>{_classPrivateFieldGet$c(_selectedRows,this).includes(C)||_classPrivateFieldGet$c(_selectedRows,this).push(C)})})}_classPrivateFieldGet$c(_selectedRows,this).includes(_classPrivateFieldGet$c(_currentRow,this))||_classPrivateFieldSet$b(_selectedRows,this,[_classPrivateFieldGet$c(_currentRow,this)]),_classPrivateFieldSet$b(_startOffset,this,u.top-6),_classPrivateFieldSet$b(_startHeight,this,parseInt(a.height,10)),_classPrivateFieldGet$c(_handle,this).style.top=`${_classPrivateFieldGet$c(_startOffset,this)+_classPrivateFieldGet$c(_startHeight,this)}px`,_classPrivateFieldGet$c(_handle,this).style[this.inlineDir]=`${u.start}px`,_classPrivateFieldGet$c(_handle,this).style.width=`${o}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$c(_handle,this))}refreshHandlePosition(){_classPrivateFieldGet$c(_handle,this).style.top=`${_classPrivateFieldGet$c(_startOffset,this)+_classPrivateFieldGet$c(_currentHeight,this)}px`}setupGuidePosition(){const e=parseInt(outerWidth(_classPrivateFieldGet$c(_handle,this)),10),r=parseInt(_classPrivateFieldGet$c(_handle,this).style[this.inlineDir],10)+e,i=this.hot.view.getTableWidth();addClass$1(_classPrivateFieldGet$c(_handle,this),"active"),addClass$1(_classPrivateFieldGet$c(_guide,this),"active"),_classPrivateFieldGet$c(_guide,this).style.top=_classPrivateFieldGet$c(_handle,this).style.top,_classPrivateFieldGet$c(_guide,this).style[this.inlineDir]=`${r}px`,_classPrivateFieldGet$c(_guide,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$c(_guide,this))}refreshGuidePosition(){_classPrivateFieldGet$c(_guide,this).style.top=_classPrivateFieldGet$c(_handle,this).style.top}hideHandleAndGuide(){removeClass$1(_classPrivateFieldGet$c(_handle,this),"active"),removeClass$1(_classPrivateFieldGet$c(_guide,this),"active")}checkIfRowHeader(e){const r=closest(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,n.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const r=this.hot.view._wt.wtTable.getRowHeight(e);return r!==void 0&&_classPrivateFieldGet$c(_newSize,this)<r?r:_classPrivateFieldGet$c(_newSize,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},r=(i,n)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);s!==void 0&&_classPrivateFieldSet$b(_newSize,this,s),this.setManualSize(i,_classPrivateFieldGet$c(_newSize,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),n&&e()};_classPrivateFieldGet$c(_dblclick,this)>=2&&(_classPrivateFieldGet$c(_selectedRows,this).length>1?(arrayEach(_classPrivateFieldGet$c(_selectedRows,this),n=>{r(n)}),e()):arrayEach(_classPrivateFieldGet$c(_selectedRows,this),n=>{r(n,!0)})),_classPrivateFieldSet$b(_dblclick,this,0),_classPrivateFieldSet$b(_autoresizeTimeout,this,null)}bindEvents(){const{rootElement:e,rootWindow:r}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>_assertClassBrand$h(_ManualRowResize_brand,this,_onMouseOver).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>_assertClassBrand$h(_ManualRowResize_brand,this,_onMouseDown).call(this,i)),this.eventManager.addEventListener(r,"mousemove",i=>_assertClassBrand$h(_ManualRowResize_brand,this,_onMouseMove).call(this,i)),this.eventManager.addEventListener(r,"mouseup",()=>_assertClassBrand$h(_ManualRowResize_brand,this,_onMouseUp).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet$c(_handle,this),"contextmenu",()=>_assertClassBrand$h(_ManualRowResize_brand,this,_onContextMenu).call(this))}destroy(){super.destroy()}}function _onMouseOver(t){if(!isDetached(t.target)&&_classPrivateFieldGet$c(_isTriggeredByRMB,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(_classPrivateFieldGet$c(_pressed,this)||this.setupHandlePosition(e))}}function _onMouseDown(t){hasClass$1(t.target,"manualRowResizer")&&(this.setupHandlePosition(_classPrivateFieldGet$c(_currentTH,this)),this.setupGuidePosition(),_classPrivateFieldSet$b(_pressed,this,!0),_classPrivateFieldGet$c(_autoresizeTimeout,this)===null&&(_classPrivateFieldSet$b(_autoresizeTimeout,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet$c(_autoresizeTimeout,this))),_classPrivateFieldSet$b(_dblclick,this,_classPrivateFieldGet$c(_dblclick,this)+1),_classPrivateFieldSet$b(_startY,this,t.pageY),_classPrivateFieldSet$b(_newSize,this,_classPrivateFieldGet$c(_startHeight,this)))}function _onMouseMove(t){_classPrivateFieldGet$c(_pressed,this)&&(_classPrivateFieldSet$b(_currentHeight,this,_classPrivateFieldGet$c(_startHeight,this)+(t.pageY-_classPrivateFieldGet$c(_startY,this))),arrayEach(_classPrivateFieldGet$c(_selectedRows,this),e=>{_classPrivateFieldSet$b(_newSize,this,this.setManualSize(e,_classPrivateFieldGet$c(_currentHeight,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function _onMouseUp(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(r,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};_classPrivateFieldGet$c(_pressed,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet$b(_pressed,this,!1),_classPrivateFieldGet$c(_newSize,this)!==_classPrivateFieldGet$c(_startHeight,this)&&(_classPrivateFieldGet$c(_selectedRows,this).length>1?(arrayEach(_classPrivateFieldGet$c(_selectedRows,this),i=>{e(i)}),t()):arrayEach(_classPrivateFieldGet$c(_selectedRows,this),i=>{e(i,!0)})),this.setupHandlePosition(_classPrivateFieldGet$c(_currentTH,this)))}function _onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet$c(_handle,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet$c(_guide,this)),_classPrivateFieldSet$b(_pressed,this,!1),_classPrivateFieldSet$b(_isTriggeredByRMB,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet$b(_isTriggeredByRMB,this,!1)})}function _onModifyRowHeight(t,e){let r=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),n=_classPrivateFieldGet$c(_rowHeightsMap,this).getValueAtIndex(i);this.hot.getSettings()[PLUGIN_KEY$b]&&n&&(r=n)}return r}function _onMapInit$1(){const t=this.hot.getSettings()[PLUGIN_KEY$b],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((r,i)=>{_classPrivateFieldGet$c(_rowHeightsMap,this).setValueAtIndex(i,r)}):Array.isArray(t)?(t.forEach((r,i)=>{_classPrivateFieldGet$c(_rowHeightsMap,this).setValueAtIndex(i,r)}),_classPrivateFieldSet$b(_config,this,t)):t===!0&&Array.isArray(_classPrivateFieldGet$c(_config,this))&&_classPrivateFieldGet$c(_config,this).forEach((r,i)=>{_classPrivateFieldGet$c(_rowHeightsMap,this).setValueAtIndex(i,r)})},!0)}var es_array_unscopables_flatMap={},hasRequiredEs_array_unscopables_flatMap;function requireEs_array_unscopables_flatMap(){if(hasRequiredEs_array_unscopables_flatMap)return es_array_unscopables_flatMap;hasRequiredEs_array_unscopables_flatMap=1;var t=requireAddToUnscopables();return t("flatMap"),es_array_unscopables_flatMap}requireEs_array_unscopables_flatMap();var esnext_iterator_flatMap={},es_iterator_flatMap={},getIteratorFlattenable,hasRequiredGetIteratorFlattenable;function requireGetIteratorFlattenable(){if(hasRequiredGetIteratorFlattenable)return getIteratorFlattenable;hasRequiredGetIteratorFlattenable=1;var t=requireFunctionCall(),e=requireAnObject(),r=requireGetIteratorDirect(),i=requireGetIteratorMethod();return getIteratorFlattenable=function(n,s){(!s||typeof n!="string")&&e(n);var o=i(n);return r(e(o!==void 0?t(o,n):n))},getIteratorFlattenable}var hasRequiredEs_iterator_flatMap;function requireEs_iterator_flatMap(){if(hasRequiredEs_iterator_flatMap)return es_iterator_flatMap;hasRequiredEs_iterator_flatMap=1;var t=require_export(),e=requireFunctionCall(),r=requireACallable(),i=requireAnObject(),n=requireGetIteratorDirect(),s=requireGetIteratorFlattenable(),o=requireIteratorCreateProxy(),a=requireIteratorClose(),l=requireIsPure(),c=requireIteratorHelperThrowsOnInvalidIterator(),u=requireIteratorHelperWithoutClosingOnEarlyError(),d=!l&&!c("flatMap",function(){}),h=!l&&!d&&u("flatMap",TypeError),f=l||d||h,g=o(function(){for(var m=this.iterator,C=this.mapper,y,v;;){if(v=this.inner)try{if(y=i(e(v.next,v.iterator)),!y.done)return y.value;this.inner=null}catch(E){a(m,"throw",E)}if(y=i(e(this.next,m)),this.done=!!y.done)return;try{this.inner=s(C(y.value,this.counter++),!1)}catch(E){a(m,"throw",E)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(C){i(this);try{r(C)}catch(y){a(this,"throw",y)}return h?e(h,this,C):new g(n(this),{mapper:C,inner:null})}}),es_iterator_flatMap}var hasRequiredEsnext_iterator_flatMap;function requireEsnext_iterator_flatMap(){return hasRequiredEsnext_iterator_flatMap||(hasRequiredEsnext_iterator_flatMap=1,requireEs_iterator_flatMap()),esnext_iterator_flatMap}requireEsnext_iterator_flatMap();function _classPrivateFieldInitSpec$b(t,e,r){_checkPrivateRedeclaration$g(t,e),e.set(t,r)}function _checkPrivateRedeclaration$g(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$z(t,e,r){return(e=_toPropertyKey$z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$z(t){var e=_toPrimitive$z(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$z(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$b(t,e){return t.get(_assertClassBrand$g(t,e))}function _classPrivateFieldSet$a(t,e,r){return t.set(_assertClassBrand$g(t,e),r),r}function _assertClassBrand$g(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _cellRange=new WeakMap;class MergedCellCoords{constructor(e,r,i,n,s,o){_defineProperty$z(this,"row",void 0),_defineProperty$z(this,"col",void 0),_defineProperty$z(this,"rowspan",void 0),_defineProperty$z(this,"colspan",void 0),_defineProperty$z(this,"removed",!1),_defineProperty$z(this,"cellCoordsFactory",void 0),_defineProperty$z(this,"cellRangeFactory",void 0),_classPrivateFieldInitSpec$b(this,_cellRange,null),this.row=e,this.col=r,this.rowspan=i,this.colspan=n,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:r,col:i,rowspan:n,colspan:s}=e;return toSingleLine`The merged cell declared with {row: ${r}, col: ${i},\x20
      rowspan: ${n}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:r,col:i}=e;return toSingleLine`The merged cell declared at [${r}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:r,col:i}=e;return toSingleLine`The merged cell declared at [${r}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:r,col:i}=e;return toSingleLine`The merged cell declared at [${r}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:r,col:i,rowspan:n,colspan:s}=e;return r<0||i<0||n<0||s<0}static isSingleCell(e){let{rowspan:r,colspan:i}=e;return i===1&&r===1}static containsZeroSpan(e){let{rowspan:r,colspan:i}=e;return i===0||r===0}static isOutOfBounds(e,r,i){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const r=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),_classPrivateFieldSet$a(_cellRange,this,null)}includes(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,r){const i=e[0]||e[1],n=r+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(r,n),l=Math.max(r,n),c=this[o],u=this[o]+this[s]-1;if(c>=r&&(this[o]+=i),i>0)r<=u&&r>c&&(this[s]+=i);else if(i<0){if(a<=c&&l>=u)return this.removed=!0,_classPrivateFieldSet$a(_cellRange,this,null),!1;if(c>=a&&c<=l){const d=l-c+1,h=Math.abs(i)-d;this[o]-=h+i,this[s]-=d}else if(c<=a&&u>=l)this[s]+=i;else if(c<=a&&u>=a&&u<l){const d=u-a+1;this[s]-=d}}return _classPrivateFieldSet$a(_cellRange,this,null),!0}isFarther(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return _classPrivateFieldGet$b(_cellRange,this)||_classPrivateFieldSet$a(_cellRange,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),_classPrivateFieldGet$b(_cellRange,this)}}function _classPrivateMethodInitSpec$a(t,e){_checkPrivateRedeclaration$f(t,e),e.add(t)}function _checkPrivateRedeclaration$f(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$y(t,e,r){return(e=_toPropertyKey$y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$y(t){var e=_toPrimitive$y(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$y(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$f(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _MergedCellsCollection_brand=new WeakSet;class MergedCellsCollection{constructor(e){_classPrivateMethodInitSpec$a(this,_MergedCellsCollection_brand),_defineProperty$y(this,"plugin",void 0),_defineProperty$y(this,"mergedCells",[]),_defineProperty$y(this,"mergedCellsMatrix",new Map),_defineProperty$y(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:r,col:i}=e;return toSingleLine`The merged cell declared at [${r}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,r){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(r))!==null&&i!==void 0?i:!1}getByRange(e){const{row:r,col:i}=e.getTopStartCorner(),{row:n,col:s}=e.getBottomEndCorner(),o=this.mergedCells.length;let a=!1;for(let l=0;l<o;l++){const c=this.mergedCells[l],{row:u,col:d,rowspan:h,colspan:f}=c;if(u>=r&&u+h-1<=n&&d>=i&&d+f-1<=s){a=c;break}}return a}filterOverlappingMergeCells(e){const r=new Set;return this.mergedCells.forEach(n=>{const{row:s,col:o,colspan:a,rowspan:l}=n;for(let c=s;c<s+l;c++)for(let u=o;u<o+a;u++)r.add(`r${c},c${u}`)}),e.filter(n=>{const{row:s,col:o,colspan:a,rowspan:l}=n,c=new Set;let u=!1;for(let d=s;d<s+l;d++){for(let h=o;h<o+a;h++){const f=`r${d},c${h}`;if(r.has(f)){warn(MergedCellsCollection.IS_OVERLAPPING_WARNING(n)),u=!0;break}c.add(f)}if(u)break}return u||r.add(...c),!u})}getWithinRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:n}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=i;l<=s;l++)for(let c=n;c<=o;c++){const u=this.get(l,c);u&&(r||!r&&u.row===l&&u.col===c)&&a.push(u)}return a}add(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,n=e.col,s=e.rowspan,o=e.colspan,a=new MergedCellCoords(i,n,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,n),c=r?!1:this.isOverlapping(a);return!l&&!c?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),_assertClassBrand$f(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,a),a):(c&&warn(MergedCellsCollection.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,r){const i=this.get(e,r),n=i?this.mergedCells.indexOf(i):-1;return i&&n!==-1?(this.mergedCells.splice(n,1),_assertClassBrand$f(_MergedCellsCollection_brand,this,_removeMergedCellFromMatrix).call(this,i),i):!1}clear(){arrayEach(this.mergedCells,e=>{let{row:r,col:i,rowspan:n,colspan:s}=e;rangeEach(r,r+n,o=>{rangeEach(i,i+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const r=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(r))return!0;return!1}isFirstRenderableMergedCell(e,r){const i=this.get(e,r);if(!i)return!1;const{row:n,col:s,rowspan:o,colspan:a}=i,l=this.hot.view.getActiveOverlayName(),c=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),u=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),d=clamp(c,n,n+o-1),h=clamp(u,s,s+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(d,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(h,1)===r}getFirstRenderableCoords(e,r){const i=this.get(e,r);if(!i||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);const n=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(n,s)}getStartMostColumnIndex(e,r){const i=_assertClassBrand$f(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"col",-1);let n=r;for(let s=0;s<i.length;s++)if(i[s]<=r){n=i[s];break}return n}getEndMostColumnIndex(e,r){const i=_assertClassBrand$f(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"col",1);let n=r;for(let s=0;s<i.length;s++)if(i[s]>=r){n=i[s];break}return n}getTopMostRowIndex(e,r){const i=_assertClassBrand$f(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"row",-1);let n=r;for(let s=0;s<i.length;s++)if(i[s]<=r){n=i[s];break}return n}getBottomMostRowIndex(e,r){const i=_assertClassBrand$f(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"row",1);let n=r;for(let s=0;s<i.length;s++)if(i[s]>=r){n=i[s];break}return n}shiftCollections(e,r,i){const n=[0,0];switch(e){case"right":n[0]+=i;break;case"left":n[0]-=i;break;case"down":n[1]+=i;break;case"up":n[1]-=i;break}const s=[];this.mergedCells.forEach(o=>{o.shift(n,r),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{_assertClassBrand$f(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,o)})}}function _getNonIntersectingIndexes(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,n=r===1?t.getTopStartCorner():t.getBottomEndCorner(),s=r===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=n.row;r===1?o<=s.row:o>=s.row;o+=r)for(let a=n.col;r===1?a<=s.col:a>=s.col;a+=r){const l=e==="row"?o:a,c=this.get(o,a);let u=l;c&&(u=r===1?c[e]+c[`${e}span`]-1:c[e]),i.has(l)||i.set(l,new Set),i.get(l).add(u)}return Array.from(new Set(Array.from(i.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function _addMergedCellToMatrix(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(r,t)}function _removeMergedCellFromMatrix(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.get(e).delete(r)}function _defineProperty$x(t,e,r){return(e=_toPropertyKey$x(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$x(t){var e=_toPrimitive$x(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$x(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AutofillCalculations{constructor(e){_defineProperty$x(this,"plugin",void 0),_defineProperty$x(this,"mergedCellsCollection",void 0),_defineProperty$x(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,r){let i=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?i="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?i="up":r[1]===e[1]&&r[2]===e[2]?i="right":i="left",i}snapDragArea(e,r,i,n){const s=r.slice(0),o=this.getAutofillSize(e,r,i),[a,l,c,u]=e,h=["up","down"].indexOf(i)>-1?c-a+1:u-l+1,f=Math.floor(o/h)*h,g=o-f,m=this.getFarthestCollection(e,r,i,n);if(m){if(i==="down"){const C=m.row+m.rowspan-a-g;s[2]+C>=this.plugin.hot.countRows()?s[2]-=g:s[2]+=g?C:0}else if(i==="right"){const C=m.col+m.colspan-l-g;s[3]+C>=this.plugin.hot.countCols()?s[3]-=g:s[3]+=g?C:0}else if(i==="up"){const C=c-g-m.row+1;s[0]+C<0?s[0]+=g:s[0]-=g?C:0}else if(i==="left"){const C=u-g-m.col+1;s[1]+C<0?s[1]+=g:s[1]-=g?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:n,fillSize:o,dragArea:s,cycleLength:h}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),extend$1(this.currentFillData,e)}getAutofillSize(e,r,i){const[n,s,o,a]=e,[l,c,u,d]=r;switch(i){case"up":return n-l;case"down":return u-o;case"left":return s-c;case"right":return d-a;default:return null}}getDragArea(e,r,i){const[n,s,o,a]=e,[l,c,u,d]=r;switch(i){case"up":return[l,c,n-1,a];case"down":{const h=this.mergedCellsCollection.get(u,a),f=h?h.rowspan-1:0;return[o+1,s,u+f,a]}case"left":return[l,c,o,s-1];case"right":{const h=this.mergedCellsCollection.get(u,a),f=h?h.colspan-1:0;return[n,a+f,u,d]}default:return null}}getFarthestCollection(e,r,i,n){const[s,o,a,l]=e,c=["up","down"].indexOf(i)>-1,u=c?a:l,d=c?s:o,h=this.getAutofillSize(e,r,i),f=c?a-s+1:l-o+1,g=Math.floor(h/f)*f,m=h-g;let C=null,y=null,v=null;switch(i){case"up":C="includesVertically",v=u-m+1;break;case"left":C="includesHorizontally",v=u-m+1;break;case"down":C="includesVertically",v=d+m-1;break;case"right":C="includesHorizontally",v=d+m-1;break}return arrayEach(n,E=>{E[C](v)&&E.isFarther(y,i)&&(y=E)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const r=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,n=this.currentFillData.dragDirection,s=(c,u)=>{switch(n){case"up":return c.row-u>=r.from.row;case"down":return c.row+c.rowspan-1+u<=r.to.row;case"left":return c.col-u>=r.from.column;case"right":return c.col+c.colspan-1+u<=r.to.column;default:return null}};let o=0,a=null,l=1;do for(let c=0;c<i.length;c+=1){if(a=i[c],o=l*this.currentFillData.cycleLength,s(a,o))switch(n){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan},!0);break}c===i.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const r={min:null,max:null},i={min:null,max:null};return arrayEach(e,n=>{const s=n[0],o=this.plugin.hot.propToCol(n[1]);(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s),(i.min===null||o<i.min)&&(i.min=o),(i.max===null||o>i.max)&&(i.max=o)}),{from:{row:r.min,column:i.min},to:{row:r.max,column:i.max}}}dragAreaOverlapsCollections(e,r,i){const n=this.getDragArea(e,r,i),[s,o,a,l]=n,c=this.plugin.hot._createCellCoords(s,o),u=this.plugin.hot._createCellCoords(a,l),d=this.plugin.hot._createCellRange(c,c,u);if(this.mergedCellsCollection.getWithinRange(d,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(d,!1);return f.length===0?!0:i==="up"||i==="down"?!f.every(g=>{let{colspan:m}=g;return m===d.getWidth()}):!f.every(g=>{let{rowspan:m}=g;return m===d.getHeight()})}}function _defineProperty$w(t,e,r){return(e=_toPropertyKey$w(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$w(t){var e=_toPrimitive$w(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$w(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SelectionCalculations{constructor(e){_defineProperty$w(this,"plugin",void 0),_defineProperty$w(this,"hot",void 0),_defineProperty$w(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,r,i,n){const s=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(n===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r))return;const u=this.plugin.mergedCellsCollection.get(e,r);if(!u)return;const d=u.getLastRow(),h=u.getLastColumn();if(s<=u.row&&o<=u.col&&a>=d&&l>=h)return`${this.fullySelectedMergedCellClassName}-${n}`;if(this.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,r){const i=[];if(!r||!e)return!1;for(let n=0;n<e.rowspan;n+=1)for(let s=0;s<e.colspan;s+=1)i.push(this.hot._createCellCoords(e.row+n,e.col+s));for(let n=0;n<i.length;n+=1){const s=[];for(let o=0;o<r.length;o+=1)s[o]=r[o].includes(i[n]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let r=0;r<=7;r+=1)e.push(`${this.fullySelectedMergedCellClassName}-${r}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function toggleMergeItem(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:i}=e;t.toggleMerge(e),this.selectCell(r.row,r.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?MergedCellCoords.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function _defineProperty$v(t,e,r){return(e=_toPropertyKey$v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$v(t){var e=_toPrimitive$v(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$v(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NodeStructure{constructor(e){_defineProperty$v(this,"data",void 0),_defineProperty$v(this,"next",null),_defineProperty$v(this,"prev",null),this.data=e}}class LinkedList{constructor(){_defineProperty$v(this,"first",null),_defineProperty$v(this,"last",null)}push(e){const r=new NodeStructure(e);if(this.first===null)this.first=r,this.last=r;else{const i=this.last;this.last=r,r.prev=i,i.next=r}return r}unshift(e){const r=new NodeStructure(e);if(this.first===null)this.first=r,this.last=r;else{const i=this.first;this.first=r,r.next=i,i.prev=r}}inorder(e){let r=this.first;for(;r;){const i=e(r);if(r===this.last||i===!0)break;r=r.next}}remove(e){if(this.first===null)return!1;let r=this.first,i,n;for(;r;){if(r.data===e)return i=r.next,n=r.prev,i&&(i.prev=n),n&&(n.next=i),r===this.first&&(this.first=i),r===this.last&&(this.last=n),!0;r=r.next}return!1}hasCycle(){let e=this.first,r=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,r=r.next,e===r)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,n){n&&(e(n,n.next),n.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const r=this.first;this.first=this.last,this.last=r}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,r=this.first,i;for(;e;)i=e.next,e.next=r,r.prev=e,r=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=r,this.last=i}}function _classPrivateMethodInitSpec$9(t,e){_checkPrivateRedeclaration$e(t,e),e.add(t)}function _classPrivateFieldInitSpec$a(t,e,r){_checkPrivateRedeclaration$e(t,e),e.set(t,r)}function _checkPrivateRedeclaration$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$a(t,e){return t.get(_assertClassBrand$e(t,e))}function _classPrivateFieldSet$9(t,e,r){return t.set(_assertClassBrand$e(t,e),r),r}function _assertClassBrand$e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _cellsHorizontalOrder=new WeakMap,_cellsVerticalOrder=new WeakMap,_currentHorizontalLinkedNode=new WeakMap,_currentVerticalLinkedNode=new WeakMap,_mergedCellsGetter=new WeakMap,_rowIndexMapper=new WeakMap,_columnIndexMapper=new WeakMap,_FocusOrder_brand=new WeakSet;class FocusOrder{constructor(e){let{mergedCellsGetter:r,rowIndexMapper:i,columnIndexMapper:n}=e;_classPrivateMethodInitSpec$9(this,_FocusOrder_brand),_classPrivateFieldInitSpec$a(this,_cellsHorizontalOrder,new LinkedList),_classPrivateFieldInitSpec$a(this,_cellsVerticalOrder,new LinkedList),_classPrivateFieldInitSpec$a(this,_currentHorizontalLinkedNode,null),_classPrivateFieldInitSpec$a(this,_currentVerticalLinkedNode,null),_classPrivateFieldInitSpec$a(this,_mergedCellsGetter,null),_classPrivateFieldInitSpec$a(this,_rowIndexMapper,null),_classPrivateFieldInitSpec$a(this,_columnIndexMapper,null),_classPrivateFieldSet$9(_mergedCellsGetter,this,r),_classPrivateFieldSet$9(_rowIndexMapper,this,i),_classPrivateFieldSet$9(_columnIndexMapper,this,n)}getCurrentVerticalNode(){return _classPrivateFieldGet$a(_currentVerticalLinkedNode,this).data}getFirstVerticalNode(){return _classPrivateFieldGet$a(_cellsVerticalOrder,this).first.data}getNextVerticalNode(){return _classPrivateFieldGet$a(_currentVerticalLinkedNode,this).next.data}getPrevVerticalNode(){return _classPrivateFieldGet$a(_currentVerticalLinkedNode,this).prev.data}getCurrentHorizontalNode(){return _classPrivateFieldGet$a(_currentHorizontalLinkedNode,this).data}getFirstHorizontalNode(){return _classPrivateFieldGet$a(_cellsHorizontalOrder,this).first.data}getNextHorizontalNode(){return _classPrivateFieldGet$a(_currentHorizontalLinkedNode,this).next.data}getPrevHorizontalNode(){return _classPrivateFieldGet$a(_currentHorizontalLinkedNode,this).prev.data}setPrevNodeAsActive(){_classPrivateFieldSet$9(_currentVerticalLinkedNode,this,_classPrivateFieldGet$a(_currentVerticalLinkedNode,this).prev),_classPrivateFieldSet$9(_currentHorizontalLinkedNode,this,_classPrivateFieldGet$a(_currentHorizontalLinkedNode,this).prev)}setNextNodeAsActive(){_classPrivateFieldSet$9(_currentVerticalLinkedNode,this,_classPrivateFieldGet$a(_currentVerticalLinkedNode,this).next),_classPrivateFieldSet$9(_currentHorizontalLinkedNode,this,_classPrivateFieldGet$a(_currentHorizontalLinkedNode,this).next)}buildFocusOrder(e){const r=e.getTopStartCorner(),i=e.getBottomEndCorner(),n=new WeakSet;_classPrivateFieldSet$9(_cellsHorizontalOrder,this,new LinkedList);for(let o=r.row;o<=i.row;o++)if(!_classPrivateFieldGet$a(_rowIndexMapper,this).isHidden(o))for(let a=r.col;a<=i.col;a++){if(_classPrivateFieldGet$a(_columnIndexMapper,this).isHidden(a))continue;const l=_assertClassBrand$e(_FocusOrder_brand,this,_pushOrderNode).call(this,e,_classPrivateFieldGet$a(_cellsHorizontalOrder,this),n,o,a);l&&_classPrivateFieldSet$9(_currentHorizontalLinkedNode,this,l)}_classPrivateFieldGet$a(_cellsHorizontalOrder,this).first&&(_classPrivateFieldGet$a(_cellsHorizontalOrder,this).first.prev=_classPrivateFieldGet$a(_cellsHorizontalOrder,this).last,_classPrivateFieldGet$a(_cellsHorizontalOrder,this).last.next=_classPrivateFieldGet$a(_cellsHorizontalOrder,this).first);const s=new WeakSet;_classPrivateFieldSet$9(_cellsVerticalOrder,this,new LinkedList);for(let o=r.col;o<=i.col;o++)if(!_classPrivateFieldGet$a(_columnIndexMapper,this).isHidden(o))for(let a=r.row;a<=i.row;a++){if(_classPrivateFieldGet$a(_rowIndexMapper,this).isHidden(a))continue;const l=_assertClassBrand$e(_FocusOrder_brand,this,_pushOrderNode).call(this,e,_classPrivateFieldGet$a(_cellsVerticalOrder,this),s,a,o);l&&_classPrivateFieldSet$9(_currentVerticalLinkedNode,this,l)}_classPrivateFieldGet$a(_cellsVerticalOrder,this).first&&(_classPrivateFieldGet$a(_cellsVerticalOrder,this).first.prev=_classPrivateFieldGet$a(_cellsVerticalOrder,this).last,_classPrivateFieldGet$a(_cellsVerticalOrder,this).last.next=_classPrivateFieldGet$a(_cellsVerticalOrder,this).first)}setActiveNode(e,r){return _classPrivateFieldGet$a(_cellsHorizontalOrder,this).inorder(i=>{const{rowStart:n,rowEnd:s,colStart:o,colEnd:a}=i.data;if(e>=n&&e<=s&&r>=o&&r<=a)return _classPrivateFieldSet$9(_currentHorizontalLinkedNode,this,i),!1}),_classPrivateFieldGet$a(_cellsVerticalOrder,this).inorder(i=>{const{rowStart:n,rowEnd:s,colStart:o,colEnd:a}=i.data;if(e>=n&&e<=s&&r>=o&&r<=a)return _classPrivateFieldSet$9(_currentVerticalLinkedNode,this,i),!1}),this}}function _pushOrderNode(t,e,r,i,n){const s=t.getTopStartCorner(),o=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=_classPrivateFieldGet$a(_mergedCellsGetter,this).call(this,i,n);if(l&&r.has(l))return null;const c={colStart:n,colEnd:n,rowStart:i,rowEnd:i};if(l){if(r.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;c.colStart=l.col,c.colEnd=l.col+l.colspan-1,c.rowStart=l.row,c.rowEnd=l.row+l.rowspan-1}const u=e.push(c);return i===a.row&&n===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?u:null}function sumCellsHeights(t,e,r){const{rowIndexMapper:i,stylesHandler:n}=t,s=n.getDefaultRowHeight();let o=0;for(let l=e;l<e+r;l++)if(!i.isHidden(l)){var a;o+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:s,l===0&&!n.isClassicTheme()&&(o+=1)}return o}function createMergeCellRenderer(t){const{hot:e}=t,{rowIndexMapper:r,columnIndexMapper:i}=e,n=new Map;function s(){}function o(a,l,c){const u=t.mergedCellsCollection.get(l,c);if(!isObject(u)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),isSafari()&&n.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${n.get(l)}px`,n.delete(l)),a.style.display="";return}const{row:d,col:h,colspan:f,rowspan:g}=u,[m,C]=t.translateMergedCellToRenderable(d,g,h,f),y=t.getSetting("virtualized");if(isSafari()&&h===0&&!e.getSettings().rowHeaders){const M=sumCellsHeights(e,d,g);n.set(l,M/g)}const v=r.getRenderableFromVisualIndex(l),E=i.getRenderableFromVisualIndex(c),$=m-v+1,O=C-E+1;let P=r.getNearestNotHiddenIndex(d,1),I=i.getNearestNotHiddenIndex(h,1);if(y){const M=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(M)||(P=Math.max(P,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(M)||(I=Math.max(I,e.getFirstRenderedVisibleColumn()))}const W=Math.min(g,$),q=Math.min(f,O);P===l&&I===c?(a.setAttribute("rowspan",W),a.setAttribute("colspan",q)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:s,after:o}}function _classPrivateMethodInitSpec$8(t,e){_checkPrivateRedeclaration$d(t,e),e.add(t)}function _classPrivateFieldInitSpec$9(t,e,r){_checkPrivateRedeclaration$d(t,e),e.set(t,r)}function _checkPrivateRedeclaration$d(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$u(t,e,r){return(e=_toPropertyKey$u(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$u(t){var e=_toPrimitive$u(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$u(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldSet$8(t,e,r){return t.set(_assertClassBrand$d(t,e),r),r}function _classPrivateFieldGet$9(t,e){return t.get(_assertClassBrand$d(t,e))}function _assertClassBrand$d(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeMergeCells");Hooks.getSingleton().register("afterMergeCells");Hooks.getSingleton().register("beforeUnmergeCells");Hooks.getSingleton().register("afterUnmergeCells");const PLUGIN_KEY$a="mergeCells",PLUGIN_PRIORITY$a=150,SHORTCUTS_GROUP$3=PLUGIN_KEY$a;var _lastSelectedFocus=new WeakMap,_lastFocusDelta=new WeakMap,_focusOrder=new WeakMap,_cellRenderer=new WeakMap,_MergeCells_brand=new WeakSet;class MergeCells extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$8(this,_MergeCells_brand),_defineProperty$u(this,"mergedCellsCollection",null),_defineProperty$u(this,"autofillCalculations",null),_defineProperty$u(this,"selectionCalculations",null),_classPrivateFieldInitSpec$9(this,_lastSelectedFocus,null),_classPrivateFieldInitSpec$9(this,_lastFocusDelta,{row:0,col:0}),_classPrivateFieldInitSpec$9(this,_focusOrder,new FocusOrder({mergedCellsGetter:(e,r)=>this.mergedCellsCollection.get(e,r),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),_classPrivateFieldInitSpec$9(this,_cellRenderer,createMergeCellRenderer(this))}static get PLUGIN_KEY(){return PLUGIN_KEY$a}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$a}static get DEFAULT_SETTINGS(){return{[defaultMainSettingSymbol]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$a]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new MergedCellsCollection(this),this.autofillCalculations=new AutofillCalculations(this),this.selectionCalculations=new SelectionCalculations(this),this.addHook("afterInit",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterInit$1).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onModifyTransformFocus).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onModifyTransformStart$1).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onModifyTransformEnd).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onBeforeSelectionHighlightSet$1).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onBeforeSetRangeStart).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onBeforeSetRangeStart).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onBeforeSelectionFocusSet).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterSelectionFocusSet).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterSelectionEnd).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onModifyGetCellCoords).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onModifyGetCellCoords).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterIsMultipleSelection).call(e,...i)}),this.addHook("afterRenderer",function(){return _classPrivateFieldGet$9(_cellRenderer,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_addMergeActionsToContextMenu).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterGetCellMeta).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterViewportRowCalculatorOverride).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterViewportColumnCalculatorOverride$1).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onModifyAutofillRange).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterCreateCol).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterRemoveCol).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterCreateRow$1).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterRemoveRow$1).call(e,...i)}),this.addHook("afterChange",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterChange$1).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onBeforeDrawAreaBorders).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onAfterDrawSelection).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onBeforeRemoveCellClassNames).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onBeforeBeginEditing).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$d(_MergeCells_brand,e,_onModifyRowHeightByOverlayName).call(e,...i)}),this.addHook("beforeUndoStackChange",(r,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!isChrome())return;const e=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:n,rowspan:s}=i;for(let o=n+1;o<n+s;o++)r.push(o)}),r=[...new Set(r)],r.forEach(i=>{const n=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>s?.name==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(n);o&&(o.style.background=getStyle(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{var n;i.style.background=(n=getStyle(i,"backgroundColor"))===null||n===void 0?void 0:n.replace(", 0.99)",")")})},1)}validateSetting(e){return e?MergedCellCoords.containsNegativeValues(e)?(warn(MergedCellCoords.NEGATIVE_VALUES_WARNING(e)),!1):MergedCellCoords.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(warn(MergedCellCoords.IS_OUT_OF_BOUNDS_WARNING(e)),!1):MergedCellCoords.isSingleCell(e)?(warn(MergedCellCoords.IS_SINGLE_CELL(e)),!1):MergedCellCoords.containsZeroSpan(e)?(warn(MergedCellCoords.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(n=>this.validateSetting(n)),r=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];r.forEach(n=>{const{row:s,col:o,rowspan:a,colspan:l}=n,c=this.hot._createCellCoords(s,o),u=this.hot._createCellCoords(s+a-1,o+l-1),d=this.hot._createCellRange(c,c,u);this.mergeRange(d,!0,!0);for(let h=s;h<s+a;h++)for(let f=o;f<o+l;f++)(h!==s||f!==o)&&i.push([h,f,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(r.row,r.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:r,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(r.row,r.col,i.row,i.col,!1)}mergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:n.row,col:n.col,rowspan:s.row-n.row+1,colspan:s.col-n.col+1},a=[];let l=null;return this.canMergeRange(o,r)?(this.hot.runHooks("beforeMergeCells",e,r),rangeEach(0,o.rowspan-1,u=>{rangeEach(0,o.colspan-1,d=>{let h=null;a[u]||(a[u]=[]),u===0&&d===0?h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+u,o.col+d,"hidden",!0),a[u][d]=h})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,r)?(i?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),r||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,r),l):!0):!1}unmergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,r),arrayEach(i,n=>{this.mergedCellsCollection.remove(n.row,n.col),rangeEach(0,n.rowspan-1,s=>{rangeEach(0,n.colspan-1,o=>{this.hot.removeCellMeta(n.row+s,n.col+o,"hidden"),this.hot.removeCellMeta(n.row+s,n.col+o,"copyable")})}),this.hot.removeCellMeta(n.row,n.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}toggleMerge(e){const{from:r,to:i}=e.clone().normalize(),n=this.mergedCellsCollection.get(r.row,r.col);n.row===r.row&&n.col===r.col&&n.row+n.rowspan-1===i.row&&n.col+n.colspan-1===i.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,r,i,n){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(i,n);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,r,i,n){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(i,n);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:SHORTCUTS_GROUP$3})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$3)}modifyViewportRowStart(e,r){const i=this.hot.rowIndexMapper,n=i.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(n,s);if(isObject(o)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,r);return}}}}modifyViewportRowEnd(e,r){const i=this.hot.rowIndexMapper,n=i.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(n,s);if(isObject(o)){const a=o.row+o.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,r);return}}}}modifyViewportColumnStart(e,r){const i=this.hot.columnIndexMapper,n=i.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,n);if(isObject(o)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,r);return}}}}modifyViewportColumnEnd(e,r){const i=this.hot.columnIndexMapper,n=i.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,n);if(isObject(o)){const a=o.col+o.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,r);return}}}}translateMergedCellToRenderable(e,r,i,n){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;r===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+r-1,-1),n===0?l=o.getNearestNotHiddenIndex(i,1):l=o.getNearestNotHiddenIndex(i+n-1,-1);const c=e>=0?s.getRenderableFromVisualIndex(a):e,u=i>=0?o.getRenderableFromVisualIndex(l):i;return[c,u]}}function _onAfterInit$1(){this.generateFromSettings(),this.hot.render()}function _onAfterIsMultipleSelection(t){if(t){const e=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),i=r.getTopStartCorner(),n=r.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(i.row===e[s].row&&i.col===e[s].col&&n.row===e[s].row+e[s].rowspan-1&&n.col===e[s].col+e[s].colspan-1)return!1}return t}function _onModifyTransformFocus(t){_classPrivateFieldGet$9(_lastFocusDelta,this).row=t.row,_classPrivateFieldGet$9(_lastFocusDelta,this).col=t.col}function _onModifyTransformStart$1(t){const e=this.hot.getSelectedRangeLast(),{highlight:r}=e,{columnIndexMapper:i,rowIndexMapper:n}=this.hot;_classPrivateFieldGet$9(_lastSelectedFocus,this)&&(n.getRenderableFromVisualIndex(_classPrivateFieldGet$9(_lastSelectedFocus,this).row)!==null&&(r.row=_classPrivateFieldGet$9(_lastSelectedFocus,this).row),i.getRenderableFromVisualIndex(_classPrivateFieldGet$9(_lastSelectedFocus,this).col)!==null&&(r.col=_classPrivateFieldGet$9(_lastSelectedFocus,this).col),_classPrivateFieldSet$8(_lastSelectedFocus,this,null));const s=this.mergedCellsCollection.get(r.row,r.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(t.col<0){const u=r.col>=o&&r.col<=a?o-1:a,d=i.getNearestNotHiddenIndex(u,-1);d===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,r.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(d,r.col)-1,1)}else if(t.col>0){const u=r.col>=o&&r.col<=a?a+1:o,d=i.getNearestNotHiddenIndex(u,1);d===null?t.col=this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,d)-1,1)}const l=s.row,c=s.row+s.rowspan-1;if(t.row<0){const u=r.row>=l&&r.row<=c?l-1:c,d=n.getNearestNotHiddenIndex(u,-1);d===null?t.row=-this.hot.view.countRenderableRowsInRange(0,r.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(d,r.row)-1,1)}else if(t.row>0){const u=r.row>=l&&r.row<=c?c+1:l,d=n.getNearestNotHiddenIndex(u,1);d===null?t.row=this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,d)-1,1)}}function _onModifyTransformEnd(t){const e=this.hot.getSelectedRangeLast(),r=e.clone(),{to:i}=e,{columnIndexMapper:n,rowIndexMapper:s}=this.hot,o=(a,l)=>{r.expand(this.hot._createCellCoords(a,l));for(let c=0;c<this.mergedCellsCollection.mergedCells.length;c+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[c].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;o(i.row,a),e.getHorizontalDirection()==="E-W"&&r.getHorizontalDirection()==="E-W"&&(a=r.getTopStartCorner().col);const l=n.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;o(i.row,a),e.getHorizontalDirection()==="W-E"&&r.getHorizontalDirection()==="W-E"&&(a=r.getBottomEndCorner().col);const l=n.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;o(a,i.col),e.getVerticalDirection()==="S-N"&&r.getVerticalDirection()==="S-N"&&(a=r.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;o(a,i.col),e.getVerticalDirection()==="N-S"&&r.getVerticalDirection()==="N-S"&&(a=r.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function _onBeforeSelectionHighlightSet$1(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){_classPrivateFieldSet$8(_lastSelectedFocus,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const r=this.mergedCellsCollection.get(e.row,e.col);_classPrivateFieldSet$8(_lastSelectedFocus,this,e.clone()),r&&e.assign(r)}function _onModifyGetCellCoords(t,e,r,i){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:s,col:o,colspan:a,rowspan:l}=n,c=s,u=o,d=s+l-1,h=o+a-1;if(i==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),m=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[clamp(g,c,d),clamp(m,u,h),clamp(this.hot.getLastRenderedVisibleRow(),c,d),clamp(this.hot.getLastRenderedVisibleColumn(),u,h)]}return[c,u,d,h]}function _addMergeActionsToContextMenu(t){t.items.push({name:"---------"},toggleMergeItem(this))}function _onBeforeSetRangeStart(){_classPrivateFieldSet$8(_lastSelectedFocus,this,null)}function _onBeforeSelectionFocusSet(){if(_classPrivateFieldGet$9(_lastSelectedFocus,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),r=t.getHorizontalDirection(),i=_classPrivateFieldGet$9(_lastSelectedFocus,this).clone().normalize();_classPrivateFieldGet$9(_focusOrder,this).setActiveNode(i.row,i.col),_classPrivateFieldGet$9(_lastFocusDelta,this).row>0||_classPrivateFieldGet$9(_lastFocusDelta,this).col>0?_classPrivateFieldGet$9(_focusOrder,this).setPrevNodeAsActive():(r==="E-W"&&_classPrivateFieldGet$9(_lastFocusDelta,this).col<0||e==="S-N"&&_classPrivateFieldGet$9(_lastFocusDelta,this).row<0)&&_classPrivateFieldGet$9(_focusOrder,this).setNextNodeAsActive()}function _onAfterSelectionFocusSet(t,e){const r=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:n}=this.hot;let s=null,o=null;if(_classPrivateFieldGet$9(_lastFocusDelta,this).col<0){const{rowEnd:a,colEnd:l}=_classPrivateFieldGet$9(_focusOrder,this).getPrevHorizontalNode();o=i.getNearestNotHiddenIndex(l,-1),s=n.getNearestNotHiddenIndex(a,-1)}else if(_classPrivateFieldGet$9(_lastFocusDelta,this).col>0){const{rowStart:a,colStart:l}=_classPrivateFieldGet$9(_focusOrder,this).getNextHorizontalNode();o=i.getNearestNotHiddenIndex(l,1),s=n.getNearestNotHiddenIndex(a,1)}else if(_classPrivateFieldGet$9(_lastFocusDelta,this).row<0){const{rowEnd:a,colEnd:l}=_classPrivateFieldGet$9(_focusOrder,this).getPrevVerticalNode();o=i.getNearestNotHiddenIndex(l,-1),s=n.getNearestNotHiddenIndex(a,-1)}else if(_classPrivateFieldGet$9(_lastFocusDelta,this).row>0){const{rowStart:a,colStart:l}=_classPrivateFieldGet$9(_focusOrder,this).getNextVerticalNode();o=i.getNearestNotHiddenIndex(l,1),s=n.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),c=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?r.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):r.highlight.assign(a),c.clear(),c.add(a).commit()}_classPrivateFieldGet$9(_focusOrder,this).setActiveNode(t,e),_classPrivateFieldSet$8(_lastFocusDelta,this,{row:0,col:0})}function _onAfterSelectionEnd(){this.hot.getSelectedRangeLast().isHeader()||_classPrivateFieldGet$9(_focusOrder,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function _onAfterGetCellMeta(t,e,r){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?r.copyable=!1:(r.rowspan=i.rowspan,r.colspan=i.colspan))}function _onAfterViewportRowCalculatorOverride(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function _onAfterViewportColumnCalculatorOverride$1(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function _onModifyAutofillRange(t,e){const r=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,r))return e;const i=this.hot._createCellCoords(e[0],e[1]),n=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(i,i,n),o=this.mergedCellsCollection.getWithinRange(s);return o.length===0?t:this.autofillCalculations.snapDragArea(e,t,r,o)}function _onAfterCreateCol(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function _onAfterRemoveCol(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function _onAfterCreateRow$1(t,e,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function _onAfterRemoveRow$1(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function _onAfterChange$1(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function _onBeforeDrawAreaBorders(t,e){if(e&&e==="area"){const r=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(r);arrayEach(i,n=>{r.getBottomEndCorner().row===n.getLastRow()&&r.getBottomEndCorner().col===n.getLastColumn()&&(t[2]=n.row,t[3]=n.col)})}}function _onAfterDrawSelection(t,e,r,i){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,r,i)}function _onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function _onBeforeBeginEditing(t,e,r,i){if(!(i instanceof MouseEvent))return;const n=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(n);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&n.isEqual(this.hot._createCellRange(o,o,a))}function _onModifyRowHeightByOverlayName(t,e,r){if(this.hot.getSettings().rowHeaders||r==="bottom"||r==="bottom_inline_start_corner")return t;let i,n;if(r==="master")i=this.hot.getFirstRenderedVisibleColumn(),n=this.hot.getLastRenderedVisibleColumn();else{const h=this.hot.view.getOverlayByName(r);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(h.clone.wtTable.getFirstRenderedColumn()),n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(h.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const o=this.hot._createCellCoords(e,i),a=this.hot._createCellCoords(e,n),l=this.hot._createCellRange(o,o,a),c=this.mergedCellsCollection.getWithinRange(l,!0),u=c.reduce((h,f)=>{let{rowspan:g}=f;return Math.max(h,g)},1);let d=0;return c.length>1&&c[0].rowspan<u&&(d=u-c[0].rowspan),c.forEach(h=>{let{rowspan:f}=h,g=0;r==="top"||r==="top_inline_start_corner"?g=Math.min(u,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-d,t=Math.max(t??0,sumCellsHeights(this.hot,e,g))}),t}function rootComparator(t,e){return function(r,i){const[,...n]=r,[,...s]=i;return function o(a){const l=t[a],c=e[a],u=n[a],d=s[a],h=c.multiColumnSorting,g=(h.compareFunctionFactory?h.compareFunctionFactory:getCompareFunctionFactory(c.type))(l,c,h)(u,d);if(g===DO_NOT_SWAP){const m=a+1;if(typeof e[m]<"u")return o(m)}return g}(0)}}const COLUMN_ORDER_PREFIX="sort";function getClassesToAdd(t,e,r){const i=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${COLUMN_ORDER_PREFIX}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function getClassesToRemove(t){const e=t.className.split(" "),r=new RegExp(`^${COLUMN_ORDER_PREFIX}-[0-9]{1,2}$`);return e.filter(i=>r.test(i))}function _defineProperty$t(t,e,r){return(e=_toPropertyKey$t(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$t(t){var e=_toPrimitive$t(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$t(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const PLUGIN_KEY$9="multiColumnSorting",PLUGIN_PRIORITY$9=170,SHORTCUTS_GROUP$2=PLUGIN_KEY$9;registerRootComparator(PLUGIN_KEY$9,rootComparator);class MultiColumnSorting extends ColumnSorting{constructor(){super(...arguments),_defineProperty$t(this,"pluginKey",PLUGIN_KEY$9)}static get PLUGIN_KEY(){return PLUGIN_KEY$9}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$9}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,APPEND_COLUMN_CONFIG_STRATEGY)),!1},runOnlyIf:()=>{var e,r;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP$2})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$2)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];super.updateHeaderClasses(e,...i),removeClass$1(e,getClassesToRemove(e)),this.enabled!==!1&&addClass$1(e,getClassesToAdd(...i))}onAfterOnCellMouseDown(e,r){wasHeaderClickedProperly(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(r.col),this.sort(this.getNextSortConfig(r.col,APPEND_COLUMN_CONFIG_STRATEGY))):this.sort(this.getColumnNextConfig(r.col)))}}function _defineProperty$s(t,e,r){return(e=_toPropertyKey$s(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$s(t){var e=_toPrimitive$s(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$s(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const PLUGIN_KEY$8="multipleSelectionHandles",PLUGIN_PRIORITY$8=160;class MultipleSelectionHandles extends BasePlugin{constructor(){super(...arguments),_defineProperty$s(this,"dragged",[]),_defineProperty$s(this,"lastSetCell",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$8}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$8}isEnabled(){return isMobileBrowser()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:r}=this.hot;function i(n){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(n);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",n=>{let s;if(hasClass$1(n.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},n.preventDefault(),!1;if(hasClass$1(n.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},n.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchend",n=>{if(hasClass$1(n.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,n.preventDefault(),!1;if(hasClass$1(n.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,n.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchmove",n=>{const{rootDocument:s}=this.hot;let o,a,l,c,u,d;if(e.dragged.length===0)return;const h=s.elementFromPoint(n.touches[0].clientX,n.touches[0].clientY);!h||h===e.lastSetCell||((h.nodeName==="TD"||h.nodeName==="TH")&&(o=e.hot.getCoords(h),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),c=a.getHeight(),u=a.getDirection(),l===1&&c===1&&e.hot.selection.setRangeEnd(o),d=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,u,e.dragged[0]),d.start!==null&&e.hot.selection.setRangeStart(d.start),e.hot.selection.setRangeEnd(d.end),e.lastSetCell=h),n.preventDefault())})}getCurrentRangeCoords(e,r,i,n,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),c=e.getTopEndCorner();let u={start:null,end:null};switch(i){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":s==="top"?u={start:this.hot._createCellCoords(r.row,e.highlight.col),end:this.hot._createCellCoords(l.row,r.col)}:u={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,o.col)};break;case"SE-NW":s==="bottom"&&(u={start:this.hot._createCellCoords(a.row,r.col),end:this.hot._createCellCoords(r.row,o.col)});break}break;case"NW-SE":switch(n){case"NE-SW":s==="top"?u={start:r,end:l}:u.end=r;break;case"NW-SE":s==="top"?u={start:r,end:a}:u.end=r;break;case"SE-NW":s==="top"?u={start:r,end:o}:u.end=r;break;case"SW-NE":s==="top"?u={start:r,end:c}:u.end=r;break}break;case"SW-NE":switch(n){case"NW-SE":s==="bottom"?u={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(l.row,r.col)}:u={start:this.hot._createCellCoords(o.row,r.col),end:this.hot._createCellCoords(r.row,a.col)};break;case"SW-NE":s==="top"?u={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,a.col)}:u={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(o.row,r.col)};break;case"SE-NW":s==="bottom"?u={start:this.hot._createCellCoords(r.row,c.col),end:this.hot._createCellCoords(o.row,r.col)}:s==="top"&&(u={start:l,end:r});break}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(u.end=r);break;case"SE-NW":s==="top"?u.end=r:u={start:r,end:o};break}break}return u}isDragged(){return this.dragged.length>0}}function createDefaultHeaderSettings(){let{label:t="",colspan:e=1,origColspan:r=1,collapsible:i=!1,crossHiddenColumns:n=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:c=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:r,collapsible:i,isCollapsed:s,crossHiddenColumns:n,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:c}}function createPlaceholderHeaderSettings(){return{label:"",isPlaceholder:!0}}function normalizeSettings(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(e===0)return r;arrayEach(t,n=>{const s=[];let o=0;r.push(s),arrayEach(n,a=>{const l=createDefaultHeaderSettings();if(isObject(a)){const{label:u,colspan:d,headerClassName:h}=a;l.label=stringify$1(u),typeof d=="number"&&d>1&&(l.colspan=d,l.origColspan=d),typeof h=="string"&&(l.headerClassNames=[...h.split(" ")])}else l.label=stringify$1(a);o+=l.origColspan;let c=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,c=!0),s.push(l),l.colspan>1)for(let u=0;u<l.colspan-1;u++)s.push(createPlaceholderHeaderSettings());return!c})});const i=Math.max(...arrayMap(r,n=>n.length));return arrayEach(r,n=>{if(n.length<i){const s=arrayMap(new Array(i-n.length),()=>createDefaultHeaderSettings());n.splice(n.length,0,...s)}}),r}function _classPrivateFieldInitSpec$8(t,e,r){_checkPrivateRedeclaration$c(t,e),e.set(t,r)}function _checkPrivateRedeclaration$c(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$8(t,e){return t.get(_assertClassBrand$c(t,e))}function _classPrivateFieldSet$7(t,e,r){return t.set(_assertClassBrand$c(t,e),r),r}function _assertClassBrand$c(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const HEADER_CONFIGURABLE_PROPS=["label","collapsible"];var _data=new WeakMap,_dataLength=new WeakMap,_columnsLimit=new WeakMap;class SourceSettings{constructor(){_classPrivateFieldInitSpec$8(this,_data,[]),_classPrivateFieldInitSpec$8(this,_dataLength,0),_classPrivateFieldInitSpec$8(this,_columnsLimit,1/0)}setColumnsLimit(e){_classPrivateFieldSet$7(_columnsLimit,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_classPrivateFieldSet$7(_data,this,normalizeSettings(e,_classPrivateFieldGet$8(_columnsLimit,this))),_classPrivateFieldSet$7(_dataLength,this,_classPrivateFieldGet$8(_data,this).length)}getData(){return _classPrivateFieldGet$8(_data,this)}mergeWith(e){arrayEach(e,r=>{let{row:i,col:n,...s}=r;const o=this.getHeaderSettings(i,n);o!==null&&extend$1(o,s,HEADER_CONFIGURABLE_PROPS)})}map(e){arrayEach(_classPrivateFieldGet$8(_data,this),r=>{arrayEach(r,i=>{const n=e({...i});isObject(n)&&extend$1(i,n,HEADER_CONFIGURABLE_PROPS)})})}getHeaderSettings(e,r){var i;if(e>=_classPrivateFieldGet$8(_dataLength,this)||e<0)return null;const n=_classPrivateFieldGet$8(_data,this)[e];return Array.isArray(n)===!1||r>=n.length?null:(i=n[r])!==null&&i!==void 0?i:null}getHeadersSettings(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const n=[];if(e>=_classPrivateFieldGet$8(_dataLength,this)||e<0)return n;const s=_classPrivateFieldGet$8(_data,this)[e];let o=0;for(let a=r;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,n.push(l),l.colspan>1&&(a+=l.colspan-1),o===i)break;if(o>i)throw new Error("The last column settings cannot overlap the other header layers")}return n}getLayersCount(){return _classPrivateFieldGet$8(_dataLength,this)}getColumnsCount(){return _classPrivateFieldGet$8(_dataLength,this)>0?_classPrivateFieldGet$8(_data,this)[0].length:0}clear(){_classPrivateFieldSet$7(_data,this,[]),_classPrivateFieldSet$7(_dataLength,this,0)}}function _defineProperty$r(t,e,r){return(e=_toPropertyKey$r(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$r(t){var e=_toPrimitive$r(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$r(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const TRAVERSAL_DF_PRE="DF-pre-order";function depthFirstPreOrder(t,e){let r=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(r===!1)return!1;r=depthFirstPreOrder.call(this.childs[i],t,e)}return r}const TRAVERSAL_DF_POST="DF-post-order";function depthFirstPostOrder(t,e){for(let r=0;r<this.childs.length;r++)if(depthFirstPostOrder.call(this.childs[r],t,e)===!1)return!1;return t.call(e,this)}const TRAVERSAL_BF="BF";function breadthFirst(t,e){const r=[this];function i(){if(r.length===0)return;const n=r.shift();r.push(...n.childs),t.call(e,n)!==!1&&i()}i()}const DEFAULT_TRAVERSAL_STRATEGY=TRAVERSAL_BF,TRAVERSAL_STRATEGIES=new Map([[TRAVERSAL_DF_PRE,depthFirstPreOrder],[TRAVERSAL_DF_POST,depthFirstPostOrder],[TRAVERSAL_BF,breadthFirst]]);class TreeNode{constructor(e){_defineProperty$r(this,"data",{}),_defineProperty$r(this,"parent",null),_defineProperty$r(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new TreeNode({...e.data});for(let i=0;i<e.childs.length;i++)r.addChild(this.cloneTree(e.childs[i]));return r}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}walkDown(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_TRAVERSAL_STRATEGY;if(!TRAVERSAL_STRATEGIES.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);TRAVERSAL_STRATEGIES.get(r).call(this,e,this)}walkUp(e){const r=this,i=n=>{e.call(r,n)!==!1&&n.parent!==null&&i(n.parent)};i(this)}}function _classPrivateFieldInitSpec$7(t,e,r){_checkPrivateRedeclaration$b(t,e),e.set(t,r)}function _checkPrivateRedeclaration$b(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$7(t,e){return t.get(_assertClassBrand$b(t,e))}function _classPrivateFieldSet$6(t,e,r){return t.set(_assertClassBrand$b(t,e),r),r}function _assertClassBrand$b(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _rootNodes=new WeakMap,_rootsIndex=new WeakMap,_sourceSettings$1=new WeakMap;class HeadersTree{constructor(e){_classPrivateFieldInitSpec$7(this,_rootNodes,new Map),_classPrivateFieldInitSpec$7(this,_rootsIndex,new Map),_classPrivateFieldInitSpec$7(this,_sourceSettings$1,null),_classPrivateFieldSet$6(_sourceSettings$1,this,e)}getRoots(){return Array.from(_classPrivateFieldGet$7(_rootNodes,this).values())}getRootByColumn(e){let r;return _classPrivateFieldGet$7(_rootsIndex,this).has(e)&&(r=_classPrivateFieldGet$7(_rootNodes,this).get(_classPrivateFieldGet$7(_rootsIndex,this).get(e))),r}getNode(e,r){const i=this.getRootByColumn(r);if(!i)return;const n=r-_classPrivateFieldGet$7(_rootsIndex,this).get(r);let s=0,o;return i.walkDown(a=>{const{data:{origColspan:l,headerLevel:c}}=a;if(e===c){if(n>=s&&n<=s+l-1)return o=a,o.data.isRoot=r===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;_classPrivateFieldGet$7(_rootsIndex,this).clear(),arrayEach(_classPrivateFieldGet$7(_rootNodes,this),r=>{let[,{data:{colspan:i}}]=r;for(let n=e;n<e+i;n++)_classPrivateFieldGet$7(_rootsIndex,this).set(n,e);e+=i})}buildTree(){this.clear();const e=_classPrivateFieldGet$7(_sourceSettings$1,this).getColumnsCount();let r=0;for(;r<e;){const i=_classPrivateFieldGet$7(_sourceSettings$1,this).getHeaderSettings(0,r),n=new TreeNode;_classPrivateFieldGet$7(_rootNodes,this).set(r,n),this.buildLeaves(n,r,0,i.origColspan),r+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,r,i){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=_classPrivateFieldGet$7(_sourceSettings$1,this).getHeadersSettings(i,r,n);i+=1,arrayEach(s,o=>{const a={...o,headerLevel:i-1,columnIndex:r};let l;i===1?(e.data=a,l=e):(l=new TreeNode(a),e.addChild(l)),i<_classPrivateFieldGet$7(_sourceSettings$1,this).getLayersCount()&&this.buildLeaves(l,r,i,o.origColspan),r+=o.origColspan})}clear(){_classPrivateFieldGet$7(_rootNodes,this).clear(),_classPrivateFieldGet$7(_rootsIndex,this).clear()}}function traverseHiddenNodeColumnIndexes(t,e){t.walkDown(r=>{let{data:i,childs:n}=r;if(!i.isHidden&&(e(i.columnIndex),n.length===0))for(let s=1;s<i.colspan;s++)e(i.columnIndex+s)})}function getFirstChildProperty(t,e){let{childs:r}=t;if(r.length!==0)return r[0].data[e]}function isNodeReflectsFirstChildColspan(t){return getFirstChildProperty(t,"origColspan")===t.data.origColspan}function expandNode(t){const{data:e,childs:r}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(t))return expandNode(r[0]);e.isCollapsed=!1;const n=r.slice(1),s=new Set;let o=0;if(n.length>0)arrayEach(n,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,traverseHiddenNodeColumnIndexes(a,c=>{s.add(c)})});else{const{colspan:a,origColspan:l,columnIndex:c}=e;o=l-a;for(let u=1;u<l;u++)s.add(c+u)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):isNodeReflectsFirstChildColspan(a)&&(l.isCollapsed=getFirstChildProperty(a,"isCollapsed"))}),{rollbackModification:()=>collapseNode(t),affectedColumns:Array.from(s),colspanCompensation:o}}function collapseNode(t){var e;const{data:r,childs:i}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(t))return collapseNode(i[0]);r.isCollapsed=!0;const s=i.slice(1),o=new Set;if(s.length>0)arrayEach(s,l=>{traverseHiddenNodeColumnIndexes(l,c=>{o.add(c)}),l.data.clonedTree=l.cloneTree(),l.walkDown(c=>{let{data:u}=c;u.isHidden=!0})});else{const{origColspan:l,columnIndex:c}=r;for(let u=1;u<l;u++){const d=c+u;o.add(d)}}const a=r.colspan-((e=getFirstChildProperty(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:c}=l;c.colspan-=a,c.colspan<=1?(c.colspan=1,c.isCollapsed=!0):isNodeReflectsFirstChildColspan(l)&&(c.isCollapsed=getFirstChildProperty(l,"isCollapsed"))}),{rollbackModification:()=>expandNode(t),affectedColumns:Array.from(o),colspanCompensation:a}}function hideColumn(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(r.includes(e))return;let i=!1;t.walkUp(n=>{const{data:{collapsible:s}}=n;if(s)return i=!0,!1}),!i&&t.walkUp(n=>{const{data:s}=n;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function showColumn(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(!r.includes(e))return;let i=!1;t.walkUp(n=>{const{data:{collapsible:s}}=n;if(s)return i=!0,!1}),!i&&t.walkUp(n=>{const{data:s}=n;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const availableModifiers=new Map([["collapse",collapseNode],["expand",expandNode],["hide-column",hideColumn],["show-column",showColumn]]);function triggerNodeModification(t,e,r){if(!availableModifiers.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return availableModifiers.get(t)(e,r)}function generateMatrix(t){const e=[];return arrayEach(t,r=>{r.walkDown(i=>{const n=i.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=n,c=createNestedArrayIfNecessary(e,a);let u=!1;for(let d=o;d<o+s;d++)if(l.includes(d)||u)c.push(createPlaceholderHeaderSettings());else{const f=createHeaderSettings(n);f.isRoot=!0,c.push(f),u=!0}})}),e}function createHeaderSettings(t){const{crossHiddenColumns:e,...r}=createDefaultHeaderSettings(t);return r}function createNestedArrayIfNecessary(t,e){let r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function _classPrivateFieldInitSpec$6(t,e,r){_checkPrivateRedeclaration$a(t,e),e.set(t,r)}function _checkPrivateRedeclaration$a(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$5(t,e,r){return t.set(_assertClassBrand$a(t,e),r),r}function _classPrivateFieldGet$6(t,e){return t.get(_assertClassBrand$a(t,e))}function _assertClassBrand$a(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _sourceSettings=new WeakMap,_headersTree=new WeakMap,_stateMatrix=new WeakMap;class StateManager{constructor(){_classPrivateFieldInitSpec$6(this,_sourceSettings,new SourceSettings),_classPrivateFieldInitSpec$6(this,_headersTree,new HeadersTree(_classPrivateFieldGet$6(_sourceSettings,this))),_classPrivateFieldInitSpec$6(this,_stateMatrix,[[]])}setState(e){_classPrivateFieldGet$6(_sourceSettings,this).setData(e);let r=!1;try{_classPrivateFieldGet$6(_headersTree,this).buildTree()}catch{_classPrivateFieldGet$6(_headersTree,this).clear(),_classPrivateFieldGet$6(_sourceSettings,this).clear(),r=!0}return _classPrivateFieldSet$5(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$6(_headersTree,this).getRoots())),r}setColumnsLimit(e){_classPrivateFieldGet$6(_sourceSettings,this).setColumnsLimit(e)}mergeStateWith(e){const r=arrayMap(e,i=>{let{row:n,...s}=i;return{row:n<0?this.rowCoordsToLevel(n):n,...s}});_classPrivateFieldGet$6(_sourceSettings,this).mergeWith(r),_classPrivateFieldGet$6(_headersTree,this).buildTree(),_classPrivateFieldSet$5(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$6(_headersTree,this).getRoots()))}mapState(e){_classPrivateFieldGet$6(_sourceSettings,this).map(e),_classPrivateFieldGet$6(_headersTree,this).buildTree(),_classPrivateFieldSet$5(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$6(_headersTree,this).getRoots()))}mapNodes(e){return arrayReduce(_classPrivateFieldGet$6(_headersTree,this).getRoots(),(r,i)=>(i.walkDown(n=>{const s=e(n.data);s!==void 0&&r.push(s)}),r),[])}triggerNodeModification(e,r,i){r<0&&(r=this.rowCoordsToLevel(r));const n=_classPrivateFieldGet$6(_headersTree,this).getNode(r,i);let s;return n&&(s=triggerNodeModification(e,n,i),_classPrivateFieldSet$5(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$6(_headersTree,this).getRoots()))),s}triggerColumnModification(e,r){return this.triggerNodeModification(e,-1,r)}rowCoordsToLevel(e){if(e>=0)return null;const r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}levelToRowCoords(e){if(e<0)return null;const r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}getHeaderSettings(e,r){var i,n;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(n=_classPrivateFieldGet$6(_stateMatrix,this)[e])===null||n===void 0?void 0:n[r])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,r){const i=this.getHeaderTreeNode(e,r);return i?{...i.data}:null}getHeaderTreeNode(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=_classPrivateFieldGet$6(_headersTree,this).getNode(e,r);return i||null}findTopMostEntireHeaderLevel(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let n=!1,s=null;for(let o=e;o<=r;o++){const a=_classPrivateFieldGet$6(_headersTree,this).getRootByColumn(o);if(!a)break;n=!0,a.walkDown(l=>{const{columnIndex:c,headerLevel:u,origColspan:d,isHidden:h}=l.data;h||d<=i&&c>=e&&c+d-1<=r&&(s===null||u<s)&&(s=u)},TRAVERSAL_DF_PRE)}return n&&s===null?-1:this.levelToRowCoords(s??0)}findLeftMostColumnIndex(e,r){var i;const{isRoot:n}=(i=this.getHeaderSettings(e,r))!==null&&i!==void 0?i:{isRoot:!0};if(n)return r;let s=r-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,r){var i;const{isRoot:n,origColspan:s}=(i=this.getHeaderSettings(e,r))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(n)return r+s-1;let o=r+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return _classPrivateFieldGet$6(_sourceSettings,this).getLayersCount()}getColumnsCount(){return _classPrivateFieldGet$6(_sourceSettings,this).getColumnsCount()}clear(){_classPrivateFieldSet$5(_stateMatrix,this,[]),_classPrivateFieldGet$6(_sourceSettings,this).clear(),_classPrivateFieldGet$6(_headersTree,this).clear()}}function _defineProperty$q(t,e,r){return(e=_toPropertyKey$q(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$q(t){var e=_toPrimitive$q(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$q(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GhostTable{constructor(e,r){_defineProperty$q(this,"hot",void 0),_defineProperty$q(this,"nestedHeaderSettingsGetter",void 0),_defineProperty$q(this,"layersCount",0),_defineProperty$q(this,"container",void 0),_defineProperty$q(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const r=this.container.querySelectorAll("tr:last-of-type th"),i=r.length;this.widthsMap.clear();for(let n=0;n<i;n++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(o,r[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:r,columnIndexMapper:i}=this.hot,n=r.createDocumentFragment(),s=r.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const c=r.createElement("tr");for(let u=0;u<a;u++){let d=i.getVisualFromRenderableIndex(u);d===null&&(d=u);const h=r.createElement("th"),f=this.nestedHeaderSettingsGetter(l,d);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;o&&(g+='<button class="changeType"></button>'),fastInnerHTML(h,g),h.colSpan=f.colspan,c.appendChild(h)}}s.appendChild(c)}n.appendChild(s),e.appendChild(n)}clear(){this.widthsMap.clear(),this.container=null}}function _classPrivateMethodInitSpec$7(t,e){_checkPrivateRedeclaration$9(t,e),e.add(t)}function _defineProperty$p(t,e,r){return(e=_toPropertyKey$p(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$p(t){var e=_toPrimitive$p(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$p(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldInitSpec$5(t,e,r){_checkPrivateRedeclaration$9(t,e),e.set(t,r)}function _checkPrivateRedeclaration$9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$4(t,e,r){return t.set(_assertClassBrand$9(t,e),r),r}function _classPrivateFieldGet$5(t,e){return t.get(_assertClassBrand$9(t,e))}function _assertClassBrand$9(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$7="nestedHeaders",PLUGIN_PRIORITY$7=280;var _stateManager=new WeakMap,_hidingIndexMapObserver=new WeakMap,_focusInitialCoords=new WeakMap,_isColumnsSelectionInProgress=new WeakMap,_recentlyHighlightCoords=new WeakMap,_NestedHeaders_brand=new WeakSet;class NestedHeaders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$7(this,_NestedHeaders_brand),_classPrivateFieldInitSpec$5(this,_stateManager,new StateManager),_classPrivateFieldInitSpec$5(this,_hidingIndexMapObserver,null),_classPrivateFieldInitSpec$5(this,_focusInitialCoords,null),_classPrivateFieldInitSpec$5(this,_isColumnsSelectionInProgress,!1),_classPrivateFieldInitSpec$5(this,_recentlyHighlightCoords,null),_defineProperty$p(this,"ghostTable",new GhostTable(this.hot,(e,r)=>this.getHeaderSettings(e,r))),_defineProperty$p(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$7}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$7}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$7]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();(!Array.isArray(r)||!Array.isArray(r[0]))&&warn(toSingleLine`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>_assertClassBrand$9(_NestedHeaders_brand,this,_onInit).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onAfterLoadData).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onBeforeOnCellMouseDown$1).call(e,...n)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onAfterOnCellMouseDown).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onBeforeOnCellMouseOver).call(e,...n)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onBeforeOnCellMouseUp).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onBeforeSelectionHighlightSet).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onModifyTransformStart).call(e,...n)}),this.addHook("afterSelection",()=>_assertClassBrand$9(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.addHook("afterSelectionFocusSet",()=>_assertClassBrand$9(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onBeforeViewportScrollHorizontally).call(e,...n)}),this.addHook("afterGetColumnHeaderRenderers",i=>_assertClassBrand$9(_NestedHeaders_brand,this,_onAfterGetColumnHeaderRenderers).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onModifyColWidth$1).call(e,...n)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onModifyColumnHeaderValue).call(e,...n)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onBeforeHighlightingColumnHeader).call(e,...n)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onBeforeCopy).call(e,...n)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onBeforeSelectColumns).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onAfterViewportColumnCalculatorOverride).call(e,...n)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$9(_NestedHeaders_brand,e,_onModifyFocusedElement).call(e,...n)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>_assertClassBrand$9(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>_assertClassBrand$9(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();_classPrivateFieldGet$5(_stateManager,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=_classPrivateFieldGet$5(_stateManager,this).setState(e)),this.detectedOverlappedHeaders&&warn(toSingleLine`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,i)=>{const n=r===!0?"hide-column":"show-column";_classPrivateFieldGet$5(_stateManager,this).triggerColumnModification(n,i)}),!_classPrivateFieldGet$5(_hidingIndexMapObserver,this)&&this.enabled&&_classPrivateFieldSet$4(_hidingIndexMapObserver,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(i=>{let{op:n,index:s,newValue:o}=i;if(n==="replace"){const a=o===!0?"hide-column":"show-column";_classPrivateFieldGet$5(_stateManager,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),_classPrivateFieldGet$5(_stateManager,this).clear(),_classPrivateFieldGet$5(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet$4(_hidingIndexMapObserver,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return _classPrivateFieldGet$5(_stateManager,this)}getLayersCount(){return _classPrivateFieldGet$5(_stateManager,this).getLayersCount()}getHeaderSettings(e,r){return _classPrivateFieldGet$5(_stateManager,this).getHeaderSettings(e,r)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,r=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,n=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<r;o++){const a=i.childNodes[o];if(!a)break;const l=n.childNodes[o],c=s?s.childNodes[o]:null;for(let u=0,d=a.childNodes.length;u<d;u++)a.childNodes[u].removeAttribute("colspan"),removeClass$1(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),removeClass$1(l.childNodes[u],"hiddenHeader")),s&&c&&c.childNodes[u]&&(c.childNodes[u].removeAttribute("colspan"),removeClass$1(c.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var r=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(n,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let c=a.getVisualFromRenderableIndex(n);c===null&&(c=n),s.removeAttribute("colspan"),removeClass$1(s,"hiddenHeader"),removeClass$1(s,"hiddenHeaderText");const{colspan:u,isHidden:d,isPlaceholder:h,headerClassNames:f}=(o=_classPrivateFieldGet$5(_stateManager,this).getHeaderSettings(e,c))!==null&&o!==void 0?o:{};if(h||d)addClass$1(s,"hiddenHeader");else if(u>1){var g,m,C;const{wtOverlays:y}=l._wt,v=(g=y.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(s),E=(m=y.inlineStartOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s);((C=y.topOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s))&&c<i&&addClass$1(s,"hiddenHeaderText");const O=v||E?Math.min(u,i-n):u;O>1&&s.setAttribute("colspan",O)}if(this.hot.view.appendColHeader(c,s,function(){return r.getColumnHeaderValue(...arguments)},e),!h&&!d){const y=s.querySelector("div.relative");y&&f&&f.length>0&&(removeClass$1(y,this.hot.getColumnMeta(c).headerClassName),addClass$1(y,f))}}}getColumnHeaderValue(e,r){var i;const{isHidden:n,isPlaceholder:s}=(i=_classPrivateFieldGet$5(_stateManager,this).getHeaderSettings(r,e))!==null&&i!==void 0?i:{};return s||n?"":this.hot.getColHeader(e,r)}destroy(){_classPrivateFieldSet$4(_stateManager,this,null),_classPrivateFieldGet$5(_hidingIndexMapObserver,this)!==null&&(_classPrivateFieldGet$5(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet$4(_hidingIndexMapObserver,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return _classPrivateFieldGet$5(_stateManager,this).getHeaderTreeNodeData(e.row,e.col)}}function _updateFocusHighlightPosition(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:r}=e;if(r.isHeader()&&r.col>=0){const n=_classPrivateFieldGet$5(_stateManager,this).findLeftMostColumnIndex(r.row,r.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=n,s.visualCellRange.from.col=n,s.visualCellRange.to.col=n,s.commit()}}function _onBeforeViewportScrollHorizontally(t,e){var r;const i=this.hot.getSelectedRangeLast();if(!i)return t;const{highlight:n}=i,{navigableHeaders:s}=this.hot.getSettings(),o=this.hot.selection.isSelectedByColumnHeader(),a=s?n.row:(r=_classPrivateFieldGet$5(_recentlyHighlightCoords,this))===null||r===void 0?void 0:r.row,l=o?t:n.col,c=a<0&&l>=0;if(_classPrivateFieldSet$4(_recentlyHighlightCoords,this,null),!c)return t;const u=this.hot.getFirstFullyVisibleColumn(),d=this.hot.getLastFullyVisibleColumn(),h=d-u+1,f=_classPrivateFieldGet$5(_stateManager,this).findLeftMostColumnIndex(a,l),g=_classPrivateFieldGet$5(_stateManager,this).findRightMostColumnIndex(a,l),m=g-f+1;if(f<u&&g>d)return f;if(o){let C=null;return f>=u&&g>d?m>h?(e.value="start",C=f):(e.value="end",C=g):f<u&&g<=d&&(m>h?(e.value="end",C=g):(e.value="start",C=f)),C}return f<=u?f:g}function _onBeforeHighlightingColumnHeader(t,e,r){const i=_classPrivateFieldGet$5(_stateManager,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:n,selectionType:s,selectionWidth:o}=r,{isRoot:a,colspan:l}=_classPrivateFieldGet$5(_stateManager,this).getHeaderSettings(e,t);if(s===HEADER_TYPE){if(!a)return i.columnIndex}else if(s===ACTIVE_HEADER_TYPE&&(l>o-n||!a))return null;return t}function _onBeforeCopy(t,e,r){let{columnHeadersCount:i}=r;if(i!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:c}=e[s],u=l-o+1,d=a-c+1;if(o>=0||d===1)break;for(let h=a;h<=c;h++)for(let f=o;f<=l;f++){var n;const g=u+f,m=h-a;if(m===0)continue;((n=_classPrivateFieldGet$5(_stateManager,this).getHeaderTreeNodeData(f,h))===null||n===void 0?void 0:n.isRoot)===!1&&(t[g][m]="")}}}function _onBeforeOnCellMouseDown$1(t,e,r,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function _onAfterOnCellMouseDown(t,e){const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;_classPrivateFieldSet$4(_focusInitialCoords,this,e.clone()),_classPrivateFieldSet$4(_isColumnsSelectionInProgress,this,!0);const{selection:i}=this.hot,n=i.isSelected()?i.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=r,l=!i.inInSelection(e);t.shiftKey&&n?e.col<n.from.col?s.push(n.getTopEndCorner().col,o,e.row):e.col>n.from.col?s.push(n.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(isLeftClick(t)||isRightClick(t)&&l||isTouchEvent(t))&&s.push(o,o+a-1,e.row),i.selectColumns(...s)}function _onBeforeOnCellMouseOver(t,e,r,i){if(!this.hot.view.isMouseDown()||i.column)return;const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;const{columnIndex:s,origColspan:o}=n,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),c=a.getBottomEndCorner(),{from:u}=a;i.column=!0,i.cell=!0;const d=[],h=clamp(e.row,-1/0,-1);e.col<u.col?d.push(c.col,s,h):e.col>u.col?d.push(l.col,s+o-1,h):d.push(s,s+o-1,h),this.hot.selection.selectColumns(...d)}function _onBeforeOnCellMouseUp(){_classPrivateFieldSet$4(_isColumnsSelectionInProgress,this,!1)}function _onBeforeSelectionHighlightSet(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!_classPrivateFieldGet$5(_isColumnsSelectionInProgress,this)||!t)return;const e=this.hot.getSelectedRangeLast(),r=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:n,origColspan:s}=_classPrivateFieldGet$5(_stateManager,this).getHeaderTreeNodeData(_classPrivateFieldGet$5(_focusInitialCoords,this).row,_classPrivateFieldGet$5(_focusInitialCoords,this).col);if(e.setHighlight(_classPrivateFieldGet$5(_focusInitialCoords,this)),s>e.getWidth()||n<r||n+s-1>i){const o=_classPrivateFieldGet$5(_stateManager,this).findTopMostEntireHeaderLevel(clamp(r,n,n+s-1),clamp(i,n,n+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function _onModifyTransformStart(t){const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(r.isHeader()&&r.col>=0))return;const n=_classPrivateFieldGet$5(_stateManager,this).findLeftMostColumnIndex(r.row,r.col),s=_classPrivateFieldGet$5(_stateManager,this).findRightMostColumnIndex(r.row,r.col);if(t.col<0){const o=e.col>=n&&e.col<=s?n-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const o=e.col>=n&&e.col<=s?s+1:n,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function _onBeforeSelectColumns(t,e,r){const i=t.row,n=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),s=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});_classPrivateFieldSet$4(_recentlyHighlightCoords,this,r.clone()),e.col<t.col?(n&&(t.col=n.columnIndex+n.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=t.col&&(n&&(t.col=n.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function _onAfterGetColumnHeaderRenderers(t){if(_classPrivateFieldGet$5(_stateManager,this).getLayersCount()>0){t.length=0;for(let e=0;e<_classPrivateFieldGet$5(_stateManager,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function _onAfterViewportColumnCalculatorOverride(t){const e=_classPrivateFieldGet$5(_stateManager,this).getLayersCount();let r=t.startColumn,i=!!e;for(let n=0;n<e;n++){const s=_classPrivateFieldGet$5(_stateManager,this).findLeftMostColumnIndex(n,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(i=!1),isNumeric(o)&&o<t.startColumn){r=o;break}}t.startColumn=i?_classPrivateFieldGet$5(_stateManager,this).getHeaderTreeNodeData(0,r).columnIndex:r}function _onModifyColWidth$1(t,e){const r=this.ghostTable.getWidth(e);return t>r?t:r}function _onModifyColumnHeaderValue(t,e,r){var i;const{label:n}=(i=_classPrivateFieldGet$5(_stateManager,this).getHeaderTreeNodeData(r,e))!==null&&i!==void 0?i:{label:""};return n}function _onModifyFocusedElement(t,e){if(t<0)return this.hot.getCell(t,_classPrivateFieldGet$5(_stateManager,this).findLeftMostColumnIndex(t,e),!0)}function _onInit(){this.updatePlugin()}function _onAfterLoadData(t,e){e||this.updatePlugin()}function _defineProperty$o(t,e,r){return(e=_toPropertyKey$o(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$o(t){var e=_toPrimitive$o(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$o(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DataManager{constructor(e,r){_defineProperty$o(this,"hot",void 0),_defineProperty$o(this,"data",null),_defineProperty$o(this,"plugin",void 0),_defineProperty$o(this,"parentReference",new WeakMap),_defineProperty$o(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=r,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},rangeEach(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,r,i){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&arrayEach(e.__children,n=>{this.cacheNode(n,r+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,r,i,n){let s=!1,o=r;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),i!=null&&o===i?{result:a,end:!0}:n!=null&&a===n?{result:o,end:!0}:(o+=1,a.__children&&arrayEach(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,i,n),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return objectEach(this.data[0],(r,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let r=null;isNaN(e)?r=e:r=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(r):i.__children.indexOf(r)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let r=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(arrayEach(i.__children,n=>{r+=1,n.__children&&(r+=this.countChildren(n))}),r)}getRowParent(e){let r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,r){var i;return((i=e.__children)===null||i===void 0?void 0:i[r])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var r;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((r=i.__children)===null||r===void 0?void 0:r.length)!==0}addChild(e,r){let i=r;this.hot.runHooks("beforeAddChild",e,i);let n=null;e&&(n=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),i||(i=this.mockNode()),s.__children.push(i),this.rewriteCache();const o=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,r,i){let n=i,s;if(n||(n=this.mockNode()),this.hot.runHooks("beforeAddChild",e,n,r),e){const a=this.getRowIndex(e)+r+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(r,null,n),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[r]);n=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,n,r)}addSibling(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),n=this.getRowParent(i),s=this.getRowIndexWithinParent(i);switch(r){case"below":this.addChildAtIndex(n,s+1,null);break;case"above":this.addChildAtIndex(n,s,null);break}}detachFromParent(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const n=[];Array.isArray(e)?(rangeEach(e[0],e[2],h=>{const f=this.translateTrimmedRow(h);n.push(this.getDataObject(f))}),rangeEach(0,n.length-2,h=>{this.detachFromParent(n[h],!1)}),i=n[n.length-1]):i=e;const s=this.getRowIndex(i),o=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),c=this.getRowParent(l),u=this.getRowIndex(c);let d=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){const h=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,h,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,h,this.plugin.pluginName),c){d=u+this.countChildren(c);const f=this.getChild(c,this.countChildren(c)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,o+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,o+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),r&&this.hot.render()}filterData(e,r,i){const n=[];arrayEach(i,s=>{n.push(this.getDataObject(s))}),arrayEach(n,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,r,i){const n=this.getDataObject(e-1);let s=null,o=e;n&&n.__children&&n.__children.length===0?(s=n,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?i?s.__children.splice(o,r,...i):s.__children.splice(o,r):i?this.data.splice(o,r,...i):this.data.splice(o,r),this.rewriteCache()}syncRowWithRawSource(e){let r=e,i=r;do i=this.getRowParent(i),i!==null&&(r=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,r,i,n){const s=r===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),c=e>r;let u=s?this.getRowParent(r-1):this.getRowParent(r);u==null&&(u=this.getRowParent(r-1)),u==null&&(u=this.getDataObject(r-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(r),u.__children=[]);const d=s||i||n?u.__children.length:this.getRowIndexWithinParent(r),h=o===u;u.__children.splice(d,0,l[0]),o.__children.splice(a+(c&&h?1:0),1),this.syncRowWithRawSource(o),h||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function _defineProperty$n(t,e,r){return(e=_toPropertyKey$n(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$n(t){var e=_toPrimitive$n(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$n(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BaseUI{constructor(e,r){_defineProperty$n(this,"hot",void 0),_defineProperty$n(this,"plugin",void 0),this.hot=r,this.plugin=e}}class HeadersUI extends BaseUI{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,r){super(e,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,r){const i=this.hot.toPhysicalRow(e),n=this.dataManager.getRowLevel(i),s=this.dataManager.getDataObject(i),o=r.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),c=this.hot.getSettings().ariaTags;if(arrayEach(l,u=>{u&&o.removeChild(u)}),addClass$1(r,HeadersUI.CSS_CLASSES.indicatorContainer),n){const{rootDocument:u}=this.hot,d=a.cloneNode(!0);o.innerHTML="",rangeEach(0,n-1,()=>{const h=u.createElement("SPAN");addClass$1(h,HeadersUI.CSS_CLASSES.emptyIndicator),o.appendChild(h)}),o.appendChild(d)}if(this.dataManager.hasChildren(s)){const u=this.hot.rootDocument.createElement("DIV");c&&setAttribute(u,[A11Y_HIDDEN()]),addClass$1(r,HeadersUI.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(addClass$1(u,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.expandButton}`),c&&setAttribute(r,[A11Y_EXPANDED(!1)])):(addClass$1(u,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.collapseButton}`),c&&setAttribute(r,[A11Y_EXPANDED(!0)])),o.appendChild(u)}}updateRowHeaderWidth(e){let r=e;r||(r=this.dataManager.cache.levelCount);let i=11;this.hot.stylesHandler.isClassicTheme()||(i=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*r+25),this.hot.render()}}class CollapsingUI extends BaseUI{constructor(e,r){var i;super(e,r),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,n)},shiftStash:function(n,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),arrayEach(i.lastCollapsedRows,(a,l)=>{a>=n&&a<s&&(i.lastCollapsedRows[l]=a+o)})},applyStash:function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,n),i.lastCollapsedRows=void 0},trimStash:(n,s)=>{rangeEach(n,n+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&arrayEach(s.__children,l=>{n.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(n,!0,!1),i&&this.trimRows(a),r&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=[];arrayEach(e,s=>{n.push(...this.collapseChildren(s,!1,!1))}),i&&this.trimRows(n),r&&this.renderAndAdjust()}collapseRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],r)}collapseRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=[];return arrayEach(e,s=>{n.push(s),r&&this.collapseChildRows(s,n)}),i&&this.trimRows(n),n}collapseChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const n=this.dataManager.getDataObject(e);arrayEach(n.__children,s=>{const o=this.dataManager.getRowIndex(s);r.push(o),this.collapseChildRows(o,r)})}i&&this.trimRows(r)}expandRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],r)}expandRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const n=[];return arrayEach(e,s=>{n.push(s),r&&this.expandChildRows(s,n)}),i&&this.untrimRows(n),n}expandChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const n=this.dataManager.getDataObject(e);arrayEach(n.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);r.push(o),this.expandChildRows(o,r)}})}i&&this.untrimRows(r)}expandChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&arrayEach(s.__children,l=>{const c=this.dataManager.getRowIndex(l);n.push(c)}),a=this.expandRows(n,!0,!1),i&&this.untrimRows(a),r&&this.renderAndAdjust(),a}expandMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=[];arrayEach(e,s=>{n.push(...this.expandChildren(s,!1,!1))}),i&&this.untrimRows(n),r&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),r=[];arrayEach(e,i=>{this.dataManager.hasChildren(i)&&r.push(i)}),this.collapseMultipleChildren(r),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),r=[];arrayEach(e,i=>{this.dataManager.hasChildren(i)&&r.push(i)}),this.expandMultipleChildren(r),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{arrayEach(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{arrayEach(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(e){let r=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return r===null&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&arrayEach(r.__children,n=>{const s=this.dataManager.getRowIndex(n);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return i=!1,!1}),i}isAnyParentCollapsed(e){let r=e;for(;r!==null;){r=this.dataManager.getRowParent(r);const i=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,r){if(r.col>=0)return;const i=this.translateTrimmedRow(r.row);hasClass$1(e.target,HeadersUI.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),stopImmediatePropagation(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function _classPrivateFieldInitSpec$4(t,e,r){_checkPrivateRedeclaration$8(t,e),e.set(t,r)}function _checkPrivateRedeclaration$8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$m(t,e,r){return(e=_toPropertyKey$m(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$m(t){var e=_toPrimitive$m(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$m(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$4(t,e){return t.get(_assertClassBrand$8(t,e))}function _assertClassBrand$8(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _menuEntries=new WeakMap;class ContextMenuUI extends BaseUI{constructor(){super(...arguments),_defineProperty$m(this,"dataManager",this.plugin.dataManager),_classPrivateFieldInitSpec$4(this,_menuEntries,{row_above:(e,r)=>{const i=r[r.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,r)=>{const i=r[r.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const r=[{key:"add_child",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),n=this.dataManager.getDataObject(i);this.dataManager.addChild(n)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),n=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(n)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return rangeEach(0,e.items.length-1,i=>{if(i===0)return arrayEach(r,(n,s)=>{e.items.splice(i+s,0,n)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return rangeEach(0,e.items.length-1,r=>{const i=_classPrivateFieldGet$4(_menuEntries,this)[e.items[r].key];i!=null&&(e.items[r].callback=i)}),e}}function _defineProperty$l(t,e,r){return(e=_toPropertyKey$l(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$l(t){var e=_toPrimitive$l(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$l(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RowMoveController{constructor(e){_defineProperty$l(this,"plugin",void 0),_defineProperty$l(this,"hot",void 0),_defineProperty$l(this,"dataManager",void 0),_defineProperty$l(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,i,n){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:i,movePossible:n}))return!1;this.movedToCollapsed=!1;const o=i===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let l=!0;const c=e.map(g=>{if(!l)return!1;const m=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(m,a),m}),u=c.indexOf(a)===-1;if(!l||!u)return!1;const d=this.getBaseParent(c),h=this.getTargetParent(o,a),f=d===h;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(h),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,a,f),this.moveRows(c,a,h),this.dataManager.rewriteCache(),this.moveCellsMeta(c,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,i,n,n&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:r,finalIndex:i,dropIndex:n,movePossible:s}=e;let o=!1;return isUndefined(n)&&(warn(toSingleLine`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",r,i,n,s,!1),o=!0),o}shouldAllowMoving(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,r){let i=this.dataManager.getRowParent(e?r-1:r);return i==null&&(i=this.dataManager.getRowParent(r-1)),i}shiftCollapsibleParentsLocations(e,r,i){i||(Math.max(...e)<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}moveRows(e,r,i){const n=r===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,r,this.movedToCollapsed,n)})})}moveCellsMeta(e,r){const i=[],n=Math.max(...e)<r;e.forEach(s=>{i.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(r-(n?i.length:0),0,...i)}selectCells(e,r){const i=e.length;let n=0,s=0;if(this.movedToCollapsed){let o=null;e[i-1]<r?o=this.dataManager.translateTrimmedRow(r-i):o=this.dataManager.translateTrimmedRow(r);const a=this.dataManager.getRowParent(o===null?this.hot.countSourceRows()-1:o-1),l=this.dataManager.getRowIndex(a);n=this.dataManager.untranslateTrimmedRow(l),s=n}else e[i-1]<r?(s=r-1,n=s-i+1):(n=r,s=n+i-1);this.hot.selectCells([[n,0,s,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,r){return e.some((i,n)=>i-n!==r)}}function _classPrivateMethodInitSpec$6(t,e){_checkPrivateRedeclaration$7(t,e),e.add(t)}function _classPrivateFieldInitSpec$3(t,e,r){_checkPrivateRedeclaration$7(t,e),e.set(t,r)}function _checkPrivateRedeclaration$7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$k(t,e,r){return(e=_toPropertyKey$k(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$k(t){var e=_toPrimitive$k(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$k(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _classPrivateFieldGet$3(t,e){return t.get(_assertClassBrand$7(t,e))}function _classPrivateFieldSet$3(t,e,r){return t.set(_assertClassBrand$7(t,e),r),r}function _assertClassBrand$7(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$6="nestedRows",PLUGIN_PRIORITY$6=300,SHORTCUTS_GROUP$1=PLUGIN_KEY$6,WRONG_DATA_TYPE_ERROR="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var _skipRender=new WeakMap,_skipCoreAPIModifiers=new WeakMap,_NestedRows_brand=new WeakSet;class NestedRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$6(this,_NestedRows_brand),_defineProperty$k(this,"dataManager",null),_defineProperty$k(this,"headersUI",null),_defineProperty$k(this,"collapsedRowsMap",null),_classPrivateFieldInitSpec$3(this,_skipRender,!1),_classPrivateFieldInitSpec$3(this,_skipCoreAPIModifiers,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$6}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$6}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$6]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new TrimmingMap),this.dataManager=new DataManager(this,this.hot),this.collapsingUI=new CollapsingUI(this,this.hot),this.headersUI=new HeadersUI(this,this.hot),this.contextMenuUI=new ContextMenuUI(this,this.hot),this.rowMoveController=new RowMoveController(this),this.addHook("afterInit",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onAfterInit).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onBeforeViewRender).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onFilterData).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onAfterContextMenuDefaultOptions).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onAfterGetRowHeader).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onBeforeOnCellMouseDown).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onBeforeRemoveRow).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onAfterRemoveRow).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onBeforeAddChild).call(e,...i)}),this.addHook("afterAddChild",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onAfterAddChild).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onBeforeDetachChild).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onAfterDetachChild).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onModifyRowHeaderWidth).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onAfterCreateRow).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$7(_NestedRows_brand,e,_onBeforeRowMove).call(e,...i)}),this.addHook("beforeLoadData",r=>_assertClassBrand$7(_NestedRows_brand,this,_onBeforeLoadData).call(this,r)),this.addHook("beforeUpdateData",r=>_assertClassBrand$7(_NestedRows_brand,this,_onBeforeLoadData).call(this,r)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(r)?this.collapsingUI.expandChildren(r):this.collapsingUI.collapseChildren(r),!1},runOnlyIf:()=>{var e,r;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:SHORTCUTS_GROUP$1,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$1)}disableCoreAPIModifiers(){_classPrivateFieldSet$3(_skipCoreAPIModifiers,this,!0)}enableCoreAPIModifiers(){_classPrivateFieldSet$3(_skipCoreAPIModifiers,this,!1)}onModifyRowData(e){if(!_classPrivateFieldGet$3(_skipCoreAPIModifiers,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!_classPrivateFieldGet$3(_skipCoreAPIModifiers,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,r,i){return _classPrivateFieldGet$3(_skipCoreAPIModifiers,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,r,i),!1)}destroy(){super.destroy()}}function _onBeforeRowMove(t,e,r,i){return this.rowMoveController.onBeforeRowMove(t,e,r,i)}function _onBeforeOnCellMouseDown(t,e,r){this.collapsingUI.toggleState(t,e,r)}function _onFilterData(t,e,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*e),this.dataManager.filterData(t,e,r),_classPrivateFieldSet$3(_skipRender,this,!0),this.dataManager.getData().slice()}function _onAfterContextMenuDefaultOptions(t){return this.contextMenuUI.appendOptions(t)}function _onAfterGetRowHeader(t,e){this.headersUI.appendLevelIndicators(t,e)}function _onModifyRowHeaderWidth(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function _onAfterRemoveRow(t,e,r,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{_classPrivateFieldSet$3(_skipRender,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function _onBeforeRemoveRow(t,e,r){const i=Array.from(r.reduce((n,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return n.add(s),Array.isArray(o)&&o.forEach(a=>n.add(this.dataManager.getRowIndex(a))),n}return n.add(s)},new Set));r.length=0,r.push(...i)}function _onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterAddChild(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterDetachChild(t,e,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onAfterCreateRow(){this.dataManager.rewriteCache()}function _onAfterInit(){this.headersUI.updateRowHeaderWidth()}function _onBeforeViewRender(t,e){_classPrivateFieldGet$3(_skipRender,this)&&(e.skipRender=!0)}function _onBeforeLoadData(t){if(!isArrayOfObjects(t)){error(WRONG_DATA_TYPE_ERROR),this.hot.getSettings()[PLUGIN_KEY$6]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function _defineProperty$j(t,e,r){return(e=_toPropertyKey$j(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$j(t){var e=_toPrimitive$j(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$j(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Storage{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;_defineProperty$j(this,"rootWindow",void 0),_defineProperty$j(this,"prefix",void 0),_defineProperty$j(this,"savedKeys",[]),this.rootWindow=r,this.prefix=e,this.loadSavedKeys()}saveValue(e,r){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,r){const i=typeof e>"u"?r:e,n=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return n===null?void 0:JSON.parse(n)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){arrayEach(this.savedKeys,(e,r)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[r]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function _defineProperty$i(t,e,r){return(e=_toPropertyKey$i(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$i(t){var e=_toPrimitive$i(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$i(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Hooks.getSingleton().register("persistentStateSave");Hooks.getSingleton().register("persistentStateLoad");Hooks.getSingleton().register("persistentStateReset");const PLUGIN_KEY$5="persistentState",PLUGIN_PRIORITY$5=0;class PersistentState extends BasePlugin{constructor(){super(...arguments),_defineProperty$i(this,"storage",void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$5}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$5}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$5]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Storage(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,r)=>this.saveValue(e,r)),this.addHook("persistentStateLoad",(e,r)=>this.loadValue(e,r)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,r){r.value=this.storage.loadValue(e)}saveValue(e,r){this.storage.saveValue(e,r)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function _classPrivateMethodInitSpec$5(t,e){_checkPrivateRedeclaration$6(t,e),e.add(t)}function _checkPrivateRedeclaration$6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$h(t,e,r){return(e=_toPropertyKey$h(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$h(t){var e=_toPrimitive$h(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$h(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$6(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$4="search",PLUGIN_PRIORITY$4=190,DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",DEFAULT_CALLBACK=function(t,e,r,i,n){t.getCellMeta(e,r).isSearchResult=n},DEFAULT_QUERY_METHOD=function(t,e,r){return isUndefined(t)||t===null||!t.toLocaleLowerCase||t.length===0||isUndefined(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1};var _Search_brand=new WeakSet;class Search extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$5(this,_Search_brand),_defineProperty$h(this,"callback",DEFAULT_CALLBACK),_defineProperty$h(this,"queryMethod",DEFAULT_QUERY_METHOD),_defineProperty$h(this,"searchResultClass",DEFAULT_SEARCH_RESULT_CLASS)}static get PLUGIN_KEY(){return PLUGIN_KEY$4}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$4}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$4]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[PLUGIN_KEY$4];this.updatePluginSettings(r),this.addHook("beforeRenderer",function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$6(_Search_brand,e,_onBeforeRenderer).call(e,...n)}),super.enablePlugin()}disablePlugin(){var e=this;const r=function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return _assertClassBrand$6(_Search_brand,e,_onBeforeRenderer).call(e,...n)};this.hot.addHook("beforeRenderer",r),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",r)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const n=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return rangeEach(0,n-1,l=>{rangeEach(0,s-1,c=>{const u=this.hot.getDataAtCell(l,c),d=this.hot.getCellMeta(l,c),h=d.search.callback||r,g=(d.search.queryMethod||i)(e,u,d);if(g){const m={row:l,col:c,data:u};o.push(m)}h&&h(a,l,c,u,g)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){isObject(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function _onBeforeRenderer(t,e,r,i,n,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function _defineProperty$g(t,e,r){return(e=_toPropertyKey$g(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$g(t){var e=_toPrimitive$g(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$g(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class StretchStrategy{constructor(e){_defineProperty$g(this,"viewportWidth",void 0),_defineProperty$g(this,"overwriteColumnWidthFn",void 0),_defineProperty$g(this,"baseWidths",new Map),_defineProperty$g(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:r}=e;this.viewportWidth=r,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,r){this.baseWidths.set(e,r)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class StretchAllStrategy extends StretchStrategy{calculate(){const e=Array.from(this.baseWidths).reduce((d,h)=>{let[,f]=h;return d+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,n=[],s=[];let o=this.viewportWidth,a=0;if(this.baseWidths.forEach((d,h)=>{const f=Math.round(d*i),g=this.overwriteColumnWidthFn(f,h);f===g&&f>=DEFAULT_WIDTH?(n.push([h,g]),a+=g):f!==g&&(n.push([h,g]),s.push(h),o-=g)}),o<=DEFAULT_WIDTH){this.stretchedWidths.clear();return}const l=o/a;let c=-1,u=0;n.forEach((d,h)=>{let[f,g]=d,m=g;s.includes(f)||(m=Math.round(g*l)),this.stretchedWidths.set(f,m),c=f,h<n.length-1&&(u+=m)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(c,Math.round(this.viewportWidth-u))}}function _classPrivateFieldInitSpec$2(t,e,r){_checkPrivateRedeclaration$5(t,e),e.set(t,r)}function _checkPrivateRedeclaration$5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$2(t,e){return t.get(_assertClassBrand$5(t,e))}function _classPrivateFieldSet$2(t,e,r){return t.set(_assertClassBrand$5(t,e),r),r}function _assertClassBrand$5(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _lastColumnWidth=new WeakMap,_lastColumnIndex=new WeakMap;class StretchLastStrategy extends StretchStrategy{constructor(){super(...arguments),_classPrivateFieldInitSpec$2(this,_lastColumnWidth,0),_classPrivateFieldInitSpec$2(this,_lastColumnIndex,-1)}prepare(e){super.prepare(e),_classPrivateFieldSet$2(_lastColumnWidth,this,0),_classPrivateFieldSet$2(_lastColumnIndex,this,-1)}setColumnBaseWidth(e,r){super.setColumnBaseWidth(e,r),_classPrivateFieldSet$2(_lastColumnIndex,this,e),_classPrivateFieldSet$2(_lastColumnWidth,this,r)}calculate(){if(_classPrivateFieldGet$2(_lastColumnIndex,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,n)=>{let[,s]=n;return i+s},0),r=Math.max(this.viewportWidth-e+_classPrivateFieldGet$2(_lastColumnWidth,this),0);this.stretchedWidths.set(_classPrivateFieldGet$2(_lastColumnIndex,this),r)}}function _classPrivateMethodInitSpec$4(t,e){_checkPrivateRedeclaration$4(t,e),e.add(t)}function _classPrivateFieldInitSpec$1(t,e,r){_checkPrivateRedeclaration$4(t,e),e.set(t,r)}function _checkPrivateRedeclaration$4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$1(t,e){return t.get(_assertClassBrand$4(t,e))}function _classPrivateFieldSet$1(t,e,r){return t.set(_assertClassBrand$4(t,e),r),r}function _assertClassBrand$4(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const STRETCH_WIDTH_MAP_NAME="stretchColumns";var _hot=new WeakMap,_widthsMap=new WeakMap,_stretchStrategies=new WeakMap,_activeStrategy=new WeakMap,_StretchCalculator_brand=new WeakSet;class StretchCalculator{constructor(e){_classPrivateMethodInitSpec$4(this,_StretchCalculator_brand),_classPrivateFieldInitSpec$1(this,_hot,void 0),_classPrivateFieldInitSpec$1(this,_widthsMap,void 0),_classPrivateFieldInitSpec$1(this,_stretchStrategies,new Map([["all",new StretchAllStrategy(_assertClassBrand$4(_StretchCalculator_brand,this,_overwriteColumnWidthFn).bind(this))],["last",new StretchLastStrategy(_assertClassBrand$4(_StretchCalculator_brand,this,_overwriteColumnWidthFn).bind(this))]])),_classPrivateFieldInitSpec$1(this,_activeStrategy,"none"),_classPrivateFieldSet$1(_hot,this,e),_classPrivateFieldSet$1(_widthsMap,this,_classPrivateFieldGet$1(_hot,this).columnIndexMapper.createAndRegisterIndexMap(STRETCH_WIDTH_MAP_NAME,"physicalIndexToValue"))}useStrategy(e){_classPrivateFieldSet$1(_activeStrategy,this,_classPrivateFieldGet$1(_stretchStrategies,this).has(e)?e:"none")}refreshStretching(){if(_classPrivateFieldGet$1(_activeStrategy,this)==="none"){_classPrivateFieldGet$1(_widthsMap,this).clear();return}_classPrivateFieldGet$1(_hot,this).batchExecution(()=>{_classPrivateFieldGet$1(_widthsMap,this).clear();const e=_classPrivateFieldGet$1(_stretchStrategies,this).get(_classPrivateFieldGet$1(_activeStrategy,this));let i=_classPrivateFieldGet$1(_hot,this).view.getViewportWidth();_assertClassBrand$4(_StretchCalculator_brand,this,_willVerticalScrollAppear).call(this)&&(i-=getScrollbarWidth(_classPrivateFieldGet$1(_hot,this).rootDocument)),e.prepare({viewportWidth:i});for(let n=0;n<_classPrivateFieldGet$1(_hot,this).countCols();n++)_classPrivateFieldGet$1(_hot,this).columnIndexMapper.isHidden(_classPrivateFieldGet$1(_hot,this).toPhysicalColumn(n))||e.setColumnBaseWidth(n,_assertClassBrand$4(_StretchCalculator_brand,this,_getWidthWithoutStretching).call(this,n));e.calculate(),e.getWidths().forEach(n=>{let[s,o]=n;_classPrivateFieldGet$1(_widthsMap,this).setValueAtIndex(_classPrivateFieldGet$1(_hot,this).toPhysicalColumn(s),o)})},!0)}getStretchedWidth(e){return _classPrivateFieldGet$1(_widthsMap,this).getValueAtIndex(_classPrivateFieldGet$1(_hot,this).toPhysicalColumn(e))}}function _willVerticalScrollAppear(){const{view:t,stylesHandler:e}=_classPrivateFieldGet$1(_hot,this);if(t.isVerticallyScrollableByWindow())return!1;const r=t.getViewportHeight(),i=_classPrivateFieldGet$1(_hot,this).countRows(),n=e.getDefaultRowHeight();let s=0,o=!1;for(let l=0;l<i;l++){var a;if(s+=((a=_classPrivateFieldGet$1(_hot,this).getRowHeight(l))!==null&&a!==void 0?a:n)+(l===0?1:0),s>r){o=!0;break}}return o}function _getWidthWithoutStretching(t){var e;return(e=_classPrivateFieldGet$1(_hot,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:DEFAULT_WIDTH}function _overwriteColumnWidthFn(t,e){return _classPrivateFieldGet$1(_hot,this).runHooks("beforeStretchingColumnWidth",t,e)}function _classPrivateMethodInitSpec$3(t,e){_checkPrivateRedeclaration$3(t,e),e.add(t)}function _classPrivateFieldInitSpec(t,e,r){_checkPrivateRedeclaration$3(t,e),e.set(t,r)}function _checkPrivateRedeclaration$3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet(t,e,r){return t.set(_assertClassBrand$3(t,e),r),r}function _classPrivateFieldGet(t,e){return t.get(_assertClassBrand$3(t,e))}function _assertClassBrand$3(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$3="stretchColumns",PLUGIN_PRIORITY$3=155;var _stretchCalculator=new WeakMap,_previousTableWidth=new WeakMap,_resizeObserver=new WeakMap,_StretchColumns_brand=new WeakSet;class StretchColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$3(this,_StretchColumns_brand),_classPrivateFieldInitSpec(this,_stretchCalculator,new StretchCalculator(this.hot)),_classPrivateFieldInitSpec(this,_previousTableWidth,null),_classPrivateFieldInitSpec(this,_resizeObserver,new ResizeObserver(e=>{requestAnimationFrame(()=>{var r;(r=this.hot)!==null&&r!==void 0&&r.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:n}=i;_classPrivateFieldGet(_previousTableWidth,this)!==null&&_classPrivateFieldGet(_previousTableWidth,this)!==n.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),_classPrivateFieldSet(_previousTableWidth,this,n.width)})})}))}static get PLUGIN_KEY(){return PLUGIN_KEY$3}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$3}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldGet(_stretchCalculator,this).useStrategy(this.hot.getSettings().stretchH),_classPrivateFieldGet(_resizeObserver,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$3(_StretchColumns_brand,e,_onBeforeRender).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand$3(_StretchColumns_brand,e,_onModifyColWidth).call(e,...i)},10),super.enablePlugin())}updatePlugin(){_classPrivateFieldGet(_stretchCalculator,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),_classPrivateFieldGet(_resizeObserver,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return _classPrivateFieldGet(_stretchCalculator,this).getStretchedWidth(e)}destroy(){_classPrivateFieldGet(_resizeObserver,this).disconnect(),_classPrivateFieldSet(_resizeObserver,this,null),_classPrivateFieldSet(_stretchCalculator,this,null),super.destroy()}}function _onModifyColWidth(t,e,r){if(r===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function _onBeforeRender(t){t&&_classPrivateFieldGet(_stretchCalculator,this).refreshStretching()}function _classPrivateMethodInitSpec$2(t,e){_checkPrivateRedeclaration$2(t,e),e.add(t)}function _checkPrivateRedeclaration$2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$f(t,e,r){return(e=_toPropertyKey$f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$f(t){var e=_toPrimitive$f(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$f(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$2="touchScroll",PLUGIN_PRIORITY$2=200;var _TouchScroll_brand=new WeakSet;class TouchScroll extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$2(this,_TouchScroll_brand),_defineProperty$f(this,"scrollbars",[]),_defineProperty$f(this,"clones",[]),_defineProperty$f(this,"lockedCollection",!1),_defineProperty$f(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$2}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$2}static get SETTING_KEYS(){return!0}isEnabled(){return isTouchSupported()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>_assertClassBrand$2(_TouchScroll_brand,this,_onAfterViewRender).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>_assertClassBrand$2(_TouchScroll_brand,this,_onBeforeTouchScroll).call(this)),this.addHook("afterMomentumScroll",()=>_assertClassBrand$2(_TouchScroll_brand,this,_onAfterMomentumScroll).call(this))}}function _onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(r),i&&this.scrollbars.push(i),n&&n.clone&&this.scrollbars.push(n),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),n&&n.clone&&this.clones.push(n.clone.wtTable.holder.parentNode)}function _onBeforeTouchScroll(){this.freezeOverlays=!0,arrayEach(this.clones,t=>{addClass$1(t,"hide-tween")})}function _onAfterMomentumScroll(){this.freezeOverlays=!1,arrayEach(this.clones,t=>{removeClass$1(t,"hide-tween"),addClass$1(t,"show-tween")}),this.hot._registerTimeout(()=>{arrayEach(this.clones,t=>{removeClass$1(t,"show-tween")})},400),arrayEach(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function _classPrivateMethodInitSpec$1(t,e){_checkPrivateRedeclaration$1(t,e),e.add(t)}function _checkPrivateRedeclaration$1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$e(t,e,r){return(e=_toPropertyKey$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$e(t){var e=_toPrimitive$e(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand$1(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$1="trimRows",PLUGIN_PRIORITY$1=330;var _TrimRows_brand=new WeakSet;class TrimRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$1(this,_TrimRows_brand),_defineProperty$e(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$1}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$1}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$1]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new TrimmingMap),this.trimmedRowsMap.addLocalHook("init",()=>_assertClassBrand$1(_TrimRows_brand,this,_onMapInit).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[PLUGIN_KEY$1];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),arrayEach(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const r=this.getTrimmedRows(),i=this.isValidConfig(e);let n=r;i&&(n=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeTrimRow",r,n,i)!==!1&&(i&&this.hot.batchExecution(()=>{arrayEach(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",r,n,i,i&&n.length>r.length))}trimRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.trimRows(r)}untrimRows(e){const r=this.getTrimmedRows(),i=this.isValidConfig(e);let n=r;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;i&&o&&(arrayEach(e,l=>{s[l]=!1}),n=arrayReduce(s,(l,c,u)=>(c&&l.push(u),l),[])),this.hot.runHooks("beforeUntrimRow",r,n,i&&o)!==!1&&(i&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",r,n,i&&o,i&&n.length<r.length))}untrimRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.untrimRows(r)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const r=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<r)}destroy(){super.destroy()}}function _onMapInit(){const t=this.hot.getSettings()[PLUGIN_KEY$1];Array.isArray(t)&&this.hot.batchExecution(()=>{arrayEach(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function _defineProperty$d(t,e,r){return(e=_toPropertyKey$d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$d(t){var e=_toPrimitive$d(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$d(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BaseAction{constructor(e){_defineProperty$d(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function _defineProperty$c(t,e,r){return(e=_toPropertyKey$c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$c(t){var e=_toPrimitive$c(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$c(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CellAlignmentAction extends BaseAction{constructor(e){let{stateBefore:r,range:i,type:n,alignment:s}=e;super("cell_alignment"),_defineProperty$c(this,"stateBefore",void 0),_defineProperty$c(this,"range",void 0),_defineProperty$c(this,"type",void 0),_defineProperty$c(this,"alignment",void 0),this.stateBefore=r,this.range=i,this.type=n,this.alignment=s}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(i,n,s,o)=>{r.done(()=>new CellAlignmentAction({stateBefore:i,range:n,type:s,alignment:o}))})}undo(e,r){arrayEach(this.range,i=>{i.forAll((n,s)=>{n>=0&&s>=0&&e.setCellMeta(n,s,"className",this.stateBefore[n][s]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){align(this.range,this.type,this.alignment,(i,n)=>e.getCellMeta(i,n),(i,n,s,o)=>e.setCellMeta(i,n,s,o)),e.addHookOnce("afterViewRender",r),e.render()}}function _defineProperty$b(t,e,r){return(e=_toPropertyKey$b(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$b(t){var e=_toPrimitive$b(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$b(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ColumnMoveAction extends BaseAction{constructor(e){let{columns:r,finalIndex:i}=e;super("col_move"),_defineProperty$b(this,"columns",void 0),_defineProperty$b(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(i,n)=>{i!==!1&&r.done(()=>new ColumnMoveAction({columns:i,finalIndex:n}))})}undo(e,r){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),getMoves(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),i.moveColumn(a,o)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function _defineProperty$a(t,e,r){return(e=_toPropertyKey$a(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$a(t){var e=_toPrimitive$a(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$a(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ColumnSortAction extends BaseAction{constructor(e){let{currentSortState:r,newSortState:i}=e;super("col_sort"),_defineProperty$a(this,"previousSortState",void 0),_defineProperty$a(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=i}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(i,n,s)=>{s&&r.done(()=>new ColumnSortAction({currentSortState:i,newSortState:n}))})}undo(e,r){const i=e.getPlugin("columnSorting"),n=e.getPlugin("multiColumnSorting"),s=n.isEnabled()?n:i;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),r()}redo(e,r){const i=e.getPlugin("columnSorting"),n=e.getPlugin("multiColumnSorting");(n.isEnabled()?n:i).sort(this.nextSortState),r()}}function _defineProperty$9(t,e,r){return(e=_toPropertyKey$9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$9(t){var e=_toPrimitive$9(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CreateColumnAction extends BaseAction{constructor(e){let{index:r,amount:i}=e;super("insert_col"),_defineProperty$9(this,"index",void 0),_defineProperty$9(this,"amount",void 0),this.index=r,this.amount=i}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(i,n,s)=>{r.done(()=>new CreateColumnAction({index:i,amount:n}),s)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function _defineProperty$8(t,e,r){return(e=_toPropertyKey$8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$8(t){var e=_toPrimitive$8(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CreateRowAction extends BaseAction{constructor(e){let{index:r,amount:i}=e;super("insert_row"),_defineProperty$8(this,"index",void 0),_defineProperty$8(this,"amount",void 0),this.index=r,this.amount=i}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(i,n,s)=>{r.done(()=>new CreateRowAction({index:i,amount:n}),s)})}undo(e,r){const i=e.countRows(),n=e.getSettings().minSpareRows;this.index>=i&&this.index-n<i&&(this.index-=n),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function _defineProperty$7(t,e,r){return(e=_toPropertyKey$7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$7(t){var e=_toPrimitive$7(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DataChangeAction extends BaseAction{constructor(e){let{changes:r,selected:i,countCols:n,countRows:s}=e;super("change"),_defineProperty$7(this,"changes",void 0),_defineProperty$7(this,"selected",void 0),_defineProperty$7(this,"countCols",void 0),_defineProperty$7(this,"countRows",void 0),this.changes=r,this.selected=i,this.countCols=n,this.countRows=s}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(i,n){const s=i&&i.length;if(!s||!i.find(l=>{const[,,c,u]=l;return c!==u}))return;const a=()=>{const l=i.reduce((u,d)=>(u.push([...d]),u),[]);l.forEach(u=>{u[1]=e.propToCol(u[1])});const c=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new DataChangeAction({changes:l,selected:c,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,n)})}undo(e,r){const i=deepClone(this.changes);for(let o=0,a=i.length;o<a;o++)i[o].splice(3,1);e.addHookOnce("afterChange",r),e.setDataAtCell(i,null,null,"UndoRedo.undo");const n=e.countRows()-this.countRows;n>0&&e.alter("remove_row",null,n,"UndoRedo.undo");const s=e.countCols()-this.countCols;s>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,s,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,r){const i=deepClone(this.changes);for(let n=0,s=i.length;n<s;n++)i[n].splice(2,1);e.addHookOnce("afterChange",r),e.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function _defineProperty$6(t,e,r){return(e=_toPropertyKey$6(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$6(t){var e=_toPrimitive$6(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$6(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FiltersAction extends BaseAction{constructor(e){let{conditionsStack:r,previousConditionsStack:i}=e;super("filter"),_defineProperty$6(this,"conditionsStack",void 0),_defineProperty$6(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=i}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(i,n)=>{r.done(()=>new FiltersAction({conditionsStack:i,previousConditionsStack:n}))})}undo(e,r){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),i.importConditions(this.previousConditionsStack),i.filter()}redo(e,r){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),i.importConditions(this.conditionsStack),i.filter()}}function _defineProperty$5(t,e,r){return(e=_toPropertyKey$5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$5(t){var e=_toPrimitive$5(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MergeCellsAction extends BaseAction{constructor(e){let{data:r,cellRange:i}=e;super("merge_cells"),_defineProperty$5(this,"cellRange",void 0),this.cellRange=i,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(i,n)=>{if(n)return;const s=i.getTopStartCorner(),o=i.getBottomEndCorner(),a=e.getData(s.row,s.col,o.row,o.col);r.done(()=>new MergeCellsAction({data:a,cellRange:i}))})}undo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.unmergeRange(this.cellRange,!0);const n=this.cellRange.getTopStartCorner();e.populateFromArray(n.row,n.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.mergeRange(this.cellRange)}}function getCellMetas(t,e,r,i,n){const s=["visualRow","visualCol","row","col","prop"],o=s.length,a=[];return rangeEach(i,n,l=>{rangeEach(e,r,c=>{const u=t.getCellMeta(c,l);if(Object.keys(u).length!==o){const d=Object.fromEntries(Object.entries(u).filter(h=>{let[f]=h;return s.includes(f)===!1}));a.push([u.visualRow,u.visualCol,d])}})}),a}function _defineProperty$4(t,e,r){return(e=_toPropertyKey$4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$4(t){var e=_toPrimitive$4(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$4(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RemoveColumnAction extends BaseAction{constructor(e){let{index:r,indexes:i,data:n,amount:s,headers:o,columnPositions:a,rowPositions:l,fixedColumnsStart:c,removedCellMetas:u}=e;super("remove_col"),_defineProperty$4(this,"index",void 0),_defineProperty$4(this,"indexes",void 0),_defineProperty$4(this,"data",void 0),_defineProperty$4(this,"amount",void 0),_defineProperty$4(this,"headers",void 0),_defineProperty$4(this,"columnPositions",void 0),_defineProperty$4(this,"rowPositions",void 0),_defineProperty$4(this,"fixedColumnsStart",void 0),_defineProperty$4(this,"removedCellMetas",void 0),this.index=r,this.indexes=i,this.data=n,this.amount=s,this.headers=o,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=c,this.removedCellMetas=u}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(i,n,s,o)=>{const a=()=>{const l=e.getSourceDataArray(),c=(e.countCols()+i)%e.countCols(),u=c+n-1,d=[],h=[],f=[];return rangeEach(l.length-1,g=>{const m=[],C=l[g];rangeEach(c,u,y=>{m.push(C[e.toPhysicalColumn(y)])}),d.push(m)}),rangeEach(n-1,g=>{f.push(e.toPhysicalColumn(c+g))}),Array.isArray(e.getSettings().colHeaders)&&rangeEach(n-1,g=>{h.push(e.getSettings().colHeaders[e.toPhysicalColumn(c+g)]||null)}),new RemoveColumnAction({index:c,indexes:f,data:d,amount:n,headers:h,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:getCellMetas(e,0,e.countRows(),c,u)})};r.done(a,o)})}undo(e,r){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),s=(u,d,h)=>h[this.indexes.indexOf(n[d])],o=this.data.length,a=[];for(let u=0;u<o;u++)a.push(arrayMap(this.data[u],s));const l=arrayMap(this.headers,s),c=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),arrayEach(e.getSourceDataArray(),(u,d)=>{arrayEach(n,(h,f)=>{u[h]=a[d][f],c.push([d,h,u[h]])})}),typeof this.headers<"u"&&arrayEach(l,(u,d)=>{e.getSettings().colHeaders[n[d]]=u}),this.removedCellMetas.forEach(u=>{let[d,h,f]=u;e.setCellMetaObject(d,h,f)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(c,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function _defineProperty$3(t,e,r){return(e=_toPropertyKey$3(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$3(t){var e=_toPrimitive$3(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$3(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RemoveRowAction extends BaseAction{constructor(e){let{index:r,data:i,fixedRowsBottom:n,fixedRowsTop:s,rowIndexesSequence:o,removedCellMetas:a}=e;super("remove_row"),_defineProperty$3(this,"index",void 0),_defineProperty$3(this,"data",void 0),_defineProperty$3(this,"fixedRowsBottom",void 0),_defineProperty$3(this,"fixedRowsTop",void 0),_defineProperty$3(this,"rowIndexesSequence",void 0),_defineProperty$3(this,"removedCellMetas",void 0),this.index=r,this.data=i,this.fixedRowsBottom=n,this.fixedRowsTop=s,this.rowIndexesSequence=o,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(i,n,s,o)=>{const a=()=>{const l=e.toPhysicalRow(i),c=l+n-1,u=deepClone(e.getSourceData(l,0,l+n-1,e.countSourceCols()-1));return new RemoveRowAction({index:l,data:u,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:getCellMetas(e,l,c,0,e.countCols()-1)})};r.done(a,o)})}undo(e,r){const i=e.getSettings(),n=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,o)=>{Object.keys(s).forEach(a=>{const l=parseInt(a,10);n.push([this.index+o,isNaN(l)?a:l,s[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(s=>{let[o,a,l]=s;e.setCellMetaObject(o,a,l)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(n,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function _defineProperty$2(t,e,r){return(e=_toPropertyKey$2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$2(t){var e=_toPrimitive$2(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RowMoveAction extends BaseAction{constructor(e){let{rows:r,finalIndex:i}=e;super("row_move"),_defineProperty$2(this,"rows",void 0),_defineProperty$2(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(i,n)=>{i!==!1&&r.done(()=>new RowMoveAction({rows:i,finalIndex:n}))})}undo(e,r){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),getMoves(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),i.moveRow(a,o)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function _defineProperty$1(t,e,r){return(e=_toPropertyKey$1(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey$1(t){var e=_toPrimitive$1(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UnmergeCellsAction extends BaseAction{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),_defineProperty$1(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(i,n)=>{n||r.done(()=>new UnmergeCellsAction({cellRange:i}))})}undo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.mergeRange(this.cellRange,!0)}redo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.unmergeRange(this.cellRange,!0),e.render()}}function registerActions(t,e){[CellAlignmentAction,ColumnMoveAction,ColumnSortAction,CreateColumnAction,CreateRowAction,DataChangeAction,FiltersAction,MergeCellsAction,RemoveColumnAction,RemoveRowAction,RowMoveAction,UnmergeCellsAction].forEach(r=>r.startRegisteringEvents(t,e))}function _classPrivateMethodInitSpec(t,e){_checkPrivateRedeclaration(t,e),e.add(t)}function _checkPrivateRedeclaration(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _assertClassBrand(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const SHORTCUTS_GROUP="undoRedo",PLUGIN_KEY="undoRedo",PLUGIN_PRIORITY=1e3;Hooks.getSingleton().register("beforeUndo");Hooks.getSingleton().register("afterUndo");Hooks.getSingleton().register("beforeRedo");Hooks.getSingleton().register("afterRedo");const deprecationWarns=new Set;var _UndoRedo_brand=new WeakSet;class UndoRedo extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY}static get SETTING_KEYS(){return!0}constructor(e){super(e),_classPrivateMethodInitSpec(this,_UndoRedo_brand),_defineProperty(this,"doneActions",[]),_defineProperty(this,"undoneActions",[]),_defineProperty(this,"ignoreNewActions",!1),registerActions(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return _assertClassBrand(_UndoRedo_brand,e,_onAfterChange).call(e,...i)}),this.registerShortcuts(),_assertClassBrand(_UndoRedo_brand,this,_exposeAPIToCore).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),_assertClassBrand(_UndoRedo_brand,this,_removeAPIFromCore).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),n={runOnlyIf:s=>!s.altKey,group:SHORTCUTS_GROUP};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const n=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",n,r)===!1)return;const o=e(),a=this.undoneActions.slice();this.doneActions.push(o),this.hot.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=deepClone(r);if(this.hot.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const s=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",s),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=deepClone(r);if(this.hot.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const s=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",s),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function _onAfterChange(t,e){e==="loadData"&&this.clear()}function _exposeAPIToCore(){const t=e=>{deprecationWarns.has(e)||(warn(toSingleLine`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),deprecationWarns.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function _removeAPIFromCore(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function registerAllPlugins(){registerPlugin(AutoColumnSize),registerPlugin(Autofill),registerPlugin(AutoRowSize),registerPlugin(BindRowsWithHeaders),registerPlugin(CollapsibleColumns),registerPlugin(ColumnSorting),registerPlugin(ColumnSummary),registerPlugin(Comments),registerPlugin(ContextMenu),registerPlugin(CopyPaste),registerPlugin(CustomBorders),registerPlugin(DragToScroll),registerPlugin(DropdownMenu),registerPlugin(ExportFile),registerPlugin(Filters),registerPlugin(Formulas),registerPlugin(HiddenColumns),registerPlugin(HiddenRows),registerPlugin(ManualColumnFreeze),registerPlugin(ManualColumnMove),registerPlugin(ManualColumnResize),registerPlugin(ManualRowMove),registerPlugin(ManualRowResize),registerPlugin(MergeCells),registerPlugin(MultiColumnSorting),registerPlugin(MultipleSelectionHandles),registerPlugin(NestedHeaders),registerPlugin(NestedRows),registerPlugin(PersistentState),registerPlugin(Search),registerPlugin(StretchColumns),registerPlugin(TouchScroll),registerPlugin(TrimRows),registerPlugin(UndoRedo)}function registerAllModules(){registerAllEditors(),registerAllRenderers(),registerAllValidators(),registerAllCellTypes(),registerAllPlugins()}function jQueryWrapper(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(r){const i=this.first();let n=i.data("handsontable");if(typeof r!="string"){const c=r||{};return n?n.updateSettings(c):(n=new t.Core(i[0],c),i.data("handsontable",n),n.init()),i}let s;if(n)if(typeof n[r]<"u"){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];s=n[r].call(n,...a),r==="destroy"&&i.removeData()}else throw new Error(`Handsontable do not provide action: ${r}`);return s})}var _Handsontable$cellTyp,_Handsontable$editors,_Handsontable$rendere,_Handsontable$validat,_Handsontable$plugins;registerAllModules();jQueryWrapper(Handsontable$1);Handsontable$1.__GhostTable=GhostTable$1;Handsontable$1._getListenersCounter=getListenersCounter;Handsontable$1._getRegisteredMapsCounter=getRegisteredMapsCounter;Handsontable$1.EventManager=EventManager;const HELPERS=[arrayHelpers,browserHelpers,dataHelpers,dateHelpers,featureHelpers,functionHelpers,mixedHelpers,numberHelpers,objectHelpers,stringHelpers,unicodeHelpers,parseTableHelpers],DOM=[domHelpers,domEventHelpers];Handsontable$1.helper={};Handsontable$1.dom={};arrayEach(HELPERS,t=>{arrayEach(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Handsontable$1.helper[e]=t[e])})});arrayEach(DOM,t=>{arrayEach(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Handsontable$1.dom[e]=t[e])})});Handsontable$1.cellTypes=(_Handsontable$cellTyp=Handsontable$1.cellTypes)!==null&&_Handsontable$cellTyp!==void 0?_Handsontable$cellTyp:{};arrayEach(getNames(),t=>{Handsontable$1.cellTypes[t]=_getItem(t)});Handsontable$1.cellTypes.registerCellType=_register;Handsontable$1.cellTypes.getCellType=_getItem;Handsontable$1.editors=(_Handsontable$editors=Handsontable$1.editors)!==null&&_Handsontable$editors!==void 0?_Handsontable$editors:{};arrayEach(getNames$3(),t=>{Handsontable$1.editors[`${toUpperCaseFirst(t)}Editor`]=_getItem$3(t)});Handsontable$1.editors.registerEditor=_register$3;Handsontable$1.editors.getEditor=_getItem$3;Handsontable$1.renderers=(_Handsontable$rendere=Handsontable$1.renderers)!==null&&_Handsontable$rendere!==void 0?_Handsontable$rendere:{};arrayEach(getNames$2(),t=>{const e=_getItem$2(t);t==="base"&&(Handsontable$1.renderers.cellDecorator=e),Handsontable$1.renderers[`${toUpperCaseFirst(t)}Renderer`]=e});Handsontable$1.renderers.registerRenderer=_register$2;Handsontable$1.renderers.getRenderer=_getItem$2;Handsontable$1.validators=(_Handsontable$validat=Handsontable$1.validators)!==null&&_Handsontable$validat!==void 0?_Handsontable$validat:{};arrayEach(getNames$1(),t=>{Handsontable$1.validators[`${toUpperCaseFirst(t)}Validator`]=_getItem$1(t)});Handsontable$1.validators.registerValidator=_register$1;Handsontable$1.validators.getValidator=_getItem$1;Handsontable$1.plugins=(_Handsontable$plugins=Handsontable$1.plugins)!==null&&_Handsontable$plugins!==void 0?_Handsontable$plugins:{};arrayEach(getPluginsNames(),t=>{Handsontable$1.plugins[t]=getPlugin(t)});Handsontable$1.plugins[`${toUpperCaseFirst(BasePlugin.PLUGIN_KEY)}Plugin`]=BasePlugin;Handsontable$1.plugins.registerPlugin=registerPlugin;Handsontable$1.plugins.getPlugin=getPlugin;const Handsontable=Object.freeze(Object.defineProperty({__proto__:null,CellCoords,CellRange,default:Handsontable$1},Symbol.toStringTag,{value:"Module"})),hotLanguageHandler=(t,{code:e,language:r})=>{const i={nestedHeaders:[[]],data:[],columns:[],manualColumnResize:!0,licenseKey:"non-commercial-and-evaluation",mergeCells:[],height:"auto",readOnly:!0,modifyColWidth:(u,d)=>u>300?300:u};let n=null,s={},o=0,a=[],l=()=>{for(const[u,d]of i.nestedHeaders.entries())if(a[u])a[u].colspan++;else{const h=d.reduce((f,g)=>f+(["undefined","string"].includes(typeof g)?1:g.colspan),0);o>h&&d.push(...new Array(o-h))}};for(const u of e.split(`
`)){if(u.startsWith("# OPTIONS")){n="options";continue}else if(u.startsWith("# COLUMNS")){n="columns";continue}else if(u.startsWith("# DATA")){n="data";continue}switch(n){case"options":{const d=u.split(":").map(h=>h.trim());["true","false"].includes(d[1])?i[d[0]]=d[1]==="true":i[d[0]]=d[1];continue}case"columns.options":{if(u.trim()==="}"){i.columns.push(s),s={},n="columns";continue}const d=u.split(":").map(h=>h.trim());["true","false"].includes(d[1])?s[d[0]]=d[1]==="true":s[d[0]]=d[1];continue}case"columns":{if(u.endsWith("[")){if(a.push({label:u.substr(0,u.length-2).trim(),colspan:0}),i.nestedHeaders.length<=a.length){const d=[];o>0&&d.push(...new Array(o)),i.nestedHeaders.push(d)}}else if(u.trim()==="]"){const d=a.pop();i.nestedHeaders[a.length].push(d)}else u.endsWith("{")?(i.nestedHeaders[a.length].push(u.substr(0,u.length-2).trim()),n="columns.options",o++,l()):(i.columns.push({}),i.nestedHeaders[a.length].push(u.trim()),o++,l());continue}case"data":{const d=u.split("|").map(h=>h.trim().replace(/\\n/g,`
`));for(const[h,f]of d.entries()){const m=/^<\$(?:w(?<width>\d+))?\s?(?:h(?<height>\d+))?\s?(?:s"(?<styling>.+?)")?\>/gm.exec(f);if(m){if(m.groups.height||m.groups.width){const C=parseInt(m.groups.height)||1,y=parseInt(m.groups.width)||1,v=i.data.length;i.mergeCells.push({col:h,row:v,colspan:y,rowspan:C})}d[h]=d[h].substring(m[0].length)}}i.data.push(d);continue}default:continue}}const c=`<div id="HOTable-${t.length}"></div>`;return t.push(i),c},hotLanguageSerialize=t=>{const e=t.getData(),r=t.getSettings().nestedHeaders,i=t.getSettings().mergeCells,n=t.getSettings().columns,s=Object.entries(Object.getPrototypeOf(t.getSettings())),o={};for(const[u,d]of s)typeof d=="boolean"&&d!==Handsontable$1.DefaultSettings[u]&&(o[u]=d);delete o.contextMenu,delete o.manualColumnResize,console.log(i);let a="```handsontable\n";a+=`# OPTIONS
`;for(const[u,d]of Object.entries(o))a+=`${u}: ${d}
`;a+=`# COLUMNS
`;const l=new Array(r.length).fill(0),c=(u,d)=>{let h=l[u],f=0;for(;h<r[u].length&&!["string","object"].includes(typeof r[u][h]);)h++;for(;f<d&&h<r[u].length;){if(typeof r[u][h]=="object")a+=`${"".padStart(u*2," ")}${r[u][h].label} [
`,c(u+1,r[u][h].colspan),f+=r[u][h].colspan;else if(typeof r[u][h]=="string"){a+=`${"".padStart(u*2," ")}${r[u][h]}`;let g=0;for(let m=0;m<h;m++)g+=["undefined","string"].includes(typeof r[u][m])?1:r[u][m].colspan;if(Object.keys(n[g]).length>0){a+=` {
`;for(const[m,C]of Object.entries(n[f]))a+=`${"".padStart((u+1)*2," ")}${m}: ${C}
`;a+=`${"".padStart(u*2," ")}}
`}else a+=`
`;f+=1}else f+=1;h++}u!==0&&(a+=`${"".padStart((u-1)*2," ")}]
`),l[u]=h};c(0,r[0].reduce((u,d)=>u+(["undefined","string"].includes(typeof d)?1:d.colspan),0)),a+=`# DATA
`,console.log(e),console.log(i);for(const u of i)e[u.row][u.col]=`<$w${u.colspan}h${u.rowspan}>`+e[u.row][u.col];for(let u=0;u<e.length;u++)e[u]=e[u].join("|").replace(/\r?\n/g,"\\n");return a+=e.join(`
`),a+="\n```",a},currentPath=(()=>{const{subscribe:t,set:e}=writable("");let r=!0,i=location.search;return window.addEventListener("popstate",n=>{location.search!=i&&(console.log(i),console.log(location.search),location.reload())}),{subscribe:t,set:n=>(r||window.history.pushState({},"",`${window.location.origin}${window.location.pathname}?page=${n}`),i=location.search,r=!1,e(n)),reset:()=>e("")}})(),hostRootAddr=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"./docs/":"https://raw.githubusercontent.com/fudgepop01/fudgepop01.github.io/master/portfolio/public/docs/",defaultTypes=["bool","char","i8","u8","short","i16","u16","int","i32","u32","long","i64","u64","long long","i128","u128","float","f32","double","f64","long double"],currStuctPathStore=()=>{let t="";const{subscribe:e,set:r}=writable("");return{subscribe:e,set:i=>{let n;(n=i.toLowerCase().indexOf("/structs/"))!==-1&&(i=i.substring(0,n+8),i!=t&&(t=i,r(i)))}}},currStructPath=currStuctPathStore(),typeDataStore=()=>{const{subscribe:t,update:e}=writable(JSON.parse(localStorage.getItem("structs")||"{}"));return{subscribe:t,addTypes:async r=>{const i=await(await fetch(`${hostRootAddr}${r}/_consolidated.json`)).json();e(n=>{const s={...n,[r]:i};return localStorage.setItem("structs",JSON.stringify(s)),s})}}},typeData=typeDataStore();currStructPath.subscribe(t=>{t.length&&typeData.addTypes(t)});currentPath.subscribe(t=>{currStructPath.set(t)});const typeList=derived([typeData,currStructPath],([t,e])=>t[e]==null?[...defaultTypes]:[...defaultTypes,...Object.keys(t[e])]);let currentTypeList=[],currentTypeData={},currentStructPath="";typeList.subscribe(t=>{currentTypeList=t});typeData.subscribe(t=>{currentTypeData=t[currentStructPath]});currStructPath.subscribe(t=>{currentStructPath=t});Handsontable$1.renderers.registerRenderer("type",(t,e,r,i,n,s,o)=>{if(e.style.fontFamily="monospace",typeof s=="string"&&o.readOnly){const a=s.endsWith("*")?s.substring(0,s.length-1):s;if(e.innerHTML="",currentTypeData[a]){const l=document.createElement("span");l.onclick=()=>currentPath.set(currentTypeData[a].path.substring(1)),l.className="link",l.innerText=s,e.appendChild(l)}else{const l=document.createElement("span");l.innerText=s,e.appendChild(l)}}return o.readOnly&&e.classList.add("htDimmed"),e});const typeSizeMap=t=>{if(t.endsWith("*"))return 4;switch(t.startsWith("unsigned")||t.startsWith("signed")?t=t.substring(t.indexOf(" ")):(t.startsWith("u")||t.startsWith("i"))&&(t=t.substring(1)),t){case"bool":return 1;case"char":case"8":return 1;case"short":case"short int":case"16":return 2;case"int":case"32":return 4;case"long":case"long int":case"64":return 8;case"long long":case"long long int":case"128":return 16;case"float":case"f32":return 4;case"double":case"f64":return 8;case"long double":return 12;default:return}},structHandler=(t,e,{code:r,language:i})=>{const n={nestedHeaders:[["offset",{colspan:1,label:"type"},"length","name","comments"]],data:[],columns:[{renderer:"hex"},{renderer:"type",type:"autocomplete",source:currentTypeList,strict:!1},{},{},{}],mergeCells:[],manualColumnResize:!0,licenseKey:"non-commercial-and-evaluation",height:"auto",readOnly:!0,modifyColWidth:(f,g)=>f>300?300:f},s={colHeaders:["offset","type","name","comments"],data:[],columns:[{renderer:"hex"},{renderer:"type",type:"autocomplete",source:currentTypeList,strict:!1},{},{}],manualColumnResize:!0,licenseKey:"non-commercial-and-evaluation",height:"auto",readOnly:!0,modifyColWidth:(f,g)=>f>300?300:f},o=[],a=[];let l="",c={offsetType:"rel",comments:"",offset:"0x00000000"},u=0,d="";for(const f of r.replace(/\r/g,"").split(`
`).map(g=>g.trim())){if(f.endsWith("{")){l=f.substring(0,f.length-1);continue}if(f.startsWith("$$")){c.offset=`0x${f.substring(2)}`,c.offsetType="abs";continue}if(f.startsWith("$")){const v=parseInt(f.substring(1),16);a.push({name:"_spacer",offsetType:"rel",offset:`0x${u.toString(16).padStart(8,"0")}`,comments:"",type:"char",length:v-u}),c.offset=`0x${v.toString(16).padStart(8,"0")}`,u=v;continue}if(f.startsWith("//")){const v=f.substring(2).trim();if(v.startsWith("@param")){const E=/@param\s(?<varName>\w+)\s(?<comment>.+)/g.exec(v);c.arguments||(c.arguments={}),d=E.groups.varName,c.arguments[d]||(c.arguments[d]={comments:""}),c.arguments[d].comments||(c.arguments[d].comments=""),E.groups.comment&&(c.arguments[d].comments+=E.groups.comment)}else v.startsWith("@return")?(d="@return",c.return||(c.return={}),c.return.comments||(c.return={comments:""}),c.return.comments+=v.substring(8)):(c.return||(c.return={comments:""}),d==="@return"?c.return.comments+=` ${v}`:d.length?c.arguments[d].comments+=` ${v}`:c.comments+=` ${v}`);continue}const m=/(?<returnType>(?:unsigned\s|signed\s)?\w+\*?)\s(?<fnName>\w+)\((?<args>.+)\)/g.exec(f);if(m){c.arguments||(c.arguments={}),c.return||(c.return={}),c.return.type=m.groups.returnType,c.name=m.groups.fnName;const v=/(?<typing>(?:unsigned\s|signed\s)?\w+\*?)\s(?<argName>\w+)/g;let E;for(;(E=v.exec(m.groups.args))!==null;)c.arguments[E.groups.argName]||(c.arguments[E.groups.argName]={}),c.arguments[E.groups.argName].type=E.groups.typing;o.push(c),d="",c={comments:"",offsetType:"rel",offset:`0x${u.toString(16).padStart(8,"0")}`}}const y=/(?<type>(?:unsigned\s|signed\s)?\w+\*?)\s(?<name>\w+)(?:\[(?<count>\d+)\])?/g.exec(f);if(y){c.name=y.groups.name,c.type=y.groups.type;const v=parseInt(y.groups.count)||1;y.groups.count&&(c.length=v),console.log(c.name,currentTypeData);const E=(typeSizeMap(c.type)||currentTypeData[c.type]?.size||0)*v;E!==0&&(a.push(c),u+=E),d="",c={comments:"",offsetType:"rel",offset:`0x${u.toString(16).padStart(8,"0")}`}}}for(const[f,g]of a.entries())n.data.push([g.offset,g.type,g.length||"",g.name,g.comments]);for(const f of o){if(s.data.push([f.offset,f.return.type,f.name,f.comments]),f.arguments)for(const[g,m]of Object.entries(f.arguments))s.data.push(["",m.type,g,m.comments]);f.return&&s.data.push(["",f.return.type,"@return",f.return.comments])}o.length===0&&s.data.push(["","","",""]);const h=`<div id="structTable-${t.length}"></div>`;return t.push({name:l,properties:n,functions:s}),h},rendererFactory=(t,e,r,i)=>({code(n,s,o){switch(s){case"handsontable":return hotLanguageHandler(t.hotLang,{code:n,language:s});case"struct":return structHandler(t.struct.tableData,t.struct.getCurrentData,{code:n,language:s});default:return!1}},heading(n,s,o,a){return e.push({text:o,level:s,id:a.slug(o,{dryrun:!0})}),!1},link(n,s,o){const a=get$3(currentPath),l=a.substring(0,a.lastIndexOf("/"));if(n.startsWith("/")||n.startsWith("./")||n.startsWith("..")){const c=n.indexOf("#")==-1?void 0:n.indexOf("#");return n.endsWith(".md")&&(n=n.substring(0,n.length-3)),n.charAt(0)==="."&&(n=new URL("http://a.b.c/"+l+"/"+n).pathname.substring(1)),n.charAt(0)==="/"&&(n=n.substring(1)),r.includes(n.substring(0,c))?`<a href="${window.location.origin}${window.location.pathname}?page=${n.substring(0,c)}&location=${c?new Slugger().slug(n.substring(c),{dryrun:!0}):""}">${o}</a>`:`<span class="invalid-link" data-targetpage="${n.substring(0,c)}">${o}</span>`}else{if(n.startsWith("#"))return`<a href="${window.location.origin}${window.location.pathname}?page=${localStorage.getItem("lastPage")}&location=${new Slugger().slug(n.substring(1),{dryrun:!0})}">${o}</a>`;if(n.includes("localhost")||n.includes("fudgepop01.github.io/portfolio")){const c=new URLSearchParams(n.substring(n.indexOf("?"))).get("page");return r.includes(c)?`<a href="${window.location.origin}${window.location.pathname}${n.replace(/https?:\/\/(?:localhost:\d{4}|fudgepop01\.github\.io)/g,"")}">${o}</a>`:`<span class="invalid-link" data-targetpage="${c}">${o}</span>`}}return!1},image(n,s,o){if(console.log(n,s,o),o==="SCRIPT")return window.location.hostname==="localhost"?i=[...i,`${window.location.origin}${window.location.pathname}docs/${n.substring(1)}.js`]:window.location.origin==="https://fudgepop01.github.io"&&(i=[...i,`https://raw.githubusercontent.com/fudgepop01/fudgepop01.github.io/main/public/docs/${n.substring(1)}.js`]),"";if(n.startsWith("./")||n.startsWith("..")){const a=get$3(currentPath),l=a.substring(0,a.lastIndexOf("/"));return n.charAt(0)==="."&&(n=new URL("http://a.b.c/"+l+"/"+n).pathname.substring(1)),`
        <div img-container alt="${o}"><img src="${hostRootAddr+n}" alt="${o}"></div>`}return!1}}),copyToClipboard=t=>{navigator.clipboard.writeText(encodeURI(t))},registerHexRenderers=()=>{Handsontable$1.renderers.registerRenderer("hex",(t,e,r,i,n,s,o)=>(e.style.fontFamily="monospace",e.style.fontWeight="bold",e.style.textAlign="center",typeof s=="string"?s.length>0?e.innerText="0x"+(s.startsWith("0x")?parseInt(s,16):parseInt(s)).toString(16).toUpperCase():e.innerText="-":typeof s=="number"?e.innerText="0x"+s.toString(16).toUpperCase():e.innerText="NaN",o.readOnly&&(e.className="htDimmed"),e))};var on_click$3=(t,e,r,i)=>{t.stopPropagation(),e()(r()+get$4(i))},on_keydown=(t,e,r,i,n)=>{t.stopPropagation(),t.preventDefault(),e(t,()=>r()(i()+get$4(n)))},root_3$2=from_html('<div role="menuitem" tabindex="0"> </div>'),on_click_1$3=function(t,e){t.stopPropagation(),e(t,this)},on_keydown_1=function(t,e){t.stopPropagation(),t.preventDefault(),e(t)},root_4=from_html('<div role="menuitem" tabindex="0"><span class="svelte-dc9k0d"> </span> <div class="nav-dir-links svelte-dc9k0d"><!></div></div>');function PageNav_1(t,e){push(e,!0);let r=prop(e,"pageDirStructure",27,()=>proxy({label:"_",children:[]})),i=prop(e,"pageRoot",3,""),n=prop(e,"lastPage",3,""),s=prop(e,"clickEvt",3,async()=>{});const o=m=>m instanceof HTMLElement?(m.focus(),!0):!1,a=(m,C)=>{const y=C==="next"?"nextElementSibling":"previousElementSibling",v=C==="next"?"firstElementChild":"lastElementChild";if(m[y]instanceof HTMLElement)o(m[y]);else if(m?.parentElement?.parentElement.classList.contains("nav-dir-header")){const E=m.parentElement.parentElement[y];E?(m.parentElement.parentElement.classList.remove("active"),E.classList.contains("nav-dir-header")?(E.classList.add("active"),o(E.children.item(1)[v])):o(E)):a(m.parentElement.parentElement,C)}else m?.parentElement?.parentElement&&o(m.parentElement.parentElement)},l=m=>{if(m.target instanceof HTMLElement)switch(m.code){case"ArrowDown":a(m.target,"next");break;case"ArrowUp":a(m.target,"previous");break;case"ArrowRight":case"Enter":m.target.classList.contains("active")?o(m.target.children.item(1).firstElementChild):m.target.classList.add("active");break;case"ArrowLeft":m.target.classList.contains("active")?m.target.classList.remove("active"):o(m.target.parentElement.parentElement);break;case"Tab":a(m.target,m.shiftKey?"next":"previous");break}},c=(m,C)=>{if(m.target instanceof HTMLElement)switch(m.code){case"ArrowRight":case"ArrowDown":a(m.target,"next");break;case"ArrowUp":a(m.target,"previous");break;case"Space":case"Enter":C();break;case"ArrowLeft":o(m.target.parentElement.parentElement);break;case"Tab":a(m.target,m.shiftKey?"next":"previous");break}},u=(m,C)=>{const y=C.getElementsByClassName("nav-dir-links")[0];(!y.style.maxHeight||parseInt(y.style.maxHeight)<50)&&(y.style.maxHeight=`${C.offsetHeight}px`),C.classList.toggle("active")};let d=proxy([]),h=state(!1);user_effect(()=>{if(!get$4(h)&&d.length>0){d.sort((m,C)=>m.depth-C.depth);for(const m of d)if(!m.style.maxHeight){let C=0;for(const y of m.children)y.classList.contains("nav-dir-header")?C+=parseInt(y.getElementsByClassName("nav-dir-links")[0].style.maxHeight):C+=y.clientHeight;m.style.maxHeight=`${C+35}px`}set$2(h,!0)}});var f=comment(),g=first_child(f);key(g,r,m=>{var C=comment(),y=first_child(C);each(y,17,()=>r().children,index$1,(v,E)=>{var $=comment(),O=first_child($);{var P=W=>{var q=root_3$2();q.__click=[on_click$3,s,i,E],q.__keydown=[on_keydown,c,s,i,E];var M=child(q);template_effect(Y=>{set_class(q,1,`nav-link ${n()===i()+get$4(E)?"current":""}`,"svelte-dc9k0d"),set_text(M,Y)},[()=>get$4(E).replace(/_/g," ")]),append(W,q)},I=W=>{var q=root_4();q.__click=[on_click_1$3,u],q.__keydown=[on_keydown_1,l];var M=child(q),Y=child(M),z=sibling(M,2),Q=child(z);{let K=user_derived(()=>i()+get$4(E).label);PageNav_1(Q,{get pageDirStructure(){return get$4(E)},get pageRoot(){return get$4(K)},get lastPage(){return n()},get clickEvt(){return s()}})}bind_this(z,K=>d[d.length]=K,()=>d?.[d.length]),template_effect(K=>{set_class(q,1,`nav-dir-header ${get$4(E).collapsed?"":"active"}`,"svelte-dc9k0d"),set_text(Y,K)},[()=>get$4(E).label.replace(/_/g," ")]),append(W,q)};if_block(O,W=>{typeof get$4(E)=="string"?W(P):W(I,!1)})}append(v,$)}),append(m,C)}),append(t,f),pop()}delegate(["click","keydown"]);var root_1$2=from_html('<button style="display: block" class="svelte-2pzyd5">show table</button>'),root_3$1=from_html('<button class="svelte-2pzyd5">stop editing</button> <button class="svelte-2pzyd5">copy as markdown</button>',1),on_click$2=(t,e)=>e(!0),root_5$1=from_html('<button class="svelte-2pzyd5">hide table</button> <button class="svelte-2pzyd5">edit table</button>',1),on_click_1$2=(t,e)=>e(!1),root_6$1=from_html('<button style="display: block" class="svelte-2pzyd5">show table</button>'),root_2$1=from_html("<!> <div></div>",1);function StandardTable(t,e){push(e,!0);let r=prop(e,"hidden",15),i=state(!1),n=state(!1),s=state(void 0),o;const a=async()=>{set$2(i,!0),await tick(),o=new Handsontable$1(get$4(s),e.tableData)},l=()=>{copyToClipboard(hotLanguageSerialize(o))},c=()=>{o.updateSettings({readOnly:!1,contextMenu:!0,allowInsertColumn:!0,allowInsertRow:!0}),set$2(n,!0)},u=()=>{o.updateSettings({readOnly:!0,contextMenu:!1}),set$2(n,!1)};onMount(()=>{r()||a(),r(!1)});var d=comment(),h=first_child(d);{var f=m=>{var C=root_1$2();C.__click=a,append(m,C)},g=m=>{var C=root_2$1(),y=first_child(C);{var v=O=>{var P=root_3$1(),I=first_child(P);I.__click=u;var W=sibling(I,2);W.__click=l,append(O,P)},E=O=>{var P=comment(),I=first_child(P);{var W=M=>{var Y=root_5$1(),z=first_child(Y);z.__click=[on_click$2,r];var Q=sibling(z,2);Q.__click=c,append(M,Y)},q=M=>{var Y=root_6$1();Y.__click=[on_click_1$2,r],append(M,Y)};if_block(I,M=>{r()?M(q,!1):M(W)})}append(O,P)};if_block(y,O=>{get$4(n)?O(v):O(E,!1)})}var $=sibling(y,2);bind_this($,O=>set$2(s,O),()=>get$4(s)),template_effect(()=>set_style($,`display: ${r()?"none":"block"}`)),append(m,C)};if_block(h,m=>{get$4(i)==!1?m(f):m(g,!1)})}append(t,d),pop()}delegate(["click"]);var root_1$1=from_html('<button style="display: block" class="svelte-18qp6ys">show table</button>'),root_3=from_html('<button class="svelte-18qp6ys">stop editing</button>'),on_click$1=(t,e)=>e(!0),root_5=from_html('<button class="svelte-18qp6ys">hide table</button> <button class="svelte-18qp6ys">edit table</button>',1),on_click_1$1=(t,e)=>e(!1),root_6=from_html('<button style="display: block" class="svelte-18qp6ys">show table</button>'),root_2=from_html('<!> <div class="tables"><span class="block-heading svelte-18qp6ys">properties</span> <div></div> <span class="block-heading svelte-18qp6ys">functions</span> <div></div></div>',1),root$1=from_html('<h5 class="block-heading"> </h5> <!>',1);function StructTable(t,e){push(e,!0);let r=prop(e,"hidden",15),i=state(!1),n=state(!1),s=state(void 0),o,a=state(void 0),l;const c=async()=>{set$2(i,!0),await tick(),o=new Handsontable(get$4(s),e.structData),l=new Handsontable(get$4(a),e.fnData)},u=()=>{o.updateSettings({readOnly:!1,contextMenu:!0,allowInsertColumn:!0,allowInsertRow:!0}),l.updateSettings({readOnly:!1,contextMenu:!0,allowInsertColumn:!0,allowInsertRow:!0}),set$2(n,!0)},d=()=>{o.updateSettings({readOnly:!0,contextMenu:!1}),l.updateSettings({readOnly:!0,contextMenu:!1}),set$2(n,!1)};onMount(()=>{r()||c(),r(!1)});var h=root$1(),f=first_child(h),g=child(f),m=sibling(f,2);{var C=v=>{var E=root_1$1();E.__click=c,append(v,E)},y=v=>{var E=root_2(),$=first_child(E);{var O=M=>{var Y=root_3();Y.__click=d,append(M,Y)},P=M=>{var Y=comment(),z=first_child(Y);{var Q=Z=>{var ue=root_5(),oe=first_child(ue);oe.__click=[on_click$1,r];var ae=sibling(oe,2);ae.__click=u,append(Z,ue)},K=Z=>{var ue=root_6();ue.__click=[on_click_1$1,r],append(Z,ue)};if_block(z,Z=>{r()?Z(K,!1):Z(Q)})}append(M,Y)};if_block($,M=>{get$4(n)?M(O):M(P,!1)})}var I=sibling($,2),W=sibling(child(I),2);bind_this(W,M=>set$2(s,M),()=>get$4(s));var q=sibling(W,4);bind_this(q,M=>set$2(a,M),()=>get$4(a)),template_effect(()=>set_style(I,`display: ${r()?"none":"block"}`)),append(v,E)};if_block(m,v=>{get$4(i)==!1?v(C):v(y,!1)})}template_effect(()=>set_text(g,e.name)),append(t,h),pop()}delegate(["click"]);var on_click=(t,e)=>set$2(e,!0),on_click_1=(t,e)=>set$2(e,!0),on_click_2=(t,e,r)=>{set$2(e,!1),set$2(r,!1)},root_1=from_html('<li class="svelte-ofrpun"><a> </a></li>'),root=from_html('<header class="svelte-ofrpun"><button class="sidebarButton svelte-ofrpun">pages</button> <button class="navButton svelte-ofrpun">content</button></header> <div></div> <main class="svelte-ofrpun"><div><div class="list svelte-ofrpun"><!></div></div> <div class="content svelte-ofrpun"><div class="content-wrapper svelte-ofrpun" id="content"><h6> </h6> <!></div></div> <div><ul class="svelte-ofrpun"></ul></div></main>',1);function App($$anchor,$$props){push($$props,!0);const[$$stores,$$cleanup]=setup_stores(),$currentPath=()=>store_get(currentPath,"$currentPath",$$stores);registerHexRenderers();const tables=[],structData=[];let TOC=state(proxy([])),TOCIsActive=state(!1),sidebarIsActive=state(!1),lastPage=state(proxy(localStorage.getItem("lastPage"))),pages=state(proxy([])),pageScripts=state(proxy([])),contentElement=state(void 0),titleHeaderText=state("");const getStructData=()=>localStorage.getItem("structs");marked.use({renderer:rendererFactory({hotLang:tables,struct:{getCurrentData:getStructData,tableData:structData}},get$4(TOC),get$4(pages),get$4(pageScripts))});let markedHTMLOut=state("");const updatePageContent=async()=>{get$4(contentElement).scrollTop=0,localStorage.setItem("lastPage",$currentPath()),set$2(lastPage,$currentPath(),!0),tables.length=0,structData.length=0,get$4(TOC).length=0,set$2(markedHTMLOut,marked(await(await fetch(`${hostRootAddr}${$currentPath()}.md`)).text()),!0),set$2(TOC,get$4(TOC),!0);for(const src of get$4(pageScripts))console.log(src),eval(await(await fetch(src)).text());set$2(pageScripts,[],!0),await tick();for(const[t,e]of tables.entries())mount(StandardTable,{target:document.getElementById(`HOTable-${t}`),props:{tableData:e,hidden:tables.length>10}});for(const[t,{name:e,properties:r,functions:i}]of structData.entries())console.log(document.getElementById(`structTable-${t}`)),mount(StructTable,{target:document.getElementById(`structTable-${t}`),props:{name:e,structData:r,fnData:i,hidden:!0}});set$2(titleHeaderText,$currentPath().replace(/\//g," > "),!0);for(const t of document.querySelectorAll("h1, h2, h3, h4, h5, h6"))t.classList.add("page-link"),t.addEventListener("click",()=>{navigator.clipboard.writeText(encodeURI(`${window.location.origin}${window.location.pathname}?page=${$currentPath()}&location=${t.id}`))})};let pageDirStructure=proxy({label:"_root",children:[],collapsed:!1});(async()=>{let e;e=(await(await fetch(`${hostRootAddr}_pages.txt`)).text()).replace(/\r/g,"").split(`
`);const r=[],i=[pageDirStructure];let n=0;for(const l of e){if(l.trim().startsWith("? ")||l.length===0)continue;const c=l.search(/\S/);if(c<n){const d=(n-c)/2;for(let h=0;h<d;h++)r.pop();i.length=r.length+1,n=c}else n=c;let u=l.trim();if(u.startsWith("?c")&&(u=u.substring(2).trim(),u.endsWith("/"))){get$4(pages).push(r.join("")+u),r.push(u),i[i.length-1].children.push({label:u,children:[],collapsed:!0}),i.push(i[i.length-1].children.slice(-1)[0]),n+=2;continue}get$4(pages).push(r.join("")+u),l.endsWith("/")?(r.push(u),i[i.length-1].children.push({label:u,children:[]}),i.push(i[i.length-1].children.slice(-1)[0]),n+=2):i[i.length-1].children.push(u)}set$2(pages,get$4(pages),!0);const s=new URLSearchParams(window.location.search);console.log(window.location.search);for(const l of s.entries())console.log(l);const o=s.get("page");console.log(o);const a=s.get("location");store_set(currentPath,o||localStorage.getItem("lastPage")||"index"),await tick(),a&&document.getElementById(new marked.Slugger().slug(a,{dryrun:!0})).scrollIntoView()})(),onMount(()=>{let t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js?config=TeX-MML-AM_CHTML",document.head.append(t),window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}}),user_effect(()=>{updatePageContent().then(()=>{window.MathJax&&window.MathJax.typeset&&window.MathJax.typesetPromise(document.body.children)})});var fragment=root(),header_1=first_child(fragment),button=child(header_1);button.__click=[on_click,sidebarIsActive];var button_1=sibling(button,2);button_1.__click=[on_click_1,TOCIsActive];var div=sibling(header_1,2);div.__click=[on_click_2,TOCIsActive,sidebarIsActive];var main=sibling(div,2),div_1=child(main),div_2=child(div_1),node=child(div_2);PageNav_1(node,{get pageDirStructure(){return pageDirStructure},clickEvt:t=>{store_set(currentPath,t)},get lastPage(){return get$4(lastPage)}});var div_3=sibling(div_1,2),div_4=child(div_3),h6=child(div_4),text=child(h6),node_1=sibling(h6,2);html$3(node_1,()=>get$4(markedHTMLOut)),bind_this(div_3,t=>set$2(contentElement,t),()=>get$4(contentElement));var div_5=sibling(div_3,2),ul=child(div_5);each(ul,21,()=>get$4(TOC),index$1,(t,e)=>{var r=root_1(),i=child(r),n=child(i);template_effect(()=>{set_style(r,`margin-left: ${(get$4(e).level-1)*10}px`),set_attribute(i,"href",`#${get$4(e).id??""}`),set_text(n,get$4(e).text)}),append(t,r)}),template_effect(()=>{set_class(div,1,`offToggle ${get$4(sidebarIsActive)||get$4(TOCIsActive)?"active":""}`,"svelte-ofrpun"),set_class(div_1,1,`sidebar ${get$4(sidebarIsActive)?"active":""}`,"svelte-ofrpun"),set_text(text,get$4(titleHeaderText)),set_class(div_5,1,`TOC ${get$4(TOCIsActive)?"active":""}`,"svelte-ofrpun")}),append($$anchor,fragment),pop(),$$cleanup()}delegate(["click"]);mount(App,{target:document.getElementById("app")})});export default ct();
