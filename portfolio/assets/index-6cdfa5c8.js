var at=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var st=at((exports,module)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const app="",markdown="";function noop$1(){}function run$1(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run$1)}function is_function(e){return typeof e=="function"}function safe_not_equal(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function is_empty(e){return Object.keys(e).length===0}function subscribe(e,...t){if(e==null)return noop$1;const r=e.subscribe(...t);return r.unsubscribe?()=>r.unsubscribe():r}function component_subscribe(e,t,r){e.$$.on_destroy.push(subscribe(t,r))}function set_store_value(e,t,r){return e.set(r),t}function append(e,t){e.appendChild(t)}function insert(e,t,r){e.insertBefore(t,r||null)}function detach(e){e.parentNode&&e.parentNode.removeChild(e)}function destroy_each(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}function element(e){return document.createElement(e)}function text$1(e){return document.createTextNode(e)}function space(){return text$1(" ")}function empty$2(){return text$1("")}function listen(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function attr(e,t,r){r==null?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function children(e){return Array.from(e.childNodes)}function set_data(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function set_style(e,t,r,n){r===null?e.style.removeProperty(t):e.style.setProperty(t,r,n?"important":"")}let current_component;function set_current_component(e){current_component=e}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(e){get_current_component().$$.on_mount.push(e)}const dirty_components=[],binding_callbacks=[],render_callbacks=[],flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function tick(){return schedule_update(),resolved_promise}function add_render_callback(e){render_callbacks.push(e)}const seen_callbacks=new Set;let flushidx=0;function flush(){if(flushidx!==0)return;const e=current_component;do{try{for(;flushidx<dirty_components.length;){const t=dirty_components[flushidx];flushidx++,set_current_component(t),update(t.$$)}}catch(t){throw dirty_components.length=0,flushidx=0,t}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let t=0;t<render_callbacks.length;t+=1){const r=render_callbacks[t];seen_callbacks.has(r)||(seen_callbacks.add(r),r())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(e)}function update(e){if(e.fragment!==null){e.update(),run_all(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(add_render_callback)}}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(e,t){e&&e.i&&(outroing.delete(e),e.i(t))}function transition_out(e,t,r,n){if(e&&e.o){if(outroing.has(e))return;outroing.add(e),outros.c.push(()=>{outroing.delete(e),n&&(r&&e.d(1),n())}),e.o(t)}else n&&n()}function create_component(e){e&&e.c()}function mount_component(e,t,r,n){const{fragment:o,after_update:i}=e.$$;o&&o.m(t,r),n||add_render_callback(()=>{const a=e.$$.on_mount.map(run$1).filter(is_function);e.$$.on_destroy?e.$$.on_destroy.push(...a):run_all(a),e.$$.on_mount=[]}),i.forEach(add_render_callback)}function destroy_component(e,t){const r=e.$$;r.fragment!==null&&(run_all(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function make_dirty(e,t){e.$$.dirty[0]===-1&&(dirty_components.push(e),schedule_update(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function init(e,t,r,n,o,i,a,s=[-1]){const l=current_component;set_current_component(e);const u=e.$$={fragment:null,ctx:[],props:i,update:noop$1,not_equal:o,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:blank_object(),dirty:s,skip_bound:!1,root:t.target||l.$$.root};a&&a(u.root);let c=!1;if(u.ctx=r?r(e,t.props||{},(f,d,...h)=>{const y=h.length?h[0]:d;return u.ctx&&o(u.ctx[f],u.ctx[f]=y)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](y),c&&make_dirty(e,f)),d}):[],u.update(),c=!0,run_all(u.before_update),u.fragment=n?n(u.ctx):!1,t.target){if(t.hydrate){const f=children(t.target);u.fragment&&u.fragment.l(f),f.forEach(detach)}else u.fragment&&u.fragment.c();t.intro&&transition_in(e.$$.fragment),mount_component(e,t.target,t.anchor,t.customElement),flush()}set_current_component(l)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop$1}$on(t,r){if(!is_function(r))return noop$1;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(r),()=>{const o=n.indexOf(r);o!==-1&&n.splice(o,1)}}$set(t){this.$$set&&!is_empty(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function getDefaults(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let defaults$1=getDefaults();function changeDefaults(e){defaults$1=e}const escapeTest=/[&<>"']/,escapeReplace=new RegExp(escapeTest.source,"g"),escapeTestNoEncode=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode=new RegExp(escapeTestNoEncode.source,"g"),escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=e=>escapeReplacements[e];function escape(e,t){if(t){if(escapeTest.test(e))return e.replace(escapeReplace,getEscapeReplacement)}else if(escapeTestNoEncode.test(e))return e.replace(escapeReplaceNoEncode,getEscapeReplacement);return e}const unescapeTest=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function unescape(e){return e.replace(unescapeTest,(t,r)=>(r=r.toLowerCase(),r==="colon"?":":r.charAt(0)==="#"?r.charAt(1)==="x"?String.fromCharCode(parseInt(r.substring(2),16)):String.fromCharCode(+r.substring(1)):""))}const caret=/(^|[^\[])\^/g;function edit(e,t){e=typeof e=="string"?e:e.source,t=t||"";const r={replace:(n,o)=>(o=o.source||o,o=o.replace(caret,"$1"),e=e.replace(n,o),r),getRegex:()=>new RegExp(e,t)};return r}const nonWordAndColonTest=/[^\w:]/g,originIndependentUrl=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function cleanUrl(e,t,r){if(e){let n;try{n=decodeURIComponent(unescape(r)).replace(nonWordAndColonTest,"").toLowerCase()}catch{return null}if(n.indexOf("javascript:")===0||n.indexOf("vbscript:")===0||n.indexOf("data:")===0)return null}t&&!originIndependentUrl.test(r)&&(r=resolveUrl(t,r));try{r=encodeURI(r).replace(/%25/g,"%")}catch{return null}return r}const baseUrls={},justDomain=/^[^:]+:\/*[^/]*$/,protocol=/^([^:]+:)[\s\S]*$/,domain=/^([^:]+:\/*[^/]*)[\s\S]*$/;function resolveUrl(e,t){baseUrls[" "+e]||(justDomain.test(e)?baseUrls[" "+e]=e+"/":baseUrls[" "+e]=rtrim$1(e,"/",!0)),e=baseUrls[" "+e];const r=e.indexOf(":")===-1;return t.substring(0,2)==="//"?r?t:e.replace(protocol,"$1")+t:t.charAt(0)==="/"?r?t:e.replace(domain,"$1")+t:e+t}const noopTest={exec:function(){}};function merge$1(e){let t=1,r,n;for(;t<arguments.length;t++){r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}function splitCells(e,t){const r=e.replace(/\|/g,(i,a,s)=>{let l=!1,u=a;for(;--u>=0&&s[u]==="\\";)l=!l;return l?"|":" |"}),n=r.split(/ \|/);let o=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;o<n.length;o++)n[o]=n[o].trim().replace(/\\\|/g,"|");return n}function rtrim$1(e,t,r){const n=e.length;if(n===0)return"";let o=0;for(;o<n;){const i=e.charAt(n-o-1);if(i===t&&!r)o++;else if(i!==t&&r)o++;else break}return e.slice(0,n-o)}function findClosingBracket(e,t){if(e.indexOf(t[1])===-1)return-1;const r=e.length;let n=0,o=0;for(;o<r;o++)if(e[o]==="\\")o++;else if(e[o]===t[0])n++;else if(e[o]===t[1]&&(n--,n<0))return o;return-1}function checkSanitizeDeprecation(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function repeatString(e,t){if(t<1)return"";let r="";for(;t>1;)t&1&&(r+=e),t>>=1,e+=e;return r+e}function outputLink(e,t,r,n){const o=t.href,i=t.title?escape(t.title):null,a=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){n.state.inLink=!0;const s={type:"link",raw:r,href:o,title:i,text:a,tokens:n.inlineTokens(a)};return n.state.inLink=!1,s}return{type:"image",raw:r,href:o,title:i,text:escape(a)}}function indentCodeCompensation(e,t){const r=e.match(/^(\s+)(?:```)/);if(r===null)return t;const n=r[1];return t.split(`
`).map(o=>{const i=o.match(/^\s+/);if(i===null)return o;const[a]=i;return a.length>=n.length?o.slice(n.length):o}).join(`
`)}class Tokenizer{constructor(t){this.options=t||defaults$1}space(t){const r=this.rules.block.newline.exec(t);if(r&&r[0].length>0)return{type:"space",raw:r[0]}}code(t){const r=this.rules.block.code.exec(t);if(r){const n=r[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:r[0],codeBlockStyle:"indented",text:this.options.pedantic?n:rtrim$1(n,`
`)}}}fences(t){const r=this.rules.block.fences.exec(t);if(r){const n=r[0],o=indentCodeCompensation(n,r[3]||"");return{type:"code",raw:n,lang:r[2]?r[2].trim().replace(this.rules.inline._escapes,"$1"):r[2],text:o}}}heading(t){const r=this.rules.block.heading.exec(t);if(r){let n=r[2].trim();if(/#$/.test(n)){const o=rtrim$1(n,"#");(this.options.pedantic||!o||/ $/.test(o))&&(n=o.trim())}return{type:"heading",raw:r[0],depth:r[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){const r=this.rules.block.hr.exec(t);if(r)return{type:"hr",raw:r[0]}}blockquote(t){const r=this.rules.block.blockquote.exec(t);if(r){const n=r[0].replace(/^ *>[ \t]?/gm,""),o=this.lexer.state.top;this.lexer.state.top=!0;const i=this.lexer.blockTokens(n);return this.lexer.state.top=o,{type:"blockquote",raw:r[0],tokens:i,text:n}}}list(t){let r=this.rules.block.list.exec(t);if(r){let n,o,i,a,s,l,u,c,f,d,h,y,p=r[1].trim();const v=p.length>1,b={type:"list",raw:"",ordered:v,start:v?+p.slice(0,-1):"",loose:!1,items:[]};p=v?`\\d{1,9}\\${p.slice(-1)}`:`\\${p}`,this.options.pedantic&&(p=v?p:"[*+-]");const S=new RegExp(`^( {0,3}${p})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;t&&(y=!1,!(!(r=S.exec(t))||this.rules.block.hr.test(t)));){if(n=r[0],t=t.substring(n.length),c=r[2].split(`
`,1)[0].replace(/^\t+/,P=>" ".repeat(3*P.length)),f=t.split(`
`,1)[0],this.options.pedantic?(a=2,h=c.trimLeft()):(a=r[2].search(/[^ ]/),a=a>4?1:a,h=c.slice(a),a+=r[1].length),l=!1,!c&&/^ *$/.test(f)&&(n+=f+`
`,t=t.substring(f.length+1),y=!0),!y){const P=new RegExp(`^ {0,${Math.min(3,a-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),E=new RegExp(`^ {0,${Math.min(3,a-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),j=new RegExp(`^ {0,${Math.min(3,a-1)}}(?:\`\`\`|~~~)`),G=new RegExp(`^ {0,${Math.min(3,a-1)}}#`);for(;t&&(d=t.split(`
`,1)[0],f=d,this.options.pedantic&&(f=f.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(j.test(f)||G.test(f)||P.test(f)||E.test(t)));){if(f.search(/[^ ]/)>=a||!f.trim())h+=`
`+f.slice(a);else{if(l||c.search(/[^ ]/)>=4||j.test(c)||G.test(c)||E.test(c))break;h+=`
`+f}!l&&!f.trim()&&(l=!0),n+=d+`
`,t=t.substring(d.length+1),c=f.slice(a)}}b.loose||(u?b.loose=!0:/\n *\n *$/.test(n)&&(u=!0)),this.options.gfm&&(o=/^\[[ xX]\] /.exec(h),o&&(i=o[0]!=="[ ] ",h=h.replace(/^\[[ xX]\] +/,""))),b.items.push({type:"list_item",raw:n,task:!!o,checked:i,loose:!1,text:h}),b.raw+=n}b.items[b.items.length-1].raw=n.trimRight(),b.items[b.items.length-1].text=h.trimRight(),b.raw=b.raw.trimRight();const w=b.items.length;for(s=0;s<w;s++)if(this.lexer.state.top=!1,b.items[s].tokens=this.lexer.blockTokens(b.items[s].text,[]),!b.loose){const P=b.items[s].tokens.filter(j=>j.type==="space"),E=P.length>0&&P.some(j=>/\n.*\n/.test(j.raw));b.loose=E}if(b.loose)for(s=0;s<w;s++)b.items[s].loose=!0;return b}}html(t){const r=this.rules.block.html.exec(t);if(r){const n={type:"html",raw:r[0],pre:!this.options.sanitizer&&(r[1]==="pre"||r[1]==="script"||r[1]==="style"),text:r[0]};if(this.options.sanitize){const o=this.options.sanitizer?this.options.sanitizer(r[0]):escape(r[0]);n.type="paragraph",n.text=o,n.tokens=this.lexer.inline(o)}return n}}def(t){const r=this.rules.block.def.exec(t);if(r){const n=r[1].toLowerCase().replace(/\s+/g," "),o=r[2]?r[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",i=r[3]?r[3].substring(1,r[3].length-1).replace(this.rules.inline._escapes,"$1"):r[3];return{type:"def",tag:n,raw:r[0],href:o,title:i}}}table(t){const r=this.rules.block.table.exec(t);if(r){const n={type:"table",header:splitCells(r[1]).map(o=>({text:o})),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:r[3]&&r[3].trim()?r[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(n.header.length===n.align.length){n.raw=r[0];let o=n.align.length,i,a,s,l;for(i=0;i<o;i++)/^ *-+: *$/.test(n.align[i])?n.align[i]="right":/^ *:-+: *$/.test(n.align[i])?n.align[i]="center":/^ *:-+ *$/.test(n.align[i])?n.align[i]="left":n.align[i]=null;for(o=n.rows.length,i=0;i<o;i++)n.rows[i]=splitCells(n.rows[i],n.header.length).map(u=>({text:u}));for(o=n.header.length,a=0;a<o;a++)n.header[a].tokens=this.lexer.inline(n.header[a].text);for(o=n.rows.length,a=0;a<o;a++)for(l=n.rows[a],s=0;s<l.length;s++)l[s].tokens=this.lexer.inline(l[s].text);return n}}}lheading(t){const r=this.rules.block.lheading.exec(t);if(r)return{type:"heading",raw:r[0],depth:r[2].charAt(0)==="="?1:2,text:r[1],tokens:this.lexer.inline(r[1])}}paragraph(t){const r=this.rules.block.paragraph.exec(t);if(r){const n=r[1].charAt(r[1].length-1)===`
`?r[1].slice(0,-1):r[1];return{type:"paragraph",raw:r[0],text:n,tokens:this.lexer.inline(n)}}}text(t){const r=this.rules.block.text.exec(t);if(r)return{type:"text",raw:r[0],text:r[0],tokens:this.lexer.inline(r[0])}}escape(t){const r=this.rules.inline.escape.exec(t);if(r)return{type:"escape",raw:r[0],text:escape(r[1])}}tag(t){const r=this.rules.inline.tag.exec(t);if(r)return!this.lexer.state.inLink&&/^<a /i.test(r[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(r[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:r[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):escape(r[0]):r[0]}}link(t){const r=this.rules.inline.link.exec(t);if(r){const n=r[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const a=rtrim$1(n.slice(0,-1),"\\");if((n.length-a.length)%2===0)return}else{const a=findClosingBracket(r[2],"()");if(a>-1){const l=(r[0].indexOf("!")===0?5:4)+r[1].length+a;r[2]=r[2].substring(0,a),r[0]=r[0].substring(0,l).trim(),r[3]=""}}let o=r[2],i="";if(this.options.pedantic){const a=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(o);a&&(o=a[1],i=a[3])}else i=r[3]?r[3].slice(1,-1):"";return o=o.trim(),/^</.test(o)&&(this.options.pedantic&&!/>$/.test(n)?o=o.slice(1):o=o.slice(1,-1)),outputLink(r,{href:o&&o.replace(this.rules.inline._escapes,"$1"),title:i&&i.replace(this.rules.inline._escapes,"$1")},r[0],this.lexer)}}reflink(t,r){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let o=(n[2]||n[1]).replace(/\s+/g," ");if(o=r[o.toLowerCase()],!o){const i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return outputLink(n,o,n[0],this.lexer)}}emStrong(t,r,n=""){let o=this.rules.inline.emStrong.lDelim.exec(t);if(!o||o[3]&&n.match(/[\p{L}\p{N}]/u))return;const i=o[1]||o[2]||"";if(!i||i&&(n===""||this.rules.inline.punctuation.exec(n))){const a=o[0].length-1;let s,l,u=a,c=0;const f=o[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(f.lastIndex=0,r=r.slice(-1*t.length+a);(o=f.exec(r))!=null;){if(s=o[1]||o[2]||o[3]||o[4]||o[5]||o[6],!s)continue;if(l=s.length,o[3]||o[4]){u+=l;continue}else if((o[5]||o[6])&&a%3&&!((a+l)%3)){c+=l;continue}if(u-=l,u>0)continue;l=Math.min(l,l+u+c);const d=t.slice(0,a+o.index+(o[0].length-s.length)+l);if(Math.min(a,l)%2){const y=d.slice(1,-1);return{type:"em",raw:d,text:y,tokens:this.lexer.inlineTokens(y)}}const h=d.slice(2,-2);return{type:"strong",raw:d,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(t){const r=this.rules.inline.code.exec(t);if(r){let n=r[2].replace(/\n/g," ");const o=/[^ ]/.test(n),i=/^ /.test(n)&&/ $/.test(n);return o&&i&&(n=n.substring(1,n.length-1)),n=escape(n,!0),{type:"codespan",raw:r[0],text:n}}}br(t){const r=this.rules.inline.br.exec(t);if(r)return{type:"br",raw:r[0]}}del(t){const r=this.rules.inline.del.exec(t);if(r)return{type:"del",raw:r[0],text:r[2],tokens:this.lexer.inlineTokens(r[2])}}autolink(t,r){const n=this.rules.inline.autolink.exec(t);if(n){let o,i;return n[2]==="@"?(o=escape(this.options.mangle?r(n[1]):n[1]),i="mailto:"+o):(o=escape(n[1]),i=o),{type:"link",raw:n[0],text:o,href:i,tokens:[{type:"text",raw:o,text:o}]}}}url(t,r){let n;if(n=this.rules.inline.url.exec(t)){let o,i;if(n[2]==="@")o=escape(this.options.mangle?r(n[0]):n[0]),i="mailto:"+o;else{let a;do a=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0];while(a!==n[0]);o=escape(n[0]),n[1]==="www."?i="http://"+n[0]:i=n[0]}return{type:"link",raw:n[0],text:o,href:i,tokens:[{type:"text",raw:o,text:o}]}}}inlineText(t,r){const n=this.rules.inline.text.exec(t);if(n){let o;return this.lexer.state.inRawBlock?o=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):escape(n[0]):n[0]:o=escape(this.options.smartypants?r(n[0]):n[0]),{type:"text",raw:n[0],text:o}}}}const block={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:noopTest,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};block._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;block._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;block.def=edit(block.def).replace("label",block._label).replace("title",block._title).getRegex();block.bullet=/(?:[*+-]|\d{1,9}[.)])/;block.listItemStart=edit(/^( *)(bull) */).replace("bull",block.bullet).getRegex();block.list=edit(block.list).replace(/bull/g,block.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+block.def.source+")").getRegex();block._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";block._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;block.html=edit(block.html,"i").replace("comment",block._comment).replace("tag",block._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();block.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.blockquote=edit(block.blockquote).replace("paragraph",block.paragraph).getRegex();block.normal=merge$1({},block);block.gfm=merge$1({},block.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});block.gfm.table=edit(block.gfm.table).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.gfm.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",block.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.pedantic=merge$1({},block.normal,{html:edit(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",block._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:noopTest,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:edit(block.normal._paragraph).replace("hr",block.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",block.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const inline={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:noopTest,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:noopTest,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};inline._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";inline.punctuation=edit(inline.punctuation).replace(/punctuation/g,inline._punctuation).getRegex();inline.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;inline.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;inline._comment=edit(block._comment).replace("(?:-->|$)","-->").getRegex();inline.emStrong.lDelim=edit(inline.emStrong.lDelim).replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimAst=edit(inline.emStrong.rDelimAst,"g").replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimUnd=edit(inline.emStrong.rDelimUnd,"g").replace(/punct/g,inline._punctuation).getRegex();inline._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;inline._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;inline._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;inline.autolink=edit(inline.autolink).replace("scheme",inline._scheme).replace("email",inline._email).getRegex();inline._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;inline.tag=edit(inline.tag).replace("comment",inline._comment).replace("attribute",inline._attribute).getRegex();inline._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;inline._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;inline._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;inline.link=edit(inline.link).replace("label",inline._label).replace("href",inline._href).replace("title",inline._title).getRegex();inline.reflink=edit(inline.reflink).replace("label",inline._label).replace("ref",block._label).getRegex();inline.nolink=edit(inline.nolink).replace("ref",block._label).getRegex();inline.reflinkSearch=edit(inline.reflinkSearch,"g").replace("reflink",inline.reflink).replace("nolink",inline.nolink).getRegex();inline.normal=merge$1({},inline);inline.pedantic=merge$1({},inline.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",inline._label).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",inline._label).getRegex()});inline.gfm=merge$1({},inline.normal,{escape:edit(inline.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});inline.gfm.url=edit(inline.gfm.url,"i").replace("email",inline.gfm._extended_email).getRegex();inline.breaks=merge$1({},inline.gfm,{br:edit(inline.br).replace("{2,}","*").getRegex(),text:edit(inline.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function smartypants(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function mangle(e){let t="",r,n;const o=e.length;for(r=0;r<o;r++)n=e.charCodeAt(r),Math.random()>.5&&(n="x"+n.toString(16)),t+="&#"+n+";";return t}class Lexer{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||defaults$1,this.options.tokenizer=this.options.tokenizer||new Tokenizer,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const r={block:block.normal,inline:inline.normal};this.options.pedantic?(r.block=block.pedantic,r.inline=inline.pedantic):this.options.gfm&&(r.block=block.gfm,this.options.breaks?r.inline=inline.breaks:r.inline=inline.gfm),this.tokenizer.rules=r}static get rules(){return{block,inline}}static lex(t,r){return new Lexer(r).lex(t)}static lexInline(t,r){return new Lexer(r).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);let r;for(;r=this.inlineQueue.shift();)this.inlineTokens(r.src,r.tokens);return this.tokens}blockTokens(t,r=[]){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(s,l,u)=>l+"    ".repeat(u.length));let n,o,i,a;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(s=>(n=s.call({lexer:this},t,r))?(t=t.substring(n.raw.length),r.push(n),!0):!1))){if(n=this.tokenizer.space(t)){t=t.substring(n.raw.length),n.raw.length===1&&r.length>0?r[r.length-1].raw+=`
`:r.push(n);continue}if(n=this.tokenizer.code(t)){t=t.substring(n.raw.length),o=r[r.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+n.raw,o.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(n);continue}if(n=this.tokenizer.fences(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.heading(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.hr(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.blockquote(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.list(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.html(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.def(t)){t=t.substring(n.raw.length),o=r[r.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+n.raw,o.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=o.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.lheading(t)){t=t.substring(n.raw.length),r.push(n);continue}if(i=t,this.options.extensions&&this.options.extensions.startBlock){let s=1/0;const l=t.slice(1);let u;this.options.extensions.startBlock.forEach(function(c){u=c.call({lexer:this},l),typeof u=="number"&&u>=0&&(s=Math.min(s,u))}),s<1/0&&s>=0&&(i=t.substring(0,s+1))}if(this.state.top&&(n=this.tokenizer.paragraph(i))){o=r[r.length-1],a&&o.type==="paragraph"?(o.raw+=`
`+n.raw,o.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(n),a=i.length!==t.length,t=t.substring(n.raw.length);continue}if(n=this.tokenizer.text(t)){t=t.substring(n.raw.length),o=r[r.length-1],o&&o.type==="text"?(o.raw+=`
`+n.raw,o.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(n);continue}if(t){const s="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(s);break}else throw new Error(s)}}return this.state.top=!0,r}inline(t,r=[]){return this.inlineQueue.push({src:t,tokens:r}),r}inlineTokens(t,r=[]){let n,o,i,a=t,s,l,u;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)c.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,s.index)+"["+repeatString("a",s[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)a=a.slice(0,s.index)+"["+repeatString("a",s[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(s=this.tokenizer.rules.inline.escapedEmSt.exec(a))!=null;)a=a.slice(0,s.index+s[0].length-2)+"++"+a.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;t;)if(l||(u=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(c=>(n=c.call({lexer:this},t,r))?(t=t.substring(n.raw.length),r.push(n),!0):!1))){if(n=this.tokenizer.escape(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.tag(t)){t=t.substring(n.raw.length),o=r[r.length-1],o&&n.type==="text"&&o.type==="text"?(o.raw+=n.raw,o.text+=n.text):r.push(n);continue}if(n=this.tokenizer.link(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(n.raw.length),o=r[r.length-1],o&&n.type==="text"&&o.type==="text"?(o.raw+=n.raw,o.text+=n.text):r.push(n);continue}if(n=this.tokenizer.emStrong(t,a,u)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.codespan(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.br(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.del(t)){t=t.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.autolink(t,mangle)){t=t.substring(n.raw.length),r.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(t,mangle))){t=t.substring(n.raw.length),r.push(n);continue}if(i=t,this.options.extensions&&this.options.extensions.startInline){let c=1/0;const f=t.slice(1);let d;this.options.extensions.startInline.forEach(function(h){d=h.call({lexer:this},f),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(i=t.substring(0,c+1))}if(n=this.tokenizer.inlineText(i,smartypants)){t=t.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(u=n.raw.slice(-1)),l=!0,o=r[r.length-1],o&&o.type==="text"?(o.raw+=n.raw,o.text+=n.text):r.push(n);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return r}}let Renderer$1=class{constructor(t){this.options=t||defaults$1}code(t,r,n){const o=(r||"").match(/\S*/)[0];if(this.options.highlight){const i=this.options.highlight(t,o);i!=null&&i!==t&&(n=!0,t=i)}return t=t.replace(/\n$/,"")+`
`,o?'<pre><code class="'+this.options.langPrefix+escape(o)+'">'+(n?t:escape(t,!0))+`</code></pre>
`:"<pre><code>"+(n?t:escape(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
${t}</blockquote>
`}html(t){return t}heading(t,r,n,o){if(this.options.headerIds){const i=this.options.headerPrefix+o.slug(n);return`<h${r} id="${i}">${t}</h${r}>
`}return`<h${r}>${t}</h${r}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(t,r,n){const o=r?"ol":"ul",i=r&&n!==1?' start="'+n+'"':"";return"<"+o+i+`>
`+t+"</"+o+`>
`}listitem(t){return`<li>${t}</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return`<p>${t}</p>
`}table(t,r){return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow(t){return`<tr>
${t}</tr>
`}tablecell(t,r){const n=r.header?"th":"td";return(r.align?`<${n} align="${r.align}">`:`<${n}>`)+t+`</${n}>
`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return`<del>${t}</del>`}link(t,r,n){if(t=cleanUrl(this.options.sanitize,this.options.baseUrl,t),t===null)return n;let o='<a href="'+t+'"';return r&&(o+=' title="'+r+'"'),o+=">"+n+"</a>",o}image(t,r,n){if(t=cleanUrl(this.options.sanitize,this.options.baseUrl,t),t===null)return n;let o=`<img src="${t}" alt="${n}"`;return r&&(o+=` title="${r}"`),o+=this.options.xhtml?"/>":">",o}text(t){return t}};class TextRenderer{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,r,n){return""+n}image(t,r,n){return""+n}br(){return""}}class Slugger{constructor(){this.seen={}}serialize(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(t,r){let n=t,o=0;if(this.seen.hasOwnProperty(n)){o=this.seen[t];do o++,n=t+"-"+o;while(this.seen.hasOwnProperty(n))}return r||(this.seen[t]=o,this.seen[n]=0),n}slug(t,r={}){const n=this.serialize(t);return this.getNextSafeSlug(n,r.dryrun)}}class Parser{constructor(t){this.options=t||defaults$1,this.options.renderer=this.options.renderer||new Renderer$1,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new TextRenderer,this.slugger=new Slugger}static parse(t,r){return new Parser(r).parse(t)}static parseInline(t,r){return new Parser(r).parseInline(t)}parse(t,r=!0){let n="",o,i,a,s,l,u,c,f,d,h,y,p,v,b,S,w,P,E,j;const G=t.length;for(o=0;o<G;o++){if(h=t[o],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[h.type]&&(j=this.options.extensions.renderers[h.type].call({parser:this},h),j!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type))){n+=j||"";continue}switch(h.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{n+=this.renderer.heading(this.parseInline(h.tokens),h.depth,unescape(this.parseInline(h.tokens,this.textRenderer)),this.slugger);continue}case"code":{n+=this.renderer.code(h.text,h.lang,h.escaped);continue}case"table":{for(f="",c="",s=h.header.length,i=0;i<s;i++)c+=this.renderer.tablecell(this.parseInline(h.header[i].tokens),{header:!0,align:h.align[i]});for(f+=this.renderer.tablerow(c),d="",s=h.rows.length,i=0;i<s;i++){for(u=h.rows[i],c="",l=u.length,a=0;a<l;a++)c+=this.renderer.tablecell(this.parseInline(u[a].tokens),{header:!1,align:h.align[a]});d+=this.renderer.tablerow(c)}n+=this.renderer.table(f,d);continue}case"blockquote":{d=this.parse(h.tokens),n+=this.renderer.blockquote(d);continue}case"list":{for(y=h.ordered,p=h.start,v=h.loose,s=h.items.length,d="",i=0;i<s;i++)S=h.items[i],w=S.checked,P=S.task,b="",S.task&&(E=this.renderer.checkbox(w),v?S.tokens.length>0&&S.tokens[0].type==="paragraph"?(S.tokens[0].text=E+" "+S.tokens[0].text,S.tokens[0].tokens&&S.tokens[0].tokens.length>0&&S.tokens[0].tokens[0].type==="text"&&(S.tokens[0].tokens[0].text=E+" "+S.tokens[0].tokens[0].text)):S.tokens.unshift({type:"text",text:E}):b+=E),b+=this.parse(S.tokens,v),d+=this.renderer.listitem(b,P,w);n+=this.renderer.list(d,y,p);continue}case"html":{n+=this.renderer.html(h.text);continue}case"paragraph":{n+=this.renderer.paragraph(this.parseInline(h.tokens));continue}case"text":{for(d=h.tokens?this.parseInline(h.tokens):h.text;o+1<G&&t[o+1].type==="text";)h=t[++o],d+=`
`+(h.tokens?this.parseInline(h.tokens):h.text);n+=r?this.renderer.paragraph(d):d;continue}default:{const q='Token with "'+h.type+'" type was not found.';if(this.options.silent){console.error(q);return}else throw new Error(q)}}}return n}parseInline(t,r){r=r||this.renderer;let n="",o,i,a;const s=t.length;for(o=0;o<s;o++){if(i=t[o],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]&&(a=this.options.extensions.renderers[i.type].call({parser:this},i),a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type))){n+=a||"";continue}switch(i.type){case"escape":{n+=r.text(i.text);break}case"html":{n+=r.html(i.text);break}case"link":{n+=r.link(i.href,i.title,this.parseInline(i.tokens,r));break}case"image":{n+=r.image(i.href,i.title,i.text);break}case"strong":{n+=r.strong(this.parseInline(i.tokens,r));break}case"em":{n+=r.em(this.parseInline(i.tokens,r));break}case"codespan":{n+=r.codespan(i.text);break}case"br":{n+=r.br();break}case"del":{n+=r.del(this.parseInline(i.tokens,r));break}case"text":{n+=r.text(i.text);break}default:{const l='Token with "'+i.type+'" type was not found.';if(this.options.silent){console.error(l);return}else throw new Error(l)}}}return n}}function marked(e,t,r){if(typeof e>"u"||e===null)throw new Error("marked(): input parameter is undefined or null");if(typeof e!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(typeof t=="function"&&(r=t,t=null),t=merge$1({},marked.defaults,t||{}),checkSanitizeDeprecation(t),r){const o=t.highlight;let i;try{i=Lexer.lex(e,t)}catch(l){return r(l)}const a=function(l){let u;if(!l)try{t.walkTokens&&marked.walkTokens(i,t.walkTokens),u=Parser.parse(i,t)}catch(c){l=c}return t.highlight=o,l?r(l):r(null,u)};if(!o||o.length<3||(delete t.highlight,!i.length))return a();let s=0;marked.walkTokens(i,function(l){l.type==="code"&&(s++,setTimeout(()=>{o(l.text,l.lang,function(u,c){if(u)return a(u);c!=null&&c!==l.text&&(l.text=c,l.escaped=!0),s--,s===0&&a()})},0))}),s===0&&a();return}function n(o){if(o.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+escape(o.message+"",!0)+"</pre>";throw o}try{const o=Lexer.lex(e,t);if(t.walkTokens){if(t.async)return Promise.all(marked.walkTokens(o,t.walkTokens)).then(()=>Parser.parse(o,t)).catch(n);marked.walkTokens(o,t.walkTokens)}return Parser.parse(o,t)}catch(o){n(o)}}marked.options=marked.setOptions=function(e){return merge$1(marked.defaults,e),changeDefaults(marked.defaults),marked};marked.getDefaults=getDefaults;marked.defaults=defaults$1;marked.use=function(...e){const t=marked.defaults.extensions||{renderers:{},childTokens:{}};e.forEach(r=>{const n=merge$1({},r);if(n.async=marked.defaults.async||n.async,r.extensions&&(r.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if(o.renderer){const i=t.renderers[o.name];i?t.renderers[o.name]=function(...a){let s=o.renderer.apply(this,a);return s===!1&&(s=i.apply(this,a)),s}:t.renderers[o.name]=o.renderer}if(o.tokenizer){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");t[o.level]?t[o.level].unshift(o.tokenizer):t[o.level]=[o.tokenizer],o.start&&(o.level==="block"?t.startBlock?t.startBlock.push(o.start):t.startBlock=[o.start]:o.level==="inline"&&(t.startInline?t.startInline.push(o.start):t.startInline=[o.start]))}o.childTokens&&(t.childTokens[o.name]=o.childTokens)}),n.extensions=t),r.renderer){const o=marked.defaults.renderer||new Renderer$1;for(const i in r.renderer){const a=o[i];o[i]=(...s)=>{let l=r.renderer[i].apply(o,s);return l===!1&&(l=a.apply(o,s)),l}}n.renderer=o}if(r.tokenizer){const o=marked.defaults.tokenizer||new Tokenizer;for(const i in r.tokenizer){const a=o[i];o[i]=(...s)=>{let l=r.tokenizer[i].apply(o,s);return l===!1&&(l=a.apply(o,s)),l}}n.tokenizer=o}if(r.walkTokens){const o=marked.defaults.walkTokens;n.walkTokens=function(i){let a=[];return a.push(r.walkTokens.call(this,i)),o&&(a=a.concat(o.call(this,i))),a}}marked.setOptions(n)})};marked.walkTokens=function(e,t){let r=[];for(const n of e)switch(r=r.concat(t.call(marked,n)),n.type){case"table":{for(const o of n.header)r=r.concat(marked.walkTokens(o.tokens,t));for(const o of n.rows)for(const i of o)r=r.concat(marked.walkTokens(i.tokens,t));break}case"list":{r=r.concat(marked.walkTokens(n.items,t));break}default:marked.defaults.extensions&&marked.defaults.extensions.childTokens&&marked.defaults.extensions.childTokens[n.type]?marked.defaults.extensions.childTokens[n.type].forEach(function(o){r=r.concat(marked.walkTokens(n[o],t))}):n.tokens&&(r=r.concat(marked.walkTokens(n.tokens,t)))}return r};marked.parseInline=function(e,t){if(typeof e>"u"||e===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof e!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");t=merge$1({},marked.defaults,t||{}),checkSanitizeDeprecation(t);try{const r=Lexer.lexInline(e,t);return t.walkTokens&&marked.walkTokens(r,t.walkTokens),Parser.parseInline(r,t)}catch(r){if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+escape(r.message+"",!0)+"</pre>";throw r}};marked.Parser=Parser;marked.parser=Parser.parse;marked.Renderer=Renderer$1;marked.TextRenderer=TextRenderer;marked.Lexer=Lexer;marked.lexer=Lexer.lex;marked.Tokenizer=Tokenizer;marked.Slugger=Slugger;marked.parse=marked;marked.options;marked.setOptions;marked.use;marked.walkTokens;marked.parseInline;Parser.parse;Lexer.lex;var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getAugmentedNamespace(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){if(this instanceof n){var o=[null];o.push.apply(o,arguments);var i=Function.bind.apply(t,o);return new i}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),r}var check=function(e){return e&&e.Math==Math&&e},global$s=check(typeof globalThis=="object"&&globalThis)||check(typeof window=="object"&&window)||check(typeof self=="object"&&self)||check(typeof commonjsGlobal=="object"&&commonjsGlobal)||function(){return this}()||Function("return this")(),objectGetOwnPropertyDescriptor={},fails$I=function(e){try{return!!e()}catch{return!0}},fails$H=fails$I,descriptors=!fails$H(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),fails$G=fails$I,functionBindNative=!fails$G(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),NATIVE_BIND$4=functionBindNative,call$m=Function.prototype.call,functionCall=NATIVE_BIND$4?call$m.bind(call$m):function(){return call$m.apply(call$m,arguments)},objectPropertyIsEnumerable={},$propertyIsEnumerable$2={}.propertyIsEnumerable,getOwnPropertyDescriptor$6=Object.getOwnPropertyDescriptor,NASHORN_BUG=getOwnPropertyDescriptor$6&&!$propertyIsEnumerable$2.call({1:2},1);objectPropertyIsEnumerable.f=NASHORN_BUG?function(t){var r=getOwnPropertyDescriptor$6(this,t);return!!r&&r.enumerable}:$propertyIsEnumerable$2;var createPropertyDescriptor$5=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},NATIVE_BIND$3=functionBindNative,FunctionPrototype$3=Function.prototype,call$l=FunctionPrototype$3.call,uncurryThisWithBind=NATIVE_BIND$3&&FunctionPrototype$3.bind.bind(call$l,call$l),functionUncurryThis=NATIVE_BIND$3?uncurryThisWithBind:function(e){return function(){return call$l.apply(e,arguments)}},uncurryThis$K=functionUncurryThis,toString$n=uncurryThis$K({}.toString),stringSlice$c=uncurryThis$K("".slice),classofRaw$2=function(e){return stringSlice$c(toString$n(e),8,-1)},uncurryThis$J=functionUncurryThis,fails$F=fails$I,classof$c=classofRaw$2,$Object$5=Object,split=uncurryThis$J("".split),indexedObject=fails$F(function(){return!$Object$5("z").propertyIsEnumerable(0)})?function(e){return classof$c(e)=="String"?split(e,""):$Object$5(e)}:$Object$5,isNullOrUndefined$b=function(e){return e==null},isNullOrUndefined$a=isNullOrUndefined$b,$TypeError$i=TypeError,requireObjectCoercible$e=function(e){if(isNullOrUndefined$a(e))throw $TypeError$i("Can't call method on "+e);return e},IndexedObject$4=indexedObject,requireObjectCoercible$d=requireObjectCoercible$e,toIndexedObject$d=function(e){return IndexedObject$4(requireObjectCoercible$d(e))},documentAll$2=typeof document=="object"&&document.all,IS_HTMLDDA=typeof documentAll$2>"u"&&documentAll$2!==void 0,documentAll_1={all:documentAll$2,IS_HTMLDDA},$documentAll$1=documentAll_1,documentAll$1=$documentAll$1.all,isCallable$p=$documentAll$1.IS_HTMLDDA?function(e){return typeof e=="function"||e===documentAll$1}:function(e){return typeof e=="function"},isCallable$o=isCallable$p,$documentAll=documentAll_1,documentAll=$documentAll.all,isObject$n=$documentAll.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:isCallable$o(e)||e===documentAll}:function(e){return typeof e=="object"?e!==null:isCallable$o(e)},global$r=global$s,isCallable$n=isCallable$p,aFunction=function(e){return isCallable$n(e)?e:void 0},getBuiltIn$9=function(e,t){return arguments.length<2?aFunction(global$r[e]):global$r[e]&&global$r[e][t]},uncurryThis$I=functionUncurryThis,objectIsPrototypeOf=uncurryThis$I({}.isPrototypeOf),engineUserAgent=typeof navigator<"u"&&String(navigator.userAgent)||"",global$q=global$s,userAgent$4=engineUserAgent,process$3=global$q.process,Deno=global$q.Deno,versions=process$3&&process$3.versions||Deno&&Deno.version,v8=versions&&versions.v8,match,version;v8&&(match=v8.split("."),version=match[0]>0&&match[0]<4?1:+(match[0]+match[1]));!version&&userAgent$4&&(match=userAgent$4.match(/Edge\/(\d+)/),(!match||match[1]>=74)&&(match=userAgent$4.match(/Chrome\/(\d+)/),match&&(version=+match[1])));var engineV8Version=version,V8_VERSION$2=engineV8Version,fails$E=fails$I,symbolConstructorDetection=!!Object.getOwnPropertySymbols&&!fails$E(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&V8_VERSION$2&&V8_VERSION$2<41}),NATIVE_SYMBOL$6=symbolConstructorDetection,useSymbolAsUid=NATIVE_SYMBOL$6&&!Symbol.sham&&typeof Symbol.iterator=="symbol",getBuiltIn$8=getBuiltIn$9,isCallable$m=isCallable$p,isPrototypeOf$7=objectIsPrototypeOf,USE_SYMBOL_AS_UID$1=useSymbolAsUid,$Object$4=Object,isSymbol$5=USE_SYMBOL_AS_UID$1?function(e){return typeof e=="symbol"}:function(e){var t=getBuiltIn$8("Symbol");return isCallable$m(t)&&isPrototypeOf$7(t.prototype,$Object$4(e))},$String$6=String,tryToString$6=function(e){try{return $String$6(e)}catch{return"Object"}},isCallable$l=isCallable$p,tryToString$5=tryToString$6,$TypeError$h=TypeError,aCallable$7=function(e){if(isCallable$l(e))return e;throw $TypeError$h(tryToString$5(e)+" is not a function")},aCallable$6=aCallable$7,isNullOrUndefined$9=isNullOrUndefined$b,getMethod$7=function(e,t){var r=e[t];return isNullOrUndefined$9(r)?void 0:aCallable$6(r)},call$k=functionCall,isCallable$k=isCallable$p,isObject$m=isObject$n,$TypeError$g=TypeError,ordinaryToPrimitive$2=function(e,t){var r,n;if(t==="string"&&isCallable$k(r=e.toString)&&!isObject$m(n=call$k(r,e))||isCallable$k(r=e.valueOf)&&!isObject$m(n=call$k(r,e))||t!=="string"&&isCallable$k(r=e.toString)&&!isObject$m(n=call$k(r,e)))return n;throw $TypeError$g("Can't convert object to primitive value")},sharedExports={},shared$7={get exports(){return sharedExports},set exports(e){sharedExports=e}},isPure=!1,global$p=global$s,defineProperty$a=Object.defineProperty,defineGlobalProperty$3=function(e,t){try{defineProperty$a(global$p,e,{value:t,configurable:!0,writable:!0})}catch{global$p[e]=t}return t},global$o=global$s,defineGlobalProperty$2=defineGlobalProperty$3,SHARED="__core-js_shared__",store$3=global$o[SHARED]||defineGlobalProperty$2(SHARED,{}),sharedStore=store$3,store$2=sharedStore;(shared$7.exports=function(e,t){return store$2[e]||(store$2[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.29.0",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.29.0/LICENSE",source:"https://github.com/zloirock/core-js"});var requireObjectCoercible$c=requireObjectCoercible$e,$Object$3=Object,toObject$f=function(e){return $Object$3(requireObjectCoercible$c(e))},uncurryThis$H=functionUncurryThis,toObject$e=toObject$f,hasOwnProperty$2=uncurryThis$H({}.hasOwnProperty),hasOwnProperty_1=Object.hasOwn||function(t,r){return hasOwnProperty$2(toObject$e(t),r)},uncurryThis$G=functionUncurryThis,id$2=0,postfix=Math.random(),toString$m=uncurryThis$G(1 .toString),uid$4=function(e){return"Symbol("+(e===void 0?"":e)+")_"+toString$m(++id$2+postfix,36)},global$n=global$s,shared$6=sharedExports,hasOwn$m=hasOwnProperty_1,uid$3=uid$4,NATIVE_SYMBOL$5=symbolConstructorDetection,USE_SYMBOL_AS_UID=useSymbolAsUid,Symbol$1=global$n.Symbol,WellKnownSymbolsStore$1=shared$6("wks"),createWellKnownSymbol=USE_SYMBOL_AS_UID?Symbol$1.for||Symbol$1:Symbol$1&&Symbol$1.withoutSetter||uid$3,wellKnownSymbol$q=function(e){return hasOwn$m(WellKnownSymbolsStore$1,e)||(WellKnownSymbolsStore$1[e]=NATIVE_SYMBOL$5&&hasOwn$m(Symbol$1,e)?Symbol$1[e]:createWellKnownSymbol("Symbol."+e)),WellKnownSymbolsStore$1[e]},call$j=functionCall,isObject$l=isObject$n,isSymbol$4=isSymbol$5,getMethod$6=getMethod$7,ordinaryToPrimitive$1=ordinaryToPrimitive$2,wellKnownSymbol$p=wellKnownSymbol$q,$TypeError$f=TypeError,TO_PRIMITIVE$1=wellKnownSymbol$p("toPrimitive"),toPrimitive$2=function(e,t){if(!isObject$l(e)||isSymbol$4(e))return e;var r=getMethod$6(e,TO_PRIMITIVE$1),n;if(r){if(t===void 0&&(t="default"),n=call$j(r,e,t),!isObject$l(n)||isSymbol$4(n))return n;throw $TypeError$f("Can't convert object to primitive value")}return t===void 0&&(t="number"),ordinaryToPrimitive$1(e,t)},toPrimitive$1=toPrimitive$2,isSymbol$3=isSymbol$5,toPropertyKey$4=function(e){var t=toPrimitive$1(e,"string");return isSymbol$3(t)?t:t+""},global$m=global$s,isObject$k=isObject$n,document$1=global$m.document,EXISTS$1=isObject$k(document$1)&&isObject$k(document$1.createElement),documentCreateElement$2=function(e){return EXISTS$1?document$1.createElement(e):{}},DESCRIPTORS$k=descriptors,fails$D=fails$I,createElement$2=documentCreateElement$2,ie8DomDefine=!DESCRIPTORS$k&&!fails$D(function(){return Object.defineProperty(createElement$2("div"),"a",{get:function(){return 7}}).a!=7}),DESCRIPTORS$j=descriptors,call$i=functionCall,propertyIsEnumerableModule$2=objectPropertyIsEnumerable,createPropertyDescriptor$4=createPropertyDescriptor$5,toIndexedObject$c=toIndexedObject$d,toPropertyKey$3=toPropertyKey$4,hasOwn$l=hasOwnProperty_1,IE8_DOM_DEFINE$1=ie8DomDefine,$getOwnPropertyDescriptor$2=Object.getOwnPropertyDescriptor;objectGetOwnPropertyDescriptor.f=DESCRIPTORS$j?$getOwnPropertyDescriptor$2:function(t,r){if(t=toIndexedObject$c(t),r=toPropertyKey$3(r),IE8_DOM_DEFINE$1)try{return $getOwnPropertyDescriptor$2(t,r)}catch{}if(hasOwn$l(t,r))return createPropertyDescriptor$4(!call$i(propertyIsEnumerableModule$2.f,t,r),t[r])};var objectDefineProperty={},DESCRIPTORS$i=descriptors,fails$C=fails$I,v8PrototypeDefineBug=DESCRIPTORS$i&&fails$C(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),isObject$j=isObject$n,$String$5=String,$TypeError$e=TypeError,anObject$m=function(e){if(isObject$j(e))return e;throw $TypeError$e($String$5(e)+" is not an object")},DESCRIPTORS$h=descriptors,IE8_DOM_DEFINE=ie8DomDefine,V8_PROTOTYPE_DEFINE_BUG$1=v8PrototypeDefineBug,anObject$l=anObject$m,toPropertyKey$2=toPropertyKey$4,$TypeError$d=TypeError,$defineProperty$1=Object.defineProperty,$getOwnPropertyDescriptor$1=Object.getOwnPropertyDescriptor,ENUMERABLE="enumerable",CONFIGURABLE$1="configurable",WRITABLE="writable";objectDefineProperty.f=DESCRIPTORS$h?V8_PROTOTYPE_DEFINE_BUG$1?function(t,r,n){if(anObject$l(t),r=toPropertyKey$2(r),anObject$l(n),typeof t=="function"&&r==="prototype"&&"value"in n&&WRITABLE in n&&!n[WRITABLE]){var o=$getOwnPropertyDescriptor$1(t,r);o&&o[WRITABLE]&&(t[r]=n.value,n={configurable:CONFIGURABLE$1 in n?n[CONFIGURABLE$1]:o[CONFIGURABLE$1],enumerable:ENUMERABLE in n?n[ENUMERABLE]:o[ENUMERABLE],writable:!1})}return $defineProperty$1(t,r,n)}:$defineProperty$1:function(t,r,n){if(anObject$l(t),r=toPropertyKey$2(r),anObject$l(n),IE8_DOM_DEFINE)try{return $defineProperty$1(t,r,n)}catch{}if("get"in n||"set"in n)throw $TypeError$d("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var DESCRIPTORS$g=descriptors,definePropertyModule$5=objectDefineProperty,createPropertyDescriptor$3=createPropertyDescriptor$5,createNonEnumerableProperty$7=DESCRIPTORS$g?function(e,t,r){return definePropertyModule$5.f(e,t,createPropertyDescriptor$3(1,r))}:function(e,t,r){return e[t]=r,e},makeBuiltInExports={},makeBuiltIn$3={get exports(){return makeBuiltInExports},set exports(e){makeBuiltInExports=e}},DESCRIPTORS$f=descriptors,hasOwn$k=hasOwnProperty_1,FunctionPrototype$2=Function.prototype,getDescriptor=DESCRIPTORS$f&&Object.getOwnPropertyDescriptor,EXISTS=hasOwn$k(FunctionPrototype$2,"name"),PROPER=EXISTS&&function(){}.name==="something",CONFIGURABLE=EXISTS&&(!DESCRIPTORS$f||DESCRIPTORS$f&&getDescriptor(FunctionPrototype$2,"name").configurable),functionName={EXISTS,PROPER,CONFIGURABLE},uncurryThis$F=functionUncurryThis,isCallable$j=isCallable$p,store$1=sharedStore,functionToString$1=uncurryThis$F(Function.toString);isCallable$j(store$1.inspectSource)||(store$1.inspectSource=function(e){return functionToString$1(e)});var inspectSource$2=store$1.inspectSource,global$l=global$s,isCallable$i=isCallable$p,WeakMap$2=global$l.WeakMap,weakMapBasicDetection=isCallable$i(WeakMap$2)&&/native code/.test(String(WeakMap$2)),shared$5=sharedExports,uid$2=uid$4,keys$2=shared$5("keys"),sharedKey$4=function(e){return keys$2[e]||(keys$2[e]=uid$2(e))},hiddenKeys$6={},NATIVE_WEAK_MAP$1=weakMapBasicDetection,global$k=global$s,isObject$i=isObject$n,createNonEnumerableProperty$6=createNonEnumerableProperty$7,hasOwn$j=hasOwnProperty_1,shared$4=sharedStore,sharedKey$3=sharedKey$4,hiddenKeys$5=hiddenKeys$6,OBJECT_ALREADY_INITIALIZED="Object already initialized",TypeError$3=global$k.TypeError,WeakMap$1=global$k.WeakMap,set$3,get$3,has,enforce=function(e){return has(e)?get$3(e):set$3(e,{})},getterFor=function(e){return function(t){var r;if(!isObject$i(t)||(r=get$3(t)).type!==e)throw TypeError$3("Incompatible receiver, "+e+" required");return r}};if(NATIVE_WEAK_MAP$1||shared$4.state){var store=shared$4.state||(shared$4.state=new WeakMap$1);store.get=store.get,store.has=store.has,store.set=store.set,set$3=function(e,t){if(store.has(e))throw TypeError$3(OBJECT_ALREADY_INITIALIZED);return t.facade=e,store.set(e,t),t},get$3=function(e){return store.get(e)||{}},has=function(e){return store.has(e)}}else{var STATE=sharedKey$3("state");hiddenKeys$5[STATE]=!0,set$3=function(e,t){if(hasOwn$j(e,STATE))throw TypeError$3(OBJECT_ALREADY_INITIALIZED);return t.facade=e,createNonEnumerableProperty$6(e,STATE,t),t},get$3=function(e){return hasOwn$j(e,STATE)?e[STATE]:{}},has=function(e){return hasOwn$j(e,STATE)}}var internalState={set:set$3,get:get$3,has,enforce,getterFor},uncurryThis$E=functionUncurryThis,fails$B=fails$I,isCallable$h=isCallable$p,hasOwn$i=hasOwnProperty_1,DESCRIPTORS$e=descriptors,CONFIGURABLE_FUNCTION_NAME$1=functionName.CONFIGURABLE,inspectSource$1=inspectSource$2,InternalStateModule$5=internalState,enforceInternalState$2=InternalStateModule$5.enforce,getInternalState$4=InternalStateModule$5.get,$String$4=String,defineProperty$9=Object.defineProperty,stringSlice$b=uncurryThis$E("".slice),replace$7=uncurryThis$E("".replace),join$1=uncurryThis$E([].join),CONFIGURABLE_LENGTH=DESCRIPTORS$e&&!fails$B(function(){return defineProperty$9(function(){},"length",{value:8}).length!==8}),TEMPLATE=String(String).split("String"),makeBuiltIn$2=makeBuiltIn$3.exports=function(e,t,r){stringSlice$b($String$4(t),0,7)==="Symbol("&&(t="["+replace$7($String$4(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!hasOwn$i(e,"name")||CONFIGURABLE_FUNCTION_NAME$1&&e.name!==t)&&(DESCRIPTORS$e?defineProperty$9(e,"name",{value:t,configurable:!0}):e.name=t),CONFIGURABLE_LENGTH&&r&&hasOwn$i(r,"arity")&&e.length!==r.arity&&defineProperty$9(e,"length",{value:r.arity});try{r&&hasOwn$i(r,"constructor")&&r.constructor?DESCRIPTORS$e&&defineProperty$9(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=enforceInternalState$2(e);return hasOwn$i(n,"source")||(n.source=join$1(TEMPLATE,typeof t=="string"?t:"")),e};Function.prototype.toString=makeBuiltIn$2(function(){return isCallable$h(this)&&getInternalState$4(this).source||inspectSource$1(this)},"toString");var isCallable$g=isCallable$p,definePropertyModule$4=objectDefineProperty,makeBuiltIn$1=makeBuiltInExports,defineGlobalProperty$1=defineGlobalProperty$3,defineBuiltIn$c=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(isCallable$g(r)&&makeBuiltIn$1(r,i,n),n.global)o?e[t]=r:defineGlobalProperty$1(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:definePropertyModule$4.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},objectGetOwnPropertyNames={},ceil$1=Math.ceil,floor$4=Math.floor,mathTrunc=Math.trunc||function(t){var r=+t;return(r>0?floor$4:ceil$1)(r)},trunc=mathTrunc,toIntegerOrInfinity$8=function(e){var t=+e;return t!==t||t===0?0:trunc(t)},toIntegerOrInfinity$7=toIntegerOrInfinity$8,max$5=Math.max,min$8=Math.min,toAbsoluteIndex$5=function(e,t){var r=toIntegerOrInfinity$7(e);return r<0?max$5(r+t,0):min$8(r,t)},toIntegerOrInfinity$6=toIntegerOrInfinity$8,min$7=Math.min,toLength$7=function(e){return e>0?min$7(toIntegerOrInfinity$6(e),9007199254740991):0},toLength$6=toLength$7,lengthOfArrayLike$c=function(e){return toLength$6(e.length)},toIndexedObject$b=toIndexedObject$d,toAbsoluteIndex$4=toAbsoluteIndex$5,lengthOfArrayLike$b=lengthOfArrayLike$c,createMethod$6=function(e){return function(t,r,n){var o=toIndexedObject$b(t),i=lengthOfArrayLike$b(o),a=toAbsoluteIndex$4(n,i),s;if(e&&r!=r){for(;i>a;)if(s=o[a++],s!=s)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},arrayIncludes={includes:createMethod$6(!0),indexOf:createMethod$6(!1)},uncurryThis$D=functionUncurryThis,hasOwn$h=hasOwnProperty_1,toIndexedObject$a=toIndexedObject$d,indexOf$2=arrayIncludes.indexOf,hiddenKeys$4=hiddenKeys$6,push$8=uncurryThis$D([].push),objectKeysInternal=function(e,t){var r=toIndexedObject$a(e),n=0,o=[],i;for(i in r)!hasOwn$h(hiddenKeys$4,i)&&hasOwn$h(r,i)&&push$8(o,i);for(;t.length>n;)hasOwn$h(r,i=t[n++])&&(~indexOf$2(o,i)||push$8(o,i));return o},enumBugKeys$3=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],internalObjectKeys$1=objectKeysInternal,enumBugKeys$2=enumBugKeys$3,hiddenKeys$3=enumBugKeys$2.concat("length","prototype");objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(t){return internalObjectKeys$1(t,hiddenKeys$3)};var objectGetOwnPropertySymbols={};objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols;var getBuiltIn$7=getBuiltIn$9,uncurryThis$C=functionUncurryThis,getOwnPropertyNamesModule$2=objectGetOwnPropertyNames,getOwnPropertySymbolsModule$3=objectGetOwnPropertySymbols,anObject$k=anObject$m,concat$3=uncurryThis$C([].concat),ownKeys$k=getBuiltIn$7("Reflect","ownKeys")||function(t){var r=getOwnPropertyNamesModule$2.f(anObject$k(t)),n=getOwnPropertySymbolsModule$3.f;return n?concat$3(r,n(t)):r},hasOwn$g=hasOwnProperty_1,ownKeys$j=ownKeys$k,getOwnPropertyDescriptorModule$3=objectGetOwnPropertyDescriptor,definePropertyModule$3=objectDefineProperty,copyConstructorProperties$3=function(e,t,r){for(var n=ownKeys$j(t),o=definePropertyModule$3.f,i=getOwnPropertyDescriptorModule$3.f,a=0;a<n.length;a++){var s=n[a];!hasOwn$g(e,s)&&!(r&&hasOwn$g(r,s))&&o(e,s,i(t,s))}},fails$A=fails$I,isCallable$f=isCallable$p,replacement=/#|\.prototype\./,isForced$4=function(e,t){var r=data[normalize(e)];return r==POLYFILL?!0:r==NATIVE?!1:isCallable$f(t)?fails$A(t):!!t},normalize=isForced$4.normalize=function(e){return String(e).replace(replacement,".").toLowerCase()},data=isForced$4.data={},NATIVE=isForced$4.NATIVE="N",POLYFILL=isForced$4.POLYFILL="P",isForced_1=isForced$4,global$j=global$s,getOwnPropertyDescriptor$5=objectGetOwnPropertyDescriptor.f,createNonEnumerableProperty$5=createNonEnumerableProperty$7,defineBuiltIn$b=defineBuiltIn$c,defineGlobalProperty=defineGlobalProperty$3,copyConstructorProperties$2=copyConstructorProperties$3,isForced$3=isForced_1,_export=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,s,l,u,c;if(n?a=global$j:o?a=global$j[r]||defineGlobalProperty(r,{}):a=(global$j[r]||{}).prototype,a)for(s in t){if(u=t[s],e.dontCallGetSet?(c=getOwnPropertyDescriptor$5(a,s),l=c&&c.value):l=a[s],i=isForced$3(n?s:r+(o?".":"#")+s,e.forced),!i&&l!==void 0){if(typeof u==typeof l)continue;copyConstructorProperties$2(u,l)}(e.sham||l&&l.sham)&&createNonEnumerableProperty$5(u,"sham",!0),defineBuiltIn$b(a,s,u,e)}},objectGetOwnPropertyNamesExternal={},toPropertyKey$1=toPropertyKey$4,definePropertyModule$2=objectDefineProperty,createPropertyDescriptor$2=createPropertyDescriptor$5,createProperty$6=function(e,t,r){var n=toPropertyKey$1(t);n in e?definePropertyModule$2.f(e,n,createPropertyDescriptor$2(0,r)):e[n]=r},toAbsoluteIndex$3=toAbsoluteIndex$5,lengthOfArrayLike$a=lengthOfArrayLike$c,createProperty$5=createProperty$6,$Array$3=Array,max$4=Math.max,arraySliceSimple=function(e,t,r){for(var n=lengthOfArrayLike$a(e),o=toAbsoluteIndex$3(t,n),i=toAbsoluteIndex$3(r===void 0?n:r,n),a=$Array$3(max$4(i-o,0)),s=0;o<i;o++,s++)createProperty$5(a,s,e[o]);return a.length=s,a},classof$b=classofRaw$2,toIndexedObject$9=toIndexedObject$d,$getOwnPropertyNames$1=objectGetOwnPropertyNames.f,arraySlice$7=arraySliceSimple,windowNames=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(e){try{return $getOwnPropertyNames$1(e)}catch{return arraySlice$7(windowNames)}};objectGetOwnPropertyNamesExternal.f=function(t){return windowNames&&classof$b(t)=="Window"?getWindowNames(t):$getOwnPropertyNames$1(toIndexedObject$9(t))};var $$O=_export,fails$z=fails$I,getOwnPropertyNames$2=objectGetOwnPropertyNamesExternal.f,FAILS_ON_PRIMITIVES$4=fails$z(function(){return!Object.getOwnPropertyNames(1)});$$O({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES$4},{getOwnPropertyNames:getOwnPropertyNames$2});var wellKnownSymbol$o=wellKnownSymbol$q,TO_STRING_TAG$3=wellKnownSymbol$o("toStringTag"),test$2={};test$2[TO_STRING_TAG$3]="z";var toStringTagSupport=String(test$2)==="[object z]",TO_STRING_TAG_SUPPORT$2=toStringTagSupport,isCallable$e=isCallable$p,classofRaw$1=classofRaw$2,wellKnownSymbol$n=wellKnownSymbol$q,TO_STRING_TAG$2=wellKnownSymbol$n("toStringTag"),$Object$2=Object,CORRECT_ARGUMENTS=classofRaw$1(function(){return arguments}())=="Arguments",tryGet=function(e,t){try{return e[t]}catch{}},classof$a=TO_STRING_TAG_SUPPORT$2?classofRaw$1:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=tryGet(t=$Object$2(e),TO_STRING_TAG$2))=="string"?r:CORRECT_ARGUMENTS?classofRaw$1(t):(n=classofRaw$1(t))=="Object"&&isCallable$e(t.callee)?"Arguments":n},classof$9=classof$a,$String$3=String,toString$l=function(e){if(classof$9(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return $String$3(e)},objectDefineProperties={},internalObjectKeys=objectKeysInternal,enumBugKeys$1=enumBugKeys$3,objectKeys$4=Object.keys||function(t){return internalObjectKeys(t,enumBugKeys$1)},DESCRIPTORS$d=descriptors,V8_PROTOTYPE_DEFINE_BUG=v8PrototypeDefineBug,definePropertyModule$1=objectDefineProperty,anObject$j=anObject$m,toIndexedObject$8=toIndexedObject$d,objectKeys$3=objectKeys$4;objectDefineProperties.f=DESCRIPTORS$d&&!V8_PROTOTYPE_DEFINE_BUG?Object.defineProperties:function(t,r){anObject$j(t);for(var n=toIndexedObject$8(r),o=objectKeys$3(r),i=o.length,a=0,s;i>a;)definePropertyModule$1.f(t,s=o[a++],n[s]);return t};var getBuiltIn$6=getBuiltIn$9,html$4=getBuiltIn$6("document","documentElement"),anObject$i=anObject$m,definePropertiesModule$1=objectDefineProperties,enumBugKeys=enumBugKeys$3,hiddenKeys$2=hiddenKeys$6,html$3=html$4,documentCreateElement$1=documentCreateElement$2,sharedKey$2=sharedKey$4,GT=">",LT="<",PROTOTYPE$1="prototype",SCRIPT="script",IE_PROTO$1=sharedKey$2("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(e){return LT+SCRIPT+GT+e+LT+"/"+SCRIPT+GT},NullProtoObjectViaActiveX=function(e){e.write(scriptTag("")),e.close();var t=e.parentWindow.Object;return e=null,t},NullProtoObjectViaIFrame=function(){var e=documentCreateElement$1("iframe"),t="java"+SCRIPT+":",r;return e.style.display="none",html$3.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(scriptTag("document.F=Object")),r.close(),r.F},activeXDocument,NullProtoObject=function(){try{activeXDocument=new ActiveXObject("htmlfile")}catch{}NullProtoObject=typeof document<"u"?document.domain&&activeXDocument?NullProtoObjectViaActiveX(activeXDocument):NullProtoObjectViaIFrame():NullProtoObjectViaActiveX(activeXDocument);for(var e=enumBugKeys.length;e--;)delete NullProtoObject[PROTOTYPE$1][enumBugKeys[e]];return NullProtoObject()};hiddenKeys$2[IE_PROTO$1]=!0;var objectCreate=Object.create||function(t,r){var n;return t!==null?(EmptyConstructor[PROTOTYPE$1]=anObject$i(t),n=new EmptyConstructor,EmptyConstructor[PROTOTYPE$1]=null,n[IE_PROTO$1]=t):n=NullProtoObject(),r===void 0?n:definePropertiesModule$1.f(n,r)},makeBuiltIn=makeBuiltInExports,defineProperty$8=objectDefineProperty,defineBuiltInAccessor$5=function(e,t,r){return r.get&&makeBuiltIn(r.get,t,{getter:!0}),r.set&&makeBuiltIn(r.set,t,{setter:!0}),defineProperty$8.f(e,t,r)},wellKnownSymbolWrapped={},wellKnownSymbol$m=wellKnownSymbol$q;wellKnownSymbolWrapped.f=wellKnownSymbol$m;var global$i=global$s,path$2=global$i,path$1=path$2,hasOwn$f=hasOwnProperty_1,wrappedWellKnownSymbolModule$1=wellKnownSymbolWrapped,defineProperty$7=objectDefineProperty.f,wellKnownSymbolDefine=function(e){var t=path$1.Symbol||(path$1.Symbol={});hasOwn$f(t,e)||defineProperty$7(t,e,{value:wrappedWellKnownSymbolModule$1.f(e)})},call$h=functionCall,getBuiltIn$5=getBuiltIn$9,wellKnownSymbol$l=wellKnownSymbol$q,defineBuiltIn$a=defineBuiltIn$c,symbolDefineToPrimitive=function(){var e=getBuiltIn$5("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=wellKnownSymbol$l("toPrimitive");t&&!t[n]&&defineBuiltIn$a(t,n,function(o){return call$h(r,this)},{arity:1})},defineProperty$6=objectDefineProperty.f,hasOwn$e=hasOwnProperty_1,wellKnownSymbol$k=wellKnownSymbol$q,TO_STRING_TAG$1=wellKnownSymbol$k("toStringTag"),setToStringTag$4=function(e,t,r){e&&!r&&(e=e.prototype),e&&!hasOwn$e(e,TO_STRING_TAG$1)&&defineProperty$6(e,TO_STRING_TAG$1,{configurable:!0,value:t})},classofRaw=classofRaw$2,uncurryThis$B=functionUncurryThis,functionUncurryThisClause=function(e){if(classofRaw(e)==="Function")return uncurryThis$B(e)},uncurryThis$A=functionUncurryThisClause,aCallable$5=aCallable$7,NATIVE_BIND$2=functionBindNative,bind$6=uncurryThis$A(uncurryThis$A.bind),functionBindContext=function(e,t){return aCallable$5(e),t===void 0?e:NATIVE_BIND$2?bind$6(e,t):function(){return e.apply(t,arguments)}},classof$8=classofRaw$2,isArray$8=Array.isArray||function(t){return classof$8(t)=="Array"},uncurryThis$z=functionUncurryThis,fails$y=fails$I,isCallable$d=isCallable$p,classof$7=classof$a,getBuiltIn$4=getBuiltIn$9,inspectSource=inspectSource$2,noop=function(){},empty$1=[],construct$2=getBuiltIn$4("Reflect","construct"),constructorRegExp=/^\s*(?:class|function)\b/,exec$4=uncurryThis$z(constructorRegExp.exec),INCORRECT_TO_STRING=!constructorRegExp.exec(noop),isConstructorModern=function(t){if(!isCallable$d(t))return!1;try{return construct$2(noop,empty$1,t),!0}catch{return!1}},isConstructorLegacy=function(t){if(!isCallable$d(t))return!1;switch(classof$7(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return INCORRECT_TO_STRING||!!exec$4(constructorRegExp,inspectSource(t))}catch{return!0}};isConstructorLegacy.sham=!0;var isConstructor$4=!construct$2||fails$y(function(){var e;return isConstructorModern(isConstructorModern.call)||!isConstructorModern(Object)||!isConstructorModern(function(){e=!0})||e})?isConstructorLegacy:isConstructorModern,isArray$7=isArray$8,isConstructor$3=isConstructor$4,isObject$h=isObject$n,wellKnownSymbol$j=wellKnownSymbol$q,SPECIES$5=wellKnownSymbol$j("species"),$Array$2=Array,arraySpeciesConstructor$1=function(e){var t;return isArray$7(e)&&(t=e.constructor,isConstructor$3(t)&&(t===$Array$2||isArray$7(t.prototype))?t=void 0:isObject$h(t)&&(t=t[SPECIES$5],t===null&&(t=void 0))),t===void 0?$Array$2:t},arraySpeciesConstructor=arraySpeciesConstructor$1,arraySpeciesCreate$3=function(e,t){return new(arraySpeciesConstructor(e))(t===0?0:t)},bind$5=functionBindContext,uncurryThis$y=functionUncurryThis,IndexedObject$3=indexedObject,toObject$d=toObject$f,lengthOfArrayLike$9=lengthOfArrayLike$c,arraySpeciesCreate$2=arraySpeciesCreate$3,push$7=uncurryThis$y([].push),createMethod$5=function(e){var t=e==1,r=e==2,n=e==3,o=e==4,i=e==6,a=e==7,s=e==5||i;return function(l,u,c,f){for(var d=toObject$d(l),h=IndexedObject$3(d),y=bind$5(u,c),p=lengthOfArrayLike$9(h),v=0,b=f||arraySpeciesCreate$2,S=t?b(l,p):r||a?b(l,0):void 0,w,P;p>v;v++)if((s||v in h)&&(w=h[v],P=y(w,v,d),e))if(t)S[v]=P;else if(P)switch(e){case 3:return!0;case 5:return w;case 6:return v;case 2:push$7(S,w)}else switch(e){case 4:return!1;case 7:push$7(S,w)}return i?-1:n||o?o:S}},arrayIteration={forEach:createMethod$5(0),map:createMethod$5(1),filter:createMethod$5(2),some:createMethod$5(3),every:createMethod$5(4),find:createMethod$5(5),findIndex:createMethod$5(6),filterReject:createMethod$5(7)},$$N=_export,global$h=global$s,call$g=functionCall,uncurryThis$x=functionUncurryThis,DESCRIPTORS$c=descriptors,NATIVE_SYMBOL$4=symbolConstructorDetection,fails$x=fails$I,hasOwn$d=hasOwnProperty_1,isPrototypeOf$6=objectIsPrototypeOf,anObject$h=anObject$m,toIndexedObject$7=toIndexedObject$d,toPropertyKey=toPropertyKey$4,$toString$1=toString$l,createPropertyDescriptor$1=createPropertyDescriptor$5,nativeObjectCreate=objectCreate,objectKeys$2=objectKeys$4,getOwnPropertyNamesModule$1=objectGetOwnPropertyNames,getOwnPropertyNamesExternal=objectGetOwnPropertyNamesExternal,getOwnPropertySymbolsModule$2=objectGetOwnPropertySymbols,getOwnPropertyDescriptorModule$2=objectGetOwnPropertyDescriptor,definePropertyModule=objectDefineProperty,definePropertiesModule=objectDefineProperties,propertyIsEnumerableModule$1=objectPropertyIsEnumerable,defineBuiltIn$9=defineBuiltIn$c,defineBuiltInAccessor$4=defineBuiltInAccessor$5,shared$3=sharedExports,sharedKey$1=sharedKey$4,hiddenKeys$1=hiddenKeys$6,uid$1=uid$4,wellKnownSymbol$i=wellKnownSymbol$q,wrappedWellKnownSymbolModule=wellKnownSymbolWrapped,defineWellKnownSymbol$2=wellKnownSymbolDefine,defineSymbolToPrimitive$1=symbolDefineToPrimitive,setToStringTag$3=setToStringTag$4,InternalStateModule$4=internalState,$forEach$1=arrayIteration.forEach,HIDDEN=sharedKey$1("hidden"),SYMBOL="Symbol",PROTOTYPE="prototype",setInternalState$4=InternalStateModule$4.set,getInternalState$3=InternalStateModule$4.getterFor(SYMBOL),ObjectPrototype$2=Object[PROTOTYPE],$Symbol=global$h.Symbol,SymbolPrototype$1=$Symbol&&$Symbol[PROTOTYPE],TypeError$2=global$h.TypeError,QObject=global$h.QObject,nativeGetOwnPropertyDescriptor$1=getOwnPropertyDescriptorModule$2.f,nativeDefineProperty=definePropertyModule.f,nativeGetOwnPropertyNames=getOwnPropertyNamesExternal.f,nativePropertyIsEnumerable=propertyIsEnumerableModule$1.f,push$6=uncurryThis$x([].push),AllSymbols=shared$3("symbols"),ObjectPrototypeSymbols=shared$3("op-symbols"),WellKnownSymbolsStore=shared$3("wks"),USE_SETTER=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild,setSymbolDescriptor=DESCRIPTORS$c&&fails$x(function(){return nativeObjectCreate(nativeDefineProperty({},"a",{get:function(){return nativeDefineProperty(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=nativeGetOwnPropertyDescriptor$1(ObjectPrototype$2,t);n&&delete ObjectPrototype$2[t],nativeDefineProperty(e,t,r),n&&e!==ObjectPrototype$2&&nativeDefineProperty(ObjectPrototype$2,t,n)}:nativeDefineProperty,wrap=function(e,t){var r=AllSymbols[e]=nativeObjectCreate(SymbolPrototype$1);return setInternalState$4(r,{type:SYMBOL,tag:e,description:t}),DESCRIPTORS$c||(r.description=t),r},$defineProperty=function(t,r,n){t===ObjectPrototype$2&&$defineProperty(ObjectPrototypeSymbols,r,n),anObject$h(t);var o=toPropertyKey(r);return anObject$h(n),hasOwn$d(AllSymbols,o)?(n.enumerable?(hasOwn$d(t,HIDDEN)&&t[HIDDEN][o]&&(t[HIDDEN][o]=!1),n=nativeObjectCreate(n,{enumerable:createPropertyDescriptor$1(0,!1)})):(hasOwn$d(t,HIDDEN)||nativeDefineProperty(t,HIDDEN,createPropertyDescriptor$1(1,{})),t[HIDDEN][o]=!0),setSymbolDescriptor(t,o,n)):nativeDefineProperty(t,o,n)},$defineProperties=function(t,r){anObject$h(t);var n=toIndexedObject$7(r),o=objectKeys$2(n).concat($getOwnPropertySymbols(n));return $forEach$1(o,function(i){(!DESCRIPTORS$c||call$g($propertyIsEnumerable$1,n,i))&&$defineProperty(t,i,n[i])}),t},$create=function(t,r){return r===void 0?nativeObjectCreate(t):$defineProperties(nativeObjectCreate(t),r)},$propertyIsEnumerable$1=function(t){var r=toPropertyKey(t),n=call$g(nativePropertyIsEnumerable,this,r);return this===ObjectPrototype$2&&hasOwn$d(AllSymbols,r)&&!hasOwn$d(ObjectPrototypeSymbols,r)?!1:n||!hasOwn$d(this,r)||!hasOwn$d(AllSymbols,r)||hasOwn$d(this,HIDDEN)&&this[HIDDEN][r]?n:!0},$getOwnPropertyDescriptor=function(t,r){var n=toIndexedObject$7(t),o=toPropertyKey(r);if(!(n===ObjectPrototype$2&&hasOwn$d(AllSymbols,o)&&!hasOwn$d(ObjectPrototypeSymbols,o))){var i=nativeGetOwnPropertyDescriptor$1(n,o);return i&&hasOwn$d(AllSymbols,o)&&!(hasOwn$d(n,HIDDEN)&&n[HIDDEN][o])&&(i.enumerable=!0),i}},$getOwnPropertyNames=function(t){var r=nativeGetOwnPropertyNames(toIndexedObject$7(t)),n=[];return $forEach$1(r,function(o){!hasOwn$d(AllSymbols,o)&&!hasOwn$d(hiddenKeys$1,o)&&push$6(n,o)}),n},$getOwnPropertySymbols=function(e){var t=e===ObjectPrototype$2,r=nativeGetOwnPropertyNames(t?ObjectPrototypeSymbols:toIndexedObject$7(e)),n=[];return $forEach$1(r,function(o){hasOwn$d(AllSymbols,o)&&(!t||hasOwn$d(ObjectPrototype$2,o))&&push$6(n,AllSymbols[o])}),n};NATIVE_SYMBOL$4||($Symbol=function(){if(isPrototypeOf$6(SymbolPrototype$1,this))throw TypeError$2("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:$toString$1(arguments[0]),r=uid$1(t),n=function(o){this===ObjectPrototype$2&&call$g(n,ObjectPrototypeSymbols,o),hasOwn$d(this,HIDDEN)&&hasOwn$d(this[HIDDEN],r)&&(this[HIDDEN][r]=!1),setSymbolDescriptor(this,r,createPropertyDescriptor$1(1,o))};return DESCRIPTORS$c&&USE_SETTER&&setSymbolDescriptor(ObjectPrototype$2,r,{configurable:!0,set:n}),wrap(r,t)},SymbolPrototype$1=$Symbol[PROTOTYPE],defineBuiltIn$9(SymbolPrototype$1,"toString",function(){return getInternalState$3(this).tag}),defineBuiltIn$9($Symbol,"withoutSetter",function(e){return wrap(uid$1(e),e)}),propertyIsEnumerableModule$1.f=$propertyIsEnumerable$1,definePropertyModule.f=$defineProperty,definePropertiesModule.f=$defineProperties,getOwnPropertyDescriptorModule$2.f=$getOwnPropertyDescriptor,getOwnPropertyNamesModule$1.f=getOwnPropertyNamesExternal.f=$getOwnPropertyNames,getOwnPropertySymbolsModule$2.f=$getOwnPropertySymbols,wrappedWellKnownSymbolModule.f=function(e){return wrap(wellKnownSymbol$i(e),e)},DESCRIPTORS$c&&(defineBuiltInAccessor$4(SymbolPrototype$1,"description",{configurable:!0,get:function(){return getInternalState$3(this).description}}),defineBuiltIn$9(ObjectPrototype$2,"propertyIsEnumerable",$propertyIsEnumerable$1,{unsafe:!0})));$$N({global:!0,constructor:!0,wrap:!0,forced:!NATIVE_SYMBOL$4,sham:!NATIVE_SYMBOL$4},{Symbol:$Symbol});$forEach$1(objectKeys$2(WellKnownSymbolsStore),function(e){defineWellKnownSymbol$2(e)});$$N({target:SYMBOL,stat:!0,forced:!NATIVE_SYMBOL$4},{useSetter:function(){USE_SETTER=!0},useSimple:function(){USE_SETTER=!1}});$$N({target:"Object",stat:!0,forced:!NATIVE_SYMBOL$4,sham:!DESCRIPTORS$c},{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor});$$N({target:"Object",stat:!0,forced:!NATIVE_SYMBOL$4},{getOwnPropertyNames:$getOwnPropertyNames});defineSymbolToPrimitive$1();setToStringTag$3($Symbol,SYMBOL);hiddenKeys$1[HIDDEN]=!0;var NATIVE_SYMBOL$3=symbolConstructorDetection,symbolRegistryDetection=NATIVE_SYMBOL$3&&!!Symbol.for&&!!Symbol.keyFor,$$M=_export,getBuiltIn$3=getBuiltIn$9,hasOwn$c=hasOwnProperty_1,toString$k=toString$l,shared$2=sharedExports,NATIVE_SYMBOL_REGISTRY$1=symbolRegistryDetection,StringToSymbolRegistry=shared$2("string-to-symbol-registry"),SymbolToStringRegistry$1=shared$2("symbol-to-string-registry");$$M({target:"Symbol",stat:!0,forced:!NATIVE_SYMBOL_REGISTRY$1},{for:function(e){var t=toString$k(e);if(hasOwn$c(StringToSymbolRegistry,t))return StringToSymbolRegistry[t];var r=getBuiltIn$3("Symbol")(t);return StringToSymbolRegistry[t]=r,SymbolToStringRegistry$1[r]=t,r}});var $$L=_export,hasOwn$b=hasOwnProperty_1,isSymbol$2=isSymbol$5,tryToString$4=tryToString$6,shared$1=sharedExports,NATIVE_SYMBOL_REGISTRY=symbolRegistryDetection,SymbolToStringRegistry=shared$1("symbol-to-string-registry");$$L({target:"Symbol",stat:!0,forced:!NATIVE_SYMBOL_REGISTRY},{keyFor:function(t){if(!isSymbol$2(t))throw TypeError(tryToString$4(t)+" is not a symbol");if(hasOwn$b(SymbolToStringRegistry,t))return SymbolToStringRegistry[t]}});var NATIVE_BIND$1=functionBindNative,FunctionPrototype$1=Function.prototype,apply$8=FunctionPrototype$1.apply,call$f=FunctionPrototype$1.call,functionApply=typeof Reflect=="object"&&Reflect.apply||(NATIVE_BIND$1?call$f.bind(apply$8):function(){return call$f.apply(apply$8,arguments)}),uncurryThis$w=functionUncurryThis,arraySlice$6=uncurryThis$w([].slice),uncurryThis$v=functionUncurryThis,isArray$6=isArray$8,isCallable$c=isCallable$p,classof$6=classofRaw$2,toString$j=toString$l,push$5=uncurryThis$v([].push),getJsonReplacerFunction=function(e){if(isCallable$c(e))return e;if(isArray$6(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?push$5(r,o):(typeof o=="number"||classof$6(o)=="Number"||classof$6(o)=="String")&&push$5(r,toString$j(o))}var i=r.length,a=!0;return function(s,l){if(a)return a=!1,l;if(isArray$6(this))return l;for(var u=0;u<i;u++)if(r[u]===s)return l}}},$$K=_export,getBuiltIn$2=getBuiltIn$9,apply$7=functionApply,call$e=functionCall,uncurryThis$u=functionUncurryThis,fails$w=fails$I,isCallable$b=isCallable$p,isSymbol$1=isSymbol$5,arraySlice$5=arraySlice$6,getReplacerFunction=getJsonReplacerFunction,NATIVE_SYMBOL$2=symbolConstructorDetection,$String$2=String,$stringify=getBuiltIn$2("JSON","stringify"),exec$3=uncurryThis$u(/./.exec),charAt$6=uncurryThis$u("".charAt),charCodeAt$2=uncurryThis$u("".charCodeAt),replace$6=uncurryThis$u("".replace),numberToString=uncurryThis$u(1 .toString),tester$1=/[\uD800-\uDFFF]/g,low=/^[\uD800-\uDBFF]$/,hi=/^[\uDC00-\uDFFF]$/,WRONG_SYMBOLS_CONVERSION=!NATIVE_SYMBOL$2||fails$w(function(){var e=getBuiltIn$2("Symbol")();return $stringify([e])!="[null]"||$stringify({a:e})!="{}"||$stringify(Object(e))!="{}"}),ILL_FORMED_UNICODE=fails$w(function(){return $stringify("\uDF06\uD834")!=='"\\udf06\\ud834"'||$stringify("\uDEAD")!=='"\\udead"'}),stringifyWithSymbolsFix=function(e,t){var r=arraySlice$5(arguments),n=getReplacerFunction(t);if(!(!isCallable$b(n)&&(e===void 0||isSymbol$1(e))))return r[1]=function(o,i){if(isCallable$b(n)&&(i=call$e(n,this,$String$2(o),i)),!isSymbol$1(i))return i},apply$7($stringify,null,r)},fixIllFormed=function(e,t,r){var n=charAt$6(r,t-1),o=charAt$6(r,t+1);return exec$3(low,e)&&!exec$3(hi,o)||exec$3(hi,e)&&!exec$3(low,n)?"\\u"+numberToString(charCodeAt$2(e,0),16):e};$stringify&&$$K({target:"JSON",stat:!0,arity:3,forced:WRONG_SYMBOLS_CONVERSION||ILL_FORMED_UNICODE},{stringify:function(t,r,n){var o=arraySlice$5(arguments),i=apply$7(WRONG_SYMBOLS_CONVERSION?stringifyWithSymbolsFix:$stringify,null,o);return ILL_FORMED_UNICODE&&typeof i=="string"?replace$6(i,tester$1,fixIllFormed):i}});var $$J=_export,NATIVE_SYMBOL$1=symbolConstructorDetection,fails$v=fails$I,getOwnPropertySymbolsModule$1=objectGetOwnPropertySymbols,toObject$c=toObject$f,FORCED$a=!NATIVE_SYMBOL$1||fails$v(function(){getOwnPropertySymbolsModule$1.f(1)});$$J({target:"Object",stat:!0,forced:FORCED$a},{getOwnPropertySymbols:function(t){var r=getOwnPropertySymbolsModule$1.f;return r?r(toObject$c(t)):[]}});var $$I=_export,DESCRIPTORS$b=descriptors,global$g=global$s,uncurryThis$t=functionUncurryThis,hasOwn$a=hasOwnProperty_1,isCallable$a=isCallable$p,isPrototypeOf$5=objectIsPrototypeOf,toString$i=toString$l,defineBuiltInAccessor$3=defineBuiltInAccessor$5,copyConstructorProperties$1=copyConstructorProperties$3,NativeSymbol=global$g.Symbol,SymbolPrototype=NativeSymbol&&NativeSymbol.prototype;if(DESCRIPTORS$b&&isCallable$a(NativeSymbol)&&(!("description"in SymbolPrototype)||NativeSymbol().description!==void 0)){var EmptyStringDescriptionStore={},SymbolWrapper=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:toString$i(arguments[0]),r=isPrototypeOf$5(SymbolPrototype,this)?new NativeSymbol(t):t===void 0?NativeSymbol():NativeSymbol(t);return t===""&&(EmptyStringDescriptionStore[r]=!0),r};copyConstructorProperties$1(SymbolWrapper,NativeSymbol),SymbolWrapper.prototype=SymbolPrototype,SymbolPrototype.constructor=SymbolWrapper;var NATIVE_SYMBOL=String(NativeSymbol("test"))=="Symbol(test)",thisSymbolValue=uncurryThis$t(SymbolPrototype.valueOf),symbolDescriptiveString=uncurryThis$t(SymbolPrototype.toString),regexp=/^Symbol\((.*)\)[^)]+$/,replace$5=uncurryThis$t("".replace),stringSlice$a=uncurryThis$t("".slice);defineBuiltInAccessor$3(SymbolPrototype,"description",{configurable:!0,get:function(){var t=thisSymbolValue(this);if(hasOwn$a(EmptyStringDescriptionStore,t))return"";var r=symbolDescriptiveString(t),n=NATIVE_SYMBOL?stringSlice$a(r,7,-1):replace$5(r,regexp,"$1");return n===""?void 0:n}}),$$I({global:!0,constructor:!0,forced:!0},{Symbol:SymbolWrapper})}var defineWellKnownSymbol$1=wellKnownSymbolDefine;defineWellKnownSymbol$1("iterator");var DESCRIPTORS$a=descriptors,FUNCTION_NAME_EXISTS=functionName.EXISTS,uncurryThis$s=functionUncurryThis,defineBuiltInAccessor$2=defineBuiltInAccessor$5,FunctionPrototype=Function.prototype,functionToString=uncurryThis$s(FunctionPrototype.toString),nameRE=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,regExpExec$3=uncurryThis$s(nameRE.exec),NAME="name";DESCRIPTORS$a&&!FUNCTION_NAME_EXISTS&&defineBuiltInAccessor$2(FunctionPrototype,NAME,{configurable:!0,get:function(){try{return regExpExec$3(nameRE,functionToString(this))[1]}catch{return""}}});var fails$u=fails$I,freezing=!fails$u(function(){return Object.isExtensible(Object.preventExtensions({}))}),internalMetadataExports={},internalMetadata={get exports(){return internalMetadataExports},set exports(e){internalMetadataExports=e}},fails$t=fails$I,arrayBufferNonExtensible=fails$t(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),fails$s=fails$I,isObject$g=isObject$n,classof$5=classofRaw$2,ARRAY_BUFFER_NON_EXTENSIBLE=arrayBufferNonExtensible,$isExtensible=Object.isExtensible,FAILS_ON_PRIMITIVES$3=fails$s(function(){$isExtensible(1)}),objectIsExtensible=FAILS_ON_PRIMITIVES$3||ARRAY_BUFFER_NON_EXTENSIBLE?function(t){return!isObject$g(t)||ARRAY_BUFFER_NON_EXTENSIBLE&&classof$5(t)=="ArrayBuffer"?!1:$isExtensible?$isExtensible(t):!0}:$isExtensible,$$H=_export,uncurryThis$r=functionUncurryThis,hiddenKeys=hiddenKeys$6,isObject$f=isObject$n,hasOwn$9=hasOwnProperty_1,defineProperty$5=objectDefineProperty.f,getOwnPropertyNamesModule=objectGetOwnPropertyNames,getOwnPropertyNamesExternalModule=objectGetOwnPropertyNamesExternal,isExtensible$1=objectIsExtensible,uid=uid$4,FREEZING$2=freezing,REQUIRED=!1,METADATA=uid("meta"),id$1=0,setMetadata=function(e){defineProperty$5(e,METADATA,{value:{objectID:"O"+id$1++,weakData:{}}})},fastKey$1=function(e,t){if(!isObject$f(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!hasOwn$9(e,METADATA)){if(!isExtensible$1(e))return"F";if(!t)return"E";setMetadata(e)}return e[METADATA].objectID},getWeakData$1=function(e,t){if(!hasOwn$9(e,METADATA)){if(!isExtensible$1(e))return!0;if(!t)return!1;setMetadata(e)}return e[METADATA].weakData},onFreeze$1=function(e){return FREEZING$2&&REQUIRED&&isExtensible$1(e)&&!hasOwn$9(e,METADATA)&&setMetadata(e),e},enable=function(){meta.enable=function(){},REQUIRED=!0;var e=getOwnPropertyNamesModule.f,t=uncurryThis$r([].splice),r={};r[METADATA]=1,e(r).length&&(getOwnPropertyNamesModule.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===METADATA){t(o,i,1);break}return o},$$H({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:getOwnPropertyNamesExternalModule.f}))},meta=internalMetadata.exports={enable,fastKey:fastKey$1,getWeakData:getWeakData$1,onFreeze:onFreeze$1};hiddenKeys[METADATA]=!0;var $$G=_export,FREEZING$1=freezing,fails$r=fails$I,isObject$e=isObject$n,onFreeze=internalMetadataExports.onFreeze,$freeze=Object.freeze,FAILS_ON_PRIMITIVES$2=fails$r(function(){$freeze(1)});$$G({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES$2,sham:!FREEZING$1},{freeze:function(t){return $freeze&&isObject$e(t)?$freeze(onFreeze(t)):t}});var wellKnownSymbol$h=wellKnownSymbol$q,create$5=objectCreate,defineProperty$4=objectDefineProperty.f,UNSCOPABLES=wellKnownSymbol$h("unscopables"),ArrayPrototype$1=Array.prototype;ArrayPrototype$1[UNSCOPABLES]==null&&defineProperty$4(ArrayPrototype$1,UNSCOPABLES,{configurable:!0,value:create$5(null)});var addToUnscopables$5=function(e){ArrayPrototype$1[UNSCOPABLES][e]=!0},iterators={},fails$q=fails$I,correctPrototypeGetter=!fails$q(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),hasOwn$8=hasOwnProperty_1,isCallable$9=isCallable$p,toObject$b=toObject$f,sharedKey=sharedKey$4,CORRECT_PROTOTYPE_GETTER$1=correctPrototypeGetter,IE_PROTO=sharedKey("IE_PROTO"),$Object$1=Object,ObjectPrototype$1=$Object$1.prototype,objectGetPrototypeOf=CORRECT_PROTOTYPE_GETTER$1?$Object$1.getPrototypeOf:function(e){var t=toObject$b(e);if(hasOwn$8(t,IE_PROTO))return t[IE_PROTO];var r=t.constructor;return isCallable$9(r)&&t instanceof r?r.prototype:t instanceof $Object$1?ObjectPrototype$1:null},fails$p=fails$I,isCallable$8=isCallable$p,isObject$d=isObject$n,getPrototypeOf$3=objectGetPrototypeOf,defineBuiltIn$8=defineBuiltIn$c,wellKnownSymbol$g=wellKnownSymbol$q,ITERATOR$5=wellKnownSymbol$g("iterator"),BUGGY_SAFARI_ITERATORS$1=!1,IteratorPrototype$2,PrototypeOfArrayIteratorPrototype,arrayIterator;[].keys&&(arrayIterator=[].keys(),"next"in arrayIterator?(PrototypeOfArrayIteratorPrototype=getPrototypeOf$3(getPrototypeOf$3(arrayIterator)),PrototypeOfArrayIteratorPrototype!==Object.prototype&&(IteratorPrototype$2=PrototypeOfArrayIteratorPrototype)):BUGGY_SAFARI_ITERATORS$1=!0);var NEW_ITERATOR_PROTOTYPE=!isObject$d(IteratorPrototype$2)||fails$p(function(){var e={};return IteratorPrototype$2[ITERATOR$5].call(e)!==e});NEW_ITERATOR_PROTOTYPE&&(IteratorPrototype$2={});isCallable$8(IteratorPrototype$2[ITERATOR$5])||defineBuiltIn$8(IteratorPrototype$2,ITERATOR$5,function(){return this});var iteratorsCore={IteratorPrototype:IteratorPrototype$2,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS$1},IteratorPrototype$1=iteratorsCore.IteratorPrototype,create$4=objectCreate,createPropertyDescriptor=createPropertyDescriptor$5,setToStringTag$2=setToStringTag$4,Iterators$4=iterators,returnThis$1=function(){return this},iteratorCreateConstructor=function(e,t,r,n){var o=t+" Iterator";return e.prototype=create$4(IteratorPrototype$1,{next:createPropertyDescriptor(+!n,r)}),setToStringTag$2(e,o,!1),Iterators$4[o]=returnThis$1,e},uncurryThis$q=functionUncurryThis,aCallable$4=aCallable$7,functionUncurryThisAccessor=function(e,t,r){try{return uncurryThis$q(aCallable$4(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},isCallable$7=isCallable$p,$String$1=String,$TypeError$c=TypeError,aPossiblePrototype$1=function(e){if(typeof e=="object"||isCallable$7(e))return e;throw $TypeError$c("Can't set "+$String$1(e)+" as a prototype")},uncurryThisAccessor=functionUncurryThisAccessor,anObject$g=anObject$m,aPossiblePrototype=aPossiblePrototype$1,objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=uncurryThisAccessor(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return anObject$g(o),aPossiblePrototype(i),e?r(o,i):o.__proto__=i,o}}():void 0),$$F=_export,call$d=functionCall,FunctionName=functionName,isCallable$6=isCallable$p,createIteratorConstructor=iteratorCreateConstructor,getPrototypeOf$2=objectGetPrototypeOf,setPrototypeOf$3=objectSetPrototypeOf,setToStringTag$1=setToStringTag$4,createNonEnumerableProperty$4=createNonEnumerableProperty$7,defineBuiltIn$7=defineBuiltIn$c,wellKnownSymbol$f=wellKnownSymbol$q,Iterators$3=iterators,IteratorsCore=iteratorsCore,PROPER_FUNCTION_NAME$2=FunctionName.PROPER,CONFIGURABLE_FUNCTION_NAME=FunctionName.CONFIGURABLE,IteratorPrototype=IteratorsCore.IteratorPrototype,BUGGY_SAFARI_ITERATORS=IteratorsCore.BUGGY_SAFARI_ITERATORS,ITERATOR$4=wellKnownSymbol$f("iterator"),KEYS="keys",VALUES="values",ENTRIES="entries",returnThis=function(){return this},iteratorDefine=function(e,t,r,n,o,i,a){createIteratorConstructor(r,t,n);var s=function(b){if(b===o&&d)return d;if(!BUGGY_SAFARI_ITERATORS&&b in c)return c[b];switch(b){case KEYS:return function(){return new r(this,b)};case VALUES:return function(){return new r(this,b)};case ENTRIES:return function(){return new r(this,b)}}return function(){return new r(this)}},l=t+" Iterator",u=!1,c=e.prototype,f=c[ITERATOR$4]||c["@@iterator"]||o&&c[o],d=!BUGGY_SAFARI_ITERATORS&&f||s(o),h=t=="Array"&&c.entries||f,y,p,v;if(h&&(y=getPrototypeOf$2(h.call(new e)),y!==Object.prototype&&y.next&&(getPrototypeOf$2(y)!==IteratorPrototype&&(setPrototypeOf$3?setPrototypeOf$3(y,IteratorPrototype):isCallable$6(y[ITERATOR$4])||defineBuiltIn$7(y,ITERATOR$4,returnThis)),setToStringTag$1(y,l,!0))),PROPER_FUNCTION_NAME$2&&o==VALUES&&f&&f.name!==VALUES&&(CONFIGURABLE_FUNCTION_NAME?createNonEnumerableProperty$4(c,"name",VALUES):(u=!0,d=function(){return call$d(f,this)})),o)if(p={values:s(VALUES),keys:i?d:s(KEYS),entries:s(ENTRIES)},a)for(v in p)(BUGGY_SAFARI_ITERATORS||u||!(v in c))&&defineBuiltIn$7(c,v,p[v]);else $$F({target:t,proto:!0,forced:BUGGY_SAFARI_ITERATORS||u},p);return c[ITERATOR$4]!==d&&defineBuiltIn$7(c,ITERATOR$4,d,{name:o}),Iterators$3[t]=d,p},createIterResultObject$3=function(e,t){return{value:e,done:t}},toIndexedObject$6=toIndexedObject$d,addToUnscopables$4=addToUnscopables$5,Iterators$2=iterators,InternalStateModule$3=internalState,defineProperty$3=objectDefineProperty.f,defineIterator$2=iteratorDefine,createIterResultObject$2=createIterResultObject$3,DESCRIPTORS$9=descriptors,ARRAY_ITERATOR="Array Iterator",setInternalState$3=InternalStateModule$3.set,getInternalState$2=InternalStateModule$3.getterFor(ARRAY_ITERATOR),es_array_iterator=defineIterator$2(Array,"Array",function(e,t){setInternalState$3(this,{type:ARRAY_ITERATOR,target:toIndexedObject$6(e),index:0,kind:t})},function(){var e=getInternalState$2(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,createIterResultObject$2(void 0,!0)):r=="keys"?createIterResultObject$2(n,!1):r=="values"?createIterResultObject$2(t[n],!1):createIterResultObject$2([n,t[n]],!1)},"values"),values=Iterators$2.Arguments=Iterators$2.Array;addToUnscopables$4("keys");addToUnscopables$4("values");addToUnscopables$4("entries");if(DESCRIPTORS$9&&values.name!=="values")try{defineProperty$3(values,"name",{value:"values"})}catch{}var TO_STRING_TAG_SUPPORT$1=toStringTagSupport,classof$4=classof$a,objectToString=TO_STRING_TAG_SUPPORT$1?{}.toString:function(){return"[object "+classof$4(this)+"]"},TO_STRING_TAG_SUPPORT=toStringTagSupport,defineBuiltIn$6=defineBuiltIn$c,toString$h=objectToString;TO_STRING_TAG_SUPPORT||defineBuiltIn$6(Object.prototype,"toString",toString$h,{unsafe:!0});var wellKnownSymbol$e=wellKnownSymbol$q,Iterators$1=iterators,ITERATOR$3=wellKnownSymbol$e("iterator"),ArrayPrototype=Array.prototype,isArrayIteratorMethod$2=function(e){return e!==void 0&&(Iterators$1.Array===e||ArrayPrototype[ITERATOR$3]===e)},classof$3=classof$a,getMethod$5=getMethod$7,isNullOrUndefined$8=isNullOrUndefined$b,Iterators=iterators,wellKnownSymbol$d=wellKnownSymbol$q,ITERATOR$2=wellKnownSymbol$d("iterator"),getIteratorMethod$3=function(e){if(!isNullOrUndefined$8(e))return getMethod$5(e,ITERATOR$2)||getMethod$5(e,"@@iterator")||Iterators[classof$3(e)]},call$c=functionCall,aCallable$3=aCallable$7,anObject$f=anObject$m,tryToString$3=tryToString$6,getIteratorMethod$2=getIteratorMethod$3,$TypeError$b=TypeError,getIterator$2=function(e,t){var r=arguments.length<2?getIteratorMethod$2(e):t;if(aCallable$3(r))return anObject$f(call$c(r,e));throw $TypeError$b(tryToString$3(e)+" is not iterable")},call$b=functionCall,anObject$e=anObject$m,getMethod$4=getMethod$7,iteratorClose$2=function(e,t,r){var n,o;anObject$e(e);try{if(n=getMethod$4(e,"return"),!n){if(t==="throw")throw r;return r}n=call$b(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return anObject$e(n),r},bind$4=functionBindContext,call$a=functionCall,anObject$d=anObject$m,tryToString$2=tryToString$6,isArrayIteratorMethod$1=isArrayIteratorMethod$2,lengthOfArrayLike$8=lengthOfArrayLike$c,isPrototypeOf$4=objectIsPrototypeOf,getIterator$1=getIterator$2,getIteratorMethod$1=getIteratorMethod$3,iteratorClose$1=iteratorClose$2,$TypeError$a=TypeError,Result=function(e,t){this.stopped=e,this.result=t},ResultPrototype=Result.prototype,iterate$3=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),l=bind$4(t,n),u,c,f,d,h,y,p,v=function(S){return u&&iteratorClose$1(u,"normal",S),new Result(!0,S)},b=function(S){return o?(anObject$d(S),s?l(S[0],S[1],v):l(S[0],S[1])):s?l(S,v):l(S)};if(i)u=e.iterator;else if(a)u=e;else{if(c=getIteratorMethod$1(e),!c)throw $TypeError$a(tryToString$2(e)+" is not iterable");if(isArrayIteratorMethod$1(c)){for(f=0,d=lengthOfArrayLike$8(e);d>f;f++)if(h=b(e[f]),h&&isPrototypeOf$4(ResultPrototype,h))return h;return new Result(!1)}u=getIterator$1(e,c)}for(y=i?e.next:u.next;!(p=call$a(y,u)).done;){try{h=b(p.value)}catch(S){iteratorClose$1(u,"throw",S)}if(typeof h=="object"&&h&&isPrototypeOf$4(ResultPrototype,h))return h}return new Result(!1)},isPrototypeOf$3=objectIsPrototypeOf,$TypeError$9=TypeError,anInstance$3=function(e,t){if(isPrototypeOf$3(t,e))return e;throw $TypeError$9("Incorrect invocation")},wellKnownSymbol$c=wellKnownSymbol$q,ITERATOR$1=wellKnownSymbol$c("iterator"),SAFE_CLOSING=!1;try{var called=0,iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=!0}};iteratorWithReturn[ITERATOR$1]=function(){return this},Array.from(iteratorWithReturn,function(){throw 2})}catch{}var checkCorrectnessOfIteration$2=function(e,t){if(!t&&!SAFE_CLOSING)return!1;var r=!1;try{var n={};n[ITERATOR$1]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},isCallable$5=isCallable$p,isObject$c=isObject$n,setPrototypeOf$2=objectSetPrototypeOf,inheritIfRequired$3=function(e,t,r){var n,o;return setPrototypeOf$2&&isCallable$5(n=t.constructor)&&n!==r&&isObject$c(o=n.prototype)&&o!==r.prototype&&setPrototypeOf$2(e,o),e},$$E=_export,global$f=global$s,uncurryThis$p=functionUncurryThis,isForced$2=isForced_1,defineBuiltIn$5=defineBuiltIn$c,InternalMetadataModule$1=internalMetadataExports,iterate$2=iterate$3,anInstance$2=anInstance$3,isCallable$4=isCallable$p,isNullOrUndefined$7=isNullOrUndefined$b,isObject$b=isObject$n,fails$o=fails$I,checkCorrectnessOfIteration$1=checkCorrectnessOfIteration$2,setToStringTag=setToStringTag$4,inheritIfRequired$2=inheritIfRequired$3,collection$5=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=global$f[e],s=a&&a.prototype,l=a,u={},c=function(b){var S=uncurryThis$p(s[b]);defineBuiltIn$5(s,b,b=="add"?function(P){return S(this,P===0?0:P),this}:b=="delete"?function(w){return o&&!isObject$b(w)?!1:S(this,w===0?0:w)}:b=="get"?function(P){return o&&!isObject$b(P)?void 0:S(this,P===0?0:P)}:b=="has"?function(P){return o&&!isObject$b(P)?!1:S(this,P===0?0:P)}:function(P,E){return S(this,P===0?0:P,E),this})},f=isForced$2(e,!isCallable$4(a)||!(o||s.forEach&&!fails$o(function(){new a().entries().next()})));if(f)l=r.getConstructor(t,e,n,i),InternalMetadataModule$1.enable();else if(isForced$2(e,!0)){var d=new l,h=d[i](o?{}:-0,1)!=d,y=fails$o(function(){d.has(1)}),p=checkCorrectnessOfIteration$1(function(b){new a(b)}),v=!o&&fails$o(function(){for(var b=new a,S=5;S--;)b[i](S,S);return!b.has(-0)});p||(l=t(function(b,S){anInstance$2(b,s);var w=inheritIfRequired$2(new a,b,l);return isNullOrUndefined$7(S)||iterate$2(S,w[i],{that:w,AS_ENTRIES:n}),w}),l.prototype=s,s.constructor=l),(y||v)&&(c("delete"),c("has"),n&&c("get")),(v||h)&&c(i),o&&s.clear&&delete s.clear}return u[e]=l,$$E({global:!0,constructor:!0,forced:l!=a},u),setToStringTag(l,e),o||r.setStrong(l,e,n),l},defineBuiltIn$4=defineBuiltIn$c,defineBuiltIns$3=function(e,t,r){for(var n in t)defineBuiltIn$4(e,n,t[n],r);return e},getBuiltIn$1=getBuiltIn$9,defineBuiltInAccessor$1=defineBuiltInAccessor$5,wellKnownSymbol$b=wellKnownSymbol$q,DESCRIPTORS$8=descriptors,SPECIES$4=wellKnownSymbol$b("species"),setSpecies$2=function(e){var t=getBuiltIn$1(e);DESCRIPTORS$8&&t&&!t[SPECIES$4]&&defineBuiltInAccessor$1(t,SPECIES$4,{configurable:!0,get:function(){return this}})},create$3=objectCreate,defineBuiltInAccessor=defineBuiltInAccessor$5,defineBuiltIns$2=defineBuiltIns$3,bind$3=functionBindContext,anInstance$1=anInstance$3,isNullOrUndefined$6=isNullOrUndefined$b,iterate$1=iterate$3,defineIterator$1=iteratorDefine,createIterResultObject$1=createIterResultObject$3,setSpecies$1=setSpecies$2,DESCRIPTORS$7=descriptors,fastKey=internalMetadataExports.fastKey,InternalStateModule$2=internalState,setInternalState$2=InternalStateModule$2.set,internalStateGetterFor$1=InternalStateModule$2.getterFor,collectionStrong$2={getConstructor:function(e,t,r,n){var o=e(function(u,c){anInstance$1(u,i),setInternalState$2(u,{type:t,index:create$3(null),first:void 0,last:void 0,size:0}),DESCRIPTORS$7||(u.size=0),isNullOrUndefined$6(c)||iterate$1(c,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=internalStateGetterFor$1(t),s=function(u,c,f){var d=a(u),h=l(u,c),y,p;return h?h.value=f:(d.last=h={index:p=fastKey(c,!0),key:c,value:f,previous:y=d.last,next:void 0,removed:!1},d.first||(d.first=h),y&&(y.next=h),DESCRIPTORS$7?d.size++:u.size++,p!=="F"&&(d.index[p]=h)),u},l=function(u,c){var f=a(u),d=fastKey(c),h;if(d!=="F")return f.index[d];for(h=f.first;h;h=h.next)if(h.key==c)return h};return defineBuiltIns$2(i,{clear:function(){for(var c=this,f=a(c),d=f.index,h=f.first;h;)h.removed=!0,h.previous&&(h.previous=h.previous.next=void 0),delete d[h.index],h=h.next;f.first=f.last=void 0,DESCRIPTORS$7?f.size=0:c.size=0},delete:function(u){var c=this,f=a(c),d=l(c,u);if(d){var h=d.next,y=d.previous;delete f.index[d.index],d.removed=!0,y&&(y.next=h),h&&(h.previous=y),f.first==d&&(f.first=h),f.last==d&&(f.last=y),DESCRIPTORS$7?f.size--:c.size--}return!!d},forEach:function(c){for(var f=a(this),d=bind$3(c,arguments.length>1?arguments[1]:void 0),h;h=h?h.next:f.first;)for(d(h.value,h.key,this);h&&h.removed;)h=h.previous},has:function(c){return!!l(this,c)}}),defineBuiltIns$2(i,r?{get:function(c){var f=l(this,c);return f&&f.value},set:function(c,f){return s(this,c===0?0:c,f)}}:{add:function(c){return s(this,c=c===0?0:c,c)}}),DESCRIPTORS$7&&defineBuiltInAccessor(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=internalStateGetterFor$1(t),i=internalStateGetterFor$1(n);defineIterator$1(e,t,function(a,s){setInternalState$2(this,{type:n,target:a,state:o(a),kind:s,last:void 0})},function(){for(var a=i(this),s=a.kind,l=a.last;l&&l.removed;)l=l.previous;return!a.target||!(a.last=l=l?l.next:a.state.first)?(a.target=void 0,createIterResultObject$1(void 0,!0)):s=="keys"?createIterResultObject$1(l.key,!1):s=="values"?createIterResultObject$1(l.value,!1):createIterResultObject$1([l.key,l.value],!1)},r?"entries":"values",!r,!0),setSpecies$1(t)}},collection$4=collection$5,collectionStrong$1=collectionStrong$2;collection$4("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},collectionStrong$1);var uncurryThis$o=functionUncurryThis,toIntegerOrInfinity$5=toIntegerOrInfinity$8,toString$g=toString$l,requireObjectCoercible$b=requireObjectCoercible$e,charAt$5=uncurryThis$o("".charAt),charCodeAt$1=uncurryThis$o("".charCodeAt),stringSlice$9=uncurryThis$o("".slice),createMethod$4=function(e){return function(t,r){var n=toString$g(requireObjectCoercible$b(t)),o=toIntegerOrInfinity$5(r),i=n.length,a,s;return o<0||o>=i?e?"":void 0:(a=charCodeAt$1(n,o),a<55296||a>56319||o+1===i||(s=charCodeAt$1(n,o+1))<56320||s>57343?e?charAt$5(n,o):a:e?stringSlice$9(n,o,o+2):(a-55296<<10)+(s-56320)+65536)}},stringMultibyte={codeAt:createMethod$4(!1),charAt:createMethod$4(!0)},charAt$4=stringMultibyte.charAt,toString$f=toString$l,InternalStateModule$1=internalState,defineIterator=iteratorDefine,createIterResultObject=createIterResultObject$3,STRING_ITERATOR="String Iterator",setInternalState$1=InternalStateModule$1.set,getInternalState$1=InternalStateModule$1.getterFor(STRING_ITERATOR);defineIterator(String,"String",function(e){setInternalState$1(this,{type:STRING_ITERATOR,string:toString$f(e),index:0})},function(){var t=getInternalState$1(this),r=t.string,n=t.index,o;return n>=r.length?createIterResultObject(void 0,!0):(o=charAt$4(r,n),t.index+=o.length,createIterResultObject(o,!1))});var domIterables={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},documentCreateElement=documentCreateElement$2,classList=documentCreateElement("span").classList,DOMTokenListPrototype$2=classList&&classList.constructor&&classList.constructor.prototype,domTokenListPrototype=DOMTokenListPrototype$2===Object.prototype?void 0:DOMTokenListPrototype$2,global$e=global$s,DOMIterables$1=domIterables,DOMTokenListPrototype$1=domTokenListPrototype,ArrayIteratorMethods=es_array_iterator,createNonEnumerableProperty$3=createNonEnumerableProperty$7,wellKnownSymbol$a=wellKnownSymbol$q,ITERATOR=wellKnownSymbol$a("iterator"),TO_STRING_TAG=wellKnownSymbol$a("toStringTag"),ArrayValues=ArrayIteratorMethods.values,handlePrototype$1=function(e,t){if(e){if(e[ITERATOR]!==ArrayValues)try{createNonEnumerableProperty$3(e,ITERATOR,ArrayValues)}catch{e[ITERATOR]=ArrayValues}if(e[TO_STRING_TAG]||createNonEnumerableProperty$3(e,TO_STRING_TAG,t),DOMIterables$1[t]){for(var r in ArrayIteratorMethods)if(e[r]!==ArrayIteratorMethods[r])try{createNonEnumerableProperty$3(e,r,ArrayIteratorMethods[r])}catch{e[r]=ArrayIteratorMethods[r]}}}};for(var COLLECTION_NAME$1 in DOMIterables$1)handlePrototype$1(global$e[COLLECTION_NAME$1]&&global$e[COLLECTION_NAME$1].prototype,COLLECTION_NAME$1);handlePrototype$1(DOMTokenListPrototype$1,"DOMTokenList");var $$D=_export,$includes=arrayIncludes.includes,fails$n=fails$I,addToUnscopables$3=addToUnscopables$5,BROKEN_ON_SPARSE=fails$n(function(){return!Array(1).includes()});$$D({target:"Array",proto:!0,forced:BROKEN_ON_SPARSE},{includes:function(t){return $includes(this,t,arguments.length>1?arguments[1]:void 0)}});addToUnscopables$3("includes");var tryToString$1=tryToString$6,$TypeError$8=TypeError,deletePropertyOrThrow$2=function(e,t){if(!delete e[t])throw $TypeError$8("Cannot delete property "+tryToString$1(t)+" of "+tryToString$1(e))},arraySlice$4=arraySliceSimple,floor$3=Math.floor,mergeSort=function(e,t){var r=e.length,n=floor$3(r/2);return r<8?insertionSort(e,t):merge(e,mergeSort(arraySlice$4(e,0,n),t),mergeSort(arraySlice$4(e,n),t),t)},insertionSort=function(e,t){for(var r=e.length,n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}return e},merge=function(e,t,r,n){for(var o=t.length,i=r.length,a=0,s=0;a<o||s<i;)e[a+s]=a<o&&s<i?n(t[a],r[s])<=0?t[a++]:r[s++]:a<o?t[a++]:r[s++];return e},arraySort=mergeSort,fails$m=fails$I,arrayMethodIsStrict$6=function(e,t){var r=[][e];return!!r&&fails$m(function(){r.call(null,t||function(){return 1},1)})},userAgent$3=engineUserAgent,firefox=userAgent$3.match(/firefox\/(\d+)/i),engineFfVersion=!!firefox&&+firefox[1],UA=engineUserAgent,engineIsIeOrEdge=/MSIE|Trident/.test(UA),userAgent$2=engineUserAgent,webkit=userAgent$2.match(/AppleWebKit\/(\d+)\./),engineWebkitVersion=!!webkit&&+webkit[1],$$C=_export,uncurryThis$n=functionUncurryThis,aCallable$2=aCallable$7,toObject$a=toObject$f,lengthOfArrayLike$7=lengthOfArrayLike$c,deletePropertyOrThrow$1=deletePropertyOrThrow$2,toString$e=toString$l,fails$l=fails$I,internalSort=arraySort,arrayMethodIsStrict$5=arrayMethodIsStrict$6,FF=engineFfVersion,IE_OR_EDGE=engineIsIeOrEdge,V8=engineV8Version,WEBKIT=engineWebkitVersion,test$1=[],nativeSort=uncurryThis$n(test$1.sort),push$4=uncurryThis$n(test$1.push),FAILS_ON_UNDEFINED=fails$l(function(){test$1.sort(void 0)}),FAILS_ON_NULL=fails$l(function(){test$1.sort(null)}),STRICT_METHOD$2=arrayMethodIsStrict$5("sort"),STABLE_SORT=!fails$l(function(){if(V8)return V8<70;if(!(FF&&FF>3)){if(IE_OR_EDGE)return!0;if(WEBKIT)return WEBKIT<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)test$1.push({k:r+o,v:n})}for(test$1.sort(function(i,a){return a.v-i.v}),o=0;o<test$1.length;o++)r=test$1[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),FORCED$9=FAILS_ON_UNDEFINED||!FAILS_ON_NULL||!STRICT_METHOD$2||!STABLE_SORT,getSortCompare=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:toString$e(t)>toString$e(r)?1:-1}};$$C({target:"Array",proto:!0,forced:FORCED$9},{sort:function(t){t!==void 0&&aCallable$2(t);var r=toObject$a(this);if(STABLE_SORT)return t===void 0?nativeSort(r):nativeSort(r,t);var n=[],o=lengthOfArrayLike$7(r),i,a;for(a=0;a<o;a++)a in r&&push$4(n,r[a]);for(internalSort(n,getSortCompare(t)),i=lengthOfArrayLike$7(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)deletePropertyOrThrow$1(r,a++);return r}});var DESCRIPTORS$6=descriptors,isArray$5=isArray$8,$TypeError$7=TypeError,getOwnPropertyDescriptor$4=Object.getOwnPropertyDescriptor,SILENT_ON_NON_WRITABLE_LENGTH_SET=DESCRIPTORS$6&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),arraySetLength=SILENT_ON_NON_WRITABLE_LENGTH_SET?function(e,t){if(isArray$5(e)&&!getOwnPropertyDescriptor$4(e,"length").writable)throw $TypeError$7("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},$TypeError$6=TypeError,MAX_SAFE_INTEGER=9007199254740991,doesNotExceedSafeInteger$2=function(e){if(e>MAX_SAFE_INTEGER)throw $TypeError$6("Maximum allowed index exceeded");return e},fails$k=fails$I,wellKnownSymbol$9=wellKnownSymbol$q,V8_VERSION$1=engineV8Version,SPECIES$3=wellKnownSymbol$9("species"),arrayMethodHasSpeciesSupport$5=function(e){return V8_VERSION$1>=51||!fails$k(function(){var t=[],r=t.constructor={};return r[SPECIES$3]=function(){return{foo:1}},t[e](Boolean).foo!==1})},$$B=_export,toObject$9=toObject$f,toAbsoluteIndex$2=toAbsoluteIndex$5,toIntegerOrInfinity$4=toIntegerOrInfinity$8,lengthOfArrayLike$6=lengthOfArrayLike$c,setArrayLength=arraySetLength,doesNotExceedSafeInteger$1=doesNotExceedSafeInteger$2,arraySpeciesCreate$1=arraySpeciesCreate$3,createProperty$4=createProperty$6,deletePropertyOrThrow=deletePropertyOrThrow$2,arrayMethodHasSpeciesSupport$4=arrayMethodHasSpeciesSupport$5,HAS_SPECIES_SUPPORT$3=arrayMethodHasSpeciesSupport$4("splice"),max$3=Math.max,min$6=Math.min;$$B({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$3},{splice:function(t,r){var n=toObject$9(this),o=lengthOfArrayLike$6(n),i=toAbsoluteIndex$2(t,o),a=arguments.length,s,l,u,c,f,d;for(a===0?s=l=0:a===1?(s=0,l=o-i):(s=a-2,l=min$6(max$3(toIntegerOrInfinity$4(r),0),o-i)),doesNotExceedSafeInteger$1(o+s-l),u=arraySpeciesCreate$1(n,l),c=0;c<l;c++)f=i+c,f in n&&createProperty$4(u,c,n[f]);if(u.length=l,s<l){for(c=i;c<o-l;c++)f=c+l,d=c+s,f in n?n[d]=n[f]:deletePropertyOrThrow(n,d);for(c=o;c>o-l+s;c--)deletePropertyOrThrow(n,c-1)}else if(s>l)for(c=o-l;c>i;c--)f=c+l-1,d=c+s-1,f in n?n[d]=n[f]:deletePropertyOrThrow(n,d);for(c=0;c<s;c++)n[c+i]=arguments[c+2];return setArrayLength(n,o-l+s),u}});var isObject$a=isObject$n,floor$2=Math.floor,isIntegralNumber$1=Number.isInteger||function(t){return!isObject$a(t)&&isFinite(t)&&floor$2(t)===t},$$A=_export,isIntegralNumber=isIntegralNumber$1;$$A({target:"Number",stat:!0},{isInteger:isIntegralNumber});var uncurryThis$m=functionUncurryThis,thisNumberValue$2=uncurryThis$m(1 .valueOf),whitespaces$2=`	
\v\f\r                　\u2028\u2029\uFEFF`,uncurryThis$l=functionUncurryThis,requireObjectCoercible$a=requireObjectCoercible$e,toString$d=toString$l,whitespaces$1=whitespaces$2,replace$4=uncurryThis$l("".replace),ltrim=RegExp("^["+whitespaces$1+"]+"),rtrim=RegExp("(^|[^"+whitespaces$1+"])["+whitespaces$1+"]+$"),createMethod$3=function(e){return function(t){var r=toString$d(requireObjectCoercible$a(t));return e&1&&(r=replace$4(r,ltrim,"")),e&2&&(r=replace$4(r,rtrim,"$1")),r}},stringTrim$1={start:createMethod$3(1),end:createMethod$3(2),trim:createMethod$3(3)},$$z=_export,IS_PURE=isPure,DESCRIPTORS$5=descriptors,global$d=global$s,path=path$2,uncurryThis$k=functionUncurryThis,isForced$1=isForced_1,hasOwn$7=hasOwnProperty_1,inheritIfRequired$1=inheritIfRequired$3,isPrototypeOf$2=objectIsPrototypeOf,isSymbol=isSymbol$5,toPrimitive=toPrimitive$2,fails$j=fails$I,getOwnPropertyNames$1=objectGetOwnPropertyNames.f,getOwnPropertyDescriptor$3=objectGetOwnPropertyDescriptor.f,defineProperty$2=objectDefineProperty.f,thisNumberValue$1=thisNumberValue$2,trim=stringTrim$1.trim,NUMBER="Number",NativeNumber=global$d[NUMBER];path[NUMBER];var NumberPrototype=NativeNumber.prototype,TypeError$1=global$d.TypeError,stringSlice$8=uncurryThis$k("".slice),charCodeAt=uncurryThis$k("".charCodeAt),toNumeric=function(e){var t=toPrimitive(e,"number");return typeof t=="bigint"?t:toNumber(t)},toNumber=function(e){var t=toPrimitive(e,"number"),r,n,o,i,a,s,l,u;if(isSymbol(t))throw TypeError$1("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=trim(t),r=charCodeAt(t,0),r===43||r===45){if(n=charCodeAt(t,2),n===88||n===120)return NaN}else if(r===48){switch(charCodeAt(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=stringSlice$8(t,2),s=a.length,l=0;l<s;l++)if(u=charCodeAt(a,l),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},FORCED$8=isForced$1(NUMBER,!NativeNumber(" 0o1")||!NativeNumber("0b1")||NativeNumber("+0x1")),calledWithNew=function(e){return isPrototypeOf$2(NumberPrototype,e)&&fails$j(function(){thisNumberValue$1(e)})},NumberWrapper=function(t){var r=arguments.length<1?0:NativeNumber(toNumeric(t));return calledWithNew(this)?inheritIfRequired$1(Object(r),this,NumberWrapper):r};NumberWrapper.prototype=NumberPrototype;FORCED$8&&!IS_PURE&&(NumberPrototype.constructor=NumberWrapper);$$z({global:!0,constructor:!0,wrap:!0,forced:FORCED$8},{Number:NumberWrapper});var copyConstructorProperties=function(e,t){for(var r=DESCRIPTORS$5?getOwnPropertyNames$1(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)hasOwn$7(t,o=r[n])&&!hasOwn$7(e,o)&&defineProperty$2(e,o,getOwnPropertyDescriptor$3(t,o))};(FORCED$8||IS_PURE)&&copyConstructorProperties(path[NUMBER],NativeNumber);var $$y=_export,isArray$4=isArray$8,isConstructor$2=isConstructor$4,isObject$9=isObject$n,toAbsoluteIndex$1=toAbsoluteIndex$5,lengthOfArrayLike$5=lengthOfArrayLike$c,toIndexedObject$5=toIndexedObject$d,createProperty$3=createProperty$6,wellKnownSymbol$8=wellKnownSymbol$q,arrayMethodHasSpeciesSupport$3=arrayMethodHasSpeciesSupport$5,nativeSlice=arraySlice$6,HAS_SPECIES_SUPPORT$2=arrayMethodHasSpeciesSupport$3("slice"),SPECIES$2=wellKnownSymbol$8("species"),$Array$1=Array,max$2=Math.max;$$y({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$2},{slice:function(t,r){var n=toIndexedObject$5(this),o=lengthOfArrayLike$5(n),i=toAbsoluteIndex$1(t,o),a=toAbsoluteIndex$1(r===void 0?o:r,o),s,l,u;if(isArray$4(n)&&(s=n.constructor,isConstructor$2(s)&&(s===$Array$1||isArray$4(s.prototype))?s=void 0:isObject$9(s)&&(s=s[SPECIES$2],s===null&&(s=void 0)),s===$Array$1||s===void 0))return nativeSlice(n,i,a);for(l=new(s===void 0?$Array$1:s)(max$2(a-i,0)),u=0;i<a;i++,u++)i in n&&createProperty$3(l,u,n[i]);return l.length=u,l}});var $$x=_export,fails$i=fails$I,isArray$3=isArray$8,isObject$8=isObject$n,toObject$8=toObject$f,lengthOfArrayLike$4=lengthOfArrayLike$c,doesNotExceedSafeInteger=doesNotExceedSafeInteger$2,createProperty$2=createProperty$6,arraySpeciesCreate=arraySpeciesCreate$3,arrayMethodHasSpeciesSupport$2=arrayMethodHasSpeciesSupport$5,wellKnownSymbol$7=wellKnownSymbol$q,V8_VERSION=engineV8Version,IS_CONCAT_SPREADABLE=wellKnownSymbol$7("isConcatSpreadable"),IS_CONCAT_SPREADABLE_SUPPORT=V8_VERSION>=51||!fails$i(function(){var e=[];return e[IS_CONCAT_SPREADABLE]=!1,e.concat()[0]!==e}),isConcatSpreadable=function(e){if(!isObject$8(e))return!1;var t=e[IS_CONCAT_SPREADABLE];return t!==void 0?!!t:isArray$3(e)},FORCED$7=!IS_CONCAT_SPREADABLE_SUPPORT||!arrayMethodHasSpeciesSupport$2("concat");$$x({target:"Array",proto:!0,arity:1,forced:FORCED$7},{concat:function(t){var r=toObject$8(this),n=arraySpeciesCreate(r,0),o=0,i,a,s,l,u;for(i=-1,s=arguments.length;i<s;i++)if(u=i===-1?r:arguments[i],isConcatSpreadable(u))for(l=lengthOfArrayLike$4(u),doesNotExceedSafeInteger(o+l),a=0;a<l;a++,o++)a in u&&createProperty$2(n,o,u[a]);else doesNotExceedSafeInteger(o+1),createProperty$2(n,o++,u);return n.length=o,n}});var toObject$7=toObject$f,toAbsoluteIndex=toAbsoluteIndex$5,lengthOfArrayLike$3=lengthOfArrayLike$c,arrayFill=function(t){for(var r=toObject$7(this),n=lengthOfArrayLike$3(r),o=arguments.length,i=toAbsoluteIndex(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,s=a===void 0?n:toAbsoluteIndex(a,n);s>i;)r[i++]=t;return r},$$w=_export,fill=arrayFill,addToUnscopables$2=addToUnscopables$5;$$w({target:"Array",proto:!0},{fill});addToUnscopables$2("fill");var $$v=_export,$map=arrayIteration.map,arrayMethodHasSpeciesSupport$1=arrayMethodHasSpeciesSupport$5,HAS_SPECIES_SUPPORT$1=arrayMethodHasSpeciesSupport$1("map");$$v({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$1},{map:function(t){return $map(this,t,arguments.length>1?arguments[1]:void 0)}});var anObject$c=anObject$m,regexpFlags$1=function(){var e=anObject$c(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},fails$h=fails$I,global$c=global$s,$RegExp$2=global$c.RegExp,UNSUPPORTED_Y$3=fails$h(function(){var e=$RegExp$2("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),MISSED_STICKY$1=UNSUPPORTED_Y$3||fails$h(function(){return!$RegExp$2("a","y").sticky}),BROKEN_CARET=UNSUPPORTED_Y$3||fails$h(function(){var e=$RegExp$2("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),regexpStickyHelpers={BROKEN_CARET,MISSED_STICKY:MISSED_STICKY$1,UNSUPPORTED_Y:UNSUPPORTED_Y$3},fails$g=fails$I,global$b=global$s,$RegExp$1=global$b.RegExp,regexpUnsupportedDotAll=fails$g(function(){var e=$RegExp$1(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),fails$f=fails$I,global$a=global$s,$RegExp=global$a.RegExp,regexpUnsupportedNcg=fails$f(function(){var e=$RegExp("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),call$9=functionCall,uncurryThis$j=functionUncurryThis,toString$c=toString$l,regexpFlags=regexpFlags$1,stickyHelpers$2=regexpStickyHelpers,shared=sharedExports,create$2=objectCreate,getInternalState=internalState.get,UNSUPPORTED_DOT_ALL$1=regexpUnsupportedDotAll,UNSUPPORTED_NCG$1=regexpUnsupportedNcg,nativeReplace=shared("native-string-replace",String.prototype.replace),nativeExec=RegExp.prototype.exec,patchedExec=nativeExec,charAt$3=uncurryThis$j("".charAt),indexOf$1=uncurryThis$j("".indexOf),replace$3=uncurryThis$j("".replace),stringSlice$7=uncurryThis$j("".slice),UPDATES_LAST_INDEX_WRONG=function(){var e=/a/,t=/b*/g;return call$9(nativeExec,e,"a"),call$9(nativeExec,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),UNSUPPORTED_Y$2=stickyHelpers$2.BROKEN_CARET,NPCG_INCLUDED=/()??/.exec("")[1]!==void 0,PATCH=UPDATES_LAST_INDEX_WRONG||NPCG_INCLUDED||UNSUPPORTED_Y$2||UNSUPPORTED_DOT_ALL$1||UNSUPPORTED_NCG$1;PATCH&&(patchedExec=function(t){var r=this,n=getInternalState(r),o=toString$c(t),i=n.raw,a,s,l,u,c,f,d;if(i)return i.lastIndex=r.lastIndex,a=call$9(patchedExec,i,o),r.lastIndex=i.lastIndex,a;var h=n.groups,y=UNSUPPORTED_Y$2&&r.sticky,p=call$9(regexpFlags,r),v=r.source,b=0,S=o;if(y&&(p=replace$3(p,"y",""),indexOf$1(p,"g")===-1&&(p+="g"),S=stringSlice$7(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&charAt$3(o,r.lastIndex-1)!==`
`)&&(v="(?: "+v+")",S=" "+S,b++),s=new RegExp("^(?:"+v+")",p)),NPCG_INCLUDED&&(s=new RegExp("^"+v+"$(?!\\s)",p)),UPDATES_LAST_INDEX_WRONG&&(l=r.lastIndex),u=call$9(nativeExec,y?s:r,S),y?u?(u.input=stringSlice$7(u.input,b),u[0]=stringSlice$7(u[0],b),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:UPDATES_LAST_INDEX_WRONG&&u&&(r.lastIndex=r.global?u.index+u[0].length:l),NPCG_INCLUDED&&u&&u.length>1&&call$9(nativeReplace,u[0],s,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(u[c]=void 0)}),u&&h)for(u.groups=f=create$2(null),c=0;c<h.length;c++)d=h[c],f[d[0]]=u[d[1]];return u});var regexpExec$3=patchedExec,$$u=_export,exec$2=regexpExec$3;$$u({target:"RegExp",proto:!0,forced:/./.exec!==exec$2},{exec:exec$2});var uncurryThis$i=functionUncurryThisClause,defineBuiltIn$3=defineBuiltIn$c,regexpExec$2=regexpExec$3,fails$e=fails$I,wellKnownSymbol$6=wellKnownSymbol$q,createNonEnumerableProperty$2=createNonEnumerableProperty$7,SPECIES$1=wellKnownSymbol$6("species"),RegExpPrototype$3=RegExp.prototype,fixRegexpWellKnownSymbolLogic=function(e,t,r,n){var o=wellKnownSymbol$6(e),i=!fails$e(function(){var u={};return u[o]=function(){return 7},""[e](u)!=7}),a=i&&!fails$e(function(){var u=!1,c=/a/;return e==="split"&&(c={},c.constructor={},c.constructor[SPECIES$1]=function(){return c},c.flags="",c[o]=/./[o]),c.exec=function(){return u=!0,null},c[o](""),!u});if(!i||!a||r){var s=uncurryThis$i(/./[o]),l=t(o,""[e],function(u,c,f,d,h){var y=uncurryThis$i(u),p=c.exec;return p===regexpExec$2||p===RegExpPrototype$3.exec?i&&!h?{done:!0,value:s(c,f,d)}:{done:!0,value:y(f,c,d)}:{done:!1}});defineBuiltIn$3(String.prototype,e,l[0]),defineBuiltIn$3(RegExpPrototype$3,o,l[1])}n&&createNonEnumerableProperty$2(RegExpPrototype$3[o],"sham",!0)},charAt$2=stringMultibyte.charAt,advanceStringIndex$3=function(e,t,r){return t+(r?charAt$2(e,t).length:1)},uncurryThis$h=functionUncurryThis,toObject$6=toObject$f,floor$1=Math.floor,charAt$1=uncurryThis$h("".charAt),replace$2=uncurryThis$h("".replace),stringSlice$6=uncurryThis$h("".slice),SUBSTITUTION_SYMBOLS=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,SUBSTITUTION_SYMBOLS_NO_NAMED=/\$([$&'`]|\d{1,2})/g,getSubstitution$1=function(e,t,r,n,o,i){var a=r+e.length,s=n.length,l=SUBSTITUTION_SYMBOLS_NO_NAMED;return o!==void 0&&(o=toObject$6(o),l=SUBSTITUTION_SYMBOLS),replace$2(i,l,function(u,c){var f;switch(charAt$1(c,0)){case"$":return"$";case"&":return e;case"`":return stringSlice$6(t,0,r);case"'":return stringSlice$6(t,a);case"<":f=o[stringSlice$6(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>s){var h=floor$1(d/10);return h===0?u:h<=s?n[h-1]===void 0?charAt$1(c,1):n[h-1]+charAt$1(c,1):u}f=n[d-1]}return f===void 0?"":f})},call$8=functionCall,anObject$b=anObject$m,isCallable$3=isCallable$p,classof$2=classofRaw$2,regexpExec$1=regexpExec$3,$TypeError$5=TypeError,regexpExecAbstract=function(e,t){var r=e.exec;if(isCallable$3(r)){var n=call$8(r,e,t);return n!==null&&anObject$b(n),n}if(classof$2(e)==="RegExp")return call$8(regexpExec$1,e,t);throw $TypeError$5("RegExp#exec called on incompatible receiver")},apply$6=functionApply,call$7=functionCall,uncurryThis$g=functionUncurryThis,fixRegExpWellKnownSymbolLogic$3=fixRegexpWellKnownSymbolLogic,fails$d=fails$I,anObject$a=anObject$m,isCallable$2=isCallable$p,isNullOrUndefined$5=isNullOrUndefined$b,toIntegerOrInfinity$3=toIntegerOrInfinity$8,toLength$5=toLength$7,toString$b=toString$l,requireObjectCoercible$9=requireObjectCoercible$e,advanceStringIndex$2=advanceStringIndex$3,getMethod$3=getMethod$7,getSubstitution=getSubstitution$1,regExpExec$2=regexpExecAbstract,wellKnownSymbol$5=wellKnownSymbol$q,REPLACE=wellKnownSymbol$5("replace"),max$1=Math.max,min$5=Math.min,concat$2=uncurryThis$g([].concat),push$3=uncurryThis$g([].push),stringIndexOf$3=uncurryThis$g("".indexOf),stringSlice$5=uncurryThis$g("".slice),maybeToString=function(e){return e===void 0?e:String(e)},REPLACE_KEEPS_$0=function(){return"a".replace(/./,"$0")==="$0"}(),REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE=function(){return/./[REPLACE]?/./[REPLACE]("a","$0")==="":!1}(),REPLACE_SUPPORTS_NAMED_GROUPS=!fails$d(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});fixRegExpWellKnownSymbolLogic$3("replace",function(e,t,r){var n=REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE?"$":"$0";return[function(i,a){var s=requireObjectCoercible$9(this),l=isNullOrUndefined$5(i)?void 0:getMethod$3(i,REPLACE);return l?call$7(l,i,s,a):call$7(t,toString$b(s),i,a)},function(o,i){var a=anObject$a(this),s=toString$b(o);if(typeof i=="string"&&stringIndexOf$3(i,n)===-1&&stringIndexOf$3(i,"$<")===-1){var l=r(t,a,s,i);if(l.done)return l.value}var u=isCallable$2(i);u||(i=toString$b(i));var c=a.global;if(c){var f=a.unicode;a.lastIndex=0}for(var d=[];;){var h=regExpExec$2(a,s);if(h===null||(push$3(d,h),!c))break;var y=toString$b(h[0]);y===""&&(a.lastIndex=advanceStringIndex$2(s,toLength$5(a.lastIndex),f))}for(var p="",v=0,b=0;b<d.length;b++){h=d[b];for(var S=toString$b(h[0]),w=max$1(min$5(toIntegerOrInfinity$3(h.index),s.length),0),P=[],E=1;E<h.length;E++)push$3(P,maybeToString(h[E]));var j=h.groups;if(u){var G=concat$2([S],P,w,s);j!==void 0&&push$3(G,j);var q=toString$b(apply$6(i,void 0,G))}else q=getSubstitution(S,s,w,P,j,i);w>=v&&(p+=stringSlice$5(s,v,w)+q,v=w+S.length)}return p+stringSlice$5(s,v)}]},!REPLACE_SUPPORTS_NAMED_GROUPS||!REPLACE_KEEPS_$0||REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE);var anObject$9=anObject$m,iteratorClose=iteratorClose$2,callWithSafeIterationClosing$1=function(e,t,r,n){try{return n?t(anObject$9(r)[0],r[1]):t(r)}catch(o){iteratorClose(e,"throw",o)}},bind$2=functionBindContext,call$6=functionCall,toObject$5=toObject$f,callWithSafeIterationClosing=callWithSafeIterationClosing$1,isArrayIteratorMethod=isArrayIteratorMethod$2,isConstructor$1=isConstructor$4,lengthOfArrayLike$2=lengthOfArrayLike$c,createProperty$1=createProperty$6,getIterator=getIterator$2,getIteratorMethod=getIteratorMethod$3,$Array=Array,arrayFrom=function(t){var r=toObject$5(t),n=isConstructor$1(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=bind$2(i,o>2?arguments[2]:void 0));var s=getIteratorMethod(r),l=0,u,c,f,d,h,y;if(s&&!(this===$Array&&isArrayIteratorMethod(s)))for(d=getIterator(r,s),h=d.next,c=n?new this:[];!(f=call$6(h,d)).done;l++)y=a?callWithSafeIterationClosing(d,i,[f.value,l],!0):f.value,createProperty$1(c,l,y);else for(u=lengthOfArrayLike$2(r),c=n?new this(u):$Array(u);u>l;l++)y=a?i(r[l],l):r[l],createProperty$1(c,l,y);return c.length=l,c},$$t=_export,from$1=arrayFrom,checkCorrectnessOfIteration=checkCorrectnessOfIteration$2,INCORRECT_ITERATION=!checkCorrectnessOfIteration(function(e){Array.from(e)});$$t({target:"Array",stat:!0,forced:INCORRECT_ITERATION},{from:from$1});var $$s=_export,uncurryThis$f=functionUncurryThisClause,$indexOf=arrayIncludes.indexOf,arrayMethodIsStrict$4=arrayMethodIsStrict$6,nativeIndexOf=uncurryThis$f([].indexOf),NEGATIVE_ZERO$1=!!nativeIndexOf&&1/nativeIndexOf([1],1,-0)<0,FORCED$6=NEGATIVE_ZERO$1||!arrayMethodIsStrict$4("indexOf");$$s({target:"Array",proto:!0,forced:FORCED$6},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return NEGATIVE_ZERO$1?nativeIndexOf(this,t,r)||0:$indexOf(this,t,r)}});var $$r=_export,uncurryThis$e=functionUncurryThis,isArray$2=isArray$8,nativeReverse=uncurryThis$e([].reverse),test=[1,2];$$r({target:"Array",proto:!0,forced:String(test)===String(test.reverse())},{reverse:function(){return isArray$2(this)&&(this.length=this.length),nativeReverse(this)}});var $forEach=arrayIteration.forEach,arrayMethodIsStrict$3=arrayMethodIsStrict$6,STRICT_METHOD$1=arrayMethodIsStrict$3("forEach"),arrayForEach$1=STRICT_METHOD$1?[].forEach:function(t){return $forEach(this,t,arguments.length>1?arguments[1]:void 0)},global$9=global$s,DOMIterables=domIterables,DOMTokenListPrototype=domTokenListPrototype,forEach=arrayForEach$1,createNonEnumerableProperty$1=createNonEnumerableProperty$7,handlePrototype=function(e){if(e&&e.forEach!==forEach)try{createNonEnumerableProperty$1(e,"forEach",forEach)}catch{e.forEach=forEach}};for(var COLLECTION_NAME in DOMIterables)DOMIterables[COLLECTION_NAME]&&handlePrototype(global$9[COLLECTION_NAME]&&global$9[COLLECTION_NAME].prototype);handlePrototype(DOMTokenListPrototype);var engineIsBun=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",$TypeError$4=TypeError,validateArgumentsLength$2=function(e,t){if(e<t)throw $TypeError$4("Not enough arguments");return e},global$8=global$s,apply$5=functionApply,isCallable$1=isCallable$p,ENGINE_IS_BUN=engineIsBun,USER_AGENT=engineUserAgent,arraySlice$3=arraySlice$6,validateArgumentsLength$1=validateArgumentsLength$2,Function$2=global$8.Function,WRAP=/MSIE .\./.test(USER_AGENT)||ENGINE_IS_BUN&&function(){var e=global$8.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),schedulersFix$3=function(e,t){var r=t?2:1;return WRAP?function(n,o){var i=validateArgumentsLength$1(arguments.length,1)>r,a=isCallable$1(n)?n:Function$2(n),s=i?arraySlice$3(arguments,r):[],l=i?function(){apply$5(a,this,s)}:a;return t?e(l,o):e(l)}:e},$$q=_export,global$7=global$s,schedulersFix$2=schedulersFix$3,setInterval=schedulersFix$2(global$7.setInterval,!0);$$q({global:!0,bind:!0,forced:global$7.setInterval!==setInterval},{setInterval});var $$p=_export,global$6=global$s,schedulersFix$1=schedulersFix$3,setTimeout$1=schedulersFix$1(global$6.setTimeout,!0);$$p({global:!0,bind:!0,forced:global$6.setTimeout!==setTimeout$1},{setTimeout:setTimeout$1});var userAgent$1=engineUserAgent,engineIsIos=/(?:ipad|iphone|ipod).*applewebkit/i.test(userAgent$1),classof$1=classofRaw$2,engineIsNode=typeof process<"u"&&classof$1(process)=="process",global$5=global$s,apply$4=functionApply,bind$1=functionBindContext,isCallable=isCallable$p,hasOwn$6=hasOwnProperty_1,fails$c=fails$I,html$2=html$4,arraySlice$2=arraySlice$6,createElement$1=documentCreateElement$2,validateArgumentsLength=validateArgumentsLength$2,IS_IOS=engineIsIos,IS_NODE$1=engineIsNode,set$2=global$5.setImmediate,clear=global$5.clearImmediate,process$2=global$5.process,Dispatch=global$5.Dispatch,Function$1=global$5.Function,MessageChannel=global$5.MessageChannel,String$1=global$5.String,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",$location,defer,channel,port;fails$c(function(){$location=global$5.location});var run=function(e){if(hasOwn$6(queue,e)){var t=queue[e];delete queue[e],t()}},runner=function(e){return function(){run(e)}},eventListener=function(e){run(e.data)},globalPostMessageDefer=function(e){global$5.postMessage(String$1(e),$location.protocol+"//"+$location.host)};(!set$2||!clear)&&(set$2=function(t){validateArgumentsLength(arguments.length,1);var r=isCallable(t)?t:Function$1(t),n=arraySlice$2(arguments,1);return queue[++counter]=function(){apply$4(r,void 0,n)},defer(counter),counter},clear=function(t){delete queue[t]},IS_NODE$1?defer=function(e){process$2.nextTick(runner(e))}:Dispatch&&Dispatch.now?defer=function(e){Dispatch.now(runner(e))}:MessageChannel&&!IS_IOS?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=eventListener,defer=bind$1(port.postMessage,port)):global$5.addEventListener&&isCallable(global$5.postMessage)&&!global$5.importScripts&&$location&&$location.protocol!=="file:"&&!fails$c(globalPostMessageDefer)?(defer=globalPostMessageDefer,global$5.addEventListener("message",eventListener,!1)):ONREADYSTATECHANGE in createElement$1("script")?defer=function(e){html$2.appendChild(createElement$1("script"))[ONREADYSTATECHANGE]=function(){html$2.removeChild(this),run(e)}}:defer=function(e){setTimeout(runner(e),0)});var task={set:set$2,clear},$$o=_export,global$4=global$s,clearImmediate$1=task.clear;$$o({global:!0,bind:!0,enumerable:!0,forced:global$4.clearImmediate!==clearImmediate$1},{clearImmediate:clearImmediate$1});var $$n=_export,global$3=global$s,setTask=task.set,schedulersFix=schedulersFix$3,setImmediate$1=global$3.setImmediate?schedulersFix(setTask,!1):setTask;$$n({global:!0,bind:!0,enumerable:!0,forced:global$3.setImmediate!==setImmediate$1},{setImmediate:setImmediate$1});var collection$3=collection$5,collectionStrong=collectionStrong$2;collection$3("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},collectionStrong);var $$m=_export,fails$b=fails$I,toObject$4=toObject$f,nativeGetPrototypeOf=objectGetPrototypeOf,CORRECT_PROTOTYPE_GETTER=correctPrototypeGetter,FAILS_ON_PRIMITIVES$1=fails$b(function(){nativeGetPrototypeOf(1)});$$m({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES$1,sham:!CORRECT_PROTOTYPE_GETTER},{getPrototypeOf:function(t){return nativeGetPrototypeOf(toObject$4(t))}});var isObject$7=isObject$n,classof=classofRaw$2,wellKnownSymbol$4=wellKnownSymbol$q,MATCH$2=wellKnownSymbol$4("match"),isRegexp=function(e){var t;return isObject$7(e)&&((t=e[MATCH$2])!==void 0?!!t:classof(e)=="RegExp")},isRegExp$3=isRegexp,$TypeError$3=TypeError,notARegexp=function(e){if(isRegExp$3(e))throw $TypeError$3("The method doesn't accept regular expressions");return e},wellKnownSymbol$3=wellKnownSymbol$q,MATCH$1=wellKnownSymbol$3("match"),correctIsRegexpLogic=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[MATCH$1]=!1,"/./"[e](t)}catch{}}return!1},$$l=_export,uncurryThis$d=functionUncurryThis,notARegExp$2=notARegexp,requireObjectCoercible$8=requireObjectCoercible$e,toString$a=toString$l,correctIsRegExpLogic$2=correctIsRegexpLogic,stringIndexOf$2=uncurryThis$d("".indexOf);$$l({target:"String",proto:!0,forced:!correctIsRegExpLogic$2("includes")},{includes:function(t){return!!~stringIndexOf$2(toString$a(requireObjectCoercible$8(this)),toString$a(notARegExp$2(t)),arguments.length>1?arguments[1]:void 0)}});var $$k=_export,$filter=arrayIteration.filter,arrayMethodHasSpeciesSupport=arrayMethodHasSpeciesSupport$5,HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("filter");$$k({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT},{filter:function(t){return $filter(this,t,arguments.length>1?arguments[1]:void 0)}});var call$5=functionCall,hasOwn$5=hasOwnProperty_1,isPrototypeOf$1=objectIsPrototypeOf,regExpFlags=regexpFlags$1,RegExpPrototype$2=RegExp.prototype,regexpGetFlags=function(e){var t=e.flags;return t===void 0&&!("flags"in RegExpPrototype$2)&&!hasOwn$5(e,"flags")&&isPrototypeOf$1(RegExpPrototype$2,e)?call$5(regExpFlags,e):t},defineProperty$1=objectDefineProperty.f,proxyAccessor$1=function(e,t,r){r in e||defineProperty$1(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},DESCRIPTORS$4=descriptors,global$2=global$s,uncurryThis$c=functionUncurryThis,isForced=isForced_1,inheritIfRequired=inheritIfRequired$3,createNonEnumerableProperty=createNonEnumerableProperty$7,getOwnPropertyNames=objectGetOwnPropertyNames.f,isPrototypeOf=objectIsPrototypeOf,isRegExp$2=isRegexp,toString$9=toString$l,getRegExpFlags$1=regexpGetFlags,stickyHelpers$1=regexpStickyHelpers,proxyAccessor=proxyAccessor$1,defineBuiltIn$2=defineBuiltIn$c,fails$a=fails$I,hasOwn$4=hasOwnProperty_1,enforceInternalState$1=internalState.enforce,setSpecies=setSpecies$2,wellKnownSymbol$2=wellKnownSymbol$q,UNSUPPORTED_DOT_ALL=regexpUnsupportedDotAll,UNSUPPORTED_NCG=regexpUnsupportedNcg,MATCH=wellKnownSymbol$2("match"),NativeRegExp=global$2.RegExp,RegExpPrototype$1=NativeRegExp.prototype,SyntaxError=global$2.SyntaxError,exec$1=uncurryThis$c(RegExpPrototype$1.exec),charAt=uncurryThis$c("".charAt),replace$1=uncurryThis$c("".replace),stringIndexOf$1=uncurryThis$c("".indexOf),stringSlice$4=uncurryThis$c("".slice),IS_NCG=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,re1=/a/g,re2=/a/g,CORRECT_NEW=new NativeRegExp(re1)!==re1,MISSED_STICKY=stickyHelpers$1.MISSED_STICKY,UNSUPPORTED_Y$1=stickyHelpers$1.UNSUPPORTED_Y,BASE_FORCED=DESCRIPTORS$4&&(!CORRECT_NEW||MISSED_STICKY||UNSUPPORTED_DOT_ALL||UNSUPPORTED_NCG||fails$a(function(){return re2[MATCH]=!1,NativeRegExp(re1)!=re1||NativeRegExp(re2)==re2||NativeRegExp(re1,"i")!="/a/i"})),handleDotAll=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=charAt(e,r),i==="\\"){n+=i+charAt(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},handleNCG=function(e){for(var t=e.length,r=0,n="",o=[],i={},a=!1,s=!1,l=0,u="",c;r<=t;r++){if(c=charAt(e,r),c==="\\")c=c+charAt(e,++r);else if(c==="]")a=!1;else if(!a)switch(!0){case c==="[":a=!0;break;case c==="(":exec$1(IS_NCG,stringSlice$4(e,r+1))&&(r+=2,s=!0),n+=c,l++;continue;case(c===">"&&s):if(u===""||hasOwn$4(i,u))throw new SyntaxError("Invalid capture group name");i[u]=!0,o[o.length]=[u,l],s=!1,u="";continue}s?u+=c:n+=c}return[n,o]};if(isForced("RegExp",BASE_FORCED)){for(var RegExpWrapper=function(t,r){var n=isPrototypeOf(RegExpPrototype$1,this),o=isRegExp$2(t),i=r===void 0,a=[],s=t,l,u,c,f,d,h;if(!n&&o&&i&&t.constructor===RegExpWrapper)return t;if((o||isPrototypeOf(RegExpPrototype$1,t))&&(t=t.source,i&&(r=getRegExpFlags$1(s))),t=t===void 0?"":toString$9(t),r=r===void 0?"":toString$9(r),s=t,UNSUPPORTED_DOT_ALL&&"dotAll"in re1&&(u=!!r&&stringIndexOf$1(r,"s")>-1,u&&(r=replace$1(r,/s/g,""))),l=r,MISSED_STICKY&&"sticky"in re1&&(c=!!r&&stringIndexOf$1(r,"y")>-1,c&&UNSUPPORTED_Y$1&&(r=replace$1(r,/y/g,""))),UNSUPPORTED_NCG&&(f=handleNCG(t),t=f[0],a=f[1]),d=inheritIfRequired(NativeRegExp(t,r),n?this:RegExpPrototype$1,RegExpWrapper),(u||c||a.length)&&(h=enforceInternalState$1(d),u&&(h.dotAll=!0,h.raw=RegExpWrapper(handleDotAll(t),l)),c&&(h.sticky=!0),a.length&&(h.groups=a)),t!==s)try{createNonEnumerableProperty(d,"source",s===""?"(?:)":s)}catch{}return d},keys$1=getOwnPropertyNames(NativeRegExp),index$1=0;keys$1.length>index$1;)proxyAccessor(RegExpWrapper,NativeRegExp,keys$1[index$1++]);RegExpPrototype$1.constructor=RegExpWrapper,RegExpWrapper.prototype=RegExpPrototype$1,defineBuiltIn$2(global$2,"RegExp",RegExpWrapper,{constructor:!0})}setSpecies("RegExp");var PROPER_FUNCTION_NAME$1=functionName.PROPER,defineBuiltIn$1=defineBuiltIn$c,anObject$8=anObject$m,$toString=toString$l,fails$9=fails$I,getRegExpFlags=regexpGetFlags,TO_STRING="toString",RegExpPrototype=RegExp.prototype,nativeToString=RegExpPrototype[TO_STRING],NOT_GENERIC=fails$9(function(){return nativeToString.call({source:"a",flags:"b"})!="/a/b"}),INCORRECT_NAME=PROPER_FUNCTION_NAME$1&&nativeToString.name!=TO_STRING;(NOT_GENERIC||INCORRECT_NAME)&&defineBuiltIn$1(RegExp.prototype,TO_STRING,function(){var t=anObject$8(this),r=$toString(t.source),n=$toString(getRegExpFlags(t));return"/"+r+"/"+n},{unsafe:!0});var $$j=_export,uncurryThis$b=functionUncurryThis,IndexedObject$2=indexedObject,toIndexedObject$4=toIndexedObject$d,arrayMethodIsStrict$2=arrayMethodIsStrict$6,nativeJoin=uncurryThis$b([].join),ES3_STRINGS=IndexedObject$2!=Object,FORCED$5=ES3_STRINGS||!arrayMethodIsStrict$2("join",",");$$j({target:"Array",proto:!0,forced:FORCED$5},{join:function(t){return nativeJoin(toIndexedObject$4(this),t===void 0?",":t)}});var PROPER_FUNCTION_NAME=functionName.PROPER,fails$8=fails$I,whitespaces=whitespaces$2,non="​᠎",stringTrimForced=function(e){return fails$8(function(){return!!whitespaces[e]()||non[e]()!==non||PROPER_FUNCTION_NAME&&whitespaces[e].name!==e})},$$i=_export,$trim=stringTrim$1.trim,forcedStringTrimMethod=stringTrimForced;$$i({target:"String",proto:!0,forced:forcedStringTrimMethod("trim")},{trim:function(){return $trim(this)}});function _typeof$35(e){return _typeof$35=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$35(e)}function requestAnimationFrame(e){return window.requestAnimationFrame(e)}function isClassListSupported(){return!!document.documentElement.classList}function isTextContentSupported(){return!!document.createTextNode("test").textContent}function isGetComputedStyleSupported(){return!!window.getComputedStyle}function cancelAnimationFrame(e){window.cancelAnimationFrame(e)}function isTouchSupported(){return"ontouchstart"in window}var _hasCaptionProblem;function detectCaptionProblem(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),_hasCaptionProblem=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function hasCaptionProblem(){return _hasCaptionProblem===void 0&&detectCaptionProblem(),_hasCaptionProblem}var comparisonFunction;function getComparisonFunction(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return comparisonFunction||((typeof Intl>"u"?"undefined":_typeof$35(Intl))==="object"?comparisonFunction=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?comparisonFunction=function(n,o){return"".concat(n).localeCompare(o)}:comparisonFunction=function(n,o){return n===o?0:n>o?-1:1},comparisonFunction)}var passiveSupported;function isPassiveEventSupported(){if(passiveSupported!==void 0)return passiveSupported;try{var e={get passive(){passiveSupported=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{passiveSupported=!1}return passiveSupported}const featureHelpers=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame,getComparisonFunction,hasCaptionProblem,isClassListSupported,isGetComputedStyleSupported,isPassiveEventSupported,isTextContentSupported,isTouchSupported,requestAnimationFrame},Symbol.toStringTag,{value:"Module"}));var defineWellKnownSymbol=wellKnownSymbolDefine,defineSymbolToPrimitive=symbolDefineToPrimitive;defineWellKnownSymbol("toPrimitive");defineSymbolToPrimitive();var anObject$7=anObject$m,ordinaryToPrimitive=ordinaryToPrimitive$2,$TypeError$2=TypeError,dateToPrimitive$1=function(e){if(anObject$7(this),e==="string"||e==="default")e="string";else if(e!=="number")throw $TypeError$2("Incorrect hint");return ordinaryToPrimitive(this,e)},hasOwn$3=hasOwnProperty_1,defineBuiltIn=defineBuiltIn$c,dateToPrimitive=dateToPrimitive$1,wellKnownSymbol$1=wellKnownSymbol$q,TO_PRIMITIVE=wellKnownSymbol$1("toPrimitive"),DatePrototype=Date.prototype;hasOwn$3(DatePrototype,TO_PRIMITIVE)||defineBuiltIn(DatePrototype,TO_PRIMITIVE,dateToPrimitive);var isConstructor=isConstructor$4,tryToString=tryToString$6,$TypeError$1=TypeError,aConstructor$2=function(e){if(isConstructor(e))return e;throw $TypeError$1(tryToString(e)+" is not a constructor")},anObject$6=anObject$m,aConstructor$1=aConstructor$2,isNullOrUndefined$4=isNullOrUndefined$b,wellKnownSymbol=wellKnownSymbol$q,SPECIES=wellKnownSymbol("species"),speciesConstructor$1=function(e,t){var r=anObject$6(e).constructor,n;return r===void 0||isNullOrUndefined$4(n=anObject$6(r)[SPECIES])?t:aConstructor$1(n)},apply$3=functionApply,call$4=functionCall,uncurryThis$a=functionUncurryThis,fixRegExpWellKnownSymbolLogic$2=fixRegexpWellKnownSymbolLogic,anObject$5=anObject$m,isNullOrUndefined$3=isNullOrUndefined$b,isRegExp$1=isRegexp,requireObjectCoercible$7=requireObjectCoercible$e,speciesConstructor=speciesConstructor$1,advanceStringIndex$1=advanceStringIndex$3,toLength$4=toLength$7,toString$8=toString$l,getMethod$2=getMethod$7,arraySlice$1=arraySliceSimple,callRegExpExec=regexpExecAbstract,regexpExec=regexpExec$3,stickyHelpers=regexpStickyHelpers,fails$7=fails$I,UNSUPPORTED_Y=stickyHelpers.UNSUPPORTED_Y,MAX_UINT32=4294967295,min$4=Math.min,$push=[].push,exec=uncurryThis$a(/./.exec),push$2=uncurryThis$a($push),stringSlice$3=uncurryThis$a("".slice),SPLIT_WORKS_WITH_OVERWRITTEN_EXEC=!fails$7(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});fixRegExpWellKnownSymbolLogic$2("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=toString$8(requireObjectCoercible$7(this)),s=i===void 0?MAX_UINT32:i>>>0;if(s===0)return[];if(o===void 0)return[a];if(!isRegExp$1(o))return call$4(t,a,o,s);for(var l=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),c=0,f=new RegExp(o.source,u+"g"),d,h,y;(d=call$4(regexpExec,f,a))&&(h=f.lastIndex,!(h>c&&(push$2(l,stringSlice$3(a,c,d.index)),d.length>1&&d.index<a.length&&apply$3($push,l,arraySlice$1(d,1)),y=d[0].length,c=h,l.length>=s)));)f.lastIndex===d.index&&f.lastIndex++;return c===a.length?(y||!exec(f,""))&&push$2(l,""):push$2(l,stringSlice$3(a,c)),l.length>s?arraySlice$1(l,0,s):l}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:call$4(t,this,o,i)}:n=t,[function(i,a){var s=requireObjectCoercible$7(this),l=isNullOrUndefined$3(i)?void 0:getMethod$2(i,e);return l?call$4(l,i,s,a):call$4(n,toString$8(s),i,a)},function(o,i){var a=anObject$5(this),s=toString$8(o),l=r(n,a,s,i,n!==t);if(l.done)return l.value;var u=speciesConstructor(a,RegExp),c=a.unicode,f=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(UNSUPPORTED_Y?"g":"y"),d=new u(UNSUPPORTED_Y?"^(?:"+a.source+")":a,f),h=i===void 0?MAX_UINT32:i>>>0;if(h===0)return[];if(s.length===0)return callRegExpExec(d,s)===null?[s]:[];for(var y=0,p=0,v=[];p<s.length;){d.lastIndex=UNSUPPORTED_Y?0:p;var b=callRegExpExec(d,UNSUPPORTED_Y?stringSlice$3(s,p):s),S;if(b===null||(S=min$4(toLength$4(d.lastIndex+(UNSUPPORTED_Y?p:0)),s.length))===y)p=advanceStringIndex$1(s,p,c);else{if(push$2(v,stringSlice$3(s,y,p)),v.length===h)return v;for(var w=1;w<=b.length-1;w++)if(push$2(v,b[w]),v.length===h)return v;p=y=S}}return push$2(v,stringSlice$3(s,y)),v}]},!SPLIT_WORKS_WITH_OVERWRITTEN_EXEC,UNSUPPORTED_Y);function to2dArray(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function extendArray(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function pivot(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function arrayReduce$1(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var s=i.length;for(n&&s&&(o+=1,a=i[o]),o+=1;o<s;)a=t(a,i[o],o,i),o+=1;return a}function arrayFilter(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var s=n[r];t(s,r,n)&&(a+=1,i[a]=s),r+=1}return i}function arrayMap(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var s=n[r];a+=1,i[a]=t(s,r,n),r+=1}return i}function arrayEach(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function arraySum(e){return arrayReduce$1(e,function(t,r){return t+r},0)}function arrayMax(e){return arrayReduce$1(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function arrayMin(e){return arrayReduce$1(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function arrayAvg(e){return e.length?arraySum(e)/e.length:0}function arrayFlatten(e){return arrayReduce$1(e,function(t,r){return t.concat(Array.isArray(r)?arrayFlatten(r):r)},[])}function arrayUnique(e){var t=[];return arrayEach(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function getDifferenceOfArrays(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return arrayEach(i,function(s){a=a.filter(function(l){return!s.includes(l)})}),a}function getIntersectionOfArrays(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return arrayEach(i,function(s){a=a.filter(function(l){return s.includes(l)})}),a}function getUnionOfArrays(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=new Set(o);return arrayEach(i,function(s){arrayEach(s,function(l){a.has(l)||a.add(l)})}),Array.from(a)}function stringToArray(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const arrayHelpers=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg,arrayEach,arrayFilter,arrayFlatten,arrayMap,arrayMax,arrayMin,arrayReduce:arrayReduce$1,arraySum,arrayUnique,extendArray,getDifferenceOfArrays,getIntersectionOfArrays,getUnionOfArrays,pivot,stringToArray,to2dArray},Symbol.toStringTag,{value:"Module"}));function _defineProperty$J(e,t,r){return t=_toPropertyKey$2X(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2X(e){var t=_toPrimitive$2X(e,"string");return _typeof$34(t)==="symbol"?t:String(t)}function _toPrimitive$2X(e,t){if(_typeof$34(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$34(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _typeof$34(e){return _typeof$34=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$34(e)}function duckSchema(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},objectEach(e,function(r,n){n!=="__children"&&(r&&_typeof$34(r)==="object"&&!Array.isArray(r)?t[n]=duckSchema(r):Array.isArray(r)?r.length&&_typeof$34(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[duckSchema(r[0])]:t[n]=[]:t[n]=null)})),t}function inherit(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function extend$1(e,t,r){var n=Array.isArray(r);return objectEach(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function deepExtend(e,t){objectEach(t,function(r,n){t[n]&&_typeof$34(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),deepExtend(e[n],t[n])):e[n]=t[n]})}function deepClone(e){return _typeof$34(e)==="object"?JSON.parse(JSON.stringify(e)):e}function clone$3(e){var t={};return objectEach(e,function(r,n){t[n]=r}),t}function mixin(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return arrayEach(r,function(o){e.MIXINS.push(o.MIXIN_NAME),objectEach(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var s=function(c,f){var d="_".concat(c),h=function(p){var v=p;return(Array.isArray(v)||isObject$6(v))&&(v=deepClone(v)),v};return function(){return this[d]===void 0&&(this[d]=h(f)),this[d]}},l=function(c){var f="_".concat(c);return function(d){this[f]=d}};Object.defineProperty(e.prototype,a,{get:s(a,i),set:l(a),configurable:!0})}})}),e}function isObjectEqual(e,t){return JSON.stringify(e)===JSON.stringify(t)}function isObject$6(e){return Object.prototype.toString.call(e)==="[object Object]"}function defineGetter(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function objectEach(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function getProperty(e,t){var r=t.split("."),n=e;return objectEach(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function setProperty(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(hasOwnProperty$1(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function deepObjectSize(e){if(!isObject$6(e))return 0;var t=function r(n){var o=0;return isObject$6(n)?objectEach(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function createObjectPropListener(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},_defineProperty$J(t,n,e),_defineProperty$J(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function hasOwnProperty$1(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const objectHelpers=Object.freeze(Object.defineProperty({__proto__:null,clone:clone$3,createObjectPropListener,deepClone,deepExtend,deepObjectSize,defineGetter,duckSchema,extend:extend$1,getProperty,hasOwnProperty:hasOwnProperty$1,inherit,isObject:isObject$6,isObjectEqual,mixin,objectEach,setProperty},Symbol.toStringTag,{value:"Module"}));var tester=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},browsers={chrome:tester(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:tester(function(e){return/CriOS/.test(e)}),edge:tester(function(e){return/Edge/.test(e)}),edgeWebKit:tester(function(e){return/EdgiOS/.test(e)}),firefox:tester(function(e){return/Firefox/.test(e)}),firefoxWebKit:tester(function(e){return/FxiOS/.test(e)}),ie:tester(function(e){return/Trident/.test(e)}),ie9:tester(function(){return!!document.documentMode}),mobile:tester(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:tester(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},platforms={mac:tester(function(e){return/^Mac/.test(e)}),win:tester(function(e){return/^Win/.test(e)}),linux:tester(function(e){return/^Linux/.test(e)}),ios:tester(function(e){return/iPhone|iPad|iPod/i.test(e)})};function setBrowserMeta(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;objectEach(browsers,function(i){var a=i.test;return void a(r,o)})}function setPlatformMeta(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;objectEach(platforms,function(n){var o=n.test;return void o(r)})}setBrowserMeta();setPlatformMeta();function isChrome(){return browsers.chrome.value}function isChromeWebKit(){return browsers.chromeWebKit.value}function isFirefox(){return browsers.firefox.value}function isFirefoxWebKit(){return browsers.firefoxWebKit.value}function isSafari(){return browsers.safari.value}function isEdge(){return browsers.edge.value}function isEdgeWebKit(){return browsers.edgeWebKit.value}function isIE(){return browsers.ie.value}function isIE9(){return browsers.ie9.value}function isMSBrowser(){return browsers.ie.value||browsers.edge.value}function isMobileBrowser(){return browsers.mobile.value}function isIOS(){return platforms.ios.value}function isIpadOS(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&platforms.mac.value}function isWindowsOS(){return platforms.win.value}function isMacOS(){return platforms.mac.value}function isLinuxOS(){return platforms.linux.value}const browserHelpers=Object.freeze(Object.defineProperty({__proto__:null,isChrome,isChromeWebKit,isEdge,isEdgeWebKit,isFirefox,isFirefoxWebKit,isIE,isIE9,isIOS,isIpadOS,isLinuxOS,isMSBrowser,isMacOS,isMobileBrowser,isSafari,isWindowsOS,setBrowserMeta,setPlatformMeta},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function _typeof$33(e){return _typeof$33=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$33(e)}function _setPrototypeOf$1q(e,t){return _setPrototypeOf$1q=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},_setPrototypeOf$1q(e,t)}function _isNativeReflectConstruct$1q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _construct$6(e,t,r){return _isNativeReflectConstruct$1q()?_construct$6=Reflect.construct:_construct$6=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&_setPrototypeOf$1q(u,a.prototype),u},_construct$6.apply(null,arguments)}function _toConsumableArray$C(e){return _arrayWithoutHoles$C(e)||_iterableToArray$E(e)||_unsupportedIterableToArray$1e(e)||_nonIterableSpread$C()}function _arrayWithoutHoles$C(e){if(Array.isArray(e))return _arrayLikeToArray$1e(e)}function _iterableToArray$E(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _unsupportedIterableToArray$1e(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$1e(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$1e(e,t)}}function _arrayLikeToArray$1e(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _nonIterableSpread$C(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var hasOwnProperty=Object.hasOwnProperty,setPrototypeOf$1=Object.setPrototypeOf,isFrozen$1=Object.isFrozen,getPrototypeOf$1=Object.getPrototypeOf,getOwnPropertyDescriptor$2=Object.getOwnPropertyDescriptor,freeze$1=Object.freeze,seal$1=Object.seal,create$1=Object.create,_ref=typeof Reflect<"u"&&Reflect,apply$2=_ref.apply,construct$1=_ref.construct;apply$2||(apply$2=function(t,r,n){return t.apply(r,n)});freeze$1||(freeze$1=function(t){return t});seal$1||(seal$1=function(t){return t});construct$1||(construct$1=function(t,r){return _construct$6(t,_toConsumableArray$C(r))});var arrayForEach=unapply(Array.prototype.forEach),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),stringToLowerCase=unapply(String.prototype.toLowerCase),stringToString=unapply(String.prototype.toString),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return apply$2(e,t,n)}}function unconstruct(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return construct$1(e,r)}}function addToSet(e,t,r){r=r||stringToLowerCase,setPrototypeOf$1&&setPrototypeOf$1(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var i=r(o);i!==o&&(isFrozen$1(t)||(t[n]=i),o=i)}e[o]=!0}return e}function clone$2(e){var t=create$1(null),r;for(r in e)apply$2(hasOwnProperty,e,[r])===!0&&(t[r]=e[r]);return t}function lookupGetter(e,t){for(;e!==null;){var r=getOwnPropertyDescriptor$2(e,t);if(r){if(r.get)return unapply(r.get);if(typeof r.value=="function")return unapply(r.value)}e=getPrototypeOf$1(e)}function n(o){return console.warn("fallback value for",o),null}return n}var html$1=freeze$1(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg$1=freeze$1(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze$1(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze$1(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl$1=freeze$1(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),mathMlDisallowed=freeze$1(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze$1(["#text"]),html=freeze$1(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),svg=freeze$1(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl=freeze$1(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze$1(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal$1(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ERB_EXPR=seal$1(/<%[\w\W]*|[\w\W]*%>/gm),TMPLIT_EXPR=seal$1(/\${[\w\W]*}/gm),DATA_ATTR=seal$1(/^data-[\-\w.\u00B7-\uFFFF]/),ARIA_ATTR=seal$1(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal$1(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal$1(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal$1(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DOCTYPE_NAME=seal$1(/^html$/i),getGlobal=function(){return typeof window>"u"?null:window},_createTrustedTypesPolicy=function(t,r){if(_typeof$33(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function createDOMPurify(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal(),t=function(x){return createDOMPurify(x)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,s=e.Element,l=e.NodeFilter,u=e.NamedNodeMap,c=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,f=e.HTMLFormElement,d=e.DOMParser,h=e.trustedTypes,y=s.prototype,p=lookupGetter(y,"cloneNode"),v=lookupGetter(y,"nextSibling"),b=lookupGetter(y,"childNodes"),S=lookupGetter(y,"parentNode");if(typeof i=="function"){var w=n.createElement("template");w.content&&w.content.ownerDocument&&(n=w.content.ownerDocument)}var P=_createTrustedTypesPolicy(h,r),E=P?P.createHTML(""):"",j=n,G=j.implementation,q=j.createNodeIterator,z=j.createDocumentFragment,U=j.getElementsByTagName,Z=r.importNode,te={};try{te=clone$2(n).documentMode?n.documentMode:{}}catch{}var Q={};t.isSupported=typeof S=="function"&&G&&typeof G.createHTMLDocument<"u"&&te!==9;var ie=MUSTACHE_EXPR,he=ERB_EXPR,ce=TMPLIT_EXPR,fe=DATA_ATTR,I=ARIA_ATTR,g=IS_SCRIPT_OR_DATA,m=ATTR_WHITESPACE,_=IS_ALLOWED_URI,C=null,R=addToSet({},[].concat(_toConsumableArray$C(html$1),_toConsumableArray$C(svg$1),_toConsumableArray$C(svgFilters),_toConsumableArray$C(mathMl$1),_toConsumableArray$C(text))),A=null,B=addToSet({},[].concat(_toConsumableArray$C(html),_toConsumableArray$C(svg),_toConsumableArray$C(mathMl),_toConsumableArray$C(xml))),V=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,J=null,ee=!0,oe=!0,ye=!1,ae=!0,se=!1,X=!1,_e=!1,we=!1,ge=!1,me=!1,ve=!1,O=!0,T=!1,k="user-content-",L=!0,M=!1,F={},N=null,D=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),W=null,H=addToSet({},["audio","video","img","source","image","track"]),Y=null,ne=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ue="http://www.w3.org/1998/Math/MathML",de="http://www.w3.org/2000/svg",be="http://www.w3.org/1999/xhtml",Oe=be,Me=!1,$e=null,Se=addToSet({},[ue,de,be],stringToString),Te,Ie=["application/xhtml+xml","text/html"],Pe="text/html",Ce,Ee=null,De=n.createElement("form"),Ne=function(x){return x instanceof RegExp||x instanceof Function},ke=function(x){Ee&&Ee===x||((!x||_typeof$33(x)!=="object")&&(x={}),x=clone$2(x),Te=Ie.indexOf(x.PARSER_MEDIA_TYPE)===-1?Te=Pe:Te=x.PARSER_MEDIA_TYPE,Ce=Te==="application/xhtml+xml"?stringToString:stringToLowerCase,C="ALLOWED_TAGS"in x?addToSet({},x.ALLOWED_TAGS,Ce):R,A="ALLOWED_ATTR"in x?addToSet({},x.ALLOWED_ATTR,Ce):B,$e="ALLOWED_NAMESPACES"in x?addToSet({},x.ALLOWED_NAMESPACES,stringToString):Se,Y="ADD_URI_SAFE_ATTR"in x?addToSet(clone$2(ne),x.ADD_URI_SAFE_ATTR,Ce):ne,W="ADD_DATA_URI_TAGS"in x?addToSet(clone$2(H),x.ADD_DATA_URI_TAGS,Ce):H,N="FORBID_CONTENTS"in x?addToSet({},x.FORBID_CONTENTS,Ce):D,K="FORBID_TAGS"in x?addToSet({},x.FORBID_TAGS,Ce):{},J="FORBID_ATTR"in x?addToSet({},x.FORBID_ATTR,Ce):{},F="USE_PROFILES"in x?x.USE_PROFILES:!1,ee=x.ALLOW_ARIA_ATTR!==!1,oe=x.ALLOW_DATA_ATTR!==!1,ye=x.ALLOW_UNKNOWN_PROTOCOLS||!1,ae=x.ALLOW_SELF_CLOSE_IN_ATTR!==!1,se=x.SAFE_FOR_TEMPLATES||!1,X=x.WHOLE_DOCUMENT||!1,ge=x.RETURN_DOM||!1,me=x.RETURN_DOM_FRAGMENT||!1,ve=x.RETURN_TRUSTED_TYPE||!1,we=x.FORCE_BODY||!1,O=x.SANITIZE_DOM!==!1,T=x.SANITIZE_NAMED_PROPS||!1,L=x.KEEP_CONTENT!==!1,M=x.IN_PLACE||!1,_=x.ALLOWED_URI_REGEXP||_,Oe=x.NAMESPACE||be,V=x.CUSTOM_ELEMENT_HANDLING||{},x.CUSTOM_ELEMENT_HANDLING&&Ne(x.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(V.tagNameCheck=x.CUSTOM_ELEMENT_HANDLING.tagNameCheck),x.CUSTOM_ELEMENT_HANDLING&&Ne(x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(V.attributeNameCheck=x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),x.CUSTOM_ELEMENT_HANDLING&&typeof x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(V.allowCustomizedBuiltInElements=x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),se&&(oe=!1),me&&(ge=!0),F&&(C=addToSet({},_toConsumableArray$C(text)),A=[],F.html===!0&&(addToSet(C,html$1),addToSet(A,html)),F.svg===!0&&(addToSet(C,svg$1),addToSet(A,svg),addToSet(A,xml)),F.svgFilters===!0&&(addToSet(C,svgFilters),addToSet(A,svg),addToSet(A,xml)),F.mathMl===!0&&(addToSet(C,mathMl$1),addToSet(A,mathMl),addToSet(A,xml))),x.ADD_TAGS&&(C===R&&(C=clone$2(C)),addToSet(C,x.ADD_TAGS,Ce)),x.ADD_ATTR&&(A===B&&(A=clone$2(A)),addToSet(A,x.ADD_ATTR,Ce)),x.ADD_URI_SAFE_ATTR&&addToSet(Y,x.ADD_URI_SAFE_ATTR,Ce),x.FORBID_CONTENTS&&(N===D&&(N=clone$2(N)),addToSet(N,x.FORBID_CONTENTS,Ce)),L&&(C["#text"]=!0),X&&addToSet(C,["html","head","body"]),C.table&&(addToSet(C,["tbody"]),delete K.tbody),freeze$1&&freeze$1(x),Ee=x)},Re=addToSet({},["mi","mo","mn","ms","mtext"]),We=addToSet({},["foreignobject","desc","title","annotation-xml"]),Ue=addToSet({},["title","style","font","a","script"]),Ve=addToSet({},svg$1);addToSet(Ve,svgFilters),addToSet(Ve,svgDisallowed);var ze=addToSet({},mathMl$1);addToSet(ze,mathMlDisallowed);var nt=function(x){var re=S(x);(!re||!re.tagName)&&(re={namespaceURI:Oe,tagName:"template"});var le=stringToLowerCase(x.tagName),Ae=stringToLowerCase(re.tagName);return $e[x.namespaceURI]?x.namespaceURI===de?re.namespaceURI===be?le==="svg":re.namespaceURI===ue?le==="svg"&&(Ae==="annotation-xml"||Re[Ae]):Boolean(Ve[le]):x.namespaceURI===ue?re.namespaceURI===be?le==="math":re.namespaceURI===de?le==="math"&&We[Ae]:Boolean(ze[le]):x.namespaceURI===be?re.namespaceURI===de&&!We[Ae]||re.namespaceURI===ue&&!Re[Ae]?!1:!ze[le]&&(Ue[le]||!Ve[le]):!!(Te==="application/xhtml+xml"&&$e[x.namespaceURI]):!1},je=function(x){arrayPush(t.removed,{element:x});try{x.parentNode.removeChild(x)}catch{try{x.outerHTML=E}catch{x.remove()}}},Ke=function(x,re){try{arrayPush(t.removed,{attribute:re.getAttributeNode(x),from:re})}catch{arrayPush(t.removed,{attribute:null,from:re})}if(re.removeAttribute(x),x==="is"&&!A[x])if(ge||me)try{je(re)}catch{}else try{re.setAttribute(x,"")}catch{}},qe=function(x){var re,le;if(we)x="<remove></remove>"+x;else{var Ae=stringMatch(x,/^[\r\n\t ]+/);le=Ae&&Ae[0]}Te==="application/xhtml+xml"&&Oe===be&&(x='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+x+"</body></html>");var Fe=P?P.createHTML(x):x;if(Oe===be)try{re=new d().parseFromString(Fe,Te)}catch{}if(!re||!re.documentElement){re=G.createDocument(Oe,"template",null);try{re.documentElement.innerHTML=Me?E:Fe}catch{}}var He=re.body||re.documentElement;return x&&le&&He.insertBefore(n.createTextNode(le),He.childNodes[0]||null),Oe===be?U.call(re,X?"html":"body")[0]:X?re.documentElement:He},Ze=function(x){return q.call(x.ownerDocument||x,x,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},ot=function(x){return x instanceof f&&(typeof x.nodeName!="string"||typeof x.textContent!="string"||typeof x.removeChild!="function"||!(x.attributes instanceof c)||typeof x.removeAttribute!="function"||typeof x.setAttribute!="function"||typeof x.namespaceURI!="string"||typeof x.insertBefore!="function"||typeof x.hasChildNodes!="function")},Ge=function(x){return _typeof$33(a)==="object"?x instanceof a:x&&_typeof$33(x)==="object"&&typeof x.nodeType=="number"&&typeof x.nodeName=="string"},Be=function(x,re,le){Q[x]&&arrayForEach(Q[x],function(Ae){Ae.call(t,re,le,Ee)})},Qe=function(x){var re;if(Be("beforeSanitizeElements",x,null),ot(x)||regExpTest(/[\u0080-\uFFFF]/,x.nodeName))return je(x),!0;var le=Ce(x.nodeName);if(Be("uponSanitizeElement",x,{tagName:le,allowedTags:C}),x.hasChildNodes()&&!Ge(x.firstElementChild)&&(!Ge(x.content)||!Ge(x.content.firstElementChild))&&regExpTest(/<[/\w]/g,x.innerHTML)&&regExpTest(/<[/\w]/g,x.textContent)||le==="select"&&regExpTest(/<template/i,x.innerHTML))return je(x),!0;if(!C[le]||K[le]){if(!K[le]&&et(le)&&(V.tagNameCheck instanceof RegExp&&regExpTest(V.tagNameCheck,le)||V.tagNameCheck instanceof Function&&V.tagNameCheck(le)))return!1;if(L&&!N[le]){var Ae=S(x)||x.parentNode,Fe=b(x)||x.childNodes;if(Fe&&Ae)for(var He=Fe.length,Le=He-1;Le>=0;--Le)Ae.insertBefore(p(Fe[Le],!0),v(x))}return je(x),!0}return x instanceof s&&!nt(x)||(le==="noscript"||le==="noembed")&&regExpTest(/<\/no(script|embed)/i,x.innerHTML)?(je(x),!0):(se&&x.nodeType===3&&(re=x.textContent,re=stringReplace(re,ie," "),re=stringReplace(re,he," "),re=stringReplace(re,ce," "),x.textContent!==re&&(arrayPush(t.removed,{element:x.cloneNode()}),x.textContent=re)),Be("afterSanitizeElements",x,null),!1)},Je=function(x,re,le){if(O&&(re==="id"||re==="name")&&(le in n||le in De))return!1;if(!(oe&&!J[re]&&regExpTest(fe,re))){if(!(ee&&regExpTest(I,re))){if(!A[re]||J[re]){if(!(et(x)&&(V.tagNameCheck instanceof RegExp&&regExpTest(V.tagNameCheck,x)||V.tagNameCheck instanceof Function&&V.tagNameCheck(x))&&(V.attributeNameCheck instanceof RegExp&&regExpTest(V.attributeNameCheck,re)||V.attributeNameCheck instanceof Function&&V.attributeNameCheck(re))||re==="is"&&V.allowCustomizedBuiltInElements&&(V.tagNameCheck instanceof RegExp&&regExpTest(V.tagNameCheck,le)||V.tagNameCheck instanceof Function&&V.tagNameCheck(le))))return!1}else if(!Y[re]){if(!regExpTest(_,stringReplace(le,m,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&x!=="script"&&stringIndexOf(le,"data:")===0&&W[x])){if(!(ye&&!regExpTest(g,stringReplace(le,m,"")))){if(le)return!1}}}}}}return!0},et=function(x){return x.indexOf("-")>0},tt=function(x){var re,le,Ae,Fe;Be("beforeSanitizeAttributes",x,null);var He=x.attributes;if(He){var Le={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:A};for(Fe=He.length;Fe--;){re=He[Fe];var Ye=re,xe=Ye.name,Xe=Ye.namespaceURI;if(le=xe==="value"?re.value:stringTrim(re.value),Ae=Ce(xe),Le.attrName=Ae,Le.attrValue=le,Le.keepAttr=!0,Le.forceKeepAttr=void 0,Be("uponSanitizeAttribute",x,Le),le=Le.attrValue,!Le.forceKeepAttr&&(Ke(xe,x),!!Le.keepAttr)){if(!ae&&regExpTest(/\/>/i,le)){Ke(xe,x);continue}se&&(le=stringReplace(le,ie," "),le=stringReplace(le,he," "),le=stringReplace(le,ce," "));var rt=Ce(x.nodeName);if(Je(rt,Ae,le)){if(T&&(Ae==="id"||Ae==="name")&&(Ke(xe,x),le=k+le),P&&_typeof$33(h)==="object"&&typeof h.getAttributeType=="function"&&!Xe)switch(h.getAttributeType(rt,Ae)){case"TrustedHTML":le=P.createHTML(le);break;case"TrustedScriptURL":le=P.createScriptURL(le);break}try{Xe?x.setAttributeNS(Xe,xe,le):x.setAttribute(xe,le),arrayPop(t.removed)}catch{}}}}Be("afterSanitizeAttributes",x,null)}},it=function pe(x){var re,le=Ze(x);for(Be("beforeSanitizeShadowDOM",x,null);re=le.nextNode();)Be("uponSanitizeShadowNode",re,null),!Qe(re)&&(re.content instanceof o&&pe(re.content),tt(re));Be("afterSanitizeShadowDOM",x,null)};return t.sanitize=function(pe){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re,le,Ae,Fe,He;if(Me=!pe,Me&&(pe="<!-->"),typeof pe!="string"&&!Ge(pe)){if(typeof pe.toString!="function")throw typeErrorCreate("toString is not a function");if(pe=pe.toString(),typeof pe!="string")throw typeErrorCreate("dirty is not a string, aborting")}if(!t.isSupported){if(_typeof$33(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof pe=="string")return e.toStaticHTML(pe);if(Ge(pe))return e.toStaticHTML(pe.outerHTML)}return pe}if(_e||ke(x),t.removed=[],typeof pe=="string"&&(M=!1),M){if(pe.nodeName){var Le=Ce(pe.nodeName);if(!C[Le]||K[Le])throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}else if(pe instanceof a)re=qe("<!---->"),le=re.ownerDocument.importNode(pe,!0),le.nodeType===1&&le.nodeName==="BODY"||le.nodeName==="HTML"?re=le:re.appendChild(le);else{if(!ge&&!se&&!X&&pe.indexOf("<")===-1)return P&&ve?P.createHTML(pe):pe;if(re=qe(pe),!re)return ge?null:ve?E:""}re&&we&&je(re.firstChild);for(var Ye=Ze(M?pe:re);Ae=Ye.nextNode();)Ae.nodeType===3&&Ae===Fe||Qe(Ae)||(Ae.content instanceof o&&it(Ae.content),tt(Ae),Fe=Ae);if(Fe=null,M)return pe;if(ge){if(me)for(He=z.call(re.ownerDocument);re.firstChild;)He.appendChild(re.firstChild);else He=re;return(A.shadowroot||A.shadowrootmod)&&(He=Z.call(r,He,!0)),He}var xe=X?re.outerHTML:re.innerHTML;return X&&C["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,re.ownerDocument.doctype.name)&&(xe="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+xe),se&&(xe=stringReplace(xe,ie," "),xe=stringReplace(xe,he," "),xe=stringReplace(xe,ce," ")),P&&ve?P.createHTML(xe):xe},t.setConfig=function(pe){ke(pe),_e=!0},t.clearConfig=function(){Ee=null,_e=!1},t.isValidAttribute=function(pe,x,re){Ee||ke({});var le=Ce(pe),Ae=Ce(x);return Je(le,Ae,re)},t.addHook=function(pe,x){typeof x=="function"&&(Q[pe]=Q[pe]||[],arrayPush(Q[pe],x))},t.removeHook=function(pe){if(Q[pe])return arrayPop(Q[pe])},t.removeHooks=function(pe){Q[pe]&&(Q[pe]=[])},t.removeAllHooks=function(){Q={}},t}var purify=createDOMPurify(),$$h=_export,codeAt=stringMultibyte.codeAt;$$h({target:"String",proto:!0},{codePointAt:function(t){return codeAt(this,t)}});var toIntegerOrInfinity$2=toIntegerOrInfinity$8,toString$7=toString$l,requireObjectCoercible$6=requireObjectCoercible$e,$RangeError$1=RangeError,stringRepeat=function(t){var r=toString$7(requireObjectCoercible$6(this)),n="",o=toIntegerOrInfinity$2(t);if(o<0||o==1/0)throw $RangeError$1("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},uncurryThis$9=functionUncurryThis,toLength$3=toLength$7,toString$6=toString$l,$repeat$1=stringRepeat,requireObjectCoercible$5=requireObjectCoercible$e,repeat$1=uncurryThis$9($repeat$1),stringSlice$2=uncurryThis$9("".slice),ceil=Math.ceil,createMethod$2=function(e){return function(t,r,n){var o=toString$6(requireObjectCoercible$5(t)),i=toLength$3(r),a=o.length,s=n===void 0?" ":toString$6(n),l,u;return i<=a||s==""?o:(l=i-a,u=repeat$1(s,ceil(l/s.length)),u.length>l&&(u=stringSlice$2(u,0,l)),e?o+u:u+o)}},stringPad={start:createMethod$2(!1),end:createMethod$2(!0)},userAgent=engineUserAgent,stringPadWebkitBug=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(userAgent),$$g=_export,$padStart=stringPad.start,WEBKIT_BUG=stringPadWebkitBug;$$g({target:"String",proto:!0,forced:WEBKIT_BUG},{padStart:function(t){return $padStart(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var hookCallback;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(e){hookCallback=e}function isArray$1(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function isObject$5(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function hasOwnProp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function isObjectEmpty(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(hasOwnProp(e,t))return!1;return!0}function isUndefined$1(e){return e===void 0}function isNumber(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function isDate(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function map(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function extend(e,t){for(var r in t)hasOwnProp(t,r)&&(e[r]=t[r]);return hasOwnProp(t,"toString")&&(e.toString=t.toString),hasOwnProp(t,"valueOf")&&(e.valueOf=t.valueOf),e}function createUTC(e,t,r,n){return createLocalOrUTC(e,t,r,n,!0).utc()}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function getParsingFlags(e){return e._pf==null&&(e._pf=defaultParsingFlags()),e._pf}var some;Array.prototype.some?some=Array.prototype.some:some=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function isValid(e){if(e._isValid==null){var t=getParsingFlags(e),r=some.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function createInvalid(e){var t=createUTC(NaN);return e!=null?extend(getParsingFlags(t),e):getParsingFlags(t).userInvalidated=!0,t}var momentProperties=hooks.momentProperties=[],updateInProgress=!1;function copyConfig(e,t){var r,n,o,i=momentProperties.length;if(isUndefined$1(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),isUndefined$1(t._i)||(e._i=t._i),isUndefined$1(t._f)||(e._f=t._f),isUndefined$1(t._l)||(e._l=t._l),isUndefined$1(t._strict)||(e._strict=t._strict),isUndefined$1(t._tzm)||(e._tzm=t._tzm),isUndefined$1(t._isUTC)||(e._isUTC=t._isUTC),isUndefined$1(t._offset)||(e._offset=t._offset),isUndefined$1(t._pf)||(e._pf=getParsingFlags(t)),isUndefined$1(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=momentProperties[r],o=t[n],isUndefined$1(o)||(e[n]=o);return e}function Moment(e){copyConfig(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),updateInProgress===!1&&(updateInProgress=!0,hooks.updateOffset(this),updateInProgress=!1)}function isMoment(e){return e instanceof Moment||e!=null&&e._isAMomentObject!=null}function warn$1(e){hooks.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function deprecate(e,t){var r=!0;return extend(function(){if(hooks.deprecationHandler!=null&&hooks.deprecationHandler(null,e),r){var n=[],o,i,a,s=arguments.length;for(i=0;i<s;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])hasOwnProp(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}warn$1(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var deprecations={};function deprecateSimple(e,t){hooks.deprecationHandler!=null&&hooks.deprecationHandler(e,t),deprecations[e]||(warn$1(t),deprecations[e]=!0)}hooks.suppressDeprecationWarnings=!1;hooks.deprecationHandler=null;function isFunction$1(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function set(e){var t,r;for(r in e)hasOwnProp(e,r)&&(t=e[r],isFunction$1(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(e,t){var r=extend({},e),n;for(n in t)hasOwnProp(t,n)&&(isObject$5(e[n])&&isObject$5(t[n])?(r[n]={},extend(r[n],e[n]),extend(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)hasOwnProp(e,n)&&!hasOwnProp(t,n)&&isObject$5(e[n])&&(r[n]=extend({},r[n]));return r}function Locale(e){e!=null&&this.set(e)}var keys;Object.keys?keys=Object.keys:keys=function(e){var t,r=[];for(t in e)hasOwnProp(e,t)&&r.push(t);return r};var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return isFunction$1(n)?n.call(t,r):n}function zeroFill(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(formatTokenFunctions[e]=o),t&&(formatTokenFunctions[t[0]]=function(){return zeroFill(o.apply(this,arguments),t[1],t[2])}),r&&(formatTokenFunctions[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function removeFormattingTokens(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function makeFormatFunction(e){var t=e.match(formattingTokens),r,n;for(r=0,n=t.length;r<n;r++)formatTokenFunctions[t[r]]?t[r]=formatTokenFunctions[t[r]]:t[r]=removeFormattingTokens(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=isFunction$1(t[a])?t[a].call(o,e):t[a];return i}}function formatMoment(e,t){return e.isValid()?(t=expandFormat(t,e.localeData()),formatFunctions[t]=formatFunctions[t]||makeFormatFunction(t),formatFunctions[t](e)):e.localeData().invalidDate()}function expandFormat(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(localFormattingTokens.lastIndex=0;r>=0&&localFormattingTokens.test(e);)e=e.replace(localFormattingTokens,n),localFormattingTokens.lastIndex=0,r-=1;return e}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(formattingTokens).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d",defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(e){return this._ordinal.replace("%d",e)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(e,t,r,n){var o=this._relativeTime[r];return isFunction$1(o)?o(e,t,r,n):o.replace(/%d/i,e)}function pastFuture(e,t){var r=this._relativeTime[e>0?"future":"past"];return isFunction$1(r)?r(t):r.replace(/%s/i,t)}var aliases={};function addUnitAlias(e,t){var r=e.toLowerCase();aliases[r]=aliases[r+"s"]=aliases[t]=e}function normalizeUnits(e){return typeof e=="string"?aliases[e]||aliases[e.toLowerCase()]:void 0}function normalizeObjectUnits(e){var t={},r,n;for(n in e)hasOwnProp(e,n)&&(r=normalizeUnits(n),r&&(t[r]=e[n]));return t}var priorities={};function addUnitPriority(e,t){priorities[e]=t}function getPrioritizedUnits(e){var t=[],r;for(r in e)hasOwnProp(e,r)&&t.push({unit:r,priority:priorities[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function isLeapYear(e){return e%4===0&&e%100!==0||e%400===0}function absFloor(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function toInt(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=absFloor(t)),r}function makeGetSet(e,t){return function(r){return r!=null?(set$1(this,e,r),hooks.updateOffset(this,t),this):get$1(this,e)}}function get$1(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function set$1(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&isLeapYear(e.year())&&e.month()===1&&e.date()===29?(r=toInt(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),daysInMonth(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function stringGet(e){return e=normalizeUnits(e),isFunction$1(this[e])?this[e]():this}function stringSet(e,t){if(typeof e=="object"){e=normalizeObjectUnits(e);var r=getPrioritizedUnits(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=normalizeUnits(e),isFunction$1(this[e]))return this[e](t);return this}var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,regexes;regexes={};function addRegexToken(e,t,r){regexes[e]=isFunction$1(t)?t:function(n,o){return n&&r?r:t}}function getParseRegexForToken(e,t){return hasOwnProp(regexes,e)?regexes[e](t._strict,t._locale):new RegExp(unescapeFormat(e))}function unescapeFormat(e){return regexEscape(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function regexEscape(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var tokens={};function addParseToken(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),isNumber(t)&&(n=function(i,a){a[t]=toInt(i)}),o=e.length,r=0;r<o;r++)tokens[e[r]]=n}function addWeekParseToken(e,t){addParseToken(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function addTimeToArrayFromToken(e,t,r){t!=null&&hasOwnProp(tokens,e)&&tokens[e](t,r._a,r,e)}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;function mod(e,t){return(e%t+t)%t}var indexOf;Array.prototype.indexOf?indexOf=Array.prototype.indexOf:indexOf=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function daysInMonth(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=mod(t,12);return e+=(t-r)/12,r===1?isLeapYear(e)?29:28:31-r%7%2}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1});addFormatToken("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});addFormatToken("MMMM",0,0,function(e){return this.localeData().months(this,e)});addUnitAlias("month","M");addUnitPriority("month",8);addRegexToken("M",match1to2);addRegexToken("MM",match1to2,match2);addRegexToken("MMM",function(e,t){return t.monthsShortRegex(e)});addRegexToken("MMMM",function(e,t){return t.monthsRegex(e)});addParseToken(["M","MM"],function(e,t){t[MONTH]=toInt(e)-1});addParseToken(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[MONTH]=o:getParsingFlags(r).invalidMonth=e});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function localeMonths(e,t){return e?isArray$1(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(t)?"format":"standalone"][e.month()]:isArray$1(this._months)?this._months:this._months.standalone}function localeMonthsShort(e,t){return e?isArray$1(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(t)?"format":"standalone"][e.month()]:isArray$1(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function handleStrictParse(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=createUTC([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=indexOf.call(this._shortMonthsParse,a),o!==-1?o:null):(o=indexOf.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=indexOf.call(this._shortMonthsParse,a),o!==-1?o:(o=indexOf.call(this._longMonthsParse,a),o!==-1?o:null)):(o=indexOf.call(this._longMonthsParse,a),o!==-1?o:(o=indexOf.call(this._shortMonthsParse,a),o!==-1?o:null))}function localeMonthsParse(e,t,r){var n,o,i;if(this._monthsParseExact)return handleStrictParse.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=createUTC([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function setMonth(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=toInt(t);else if(t=e.localeData().monthsParse(t),!isNumber(t))return e}return r=Math.min(e.date(),daysInMonth(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function getSetMonth(e){return e!=null?(setMonth(this,e),hooks.updateOffset(this,!0),this):get$1(this,"Month")}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}function monthsShortRegex(e){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(hasOwnProp(this,"_monthsShortRegex")||(this._monthsShortRegex=defaultMonthsShortRegex),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function monthsRegex(e){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),e?this._monthsStrictRegex:this._monthsRegex):(hasOwnProp(this,"_monthsRegex")||(this._monthsRegex=defaultMonthsRegex),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function computeMonthsParse(){function e(a,s){return s.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=createUTC([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=regexEscape(t[o]),r[o]=regexEscape(r[o]);for(o=0;o<24;o++)n[o]=regexEscape(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}addFormatToken("Y",0,0,function(){var e=this.year();return e<=9999?zeroFill(e,4):"+"+e});addFormatToken(0,["YY",2],0,function(){return this.year()%100});addFormatToken(0,["YYYY",4],0,"year");addFormatToken(0,["YYYYY",5],0,"year");addFormatToken(0,["YYYYYY",6,!0],0,"year");addUnitAlias("year","y");addUnitPriority("year",1);addRegexToken("Y",matchSigned);addRegexToken("YY",match1to2,match2);addRegexToken("YYYY",match1to4,match4);addRegexToken("YYYYY",match1to6,match6);addRegexToken("YYYYYY",match1to6,match6);addParseToken(["YYYYY","YYYYYY"],YEAR);addParseToken("YYYY",function(e,t){t[YEAR]=e.length===2?hooks.parseTwoDigitYear(e):toInt(e)});addParseToken("YY",function(e,t){t[YEAR]=hooks.parseTwoDigitYear(e)});addParseToken("Y",function(e,t){t[YEAR]=parseInt(e,10)});function daysInYear(e){return isLeapYear(e)?366:365}hooks.parseTwoDigitYear=function(e){return toInt(e)+(toInt(e)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",!0);function getIsLeapYear(){return isLeapYear(this.year())}function createDate(e,t,r,n,o,i,a){var s;return e<100&&e>=0?(s=new Date(e+400,t,r,n,o,i,a),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,r,n,o,i,a),s}function createUTCDate(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function firstWeekOffset(e,t,r){var n=7+t-r,o=(7+createUTCDate(e,0,n).getUTCDay()-t)%7;return-o+n-1}function dayOfYearFromWeeks(e,t,r,n,o){var i=(7+r-n)%7,a=firstWeekOffset(e,n,o),s=1+7*(t-1)+i+a,l,u;return s<=0?(l=e-1,u=daysInYear(l)+s):s>daysInYear(e)?(l=e+1,u=s-daysInYear(e)):(l=e,u=s),{year:l,dayOfYear:u}}function weekOfYear(e,t,r){var n=firstWeekOffset(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+weeksInYear(a,t,r)):o>weeksInYear(e.year(),t,r)?(i=o-weeksInYear(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function weeksInYear(e,t,r){var n=firstWeekOffset(e,t,r),o=firstWeekOffset(e+1,t,r);return(daysInYear(e)-n+o)/7}addFormatToken("w",["ww",2],"wo","week");addFormatToken("W",["WW",2],"Wo","isoWeek");addUnitAlias("week","w");addUnitAlias("isoWeek","W");addUnitPriority("week",5);addUnitPriority("isoWeek",5);addRegexToken("w",match1to2);addRegexToken("ww",match1to2,match2);addRegexToken("W",match1to2);addRegexToken("WW",match1to2,match2);addWeekParseToken(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=toInt(e)});function localeWeek(e){return weekOfYear(e,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function getSetISOWeek(e){var t=weekOfYear(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}addFormatToken("d",0,"do","day");addFormatToken("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});addFormatToken("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});addFormatToken("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});addFormatToken("e",0,0,"weekday");addFormatToken("E",0,0,"isoWeekday");addUnitAlias("day","d");addUnitAlias("weekday","e");addUnitAlias("isoWeekday","E");addUnitPriority("day",11);addUnitPriority("weekday",11);addUnitPriority("isoWeekday",11);addRegexToken("d",match1to2);addRegexToken("e",match1to2);addRegexToken("E",match1to2);addRegexToken("dd",function(e,t){return t.weekdaysMinRegex(e)});addRegexToken("ddd",function(e,t){return t.weekdaysShortRegex(e)});addRegexToken("dddd",function(e,t){return t.weekdaysRegex(e)});addWeekParseToken(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:getParsingFlags(r).invalidWeekday=e});addWeekParseToken(["d","e","E"],function(e,t,r,n){t[n]=toInt(e)});function parseWeekday(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function parseIsoWeekday(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function shiftWeekdays(e,t){return e.slice(t,7).concat(e.slice(0,t))}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function localeWeekdays(e,t){var r=isArray$1(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?shiftWeekdays(r,this._week.dow):e?r[e.day()]:r}function localeWeekdaysShort(e){return e===!0?shiftWeekdays(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function localeWeekdaysMin(e){return e===!0?shiftWeekdays(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function handleStrictParse$1(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=createUTC([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=indexOf.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=indexOf.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=indexOf.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=indexOf.call(this._weekdaysParse,a),o!==-1||(o=indexOf.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=indexOf.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=indexOf.call(this._shortWeekdaysParse,a),o!==-1||(o=indexOf.call(this._weekdaysParse,a),o!==-1)?o:(o=indexOf.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=indexOf.call(this._minWeekdaysParse,a),o!==-1||(o=indexOf.call(this._weekdaysParse,a),o!==-1)?o:(o=indexOf.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function localeWeekdaysParse(e,t,r){var n,o,i;if(this._weekdaysParseExact)return handleStrictParse$1.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=createUTC([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function getSetDayOfWeek(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=parseWeekday(e,this.localeData()),this.add(e-t,"d")):t}function getSetLocaleDayOfWeek(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function getSetISODayOfWeek(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=parseIsoWeekday(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function weekdaysRegex(e){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(hasOwnProp(this,"_weekdaysRegex")||(this._weekdaysRegex=defaultWeekdaysRegex),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function weekdaysShortRegex(e){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hasOwnProp(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=defaultWeekdaysShortRegex),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function weekdaysMinRegex(e){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hasOwnProp(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=defaultWeekdaysMinRegex),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function computeWeekdaysParse(){function e(c,f){return f.length-c.length}var t=[],r=[],n=[],o=[],i,a,s,l,u;for(i=0;i<7;i++)a=createUTC([2e3,1]).day(i),s=regexEscape(this.weekdaysMin(a,"")),l=regexEscape(this.weekdaysShort(a,"")),u=regexEscape(this.weekdays(a,"")),t.push(s),r.push(l),n.push(u),o.push(s),o.push(l),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}addFormatToken("H",["HH",2],0,"hour");addFormatToken("h",["hh",2],0,hFormat);addFormatToken("k",["kk",2],0,kFormat);addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)});addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)});addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});function meridiem(e,t){addFormatToken(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}meridiem("a",!0);meridiem("A",!1);addUnitAlias("hour","h");addUnitPriority("hour",13);function matchMeridiem(e,t){return t._meridiemParse}addRegexToken("a",matchMeridiem);addRegexToken("A",matchMeridiem);addRegexToken("H",match1to2);addRegexToken("h",match1to2);addRegexToken("k",match1to2);addRegexToken("HH",match1to2,match2);addRegexToken("hh",match1to2,match2);addRegexToken("kk",match1to2,match2);addRegexToken("hmm",match3to4);addRegexToken("hmmss",match5to6);addRegexToken("Hmm",match3to4);addRegexToken("Hmmss",match5to6);addParseToken(["H","HH"],HOUR);addParseToken(["k","kk"],function(e,t,r){var n=toInt(e);t[HOUR]=n===24?0:n});addParseToken(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});addParseToken(["h","hh"],function(e,t,r){t[HOUR]=toInt(e),getParsingFlags(r).bigHour=!0});addParseToken("hmm",function(e,t,r){var n=e.length-2;t[HOUR]=toInt(e.substr(0,n)),t[MINUTE]=toInt(e.substr(n)),getParsingFlags(r).bigHour=!0});addParseToken("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[HOUR]=toInt(e.substr(0,n)),t[MINUTE]=toInt(e.substr(n,2)),t[SECOND]=toInt(e.substr(o)),getParsingFlags(r).bigHour=!0});addParseToken("Hmm",function(e,t,r){var n=e.length-2;t[HOUR]=toInt(e.substr(0,n)),t[MINUTE]=toInt(e.substr(n))});addParseToken("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[HOUR]=toInt(e.substr(0,n)),t[MINUTE]=toInt(e.substr(n,2)),t[SECOND]=toInt(e.substr(o))});function localeIsPM(e){return(e+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",!0);function localeMeridiem(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse},locales={},localeFamilies={},globalLocale;function commonPrefix(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function normalizeLocale(e){return e&&e.toLowerCase().replace("_","-")}function chooseLocale(e){for(var t=0,r,n,o,i;t<e.length;){for(i=normalizeLocale(e[t]).split("-"),r=i.length,n=normalizeLocale(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=loadLocale(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&commonPrefix(i,n)>=r-1)break;r--}t++}return globalLocale}function isLocaleNameSane(e){return e.match("^[^/\\\\]*$")!=null}function loadLocale(e){var t=null,r;if(locales[e]===void 0&&typeof module<"u"&&module&&module.exports&&isLocaleNameSane(e))try{t=globalLocale._abbr,r=require,r("./locale/"+e),getSetGlobalLocale(t)}catch{locales[e]=null}return locales[e]}function getSetGlobalLocale(e,t){var r;return e&&(isUndefined$1(t)?r=getLocale(e):r=defineLocale(e,t),r?globalLocale=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),globalLocale._abbr}function defineLocale(e,t){if(t!==null){var r,n=baseConfig;if(t.abbr=e,locales[e]!=null)deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=locales[e]._config;else if(t.parentLocale!=null)if(locales[t.parentLocale]!=null)n=locales[t.parentLocale]._config;else if(r=loadLocale(t.parentLocale),r!=null)n=r._config;else return localeFamilies[t.parentLocale]||(localeFamilies[t.parentLocale]=[]),localeFamilies[t.parentLocale].push({name:e,config:t}),null;return locales[e]=new Locale(mergeConfigs(n,t)),localeFamilies[e]&&localeFamilies[e].forEach(function(o){defineLocale(o.name,o.config)}),getSetGlobalLocale(e),locales[e]}else return delete locales[e],null}function updateLocale(e,t){if(t!=null){var r,n,o=baseConfig;locales[e]!=null&&locales[e].parentLocale!=null?locales[e].set(mergeConfigs(locales[e]._config,t)):(n=loadLocale(e),n!=null&&(o=n._config),t=mergeConfigs(o,t),n==null&&(t.abbr=e),r=new Locale(t),r.parentLocale=locales[e],locales[e]=r),getSetGlobalLocale(e)}else locales[e]!=null&&(locales[e].parentLocale!=null?(locales[e]=locales[e].parentLocale,e===getSetGlobalLocale()&&getSetGlobalLocale(e)):locales[e]!=null&&delete locales[e]);return locales[e]}function getLocale(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return globalLocale;if(!isArray$1(e)){if(t=loadLocale(e),t)return t;e=[e]}return chooseLocale(e)}function listLocales(){return keys(locales)}function checkOverflow(e){var t,r=e._a;return r&&getParsingFlags(e).overflow===-2&&(t=r[MONTH]<0||r[MONTH]>11?MONTH:r[DATE]<1||r[DATE]>daysInMonth(r[YEAR],r[MONTH])?DATE:r[HOUR]<0||r[HOUR]>24||r[HOUR]===24&&(r[MINUTE]!==0||r[SECOND]!==0||r[MILLISECOND]!==0)?HOUR:r[MINUTE]<0||r[MINUTE]>59?MINUTE:r[SECOND]<0||r[SECOND]>59?SECOND:r[MILLISECOND]<0||r[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(e)._overflowDayOfYear&&(t<YEAR||t>DATE)&&(t=DATE),getParsingFlags(e)._overflowWeeks&&t===-1&&(t=WEEK),getParsingFlags(e)._overflowWeekday&&t===-1&&(t=WEEKDAY),getParsingFlags(e).overflow=t),e}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function configFromISO(e){var t,r,n=e._i,o=extendedIsoRegex.exec(n)||basicIsoRegex.exec(n),i,a,s,l,u=isoDates.length,c=isoTimes.length;if(o){for(getParsingFlags(e).iso=!0,t=0,r=u;t<r;t++)if(isoDates[t][1].exec(o[1])){a=isoDates[t][0],i=isoDates[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=c;t<r;t++)if(isoTimes[t][1].exec(o[3])){s=(o[2]||" ")+isoTimes[t][0];break}if(s==null){e._isValid=!1;return}}if(!i&&s!=null){e._isValid=!1;return}if(o[4])if(tzRegex.exec(o[4]))l="Z";else{e._isValid=!1;return}e._f=a+(s||"")+(l||""),configFromStringAndFormat(e)}else e._isValid=!1}function extractFromRFC2822Strings(e,t,r,n,o,i){var a=[untruncateYear(e),defaultLocaleMonthsShort.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function untruncateYear(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function preprocessRFC2822(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(e,t,r){if(e){var n=defaultLocaleWeekdaysShort.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return getParsingFlags(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function calculateOffset(e,t,r){if(e)return obsOffsets[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function configFromRFC2822(e){var t=rfc2822.exec(preprocessRFC2822(e._i)),r;if(t){if(r=extractFromRFC2822Strings(t[4],t[3],t[2],t[5],t[6],t[7]),!checkWeekday(t[1],r,e))return;e._a=r,e._tzm=calculateOffset(t[8],t[9],t[10]),e._d=createUTCDate.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),getParsingFlags(e).rfc2822=!0}else e._isValid=!1}function configFromString(e){var t=aspNetJsonRegex.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(configFromISO(e),e._isValid===!1)delete e._isValid;else return;if(configFromRFC2822(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:hooks.createFromInputFallback(e)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function defaults(e,t,r){return e??t??r}function currentDateArray(e){var t=new Date(hooks.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function configFromArray(e){var t,r,n=[],o,i,a;if(!e._d){for(o=currentDateArray(e),e._w&&e._a[DATE]==null&&e._a[MONTH]==null&&dayOfYearFromWeekInfo(e),e._dayOfYear!=null&&(a=defaults(e._a[YEAR],o[YEAR]),(e._dayOfYear>daysInYear(a)||e._dayOfYear===0)&&(getParsingFlags(e)._overflowDayOfYear=!0),r=createUTCDate(a,0,e._dayOfYear),e._a[MONTH]=r.getUTCMonth(),e._a[DATE]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[HOUR]===24&&e._a[MINUTE]===0&&e._a[SECOND]===0&&e._a[MILLISECOND]===0&&(e._nextDay=!0,e._a[HOUR]=0),e._d=(e._useUTC?createUTCDate:createDate).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[HOUR]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(getParsingFlags(e).weekdayMismatch=!0)}}function dayOfYearFromWeekInfo(e){var t,r,n,o,i,a,s,l,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=defaults(t.GG,e._a[YEAR],weekOfYear(createLocal(),1,4).year),n=defaults(t.W,1),o=defaults(t.E,1),(o<1||o>7)&&(l=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=weekOfYear(createLocal(),i,a),r=defaults(t.gg,e._a[YEAR],u.year),n=defaults(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(l=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(l=!0)):o=i),n<1||n>weeksInYear(r,i,a)?getParsingFlags(e)._overflowWeeks=!0:l!=null?getParsingFlags(e)._overflowWeekday=!0:(s=dayOfYearFromWeeks(r,n,o,i,a),e._a[YEAR]=s.year,e._dayOfYear=s.dayOfYear)}hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(e){if(e._f===hooks.ISO_8601){configFromISO(e);return}if(e._f===hooks.RFC_2822){configFromRFC2822(e);return}e._a=[],getParsingFlags(e).empty=!0;var t=""+e._i,r,n,o,i,a,s=t.length,l=0,u,c;for(o=expandFormat(e._f,e._locale).match(formattingTokens)||[],c=o.length,r=0;r<c;r++)i=o[r],n=(t.match(getParseRegexForToken(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&getParsingFlags(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),l+=n.length),formatTokenFunctions[i]?(n?getParsingFlags(e).empty=!1:getParsingFlags(e).unusedTokens.push(i),addTimeToArrayFromToken(i,n,e)):e._strict&&!n&&getParsingFlags(e).unusedTokens.push(i);getParsingFlags(e).charsLeftOver=s-l,t.length>0&&getParsingFlags(e).unusedInput.push(t),e._a[HOUR]<=12&&getParsingFlags(e).bigHour===!0&&e._a[HOUR]>0&&(getParsingFlags(e).bigHour=void 0),getParsingFlags(e).parsedDateParts=e._a.slice(0),getParsingFlags(e).meridiem=e._meridiem,e._a[HOUR]=meridiemFixWrap(e._locale,e._a[HOUR],e._meridiem),u=getParsingFlags(e).era,u!==null&&(e._a[YEAR]=e._locale.erasConvertYear(u,e._a[YEAR])),configFromArray(e),checkOverflow(e)}function meridiemFixWrap(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function configFromStringAndArray(e){var t,r,n,o,i,a,s=!1,l=e._f.length;if(l===0){getParsingFlags(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<l;o++)i=0,a=!1,t=copyConfig({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],configFromStringAndFormat(t),isValid(t)&&(a=!0),i+=getParsingFlags(t).charsLeftOver,i+=getParsingFlags(t).unusedTokens.length*10,getParsingFlags(t).score=i,s?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(s=!0));extend(e,r||t)}function configFromObject(e){if(!e._d){var t=normalizeObjectUnits(e._i),r=t.day===void 0?t.date:t.day;e._a=map([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),configFromArray(e)}}function createFromConfig(e){var t=new Moment(checkOverflow(prepareConfig(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function prepareConfig(e){var t=e._i,r=e._f;return e._locale=e._locale||getLocale(e._l),t===null||r===void 0&&t===""?createInvalid({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),isMoment(t)?new Moment(checkOverflow(t)):(isDate(t)?e._d=t:isArray$1(r)?configFromStringAndArray(e):r?configFromStringAndFormat(e):configFromInput(e),isValid(e)||(e._d=null),e))}function configFromInput(e){var t=e._i;isUndefined$1(t)?e._d=new Date(hooks.now()):isDate(t)?e._d=new Date(t.valueOf()):typeof t=="string"?configFromString(e):isArray$1(t)?(e._a=map(t.slice(0),function(r){return parseInt(r,10)}),configFromArray(e)):isObject$5(t)?configFromObject(e):isNumber(t)?e._d=new Date(t):hooks.createFromInputFallback(e)}function createLocalOrUTC(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(isObject$5(e)&&isObjectEmpty(e)||isArray$1(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,createFromConfig(i)}function createLocal(e,t,r,n){return createLocalOrUTC(e,t,r,n,!1)}var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=createLocal.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:createInvalid()}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=createLocal.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:createInvalid()});function pickBy(e,t){var r,n;if(t.length===1&&isArray$1(t[0])&&(t=t[0]),!t.length)return createLocal();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function min$3(){var e=[].slice.call(arguments,0);return pickBy("isBefore",e)}function max(){var e=[].slice.call(arguments,0);return pickBy("isAfter",e)}var now=function(){return Date.now?Date.now():+new Date},ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(e){var t,r=!1,n,o=ordering.length;for(t in e)if(hasOwnProp(e,t)&&!(indexOf.call(ordering,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[ordering[n]]){if(r)return!1;parseFloat(e[ordering[n]])!==toInt(e[ordering[n]])&&(r=!0)}return!0}function isValid$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(e){var t=normalizeObjectUnits(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=isDurationValid(t),this._milliseconds=+c+u*1e3+l*6e4+s*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=getLocale(),this._bubble()}function isDuration(e){return e instanceof Duration}function absRound(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function compareArrays(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&toInt(e[a])!==toInt(t[a]))&&i++;return i+o}function offset$1(e,t){addFormatToken(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+zeroFill(~~(r/60),2)+t+zeroFill(~~r%60,2)})}offset$1("Z",":");offset$1("ZZ","");addRegexToken("Z",matchShortOffset);addRegexToken("ZZ",matchShortOffset);addParseToken(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=offsetFromString(matchShortOffset,e)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(chunkOffset)||["-",0,0],i=+(o[1]*60)+toInt(o[2]),i===0?0:o[0]==="+"?i:-i)}function cloneWithOffset(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(isMoment(e)||isDate(e)?e.valueOf():createLocal(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),hooks.updateOffset(r,!1),r):createLocal(e).local()}function getDateOffset(e){return-Math.round(e._d.getTimezoneOffset())}hooks.updateOffset=function(){};function getSetOffset(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=offsetFromString(matchShortOffset,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=getDateOffset(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?addSubtract(this,createDuration(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,hooks.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:getDateOffset(this)}function getSetZone(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function setOffsetToUTC(e){return this.utcOffset(0,e)}function setOffsetToLocal(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(getDateOffset(this),"m")),this}function setOffsetToParsedOffset(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=offsetFromString(matchOffset,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function hasAlignedHourOffset(e){return this.isValid()?(e=e?createLocal(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined$1(this._isDSTShifted))return this._isDSTShifted;var e={},t;return copyConfig(e,this),e=prepareConfig(e),e._a?(t=e._isUTC?createUTC(e._a):createLocal(e._a),this._isDSTShifted=this.isValid()&&compareArrays(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function isLocal(){return this.isValid()?!this._isUTC:!1}function isUtcOffset(){return this.isValid()?this._isUTC:!1}function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:!1}var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(e,t){var r=e,n=null,o,i,a;return isDuration(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:isNumber(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=aspNetRegex.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:toInt(n[DATE])*o,h:toInt(n[HOUR])*o,m:toInt(n[MINUTE])*o,s:toInt(n[SECOND])*o,ms:toInt(absRound(n[MILLISECOND]*1e3))*o}):(n=isoRegex.exec(e))?(o=n[1]==="-"?-1:1,r={y:parseIso(n[2],o),M:parseIso(n[3],o),w:parseIso(n[4],o),d:parseIso(n[5],o),h:parseIso(n[6],o),m:parseIso(n[7],o),s:parseIso(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=momentsDifference(createLocal(r.from),createLocal(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new Duration(r),isDuration(e)&&hasOwnProp(e,"_locale")&&(i._locale=e._locale),isDuration(e)&&hasOwnProp(e,"_isValid")&&(i._isValid=e._isValid),i}createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function positiveMomentsDifference(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function momentsDifference(e,t){var r;return e.isValid()&&t.isValid()?(t=cloneWithOffset(t,e),e.isBefore(t)?r=positiveMomentsDifference(e,t):(r=positiveMomentsDifference(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function createAdder(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(deprecateSimple(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=createDuration(r,n),addSubtract(this,o,e),this}}function addSubtract(e,t,r,n){var o=t._milliseconds,i=absRound(t._days),a=absRound(t._months);e.isValid()&&(n=n??!0,a&&setMonth(e,get$1(e,"Month")+a*r),i&&set$1(e,"Date",get$1(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&hooks.updateOffset(e,i||a))}var add=createAdder(1,"add"),subtract=createAdder(-1,"subtract");function isString(e){return typeof e=="string"||e instanceof String}function isMomentInput(e){return isMoment(e)||isDate(e)||isString(e)||isNumber(e)||isNumberOrStringArray(e)||isMomentInputObject(e)||e===null||e===void 0}function isMomentInputObject(e){var t=isObject$5(e)&&!isObjectEmpty(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||hasOwnProp(e,i);return t&&r}function isNumberOrStringArray(e){var t=isArray$1(e),r=!1;return t&&(r=e.filter(function(n){return!isNumber(n)&&isString(e)}).length===0),t&&r}function isCalendarSpec(e){var t=isObject$5(e)&&!isObjectEmpty(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||hasOwnProp(e,i);return t&&r}function getCalendarFormat(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function calendar$1(e,t){arguments.length===1&&(arguments[0]?isMomentInput(arguments[0])?(e=arguments[0],t=void 0):isCalendarSpec(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||createLocal(),n=cloneWithOffset(r,this).startOf("day"),o=hooks.calendarFormat(this,n)||"sameElse",i=t&&(isFunction$1(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,createLocal(r)))}function clone(){return new Moment(this)}function isAfter(e,t){var r=isMoment(e)?e:createLocal(e);return this.isValid()&&r.isValid()?(t=normalizeUnits(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function isBefore(e,t){var r=isMoment(e)?e:createLocal(e);return this.isValid()&&r.isValid()?(t=normalizeUnits(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function isBetween(e,t,r,n){var o=isMoment(e)?e:createLocal(e),i=isMoment(t)?t:createLocal(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function isSame(e,t){var r=isMoment(e)?e:createLocal(e),n;return this.isValid()&&r.isValid()?(t=normalizeUnits(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function isSameOrAfter(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function isSameOrBefore(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function diff(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=cloneWithOffset(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=normalizeUnits(t),t){case"year":i=monthDiff(this,n)/12;break;case"month":i=monthDiff(this,n);break;case"quarter":i=monthDiff(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:absFloor(i)}function monthDiff(e,t){if(e.date()<t.date())return-monthDiff(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function toString$5(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?formatMoment(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):isFunction$1(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",formatMoment(r,"Z")):formatMoment(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function format(e){e||(e=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat);var t=formatMoment(this,e);return this.localeData().postformat(t)}function from(e,t){return this.isValid()&&(isMoment(e)&&e.isValid()||createLocal(e).isValid())?createDuration({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function fromNow(e){return this.from(createLocal(),e)}function to(e,t){return this.isValid()&&(isMoment(e)&&e.isValid()||createLocal(e).isValid())?createDuration({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function toNow(e){return this.to(createLocal(),e)}function locale(e){var t;return e===void 0?this._locale._abbr:(t=getLocale(e),t!=null&&(this._locale=t),this)}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=(365*400+97)*24*MS_PER_HOUR;function mod$1(e,t){return(e%t+t)%t}function localStartOfDate(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-MS_PER_400_YEARS:new Date(e,t,r).valueOf()}function utcStartOfDate(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-MS_PER_400_YEARS:Date.UTC(e,t,r)}function startOf(e){var t,r;if(e=normalizeUnits(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?utcStartOfDate:localStartOfDate,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=mod$1(t+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":t=this._d.valueOf(),t-=mod$1(t,MS_PER_MINUTE);break;case"second":t=this._d.valueOf(),t-=mod$1(t,MS_PER_SECOND);break}return this._d.setTime(t),hooks.updateOffset(this,!0),this}function endOf(e){var t,r;if(e=normalizeUnits(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?utcStartOfDate:localStartOfDate,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=MS_PER_HOUR-mod$1(t+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":t=this._d.valueOf(),t+=MS_PER_MINUTE-mod$1(t,MS_PER_MINUTE)-1;break;case"second":t=this._d.valueOf(),t+=MS_PER_SECOND-mod$1(t,MS_PER_SECOND)-1;break}return this._d.setTime(t),hooks.updateOffset(this,!0),this}function valueOf(){return this._d.valueOf()-(this._offset||0)*6e4}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function toObject$3(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid(this)}function parsingFlags(){return extend({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}addFormatToken("N",0,0,"eraAbbr");addFormatToken("NN",0,0,"eraAbbr");addFormatToken("NNN",0,0,"eraAbbr");addFormatToken("NNNN",0,0,"eraName");addFormatToken("NNNNN",0,0,"eraNarrow");addFormatToken("y",["y",1],"yo","eraYear");addFormatToken("y",["yy",2],0,"eraYear");addFormatToken("y",["yyy",3],0,"eraYear");addFormatToken("y",["yyyy",4],0,"eraYear");addRegexToken("N",matchEraAbbr);addRegexToken("NN",matchEraAbbr);addRegexToken("NNN",matchEraAbbr);addRegexToken("NNNN",matchEraName);addRegexToken("NNNNN",matchEraNarrow);addParseToken(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?getParsingFlags(r).era=o:getParsingFlags(r).invalidEra=e});addRegexToken("y",matchUnsigned);addRegexToken("yy",matchUnsigned);addRegexToken("yyy",matchUnsigned);addRegexToken("yyyy",matchUnsigned);addRegexToken("yo",matchEraYearOrdinal);addParseToken(["y","yy","yyy","yyyy"],YEAR);addParseToken(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[YEAR]=r._locale.eraYearOrdinalParse(e,o):t[YEAR]=parseInt(e,10)});function localeEras(e,t){var r,n,o,i=this._eras||getLocale("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=hooks(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=hooks(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function localeErasParse(e,t,r){var n,o,i=this.eras(),a,s,l;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),s=i[n].abbr.toUpperCase(),l=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(s===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(l===e)return i[n];break}else if([a,s,l].indexOf(e)>=0)return i[n]}function localeErasConvertYear(e,t){var r=e.since<=e.until?1:-1;return t===void 0?hooks(e.since).year():hooks(e.since).year()+(t-e.offset)*r}function getEraName(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function getEraNarrow(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function getEraAbbr(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function getEraYear(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-hooks(o[e].since).year())*r+o[e].offset;return this.year()}function erasNameRegex(e){return hasOwnProp(this,"_erasNameRegex")||computeErasParse.call(this),e?this._erasNameRegex:this._erasRegex}function erasAbbrRegex(e){return hasOwnProp(this,"_erasAbbrRegex")||computeErasParse.call(this),e?this._erasAbbrRegex:this._erasRegex}function erasNarrowRegex(e){return hasOwnProp(this,"_erasNarrowRegex")||computeErasParse.call(this),e?this._erasNarrowRegex:this._erasRegex}function matchEraAbbr(e,t){return t.erasAbbrRegex(e)}function matchEraName(e,t){return t.erasNameRegex(e)}function matchEraNarrow(e,t){return t.erasNarrowRegex(e)}function matchEraYearOrdinal(e,t){return t._eraYearOrdinalRegex||matchUnsigned}function computeErasParse(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(regexEscape(a[o].name)),e.push(regexEscape(a[o].abbr)),r.push(regexEscape(a[o].narrow)),n.push(regexEscape(a[o].name)),n.push(regexEscape(a[o].abbr)),n.push(regexEscape(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100});addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(e,t){addFormatToken(0,[e,e.length],0,t)}addWeekYearFormatToken("gggg","weekYear");addWeekYearFormatToken("ggggg","weekYear");addWeekYearFormatToken("GGGG","isoWeekYear");addWeekYearFormatToken("GGGGG","isoWeekYear");addUnitAlias("weekYear","gg");addUnitAlias("isoWeekYear","GG");addUnitPriority("weekYear",1);addUnitPriority("isoWeekYear",1);addRegexToken("G",matchSigned);addRegexToken("g",matchSigned);addRegexToken("GG",match1to2,match2);addRegexToken("gg",match1to2,match2);addRegexToken("GGGG",match1to4,match4);addRegexToken("gggg",match1to4,match4);addRegexToken("GGGGG",match1to6,match6);addRegexToken("ggggg",match1to6,match6);addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=toInt(e)});addWeekParseToken(["gg","GG"],function(e,t,r,n){t[n]=hooks.parseTwoDigitYear(e)});function getSetWeekYear(e){return getSetWeekYearHelper.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(e){return getSetWeekYearHelper.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getISOWeeksInISOWeekYear(){return weeksInYear(this.isoWeekYear(),1,4)}function getWeeksInYear(){var e=this.localeData()._week;return weeksInYear(this.year(),e.dow,e.doy)}function getWeeksInWeekYear(){var e=this.localeData()._week;return weeksInYear(this.weekYear(),e.dow,e.doy)}function getSetWeekYearHelper(e,t,r,n,o){var i;return e==null?weekOfYear(this,n,o).year:(i=weeksInYear(e,n,o),t>i&&(t=i),setWeekAll.call(this,e,t,r,n,o))}function setWeekAll(e,t,r,n,o){var i=dayOfYearFromWeeks(e,t,r,n,o),a=createUTCDate(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}addFormatToken("Q",0,"Qo","quarter");addUnitAlias("quarter","Q");addUnitPriority("quarter",7);addRegexToken("Q",match1);addParseToken("Q",function(e,t){t[MONTH]=(toInt(e)-1)*3});function getSetQuarter(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date");addUnitAlias("date","D");addUnitPriority("date",9);addRegexToken("D",match1to2);addRegexToken("DD",match1to2,match2);addRegexToken("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});addParseToken(["D","DD"],DATE);addParseToken("Do",function(e,t){t[DATE]=toInt(e.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",!0);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear");addUnitAlias("dayOfYear","DDD");addUnitPriority("dayOfYear",4);addRegexToken("DDD",match1to3);addRegexToken("DDDD",match3);addParseToken(["DDD","DDDD"],function(e,t,r){r._dayOfYear=toInt(e)});function getSetDayOfYear(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}addFormatToken("m",["mm",2],0,"minute");addUnitAlias("minute","m");addUnitPriority("minute",14);addRegexToken("m",match1to2);addRegexToken("mm",match1to2,match2);addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second");addUnitAlias("second","s");addUnitPriority("second",15);addRegexToken("s",match1to2);addRegexToken("ss",match1to2,match2);addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",!1);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)});addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)});addFormatToken(0,["SSS",3],0,"millisecond");addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10});addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100});addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});addUnitAlias("millisecond","ms");addUnitPriority("millisecond",16);addRegexToken("S",match1to3,match1);addRegexToken("SS",match1to3,match2);addRegexToken("SSS",match1to3,match3);var token,getSetMillisecond;for(token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);function parseMs(e,t){t[MILLISECOND]=toInt(("0."+e)*1e3)}for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);getSetMillisecond=makeGetSet("Milliseconds",!1);addFormatToken("z",0,0,"zoneAbbr");addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var proto=Moment.prototype;proto.add=add;proto.calendar=calendar$1;proto.clone=clone;proto.diff=diff;proto.endOf=endOf;proto.format=format;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$2;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract;proto.toArray=toArray;proto.toObject=toObject$3;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;typeof Symbol<"u"&&Symbol.for!=null&&(proto[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});proto.toJSON=toJSON;proto.toString=toString$5;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.eraName=getEraName;proto.eraNarrow=getEraNarrow;proto.eraAbbr=getEraAbbr;proto.eraYear=getEraYear;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.weeksInWeekYear=getWeeksInWeekYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.isoWeeksInISOWeekYear=getISOWeeksInISOWeekYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth);proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth);proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear);proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone);proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);function createUnix(e){return createLocal(e*1e3)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(e){return e}var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set;proto$1.eras=localeEras;proto$1.erasParse=localeErasParse;proto$1.erasConvertYear=localeErasConvertYear;proto$1.erasAbbrRegex=erasAbbrRegex;proto$1.erasNameRegex=erasNameRegex;proto$1.erasNarrowRegex=erasNarrowRegex;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1$1(e,t,r,n){var o=getLocale(),i=createUTC().set(n,t);return o[r](i,e)}function listMonthsImpl(e,t,r){if(isNumber(e)&&(t=e,e=void 0),e=e||"",t!=null)return get$1$1(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=get$1$1(e,n,r,"month");return o}function listWeekdaysImpl(e,t,r,n){typeof e=="boolean"?(isNumber(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,isNumber(t)&&(r=t,t=void 0),t=t||"");var o=getLocale(),i=e?o._week.dow:0,a,s=[];if(r!=null)return get$1$1(t,(r+i)%7,n,"day");for(a=0;a<7;a++)s[a]=get$1$1(t,(a+i)%7,n,"day");return s}function listMonths(e,t){return listMonthsImpl(e,t,"months")}function listMonthsShort(e,t){return listMonthsImpl(e,t,"monthsShort")}function listWeekdays(e,t,r){return listWeekdaysImpl(e,t,r,"weekdays")}function listWeekdaysShort(e,t,r){return listWeekdaysImpl(e,t,r,"weekdaysShort")}function listWeekdaysMin(e,t,r){return listWeekdaysImpl(e,t,r,"weekdaysMin")}getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=toInt(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale);hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs(){var e=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),e.milliseconds=mathAbs(e.milliseconds),e.seconds=mathAbs(e.seconds),e.minutes=mathAbs(e.minutes),e.hours=mathAbs(e.hours),e.months=mathAbs(e.months),e.years=mathAbs(e.years),this}function addSubtract$1(e,t,r,n){var o=createDuration(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function add$1(e,t){return addSubtract$1(this,e,t,1)}function subtract$1(e,t){return addSubtract$1(this,e,t,-1)}function absCeil(e){return e<0?Math.floor(e):Math.ceil(e)}function bubble(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,s,l;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=absCeil(monthsToDays(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=absFloor(e/1e3),n.seconds=o%60,i=absFloor(o/60),n.minutes=i%60,a=absFloor(i/60),n.hours=a%24,t+=absFloor(a/24),l=absFloor(daysToMonths(t)),r+=l,t-=absCeil(monthsToDays(l)),s=absFloor(r/12),r%=12,n.days=t,n.months=r,n.years=s,this}function daysToMonths(e){return e*4800/146097}function monthsToDays(e){return e*146097/4800}function as(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=normalizeUnits(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+daysToMonths(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(monthsToDays(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function valueOf$1(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+toInt(this._months/12)*31536e6:NaN}function makeAs(e){return function(){return this.as(e)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y");function clone$1(){return createDuration(this)}function get$2(e){return e=normalizeUnits(e),this.isValid()?this[e+"s"]():NaN}function makeGetter(e){return function(){return this.isValid()?this._data[e]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function substituteTimeAgo(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function relativeTime$1(e,t,r,n){var o=createDuration(e).abs(),i=round(o.as("s")),a=round(o.as("m")),s=round(o.as("h")),l=round(o.as("d")),u=round(o.as("M")),c=round(o.as("w")),f=round(o.as("y")),d=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||s<=1&&["h"]||s<r.h&&["hh",s]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||f<=1&&["y"]||["yy",f],d[2]=t,d[3]=+e>0,d[4]=n,substituteTimeAgo.apply(null,d)}function getSetRelativeTimeRounding(e){return e===void 0?round:typeof e=="function"?(round=e,!0):!1}function getSetRelativeTimeThreshold(e,t){return thresholds[e]===void 0?!1:t===void 0?thresholds[e]:(thresholds[e]=t,e==="s"&&(thresholds.ss=t-1),!0)}function humanize(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=thresholds,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},thresholds,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=relativeTime$1(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var abs$1=Math.abs;function sign(e){return(e>0)-(e<0)||+e}function toISOString$1(){if(!this.isValid())return this.localeData().invalidDate();var e=abs$1(this._milliseconds)/1e3,t=abs$1(this._days),r=abs$1(this._months),n,o,i,a,s=this.asSeconds(),l,u,c,f;return s?(n=absFloor(e/60),o=absFloor(n/60),e%=60,n%=60,i=absFloor(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=s<0?"-":"",u=sign(this._months)!==sign(s)?"-":"",c=sign(this._days)!==sign(s)?"-":"",f=sign(this._milliseconds)!==sign(s)?"-":"",l+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?c+t+"D":"")+(o||n||e?"T":"")+(o?f+o+"H":"")+(n?f+n+"M":"")+(e?f+a+"S":"")):"P0D"}var proto$2=Duration.prototype;proto$2.isValid=isValid$1;proto$2.abs=abs;proto$2.add=add$1;proto$2.subtract=subtract$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asQuarters=asQuarters;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$1;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1);proto$2.lang=lang;addFormatToken("X",0,0,"unix");addFormatToken("x",0,0,"valueOf");addRegexToken("x",matchSigned);addRegexToken("X",matchTimestamp);addParseToken("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});addParseToken("x",function(e,t,r){r._d=new Date(toInt(e))});//! moment.js
hooks.version="2.29.4";setHookCallback(createLocal);hooks.fn=proto;hooks.min=min$3;hooks.max=max;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const moment=Object.freeze(Object.defineProperty({__proto__:null,default:hooks},Symbol.toStringTag,{value:"Module"}));function toSingleLine(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=arrayReduce$1(e,function(i,a,s){var l=a.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return i+l+u},"");return o.trim()}var _templateObject$i,_templateObject2$4,_templateObject3$1,_templateObject4$1,_templateObject5,_templateObject6;function _taggedTemplateLiteral$i(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _typeof$32(e){return _typeof$32=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$32(e)}function stringify$1(e){var t;switch(_typeof$32(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function isDefined(e){return typeof e<"u"}function isUndefined(e){return typeof e>"u"}function isEmpty(e){return e===null||e===""||isUndefined(e)}function isRegExp(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var _m="length",_hd=function(t){return parseInt(t,16)},_pi=function(t){return parseInt(t,10)},_ss=function(t,r,n){return t.substr(r,n)},_cp=function(t){return t.codePointAt(0)-65},_norm=function(t){return"".concat(t).replace(/\-/g,"")},_extractTime=function(t){return _hd(_ss(_norm(t),_hd("12"),_cp("F")))/(_hd(_ss(_norm(t),_cp("B"),~~![][_m]))||9)},_ignored=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},_notified=!1,consoleMessages={invalid:function(){return toSingleLine(_templateObject$i||(_templateObject$i=_taggedTemplateLiteral$i([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return toSingleLine(_templateObject2$4||(_templateObject2$4=_taggedTemplateLiteral$i([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return toSingleLine(_templateObject3$1||(_templateObject3$1=_taggedTemplateLiteral$i([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},domMessages={invalid:function(){return toSingleLine(_templateObject4$1||(_templateObject4$1=_taggedTemplateLiteral$i([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return toSingleLine(_templateObject5||(_templateObject5=_taggedTemplateLiteral$i([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return toSingleLine(_templateObject6||(_templateObject6=_taggedTemplateLiteral$i([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function _injectProductInfo(e,t){var r=!isEmpty(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="12.3.1",i,a="invalid",s="invalid";e=_norm(e||"");var l=_checkKeySchema(e);if(r||n||l)if(l){var u=hooks("06/02/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=_extractTime(e);i=hooks((f+1)*864e5,"x").format("MMMM DD, YYYY"),c>f?(a="expired",s="expired"):(a="valid",s="valid")}else n?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if(_ignored()&&(a="valid",s="valid"),!_notified&&a!=="valid"){var d=consoleMessages[a]({keyValidityDate:i,hotVersion:o});d&&console[a==="non_commercial"?"info":"warn"](consoleMessages[a]({keyValidityDate:i,hotVersion:o})),_notified=!0}if(s!=="valid"&&t.parentNode){var h=domMessages[s]({keyValidityDate:i,hotVersion:o});if(h){var y=document.createElement("div");y.className="hot-display-license-info",y.innerHTML=domMessages[s]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(y,t.nextSibling)}}}function _checkKeySchema(e){var t=[][_m],r=t;if(e[_m]!==_cp("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=_cp(o.shift());i;i=_cp(o.shift()||"A"))--i<""[_m]?r=r|(_pi("".concat(_pi(_hd(n)+(_hd(_ss(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=_ss(e,i,i?o[_m]===1?9:8:6);return r===t}const mixedHelpers=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo,isDefined,isEmpty,isRegExp,isUndefined,stringify:stringify$1},Symbol.toStringTag,{value:"Module"}));function toUpperCaseFirst(e){return e[0].toUpperCase()+e.substr(1)}function equalsIgnoreCase(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var o=r.length;o;){o-=1;var i=stringify$1(r[o]).toLowerCase();e.indexOf(i)===-1&&e.push(i)}return e.length===1}function randomString(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function isPercentValue(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function substitute(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function stripTags(e){return sanitize("".concat(e),{ALLOWED_TAGS:[]})}function sanitize(e,t){return purify.sanitize(e,t)}const stringHelpers=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase,isPercentValue,randomString,sanitize,stripTags,substitute,toUpperCaseFirst},Symbol.toStringTag,{value:"Module"}));function _toConsumableArray$B(e){return _arrayWithoutHoles$B(e)||_iterableToArray$D(e)||_unsupportedIterableToArray$1d(e)||_nonIterableSpread$B()}function _nonIterableSpread$B(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1d(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$1d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$1d(e,t)}}function _iterableToArray$D(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$B(e){if(Array.isArray(e))return _arrayLikeToArray$1d(e)}function _arrayLikeToArray$1d(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function getParent(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function getFrameElement(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function getParentWindow(e){return getFrameElement(e)&&e.parent}function hasAccessToParentWindow(e){return!!Object.getPrototypeOf(e.parent)}function closest(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var s=a,l=s.nodeType,u=s.nodeName;if(l===o&&(t.includes(u)||t.includes(a)))return a;var c=a,f=c.host;f&&l===i?a=f:a=a.parentNode}return null}function closestDown(e,t,r){for(var n=[],o=e;o&&(o=closest(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function isChildOf(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function index(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function overlayContainsElement(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var _hasClass,_addClass,_removeClass;function filterEmptyClassNames(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(isClassListSupported()){var isSupportMultipleClassesArg=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};_hasClass=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},_addClass=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=filterEmptyClassNames(o),o.length>0)if(isSupportMultipleClassesArg(n)){var i;(i=t.classList).add.apply(i,_toConsumableArray$B(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},_removeClass=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=filterEmptyClassNames(o),o.length>0)if(isSupportMultipleClassesArg(n)){var i;(i=t.classList).remove.apply(i,_toConsumableArray$B(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var createClassNameRegExp=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};_hasClass=function(t,r){return t.className!==void 0&&createClassNameRegExp(r).test(t.className)},_addClass=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=filterEmptyClassNames(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!createClassNameRegExp(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},_removeClass=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=filterEmptyClassNames(i);i[n];)o=o.replace(createClassNameRegExp(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function hasClass(e,t){return _hasClass(e,t)}function addClass(e,t){_addClass(e,t)}function removeClass(e,t){_removeClass(e,t)}function removeTextNodes(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)removeTextNodes(t[r])}function empty(e){for(var t;t=e.lastChild;)e.removeChild(t)}var HTML_CHARACTERS=/(<(.*)>|&(.*);)/;function fastInnerHTML(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;HTML_CHARACTERS.test(t)?e.innerHTML=r?sanitize(t):t:fastInnerText(e,t)}function fastInnerText(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?isTextContentSupported?r.textContent=t:r.data=t:(empty(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function isVisible(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return isVisible(r.host.impl);if(r.host)return isVisible(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function offset(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,s,l;if(hasCaptionProblem()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return l=o.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,s=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,s=o;return s&&s.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function getWindowScrollTop(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function getWindowScrollLeft(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function getScrollTop(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?getWindowScrollTop(t):e.scrollTop}function getScrollLeft(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?getWindowScrollLeft(t):e.scrollLeft}function getScrollableElement(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=isGetComputedStyleSupported(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,s=a.overflow,l=a.overflowX,u=a.overflowY;if([s,l,u].includes("scroll"))return i;if(o){var c=r.getComputedStyle(i);if(s=c.overflow,l=c.overflowX,u=c.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(l)||n.includes(s)))return i;i=i.parentNode}return r}function getTrimmingContainer(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=getComputedStyle(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),s=o.getPropertyValue("overflow-y"),l=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(s)||i.includes(l))return n;n=n.parentNode}return r}function getStyle(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=getComputedStyle(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function matchesCSSRules(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function getComputedStyle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function outerWidth(e){return e.offsetWidth}function outerHeight(e){return hasCaptionProblem()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function innerHeight(e){return e.clientHeight||e.innerHeight}function innerWidth(e){return e.clientWidth||e.innerWidth}function addEvent(e,t,r){e.addEventListener(t,r,!1)}function removeEvent(e,t,r){e.removeEventListener(t,r,!1)}function getCaretPosition(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function getSelectionEndPosition(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function getSelectionText(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function clearTextSelection(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function setCaretPosition(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var cachedScrollbarWidth;function walkontableCalculateScrollbarWidth(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function getScrollbarWidth(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return cachedScrollbarWidth===void 0&&(cachedScrollbarWidth=walkontableCalculateScrollbarWidth(e)),cachedScrollbarWidth}function hasVerticalScrollbar(e){return e.offsetWidth!==e.clientWidth}function hasHorizontalScrollbar(e){return e.offsetHeight!==e.clientHeight}function setOverlayPosition(e,t,r){isIE9()?(e.style.top=r,e.style.left=t):isSafari()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function getCssTransform(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function resetCssTransform(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function isInput(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function isOutsideInput(e){return isInput(e)&&e.hasAttribute("data-hot-input")===!1}function selectElementIfAllowed(e){var t=e.ownerDocument.activeElement;isOutsideInput(t)||e.select()}function isDetached(e){return!e.parentNode}function observeVisibilityChangeOnce(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const domHelpers=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS,addClass,addEvent,clearTextSelection,closest,closestDown,empty,fastInnerHTML,fastInnerText,getCaretPosition,getComputedStyle,getCssTransform,getFrameElement,getParent,getParentWindow,getScrollLeft,getScrollTop,getScrollableElement,getScrollbarWidth,getSelectionEndPosition,getSelectionText,getStyle,getTrimmingContainer,getWindowScrollLeft,getWindowScrollTop,hasAccessToParentWindow,hasClass,hasHorizontalScrollbar,hasVerticalScrollbar,index,innerHeight,innerWidth,isChildOf,isDetached,isInput,isOutsideInput,isVisible,matchesCSSRules,observeVisibilityChangeOnce,offset,outerHeight,outerWidth,overlayContainsElement,removeClass,removeEvent,removeTextNodes,resetCssTransform,selectElementIfAllowed,setCaretPosition,setOverlayPosition},Symbol.toStringTag,{value:"Module"}));function isFunction(e){return typeof e=="function"}function throttle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},o=null;function i(){for(var a=this,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var c=Date.now(),f=!1;n.lastCallThrottled=!0,r||(r=c,f=!0);var d=t-(c-r);return f?(n.lastCallThrottled=!1,e.apply(this,l)):(o&&clearTimeout(o),o=setTimeout(function(){n.lastCallThrottled=!1,e.apply(a,l),r=0,o=void 0},d)),n}return i}function throttleAfterHits(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=throttle(e,t),o=r;function i(){o=r}function a(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return o?(o-=1,e.apply(this,l)):n.apply(this,l)}return a.clearHits=i,a}function debounce(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,s)},t),n}return o}function pipe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t.slice(1);return function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return arrayReduce$1(o,function(u,c){return c(u)},n.apply(this,s))}}function partial(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return e.apply(this,r.concat(a))}}function curry(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var l=n.concat(a),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function curryRight(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var l=n.concat(a.reverse()),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function fastCall(e,t,r,n,o,i,a,s){return isDefined(s)?e.call(t,r,n,o,i,a,s):isDefined(a)?e.call(t,r,n,o,i,a):isDefined(i)?e.call(t,r,n,o,i):isDefined(o)?e.call(t,r,n,o):isDefined(n)?e.call(t,r,n):isDefined(r)?e.call(t,r):e.call(t)}const functionHelpers=Object.freeze(Object.defineProperty({__proto__:null,curry,curryRight,debounce,fastCall,isFunction,partial,pipe,throttle,throttleAfterHits},Symbol.toStringTag,{value:"Module"}));function warn(){if(isDefined(console)){var e;(e=console).warn.apply(e,arguments)}}function error(){if(isDefined(console)){var e;(e=console).error.apply(e,arguments)}}var uncurryThis$8=functionUncurryThis,defineBuiltIns$1=defineBuiltIns$3,getWeakData=internalMetadataExports.getWeakData,anInstance=anInstance$3,anObject$4=anObject$m,isNullOrUndefined$2=isNullOrUndefined$b,isObject$4=isObject$n,iterate=iterate$3,ArrayIterationModule=arrayIteration,hasOwn$2=hasOwnProperty_1,InternalStateModule=internalState,setInternalState=InternalStateModule.set,internalStateGetterFor=InternalStateModule.getterFor,find=ArrayIterationModule.find,findIndex=ArrayIterationModule.findIndex,splice=uncurryThis$8([].splice),id=0,uncaughtFrozenStore=function(e){return e.frozen||(e.frozen=new UncaughtFrozenStore)},UncaughtFrozenStore=function(){this.entries=[]},findUncaughtFrozen=function(e,t){return find(e.entries,function(r){return r[0]===t})};UncaughtFrozenStore.prototype={get:function(e){var t=findUncaughtFrozen(this,e);if(t)return t[1]},has:function(e){return!!findUncaughtFrozen(this,e)},set:function(e,t){var r=findUncaughtFrozen(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=findIndex(this.entries,function(r){return r[0]===e});return~t&&splice(this.entries,t,1),!!~t}};var collectionWeak$2={getConstructor:function(e,t,r,n){var o=e(function(l,u){anInstance(l,i),setInternalState(l,{type:t,id:id++,frozen:void 0}),isNullOrUndefined$2(u)||iterate(u,l[n],{that:l,AS_ENTRIES:r})}),i=o.prototype,a=internalStateGetterFor(t),s=function(l,u,c){var f=a(l),d=getWeakData(anObject$4(u),!0);return d===!0?uncaughtFrozenStore(f).set(u,c):d[f.id]=c,l};return defineBuiltIns$1(i,{delete:function(l){var u=a(this);if(!isObject$4(l))return!1;var c=getWeakData(l);return c===!0?uncaughtFrozenStore(u).delete(l):c&&hasOwn$2(c,u.id)&&delete c[u.id]},has:function(u){var c=a(this);if(!isObject$4(u))return!1;var f=getWeakData(u);return f===!0?uncaughtFrozenStore(c).has(u):f&&hasOwn$2(f,c.id)}}),defineBuiltIns$1(i,r?{get:function(u){var c=a(this);if(isObject$4(u)){var f=getWeakData(u);return f===!0?uncaughtFrozenStore(c).get(u):f?f[c.id]:void 0}},set:function(u,c){return s(this,u,c)}}:{add:function(u){return s(this,u,!0)}}),o}},FREEZING=freezing,global$1=global$s,uncurryThis$7=functionUncurryThis,defineBuiltIns=defineBuiltIns$3,InternalMetadataModule=internalMetadataExports,collection$2=collection$5,collectionWeak$1=collectionWeak$2,isObject$3=isObject$n,enforceInternalState=internalState.enforce,fails$6=fails$I,NATIVE_WEAK_MAP=weakMapBasicDetection,$Object=Object,isArray=Array.isArray,isExtensible=$Object.isExtensible,isFrozen=$Object.isFrozen,isSealed=$Object.isSealed,freeze=$Object.freeze,seal=$Object.seal,FROZEN={},SEALED={},IS_IE11=!global$1.ActiveXObject&&"ActiveXObject"in global$1,InternalWeakMap,wrapper=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},$WeakMap=collection$2("WeakMap",wrapper,collectionWeak$1),WeakMapPrototype=$WeakMap.prototype,nativeSet=uncurryThis$7(WeakMapPrototype.set),hasMSEdgeFreezingBug=function(){return FREEZING&&fails$6(function(){var e=freeze([]);return nativeSet(new $WeakMap,e,1),!isFrozen(e)})};if(NATIVE_WEAK_MAP)if(IS_IE11){InternalWeakMap=collectionWeak$1.getConstructor(wrapper,"WeakMap",!0),InternalMetadataModule.enable();var nativeDelete=uncurryThis$7(WeakMapPrototype.delete),nativeHas=uncurryThis$7(WeakMapPrototype.has),nativeGet=uncurryThis$7(WeakMapPrototype.get);defineBuiltIns(WeakMapPrototype,{delete:function(e){if(isObject$3(e)&&!isExtensible(e)){var t=enforceInternalState(this);return t.frozen||(t.frozen=new InternalWeakMap),nativeDelete(this,e)||t.frozen.delete(e)}return nativeDelete(this,e)},has:function(t){if(isObject$3(t)&&!isExtensible(t)){var r=enforceInternalState(this);return r.frozen||(r.frozen=new InternalWeakMap),nativeHas(this,t)||r.frozen.has(t)}return nativeHas(this,t)},get:function(t){if(isObject$3(t)&&!isExtensible(t)){var r=enforceInternalState(this);return r.frozen||(r.frozen=new InternalWeakMap),nativeHas(this,t)?nativeGet(this,t):r.frozen.get(t)}return nativeGet(this,t)},set:function(t,r){if(isObject$3(t)&&!isExtensible(t)){var n=enforceInternalState(this);n.frozen||(n.frozen=new InternalWeakMap),nativeHas(this,t)?nativeSet(this,t,r):n.frozen.set(t,r)}else nativeSet(this,t,r);return this}})}else hasMSEdgeFreezingBug()&&defineBuiltIns(WeakMapPrototype,{set:function(t,r){var n;return isArray(t)&&(isFrozen(t)?n=FROZEN:isSealed(t)&&(n=SEALED)),nativeSet(this,t,r),n==FROZEN&&freeze(t),n==SEALED&&seal(t),this}});var KEY_CODES={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:isFirefox()?182:174,AUDIO_MUTE:isFirefox()?181:173,AUDIO_UP:isFirefox()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},FUNCTION_KEYS=[KEY_CODES.ALT,KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_LEFT,KEY_CODES.ARROW_RIGHT,KEY_CODES.ARROW_UP,KEY_CODES.AUDIO_DOWN,KEY_CODES.AUDIO_MUTE,KEY_CODES.AUDIO_UP,KEY_CODES.BACKSPACE,KEY_CODES.CAPS_LOCK,KEY_CODES.DELETE,KEY_CODES.END,KEY_CODES.ENTER,KEY_CODES.ESCAPE,KEY_CODES.F1,KEY_CODES.F2,KEY_CODES.F3,KEY_CODES.F4,KEY_CODES.F5,KEY_CODES.F6,KEY_CODES.F7,KEY_CODES.F8,KEY_CODES.F9,KEY_CODES.F10,KEY_CODES.F11,KEY_CODES.F12,KEY_CODES.F13,KEY_CODES.F14,KEY_CODES.F15,KEY_CODES.F16,KEY_CODES.F17,KEY_CODES.F18,KEY_CODES.F19,KEY_CODES.HOME,KEY_CODES.INSERT,KEY_CODES.MEDIA_NEXT,KEY_CODES.MEDIA_PLAY_PAUSE,KEY_CODES.MEDIA_PREV,KEY_CODES.MEDIA_STOP,KEY_CODES.NULL,KEY_CODES.NUM_LOCK,KEY_CODES.PAGE_DOWN,KEY_CODES.PAGE_UP,KEY_CODES.PAUSE,KEY_CODES.SCROLL_LOCK,KEY_CODES.SHIFT,KEY_CODES.TAB];function isPrintableChar(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function isFunctionKey(e){return FUNCTION_KEYS.includes(e)}function isCtrlKey(e){var t=[];return isMacOS()?t.push(KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX):t.push(KEY_CODES.CONTROL),t.includes(e)}function isCtrlMetaKey(e){return[KEY_CODES.CONTROL,KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX].includes(e)}function isKey(e,t){var r=t.split("|"),n=!1;return arrayEach(r,function(o){if(e===KEY_CODES[o])return n=!0,!1}),n}const unicodeHelpers=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES,isCtrlKey,isCtrlMetaKey,isFunctionKey,isKey,isPrintableChar},Symbol.toStringTag,{value:"Module"}));function stopImmediatePropagation(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function isImmediatePropagationStopped(e){return e.isImmediatePropagationEnabled===!1}function isRightClick(e){return e.button===2}function isLeftClick(e){return e.button===0}const domEventHelpers=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped,isLeftClick,isRightClick,stopImmediatePropagation},Symbol.toStringTag,{value:"Module"}));function _typeof$31(e){return _typeof$31=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$31(e)}var _templateObject$h;function _classCallCheck$2K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2W(n.key),n)}}function _createClass$2K(e,t,r){return t&&_defineProperties$2K(e.prototype,t),r&&_defineProperties$2K(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2W(e){var t=_toPrimitive$2W(e,"string");return _typeof$31(t)==="symbol"?t:String(t)}function _toPrimitive$2W(e,t){if(_typeof$31(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$31(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _taggedTemplateLiteral$h(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var REGISTERED_HOOKS=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],REMOVED_MESSAGE=toSingleLine(_templateObject$h||(_templateObject$h=_taggedTemplateLiteral$h([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),REMOVED_HOOKS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),DEPRECATED_HOOKS=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),Hooks=function(){function e(){_classCallCheck$2K(this,e),this.globalBucket=this.createEmptyBucket()}return _createClass$2K(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return arrayEach(REGISTERED_HOOKS,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))arrayEach(n,function(l){return o.add(r,l,i)});else{REMOVED_HOOKS.has(r)&&warn(substitute(REMOVED_MESSAGE,{hookName:r,removedInVersion:REMOVED_HOOKS.get(r)})),DEPRECATED_HOOKS.has(r)&&warn(DEPRECATED_HOOKS.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var s=!1;n.initialHook&&arrayEach(a[r],function(l,u){if(l.initialHook)return a[r][u]=n,s=!0,!1}),s||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?arrayEach(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,s,l,u){{var c=this.globalBucket[n],f=c?c.length:0,d=0;if(f)for(;d<f;){if(!c[d]||c[d].skip){d+=1;continue}var h=fastCall(c[d],r,o,i,a,s,l,u);h!==void 0&&(o=h),c[d]&&c[d].runOnce&&this.remove(n,c[d]),d+=1}}{var y=this.getBucket(r)[n],p=y?y.length:0,v=0;if(p)for(;v<p;){if(!y[v]||y[v].skip){v+=1;continue}var b=fastCall(y[v],r,o,i,a,s,l,u);b!==void 0&&(o=b),y[v]&&y[v].runOnce&&this.remove(n,y[v],r),v+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;objectEach(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||REGISTERED_HOOKS.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return DEPRECATED_HOOKS.has(r)||REMOVED_HOOKS.has(r)}},{key:"isRegistered",value:function(r){return REGISTERED_HOOKS.indexOf(r)>=0}},{key:"getRegistered",value:function(){return REGISTERED_HOOKS}}],[{key:"getSingleton",value:function(){return getGlobalSingleton()}}]),e}(),globalSingleton=new Hooks;function getGlobalSingleton(){return globalSingleton}const Hooks$1=Hooks;function _toConsumableArray$A(e){return _arrayWithoutHoles$A(e)||_iterableToArray$C(e)||_unsupportedIterableToArray$1c(e)||_nonIterableSpread$A()}function _nonIterableSpread$A(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1c(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$1c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$1c(e,t)}}function _iterableToArray$C(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$A(e){if(Array.isArray(e))return _arrayLikeToArray$1c(e)}function _arrayLikeToArray$1c(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var collection$1=new Map;function staticRegister(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";collection$1.has(e)||collection$1.set(e,new Map);var t=collection$1.get(e);function r(s,l){t.set(s,l)}function n(s){return t.get(s)}function o(s){return t.has(s)}function i(){return _toConsumableArray$A(t.keys())}function a(){return _toConsumableArray$A(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var registeredEditorClasses=new WeakMap,_staticRegister$7=staticRegister("editors"),register$5=_staticRegister$7.register,getItem$4=_staticRegister$7.getItem,hasItem$3=_staticRegister$7.hasItem,getNames$3=_staticRegister$7.getNames;_staticRegister$7.getValues;function RegisteredEditor(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},Hooks$1.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function _getEditorInstance(e,t){var r;if(typeof e=="function")registeredEditorClasses.get(e)||_register$3(null,e),r=registeredEditorClasses.get(e);else if(typeof e=="string")r=getItem$4(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function _getItem$3(e){if(typeof e=="function")return e;if(!hasItem$3(e))throw Error('No registered editor found under "'.concat(e,'" name'));return getItem$4(e).getConstructor()}function _register$3(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new RegisteredEditor(t);typeof e=="string"&&register$5(e,r),registeredEditorClasses.set(t,r)}function _typeof$30(e){return _typeof$30=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$30(e)}function _classCallCheck$2J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2V(n.key),n)}}function _createClass$2J(e,t,r){return t&&_defineProperties$2J(e.prototype,t),r&&_defineProperties$2J(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2V(e){var t=_toPrimitive$2V(e,"string");return _typeof$30(t)==="symbol"?t:String(t)}function _toPrimitive$2V(e,t){if(_typeof$30(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$30(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var listenersCounter=0,EventManager=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_classCallCheck$2J(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return _createClass$2J(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(l){o.call(this,extendEvent(l))}return typeof a!="boolean"&&!isPassiveEventSupported()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:s,options:a,eventManager:this}),r.addEventListener(n,s,a),listenersCounter+=1,function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,s;a;)if(a-=1,s=this.context.eventListeners[a],s.event===n&&s.element===r){if(o&&o!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(a,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),listenersCounter-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),listenersCounter-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;o.createEvent?(s=o.createEvent("MouseEvents"),s.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):s=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(s):r.fireEvent("on".concat(n),s)}}]),e}();function extendEvent(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),stopImmediatePropagation(this)},e}const EventManager$1=EventManager;function getListenersCounter(){return listenersCounter}function _typeof$2$(e){return _typeof$2$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2$(e)}function _slicedToArray$M(e,t){return _arrayWithHoles$O(e)||_iterableToArrayLimit$M(e,t)||_unsupportedIterableToArray$1b(e,t)||_nonIterableRest$O()}function _nonIterableRest$O(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1b(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$1b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$1b(e,t)}}function _arrayLikeToArray$1b(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$M(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$O(e){if(Array.isArray(e))return e}function _classCallCheck$2I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2U(n.key),n)}}function _createClass$2I(e,t,r){return t&&_defineProperties$2I(e.prototype,t),r&&_defineProperties$2I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2U(e){var t=_toPrimitive$2U(e,"string");return _typeof$2$(t)==="symbol"?t:String(t)}function _toPrimitive$2U(e,t){if(_typeof$2$(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2$(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SHORTCUTS_GROUP_NAVIGATION="editorManager.navigation",SHORTCUTS_GROUP_EDITOR$2="editorManager.handlingEditor",EditorManager=function(){function e(t,r,n){var o=this;_classCallCheck$2I(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new EventManager$1(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,s,l){return o.onCellDblClick(a,s,l)})}return _createClass$2I(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:SHORTCUTS_GROUP_EDITOR$2};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(l,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(l){r.openEditor(null,l,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(l,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,l,!0):r.moveSelectionAfterEnter(u.includes("shift")),stopImmediatePropagation(l)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(p){p&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),s=o,l=i;if(Array.isArray(a)){var u=_slicedToArray$M(a,2);s=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(s,l);var c=this.instance.rootDocument.activeElement;if(c&&isOutsideInput(c)&&c.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var f=this.instance.getCell(o,i,!0);if(f){var d=this.instance.getCellEditor(this.cellProperties),h=this.instance.colToProp(l),y=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),l);this.activeEditor=_getEditorInstance(d,this.instance),this.activeEditor.prepare(o,i,h,f,y,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,s=i.col,l=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(s);this.instance.view.scrollViewport(this.instance._createCellCoords(l,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,s=a.rowIndexMapper,l=a.columnIndexMapper,u=s.isHidden(this.instance.toPhysicalRow(o))||l.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!isFunctionKey(o)&&!isCtrlMetaKey(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),s=a.getContext("editor"),l={runOnlyIf:function(){return isDefined(n.instance.getSelected())},group:SHORTCUTS_GROUP_NAVIGATION};s.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],l),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),instances=new WeakMap;EditorManager.getInstance=function(e,t,r){var n=instances.get(e);return n||(n=new EditorManager(e,t,r),instances.set(e,n)),n};const EditorManager$1=EditorManager;var $$f=_export,toObject$2=toObject$f,nativeKeys=objectKeys$4,fails$5=fails$I,FAILS_ON_PRIMITIVES=fails$5(function(){nativeKeys(1)});$$f({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES},{keys:function(t){return nativeKeys(toObject$2(t))}});var call$3=functionCall,fixRegExpWellKnownSymbolLogic$1=fixRegexpWellKnownSymbolLogic,anObject$3=anObject$m,isNullOrUndefined$1=isNullOrUndefined$b,toLength$2=toLength$7,toString$4=toString$l,requireObjectCoercible$4=requireObjectCoercible$e,getMethod$1=getMethod$7,advanceStringIndex=advanceStringIndex$3,regExpExec$1=regexpExecAbstract;fixRegExpWellKnownSymbolLogic$1("match",function(e,t,r){return[function(o){var i=requireObjectCoercible$4(this),a=isNullOrUndefined$1(o)?void 0:getMethod$1(o,e);return a?call$3(a,o,i):new RegExp(o)[e](toString$4(i))},function(n){var o=anObject$3(this),i=toString$4(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return regExpExec$1(o,i);var s=o.unicode;o.lastIndex=0;for(var l=[],u=0,c;(c=regExpExec$1(o,i))!==null;){var f=toString$4(c[0]);l[u]=f,f===""&&(o.lastIndex=advanceStringIndex(i,toLength$2(o.lastIndex),s)),u++}return u===0?null:l}]});var apply$1=functionApply,toIndexedObject$3=toIndexedObject$d,toIntegerOrInfinity$1=toIntegerOrInfinity$8,lengthOfArrayLike$1=lengthOfArrayLike$c,arrayMethodIsStrict$1=arrayMethodIsStrict$6,min$2=Math.min,$lastIndexOf=[].lastIndexOf,NEGATIVE_ZERO=!!$lastIndexOf&&1/[1].lastIndexOf(1,-0)<0,STRICT_METHOD=arrayMethodIsStrict$1("lastIndexOf"),FORCED$4=NEGATIVE_ZERO||!STRICT_METHOD,arrayLastIndexOf=FORCED$4?function(t){if(NEGATIVE_ZERO)return apply$1($lastIndexOf,this,arguments)||0;var r=toIndexedObject$3(this),n=lengthOfArrayLike$1(r),o=n-1;for(arguments.length>1&&(o=min$2(o,toIntegerOrInfinity$1(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:$lastIndexOf,$$e=_export,lastIndexOf=arrayLastIndexOf;$$e({target:"Array",proto:!0,forced:lastIndexOf!==[].lastIndexOf},{lastIndexOf});var aCallable$1=aCallable$7,toObject$1=toObject$f,IndexedObject$1=indexedObject,lengthOfArrayLike=lengthOfArrayLike$c,$TypeError=TypeError,createMethod$1=function(e){return function(t,r,n,o){aCallable$1(r);var i=toObject$1(t),a=IndexedObject$1(i),s=lengthOfArrayLike(i),l=e?s-1:0,u=e?-1:1;if(n<2)for(;;){if(l in a){o=a[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw $TypeError("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in a&&(o=r(o,a[l],l,i));return o}},arrayReduce={left:createMethod$1(!1),right:createMethod$1(!0)},$$d=_export,$reduce=arrayReduce.left,arrayMethodIsStrict=arrayMethodIsStrict$6,CHROME_VERSION=engineV8Version,IS_NODE=engineIsNode,CHROME_BUG=!IS_NODE&&CHROME_VERSION>79&&CHROME_VERSION<83,FORCED$3=CHROME_BUG||!arrayMethodIsStrict("reduce");$$d({target:"Array",proto:!0,forced:FORCED$3},{reduce:function(t){var r=arguments.length;return $reduce(this,t,r,r>1?arguments[1]:void 0)}});var $$c=_export,$findIndex=arrayIteration.findIndex,addToUnscopables$1=addToUnscopables$5,FIND_INDEX="findIndex",SKIPS_HOLES$1=!0;FIND_INDEX in[]&&Array(1)[FIND_INDEX](function(){SKIPS_HOLES$1=!1});$$c({target:"Array",proto:!0,forced:SKIPS_HOLES$1},{findIndex:function(t){return $findIndex(this,t,arguments.length>1?arguments[1]:void 0)}});addToUnscopables$1(FIND_INDEX);function _toConsumableArray$z(e){return _arrayWithoutHoles$z(e)||_iterableToArray$B(e)||_unsupportedIterableToArray$1a(e)||_nonIterableSpread$z()}function _nonIterableSpread$z(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1a(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$1a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$1a(e,t)}}function _iterableToArray$B(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$z(e){if(Array.isArray(e))return _arrayLikeToArray$1a(e)}function _arrayLikeToArray$1a(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ESCAPED_HTML_CHARS={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},regEscapedChars=new RegExp(Object.keys(ESCAPED_HTML_CHARS).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function isHTMLTable(e){return(e&&e.nodeName||"")==="TABLE"}function instanceToHTML(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,s=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,f=t?1:0,d=0;d<i;d+=1){for(var h=t&&d===0,y=[],p=0;p<a;p+=1){var v=!h&&r&&p===0,b="";if(h)b="<th>".concat(e.getColHeader(p-c),"</th>");else if(v)b="<th>".concat(e.getRowHeader(d-f),"</th>");else{var S=o[d][p],w=e.getCellMeta(d-f,p-c),P=w.hidden,E=w.rowspan,j=w.colspan;if(!P){var G=[];if(E&&G.push('rowspan="'.concat(E,'"')),j&&G.push('colspan="'.concat(j,'"')),isEmpty(S))b="<td ".concat(G.join(" "),"></td>");else{var q=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b="<td ".concat(G.join(" "),">").concat(q,"</td>")}}}y.push(b)}var z=["<tr>"].concat(y,["</tr>"]).join("");h?l.splice(1,0,z):u.splice(-1,0,z)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function _dataToHTML(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var s=0;s<i;s+=1){var l=o[s],u=isEmpty(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function htmlToGridSettings(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(C){var R=C.match(/<td\b[^>]*?>/g)[0],A=C.substring(R.length,C.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),B="</td>";return"".concat(R).concat(A).concat(B)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!isHTMLTable(i))){var s=o.querySelector('meta[name$="enerator"]'),l=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),c=u?Array.from(u.cells).reduce(function(C,R){return C+R.colSpan},0)-(l?1:0):0,f=i.tFoot&&Array.from(i.tFoot.rows)||[],d=[],h=!1,y=0,p=0;if(i.tHead){var v=Array.from(i.tHead.rows).filter(function(C){var R=C.querySelector("td")!==null;return R&&d.push(C),!R});y=v.length,h=y>0,y>1?r.nestedHeaders=Array.from(v).reduce(function(C,R){var A=Array.from(R.cells).reduce(function(B,V,K){if(l&&K===0)return B;var J=V.colSpan,ee=V.innerHTML,oe=J>1?{label:ee,colspan:J}:ee;return B.push(oe),B},[]);return C.push(A),C},[]):h&&(r.colHeaders=Array.from(v[0].children).reduce(function(C,R,A){return l&&A===0||C.push(R.innerHTML),C},[]))}d.length&&(r.fixedRowsTop=d.length),f.length&&(r.fixedRowsBottom=f.length);var b=[].concat(d,_toConsumableArray$z(Array.from(i.tBodies).reduce(function(C,R){return C.push.apply(C,_toConsumableArray$z(Array.from(R.rows))),C},[])),_toConsumableArray$z(f));p=b.length;for(var S=new Array(p),w=0;w<p;w++)S[w]=new Array(c);for(var P=[],E=[],j=0;j<p;j++)for(var G=b[j],q=Array.from(G.cells),z=q.length,U=0;U<z;U++){var Z=q[U],te=Z.nodeName,Q=Z.innerHTML,ie=Z.rowSpan,he=Z.colSpan,ce=S[j].findIndex(function(C){return C===void 0});if(te==="TD"){if(ie>1||he>1){for(var fe=j;fe<j+ie;fe++)if(fe<p)for(var I=ce;I<ce+he;I++)S[fe][I]=null;var g=Z.getAttribute("style"),m=g&&g.includes("mso-ignore:colspan");m||P.push({col:ce,row:j,rowspan:ie,colspan:he})}var _="";s&&/excel/gi.test(s.content)?_=Q.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):_=Q.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[j][ce]=_.replace(regEscapedChars,function(C){return ESCAPED_HTML_CHARS[C]})}else E.push(Q)}return P.length&&(r.mergeCells=P),E.length&&(r.rowHeaders=E),S.length&&(r.data=S),r}}const parseTableHelpers=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML,htmlToGridSettings,instanceToHTML},Symbol.toStringTag,{value:"Module"}));function _toConsumableArray$y(e){return _arrayWithoutHoles$y(e)||_iterableToArray$A(e)||_unsupportedIterableToArray$19(e)||_nonIterableSpread$y()}function _nonIterableSpread$y(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$19(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$19(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$19(e,t)}}function _iterableToArray$A(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$y(e){if(Array.isArray(e))return _arrayLikeToArray$19(e)}function _arrayLikeToArray$19(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _typeof$2_(e){return _typeof$2_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2_(e)}function isNumeric(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=_typeof$2_(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(_toConsumableArray$y(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function isNumericLike(e){return isNumeric(e,[","])}function rangeEach(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function rangeEachReverse(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function valueAccordingPercent(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const numberHelpers=Object.freeze(Object.defineProperty({__proto__:null,isNumeric,isNumericLike,rangeEach,rangeEachReverse,valueAccordingPercent},Symbol.toStringTag,{value:"Module"}));function _toConsumableArray$x(e){return _arrayWithoutHoles$x(e)||_iterableToArray$z(e)||_unsupportedIterableToArray$18(e)||_nonIterableSpread$x()}function _nonIterableSpread$x(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$z(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$x(e){if(Array.isArray(e))return _arrayLikeToArray$18(e)}function _slicedToArray$L(e,t){return _arrayWithHoles$N(e)||_iterableToArrayLimit$L(e,t)||_unsupportedIterableToArray$18(e,t)||_nonIterableRest$N()}function _nonIterableRest$N(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$18(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$18(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$18(e,t)}}function _arrayLikeToArray$18(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$L(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$N(e){if(Array.isArray(e))return e}var ASC="asc",DESC="desc",ORDER_MAP=new Map([[ASC,[-1,1]],[DESC,[1,-1]]]),DEFAULT_ERROR_PRIORITY_EXISTS=function(t){return"The priority '".concat(t,"' is already declared in a map.")},DEFAULT_ERROR_PRIORITY_NAN=function(t){return"The priority '".concat(t,"' is not a number.")};function createPriorityMap(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=isFunction(t)?t:DEFAULT_ERROR_PRIORITY_EXISTS,r=isFunction(r)?r:DEFAULT_ERROR_PRIORITY_NAN;function o(a,s){if(!isNumeric(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,s)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ASC,s=ORDER_MAP.get(a)||ORDER_MAP.get(ASC),l=_slicedToArray$L(s,2),u=l[0],c=l[1];return _toConsumableArray$x(n).sort(function(f,d){return f[0]<d[0]?u:c}).map(function(f){return f[1]})}return{addItem:o,getItems:i}}var $$b=_export,$find=arrayIteration.find,addToUnscopables=addToUnscopables$5,FIND="find",SKIPS_HOLES=!0;FIND in[]&&Array(1)[FIND](function(){SKIPS_HOLES=!1});$$b({target:"Array",proto:!0,forced:SKIPS_HOLES},{find:function(t){return $find(this,t,arguments.length>1?arguments[1]:void 0)}});addToUnscopables(FIND);function _toConsumableArray$w(e){return _arrayWithoutHoles$w(e)||_iterableToArray$y(e)||_unsupportedIterableToArray$17(e)||_nonIterableSpread$w()}function _nonIterableSpread$w(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$y(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$w(e){if(Array.isArray(e))return _arrayLikeToArray$17(e)}function _slicedToArray$K(e,t){return _arrayWithHoles$M(e)||_iterableToArrayLimit$K(e,t)||_unsupportedIterableToArray$17(e,t)||_nonIterableRest$M()}function _nonIterableRest$M(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$17(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$17(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$17(e,t)}}function _arrayLikeToArray$17(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$K(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$M(e){if(Array.isArray(e))return e}var DEFAULT_ERROR_ID_EXISTS=function(t){return"The id '".concat(t,"' is already declared in a map.")};function createUniqueMap(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=isFunction(t)?t:DEFAULT_ERROR_ID_EXISTS;function n(c,f){if(u(c))throw new Error(t(c));r.set(c,f)}function o(c){return r.delete(c)}function i(){r.clear()}function a(c){var f=l().find(function(y){var p=_slicedToArray$K(y,2),v=p[0],b=p[1];return c===b?v:!1})||[null],d=_slicedToArray$K(f,1),h=d[0];return h}function s(c){return r.get(c)}function l(){return _toConsumableArray$w(r)}function u(c){return r.has(c)}return{addItem:n,clear:i,getId:a,getItem:s,getItems:l,hasItem:u,removeItem:o}}function _toConsumableArray$v(e){return _arrayWithoutHoles$v(e)||_iterableToArray$x(e)||_unsupportedIterableToArray$16(e)||_nonIterableSpread$v()}function _nonIterableSpread$v(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$16(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$16(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$16(e,t)}}function _iterableToArray$x(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$v(e){if(Array.isArray(e))return _arrayLikeToArray$16(e)}function _arrayLikeToArray$16(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var DEFAULT_ERROR_ITEM_EXISTS=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function createUniqueSet(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=isFunction(t)?t:DEFAULT_ERROR_ITEM_EXISTS;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return _toConsumableArray$v(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function _slicedToArray$J(e,t){return _arrayWithHoles$L(e)||_iterableToArrayLimit$J(e,t)||_unsupportedIterableToArray$15(e,t)||_nonIterableRest$L()}function _nonIterableRest$L(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit$J(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$L(e){if(Array.isArray(e))return e}function _toConsumableArray$u(e){return _arrayWithoutHoles$u(e)||_iterableToArray$w(e)||_unsupportedIterableToArray$15(e)||_nonIterableSpread$u()}function _nonIterableSpread$u(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$15(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$15(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$15(e,t)}}function _iterableToArray$w(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$u(e){if(Array.isArray(e))return _arrayLikeToArray$15(e)}function _arrayLikeToArray$15(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ERROR_PLUGIN_REGISTERED=function(t){return'There is already registered "'.concat(t,'" plugin.')},ERROR_PRIORITY_REGISTERED=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},ERROR_PRIORITY_NAN=function(t){return'The priority "'.concat(t,'" is not a number.')},priorityPluginsQueue=createPriorityMap({errorPriorityExists:ERROR_PRIORITY_REGISTERED,errorPriorityNaN:ERROR_PRIORITY_NAN}),uniquePluginsQueue=createUniqueSet({errorItemExists:ERROR_PLUGIN_REGISTERED}),uniquePluginsList=createUniqueMap({errorIdExists:ERROR_PLUGIN_REGISTERED});function getPluginsNames(){return[].concat(_toConsumableArray$u(priorityPluginsQueue.getItems()),_toConsumableArray$u(uniquePluginsQueue.getItems()))}function getPlugin(e){var t=toUpperCaseFirst(e);return uniquePluginsList.getItem(t)}function hasPlugin(e){return!!getPlugin(e)}function registerPlugin(e,t,r){var n=unifyPluginArguments(e,t,r),o=_slicedToArray$J(n,3);e=o[0],t=o[1],r=o[2],getPlugin(e)===void 0&&_registerPlugin(e,t,r)}function _registerPlugin(e,t,r){var n=toUpperCaseFirst(e);if(uniquePluginsList.hasItem(n))throw new Error(ERROR_PLUGIN_REGISTERED(n));r===void 0?uniquePluginsQueue.addItem(n):priorityPluginsQueue.addItem(r,n),uniquePluginsList.addItem(n,t)}function unifyPluginArguments(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var _staticRegister$6=staticRegister("renderers"),register$4=_staticRegister$6.register,getItem$3=_staticRegister$6.getItem,hasItem$2=_staticRegister$6.hasItem,getNames$2=_staticRegister$6.getNames;_staticRegister$6.getValues;function _getItem$2(e){if(typeof e=="function")return e;if(!hasItem$2(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return getItem$3(e)}function _register$2(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),register$4(e,t)}var _staticRegister$5=staticRegister("validators"),register$3=_staticRegister$5.register,getItem$2=_staticRegister$5.getItem,hasItem$1=_staticRegister$5.hasItem,getNames$1=_staticRegister$5.getNames;_staticRegister$5.getValues;function _getItem$1(e){if(typeof e=="function")return e;if(!hasItem$1(e))throw Error('No registered validator found under "'.concat(e,'" name'));return getItem$2(e)}function _register$1(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),register$3(e,t)}var RENDER_TYPE=1,FULLY_VISIBLE_TYPE=2;function _typeof$2Z(e){return _typeof$2Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2Z(e)}function _classCallCheck$2H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2T(n.key),n)}}function _createClass$2H(e,t,r){return t&&_defineProperties$2H(e.prototype,t),r&&_defineProperties$2H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2T(e){var t=_toPrimitive$2T(e,"string");return _typeof$2Z(t)==="symbol"?t:String(t)}function _toPrimitive$2T(e,t){if(_typeof$2Z(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2Z(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var privatePool$k=new WeakMap,ViewportColumnsCalculator=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,l=t.stretchMode,u=t.stretchingItemWidthFn,c=u===void 0?function(f){return f}:u;_classCallCheck$2H(this,e),privatePool$k.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:s,stretchingColumnWidthFn:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return _createClass$2H(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=privatePool$k.get(this),s=a.calculationType,l=a.overrideFn,u=a.scrollOffset,c=a.totalColumns,f=a.viewportWidth,d=0;d<c;d++){i=this._getColumnWidth(d),r<=u&&s!==FULLY_VISIBLE_TYPE&&(this.startColumn=d);var h=u>0?f+1:f;if(r>=u&&r+(s===FULLY_VISIBLE_TYPE?i:0)<=u+h&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=d),this.endColumn=d),o.push(r),r+=i,s!==FULLY_VISIBLE_TYPE&&(this.endColumn=d),r>=u+f){n=!1;break}}if(this.endColumn===c-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var y=o[this.endColumn]+i-o[this.startColumn-1];if((y<=f||s!==FULLY_VISIBLE_TYPE)&&(this.startColumn-=1),y>f)break}s===RENDER_TYPE&&this.startColumn!==null&&l&&l(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),c<this.endColumn&&(this.endColumn=c-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=privatePool$k.get(this),i=o.totalColumns,a=0,s=0;s<i;s++){var l=this._getColumnWidth(s),u=o.stretchingColumnWidthFn(void 0,s);typeof u=="number"?n-=u:a+=l}var c=n-a;if(this.stretch==="all"&&c>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var f=this._getColumnWidth(i-1),d=c+f;this.stretchLastWidth=d>=0?d:f}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=privatePool$k.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var s=Math.round(n*this.stretchAllRatio),l=i.stretchingColumnWidthFn(s,r);l===void 0?this.stretchAllColumnsWidth[r]=s:this.stretchAllColumnsWidth[r]=isNaN(l)?this._getColumnWidth(r):l}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=privatePool$k.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=privatePool$k.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const ViewportColumnsCalculator$1=ViewportColumnsCalculator;function _typeof$2Y(e){return _typeof$2Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2Y(e)}function _classCallCheck$2G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2S(n.key),n)}}function _createClass$2G(e,t,r){return t&&_defineProperties$2G(e.prototype,t),r&&_defineProperties$2G(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2S(e){var t=_toPrimitive$2S(e,"string");return _typeof$2Y(t)==="symbol"?t:String(t)}function _toPrimitive$2S(e,t){if(_typeof$2Y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2Y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var privatePool$j=new WeakMap,ViewportRowsCalculator=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,l=t.scrollbarHeight;_classCallCheck$2G(this,e),privatePool$j.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return _createClass$2G(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i=privatePool$j.get(this),a=i.calculationType,s=i.overrideFn,l=i.rowHeightFn,u=i.scrollOffset,c=i.totalRows,f=i.viewportHeight,d=i.horizontalScrollbarHeight||0,h,y=0;y<c;y++)if(h=l(y),isNaN(h)&&(h=e.DEFAULT_HEIGHT),r<=u&&a!==FULLY_VISIBLE_TYPE&&(this.startRow=y),r>=u&&r+(a===FULLY_VISIBLE_TYPE?h:0)<=u+f-d&&(this.startRow===null&&(this.startRow=y),this.endRow=y),o.push(r),r+=h,a!==FULLY_VISIBLE_TYPE&&(this.endRow=y),r>=u+f-d){n=!1;break}if(this.endRow===c-1&&n)for(this.startRow=this.endRow;this.startRow>0;){var p=o[this.endRow]+h-o[this.startRow-1];if((p<=f-d||a!==FULLY_VISIBLE_TYPE)&&(this.startRow-=1),p>=f-d)break}a===RENDER_TYPE&&this.startRow!==null&&s&&s(this),this.startPosition=o[this.startRow],this.startPosition===void 0&&(this.startPosition=null),c<this.endRow&&(this.endRow=c-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const ViewportRowsCalculator$1=ViewportRowsCalculator;function _typeof$2X(e){return _typeof$2X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2X(e)}function _classCallCheck$2F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2R(n.key),n)}}function _createClass$2F(e,t,r){return t&&_defineProperties$2F(e.prototype,t),r&&_defineProperties$2F(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classPrivateFieldInitSpec$e(e,t,r){_checkPrivateRedeclaration$f(e,t),t.set(e,r)}function _checkPrivateRedeclaration$f(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$I(e,t,r){return t=_toPropertyKey$2R(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2R(e){var t=_toPrimitive$2R(e,"string");return _typeof$2X(t)==="symbol"?t:String(t)}function _toPrimitive$2R(e,t){if(_typeof$2X(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2X(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$e(e,t){var r=_classExtractFieldDescriptor$e(e,t,"get");return _classApplyDescriptorGet$e(e,r)}function _classApplyDescriptorGet$e(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet$e(e,t,r){var n=_classExtractFieldDescriptor$e(e,t,"set");return _classApplyDescriptorSet$e(e,n,r),r}function _classExtractFieldDescriptor$e(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet$e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var _isRtl$1=new WeakMap,CellCoords=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_classCallCheck$2F(this,e),_defineProperty$I(this,"row",null),_defineProperty$I(this,"col",null),_classPrivateFieldInitSpec$e(this,_isRtl$1,{writable:!0,value:!1}),_classPrivateFieldSet$e(this,_isRtl$1,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return _createClass$2F(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(_classPrivateFieldGet$e(this,_isRtl$1)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(_classPrivateFieldGet$e(this,_isRtl$1)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(_classPrivateFieldGet$e(this,_isRtl$1)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(_classPrivateFieldGet$e(this,_isRtl$1)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,_classPrivateFieldGet$e(this,_isRtl$1))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const CellCoords$1=CellCoords;function _typeof$2W(e){return _typeof$2W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2W(e)}function _classCallCheck$2E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2Q(n.key),n)}}function _createClass$2E(e,t,r){return t&&_defineProperties$2E(e.prototype,t),r&&_defineProperties$2E(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classPrivateFieldInitSpec$d(e,t,r){_checkPrivateRedeclaration$e(e,t),t.set(e,r)}function _checkPrivateRedeclaration$e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$H(e,t,r){return t=_toPropertyKey$2Q(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2Q(e){var t=_toPrimitive$2Q(e,"string");return _typeof$2W(t)==="symbol"?t:String(t)}function _toPrimitive$2Q(e,t){if(_typeof$2W(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2W(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$d(e,t){var r=_classExtractFieldDescriptor$d(e,t,"get");return _classApplyDescriptorGet$d(e,r)}function _classApplyDescriptorGet$d(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet$d(e,t,r){var n=_classExtractFieldDescriptor$d(e,t,"set");return _classApplyDescriptorSet$d(e,n,r),r}function _classExtractFieldDescriptor$d(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet$d(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var _isRtl=new WeakMap,CellRange=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;_classCallCheck$2E(this,e),_defineProperty$H(this,"highlight",null),_defineProperty$H(this,"from",null),_defineProperty$H(this,"to",null),_classPrivateFieldInitSpec$d(this,_isRtl,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),_classPrivateFieldSet$d(this,_isRtl,o)}return _createClass$2E(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),s=r.getOuterBottomEndCorner(),l=Math.min(n.row,a.row),u=Math.min(n.col,a.col),c=Math.max(o.row,s.row),f=Math.max(o.col,s.col),d=this._createCellCoords(l,u),h=this._createCellCoords(c,f);return this.from=d,this.to=h,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return _classPrivateFieldGet$d(this,_isRtl)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return _classPrivateFieldGet$d(this,_isRtl)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return _classPrivateFieldGet$d(this,_isRtl)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return _classPrivateFieldGet$d(this,_isRtl)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return _classPrivateFieldGet$d(this,_isRtl)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return _classPrivateFieldGet$d(this,_isRtl)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return _classPrivateFieldGet$d(this,_isRtl)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return _classPrivateFieldGet$d(this,_isRtl)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof CellCoords$1))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var s=r(i,a);if(s===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,_classPrivateFieldGet$d(this,_isRtl))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new CellCoords$1(r,n,_classPrivateFieldGet$d(this,_isRtl))}}]),e}();const CellRange$1=CellRange;var $$a=_export,setPrototypeOf=objectSetPrototypeOf;$$a({target:"Object",stat:!0},{setPrototypeOf});var uncurryThis$6=functionUncurryThis,aCallable=aCallable$7,isObject$2=isObject$n,hasOwn$1=hasOwnProperty_1,arraySlice=arraySlice$6,NATIVE_BIND=functionBindNative,$Function=Function,concat$1=uncurryThis$6([].concat),join=uncurryThis$6([].join),factories={},construct=function(e,t,r){if(!hasOwn$1(factories,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";factories[t]=$Function("C,a","return new C("+join(n,",")+")")}return factories[t](e,r)},functionBind=NATIVE_BIND?$Function.bind:function(t){var r=aCallable(this),n=r.prototype,o=arraySlice(arguments,1),i=function(){var s=concat$1(o,arraySlice(arguments));return this instanceof i?construct(r,s.length,s):r.apply(t,s)};return isObject$2(n)&&(i.prototype=n),i},$$9=_export,getBuiltIn=getBuiltIn$9,apply=functionApply,bind=functionBind,aConstructor=aConstructor$2,anObject$2=anObject$m,isObject$1=isObject$n,create=objectCreate,fails$4=fails$I,nativeConstruct=getBuiltIn("Reflect","construct"),ObjectPrototype=Object.prototype,push$1=[].push,NEW_TARGET_BUG=fails$4(function(){function e(){}return!(nativeConstruct(function(){},[],e)instanceof e)}),ARGS_BUG=!fails$4(function(){nativeConstruct(function(){})}),FORCED$2=NEW_TARGET_BUG||ARGS_BUG;$$9({target:"Reflect",stat:!0,forced:FORCED$2,sham:FORCED$2},{construct:function(t,r){aConstructor(t),anObject$2(r);var n=arguments.length<3?t:aConstructor(arguments[2]);if(ARGS_BUG&&!NEW_TARGET_BUG)return nativeConstruct(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return apply(push$1,o,r),new(apply(bind,t,o))}var i=n.prototype,a=create(isObject$1(i)?i:ObjectPrototype),s=apply(t,a,r);return isObject$1(s)?s:a}});function _typeof$2V(e){return _typeof$2V=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2V(e)}function _classCallCheck$2D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2P(n.key),n)}}function _createClass$2D(e,t,r){return t&&_defineProperties$2D(e.prototype,t),r&&_defineProperties$2D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2P(e){var t=_toPrimitive$2P(e,"string");return _typeof$2V(t)==="symbol"?t:String(t)}function _toPrimitive$2P(e,t){if(_typeof$2V(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2V(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var privatePool$i=new WeakMap,Event$1=function(){function e(t,r,n,o,i,a){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;_classCallCheck$2D(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=s,this.eventManager=o,this.facadeGetter=t,privatePool$i.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return _createClass$2D(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};isMobileBrowser()?n():(isTouchSupported()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=privatePool$i.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],s=a[0],l=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],c=u[0],f=u[1];return s===l&&c===f}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=closestDown(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):hasClass(r,"wtBorder")&&hasClass(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):hasClass(r,"wtBorder")&&hasClass(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=privatePool$i.get(this),o=this.domBindings.rootDocument.activeElement,i=partial(getParent,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var s=this.parentCell(a);hasClass(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,s.coords,s.TD),(r.button===0||this.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=closestDown(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&isChildOf(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=closestDown(r.target,["TD","TH"],n),i=closestDown(r.relatedTarget,["TD","TH"],n);o&&o!==i&&isChildOf(o,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o)}}},{key:"onMouseUp",value:function(r){var n=privatePool$i.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(hasClass(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=privatePool$i.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=isDefined(i)&&i.row>=0&&i.col>=0,s=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(s){var l=["A","BUTTON","INPUT"];isIOS()&&(isChromeWebKit()||isFirefoxWebKit())&&this.selectedCellWasTouched(o)&&!l.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=privatePool$i.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const Event$2=Event$1;function _typeof$2U(e){return _typeof$2U=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2U(e)}function _classCallCheck$2C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2O(n.key),n)}}function _createClass$2C(e,t,r){return t&&_defineProperties$2C(e.prototype,t),r&&_defineProperties$2C(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2O(e){var t=_toPrimitive$2O(e,"string");return _typeof$2U(t)==="symbol"?t:String(t)}function _toPrimitive$2O(e,t){if(_typeof$2U(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2U(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ColumnFilter=function(){function e(t,r,n){_classCallCheck$2C(this,e),this.offset=t,this.total=r,this.countTH=n}return _createClass$2C(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const ColumnFilter$1=ColumnFilter;function _typeof$2T(e){return _typeof$2T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2T(e)}function _classCallCheck$2B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2N(n.key),n)}}function _createClass$2B(e,t,r){return t&&_defineProperties$2B(e.prototype,t),r&&_defineProperties$2B(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2N(e){var t=_toPrimitive$2N(e,"string");return _typeof$2T(t)==="symbol"?t:String(t)}function _toPrimitive$2N(e,t){if(_typeof$2T(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2T(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RowFilter=function(){function e(t,r,n){_classCallCheck$2B(this,e),this.offset=t,this.total=r,this.countTH=n}return _createClass$2B(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const RowFilter$1=RowFilter;var WORKING_SPACE_ALL=0,WORKING_SPACE_TOP=1,WORKING_SPACE_BOTTOM=2;function _typeof$2S(e){return _typeof$2S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2S(e)}function _classCallCheck$2A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2M(n.key),n)}}function _createClass$2A(e,t,r){return t&&_defineProperties$2A(e.prototype,t),r&&_defineProperties$2A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2M(e){var t=_toPrimitive$2M(e,"string");return _typeof$2S(t)==="symbol"?t:String(t)}function _toPrimitive$2M(e,t){if(_typeof$2S(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2S(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ViewSize=function(){function e(){_classCallCheck$2A(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return _createClass$2A(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function _typeof$2R(e){return _typeof$2R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2R(e)}function _classCallCheck$2z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2L(n.key),n)}}function _createClass$2z(e,t,r){return t&&_defineProperties$2z(e.prototype,t),r&&_defineProperties$2z(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2L(e){var t=_toPrimitive$2L(e,"string");return _typeof$2R(t)==="symbol"?t:String(t)}function _toPrimitive$2L(e,t){if(_typeof$2R(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2R(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ViewSizeSet=function(){function e(){_classCallCheck$2z(this,e),this.size=new ViewSize,this.workingSpace=WORKING_SPACE_ALL,this.sharedSize=null}return _createClass$2z(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof ViewSize}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=WORKING_SPACE_TOP,r.workingSpace=WORKING_SPACE_BOTTOM,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=WORKING_SPACE_BOTTOM,r.workingSpace=WORKING_SPACE_TOP,this.sharedSize=r.getViewSize()}}]),e}();function _typeof$2Q(e){return _typeof$2Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2Q(e)}function _classCallCheck$2y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2K(n.key),n)}}function _createClass$2y(e,t,r){return t&&_defineProperties$2y(e.prototype,t),r&&_defineProperties$2y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2K(e){var t=_toPrimitive$2K(e,"string");return _typeof$2Q(t)==="symbol"?t:String(t)}function _toPrimitive$2K(e,t){if(_typeof$2Q(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2Q(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OrderView=function(){function e(t,r,n){_classCallCheck$2y(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new ViewSizeSet,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return _createClass$2y(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(WORKING_SPACE_TOP))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,s=this.getRenderedChildCount();s<a;){var l=this.nodesPool();!o||o&&n.isPlaceOn(WORKING_SPACE_BOTTOM)?r.appendChild(l):r.insertBefore(l,r.firstChild),s+=1}for(var u=o&&n.isPlaceOn(WORKING_SPACE_TOP);s>a;)r.removeChild(u?r.firstChild:r.lastChild),s-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(WORKING_SPACE_BOTTOM)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function _typeof$2P(e){return _typeof$2P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2P(e)}function _classCallCheck$2x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2J(n.key),n)}}function _createClass$2x(e,t,r){return t&&_defineProperties$2x(e.prototype,t),r&&_defineProperties$2x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2J(e){var t=_toPrimitive$2J(e,"string");return _typeof$2P(t)==="symbol"?t:String(t)}function _toPrimitive$2J(e,t){if(_typeof$2P(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2P(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$1o(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1p(e,t)}function _setPrototypeOf$1p(e,t){return _setPrototypeOf$1p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1p(e,t)}function _createSuper$1o(e){var t=_isNativeReflectConstruct$1p();return function(){var n=_getPrototypeOf$1o(e),o;if(t){var i=_getPrototypeOf$1o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1o(this,o)}}function _possibleConstructorReturn$1o(e,t){if(t&&(_typeof$2P(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1o(e)}function _assertThisInitialized$1o(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1o(e){return _getPrototypeOf$1o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1o(e)}var SharedOrderView=function(e){_inherits$1o(r,e);var t=_createSuper$1o(r);function r(){return _classCallCheck$2x(this,r),t.apply(this,arguments)}return _createClass$2x(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(OrderView);function _typeof$2O(e){return _typeof$2O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2O(e)}function _classCallCheck$2w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2I(n.key),n)}}function _createClass$2w(e,t,r){return t&&_defineProperties$2w(e.prototype,t),r&&_defineProperties$2w(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2I(e){var t=_toPrimitive$2I(e,"string");return _typeof$2O(t)==="symbol"?t:String(t)}function _toPrimitive$2I(e,t){if(_typeof$2O(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2O(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NodesPool=function(){function e(t){_classCallCheck$2w(this,e),this.nodeType=t.toUpperCase()}return _createClass$2w(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function _typeof$2N(e){return _typeof$2N=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2N(e)}function _classCallCheck$2v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2H(n.key),n)}}function _createClass$2v(e,t,r){return t&&_defineProperties$2v(e.prototype,t),r&&_defineProperties$2v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2H(e){var t=_toPrimitive$2H(e,"string");return _typeof$2N(t)==="symbol"?t:String(t)}function _toPrimitive$2H(e,t){if(_typeof$2N(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2N(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BaseRenderer=function(){function e(t,r){_classCallCheck$2v(this,e),this.nodesPool=typeof t=="string"?new NodesPool(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return _createClass$2v(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function _typeof$2M(e){return _typeof$2M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2M(e)}function _classCallCheck$2u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2G(n.key),n)}}function _createClass$2u(e,t,r){return t&&_defineProperties$2u(e.prototype,t),r&&_defineProperties$2u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2G(e){var t=_toPrimitive$2G(e,"string");return _typeof$2M(t)==="symbol"?t:String(t)}function _toPrimitive$2G(e,t){if(_typeof$2M(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2M(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$1n(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1o(e,t)}function _setPrototypeOf$1o(e,t){return _setPrototypeOf$1o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1o(e,t)}function _createSuper$1n(e){var t=_isNativeReflectConstruct$1o();return function(){var n=_getPrototypeOf$1n(e),o;if(t){var i=_getPrototypeOf$1n(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1n(this,o)}}function _possibleConstructorReturn$1n(e,t){if(t&&(_typeof$2M(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1n(e)}function _assertThisInitialized$1n(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1o(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1n(e){return _getPrototypeOf$1n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1n(e)}var RowHeadersRenderer=function(e){_inherits$1n(r,e);var t=_createSuper$1n(r);function r(){var n;return _classCallCheck$2u(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return _createClass$2u(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new SharedOrderView(o,function(s){return i.nodesPool.obtain(i.sourceRowIndex,s)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,s=o.rowHeadersCount,l=o.rows,u=o.cells,c=0;c<i;c++){var f=this.table.renderedRowToSource(c),d=l.getRenderedNode(c);this.sourceRowIndex=f;var h=this.obtainOrderView(d),y=u.obtainOrderView(d);h.appendView(y).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var p=0;p<s;p++){h.render();var v=h.getCurrentNode();v.className="",v.removeAttribute("style"),a[p](f,v,p)}h.end()}}}]),r}(BaseRenderer);function _typeof$2L(e){return _typeof$2L=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2L(e)}function _classCallCheck$2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2F(n.key),n)}}function _createClass$2t(e,t,r){return t&&_defineProperties$2t(e.prototype,t),r&&_defineProperties$2t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2F(e){var t=_toPrimitive$2F(e,"string");return _typeof$2L(t)==="symbol"?t:String(t)}function _toPrimitive$2F(e,t){if(_typeof$2L(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2L(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$1m(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1n(e,t)}function _setPrototypeOf$1n(e,t){return _setPrototypeOf$1n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1n(e,t)}function _createSuper$1m(e){var t=_isNativeReflectConstruct$1n();return function(){var n=_getPrototypeOf$1m(e),o;if(t){var i=_getPrototypeOf$1m(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1m(this,o)}}function _possibleConstructorReturn$1m(e,t){if(t&&(_typeof$2L(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1m(e)}function _assertThisInitialized$1m(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1n(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1m(e){return _getPrototypeOf$1m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1m(e)}var ColumnHeadersRenderer=function(e){_inherits$1m(r,e);var t=_createSuper$1m(r);function r(n){return _classCallCheck$2t(this,r),t.call(this,null,n)}return _createClass$2t(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,s=this.rootNode.firstChild;if(i){for(var l=this.table.columnsToRender,u=l+a,c=0,f=i;c<f;c++){for(s=this.rootNode.childNodes[c],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<u;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)s.removeChild(s.lastChild),this.renderedNodes-=1}var d=this.rootNode.childNodes.length;if(d>i)for(var h=i;h<d;h++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&empty(s)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,s=a.columnHeaderFunctions,l=a.columnsToRender,u=a.rowHeadersCount,c=this.rootNode.childNodes[i],f=-1*u;f<l;f+=1){var d=this.table.renderedColumnToSource(f),h=c.childNodes[f+u];h.className="",h.removeAttribute("style"),s[i](d,h,i)}}}]),r}(BaseRenderer);function _typeof$2K(e){return _typeof$2K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2K(e)}function _classCallCheck$2s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2E(n.key),n)}}function _createClass$2s(e,t,r){return t&&_defineProperties$2s(e.prototype,t),r&&_defineProperties$2s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2E(e){var t=_toPrimitive$2E(e,"string");return _typeof$2K(t)==="symbol"?t:String(t)}function _toPrimitive$2E(e,t){if(_typeof$2K(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2K(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$1l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1m(e,t)}function _setPrototypeOf$1m(e,t){return _setPrototypeOf$1m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1m(e,t)}function _createSuper$1l(e){var t=_isNativeReflectConstruct$1m();return function(){var n=_getPrototypeOf$1l(e),o;if(t){var i=_getPrototypeOf$1l(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1l(this,o)}}function _possibleConstructorReturn$1l(e,t){if(t&&(_typeof$2K(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1l(e)}function _assertThisInitialized$1l(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1m(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1l(e){return _getPrototypeOf$1l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1l(e)}var ColGroupRenderer=function(e){_inherits$1l(r,e);var t=_createSuper$1l(r);function r(n){return _classCallCheck$2s(this,r),t.call(this,null,n)}return _createClass$2s(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,s=i+a;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,s=0;s<a;s++){var l=this.table.renderedColumnToSource(s),u=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[s].style.width="".concat(u,"px")}for(var c=0;c<i;c++){var f=this.table.renderedColumnToSource(c),d=this.table.columnUtils.getStretchedColumnWidth(f);this.rootNode.childNodes[c+a].style.width="".concat(d,"px")}var h=this.rootNode.firstChild;h&&addClass(h,"rowHeader")}}]),r}(BaseRenderer);function _typeof$2J(e){return _typeof$2J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2J(e)}var _templateObject$g;function _taggedTemplateLiteral$g(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$2r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2D(n.key),n)}}function _createClass$2r(e,t,r){return t&&_defineProperties$2r(e.prototype,t),r&&_defineProperties$2r(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2D(e){var t=_toPrimitive$2D(e,"string");return _typeof$2J(t)==="symbol"?t:String(t)}function _toPrimitive$2D(e,t){if(_typeof$2J(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2J(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$1k(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1l(e,t)}function _setPrototypeOf$1l(e,t){return _setPrototypeOf$1l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1l(e,t)}function _createSuper$1k(e){var t=_isNativeReflectConstruct$1l();return function(){var n=_getPrototypeOf$1k(e),o;if(t){var i=_getPrototypeOf$1k(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1k(this,o)}}function _possibleConstructorReturn$1k(e,t){if(t&&(_typeof$2J(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1k(e)}function _assertThisInitialized$1k(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1k(e){return _getPrototypeOf$1k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1k(e)}var performanceWarningAppeared=!1,RowsRenderer=function(e){_inherits$1k(r,e);var t=_createSuper$1k(r);function r(n){var o;return _classCallCheck$2r(this,r),o=t.call(this,"TR",n),o.orderView=new OrderView(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return _createClass$2r(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!performanceWarningAppeared&&o>1e3&&(performanceWarningAppeared=!0,warn(toSingleLine(_templateObject$g||(_templateObject$g=_taggedTemplateLiteral$g([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(BaseRenderer);function _typeof$2I(e){return _typeof$2I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2I(e)}function _classCallCheck$2q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2C(n.key),n)}}function _createClass$2q(e,t,r){return t&&_defineProperties$2q(e.prototype,t),r&&_defineProperties$2q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2C(e){var t=_toPrimitive$2C(e,"string");return _typeof$2I(t)==="symbol"?t:String(t)}function _toPrimitive$2C(e,t){if(_typeof$2I(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2I(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$1j(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1k(e,t)}function _setPrototypeOf$1k(e,t){return _setPrototypeOf$1k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1k(e,t)}function _createSuper$1j(e){var t=_isNativeReflectConstruct$1k();return function(){var n=_getPrototypeOf$1j(e),o;if(t){var i=_getPrototypeOf$1j(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1j(this,o)}}function _possibleConstructorReturn$1j(e,t){if(t&&(_typeof$2I(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1j(e)}function _assertThisInitialized$1j(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1k(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1j(e){return _getPrototypeOf$1j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1j(e)}var CellsRenderer=function(e){_inherits$1j(r,e);var t=_createSuper$1j(r);function r(){var n;return _classCallCheck$2q(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return _createClass$2q(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new SharedOrderView(o,function(s){return i.nodesPool.obtain(i.sourceRowIndex,s)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,s=o.rows,l=o.rowHeaders,u=0;u<i;u++){var c=this.table.renderedRowToSource(u),f=s.getRenderedNode(u);this.sourceRowIndex=c;var d=this.obtainOrderView(f),h=l.obtainOrderView(f);d.prependView(h).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<a;y++){d.render();var p=d.getCurrentNode(),v=this.table.renderedColumnToSource(y);hasClass(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),this.table.cellRenderer(c,v,p)}d.end()}}}]),r}(BaseRenderer);function _typeof$2H(e){return _typeof$2H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2H(e)}function _classCallCheck$2p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2B(n.key),n)}}function _createClass$2p(e,t,r){return t&&_defineProperties$2p(e.prototype,t),r&&_defineProperties$2p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2B(e){var t=_toPrimitive$2B(e,"string");return _typeof$2H(t)==="symbol"?t:String(t)}function _toPrimitive$2B(e,t){if(_typeof$2H(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2H(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TableRenderer=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;_classCallCheck$2p(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return _createClass$2p(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,s=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),s.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=s}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),s=this.rowUtils.getHeight(a);s?i.firstChild.style.height="".concat(s-1,"px"):i.firstChild.style.height=""}}}}]),e}();function _typeof$2G(e){return _typeof$2G=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2G(e)}function _classCallCheck$2o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2A(n.key),n)}}function _createClass$2o(e,t,r){return t&&_defineProperties$2o(e.prototype,t),r&&_defineProperties$2o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2A(e){var t=_toPrimitive$2A(e,"string");return _typeof$2G(t)==="symbol"?t:String(t)}function _toPrimitive$2A(e,t){if(_typeof$2G(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2G(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Renderer=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,s=t.columnUtils,l=t.cellRenderer;_classCallCheck$2o(this,e),this.renderer=new TableRenderer(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new RowHeadersRenderer,columnHeaders:new ColumnHeadersRenderer(n),colGroup:new ColGroupRenderer(o),rows:new RowsRenderer(i),cells:new CellsRenderer}),this.renderer.setAxisUtils(a,s)}return _createClass$2o(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function _typeof$2F(e){return _typeof$2F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2F(e)}function _classCallCheck$2n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2z(n.key),n)}}function _createClass$2n(e,t,r){return t&&_defineProperties$2n(e.prototype,t),r&&_defineProperties$2n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2z(e){var t=_toPrimitive$2z(e,"string");return _typeof$2F(t)==="symbol"?t:String(t)}function _toPrimitive$2z(e,t){if(_typeof$2F(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2F(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ColumnUtils=function(){function e(t,r){_classCallCheck$2n(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return _createClass$2n(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,s=a?a.wtTable.holder:o.holder,l=s.offsetHeight<s.scrollHeight?getScrollbarWidth():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-l),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var c=r.getSetting("rowHeaders").length,f=r.getSetting("defaultColumnWidth"),d=0;d<c;d++){var h=Array.isArray(u)?u[d]:u;h=h??f,this.headerWidths.set(d,h)}}}]),e}();function _typeof$2E(e){return _typeof$2E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2E(e)}function _classCallCheck$2m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2y(n.key),n)}}function _createClass$2m(e,t,r){return t&&_defineProperties$2m(e.prototype,t),r&&_defineProperties$2m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2y(e){var t=_toPrimitive$2y(e,"string");return _typeof$2E(t)==="symbol"?t:String(t)}function _toPrimitive$2y(e,t){if(_typeof$2E(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2E(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RowUtils=function(){function e(t,r){_classCallCheck$2m(this,e),this.dataAccessObject=t,this.wtSettings=r}return _createClass$2m(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function _typeof$2D(e){return _typeof$2D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2D(e)}function _toConsumableArray$t(e){return _arrayWithoutHoles$t(e)||_iterableToArray$v(e)||_unsupportedIterableToArray$14(e)||_nonIterableSpread$t()}function _nonIterableSpread$t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$v(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$t(e){if(Array.isArray(e))return _arrayLikeToArray$14(e)}function _slicedToArray$I(e,t){return _arrayWithHoles$K(e)||_iterableToArrayLimit$I(e,t)||_unsupportedIterableToArray$14(e,t)||_nonIterableRest$K()}function _nonIterableRest$K(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$14(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$14(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$14(e,t)}}function _arrayLikeToArray$14(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$I(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$K(e){if(Array.isArray(e))return e}function _classCallCheck$2l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2x(n.key),n)}}function _createClass$2l(e,t,r){return t&&_defineProperties$2l(e.prototype,t),r&&_defineProperties$2l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$G(e,t,r){return t=_toPropertyKey$2x(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2x(e){var t=_toPrimitive$2x(e,"string");return _typeof$2D(t)==="symbol"?t:String(t)}function _toPrimitive$2x(e,t){if(_typeof$2D(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2D(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Table=function(){function e(t,r,n,o,i){var a=this;_classCallCheck$2l(this,e),_defineProperty$G(this,"wtSettings",null),_defineProperty$G(this,"domBindings",void 0),_defineProperty$G(this,"TBODY",null),_defineProperty$G(this,"THEAD",null),_defineProperty$G(this,"COLGROUP",null),_defineProperty$G(this,"hasTableHeight",!0),_defineProperty$G(this,"hasTableWidth",!0),_defineProperty$G(this,"isTableVisible",!1),_defineProperty$G(this,"tableOffset",0),_defineProperty$G(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,removeTextNodes(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(s)}),this.rowUtils=new RowUtils(this.dataAccessObject,this.wtSettings),this.columnUtils=new ColumnUtils(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return _createClass$2l(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!hasClass(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!hasClass(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!hasClass(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,s=n.getSetting("totalRows"),l=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),c=u.length,f=n.getSetting("columnHeaders"),d=f.length,h=!1,y=r;if(this.isMaster&&(this.holderOffset=offset(this.holder),y=a.createRenderCalculators(y),c&&!n.getSetting("fixedColumnsStart"))){var p=i.inlineStartOverlay.getScrollPosition(),v=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,v!==this.correctHeaderWidth&&(y=!1)}if(this.isMaster&&(h=i.updateStateOfRendering()),y)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=offset(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var b=s>0?this.getFirstRenderedRow():0,S=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new RowFilter$1(b,s,d),this.columnFilter=new ColumnFilter$1(S,l,c);var w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var P={};this.wtSettings.getSetting("beforeDraw",!0,P),w=P.skipRender!==!0}if(w){this.tableRenderer.setHeaderContentRenderers(u,f),(this.is(CLONE_BOTTOM)||this.is(CLONE_BOTTOM_INLINE_START_CORNER))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var E;if(this.isMaster&&(E=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(CLONE_BOTTOM))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var j=outerWidth(this.hider),G=outerWidth(this.TABLE);j!==0&&G!==j&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),E!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(CLONE_BOTTOM)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var q=!1;return this.isMaster&&(q=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(q=i.bottomOverlay.resetFixedPosition()||q),q=i.inlineStartOverlay.resetFixedPosition()||q,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),q?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(y),h&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,s,l,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),s=this.getColumnHeader(n,o),s&&(l=innerHeight(s),(!a&&i<l||a<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,s=i.length;a<s;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(CLONE_BOTTOM))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)removeClass(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var s=[],l=0;l<a;l++){for(var u=i[l].settings,c=u.highlightHeaderClassName,f=u.highlightRowClassName,d=u.highlightColumnClassName,h=i[l].classNames,y=h.length,p=0;p<y;p++)s.includes(h[p])||s.push(h[p]);c&&!s.includes(c)&&s.push(c),f&&!s.includes(f)&&s.push(f),d&&!s.includes(d)&&s.push(d)}var v=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(v))for(var b=0;b<v.length;b++)s.push(v[b]);for(var S=s.length,w=0;w<S;w++)this.removeClassFromCells(s[w])}for(var P=0;P<a;P++)i[P].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=_slicedToArray$I(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");var l=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!l&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return l}},{key:"getRow",value:function(r){var n=null,o=null;if(r<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(r),o=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),o=this.TBODY}return n!==void 0&&o!==void 0?o.childNodes.length<n+1?!1:o.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],s=a==null?void 0:a.childNodes[i];s&&n.push(s)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=closest(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=index(o),s=n.cellIndex;if(overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,n,this.wtRootElement)||overlayContainsElement(CLONE_TOP,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,n,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM,n,this.wtRootElement)){var l=this.wtSettings.getSetting("totalRows");a=l-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,n,this.wtRootElement)||overlayContainsElement(CLONE_INLINE_START,n,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(a,s)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=innerHeight(this.TBODY)-1,i,a,s,l,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,s=this.rowFilter.renderedToSource(r),i=this.getRowHeight(s),l=this.getTrForRow(s),u=l.querySelector("th"),u?a=innerHeight(u):a=innerHeight(l)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return outerWidth(this.TABLE)}},{key:"getHeight",value:function(){return outerHeight(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=outerWidth(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=outerHeight(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return isVisible(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=isFunction(r)?r():null;return Array.isArray(n)?(n=_toConsumableArray$t(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const Table$1=Table;var MIXIN_NAME$6="stickyRowsBottom",stickyRowsBottom={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};defineGetter(stickyRowsBottom,"MIXIN_NAME",MIXIN_NAME$6,{writable:!1,enumerable:!1});const stickyRowsBottom$1=stickyRowsBottom;var MIXIN_NAME$5="stickyColumnsStart",stickyColumnsStart={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};defineGetter(stickyColumnsStart,"MIXIN_NAME",MIXIN_NAME$5,{writable:!1,enumerable:!1});const stickyColumnsStart$1=stickyColumnsStart;function _typeof$2C(e){return _typeof$2C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2C(e)}function _defineProperties$2k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2w(n.key),n)}}function _createClass$2k(e,t,r){return t&&_defineProperties$2k(e.prototype,t),r&&_defineProperties$2k(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2w(e){var t=_toPrimitive$2w(e,"string");return _typeof$2C(t)==="symbol"?t:String(t)}function _toPrimitive$2w(e,t){if(_typeof$2C(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2C(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classCallCheck$2k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$1i(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1j(e,t)}function _setPrototypeOf$1j(e,t){return _setPrototypeOf$1j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1j(e,t)}function _createSuper$1i(e){var t=_isNativeReflectConstruct$1j();return function(){var n=_getPrototypeOf$1i(e),o;if(t){var i=_getPrototypeOf$1i(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1i(this,o)}}function _possibleConstructorReturn$1i(e,t){if(t&&(_typeof$2C(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1i(e)}function _assertThisInitialized$1i(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1j(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1i(e){return _getPrototypeOf$1i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1i(e)}var BottomInlineStartCornerOverlayTable=function(e){_inherits$1i(r,e);var t=_createSuper$1i(r);function r(n,o,i,a){return _classCallCheck$2k(this,r),t.call(this,n,o,i,a,CLONE_BOTTOM_INLINE_START_CORNER)}return _createClass$2k(r)}(Table$1);mixin(BottomInlineStartCornerOverlayTable,stickyRowsBottom$1);mixin(BottomInlineStartCornerOverlayTable,stickyColumnsStart$1);const BottomInlineStartCornerOverlayTable$1=BottomInlineStartCornerOverlayTable;var CLONE_TOP="top",CLONE_BOTTOM="bottom",CLONE_INLINE_START="inline_start",CLONE_TOP_INLINE_START_CORNER="top_inline_start_corner",CLONE_BOTTOM_INLINE_START_CORNER="bottom_inline_start_corner",CLONE_TYPES=[CLONE_TOP,CLONE_BOTTOM,CLONE_INLINE_START,CLONE_TOP_INLINE_START_CORNER,CLONE_BOTTOM_INLINE_START_CORNER],CLONE_CLASS_NAMES=new Map([[CLONE_TOP,"ht_clone_".concat(CLONE_TOP)],[CLONE_BOTTOM,"ht_clone_".concat(CLONE_BOTTOM)],[CLONE_INLINE_START,"ht_clone_".concat(CLONE_INLINE_START," ht_clone_left")],[CLONE_TOP_INLINE_START_CORNER,"ht_clone_".concat(CLONE_TOP_INLINE_START_CORNER," ht_clone_top_left_corner")],[CLONE_BOTTOM_INLINE_START_CORNER,"ht_clone_".concat(CLONE_BOTTOM_INLINE_START_CORNER," ht_clone_bottom_left_corner")]]);function _typeof$2B(e){return _typeof$2B=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2B(e)}function _classCallCheck$2j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2v(n.key),n)}}function _createClass$2j(e,t,r){return t&&_defineProperties$2j(e.prototype,t),r&&_defineProperties$2j(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$F(e,t,r){return t=_toPropertyKey$2v(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2v(e){var t=_toPrimitive$2v(e,"string");return _typeof$2B(t)==="symbol"?t:String(t)}function _toPrimitive$2v(e,t){if(_typeof$2B(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2B(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Scroll=function(){function e(t){_classCallCheck$2j(this,e),_defineProperty$F(this,"dataAccessObject",void 0),_defineProperty$F(this,"lastScrolledColumnPos",-1),_defineProperty$F(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return _createClass$2j(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var s=this.scrollViewportHorizontally(r.col,o,a),l=this.scrollViewportVertically(r.row,n,i);return s||l}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,s=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),c=n===void 0&&o===void 0,f=this.dataAccessObject,d=f.fixedColumnsStart,h=f.inlineStartOverlay;if(c&&r<d)return!1;var y=!1;return l===-1?y=h.scrollTo(r,c?r>this.lastScrolledColumnPos:n):(c&&(r<l||r>u)||!c)&&(y=h.scrollTo(r,c?r>u:n)),y&&(this.lastScrolledColumnPos=r),y}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,s=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),c=n===void 0&&o===void 0,f=this.dataAccessObject,d=f.fixedRowsBottom,h=f.fixedRowsTop,y=f.topOverlay;if(c&&(r<h||r>s-d-1))return!1;var p=!1;return l===-1?p=y.scrollTo(r,c?r>this.lastScrolledRowPos:o):(c&&(r<l||r>u)||!c)&&(p=y.scrollTo(r,c?r>u:o)),p&&(this.lastScrolledRowPos=r),p}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,s=r.fixedRowsTop,l=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===l){var c=offset(o.wtRootElement),f=innerHeight(o.hider),d=innerHeight(l),h=getScrollTop(l,l);if(c.top+f-d<=h){var y=i.getColumnHeaderHeight();y+=n.sumCellSizes(0,s);for(var p=a;p>0;p--)if(y+=n.sumCellSizes(p-1,p),c.top+f-y<=h){u=p;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,s=r.rootWindow,l=o.getLastVisibleRow();if(n.mainTableScrollableElement===s){var u=offset(o.wtRootElement),c=getScrollTop(s,s);if(u.top>c){for(var f=innerHeight(s),d=i.getColumnHeaderHeight(),h=1;h<=a;h++)if(d+=n.sumCellSizes(h-1,h),u.top+d-c>=f){l=h-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,s=r.rootWindow,l=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===s){var u=offset(o.wtRootElement),c=innerWidth(o.hider),f=innerWidth(s),d=Math.abs(getScrollLeft(s,s));if(u.left+c-f<=d){for(var h=i.getRowHeaderWidth(),y=a;y>0;y--)if(h+=n.sumCellSizes(y-1,y),u.left+c-h<=d){l=y;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,s=r.rootWindow,l=o.getLastVisibleColumn();if(n.mainTableScrollableElement===s){var u=offset(o.wtRootElement),c=Math.abs(getScrollLeft(s,s));if(u.left>c){for(var f=innerWidth(s),d=i.getRowHeaderWidth(),h=1;h<=a;h++)if(d+=n.sumCellSizes(h-1,h),u.left+d-c>=f){l=h-2;break}}}return l}}]),e}();const Scroll$1=Scroll;function _typeof$2A(e){return _typeof$2A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2A(e)}function _classCallCheck$2i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2u(n.key),n)}}function _createClass$2i(e,t,r){return t&&_defineProperties$2i(e.prototype,t),r&&_defineProperties$2i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$E(e,t,r){return t=_toPropertyKey$2u(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2u(e){var t=_toPrimitive$2u(e,"string");return _typeof$2A(t)==="symbol"?t:String(t)}function _toPrimitive$2u(e,t){if(_typeof$2A(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2A(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CoreAbstract=function(){function e(t,r){_classCallCheck$2i(this,e),_defineProperty$E(this,"wtTable",void 0),_defineProperty$E(this,"wtScroll",void 0),_defineProperty$E(this,"wtViewport",void 0),_defineProperty$E(this,"wtOverlays",void 0),_defineProperty$E(this,"selections",void 0),_defineProperty$E(this,"wtEvent",void 0),_defineProperty$E(this,"guid","wt_".concat(randomString())),_defineProperty$E(this,"drawInterrupted",!1),_defineProperty$E(this,"drawn",!1),_defineProperty$E(this,"domBindings",void 0),_defineProperty$E(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Scroll$1(this.createScrollDao())}return _createClass$2i(e,[{key:"eventManager",get:function(){return new EventManager$1(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){fastInnerText(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new CellCoords$1(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new CellRange$1(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<s&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function _typeof$2z(e){return _typeof$2z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2z(e)}function _defineProperties$2h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2t(n.key),n)}}function _createClass$2h(e,t,r){return t&&_defineProperties$2h(e.prototype,t),r&&_defineProperties$2h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck$2h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$1h(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1i(e,t)}function _setPrototypeOf$1i(e,t){return _setPrototypeOf$1i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1i(e,t)}function _createSuper$1h(e){var t=_isNativeReflectConstruct$1i();return function(){var n=_getPrototypeOf$1h(e),o;if(t){var i=_getPrototypeOf$1h(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1h(this,o)}}function _possibleConstructorReturn$1h(e,t){if(t&&(_typeof$2z(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1h(e)}function _assertThisInitialized$1h(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1i(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1h(e){return _getPrototypeOf$1h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1h(e)}function _defineProperty$D(e,t,r){return t=_toPropertyKey$2t(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2t(e){var t=_toPrimitive$2t(e,"string");return _typeof$2z(t)==="symbol"?t:String(t)}function _toPrimitive$2t(e,t){if(_typeof$2z(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2z(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Clone=function(e){_inherits$1h(r,e);var t=_createSuper$1h(r);function r(n,o,i){var a;_classCallCheck$2h(this,r),a=t.call(this,n,o),_defineProperty$D(_assertThisInitialized$1h(a),"cloneSource",void 0),_defineProperty$D(_assertThisInitialized$1h(a),"cloneOverlay",void 0);var s=a.wtSettings.getSetting("facade",_assertThisInitialized$1h(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),s,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new Event$2(s,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return _createClass$2h(r)}(CoreAbstract);function _typeof$2y(e){return _typeof$2y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2y(e)}function _classCallCheck$2g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2s(n.key),n)}}function _createClass$2g(e,t,r){return t&&_defineProperties$2g(e.prototype,t),r&&_defineProperties$2g(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$C(e,t,r){return t=_toPropertyKey$2s(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2s(e){var t=_toPrimitive$2s(e,"string");return _typeof$2y(t)==="symbol"?t:String(t)}function _toPrimitive$2s(e,t){if(_typeof$2y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Overlay=function(){function e(t,r,n,o,i){_classCallCheck$2g(this,e),_defineProperty$C(this,"wtSettings",null),defineGetter(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,s=a.TABLE,l=a.hider,u=a.spreader,c=a.holder,f=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return _createClass$2g(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=getScrollableElement(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){warn("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),l=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(u),top:u.offsetTop},f={start:this.getRelativeStartPosition(r),top:r.offsetTop},d=null;return i?d=this.getRelativeCellPositionWithinWindow(s,a,f,c):d=this.getRelativeCellPositionWithinHolder(s,l,a,f,c),d}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(!n)s=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+getScrollbarWidth())),s=u<=0?-1*u:0}if(r){var c=this.clone.wtTable.TABLE.getBoundingClientRect();l=c.top-a.top}else l=i.top;return{start:o.start+s,top:o.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},l=0,u=0;if(o||(l=s.horizontal-a.start),n){var c=this.wot.wtTable.wtRootElement.getBoundingClientRect(),f=this.clone.wtTable.TABLE.getBoundingClientRect();u=f.top*-1+c.top}else r||(u=s.vertical-a.top);return{start:i.start-l,top:i.top-u}}},{key:"makeClone",value:function(){if(CLONE_TYPES.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),s=o.createElement("TABLE"),l=r.wtRootElement.parentNode;a.className="".concat(CLONE_CLASS_NAMES.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,s.className=r.TABLE.className,a.appendChild(s),l.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===CLONE_TOP||u==="vertical"&&this.type===CLONE_INLINE_START?this.mainTableScrollableElement=i:i.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=getScrollableElement(r.TABLE),new Clone(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;arrayEach([o,i,a],function(s){s.width="",s.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function _typeof$2x(e){return _typeof$2x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2x(e)}function _construct$5(e,t,r){return _isNativeReflectConstruct$1h()?_construct$5=Reflect.construct.bind():_construct$5=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&_setPrototypeOf$1h(u,a.prototype),u},_construct$5.apply(null,arguments)}function _classCallCheck$2f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2r(n.key),n)}}function _createClass$2f(e,t,r){return t&&_defineProperties$2f(e.prototype,t),r&&_defineProperties$2f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2r(e){var t=_toPrimitive$2r(e,"string");return _typeof$2x(t)==="symbol"?t:String(t)}function _toPrimitive$2r(e,t){if(_typeof$2x(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2x(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$1g(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1h(e,t)}function _setPrototypeOf$1h(e,t){return _setPrototypeOf$1h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1h(e,t)}function _createSuper$1g(e){var t=_isNativeReflectConstruct$1h();return function(){var n=_getPrototypeOf$1g(e),o;if(t){var i=_getPrototypeOf$1g(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1g(this,o)}}function _possibleConstructorReturn$1g(e,t){if(t&&(_typeof$2x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1g(e)}function _assertThisInitialized$1g(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1h(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1g(e){return _getPrototypeOf$1g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1g(e)}var BottomInlineStartCornerOverlay=function(e){_inherits$1g(r,e);var t=_createSuper$1g(r);function r(n,o,i,a,s,l){var u;return _classCallCheck$2f(this,r),u=t.call(this,n,o,CLONE_BOTTOM_INLINE_START_CORNER,i,a),u.bottomOverlay=s,u.inlineStartOverlay=l,u}return _createClass$2f(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return _construct$5(BottomInlineStartCornerOverlayTable$1,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(s,"px")}else resetCssTransform(i),this.repositionOverlay();var l=outerHeight(this.clone.wtTable.TABLE),u=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),i.style.height="".concat(l,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=getScrollbarWidth(s)),l.style.bottom="".concat(u,"px")}}]),r}(Overlay),MIXIN_NAME$4="calculatedColumns",calculatedColumns={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};defineGetter(calculatedColumns,"MIXIN_NAME",MIXIN_NAME$4,{writable:!1,enumerable:!1});const calculatedColumns$1=calculatedColumns;function _typeof$2w(e){return _typeof$2w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2w(e)}function _defineProperties$2e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2q(n.key),n)}}function _createClass$2e(e,t,r){return t&&_defineProperties$2e(e.prototype,t),r&&_defineProperties$2e(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2q(e){var t=_toPrimitive$2q(e,"string");return _typeof$2w(t)==="symbol"?t:String(t)}function _toPrimitive$2q(e,t){if(_typeof$2w(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2w(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classCallCheck$2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$1f(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1g(e,t)}function _setPrototypeOf$1g(e,t){return _setPrototypeOf$1g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1g(e,t)}function _createSuper$1f(e){var t=_isNativeReflectConstruct$1g();return function(){var n=_getPrototypeOf$1f(e),o;if(t){var i=_getPrototypeOf$1f(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1f(this,o)}}function _possibleConstructorReturn$1f(e,t){if(t&&(_typeof$2w(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1f(e)}function _assertThisInitialized$1f(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1g(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1f(e){return _getPrototypeOf$1f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1f(e)}var BottomOverlayTable=function(e){_inherits$1f(r,e);var t=_createSuper$1f(r);function r(n,o,i,a){return _classCallCheck$2e(this,r),t.call(this,n,o,i,a,CLONE_BOTTOM)}return _createClass$2e(r)}(Table$1);mixin(BottomOverlayTable,stickyRowsBottom$1);mixin(BottomOverlayTable,calculatedColumns$1);const BottomOverlayTable$1=BottomOverlayTable;function _typeof$2v(e){return _typeof$2v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2v(e)}function _construct$4(e,t,r){return _isNativeReflectConstruct$1f()?_construct$4=Reflect.construct.bind():_construct$4=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&_setPrototypeOf$1f(u,a.prototype),u},_construct$4.apply(null,arguments)}function _classCallCheck$2d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2p(n.key),n)}}function _createClass$2d(e,t,r){return t&&_defineProperties$2d(e.prototype,t),r&&_defineProperties$2d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _inherits$1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1f(e,t)}function _setPrototypeOf$1f(e,t){return _setPrototypeOf$1f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1f(e,t)}function _createSuper$1e(e){var t=_isNativeReflectConstruct$1f();return function(){var n=_getPrototypeOf$1e(e),o;if(t){var i=_getPrototypeOf$1e(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1e(this,o)}}function _possibleConstructorReturn$1e(e,t){if(t&&(_typeof$2v(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1e(e)}function _assertThisInitialized$1e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1f(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1e(e){return _getPrototypeOf$1e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1e(e)}function _defineProperty$B(e,t,r){return t=_toPropertyKey$2p(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2p(e){var t=_toPrimitive$2p(e,"string");return _typeof$2v(t)==="symbol"?t:String(t)}function _toPrimitive$2p(e,t){if(_typeof$2v(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BottomOverlay=function(e){_inherits$1e(r,e);var t=_createSuper$1e(r);function r(n,o,i,a){var s;return _classCallCheck$2d(this,r),s=t.call(this,n,o,CLONE_BOTTOM,i,a),_defineProperty$B(_assertThisInitialized$1e(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return _createClass$2d(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return _construct$4(BottomOverlayTable$1,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!s||s!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var l=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),l}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=getScrollbarWidth(s)),l.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(getWindowScrollLeft(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,s=a.wtTable,l=a.wtSettings,u=l.getSetting("defaultRowHeight"),c=o,f=0;c<i;){var d=s.getRowHeight(c);f+=d===void 0?u:d,c+=1}return f}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,s=this.domBindings,l=s.rootDocument,u=s.rootWindow,c=getScrollbarWidth(l),f=this.clone.wtTable.holder.parentNode,d=f.style,h=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||h==="horizontal"){var y=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(y-=c),y=Math.min(y,i.wtRootElement.scrollWidth),d.width="".concat(y,"px")}else d.width="";this.clone.wtTable.holder.style.width=d.width;var p=outerHeight(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(p=0),d.height="".concat(p,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;i&&l.offsetHeight!==l.clientHeight&&(u=getScrollbarWidth(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l,c=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-c+s,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,s=this.wtSettings.getSetting("columnHeaders"),l=!1;if((a||i===0)&&s.length>0){var u=this.wot.wtTable.holder.parentNode,c=hasClass(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(addClass(u,"innerBorderBottom"),l=!c):(removeClass(u,"innerBorderBottom"),l=c)}return l}}]),r}(Overlay),MIXIN_NAME$3="calculatedRows",calculatedRows={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};defineGetter(calculatedRows,"MIXIN_NAME",MIXIN_NAME$3,{writable:!1,enumerable:!1});const calculatedRows$1=calculatedRows;function _typeof$2u(e){return _typeof$2u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2u(e)}function _defineProperties$2c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2o(n.key),n)}}function _createClass$2c(e,t,r){return t&&_defineProperties$2c(e.prototype,t),r&&_defineProperties$2c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2o(e){var t=_toPrimitive$2o(e,"string");return _typeof$2u(t)==="symbol"?t:String(t)}function _toPrimitive$2o(e,t){if(_typeof$2u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classCallCheck$2c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$1d(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1e(e,t)}function _setPrototypeOf$1e(e,t){return _setPrototypeOf$1e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1e(e,t)}function _createSuper$1d(e){var t=_isNativeReflectConstruct$1e();return function(){var n=_getPrototypeOf$1d(e),o;if(t){var i=_getPrototypeOf$1d(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1d(this,o)}}function _possibleConstructorReturn$1d(e,t){if(t&&(_typeof$2u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1d(e)}function _assertThisInitialized$1d(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1d(e){return _getPrototypeOf$1d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1d(e)}var InlineStartOverlayTable=function(e){_inherits$1d(r,e);var t=_createSuper$1d(r);function r(n,o,i,a){return _classCallCheck$2c(this,r),t.call(this,n,o,i,a,CLONE_INLINE_START)}return _createClass$2c(r)}(Table$1);mixin(InlineStartOverlayTable,calculatedRows$1);mixin(InlineStartOverlayTable,stickyColumnsStart$1);const InlineStartOverlayTable$1=InlineStartOverlayTable;function _typeof$2t(e){return _typeof$2t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2t(e)}function _construct$3(e,t,r){return _isNativeReflectConstruct$1d()?_construct$3=Reflect.construct.bind():_construct$3=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&_setPrototypeOf$1d(u,a.prototype),u},_construct$3.apply(null,arguments)}function _classCallCheck$2b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2n(n.key),n)}}function _createClass$2b(e,t,r){return t&&_defineProperties$2b(e.prototype,t),r&&_defineProperties$2b(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2n(e){var t=_toPrimitive$2n(e,"string");return _typeof$2t(t)==="symbol"?t:String(t)}function _toPrimitive$2n(e,t){if(_typeof$2t(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2t(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$1c(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1d(e,t)}function _setPrototypeOf$1d(e,t){return _setPrototypeOf$1d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1d(e,t)}function _createSuper$1c(e){var t=_isNativeReflectConstruct$1d();return function(){var n=_getPrototypeOf$1c(e),o;if(t){var i=_getPrototypeOf$1c(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1c(this,o)}}function _possibleConstructorReturn$1c(e,t){if(t&&(_typeof$2t(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1c(e)}function _assertThisInitialized$1c(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1d(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1c(e){return _getPrototypeOf$1c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1c(e)}var InlineStartOverlay=function(e){_inherits$1c(r,e);var t=_createSuper$1c(r);function r(n,o,i,a){return _classCallCheck$2b(this,r),t.call(this,n,o,CLONE_INLINE_START,i,a)}return _createClass$2b(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return _construct$3(InlineStartOverlayTable$1,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer===i&&(!s||s!=="horizontal")?(l=this.getOverlayOffset()*(this.isRtl()?-1:1),setOverlayPosition(a,"".concat(l,"px"),"0px")):(l=this.getScrollPosition(),resetCssTransform(a));var u=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,getWindowScrollTop(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),s=o,l=0;s<i;)l+=this.wot.wtTable.getStretchedColumnWidth(s)||a,s+=1;return l}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,s=i.rootWindow,l=getScrollbarWidth(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||f==="vertical"){var d=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(d-=l),d=Math.min(d,o.wtRootElement.scrollHeight),c.height="".concat(d,"px")}else c.height="";this.clone.wtTable.holder.style.height=c.height;var h=outerWidth(this.clone.wtTable.TABLE);c.width="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,s=this.facadeGetter(),l=Math.abs((o=a==null?void 0:a.getCell().getBorder(s).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+l,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;if(i){var c=this.wot.wtTable.getColumnWidth(o),f=this.wot.wtViewport.getViewportWidth();c>f&&(i=!1)}return i&&l.offsetWidth!==l.clientWidth&&(u=getScrollbarWidth(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(getScrollLeft(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var s=this.wot.wtTable.getTotalWidth(),l=this.clone.wtTable.getTotalWidth(),u=s-l;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),s=this.wtSettings.getSetting("fixedColumnsStart"),l=this.wtSettings.getSetting("totalRows");l?removeClass(i,"emptyRows"):addClass(i,"emptyRows");var u=!1;if(s&&!a.length)addClass(i,"innerBorderLeft innerBorderInlineStart");else if(!s&&a.length){var c=hasClass(i,"innerBorderInlineStart");o?(addClass(i,"innerBorderLeft innerBorderInlineStart"),u=!c):(removeClass(i,"innerBorderLeft innerBorderInlineStart"),u=c)}return u}}]),r}(Overlay),MIXIN_NAME$2="stickyRowsTop",stickyRowsTop={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};defineGetter(stickyRowsTop,"MIXIN_NAME",MIXIN_NAME$2,{writable:!1,enumerable:!1});const stickyRowsTop$1=stickyRowsTop;function _typeof$2s(e){return _typeof$2s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2s(e)}function _defineProperties$2a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2m(n.key),n)}}function _createClass$2a(e,t,r){return t&&_defineProperties$2a(e.prototype,t),r&&_defineProperties$2a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2m(e){var t=_toPrimitive$2m(e,"string");return _typeof$2s(t)==="symbol"?t:String(t)}function _toPrimitive$2m(e,t){if(_typeof$2s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classCallCheck$2a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$1b(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1c(e,t)}function _setPrototypeOf$1c(e,t){return _setPrototypeOf$1c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1c(e,t)}function _createSuper$1b(e){var t=_isNativeReflectConstruct$1c();return function(){var n=_getPrototypeOf$1b(e),o;if(t){var i=_getPrototypeOf$1b(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1b(this,o)}}function _possibleConstructorReturn$1b(e,t){if(t&&(_typeof$2s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1b(e)}function _assertThisInitialized$1b(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1c(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1b(e){return _getPrototypeOf$1b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1b(e)}var TopInlineStartCornerOverlayTable=function(e){_inherits$1b(r,e);var t=_createSuper$1b(r);function r(n,o,i,a){return _classCallCheck$2a(this,r),t.call(this,n,o,i,a,CLONE_TOP_INLINE_START_CORNER)}return _createClass$2a(r)}(Table$1);mixin(TopInlineStartCornerOverlayTable,stickyRowsTop$1);mixin(TopInlineStartCornerOverlayTable,stickyColumnsStart$1);const TopInlineStartCornerOverlayTable$1=TopInlineStartCornerOverlayTable;function _typeof$2r(e){return _typeof$2r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2r(e)}function _construct$2(e,t,r){return _isNativeReflectConstruct$1b()?_construct$2=Reflect.construct.bind():_construct$2=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&_setPrototypeOf$1b(u,a.prototype),u},_construct$2.apply(null,arguments)}function _classCallCheck$29(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$29(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2l(n.key),n)}}function _createClass$29(e,t,r){return t&&_defineProperties$29(e.prototype,t),r&&_defineProperties$29(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _inherits$1a(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1b(e,t)}function _setPrototypeOf$1b(e,t){return _setPrototypeOf$1b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1b(e,t)}function _createSuper$1a(e){var t=_isNativeReflectConstruct$1b();return function(){var n=_getPrototypeOf$1a(e),o;if(t){var i=_getPrototypeOf$1a(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1a(this,o)}}function _possibleConstructorReturn$1a(e,t){if(t&&(_typeof$2r(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1a(e)}function _assertThisInitialized$1a(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1a(e){return _getPrototypeOf$1a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1a(e)}function _defineProperty$A(e,t,r){return t=_toPropertyKey$2l(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2l(e){var t=_toPrimitive$2l(e,"string");return _typeof$2r(t)==="symbol"?t:String(t)}function _toPrimitive$2l(e,t){if(_typeof$2r(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2r(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TopInlineStartCornerOverlay=function(e){_inherits$1a(r,e);var t=_createSuper$1a(r);function r(n,o,i,a,s,l){var u;return _classCallCheck$29(this,r),u=t.call(this,n,o,CLONE_TOP_INLINE_START_CORNER,i,a),_defineProperty$A(_assertThisInitialized$1a(u),"topOverlay",void 0),_defineProperty$A(_assertThisInitialized$1a(u),"inlineStartOverlay",void 0),u.topOverlay=s,u.inlineStartOverlay=l,u}return _createClass$29(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return _construct$2(TopInlineStartCornerOverlayTable$1,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();setOverlayPosition(o,"".concat(i,"px"),"".concat(a,"px"))}else resetCssTransform(o);var s=outerHeight(this.clone.wtTable.TABLE),l=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),o.style.height="".concat(s,"px"),o.style.width="".concat(l,"px"),!1}}]),r}(Overlay);function _typeof$2q(e){return _typeof$2q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2q(e)}function _defineProperties$28(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2k(n.key),n)}}function _createClass$28(e,t,r){return t&&_defineProperties$28(e.prototype,t),r&&_defineProperties$28(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2k(e){var t=_toPrimitive$2k(e,"string");return _typeof$2q(t)==="symbol"?t:String(t)}function _toPrimitive$2k(e,t){if(_typeof$2q(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2q(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classCallCheck$28(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$19(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1a(e,t)}function _setPrototypeOf$1a(e,t){return _setPrototypeOf$1a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1a(e,t)}function _createSuper$19(e){var t=_isNativeReflectConstruct$1a();return function(){var n=_getPrototypeOf$19(e),o;if(t){var i=_getPrototypeOf$19(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$19(this,o)}}function _possibleConstructorReturn$19(e,t){if(t&&(_typeof$2q(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$19(e)}function _assertThisInitialized$19(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1a(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$19(e){return _getPrototypeOf$19=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$19(e)}var TopOverlayTable=function(e){_inherits$19(r,e);var t=_createSuper$19(r);function r(n,o,i,a){return _classCallCheck$28(this,r),t.call(this,n,o,i,a,CLONE_TOP)}return _createClass$28(r)}(Table$1);mixin(TopOverlayTable,stickyRowsTop$1);mixin(TopOverlayTable,calculatedColumns$1);const TopOverlayTable$1=TopOverlayTable;function _typeof$2p(e){return _typeof$2p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2p(e)}function _construct$1(e,t,r){return _isNativeReflectConstruct$19()?_construct$1=Reflect.construct.bind():_construct$1=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&_setPrototypeOf$19(u,a.prototype),u},_construct$1.apply(null,arguments)}function _classCallCheck$27(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$27(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2j(n.key),n)}}function _createClass$27(e,t,r){return t&&_defineProperties$27(e.prototype,t),r&&_defineProperties$27(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _inherits$18(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$19(e,t)}function _setPrototypeOf$19(e,t){return _setPrototypeOf$19=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$19(e,t)}function _createSuper$18(e){var t=_isNativeReflectConstruct$19();return function(){var n=_getPrototypeOf$18(e),o;if(t){var i=_getPrototypeOf$18(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$18(this,o)}}function _possibleConstructorReturn$18(e,t){if(t&&(_typeof$2p(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$18(e)}function _assertThisInitialized$18(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$19(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$18(e){return _getPrototypeOf$18=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$18(e)}function _defineProperty$z(e,t,r){return t=_toPropertyKey$2j(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2j(e){var t=_toPrimitive$2j(e,"string");return _typeof$2p(t)==="symbol"?t:String(t)}function _toPrimitive$2j(e,t){if(_typeof$2p(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2p(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TopOverlay=function(e){_inherits$18(r,e);var t=_createSuper$18(r);function r(n,o,i,a){var s;return _classCallCheck$27(this,r),s=t.call(this,n,o,CLONE_TOP,i,a),_defineProperty$z(_assertThisInitialized$18(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return _createClass$27(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return _construct$1(TopOverlayTable$1,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),s=0,l=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,c=u.hider.getBoundingClientRect(),f=Math.ceil(c.bottom),d=o.offsetHeight;l=f===d,s=this.getOverlayOffset(),setOverlayPosition(o,"0px","".concat(s,"px"))}else s=this.getScrollPosition(),resetCssTransform(o);var h=this.adjustHeaderBordersPosition(s,l);return this.adjustElementsSize(),h}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(getWindowScrollLeft(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),s=o,l=0;s<i;){var u=this.wot.wtTable.getRowHeight(s);l+=u===void 0?a:u,s+=1}return l}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,s=i.rootWindow,l=getScrollbarWidth(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||f==="horizontal"){var d=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(d-=l),d=Math.min(d,o.wtRootElement.scrollWidth),c.width="".concat(d,"px")}else c.width="";this.clone.wtTable.holder.style.width=c.width;var h=outerHeight(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),c.height="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,s=this.facadeGetter(),l=Math.abs((o=a==null?void 0:a.getCell().getBorder(s).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+l,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,s=this.wtSettings,l=a.cloneSource?a.cloneSource:a,u=l.wtTable.holder,c=this.getTableParentOffset(),f=0;if(i){var d=this.wot.wtTable.getRowHeight(o),h=this.wot.wtViewport.getViewportHeight();d>h&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(f=getScrollbarWidth(this.domBindings.rootDocument)),i){var y=s.getSetting("fixedRowsBottom"),p=s.getSetting("totalRows");c+=this.sumCellSizes(0,o+1),c-=a.wtViewport.getViewportHeight()-this.sumCellSizes(p-y,p),c+=1}else c+=this.sumCellSizes(s.getSetting("fixedRowsTop"),o);return c+=f,this.setScrollPosition(c)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("totalColumns");s?removeClass(a,"emptyColumns"):addClass(a,"emptyColumns");var l=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==u,f=this.wtSettings.getSetting("columnHeaders");if((c||u===0)&&f.length>0){var d=hasClass(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(addClass(a,"innerBorderTop"),l=!d):(removeClass(a,"innerBorderTop"),l=d)}}return l}}]),r}(Overlay);function _typeof$2o(e){return _typeof$2o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2o(e)}function _construct(e,t,r){return _isNativeReflectConstruct$18()?_construct=Reflect.construct.bind():_construct=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&_setPrototypeOf$18(u,a.prototype),u},_construct.apply(null,arguments)}function _isNativeReflectConstruct$18(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _setPrototypeOf$18(e,t){return _setPrototypeOf$18=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$18(e,t)}function _classCallCheck$26(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$26(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2i(n.key),n)}}function _createClass$26(e,t,r){return t&&_defineProperties$26(e.prototype,t),r&&_defineProperties$26(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$y(e,t,r){return t=_toPropertyKey$2i(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2i(e){var t=_toPrimitive$2i(e,"string");return _typeof$2o(t)==="symbol"?t:String(t)}function _toPrimitive$2i(e,t){if(_typeof$2o(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2o(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Overlays=function(){function e(t,r,n,o,i,a){var s=this;_classCallCheck$26(this,e),_defineProperty$y(this,"wot",null),_defineProperty$y(this,"topOverlay",null),_defineProperty$y(this,"bottomOverlay",null),_defineProperty$y(this,"inlineStartOverlay",null),_defineProperty$y(this,"topInlineStartCornerOverlay",null),_defineProperty$y(this,"bottomInlineStartCornerOverlay",null),_defineProperty$y(this,"browserLineHeight",void 0),_defineProperty$y(this,"wtSettings",null),_defineProperty$y(this,"resizeObserver",new ResizeObserver(function(d){requestAnimationFrame(function(){!Array.isArray(d)||!d.length||s.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var l=this.domBindings,u=l.rootDocument,c=l.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=getScrollbarWidth(u);var f=c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=f?a.holder:getScrollableElement(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return _createClass$26(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),s=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||s}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=_construct(TopOverlay,r),this.bottomOverlay=_construct(BottomOverlay,r),this.inlineStartOverlay=_construct(InlineStartOverlay,r),this.topInlineStartCornerOverlay=_construct(TopInlineStartCornerOverlay,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=_construct(BottomInlineStartCornerOverlay,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,s=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(y){return r.onKeyDown(y)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(y){return r.onTableScroll(y)},{passive:!0}),a!==s&&this.eventManager.addEventListener(s,"scroll",function(y){return r.onTableScroll(y)},{passive:!0});var l=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,c=this.wtSettings.getSetting("preventWheel"),f={passive:u};(c||l||!isChrome())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(y){return r.onCloneWheel(y,c)},f);var d=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];d.forEach(function(y){if(y&&y.needFullRender){var p=y.clone.wtTable.holder;r.eventManager.addEventListener(p,"wheel",function(v){return r.onCloneWheel(v,c)},f)}});var h;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(h),h=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,s=r.target,l=a!==o&&s!==o&&!s.contains(a),u=i!==o&&s!==o&&!s.contains(i);if(!(this.keyPressed&&(l||u))){var c=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&c)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=isKey(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],s=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==s||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var l=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;l&&(l.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=s),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=getScrollableElement(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,i=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),i}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),l=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(s+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(l+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var c=o.wtRootElement,f=c.scrollHeight,d=c.scrollWidth,h=o.holder,y=h.scrollHeight,p=h.scrollWidth;this.hasScrollbarRight=f<y,this.hasScrollbarBottom=d<p,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>d?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>f&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return arrayEach(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];arrayEach(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const Overlays$1=Overlays;function _typeof$2n(e){return _typeof$2n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2n(e)}function _classCallCheck$25(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$25(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2h(n.key),n)}}function _createClass$25(e,t,r){return t&&_defineProperties$25(e.prototype,t),r&&_defineProperties$25(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$x(e,t,r){return t=_toPropertyKey$2h(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2h(e){var t=_toPrimitive$2h(e,"string");return _typeof$2n(t)==="symbol"?t:String(t)}function _toPrimitive$2h(e,t){if(_typeof$2n(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2n(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Settings=function(){function e(t){var r=this;_classCallCheck$25(this,e),_defineProperty$x(this,"settings",{}),_defineProperty$x(this,"defaults",Object.freeze(this.getDefaults())),objectEach(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return _createClass$25(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var s=r.getSetting("data",o,i);fastInnerText(a,s??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?objectEach(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function _typeof$2m(e){return _typeof$2m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2m(e)}function _classCallCheck$24(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$24(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2g(n.key),n)}}function _createClass$24(e,t,r){return t&&_defineProperties$24(e.prototype,t),r&&_defineProperties$24(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2g(e){var t=_toPrimitive$2g(e,"string");return _typeof$2m(t)==="symbol"?t:String(t)}function _toPrimitive$2g(e,t){if(_typeof$2m(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2m(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$17(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$17(e,t)}function _setPrototypeOf$17(e,t){return _setPrototypeOf$17=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$17(e,t)}function _createSuper$17(e){var t=_isNativeReflectConstruct$17();return function(){var n=_getPrototypeOf$17(e),o;if(t){var i=_getPrototypeOf$17(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$17(this,o)}}function _possibleConstructorReturn$17(e,t){if(t&&(_typeof$2m(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$17(e)}function _assertThisInitialized$17(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$17(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$17(e){return _getPrototypeOf$17=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$17(e)}var MasterTable=function(e){_inherits$17(r,e);var t=_createSuper$17(r);function r(n,o,i,a){return _classCallCheck$24(this,r),t.call(this,n,o,i,a,"master")}return _createClass$24(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=getTrimmingContainer(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var s=o.parentElement,l=getStyle(o,"height",i),u=getStyle(o,"overflow",i),c=this.holder.style,f=o.scrollWidth,d=o.scrollHeight,h=o.getBoundingClientRect(),y=h.width,p=h.height,v=["auto","hidden","scroll"];if(s&&v.includes(u)){var b=o.cloneNode(!1);b.style.overflow="auto",b.style.position="absolute",o.nextElementSibling?s.insertBefore(b,o.nextElementSibling):s.appendChild(b);var S=parseInt(getComputedStyle(b,i).height,10);s.removeChild(b),S===0&&(p=0)}p=Math.min(p,d),c.height=l==="auto"?"auto":"".concat(p,"px"),y=Math.min(y,f),c.width="".concat(y,"px"),c.overflow="",this.hasTableHeight=c.height==="auto"?!0:p>0,this.hasTableWidth=y>0}this.isTableVisible=isVisible(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",s=o.getSetting("columnHeaders"),l=s.length;if(l&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),c=u.length,f=this.getRenderedColumnsCount(),d=0;d<l;d++)for(var h=-1*c;h<f;h++)this.markIfOversizedColumnHeader(h);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(Table$1);mixin(MasterTable,calculatedRows$1);mixin(MasterTable,calculatedColumns$1);const MasterTable$1=MasterTable;function _typeof$2l(e){return _typeof$2l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2l(e)}function _classCallCheck$23(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$23(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2f(n.key),n)}}function _createClass$23(e,t,r){return t&&_defineProperties$23(e.prototype,t),r&&_defineProperties$23(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2f(e){var t=_toPrimitive$2f(e,"string");return _typeof$2l(t)==="symbol"?t:String(t)}function _toPrimitive$2f(e,t){if(_typeof$2l(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2l(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Viewport=function(){function e(t,r,n,o,i){var a=this;_classCallCheck$23(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return _createClass$23(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=outerHeight(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=o.documentElement.offsetWidth,l=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),c=r.getSetting("rtlMode"),f=this.wtTable.TABLE.getBoundingClientRect(),d=c?f.right-s:f.left,h=s-d,y,p;if(u)return outerWidth(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?y=Math.min(h,s):y=Math.min(this.getContainerFillWidth(),h,s),a===i&&l>0&&this.sumColumnWidths(0,l-1)>y)return o.documentElement.clientWidth;if(a!==i&&(p=getStyle(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),p==="scroll"||p==="hidden"||p==="auto"))return Math.max(y,a.clientWidth);var v=r.getSetting("stretchH");return v==="none"||!v?Math.max(y,outerWidth(this.wtTable.TABLE)):y}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return offset(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=outerHeight(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)a?(this.rowHeaderWidth+=outerWidth(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:RENDER_TYPE,n=this.wtSettings,o=this.wtTable,i,a,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===RENDER_TYPE?i=1/0:i=this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;l<0&&(l=0);var u=n.getSetting("fixedRowsTop"),c=n.getSetting("fixedRowsBottom"),f=n.getSetting("totalRows");return u&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,u),l+=s,i-=s),c&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(f-c,f),i-=s),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=getScrollbarWidth(this.domBindings.rootDocument),new ViewportRowsCalculator$1({viewportSize:i,scrollOffset:l,totalItems:n.getSetting("totalRows"),itemSizeFn:function(h){return o.getRowHeight(h)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:RENDER_TYPE,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN,a<0&&(a=0);var s=n.getSetting("fixedColumnsStart");if(s){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);a+=l,i-=l}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=getScrollbarWidth(this.domBindings.rootDocument)),new ViewportColumnsCalculator$1({viewportSize:i,scrollOffset:Math.abs(a),totalItems:n.getSetting("totalColumns"),itemSizeFn:function(c){return o.getColumnWidth(c)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(c,f){return n.getSetting("onBeforeStretchingColumnWidth",c,f)}})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(FULLY_VISIBLE_TYPE),i=this.createColumnsCalculator(FULLY_VISIBLE_TYPE);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(RENDER_TYPE),this.columnsRenderCalculator=this.createColumnsCalculator(RENDER_TYPE)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(FULLY_VISIBLE_TYPE),this.columnsVisibleCalculator=this.createColumnsCalculator(FULLY_VISIBLE_TYPE)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow;if(n===null&&o===null)return!1;var i=this.rowsRenderCalculator,a=i.startRow,s=i.endRow;return n<a||n===a&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn;if(n===null&&o===null)return!1;var i=this.columnsRenderCalculator,a=i.startColumn,s=i.endColumn;return n<a||n===a&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){objectEach(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const Viewport$1=Viewport;function _typeof$2k(e){return _typeof$2k=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2k(e)}function _classCallCheck$22(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$22(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2e(n.key),n)}}function _createClass$22(e,t,r){return t&&_defineProperties$22(e.prototype,t),r&&_defineProperties$22(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2e(e){var t=_toPrimitive$2e(e,"string");return _typeof$2k(t)==="symbol"?t:String(t)}function _toPrimitive$2e(e,t){if(_typeof$2k(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2k(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$16(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$16(e,t)}function _setPrototypeOf$16(e,t){return _setPrototypeOf$16=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$16(e,t)}function _createSuper$16(e){var t=_isNativeReflectConstruct$16();return function(){var n=_getPrototypeOf$16(e),o;if(t){var i=_getPrototypeOf$16(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$16(this,o)}}function _possibleConstructorReturn$16(e,t){if(t&&(_typeof$2k(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$16(e)}function _assertThisInitialized$16(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$16(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$16(e){return _getPrototypeOf$16=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$16(e)}var Walkontable=function(e){_inherits$16(r,e);var t=_createSuper$16(r);function r(n,o){var i;_classCallCheck$22(this,r),i=t.call(this,n,new Settings(o));var a=i.wtSettings.getSetting("facade",_assertThisInitialized$16(i));return i.wtTable=new MasterTable$1(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new Viewport$1(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new Event$2(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new Overlays$1(_assertThisInitialized$16(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return _createClass$22(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],s=[];objectEach(i,function(l,u){o.wtSettings.getSetting(u).length&&s.push(l),a.push(l)}),removeClass(this.wtTable.wtRootElement.parentNode,a),addClass(this.wtTable.wtRootElement.parentNode,s)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(CoreAbstract);function _typeof$2j(e){return _typeof$2j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2j(e)}function _classCallCheck$21(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$21(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2d(n.key),n)}}function _createClass$21(e,t,r){return t&&_defineProperties$21(e.prototype,t),r&&_defineProperties$21(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2d(e){var t=_toPrimitive$2d(e,"string");return _typeof$2j(t)==="symbol"?t:String(t)}function _toPrimitive$2d(e,t){if(_typeof$2j(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2j(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WalkontableFacade=function(){function e(t){_classCallCheck$21(this,e),t instanceof CoreAbstract?this._wot=t:this._initFromSettings(t)}return _createClass$21(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new Walkontable(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),DESCRIPTORS$3=descriptors,uncurryThis$5=functionUncurryThis,objectKeys$1=objectKeys$4,toIndexedObject$2=toIndexedObject$d,$propertyIsEnumerable=objectPropertyIsEnumerable.f,propertyIsEnumerable=uncurryThis$5($propertyIsEnumerable),push=uncurryThis$5([].push),createMethod=function(e){return function(t){for(var r=toIndexedObject$2(t),n=objectKeys$1(r),o=n.length,i=0,a=[],s;o>i;)s=n[i++],(!DESCRIPTORS$3||propertyIsEnumerable(r,s))&&push(a,e?[s,r[s]]:r[s]);return a}},objectToArray={entries:createMethod(!0),values:createMethod(!1)},$$8=_export,$values=objectToArray.values;$$8({target:"Object",stat:!0},{values:function(t){return $values(t)}});function _typeof$2i(e){return _typeof$2i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2i(e)}function _slicedToArray$H(e,t){return _arrayWithHoles$J(e)||_iterableToArrayLimit$H(e,t)||_unsupportedIterableToArray$13(e,t)||_nonIterableRest$J()}function _nonIterableRest$J(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$13(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$13(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$13(e,t)}}function _arrayLikeToArray$13(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$H(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$J(e){if(Array.isArray(e))return e}function _classCallCheck$20(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$20(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2c(n.key),n)}}function _createClass$20(e,t,r){return t&&_defineProperties$20(e.prototype,t),r&&_defineProperties$20(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2c(e){var t=_toPrimitive$2c(e,"string");return _typeof$2i(t)==="symbol"?t:String(t)}function _toPrimitive$2c(e,t){if(_typeof$2i(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2i(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Border=function(){function e(t,r){_classCallCheck$20(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return _createClass$20(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(l){var u=r.main.childNodes[l];r.eventManager.addEventListener(u,"mouseenter",function(c){return r.onMouseEnter(c,r.main.childNodes[l])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),stopImmediatePropagation(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function s(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function l(u){s(u)&&(o.eventManager.removeEventListener(i,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",l)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var s=o[a],l=n.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),i=l.style,i.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:r.border.color,i.height=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),isMobileBrowser()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,c=u.bordersHolder;c||(c=n.createElement("div"),c.className="htBorders",u.bordersHolder=c,u.spreader.appendChild(c)),c.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};objectEach(a,function(l,u){r.selectionHandles.styles.bottomHitArea[u]=l,r.selectionHandles.styles.topHitArea[u]=l});var s={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};objectEach(s,function(l,u){r.selectionHandles.styles.bottom[u]=l,r.selectionHandles.styles.top[u]=l}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,s){var l=this.wot.wtSettings.getSetting("rtlMode"),u=l?"right":"left",c=this.selectionHandles.styles,f=c.top,d=c.topHitArea,h=c.bottom,y=c.bottomHitArea,p=parseInt(f.borderWidth,10),v=parseInt(f.width,10),b=parseInt(d.width,10),S=this.wot.wtTable.getWidth(),w=this.wot.wtTable.getHeight();f.top="".concat(parseInt(o-v-1,10),"px"),f[u]="".concat(parseInt(i-v-1,10),"px"),d.top="".concat(parseInt(o-b/4*3,10),"px"),d[u]="".concat(parseInt(i-b/4*3,10),"px");var P=Math.min(parseInt(i+a,10),S-v-p*2),E=Math.min(parseInt(i+a-b/4,10),S-b-p*2);h[u]="".concat(P,"px"),y[u]="".concat(E,"px");var j=Math.min(parseInt(o+s,10),w-v-p*2),G=Math.min(parseInt(o+s-b/4,10),w-b-p*2);h.top="".concat(j,"px"),y.top="".concat(G,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(f.display="block",d.display="block",this.isPartRange(r,n)?(h.display="none",y.display="none"):(h.display="block",y.display="block")):(f.display="none",h.display="none",d.display="none",y.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(f.zIndex="9999",d.zIndex="9999"):(f.zIndex="",d.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,s,l,u,c,f,d,h=o.getRenderedRowsCount(),y=0;y<h;y+=1){var p=o.rowFilter.renderedToSource(y);if(p>=r[0]&&p<=r[2]){s=p,f=r[0];break}}for(var v=h-1;v>=0;v-=1){var b=o.rowFilter.renderedToSource(v);if(b>=r[0]&&b<=r[2]){l=b;break}}for(var S=o.getRenderedColumnsCount(),w=0;w<S;w+=1){var P=o.columnFilter.renderedToSource(w);if(P>=r[1]&&P<=r[3]){u=P,d=r[1];break}}for(var E=S-1;E>=0;E-=1){var j=o.columnFilter.renderedToSource(E);if(j>=r[1]&&j<=r[3]){c=j;break}}if(s===void 0||u===void 0){this.disappear();return}var G=o.getCell(this.wot.createCellCoords(s,u)),q=s!==l||u!==c,z=q?o.getCell(this.wot.createCellCoords(l,c)):G,U=offset(G),Z=q?offset(z):U,te=offset(o.TABLE),Q=outerWidth(o.TABLE),ie=U.top,he=U.left,ce=this.wot.wtSettings.getSetting("rtlMode"),fe=0,I=0;if(ce){var g=outerWidth(G),m=a.innerWidth-te.left-Q;I=he+g-Z.left,fe=a.innerWidth-he-g-m-1}else I=Z.left+outerWidth(z)-he,fe=he-te.left-1;if(this.isEntireColumnSelected(s,l)){var _=this.getDimensionsFromHeader("columns",u,c,f,te),C=null;if(_){var R=_slicedToArray$H(_,3);C=R[0],fe=R[1],I=R[2]}C&&(G=C)}var A=ie-te.top-1,B=Z.top+outerHeight(z)-ie;if(this.isEntireRowSelected(u,c)){var V=this.getDimensionsFromHeader("rows",s,l,d,te),K=null;if(V){var J=_slicedToArray$H(V,3);K=J[0],A=J[1],B=J[2]}K&&(G=K)}var ee=getComputedStyle(G,a);parseInt(ee.borderTopWidth,10)>0&&(A+=1,B=B>0?B-1:0),parseInt(ee[ce?"borderRightWidth":"borderLeftWidth"],10)>0&&(fe+=1,I=I>0?I-1:0);var oe=ce?"right":"left";this.topStyle.top="".concat(A,"px"),this.topStyle[oe]="".concat(fe,"px"),this.topStyle.width="".concat(I,"px"),this.topStyle.display="block",this.startStyle.top="".concat(A,"px"),this.startStyle[oe]="".concat(fe,"px"),this.startStyle.height="".concat(B,"px"),this.startStyle.display="block";var ye=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(A+B-ye,"px"),this.bottomStyle[oe]="".concat(fe,"px"),this.bottomStyle.width="".concat(I,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(A,"px"),this.endStyle[oe]="".concat(fe+I-ye,"px"),this.endStyle.height="".concat(B+1,"px"),this.endStyle.display="block";var ae=this.settings.border.cornerVisible;ae=typeof ae=="function"?ae(this.settings.layerLevel):ae;var se=this.wot.getSetting("onModifyGetCellCoords",l,c),X=l,_e=c;if(se&&Array.isArray(se)){var we=_slicedToArray$H(se,4);X=we[2],_e=we[3]}if(isMobileBrowser()||!ae||this.isPartRange(X,_e))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(A+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[oe]="".concat(fe+I+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var ge=getTrimmingContainer(o.TABLE),me=ge===a;me&&(ge=i.documentElement);var ve=parseInt(this.cornerDefaultStyle.width,10)/2,O=parseInt(this.cornerDefaultStyle.height,10)/2;if(c===this.wot.getSetting("totalColumns")-1){var T=me?z.getBoundingClientRect().left:z.offsetLeft,k=!1,L=0;ce?(L=T-parseInt(this.cornerDefaultStyle.width,10)/2,k=L<0):(L=T+outerWidth(z)+parseInt(this.cornerDefaultStyle.width,10)/2,k=L>=innerWidth(ge)),k&&(this.cornerStyle[oe]="".concat(Math.floor(fe+I+this.cornerCenterPointOffset-ve),"px"),this.cornerStyle[ce?"borderLeftWidth":"borderRightWidth"]=0)}if(l===this.wot.getSetting("totalRows")-1){var M=me?z.getBoundingClientRect().top:z.offsetTop,F=M+outerHeight(z)+parseInt(this.cornerDefaultStyle.height,10)/2,N=F>=innerHeight(ge);N&&(this.cornerStyle.top="".concat(Math.floor(A+B+this.cornerCenterPointOffset-O),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}isMobileBrowser()&&this.updateMultipleSelectionHandlesPosition(l,c,A,fe,I,B)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var s=this.wot.wtTable,l=s.wtRootElement.parentNode,u=null,c=null,f=null,d=null,h=null,y=null,p=null,v=null;switch(r){case"rows":u=function(){return s.getRowHeader.apply(s,arguments)},c=function(){return outerHeight.apply(void 0,arguments)},f="ht__selection--rows",y="top";break;case"columns":u=function(){return s.getColumnHeader.apply(s,arguments)},c=function(){return outerWidth.apply(void 0,arguments)},f="ht__selection--columns",y="left";break}if(l.classList.contains(f)){var b=this.wot.getSetting("columnHeaders").length;if(p=u(n,b-i),v=u(o,b-i),!p||!v)return!1;var S=offset(p),w=offset(v);return p&&v&&(d=S[y]-a[y]-1,h=w[y]+c(v)-S[y]),[p,d,h]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?addClass(this[r],"hidden"):(hasClass(this[r],"hidden")&&removeClass(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?addClass(this[r],"hidden"):removeClass(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",isMobileBrowser()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const Border$1=Border;function _slicedToArray$G(e,t){return _arrayWithHoles$I(e)||_iterableToArrayLimit$G(e,t)||_unsupportedIterableToArray$12(e,t)||_nonIterableRest$I()}function _nonIterableRest$I(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$12(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$12(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$12(e,t)}}function _arrayLikeToArray$12(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$G(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$I(e){if(Array.isArray(e))return e}function _typeof$2h(e){return _typeof$2h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2h(e)}function _classCallCheck$1$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2b(n.key),n)}}function _createClass$1$(e,t,r){return t&&_defineProperties$1$(e.prototype,t),r&&_defineProperties$1$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2b(e){var t=_toPrimitive$2b(e,"string");return _typeof$2h(t)==="symbol"?t:String(t)}function _toPrimitive$2b(e,t){if(_typeof$2h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Selection$2=function(){function e(t,r){_classCallCheck$1$(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return _createClass$1$(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new Border$1(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=r.wtTable.getCell(this.settings.createCellCoords(n,o));if(_typeof$2h(s)==="object"){var l=i;a&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),addClass(s,l)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var s=a>=0?a:n,l=r;s-=1;var u=s===0?r:"".concat(r,"-").concat(s);if(hasClass(i,u)){var c=s+1;l="".concat(r,"-").concat(c)}else l=o(i,s);return l}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=_slicedToArray$G(i,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.settings,d=f.highlightHeaderClassName,h=f.highlightColumnClassName,y=f.highlightRowClassName,p=f.highlightOnlyClosestHeader,v=f.selectionType,b=v===void 0||["active-header","header"].includes(v);if(b&&l!==null&&c!==null)for(var S=0,w=0;w<o;w+=1){var P=r.wtTable.columnFilter.renderedToSource(w);if(P>=l&&P<=c){var E=r.wtTable.getColumnHeaders(P),j=E.length-1;p&&E.length>1&&(E=[E[j]]);for(var G=0;G<E.length;G+=1){var q=[],z=E[G];d&&q.push(d),h&&q.push(h),G=p?j:G;var U=r.getSetting("onBeforeHighlightingColumnHeader",P,G,{selectionType:v,columnCursor:S,selectionWidth:c-l+1,classNames:q});U!==P&&(z=r.wtTable.getColumnHeader(U,G)),addClass(z,q)}S+=1}}if(s!==null&&u!==null)for(var Z=0,te=0;te<n;te+=1){var Q=r.wtTable.rowFilter.renderedToSource(te);if(b&&Q>=s&&Q<=u){var ie=r.wtTable.getRowHeaders(Q),he=ie.length-1;p&&ie.length>1&&(ie=[ie[he]]);for(var ce=0;ce<ie.length;ce+=1){var fe=[],I=ie[ce];d&&fe.push(d),y&&fe.push(y),ce=p?he:ce;var g=r.getSetting("onBeforeHighlightingRowHeader",Q,ce,{selectionType:v,rowCursor:Z,selectionHeight:u-s+1,classNames:fe});g!==Q&&(I=r.wtTable.getRowHeader(g,ce)),addClass(I,fe)}Z+=1}if(l!==null&&c!==null)for(var m=0;m<o;m+=1){var _=r.wtTable.columnFilter.renderedToSource(m);Q>=s&&Q<=u&&_>=l&&_<=c?this.settings.className&&this.addClassAtCoords(r,Q,_,this.settings.className,this.settings.markIntersections):Q>=s&&Q<=u?y&&this.addClassAtCoords(r,Q,_,y):_>=l&&_<=c&&h&&this.addClassAtCoords(r,Q,_,h);var C=r.getSetting("onAfterDrawSelection",Q,_,this.settings.layerLevel);typeof C=="string"&&this.addClassAtCoords(r,Q,_,C)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const Selection$3=Selection$2;function mouseDown(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,s=e.cellCoordsFactory,l=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(t&&l)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(s(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(s(l.to.row,o.col)):c&&o.col<0&&!a.row?i.setRangeEnd(s(o.row,l.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(l.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!a.column&&i.selectColumns(Math.max(l.from.col,0),o.col,o.row);else{var f=!i.inInSelection(o),d=r||n&&f;o.row<0&&o.col>=0&&!a.column?d&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?d&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?d&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function mouseOver(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();s&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,l-1)):o.cell||n.setRangeEnd(r)}}var handlers=new Map([["mousedown",mouseDown],["mouseover",mouseOver],["touchstart",mouseDown]]);function handleMouseEvent(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;handlers.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:isLeftClick(e)||e.type==="touchstart",isRightClick:isRightClick(e)})}var holder=new WeakMap,rootInstanceSymbol=Symbol("rootInstance");function registerAsRootInstance(e){holder.set(e,!0)}function hasValidParameter(e){return e===rootInstanceSymbol}function isRootInstance(e){return holder.has(e)}function _typeof$2g(e){return _typeof$2g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2g(e)}function _slicedToArray$F(e,t){return _arrayWithHoles$H(e)||_iterableToArrayLimit$F(e,t)||_unsupportedIterableToArray$11(e,t)||_nonIterableRest$H()}function _nonIterableRest$H(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit$F(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$H(e){if(Array.isArray(e))return e}function _toConsumableArray$s(e){return _arrayWithoutHoles$s(e)||_iterableToArray$u(e)||_unsupportedIterableToArray$11(e)||_nonIterableSpread$s()}function _nonIterableSpread$s(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$11(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$11(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$11(e,t)}}function _iterableToArray$u(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$s(e){if(Array.isArray(e))return _arrayLikeToArray$11(e)}function _arrayLikeToArray$11(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$1_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2a(n.key),n)}}function _createClass$1_(e,t,r){return t&&_defineProperties$1_(e.prototype,t),r&&_defineProperties$1_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classPrivateFieldInitSpec$c(e,t,r){_checkPrivateRedeclaration$d(e,t),t.set(e,r)}function _checkPrivateRedeclaration$d(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$w(e,t,r){return t=_toPropertyKey$2a(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$2a(e){var t=_toPrimitive$2a(e,"string");return _typeof$2g(t)==="symbol"?t:String(t)}function _toPrimitive$2a(e,t){if(_typeof$2g(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2g(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$c(e,t){var r=_classExtractFieldDescriptor$c(e,t,"get");return _classApplyDescriptorGet$c(e,r)}function _classApplyDescriptorGet$c(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet$c(e,t,r){var n=_classExtractFieldDescriptor$c(e,t,"set");return _classApplyDescriptorSet$c(e,n,r),r}function _classExtractFieldDescriptor$c(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet$c(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var privatePool$h=new WeakMap,_columnHeadersCount=new WeakMap,_rowHeadersCount=new WeakMap,TableView=function(){function e(t){_classCallCheck$1_(this,e),_defineProperty$w(this,"instance",void 0),_defineProperty$w(this,"eventManager",void 0),_defineProperty$w(this,"settings",void 0),_defineProperty$w(this,"THEAD",void 0),_defineProperty$w(this,"TBODY",void 0),_defineProperty$w(this,"_wt",void 0),_defineProperty$w(this,"activeWt",void 0),_classPrivateFieldInitSpec$c(this,_columnHeadersCount,{writable:!0,value:0}),_classPrivateFieldInitSpec$c(this,_rowHeadersCount,{writable:!0,value:0}),_defineProperty$w(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new EventManager$1(this.instance),this.settings=this.instance.getSettings(),privatePool$h.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return _createClass$1_(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=privatePool$h.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),addClass(o,"handsontable"),r.table=i.createElement("TABLE"),addClass(r.table,"htCore"),this.instance.getSettings().tableClassName&&addClass(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=privatePool$h.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,s=o.selection,l=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var c=r.instance.rootWindow;clearTextSelection(c),u.preventDefault(),c.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&clearTextSelection(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(l,"keyup",function(u){s.isInProgress()&&!u.shiftKey&&s.finish()}),this.eventManager.addEventListener(l,"mouseup",function(u){s.isInProgress()&&isLeftClick(u)&&s.finish(),n.mouseDown=!1,(isOutsideInput(a.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!i.contains(u.target)&&!isRightClick(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(l,"contextmenu",function(u){s.isInProgress()&&isRightClick(u)&&(s.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(l,"touchend",function(){s.isInProgress()&&s.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(l,"mousedown",function(u){var c=u.target,f=u.x||u.clientX,d=u.y||u.clientY,h=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var y=r.instance.view._wt.wtTable.holder;if(h===y){var p=getScrollbarWidth(a);if(a.elementFromPoint(f+p,d)!==y||a.elementFromPoint(f,d+p)!==y)return}else for(;h!==l;){if(h===null){if(u.isTargetWebComponent)break;return}if(h===i)return;h=h.parentNode}var v=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(c):r.settings.outsideClickDeselects;v?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||isInput(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,_toConsumableArray$s(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),s=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(s))return 0;var l=0;return n<0?l=s+1:n>0&&(l=i-s),l}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=privatePool$h.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return isRootInstance(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(c,f){var d;return(d=r.instance).getDataAtCell.apply(d,_toConsumableArray$s(r.translateFromRenderableToVisualIndex(c,f)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var c=[];return r.instance.hasRowHeaders()&&c.push(function(f,d){var h=f>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(f):f;r.appendRowHeader(h,d)}),r.instance.runHooks("afterGetRowHeaderRenderers",c),_classPrivateFieldSet$c(r,_rowHeadersCount,c.length),c},columnHeaders:function(){var c=[];return r.instance.hasColHeaders()&&c.push(function(f,d){var h=f>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(f):f;r.appendColHeader(h,d)}),r.instance.runHooks("afterGetColumnHeaderRenderers",c),_classPrivateFieldSet$c(r,_columnHeadersCount,c.length),c},columnWidth:function(c){var f=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getColWidth(f===null?c:f)},rowHeight:function(c){var f=r.instance.rowIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getRowHeight(f===null?c:f)},cellRenderer:function(c,f,d){var h=r.translateFromRenderableToVisualIndex(c,f),y=_slicedToArray$F(h,2),p=y[0],v=y[1],b=r.instance.runHooks("modifyGetCellCoords",p,v),S=p,w=v;if(Array.isArray(b)){var P=_slicedToArray$F(b,2);S=P[0],w=P[1]}var E=r.instance.getCellMeta(S,w),j=r.instance.colToProp(w),G=r.instance.getDataAtRowProp(S,j);r.instance.hasHook("beforeValueRender")&&(G=r.instance.runHooks("beforeValueRender",G,E)),r.instance.runHooks("beforeRenderer",d,p,v,j,G,E),r.instance.getCellRenderer(E)(r.instance,d,p,v,j,G,E),r.instance.runHooks("afterRenderer",d,p,v,j,G,E)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(c,f,d,h){var y=r.translateFromRenderableToVisualCoords(f),p={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=h,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",c,y,d,p),!isImmediatePropagationStopped(c)&&(handleMouseEvent(c,{coords:y,selection:r.instance.selection,controller:p,cellCoordsFactory:function(b,S){return r.instance._createCellCoords(b,S)}}),r.instance.runHooks("afterOnCellMouseDown",c,y,d),r.activeWt=r._wt)},onCellContextMenu:function(c,f,d,h){var y=r.translateFromRenderableToVisualCoords(f);r.activeWt=h,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",c,y,d),!isImmediatePropagationStopped(c)&&(r.instance.runHooks("afterOnCellContextMenu",c,y,d),r.activeWt=r._wt)},onCellMouseOut:function(c,f,d,h){var y=r.translateFromRenderableToVisualCoords(f);r.activeWt=h,r.instance.runHooks("beforeOnCellMouseOut",c,y,d),!isImmediatePropagationStopped(c)&&(r.instance.runHooks("afterOnCellMouseOut",c,y,d),r.activeWt=r._wt)},onCellMouseOver:function(c,f,d,h){var y=r.translateFromRenderableToVisualCoords(f),p={row:!1,column:!1,cell:!1};r.activeWt=h,r.instance.runHooks("beforeOnCellMouseOver",c,y,d,p),!isImmediatePropagationStopped(c)&&(n.mouseDown&&handleMouseEvent(c,{coords:y,selection:r.instance.selection,controller:p,cellCoordsFactory:function(b,S){return r.instance._createCellCoords(b,S)}}),r.instance.runHooks("afterOnCellMouseOver",c,y,d),r.activeWt=r._wt)},onCellMouseUp:function(c,f,d,h){var y=r.translateFromRenderableToVisualCoords(f);r.activeWt=h,r.instance.runHooks("beforeOnCellMouseUp",c,y,d),!(isImmediatePropagationStopped(c)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",c,y,d),r.activeWt=r._wt)},onCellCornerMouseDown:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",c)},onCellCornerDblClick:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",c)},beforeDraw:function(c,f){return r.beforeRender(c,f)},onDraw:function(c){return r.afterRender(c)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(c,f,d){var h=r.instance.rowIndexMapper,y=h.getVisualFromRenderableIndex(c),p=r.instance.runHooks("beforeHighlightingRowHeader",y,f,d);return h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(p,1))},onBeforeHighlightingColumnHeader:function(c,f,d){var h=r.instance.columnIndexMapper,y=h.getVisualFromRenderableIndex(c),p=r.instance.runHooks("beforeHighlightingColumnHeader",y,f,d);return h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(p,1))},onAfterDrawSelection:function(c,f,d){var h,y=r.translateFromRenderableToVisualIndex(c,f),p=_slicedToArray$F(y,2),v=p[0],b=p[1],S=r.instance.selection.getSelectedRange(),w=S.size();if(w>0){var P=(d??0)+1-w,E=S.peekByIndex(P);h=[E.from.row,E.from.col,E.to.row,E.to.col]}return r.instance.runHooks("afterDrawSelection",v,b,h,d)},onBeforeDrawBorders:function(c,f){var d=_slicedToArray$F(c,4),h=d[0],y=d[1],p=d[2],v=d[3],b=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(h),r.instance.columnIndexMapper.getVisualFromRenderableIndex(y),r.instance.rowIndexMapper.getVisualFromRenderableIndex(p),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v)];return r.instance.runHooks("beforeDrawBorders",b,f)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(c,f){var d=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.runHooks("beforeStretchingColumnWidth",c,d)},onModifyRowHeaderWidth:function(c){return r.instance.runHooks("modifyRowHeaderWidth",c)},onModifyGetCellCoords:function(c,f,d){var h=r.instance.rowIndexMapper,y=r.instance.columnIndexMapper,p=f>=0?y.getVisualFromRenderableIndex(f):f,v=c>=0?h.getVisualFromRenderableIndex(c):c,b=r.instance.runHooks("modifyGetCellCoords",v,p,d);if(Array.isArray(b)){var S=_slicedToArray$F(b,4),w=S[0],P=S[1],E=S[2],j=S[3];return[w>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(w,1)):w,P>=0?y.getRenderableFromVisualIndex(y.getNearestNotHiddenIndex(P,1)):P,E>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(E,-1)):E,j>=0?y.getRenderableFromVisualIndex(y.getNearestNotHiddenIndex(j,-1)):j]}},viewportRowCalculatorOverride:function(c){var f=r.settings.viewportRowRenderingOffset;if(f==="auto"&&r.settings.fixedRowsTop&&(f=10),f>0||f==="auto"){var d=r.countRenderableRows(),h=c.startRow,y=c.endRow;if(typeof f=="number")c.startRow=Math.max(h-f,0),c.endRow=Math.min(y+f,d-1);else if(f==="auto"){var p=Math.ceil(y/d*12);c.startRow=Math.max(h-p,0),c.endRow=Math.min(y+p,d-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",c)},viewportColumnCalculatorOverride:function(c){var f=r.settings.viewportColumnRenderingOffset;if(f==="auto"&&r.settings.fixedColumnsStart&&(f=10),f>0||f==="auto"){var d=r.countRenderableColumns(),h=c.startColumn,y=c.endColumn;if(typeof f=="number"&&(c.startColumn=Math.max(h-f,0),c.endColumn=Math.min(y+f,d-1)),f==="auto"){var p=Math.ceil(y/d*6);c.startColumn=Math.max(h-p,0),c.endColumn=Math.min(y+p,d-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",c)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var c=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||c}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new WalkontableFacade(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),s=a.width,l=a.height;this.setLastSize(s,l),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(isInput(r))return!0;var n=isChildOf(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return privatePool$h.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!hasClass(o,"relative")){empty(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,s=i.getRowHeader,l=a.createElement("div"),u=a.createElement("span");l.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,s),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;hasClass(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,o,i):(empty(n),this.appendColHeader(r,n,o,i))}else{var s=this.instance.rootDocument,l=s.createElement("div"),u=s.createElement("span");l.className="relative",u.className="colHeader",this.updateCellHeader(u,r,o,i),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetColHeader",r,n,i)}},{key:"updateCellHeader",value:function(r,n,o){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,s=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(hasClass(r,"colHeader")?a=s.wtTable.columnFilter.sourceToRendered(n):hasClass(r,"rowHeader")&&(a=s.wtTable.rowFilter.sourceToRendered(n))),a>-1?fastInnerHTML(r,o(n,i)):(fastInnerText(r,String.fromCharCode(160)),addClass(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=privatePool$h.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=privatePool$h.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return _classPrivateFieldGet$c(this,_columnHeadersCount)}},{key:"getRowHeadersCount",value:function(){return _classPrivateFieldGet$c(this,_rowHeadersCount)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const TableView$1=TableView;function _typeof$2f(e){return _typeof$2f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2f(e)}var COLUMN_LABEL_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZ",COLUMN_LABEL_BASE_LENGTH=COLUMN_LABEL_BASE.length;function spreadsheetColumnLabel(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%COLUMN_LABEL_BASE_LENGTH,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/COLUMN_LABEL_BASE_LENGTH,10);return r}function spreadsheetColumnIndex(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(COLUMN_LABEL_BASE_LENGTH,n)*(COLUMN_LABEL_BASE.indexOf(e[r])+1);return t-=1,t}function createSpreadsheetData(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i=[];for(o=0;o<t;o++)i.push(spreadsheetColumnLabel(o)+(n+1));r.push(i)}return r}function createSpreadsheetObjectData(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i={};for(o=0;o<t;o++)i["prop".concat(o)]=spreadsheetColumnLabel(o)+(n+1);r.push(i)}return r}function createEmptySpreadsheetData(e,t){for(var r=[],n,o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function dataRowToChangesArray(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,s){n.push([i+t,s,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function countFirstRowKeys(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&isObject$6(e[0])&&(t=deepObjectSize(e[0]))),t}function isArrayOfArrays(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function isArrayOfObjects(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return _typeof$2f(t)==="object"&&!Array.isArray(t)&&t!==null}))}const dataHelpers=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys,createEmptySpreadsheetData,createSpreadsheetData,createSpreadsheetObjectData,dataRowToChangesArray,isArrayOfArrays,isArrayOfObjects,spreadsheetColumnIndex,spreadsheetColumnLabel},Symbol.toStringTag,{value:"Module"}));function _typeof$2e(e){return _typeof$2e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2e(e)}function _classCallCheck$1Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$29(n.key),n)}}function _createClass$1Z(e,t,r){return t&&_defineProperties$1Z(e.prototype,t),r&&_defineProperties$1Z(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$29(e){var t=_toPrimitive$29(e,"string");return _typeof$2e(t)==="symbol"?t:String(t)}function _toPrimitive$29(e,t){if(_typeof$2e(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2e(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataSource=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];_classCallCheck$1Z(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return _createClass$1Z(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return arrayEach(this.data,function(i,a){var s=n.getAtCell(a,r);o.push(s)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=n===void 0&&o===void 0,l=null,u=null;if(l=this.modifyRowData(r),Array.isArray(l))u=[],s?l.forEach(function(d,h){u[h]=i.getAtPhysicalCell(r,h,l)}):rangeEach(n,o,function(d){u[d-n]=i.getAtPhysicalCell(r,d,l)});else if(isObject$6(l)||isFunction(l))if(a?u=[]:u={},!s||a){var c=0,f=this.countFirstRowKeys()-1;rangeEach(c,f,function(d){var h=i.colToProp(d);if(d>=(n||c)&&d<=(o||f)&&!Number.isInteger(h)){var y=i.getAtPhysicalCell(r,h,l);a?u.push(y):setProperty(u,h,y)}})}else objectEach(l,function(d,h){setProperty(u,h,i.getAtPhysicalCell(r,h,l))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=createObjectPropListener(o);this.hot.runHooks("modifySourceData",r,this.propToCol(n),i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:setProperty(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=getProperty(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=createObjectPropListener(i);this.hot.runHooks("modifySourceData",r,this.colToProp(n),a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,s=null,l=null,u=null,c=null;n===null||o===null?(a=!0,s=0,u=this.countRows()-1):(s=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(n.row,o.row),c=Math.max(n.col,o.col));var f=[];return rangeEach(s,u,function(d){f.push(a?r.getAtRow(d,void 0,void 0,i):r.getAtRow(d,l,c,i))}),f}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return countFirstRowKeys(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const DataSource$1=DataSource;var hasOwn=hasOwnProperty_1,isDataDescriptor$1=function(e){return e!==void 0&&(hasOwn(e,"value")||hasOwn(e,"writable"))},$$7=_export,call$2=functionCall,isObject=isObject$n,anObject$1=anObject$m,isDataDescriptor=isDataDescriptor$1,getOwnPropertyDescriptorModule$1=objectGetOwnPropertyDescriptor,getPrototypeOf=objectGetPrototypeOf;function get(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(anObject$1(e)===r)return e[t];if(n=getOwnPropertyDescriptorModule$1.f(e,t),n)return isDataDescriptor(n)?n.value:n.get===void 0?void 0:call$2(n.get,r);if(isObject(o=getPrototypeOf(e)))return get(o,t,r)}$$7({target:"Reflect",stat:!0},{get});var $$6=_export,fails$3=fails$I,toIndexedObject$1=toIndexedObject$d,nativeGetOwnPropertyDescriptor=objectGetOwnPropertyDescriptor.f,DESCRIPTORS$2=descriptors,FORCED$1=!DESCRIPTORS$2||fails$3(function(){nativeGetOwnPropertyDescriptor(1)});$$6({target:"Object",stat:!0,forced:FORCED$1,sham:!DESCRIPTORS$2},{getOwnPropertyDescriptor:function(t,r){return nativeGetOwnPropertyDescriptor(toIndexedObject$1(t),r)}});var MIXIN_NAME$1="localHooks",localHooks={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,s){if(this._localHooks[t])for(var l=this._localHooks[t].length,u=0;u<l;u++)fastCall(this._localHooks[t][u],this,r,n,o,i,a,s)},clearLocalHooks:function(){return this._localHooks={},this}};defineGetter(localHooks,"MIXIN_NAME",MIXIN_NAME$1,{writable:!1,enumerable:!1});const localHooks$1=localHooks;function _typeof$2d(e){return _typeof$2d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2d(e)}function _classCallCheck$1Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$28(n.key),n)}}function _createClass$1Y(e,t,r){return t&&_defineProperties$1Y(e.prototype,t),r&&_defineProperties$1Y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$28(e){var t=_toPrimitive$28(e,"string");return _typeof$2d(t)==="symbol"?t:String(t)}function _toPrimitive$28(e,t){if(_typeof$2d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IndexMap=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_classCallCheck$1Y(this,e),this.indexedValues=[],this.initValueOrFn=t}return _createClass$1Y(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,isFunction(this.initValueOrFn)?rangeEach(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):rangeEach(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();mixin(IndexMap,localHooks$1);function _toConsumableArray$r(e){return _arrayWithoutHoles$r(e)||_iterableToArray$t(e)||_unsupportedIterableToArray$10(e)||_nonIterableSpread$r()}function _nonIterableSpread$r(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$10(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$10(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$10(e,t)}}function _iterableToArray$t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$r(e){if(Array.isArray(e))return _arrayLikeToArray$10(e)}function _arrayLikeToArray$10(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function getListWithInsertedItems$3(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(_toConsumableArray$r(e.slice(0,o)),_toConsumableArray$r(r.map(function(i,a){return isFunction(n)?n(i,a):n})),_toConsumableArray$r(o===void 0?[]:e.slice(o)))}function getListWithRemovedItems$3(e,t){return arrayFilter(e,function(r,n){return t.includes(n)===!1})}function _typeof$2c(e){return _typeof$2c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2c(e)}function _classCallCheck$1X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$27(n.key),n)}}function _createClass$1X(e,t,r){return t&&_defineProperties$1X(e.prototype,t),r&&_defineProperties$1X(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$27(e){var t=_toPrimitive$27(e,"string");return _typeof$2c(t)==="symbol"?t:String(t)}function _toPrimitive$27(e,t){if(_typeof$2c(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2c(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$T(){return typeof Reflect<"u"&&Reflect.get?_get$T=Reflect.get.bind():_get$T=function(t,r,n){var o=_superPropBase$T(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$T.apply(this,arguments)}function _superPropBase$T(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$15(e),e!==null););return e}function _inherits$15(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$15(e,t)}function _setPrototypeOf$15(e,t){return _setPrototypeOf$15=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$15(e,t)}function _createSuper$15(e){var t=_isNativeReflectConstruct$15();return function(){var n=_getPrototypeOf$15(e),o;if(t){var i=_getPrototypeOf$15(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$15(this,o)}}function _possibleConstructorReturn$15(e,t){if(t&&(_typeof$2c(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$15(e)}function _assertThisInitialized$15(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$15(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$15(e){return _getPrototypeOf$15=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$15(e)}var PhysicalIndexToValueMap=function(e){_inherits$15(r,e);var t=_createSuper$15(r);function r(){return _classCallCheck$1X(this,r),t.apply(this,arguments)}return _createClass$1X(r,[{key:"insert",value:function(o,i){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,o,i,this.initValueOrFn),_get$T(_getPrototypeOf$15(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,o),_get$T(_getPrototypeOf$15(r.prototype),"remove",this).call(this,o)}}]),r}(IndexMap);function _typeof$2b(e){return _typeof$2b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2b(e)}function _classCallCheck$1W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$26(n.key),n)}}function _createClass$1W(e,t,r){return t&&_defineProperties$1W(e.prototype,t),r&&_defineProperties$1W(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$26(e){var t=_toPrimitive$26(e,"string");return _typeof$2b(t)==="symbol"?t:String(t)}function _toPrimitive$26(e,t){if(_typeof$2b(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2b(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$14(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$14(e,t)}function _setPrototypeOf$14(e,t){return _setPrototypeOf$14=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$14(e,t)}function _createSuper$14(e){var t=_isNativeReflectConstruct$14();return function(){var n=_getPrototypeOf$14(e),o;if(t){var i=_getPrototypeOf$14(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$14(this,o)}}function _possibleConstructorReturn$14(e,t){if(t&&(_typeof$2b(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$14(e)}function _assertThisInitialized$14(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$14(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$14(e){return _getPrototypeOf$14=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$14(e)}var HidingMap=function(e){_inherits$14(r,e);var t=_createSuper$14(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return _classCallCheck$1W(this,r),t.call(this,n)}return _createClass$1W(r,[{key:"getHiddenIndexes",value:function(){return arrayReduce$1(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(PhysicalIndexToValueMap);function _toConsumableArray$q(e){return _arrayWithoutHoles$q(e)||_iterableToArray$s(e)||_unsupportedIterableToArray$$(e)||_nonIterableSpread$q()}function _nonIterableSpread$q(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$$(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$$(e,t)}}function _iterableToArray$s(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$q(e){if(Array.isArray(e))return _arrayLikeToArray$$(e)}function _arrayLikeToArray$$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function getListWithInsertedItems$2(e,t,r){return[].concat(_toConsumableArray$q(e.slice(0,t)),_toConsumableArray$q(r),_toConsumableArray$q(e.slice(t)))}function getListWithRemovedItems$2(e,t){return arrayFilter(e,function(r){return t.includes(r)===!1})}function getDecreasedIndexes(e,t){return arrayMap(e,function(r){return r-t.filter(function(n){return n<r}).length})}function getIncreasedIndexes(e,t){var r=t[0],n=t.length;return arrayMap(e,function(o){return o>=r?o+n:o})}function _typeof$2a(e){return _typeof$2a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2a(e)}function _toConsumableArray$p(e){return _arrayWithoutHoles$p(e)||_iterableToArray$r(e)||_unsupportedIterableToArray$_(e)||_nonIterableSpread$p()}function _nonIterableSpread$p(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$_(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$_(e,t)}}function _iterableToArray$r(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$p(e){if(Array.isArray(e))return _arrayLikeToArray$_(e)}function _arrayLikeToArray$_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$1V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$25(n.key),n)}}function _createClass$1V(e,t,r){return t&&_defineProperties$1V(e.prototype,t),r&&_defineProperties$1V(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _get$S(){return typeof Reflect<"u"&&Reflect.get?_get$S=Reflect.get.bind():_get$S=function(t,r,n){var o=_superPropBase$S(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$S.apply(this,arguments)}function _superPropBase$S(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$13(e),e!==null););return e}function _inherits$13(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$13(e,t)}function _setPrototypeOf$13(e,t){return _setPrototypeOf$13=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$13(e,t)}function _createSuper$13(e){var t=_isNativeReflectConstruct$13();return function(){var n=_getPrototypeOf$13(e),o;if(t){var i=_getPrototypeOf$13(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$13(this,o)}}function _possibleConstructorReturn$13(e,t){if(t&&(_typeof$2a(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$13(e)}function _assertThisInitialized$13(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$13(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$13(e){return _getPrototypeOf$13=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$13(e)}function _defineProperty$v(e,t,r){return t=_toPropertyKey$25(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$25(e){var t=_toPrimitive$25(e,"string");return _typeof$2a(t)==="symbol"?t:String(t)}function _toPrimitive$25(e,t){if(_typeof$2a(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2a(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LinkedPhysicalIndexToValueMap=function(e){_inherits$13(r,e);var t=_createSuper$13(r);function r(){var n;_classCallCheck$1V(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_defineProperty$v(_assertThisInitialized$13(n),"orderOfIndexes",[]),n}return _createClass$1V(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=_toConsumableArray$p(Array(o.length).keys()),_get$S(_getPrototypeOf$13(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,[o]),isFunction(this.initValueOrFn)?_get$S(_getPrototypeOf$13(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):_get$S(_getPrototypeOf$13(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,_get$S(_getPrototypeOf$13(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=getIncreasedIndexes(this.orderOfIndexes,i),_get$S(_getPrototypeOf$13(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,o),this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,o),this.orderOfIndexes=getDecreasedIndexes(this.orderOfIndexes,o),_get$S(_getPrototypeOf$13(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(IndexMap);function _typeof$29(e){return _typeof$29=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$29(e)}function _classCallCheck$1U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$24(n.key),n)}}function _createClass$1U(e,t,r){return t&&_defineProperties$1U(e.prototype,t),r&&_defineProperties$1U(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$24(e){var t=_toPrimitive$24(e,"string");return _typeof$29(t)==="symbol"?t:String(t)}function _toPrimitive$24(e,t){if(_typeof$29(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$29(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$12(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$12(e,t)}function _setPrototypeOf$12(e,t){return _setPrototypeOf$12=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$12(e,t)}function _createSuper$12(e){var t=_isNativeReflectConstruct$12();return function(){var n=_getPrototypeOf$12(e),o;if(t){var i=_getPrototypeOf$12(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$12(this,o)}}function _possibleConstructorReturn$12(e,t){if(t&&(_typeof$29(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$12(e)}function _assertThisInitialized$12(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$12(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$12(e){return _getPrototypeOf$12=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$12(e)}var TrimmingMap=function(e){_inherits$12(r,e);var t=_createSuper$12(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return _classCallCheck$1U(this,r),t.call(this,n)}return _createClass$1U(r,[{key:"getTrimmedIndexes",value:function(){return arrayReduce$1(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(PhysicalIndexToValueMap),alterStrategies=new Map([["indexesSequence",{getListWithInsertedItems:getListWithInsertedItems$2,getListWithRemovedItems:getListWithRemovedItems$2}],["physicallyIndexed",{getListWithInsertedItems:getListWithInsertedItems$3,getListWithRemovedItems:getListWithRemovedItems$3}]]),alterUtilsFactory=function(t){if(alterStrategies.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return alterStrategies.get(t)};function _typeof$28(e){return _typeof$28=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$28(e)}function _classCallCheck$1T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$23(n.key),n)}}function _createClass$1T(e,t,r){return t&&_defineProperties$1T(e.prototype,t),r&&_defineProperties$1T(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$23(e){var t=_toPrimitive$23(e,"string");return _typeof$28(t)==="symbol"?t:String(t)}function _toPrimitive$23(e,t){if(_typeof$28(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$28(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$R(){return typeof Reflect<"u"&&Reflect.get?_get$R=Reflect.get.bind():_get$R=function(t,r,n){var o=_superPropBase$R(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$R.apply(this,arguments)}function _superPropBase$R(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$11(e),e!==null););return e}function _inherits$11(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$11(e,t)}function _setPrototypeOf$11(e,t){return _setPrototypeOf$11=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$11(e,t)}function _createSuper$11(e){var t=_isNativeReflectConstruct$11();return function(){var n=_getPrototypeOf$11(e),o;if(t){var i=_getPrototypeOf$11(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$11(this,o)}}function _possibleConstructorReturn$11(e,t){if(t&&(_typeof$28(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$11(e)}function _assertThisInitialized$11(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$11(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$11(e){return _getPrototypeOf$11=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$11(e)}var IndexesSequence=function(e){_inherits$11(r,e);var t=_createSuper$11(r);function r(){return _classCallCheck$1T(this,r),t.call(this,function(n){return n})}return _createClass$1T(r,[{key:"insert",value:function(o,i){var a=getIncreasedIndexes(this.indexedValues,i);this.indexedValues=getListWithInsertedItems$2(a,o,i),_get$R(_getPrototypeOf$11(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=getListWithRemovedItems$2(this.indexedValues,o);this.indexedValues=getDecreasedIndexes(i,o),_get$R(_getPrototypeOf$11(r.prototype),"remove",this).call(this,o)}}]),r}(IndexMap),availableIndexMapTypes=new Map([["hiding",HidingMap],["index",IndexMap],["linkedPhysicalIndexToValue",LinkedPhysicalIndexToValueMap],["physicalIndexToValue",PhysicalIndexToValueMap],["trimming",TrimmingMap]]);function createIndexMap(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!availableIndexMapTypes.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(availableIndexMapTypes.get(e))(t)}function _typeof$27(e){return _typeof$27=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$27(e)}function _classCallCheck$1S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$22(n.key),n)}}function _createClass$1S(e,t,r){return t&&_defineProperties$1S(e.prototype,t),r&&_defineProperties$1S(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$22(e){var t=_toPrimitive$22(e,"string");return _typeof$27(t)==="symbol"?t:String(t)}function _toPrimitive$22(e,t){if(_typeof$27(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$27(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var registeredMaps=0,MapCollection=function(){function e(){_classCallCheck$1S(this,e),this.collection=new Map}return _createClass$1S(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}),registeredMaps+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);isDefined(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),registeredMaps-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return isUndefined(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();mixin(MapCollection,localHooks$1);function getRegisteredMapsCounter(){return registeredMaps}function _typeof$26(e){return _typeof$26=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$26(e)}function _classCallCheck$1R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$21(n.key),n)}}function _createClass$1R(e,t,r){return t&&_defineProperties$1R(e.prototype,t),r&&_defineProperties$1R(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$21(e){var t=_toPrimitive$21(e,"string");return _typeof$26(t)==="symbol"?t:String(t)}function _toPrimitive$21(e,t){if(_typeof$26(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$26(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$10(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$10(e,t)}function _setPrototypeOf$10(e,t){return _setPrototypeOf$10=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$10(e,t)}function _createSuper$10(e){var t=_isNativeReflectConstruct$10();return function(){var n=_getPrototypeOf$10(e),o;if(t){var i=_getPrototypeOf$10(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$10(this,o)}}function _possibleConstructorReturn$10(e,t){if(t&&(_typeof$26(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$10(e)}function _assertThisInitialized$10(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$10(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$10(e){return _getPrototypeOf$10=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$10(e)}var AggregatedCollection=function(e){_inherits$10(r,e);var t=_createSuper$10(r);function r(n,o){var i;return _classCallCheck$1R(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return _createClass$1R(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=arrayMap(this.get(),function(f){return f.getValues()}),a=[],s=isDefined(i[0])&&i[0].length||0,l=0;l<s;l+=1){for(var u=[],c=0;c<this.getLength();c+=1)u.push(i[c][l]);a.push(u)}return arrayMap(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return isDefined(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(MapCollection);function _typeof$25(e){return _typeof$25=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$25(e)}function _classCallCheck$1Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$20(n.key),n)}}function _createClass$1Q(e,t,r){return t&&_defineProperties$1Q(e.prototype,t),r&&_defineProperties$1Q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$20(e){var t=_toPrimitive$20(e,"string");return _typeof$25(t)==="symbol"?t:String(t)}function _toPrimitive$20(e,t){if(_typeof$25(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$25(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldInitSpec$b(e,t,r){_checkPrivateRedeclaration$c(e,t),t.set(e,r)}function _checkPrivateRedeclaration$c(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$b(e,t,r){var n=_classExtractFieldDescriptor$b(e,t,"set");return _classApplyDescriptorSet$b(e,n,r),r}function _classApplyDescriptorSet$b(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function _classPrivateFieldGet$b(e,t){var r=_classExtractFieldDescriptor$b(e,t,"get");return _classApplyDescriptorGet$b(e,r)}function _classExtractFieldDescriptor$b(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorGet$b(e,t){return t.get?t.get.call(e):t.value}var _currentInitialChanges=new WeakMap,ChangesObserver=function(){function e(){_classCallCheck$1Q(this,e),_classPrivateFieldInitSpec$b(this,_currentInitialChanges,{writable:!0,value:[]})}return _createClass$1Q(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(_classPrivateFieldGet$b(this,_currentInitialChanges)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){_classPrivateFieldSet$b(this,_currentInitialChanges,r)}}]),e}();mixin(ChangesObserver,localHooks$1);function arrayDiff(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function _typeof$24(e){return _typeof$24=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$24(e)}function _classCallCheck$1P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1$(n.key),n)}}function _createClass$1P(e,t,r){return t&&_defineProperties$1P(e.prototype,t),r&&_defineProperties$1P(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1$(e){var t=_toPrimitive$1$(e,"string");return _typeof$24(t)==="symbol"?t:String(t)}function _toPrimitive$1$(e,t){if(_typeof$24(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$24(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldInitSpec$a(e,t,r){_checkPrivateRedeclaration$b(e,t),t.set(e,r)}function _checkPrivateRedeclaration$b(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$a(e,t){var r=_classExtractFieldDescriptor$a(e,t,"get");return _classApplyDescriptorGet$a(e,r)}function _classApplyDescriptorGet$a(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet$a(e,t,r){var n=_classExtractFieldDescriptor$a(e,t,"set");return _classApplyDescriptorSet$a(e,n,r),r}function _classExtractFieldDescriptor$a(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet$a(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var _observers=new WeakMap,_indexMatrix=new WeakMap,_currentIndexState=new WeakMap,_isMatrixIndexesInitialized=new WeakMap,_initialIndexValue=new WeakMap,ChangesObservable=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;_classCallCheck$1P(this,e),_classPrivateFieldInitSpec$a(this,_observers,{writable:!0,value:new Set}),_classPrivateFieldInitSpec$a(this,_indexMatrix,{writable:!0,value:[]}),_classPrivateFieldInitSpec$a(this,_currentIndexState,{writable:!0,value:[]}),_classPrivateFieldInitSpec$a(this,_isMatrixIndexesInitialized,{writable:!0,value:!1}),_classPrivateFieldInitSpec$a(this,_initialIndexValue,{writable:!0,value:!1}),_classPrivateFieldSet$a(this,_initialIndexValue,r??!1)}return _createClass$1P(e,[{key:"createObserver",value:function(){var r=this,n=new ChangesObserver;return _classPrivateFieldGet$a(this,_observers).add(n),n.addLocalHook("unsubscribe",function(){_classPrivateFieldGet$a(r,_observers).delete(n)}),n._writeInitialChanges(arrayDiff(_classPrivateFieldGet$a(this,_indexMatrix),_classPrivateFieldGet$a(this,_currentIndexState))),n}},{key:"emit",value:function(r){var n=_classPrivateFieldGet$a(this,_currentIndexState);(!_classPrivateFieldGet$a(this,_isMatrixIndexesInitialized)||_classPrivateFieldGet$a(this,_indexMatrix).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(_classPrivateFieldGet$a(this,_initialIndexValue)):_classPrivateFieldSet$a(this,_indexMatrix,new Array(r.length).fill(_classPrivateFieldGet$a(this,_initialIndexValue))),_classPrivateFieldGet$a(this,_isMatrixIndexesInitialized)||(_classPrivateFieldSet$a(this,_isMatrixIndexesInitialized,!0),n=_classPrivateFieldGet$a(this,_indexMatrix)));var o=arrayDiff(n,r);_classPrivateFieldGet$a(this,_observers).forEach(function(i){return i._write(o)}),_classPrivateFieldSet$a(this,_currentIndexState,r)}}]),e}();function _typeof$23(e){return _typeof$23=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$23(e)}var _templateObject$f;function _toConsumableArray$o(e){return _arrayWithoutHoles$o(e)||_iterableToArray$q(e)||_unsupportedIterableToArray$Z(e)||_nonIterableSpread$o()}function _nonIterableSpread$o(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$Z(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$Z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$Z(e,t)}}function _iterableToArray$q(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$o(e){if(Array.isArray(e))return _arrayLikeToArray$Z(e)}function _arrayLikeToArray$Z(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _taggedTemplateLiteral$f(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$1O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1_(n.key),n)}}function _createClass$1O(e,t,r){return t&&_defineProperties$1O(e.prototype,t),r&&_defineProperties$1O(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1_(e){var t=_toPrimitive$1_(e,"string");return _typeof$23(t)==="symbol"?t:String(t)}function _toPrimitive$1_(e,t){if(_typeof$23(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$23(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var deprecationWarns$1=new Set(["getFirstNotHiddenIndex"]),IndexMapper=function(){function e(){var t=this;_classCallCheck$1O(this,e),this.indexesSequence=new IndexesSequence,this.trimmingMapsCollection=new AggregatedCollection(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new AggregatedCollection(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new MapCollection,this.hidingChangesObservable=new ChangesObservable({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return _createClass$1O(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,createIndexMap(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof TrimmingMap?this.trimmingMapsCollection.register(r,n):n instanceof HidingMap?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return isDefined(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return isDefined(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return isDefined(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return isDefined(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;deprecationWarns$1.has("getFirstNotHiddenIndex")&&(deprecationWarns$1.delete("getFirstNotHiddenIndex"),warn(toSingleLine(_templateObject$f||(_templateObject$f=_taggedTemplateLiteral$f([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var a=this.getPhysicalFromVisualIndex(r);return a===null?o===!0&&i!==r-n?this.getFirstNotHiddenIndex(i,-n,!1,i):null:this.isHidden(a)===!1?r:this.getFirstNotHiddenIndex(r+n,n,o,i)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),s=-1;return n>0?s=a.findIndex(function(l){return l>r}):s=a.reverse().findIndex(function(l){return l<r}),s===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[s]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=_toConsumableArray$o(new Array(r).keys()),this.notHiddenIndexesCache=_toConsumableArray$o(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=_toConsumableArray$o(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=arrayMap(r,function(f){return o.getPhysicalFromVisualIndex(f)}),a=this.getNotTrimmedIndexesLength(),s=r.length,l=getListWithRemovedItems$2(this.getIndexesSequence(),i),u=a-s;if(n+s<a){var c=l.filter(function(f){return o.isTrimmed(f)===!1})[n];u=l.indexOf(c)}this.setIndexesSequence(getListWithInsertedItems$2(l,u,i))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=isDefined(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),s=arrayMap(new Array(n).fill(i),function(l,u){return l+u});this.suspendOperations(),this.indexesSequence.insert(a,s),this.trimmingMapsCollection.insertToEvery(a,s),this.hidingMapsCollection.insertToEvery(a,s),this.variousMapsCollection.insertToEvery(a,s),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();mixin(IndexMapper,localHooks$1);var _templateObject$e;function _taggedTemplateLiteral$e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function extendNotExistingKeys(e,t){return objectEach(t,function(r,n){isUndefined(e[n])&&(e[n]=r)}),e}function normalizeLanguageCode(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function warnUserAboutLanguageRegistration(e){isDefined(e)&&error(toSingleLine(_templateObject$e||(_templateObject$e=_taggedTemplateLiteral$e(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function pluralize(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var _staticRegister$4=staticRegister("phraseFormatters"),registerGloballyPhraseFormatter=_staticRegister$4.register,getGlobalPhraseFormatters=_staticRegister$4.getValues;function register$2(e,t){registerGloballyPhraseFormatter(e,t)}function getAll(){return getGlobalPhraseFormatters()}register$2("pluralize",pluralize);var CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",CM_ALIAS=CONTEXT_MENU_ITEMS_NAMESPACE,CONTEXTMENU_ITEMS_NO_ITEMS="".concat(CM_ALIAS,".noItems"),CONTEXTMENU_ITEMS_ROW_ABOVE="".concat(CM_ALIAS,".insertRowAbove"),CONTEXTMENU_ITEMS_ROW_BELOW="".concat(CM_ALIAS,".insertRowBelow"),CONTEXTMENU_ITEMS_INSERT_LEFT="".concat(CM_ALIAS,".insertColumnOnTheLeft"),CONTEXTMENU_ITEMS_INSERT_RIGHT="".concat(CM_ALIAS,".insertColumnOnTheRight"),CONTEXTMENU_ITEMS_REMOVE_ROW="".concat(CM_ALIAS,".removeRow"),CONTEXTMENU_ITEMS_REMOVE_COLUMN="".concat(CM_ALIAS,".removeColumn"),CONTEXTMENU_ITEMS_UNDO="".concat(CM_ALIAS,".undo"),CONTEXTMENU_ITEMS_REDO="".concat(CM_ALIAS,".redo"),CONTEXTMENU_ITEMS_READ_ONLY="".concat(CM_ALIAS,".readOnly"),CONTEXTMENU_ITEMS_CLEAR_COLUMN="".concat(CM_ALIAS,".clearColumn"),CONTEXTMENU_ITEMS_COPY="".concat(CM_ALIAS,".copy"),CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS="".concat(CM_ALIAS,".copyWithHeaders"),CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS="".concat(CM_ALIAS,".copyWithGroupHeaders"),CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY="".concat(CM_ALIAS,".copyHeadersOnly"),CONTEXTMENU_ITEMS_CUT="".concat(CM_ALIAS,".cut"),CONTEXTMENU_ITEMS_FREEZE_COLUMN="".concat(CM_ALIAS,".freezeColumn"),CONTEXTMENU_ITEMS_UNFREEZE_COLUMN="".concat(CM_ALIAS,".unfreezeColumn"),CONTEXTMENU_ITEMS_MERGE_CELLS="".concat(CM_ALIAS,".mergeCells"),CONTEXTMENU_ITEMS_UNMERGE_CELLS="".concat(CM_ALIAS,".unmergeCells"),CONTEXTMENU_ITEMS_ADD_COMMENT="".concat(CM_ALIAS,".addComment"),CONTEXTMENU_ITEMS_EDIT_COMMENT="".concat(CM_ALIAS,".editComment"),CONTEXTMENU_ITEMS_REMOVE_COMMENT="".concat(CM_ALIAS,".removeComment"),CONTEXTMENU_ITEMS_READ_ONLY_COMMENT="".concat(CM_ALIAS,".readOnlyComment"),CONTEXTMENU_ITEMS_ALIGNMENT="".concat(CM_ALIAS,".align"),CONTEXTMENU_ITEMS_ALIGNMENT_LEFT="".concat(CM_ALIAS,".align.left"),CONTEXTMENU_ITEMS_ALIGNMENT_CENTER="".concat(CM_ALIAS,".align.center"),CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT="".concat(CM_ALIAS,".align.right"),CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY="".concat(CM_ALIAS,".align.justify"),CONTEXTMENU_ITEMS_ALIGNMENT_TOP="".concat(CM_ALIAS,".align.top"),CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE="".concat(CM_ALIAS,".align.middle"),CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM="".concat(CM_ALIAS,".align.bottom"),CONTEXTMENU_ITEMS_BORDERS="".concat(CM_ALIAS,".borders"),CONTEXTMENU_ITEMS_BORDERS_TOP="".concat(CM_ALIAS,".borders.top"),CONTEXTMENU_ITEMS_BORDERS_RIGHT="".concat(CM_ALIAS,".borders.right"),CONTEXTMENU_ITEMS_BORDERS_BOTTOM="".concat(CM_ALIAS,".borders.bottom"),CONTEXTMENU_ITEMS_BORDERS_LEFT="".concat(CM_ALIAS,".borders.left"),CONTEXTMENU_ITEMS_REMOVE_BORDERS="".concat(CM_ALIAS,".borders.remove"),CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD="".concat(CM_ALIAS,".nestedHeaders.insertChildRow"),CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD="".concat(CM_ALIAS,".nestedHeaders.detachFromParent"),CONTEXTMENU_ITEMS_HIDE_COLUMN="".concat(CM_ALIAS,".hideColumn"),CONTEXTMENU_ITEMS_SHOW_COLUMN="".concat(CM_ALIAS,".showColumn"),CONTEXTMENU_ITEMS_HIDE_ROW="".concat(CM_ALIAS,".hideRow"),CONTEXTMENU_ITEMS_SHOW_ROW="".concat(CM_ALIAS,".showRow"),FILTERS_NAMESPACE="Filters:",FILTERS_CONDITIONS_NAMESPACE="".concat(FILTERS_NAMESPACE,"conditions"),FILTERS_CONDITIONS_NONE="".concat(FILTERS_CONDITIONS_NAMESPACE,".none"),FILTERS_CONDITIONS_EMPTY="".concat(FILTERS_CONDITIONS_NAMESPACE,".isEmpty"),FILTERS_CONDITIONS_NOT_EMPTY="".concat(FILTERS_CONDITIONS_NAMESPACE,".isNotEmpty"),FILTERS_CONDITIONS_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".isEqualTo"),FILTERS_CONDITIONS_NOT_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".isNotEqualTo"),FILTERS_CONDITIONS_BEGINS_WITH="".concat(FILTERS_CONDITIONS_NAMESPACE,".beginsWith"),FILTERS_CONDITIONS_ENDS_WITH="".concat(FILTERS_CONDITIONS_NAMESPACE,".endsWith"),FILTERS_CONDITIONS_CONTAINS="".concat(FILTERS_CONDITIONS_NAMESPACE,".contains"),FILTERS_CONDITIONS_NOT_CONTAIN="".concat(FILTERS_CONDITIONS_NAMESPACE,".doesNotContain"),FILTERS_CONDITIONS_BY_VALUE="".concat(FILTERS_CONDITIONS_NAMESPACE,".byValue"),FILTERS_CONDITIONS_GREATER_THAN="".concat(FILTERS_CONDITIONS_NAMESPACE,".greaterThan"),FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".greaterThanOrEqualTo"),FILTERS_CONDITIONS_LESS_THAN="".concat(FILTERS_CONDITIONS_NAMESPACE,".lessThan"),FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".lessThanOrEqualTo"),FILTERS_CONDITIONS_BETWEEN="".concat(FILTERS_CONDITIONS_NAMESPACE,".isBetween"),FILTERS_CONDITIONS_NOT_BETWEEN="".concat(FILTERS_CONDITIONS_NAMESPACE,".isNotBetween"),FILTERS_CONDITIONS_AFTER="".concat(FILTERS_CONDITIONS_NAMESPACE,".after"),FILTERS_CONDITIONS_BEFORE="".concat(FILTERS_CONDITIONS_NAMESPACE,".before"),FILTERS_CONDITIONS_TODAY="".concat(FILTERS_CONDITIONS_NAMESPACE,".today"),FILTERS_CONDITIONS_TOMORROW="".concat(FILTERS_CONDITIONS_NAMESPACE,".tomorrow"),FILTERS_CONDITIONS_YESTERDAY="".concat(FILTERS_CONDITIONS_NAMESPACE,".yesterday"),FILTERS_DIVS_FILTER_BY_CONDITION="".concat(FILTERS_NAMESPACE,"labels.filterByCondition"),FILTERS_DIVS_FILTER_BY_VALUE="".concat(FILTERS_NAMESPACE,"labels.filterByValue"),FILTERS_LABELS_CONJUNCTION="".concat(FILTERS_NAMESPACE,"labels.conjunction"),FILTERS_LABELS_DISJUNCTION="".concat(FILTERS_NAMESPACE,"labels.disjunction"),FILTERS_VALUES_BLANK_CELLS="".concat(FILTERS_NAMESPACE,"values.blankCells"),FILTERS_BUTTONS_SELECT_ALL="".concat(FILTERS_NAMESPACE,"buttons.selectAll"),FILTERS_BUTTONS_CLEAR="".concat(FILTERS_NAMESPACE,"buttons.clear"),FILTERS_BUTTONS_OK="".concat(FILTERS_NAMESPACE,"buttons.ok"),FILTERS_BUTTONS_CANCEL="".concat(FILTERS_NAMESPACE,"buttons.cancel"),FILTERS_BUTTONS_PLACEHOLDER_SEARCH="".concat(FILTERS_NAMESPACE,"buttons.placeholder.search"),FILTERS_BUTTONS_PLACEHOLDER_VALUE="".concat(FILTERS_NAMESPACE,"buttons.placeholder.value"),FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE="".concat(FILTERS_NAMESPACE,"buttons.placeholder.secondValue");const dictionaryKeys=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT,CONTEXTMENU_ITEMS_ALIGNMENT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP,CONTEXTMENU_ITEMS_BORDERS,CONTEXTMENU_ITEMS_BORDERS_BOTTOM,CONTEXTMENU_ITEMS_BORDERS_LEFT,CONTEXTMENU_ITEMS_BORDERS_RIGHT,CONTEXTMENU_ITEMS_BORDERS_TOP,CONTEXTMENU_ITEMS_CLEAR_COLUMN,CONTEXTMENU_ITEMS_COPY,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,CONTEXTMENU_ITEMS_CUT,CONTEXTMENU_ITEMS_EDIT_COMMENT,CONTEXTMENU_ITEMS_FREEZE_COLUMN,CONTEXTMENU_ITEMS_HIDE_COLUMN,CONTEXTMENU_ITEMS_HIDE_ROW,CONTEXTMENU_ITEMS_INSERT_LEFT,CONTEXTMENU_ITEMS_INSERT_RIGHT,CONTEXTMENU_ITEMS_MERGE_CELLS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,CONTEXTMENU_ITEMS_NO_ITEMS,CONTEXTMENU_ITEMS_READ_ONLY,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,CONTEXTMENU_ITEMS_REDO,CONTEXTMENU_ITEMS_REMOVE_BORDERS,CONTEXTMENU_ITEMS_REMOVE_COLUMN,CONTEXTMENU_ITEMS_REMOVE_COMMENT,CONTEXTMENU_ITEMS_REMOVE_ROW,CONTEXTMENU_ITEMS_ROW_ABOVE,CONTEXTMENU_ITEMS_ROW_BELOW,CONTEXTMENU_ITEMS_SHOW_COLUMN,CONTEXTMENU_ITEMS_SHOW_ROW,CONTEXTMENU_ITEMS_UNDO,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,CONTEXTMENU_ITEMS_UNMERGE_CELLS,CONTEXT_MENU_ITEMS_NAMESPACE,FILTERS_BUTTONS_CANCEL,FILTERS_BUTTONS_CLEAR,FILTERS_BUTTONS_OK,FILTERS_BUTTONS_PLACEHOLDER_SEARCH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,FILTERS_BUTTONS_PLACEHOLDER_VALUE,FILTERS_BUTTONS_SELECT_ALL,FILTERS_CONDITIONS_AFTER,FILTERS_CONDITIONS_BEFORE,FILTERS_CONDITIONS_BEGINS_WITH,FILTERS_CONDITIONS_BETWEEN,FILTERS_CONDITIONS_BY_VALUE,FILTERS_CONDITIONS_CONTAINS,FILTERS_CONDITIONS_EMPTY,FILTERS_CONDITIONS_ENDS_WITH,FILTERS_CONDITIONS_EQUAL,FILTERS_CONDITIONS_GREATER_THAN,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,FILTERS_CONDITIONS_LESS_THAN,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,FILTERS_CONDITIONS_NAMESPACE,FILTERS_CONDITIONS_NONE,FILTERS_CONDITIONS_NOT_BETWEEN,FILTERS_CONDITIONS_NOT_CONTAIN,FILTERS_CONDITIONS_NOT_EMPTY,FILTERS_CONDITIONS_NOT_EQUAL,FILTERS_CONDITIONS_TODAY,FILTERS_CONDITIONS_TOMORROW,FILTERS_CONDITIONS_YESTERDAY,FILTERS_DIVS_FILTER_BY_CONDITION,FILTERS_DIVS_FILTER_BY_VALUE,FILTERS_LABELS_CONJUNCTION,FILTERS_LABELS_DISJUNCTION,FILTERS_NAMESPACE,FILTERS_VALUES_BLANK_CELLS},Symbol.toStringTag,{value:"Module"}));function _typeof$22(e){return _typeof$22=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$22(e)}var _dictionary;function _defineProperty$u(e,t,r){return t=_toPropertyKey$1Z(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1Z(e){var t=_toPrimitive$1Z(e,"string");return _typeof$22(t)==="symbol"?t:String(t)}function _toPrimitive$1Z(e,t){if(_typeof$22(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$22(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dictionary=(_dictionary={languageCode:"en-US"},_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_NO_ITEMS,"No available options"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_UNDO,"Undo"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_REDO,"Redo"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_BORDERS,"Borders"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_COPY,"Copy"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,["Copy with header","Copy with headers"]),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,["Copy with group header","Copy with group headers"]),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,["Copy header only","Copy headers only"]),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_CUT,"Cut"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),_defineProperty$u(_dictionary,CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_NONE,"None"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_EMPTY,"Is empty"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_EQUAL,"Is equal to"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_CONTAINS,"Contains"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_LESS_THAN,"Less than"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_BETWEEN,"Is between"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_AFTER,"After"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_BEFORE,"Before"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_TODAY,"Today"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),_defineProperty$u(_dictionary,FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),_defineProperty$u(_dictionary,FILTERS_VALUES_BLANK_CELLS,"Blank cells"),_defineProperty$u(_dictionary,FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),_defineProperty$u(_dictionary,FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),_defineProperty$u(_dictionary,FILTERS_LABELS_CONJUNCTION,"And"),_defineProperty$u(_dictionary,FILTERS_LABELS_DISJUNCTION,"Or"),_defineProperty$u(_dictionary,FILTERS_BUTTONS_SELECT_ALL,"Select all"),_defineProperty$u(_dictionary,FILTERS_BUTTONS_CLEAR,"Clear"),_defineProperty$u(_dictionary,FILTERS_BUTTONS_OK,"OK"),_defineProperty$u(_dictionary,FILTERS_BUTTONS_CANCEL,"Cancel"),_defineProperty$u(_dictionary,FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),_defineProperty$u(_dictionary,FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),_defineProperty$u(_dictionary,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),_dictionary);const DEFAULT_DICTIONARY=dictionary;var DEFAULT_LANGUAGE_CODE=DEFAULT_DICTIONARY.languageCode,_staticRegister$3=staticRegister("languagesDictionaries"),registerGloballyLanguageDictionary=_staticRegister$3.register,getGlobalLanguageDictionary=_staticRegister$3.getItem,hasGlobalLanguageDictionary=_staticRegister$3.hasItem,getGlobalLanguagesDictionaries=_staticRegister$3.getValues;registerLanguageDictionary(DEFAULT_DICTIONARY);function registerLanguageDictionary(e,t){var r=e,n=t;return isObject$6(e)&&(n=e,r=n.languageCode),extendLanguageDictionary(r,n),registerGloballyLanguageDictionary(r,deepClone(n)),deepClone(n)}function extendLanguageDictionary(e,t){e!==DEFAULT_LANGUAGE_CODE&&extendNotExistingKeys(t,getGlobalLanguageDictionary(DEFAULT_LANGUAGE_CODE))}function getLanguageDictionary(e){return hasLanguageDictionary(e)?deepClone(getGlobalLanguageDictionary(e)):null}function hasLanguageDictionary(e){return hasGlobalLanguageDictionary(e)}function getLanguagesDictionaries(){return getGlobalLanguagesDictionaries()}function getTranslatedPhrase(e,t,r){var n=getLanguageDictionary(e);if(n===null)return null;var o=n[t];if(isUndefined(o))return null;var i=getFormattedPhrase(o,r);return Array.isArray(i)?i[0]:i}function getFormattedPhrase(e,t){var r=e;return arrayEach(getAll(),function(n){r=n(e,t)}),r}function getValidLanguageCode(e){var t=normalizeLanguageCode(e);return hasLanguageDictionary(t)||(t=DEFAULT_LANGUAGE_CODE,warnUserAboutLanguageRegistration(e)),t}var $$5=_export,DESCRIPTORS$1=descriptors,ownKeys$i=ownKeys$k,toIndexedObject=toIndexedObject$d,getOwnPropertyDescriptorModule=objectGetOwnPropertyDescriptor,createProperty=createProperty$6;$$5({target:"Object",stat:!0,sham:!DESCRIPTORS$1},{getOwnPropertyDescriptors:function(t){for(var r=toIndexedObject(t),n=getOwnPropertyDescriptorModule.f,o=ownKeys$i(r),i={},a=0,s,l;o.length>a;)l=n(r,s=o[a++]),l!==void 0&&createProperty(i,s,l);return i}});var ACTIVE_HEADER_TYPE="active-header",AREA_TYPE="area",CELL_TYPE$9="cell",FILL_TYPE="fill",HEADER_TYPE="header",CUSTOM_SELECTION_TYPE="custom-selection";function _typeof$21(e){return _typeof$21=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$21(e)}function _classCallCheck$1N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1Y(n.key),n)}}function _createClass$1N(e,t,r){return t&&_defineProperties$1N(e.prototype,t),r&&_defineProperties$1N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _get$Q(){return typeof Reflect<"u"&&Reflect.get?_get$Q=Reflect.get.bind():_get$Q=function(t,r,n){var o=_superPropBase$Q(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$Q.apply(this,arguments)}function _superPropBase$Q(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$$(e),e!==null););return e}function _inherits$$(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$$(e,t)}function _setPrototypeOf$$(e,t){return _setPrototypeOf$$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$$(e,t)}function _createSuper$$(e){var t=_isNativeReflectConstruct$$();return function(){var n=_getPrototypeOf$$(e),o;if(t){var i=_getPrototypeOf$$(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$$(this,o)}}function _possibleConstructorReturn$$(e,t){if(t&&(_typeof$21(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$$(e)}function _assertThisInitialized$$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$$(e){return _getPrototypeOf$$=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$$(e)}function _defineProperty$t(e,t,r){return t=_toPropertyKey$1Y(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1Y(e){var t=_toPrimitive$1Y(e,"string");return _typeof$21(t)==="symbol"?t:String(t)}function _toPrimitive$1Y(e,t){if(_typeof$21(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$21(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VisualSelection=function(e){_inherits$$(r,e);var t=_createSuper$$(r);function r(n,o){var i;return _classCallCheck$1N(this,r),i=t.call(this,n,null),_defineProperty$t(_assertThisInitialized$$(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return _createClass$1N(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,_get$Q(_getPrototypeOf$$(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,s=this.getNearestNotHiddenCoords(i,1),l=this.getNearestNotHiddenCoords(a,-1);if(s===null||l===null)return null;if(s.row>l.row||s.col>l.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;s=i,l=a}return this.settings.createCellRange(s,s,l)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(s===null)return null;var l=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return l===null?null:this.settings.createCellCoords(s,l)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var s=o.getNearestNotHiddenIndex(i,a),l=this.settings.type==="header"||this.settings.type==="active-header";return l&&s===null?-1:s}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,s=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(s!==null&&o.overlaps(s)){if(this.cellRange===null){var l=this.settings.visualToRenderableCoords(s);this.cellRange=this.settings.createCellRange(l)}return o.setHighlight(s),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,s=i.row===null||a.row===null,l=i.col===null||a.col===null,u=this.settings.createCellCoords(s?null:Math.min(i.row,a.row),l?null:Math.min(i.col,a.col)),c=this.settings.createCellCoords(s?null:Math.max(i.row,a.row),l?null:Math.max(i.col,a.col));return[u.row,u.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),s=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,s)}}]),r}(Selection$3);const VisualSelection$1=VisualSelection;function _typeof$20(e){return _typeof$20=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$20(e)}var _excluded$8=["activeHeaderClassName"];function ownKeys$h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$h(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$h(Object(r),!0).forEach(function(n){_defineProperty$s(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$h(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$s(e,t,r){return t=_toPropertyKey$1X(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1X(e){var t=_toPrimitive$1X(e,"string");return _typeof$20(t)==="symbol"?t:String(t)}function _toPrimitive$1X(e,t){if(_typeof$20(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$20(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _objectWithoutProperties$8(e,t){if(e==null)return{};var r=_objectWithoutPropertiesLoose$8(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _objectWithoutPropertiesLoose$8(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function createHighlight$6(e){var t=e.activeHeaderClassName,r=_objectWithoutProperties$8(e,_excluded$8),n=new VisualSelection$1(_objectSpread$h(_objectSpread$h({highlightHeaderClassName:t},r),{},{selectionType:ACTIVE_HEADER_TYPE}));return n}function _typeof$1$(e){return _typeof$1$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1$(e)}var _excluded$7=["layerLevel","areaCornerVisible"];function ownKeys$g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$g(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$g(Object(r),!0).forEach(function(n){_defineProperty$r(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$g(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$r(e,t,r){return t=_toPropertyKey$1W(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1W(e){var t=_toPrimitive$1W(e,"string");return _typeof$1$(t)==="symbol"?t:String(t)}function _toPrimitive$1W(e,t){if(_typeof$1$(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1$(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _objectWithoutProperties$7(e,t){if(e==null)return{};var r=_objectWithoutPropertiesLoose$7(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _objectWithoutPropertiesLoose$7(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function createHighlight$5(e){var t=e.layerLevel,r=e.areaCornerVisible,n=_objectWithoutProperties$7(e,_excluded$7),o=new VisualSelection$1(_objectSpread$g(_objectSpread$g({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:AREA_TYPE}));return o}function _typeof$1_(e){return _typeof$1_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1_(e)}var _excluded$6=["cellCornerVisible"];function ownKeys$f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$f(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$f(Object(r),!0).forEach(function(n){_defineProperty$q(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$f(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$q(e,t,r){return t=_toPropertyKey$1V(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1V(e){var t=_toPrimitive$1V(e,"string");return _typeof$1_(t)==="symbol"?t:String(t)}function _toPrimitive$1V(e,t){if(_typeof$1_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _objectWithoutProperties$6(e,t){if(e==null)return{};var r=_objectWithoutPropertiesLoose$6(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _objectWithoutPropertiesLoose$6(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function createHighlight$4(e){var t=e.cellCornerVisible,r=_objectWithoutProperties$6(e,_excluded$6),n=new VisualSelection$1(_objectSpread$f(_objectSpread$f({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:CELL_TYPE$9}));return n}function _typeof$1Z(e){return _typeof$1Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1Z(e)}var _excluded$5=["border","visualCellRange"];function ownKeys$e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$e(Object(r),!0).forEach(function(n){_defineProperty$p(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$e(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$p(e,t,r){return t=_toPropertyKey$1U(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1U(e){var t=_toPrimitive$1U(e,"string");return _typeof$1Z(t)==="symbol"?t:String(t)}function _toPrimitive$1U(e,t){if(_typeof$1Z(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1Z(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _objectWithoutProperties$5(e,t){if(e==null)return{};var r=_objectWithoutPropertiesLoose$5(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _objectWithoutPropertiesLoose$5(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function createHighlight$3(e){var t=e.border,r=e.visualCellRange,n=_objectWithoutProperties$5(e,_excluded$5),o=new VisualSelection$1(_objectSpread$e(_objectSpread$e(_objectSpread$e({},t),n),{},{selectionType:CUSTOM_SELECTION_TYPE}),r);return o}var DESCRIPTORS=descriptors,uncurryThis$4=functionUncurryThis,call$1=functionCall,fails$2=fails$I,objectKeys=objectKeys$4,getOwnPropertySymbolsModule=objectGetOwnPropertySymbols,propertyIsEnumerableModule=objectPropertyIsEnumerable,toObject=toObject$f,IndexedObject=indexedObject,$assign=Object.assign,defineProperty=Object.defineProperty,concat=uncurryThis$4([].concat),objectAssign=!$assign||fails$2(function(){if(DESCRIPTORS&&$assign({b:1},$assign(defineProperty({},"a",{enumerable:!0,get:function(){defineProperty(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),$assign({},e)[r]!=7||objectKeys($assign({},t)).join("")!=n})?function(t,r){for(var n=toObject(t),o=arguments.length,i=1,a=getOwnPropertySymbolsModule.f,s=propertyIsEnumerableModule.f;o>i;)for(var l=IndexedObject(arguments[i++]),u=a?concat(objectKeys(l),a(l)):objectKeys(l),c=u.length,f=0,d;c>f;)d=u[f++],(!DESCRIPTORS||call$1(s,l,d))&&(n[d]=l[d]);return n}:$assign,$$4=_export,assign=objectAssign;$$4({target:"Object",stat:!0,arity:2,forced:Object.assign!==assign},{assign});function _typeof$1Y(e){return _typeof$1Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1Y(e)}function ownKeys$d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$d(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$d(Object(r),!0).forEach(function(n){_defineProperty$o(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$d(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$o(e,t,r){return t=_toPropertyKey$1T(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1T(e){var t=_toPrimitive$1T(e,"string");return _typeof$1Y(t)==="symbol"?t:String(t)}function _toPrimitive$1T(e,t){if(_typeof$1Y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1Y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _objectDestructuringEmpty(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function createHighlight$2(e){var t=Object.assign({},(_objectDestructuringEmpty(e),e)),r=new VisualSelection$1(_objectSpread$d(_objectSpread$d({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:FILL_TYPE}));return r}function _typeof$1X(e){return _typeof$1X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1X(e)}var _excluded$4=["headerClassName","rowClassName","columnClassName"];function ownKeys$c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$c(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$c(Object(r),!0).forEach(function(n){_defineProperty$n(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$c(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$n(e,t,r){return t=_toPropertyKey$1S(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1S(e){var t=_toPrimitive$1S(e,"string");return _typeof$1X(t)==="symbol"?t:String(t)}function _toPrimitive$1S(e,t){if(_typeof$1X(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1X(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _objectWithoutProperties$4(e,t){if(e==null)return{};var r=_objectWithoutPropertiesLoose$4(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _objectWithoutPropertiesLoose$4(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function createHighlight$1(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=_objectWithoutProperties$4(e,_excluded$4),i=new VisualSelection$1(_objectSpread$c(_objectSpread$c({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:HEADER_TYPE}));return i}function _typeof$1W(e){return _typeof$1W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1W(e)}function ownKeys$b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$b(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$b(Object(r),!0).forEach(function(n){_defineProperty$m(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$b(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$m(e,t,r){return t=_toPropertyKey$1R(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1R(e){var t=_toPrimitive$1R(e,"string");return _typeof$1W(t)==="symbol"?t:String(t)}function _toPrimitive$1R(e,t){if(_typeof$1W(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1W(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _staticRegister$2=staticRegister("highlight/types"),register$1=_staticRegister$2.register,getItem$1=_staticRegister$2.getItem;register$1(ACTIVE_HEADER_TYPE,createHighlight$6);register$1(AREA_TYPE,createHighlight$5);register$1(CELL_TYPE$9,createHighlight$4);register$1(CUSTOM_SELECTION_TYPE,createHighlight$3);register$1(FILL_TYPE,createHighlight$2);register$1(HEADER_TYPE,createHighlight$1);function createHighlight(e,t){return getItem$1(e)(_objectSpread$b({type:e},t))}function _typeof$1V(e){return _typeof$1V=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1V(e)}function _toConsumableArray$n(e){return _arrayWithoutHoles$n(e)||_iterableToArray$p(e)||_unsupportedIterableToArray$Y(e)||_nonIterableSpread$n()}function _nonIterableSpread$n(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$Y(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$Y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$Y(e,t)}}function _iterableToArray$p(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$n(e){if(Array.isArray(e))return _arrayLikeToArray$Y(e)}function _arrayLikeToArray$Y(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys$a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$a(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$a(Object(r),!0).forEach(function(n){_defineProperty$l(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$a(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$l(e,t,r){return t=_toPropertyKey$1Q(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck$1M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1Q(n.key),n)}}function _createClass$1M(e,t,r){return t&&_defineProperties$1M(e.prototype,t),r&&_defineProperties$1M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1Q(e){var t=_toPrimitive$1Q(e,"string");return _typeof$1V(t)==="symbol"?t:String(t)}function _toPrimitive$1Q(e,t){if(_typeof$1V(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1V(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Highlight=function(e){function t(r){_classCallCheck$1M(this,t),this.options=r,this.layerLevel=0,this.cell=createHighlight(CELL_TYPE$9,r),this.fill=createHighlight(FILL_TYPE,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return _createClass$1M(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===CELL_TYPE$9&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=createHighlight(AREA_TYPE,_objectSpread$a({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return _toConsumableArray$n(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=createHighlight(HEADER_TYPE,_objectSpread$a({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return _toConsumableArray$n(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=createHighlight(ACTIVE_HEADER_TYPE,_objectSpread$a({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return _toConsumableArray$n(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return _toConsumableArray$n(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(createHighlight(CUSTOM_SELECTION_TYPE,_objectSpread$a(_objectSpread$a({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),arrayEach(this.areas.values(),function(n){return void n.clear()}),arrayEach(this.headers.values(),function(n){return void n.clear()}),arrayEach(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(_toConsumableArray$n(this.areas.values()),_toConsumableArray$n(this.headers.values()),_toConsumableArray$n(this.activeHeaders.values()),_toConsumableArray$n(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const Highlight$1=Highlight;function _typeof$1U(e){return _typeof$1U=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1U(e)}function _classCallCheck$1L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1P(n.key),n)}}function _createClass$1L(e,t,r){return t&&_defineProperties$1L(e.prototype,t),r&&_defineProperties$1L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1P(e){var t=_toPrimitive$1P(e,"string");return _typeof$1U(t)==="symbol"?t:String(t)}function _toPrimitive$1P(e,t){if(_typeof$1U(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1U(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SelectionRange=function(e){function t(r){_classCallCheck$1L(this,t),this.ranges=[],this.createCellRange=r}return _createClass$1L(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const SelectionRange$1=SelectionRange;function _typeof$1T(e){return _typeof$1T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1T(e)}function _classCallCheck$1K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1O(n.key),n)}}function _createClass$1K(e,t,r){return t&&_defineProperties$1K(e.prototype,t),r&&_defineProperties$1K(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1O(e){var t=_toPrimitive$1O(e,"string");return _typeof$1T(t)==="symbol"?t:String(t)}function _toPrimitive$1O(e,t){if(_typeof$1T(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1T(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Transformation=function(){function e(t,r){_classCallCheck$1K(this,e),this.range=t,this.options=r}return _createClass$1K(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,s=this.options.visualToRenderableCoords(a),l=s.row,u=s.col,c=a,f=0,d=0;if(this.runLocalHooks("beforeTransformStart",i),l!==null&&u!==null){var h=this.options.countRows(),y=this.options.countCols(),p=this.options.fixedRowsBottom(),v=this.options.minSpareRows(),b=this.options.minSpareCols(),S=this.options.autoWrapRow(),w=this.options.autoWrapCol();l+r>h-1?o&&v>0&&!(p&&l>=h-p-1)?(this.runLocalHooks("insertRowRequire",h),h=this.options.countRows()):w&&(i.row=1-h,i.col=u+i.col===y-1?1-y:1):w&&l+i.row<0&&u+i.col>=0&&(i.row=h-1,i.col=u+i.col===0?y-1:-1),u+i.col>y-1?o&&b>0?(this.runLocalHooks("insertColRequire",y),y=this.options.countCols()):S&&(i.row=l+i.row===h-1?1-h:1,i.col=1-y):S&&u+i.col<0&&l+i.row>=0&&(i.row=l+i.row===0?h-1:-1,i.col=y-1);var P=this.options.createCellCoords(l+i.row,u+i.col);f=0,d=0,P.row<0?(f=-1,P.row=0):P.row>0&&P.row>=h&&(f=1,P.row=h-1),P.col<0?(d=-1,P.col=0):P.col>0&&P.col>=y&&(d=1,P.col=y-1),c=this.options.renderableToVisualCoords(P)}return this.runLocalHooks("afterTransformStart",c,f,d),c}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,s=0,l=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),c=u.row,f=u.col;if(c!==null&&f!==null){var d=this.options.countRows(),h=this.options.countCols(),y=this.options.visualToRenderableCoords(i.to),p=y.row,v=y.col,b=this.options.createCellCoords(p+o.row,v+o.col);s=0,l=0,b.row<0?(s=-1,b.row=0):b.row>0&&b.row>=d&&(s=1,b.row=d-1),b.col<0?(l=-1,b.col=0):b.col>0&&b.col>=h&&(l=1,b.col=h-1),a=this.options.renderableToVisualCoords(b)}return this.runLocalHooks("afterTransformEnd",a,s,l),a}}]),e}();mixin(Transformation,localHooks$1);const Transformation$1=Transformation;function _slicedToArray$E(e,t){return _arrayWithHoles$G(e)||_iterableToArrayLimit$E(e,t)||_unsupportedIterableToArray$X(e,t)||_nonIterableRest$G()}function _nonIterableRest$G(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$X(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$X(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$X(e,t)}}function _arrayLikeToArray$X(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$E(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$G(e){if(Array.isArray(e))return e}function _typeof$1S(e){return _typeof$1S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1S(e)}var SELECTION_TYPE_UNRECOGNIZED=0,SELECTION_TYPE_EMPTY=1,SELECTION_TYPE_ARRAY=2,SELECTION_TYPE_OBJECT=3,SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY],ARRAY_TYPE_PATTERN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],rootCall=Symbol("root"),childCall=Symbol("child");function detectSelectionType(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rootCall;if(t!==rootCall&&t!==childCall)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===rootCall,o=SELECTION_TYPE_UNRECOGNIZED;if(r){var i=e[0];if(e.length===0)o=SELECTION_TYPE_EMPTY;else if(n&&i instanceof CellRange$1)o=SELECTION_TYPE_OBJECT;else if(n&&Array.isArray(i))o=detectSelectionType(i,childCall);else if(e.length>=2&&e.length<=4){var a=!e.some(function(s,l){return!ARRAY_TYPE_PATTERN[l].includes(_typeof$1S(s))});a&&(o=SELECTION_TYPE_ARRAY)}}return o}function normalizeSelectionFactory(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!SELECTION_TYPES.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===SELECTION_TYPE_OBJECT,s=a?i.from.row:i[0],l=a?i.from.col:i[1],u=a?i.to.row:i[2],c=a?i.to.col:i[3];if(typeof o=="function"&&(typeof l=="string"&&(l=o(l)),typeof c=="string"&&(c=o(c))),isUndefined(u)&&(u=s),isUndefined(c)&&(c=l),!n){var f=s,d=l,h=u,y=c;s=Math.min(f,h),l=Math.min(d,y),u=Math.max(f,h),c=Math.max(d,y)}return[s,l,u,c]}}function transformSelectionToColumnDistance(e){var t=detectSelectionType(e);if(t===SELECTION_TYPE_UNRECOGNIZED||t===SELECTION_TYPE_EMPTY)return[];var r=normalizeSelectionFactory(t),n=new Set;arrayEach(e,function(a){var s=r(a),l=_slicedToArray$E(s,4),u=l[1],c=l[3],f=Math.max(u,0),d=c-f+1;arrayEach(Array.from(new Array(d),function(h,y){return f+y}),function(h){n.has(h)||n.add(h)})});var o=Array.from(n).sort(function(a,s){return a-s}),i=arrayReduce$1(o,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return i}function transformSelectionToRowDistance(e){var t=detectSelectionType(e);if(t===SELECTION_TYPE_UNRECOGNIZED||t===SELECTION_TYPE_EMPTY)return[];var r=normalizeSelectionFactory(t),n=new Set;arrayEach(e,function(a){var s=r(a),l=_slicedToArray$E(s,3),u=l[0],c=l[2],f=Math.max(u,0),d=c-f+1;arrayEach(Array.from(new Array(d),function(h,y){return f+y}),function(h){n.has(h)||n.add(h)})});var o=Array.from(n).sort(function(a,s){return a-s}),i=arrayReduce$1(o,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return i}function isValidCoord(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function _typeof$1R(e){return _typeof$1R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1R(e)}var _templateObject$d;function _slicedToArray$D(e,t){return _arrayWithHoles$F(e)||_iterableToArrayLimit$D(e,t)||_unsupportedIterableToArray$W(e,t)||_nonIterableRest$F()}function _nonIterableRest$F(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$W(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$W(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$W(e,t)}}function _arrayLikeToArray$W(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$D(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$F(e){if(Array.isArray(e))return e}function _taggedTemplateLiteral$d(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$1J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1N(n.key),n)}}function _createClass$1J(e,t,r){return t&&_defineProperties$1J(e.prototype,t),r&&_defineProperties$1J(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1N(e){var t=_toPrimitive$1N(e,"string");return _typeof$1R(t)==="symbol"?t:String(t)}function _toPrimitive$1N(e,t){if(_typeof$1R(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1R(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Selection=function(){function e(t,r){var n=this;_classCallCheck$1J(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new SelectionRange$1(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new Highlight$1({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,s){return n.tableProps.createCellRange(i,a,s)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new Transformation$1(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return _createClass$1J(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=isUndefined(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,s=r.row<0,l=r.col<0,u=s&&l,c=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),c),(!i||i&&!a&&isUndefined(n))&&this.selectedRange.clear(),this.selectedRange.add(c),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(CELL_TYPE$9,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&(arrayEach(this.highlight.getAreas(),function(p){return void p.clear()}),arrayEach(this.highlight.getHeaders(),function(p){return void p.clear()}),arrayEach(this.highlight.getActiveHeaders(),function(p){return void p.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(a.clear(),s.clear(),l.clear(),this.highlight.isEnabledFor(AREA_TYPE,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(HEADER_TYPE,o.highlight)){var c=this.tableProps.countRowsTranslated()===0,f=this.tableProps.countColsTranslated()===0,d=o;if((c||f)&&(d=o.clone()),c&&(d.from.row=-1),f&&(d.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&d.from.normalize(),s.add(d.from).commit()):s.add(d.from).add(d.to).commit(),this.isEntireRowSelected()){var h=this.tableProps.countCols()===o.getWidth();h&&l.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var y=this.tableProps.countRows()===o.getHeight();y&&l.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=createObjectPropListener(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),s=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(s),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=detectSelectionType(r);if(o===SELECTION_TYPE_EMPTY)return!1;if(o===SELECTION_TYPE_UNRECOGNIZED)throw new Error(toSingleLine(_templateObject$d||(_templateObject$d=_taggedTemplateLiteral$d([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=normalizeSelectionFactory(o,{propToCol:function(c){return n.tableProps.propToCol(c)},keepDirection:!0}),a=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!r.some(function(u){var c=i(u),f=_slicedToArray$D(c,4),d=f[0],h=f[1],y=f[2],p=f[3],v=isValidCoord(d,a)&&isValidCoord(h,s)&&isValidCoord(y,a)&&isValidCoord(p,s);return!v});return l&&(this.clear(),arrayEach(r,function(u){var c=i(u),f=_slicedToArray$D(c,4),d=f[0],h=f[1],y=f[2],p=f[3];n.setRangeStartOnly(n.tableProps.createCellCoords(d,h),!1),n.setRangeEnd(n.tableProps.createCellCoords(y,p)),n.finish()})),l}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countCols(),l=this.tableProps.countRows(),u=isValidCoord(i,s)&&isValidCoord(a,s);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(l-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),s=isValidCoord(r,i)&&isValidCoord(n,i);return s&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),s}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();a.commit(),s.commit(),l.commit()}this.highlight.useLayerLevel(o)}}}]),e}();mixin(Selection,localHooks$1);const Selection$1=Selection;var $$3=_export,uncurryThis$3=functionUncurryThisClause,getOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f,toLength$1=toLength$7,toString$3=toString$l,notARegExp$1=notARegexp,requireObjectCoercible$3=requireObjectCoercible$e,correctIsRegExpLogic$1=correctIsRegexpLogic,nativeStartsWith=uncurryThis$3("".startsWith),stringSlice$1=uncurryThis$3("".slice),min$1=Math.min,CORRECT_IS_REGEXP_LOGIC$1=correctIsRegExpLogic$1("startsWith"),MDN_POLYFILL_BUG$1=!CORRECT_IS_REGEXP_LOGIC$1&&!!function(){var e=getOwnPropertyDescriptor$1(String.prototype,"startsWith");return e&&!e.writable}();$$3({target:"String",proto:!0,forced:!MDN_POLYFILL_BUG$1&&!CORRECT_IS_REGEXP_LOGIC$1},{startsWith:function(t){var r=toString$3(requireObjectCoercible$3(this));notARegExp$1(t);var n=toLength$1(min$1(arguments.length>1?arguments[1]:void 0,r.length)),o=toString$3(t);return nativeStartsWith?nativeStartsWith(r,o,n):stringSlice$1(r,n,n+o.length)===o}});var regUniversalNewLine=/^(\r\n|\n\r|\r|\n)/,regNextCellNoQuotes=/^[^\t\r\n]+/,regNextEmptyCell=/^\t/;function parse(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(regNextEmptyCell))e=e.replace(regNextEmptyCell,""),r+=1,t[n][r]="";else if(e.match(regUniversalNewLine))e=e.replace(regUniversalNewLine,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,s=!0;s;){var l=e.slice(0,1);l==='"'&&(a+=1),i+=l,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(s=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(c){return new Array(Math.floor(c.length/2)).fill('"').join("")})}else{var u=e.match(regNextCellNoQuotes);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function stringify(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function _toConsumableArray$m(e){return _arrayWithoutHoles$m(e)||_iterableToArray$o(e)||_unsupportedIterableToArray$V(e)||_nonIterableSpread$m()}function _nonIterableSpread$m(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$V(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$V(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$V(e,t)}}function _iterableToArray$o(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$m(e){if(Array.isArray(e))return _arrayLikeToArray$V(e)}function _arrayLikeToArray$V(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _typeof$1Q(e){return _typeof$1Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1Q(e)}function _classCallCheck$1I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1M(n.key),n)}}function _createClass$1I(e,t,r){return t&&_defineProperties$1I(e.prototype,t),r&&_defineProperties$1I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1M(e){var t=_toPrimitive$1M(e,"string");return _typeof$1Q(t)==="symbol"?t:String(t)}function _toPrimitive$1M(e,t){if(_typeof$1Q(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1Q(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataMap=function(){function e(t,r,n){_classCallCheck$1I(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return _createClass$1I(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,s=!1;if(typeof n=="function"){var l=deepObjectSize(r);i=l>0?l:this.countFirstRowKeys(),s=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var c=s?n(o):n[o];if(isObject$6(c)){if(typeof c.data<"u"){var f=s?a:o;this.colToPropCache[f]=c.data,this.propToColCache.set(c.data,f)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return countFirstRowKeys(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,s=o,l;return typeof a>"u"&&(a=0,s=""),_typeof$1Q(r)==="object"&&!Array.isArray(r)&&objectEach(r,function(u,c){u===null?(l=s+c,i.colToPropCache.push(l),i.propToColCache.set(l,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(c,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&isDefined(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(isDefined(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?duckSchema(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,s=i.mode,l=s===void 0?"above":s,u=this.instance.countSourceRows(),c=u,f=0,d=r;(typeof d!="number"||d>=u)&&(d=u),d<this.instance.countRows()&&(c=this.instance.toPhysicalRow(d));var h=this.instance.runHooks("beforeCreateRow",d,o,a);if(h===!1||c===null)return{delta:0};for(var y=this.tableMeta.maxRows,p=this.getSchema().length,v=[],b=function(){var P=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?P=deepClone(n.getSchema()):(P=[],rangeEach(p-1,function(){return P.push(null)})):n.instance.dataType==="function"?P=n.tableMeta.dataSchema(d+f):(P={},deepExtend(P,n.getSchema())),v.push(P),f+=1};f<o&&u+f<y;)b();this.instance.rowIndexMapper.insertIndexes(d,f),l==="below"&&(c=Math.min(c+1,u)),this.spliceData(c,0,v);var S=this.instance.toVisualRow(c);return this.instance.countSourceRows()===v.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),f>0&&(r==null?this.metaManager.createRow(null,f):a!=="auto"&&this.metaManager.createRow(c,o)),this.instance.runHooks("afterCreateRow",S,f,a),this.instance.forceFullRender=!0,{delta:f,startPhysicalIndex:c}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,s=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var l=this.dataSource,u=this.tableMeta.maxCols,c=this.instance.countSourceCols(),f=r;(typeof f!="number"||f>=c)&&(f=c);var d=this.instance.runHooks("beforeCreateCol",f,n,i);if(d===!1)return{delta:0};var h=c;f<this.instance.countCols()&&(h=this.instance.toPhysicalColumn(f));var y=this.instance.countSourceRows(),p=this.instance.countCols(),v=0,b=h;s==="end"&&(b=Math.min(b+1,c));for(var S=b;v<n&&p<u;){if(typeof f!="number"||f>=p)if(y>0)for(var w=0;w<y;w+=1)typeof l[w]>"u"&&(l[w]=[]),l[w].push(null);else l.push([null]);else for(var P=0;P<y;P++)l[P].splice(b,0,null);v+=1,b+=1,p+=1}this.instance.columnIndexMapper.insertIndexes(f,v),v>0&&(r==null?this.metaManager.createColumn(null,v):i!=="auto"&&this.metaManager.createColumn(S,n));var E=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",E,v,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:v,startPhysicalIndex:S}}},{key:"removeRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-o,s=this.visualRowsToPhysical(a,o),l=this.instance.countSourceRows();a=(l+a)%l;var u=this.instance.runHooks("beforeRemoveRow",a,s.length,s,i);if(u===!1)return!1;var c=s.length;if(this.filterData(a,c,s),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);var f=isDefined(this.tableMeta.columns)||isDefined(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&f===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var d=s.slice(0).sort(function(h,y){return y-h});return d.forEach(function(h){n.metaManager.removeRow(h,1)}),this.instance.runHooks("afterRemoveRow",a,c,s,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),s=a.slice(0).sort(function(S,w){return w-S}),l=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(l===!1)return!1;for(var u=!0,c=s.length,f=this.dataSource,d=0;d<c;d++)u&&a[0]!==a[d]-d&&(u=!1);if(u)for(var h=0,y=this.instance.countSourceRows();h<y;h++)f[h].splice(a[0],n),h===0&&this.metaManager.removeColumn(a[0],n);else for(var p=0,v=this.instance.countSourceRows();p<v;p++)for(var b=0;b<c;b++)f[p].splice(s[b],1),p===0&&this.metaManager.removeColumn(s[b],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),s=i.slice(n+o),l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];extendArray(u,s);for(var f=0;f<o;)u.push(null),f+=1;return to2dArray(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),s=i.slice(n+o),l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];extendArray(u,s);for(var f=0;f<o;)u.push(null),f+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var s=[].concat(_toConsumableArray$m(this.dataSource.slice(0,r)),_toConsumableArray$m(o),_toConsumableArray$m(this.dataSource.slice(r)));this.dataSource.length=0,s.forEach(function(l){return i.dataSource.push(l)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,s){return o.indexOf(s)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var s=null;if(i&&i.hasOwnProperty&&hasOwnProperty$1(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var l=n.split("."),u=i;if(!u)return null;for(var c=0,f=l.length;c<f;c++)if(u=u[l[c]],typeof u>"u")return null;s=u}else typeof n=="function"&&(s=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var d=createObjectPropListener(s);this.instance.runHooks("modifyData",o,this.propToCol(n),d,"get"),d.isTouched()&&(s=d.value)}return s}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,s=this.dataSource[i],l=this.instance.runHooks("modifyRowData",i);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){var u=createObjectPropListener(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(s&&s.hasOwnProperty&&hasOwnProperty$1(s,n))s[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var c=n.split("."),f=s,d=0,h;for(d=0,h=c.length-1;d<h;d++)typeof f[c[d]]>"u"&&(f[c[d]]={}),f=f[c[d]];f[c[d]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):s[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,s=n,l;a<o&&s;)l=this.instance.toPhysicalRow(a),i.push(l),s-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,s=n;a<o&&s;){var l=this.instance.toPhysicalColumn(a);i.push(l),s-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,s,l,u=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(u===0||c===0)return[];var f=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),h=Math.min(Math.max(c-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=d;a++){l=[];var y=a>=0?this.instance.toPhysicalRow(a):a;for(s=Math.min(r.col,n.col);s<=h&&y!==null;s++)l.push(f.call(this,a,this.colToProp(s)));y!==null&&i.push(l)}return i}},{key:"getText",value:function(r,n){return stringify(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return stringify(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const DataMap$1=DataMap;var _staticRegister$1=staticRegister("cellTypes"),register=_staticRegister$1.register,getItem=_staticRegister$1.getItem,hasItem=_staticRegister$1.hasItem,getNames=_staticRegister$1.getNames;_staticRegister$1.getValues;function _getItem(e){if(!hasItem(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return getItem(e)}function _register(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&_register$3(e,n),o&&_register$2(e,o),i&&_register$1(e,i),register(e,t)}function canBeOverwritten(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!hasOwnProperty$1(t,e)}function extendByMetaType(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?_getItem(t.type):t.type;if(e._automaticallyAssignedMetaProps&&objectEach(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!isObject$6(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};objectEach(n,function(i,a){if(canBeOverwritten(a,r)){var s;o[a]=i,(s=e._automaticallyAssignedMetaProps)===null||s===void 0||s.add(a)}}),extend$1(e,o)}}function columnFactory(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}inherit(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function isUnsignedNumber(e){return Number.isInteger(e)&&e>=0}function assert(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function isNullish(e){return e==null}function _typeof$1P(e){return _typeof$1P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1P(e)}const metaSchemaFactory=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),isEmpty(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),isEmpty(o)===!1)return _typeof$1P(o)==="object"?(i=this.getCellMeta(t,r),isObjectEqual(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function _typeof$1O(e){return _typeof$1O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1O(e)}function ownKeys$9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$9(Object(r),!0).forEach(function(n){_defineProperty$k(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$k(e,t,r){return t=_toPropertyKey$1L(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _defineProperties$1H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1L(n.key),n)}}function _createClass$1H(e,t,r){return t&&_defineProperties$1H(e.prototype,t),r&&_defineProperties$1H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1L(e){var t=_toPrimitive$1L(e,"string");return _typeof$1O(t)==="symbol"?t:String(t)}function _toPrimitive$1L(e,t){if(_typeof$1O(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1O(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classCallCheck$1H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function createTableMetaEmptyClass(){return _createClass$1H(function e(){_classCallCheck$1H(this,e)})}var GlobalMeta=function(){function e(t){_classCallCheck$1H(this,e),this.metaCtor=createTableMetaEmptyClass(),this.meta=this.metaCtor.prototype,extend$1(this.meta,metaSchemaFactory()),this.meta.instance=t}return _createClass$1H(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;extend$1(this.meta,r),extendByMetaType(this.meta,_objectSpread$9(_objectSpread$9({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function _typeof$1N(e){return _typeof$1N=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1N(e)}function _classCallCheck$1G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1K(n.key),n)}}function _createClass$1G(e,t,r){return t&&_defineProperties$1G(e.prototype,t),r&&_defineProperties$1G(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1K(e){var t=_toPrimitive$1K(e,"string");return _typeof$1N(t)==="symbol"?t:String(t)}function _toPrimitive$1K(e,t){if(_typeof$1N(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1N(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TableMeta=function(){function e(t){_classCallCheck$1G(this,e);var r=t.getMetaConstructor();this.meta=new r}return _createClass$1G(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){extend$1(this.meta,r),extendByMetaType(this.meta,r,r)}}]),e}();function _typeof$1M(e){return _typeof$1M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1M(e)}function _toConsumableArray$l(e){return _arrayWithoutHoles$l(e)||_iterableToArray$n(e)||_unsupportedIterableToArray$U(e)||_nonIterableSpread$l()}function _nonIterableSpread$l(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$U(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$U(e,t)}}function _iterableToArray$n(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$l(e){if(Array.isArray(e))return _arrayLikeToArray$U(e)}function _arrayLikeToArray$U(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$1F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1J(n.key),n)}}function _createClass$1F(e,t,r){return t&&_defineProperties$1F(e.prototype,t),r&&_defineProperties$1F(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1J(e){var t=_toPrimitive$1J(e,"string");return _typeof$1M(t)==="symbol"?t:String(t)}function _toPrimitive$1J(e,t){if(_typeof$1M(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1M(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LazyFactoryMap=function(e){function t(r){_classCallCheck$1F(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return _createClass$1F(t,[{key:"obtain",value:function(n){assert(function(){return isUnsignedNumber(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(function(){return isUnsignedNumber(n)||isNullish(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,s=0;s<o;s++)i.push(a+s),this.data.push(void 0);var l=isNullish(n)?this.index.length:n;this.index=[].concat(_toConsumableArray$l(this.index.slice(0,l)),i,_toConsumableArray$l(this.index.slice(l)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(function(){return isUnsignedNumber(n)||isNullish(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(isNullish(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var s=i[a];typeof s=="number"&&this.holes.add(s)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return arrayFilter(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var l=n[a];return a+=1,{value:l,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function _typeof$1L(e){return _typeof$1L=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1L(e)}function _classCallCheck$1E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1I(n.key),n)}}function _createClass$1E(e,t,r){return t&&_defineProperties$1E(e.prototype,t),r&&_defineProperties$1E(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1I(e){var t=_toPrimitive$1I(e,"string");return _typeof$1L(t)==="symbol"?t:String(t)}function _toPrimitive$1I(e,t){if(_typeof$1L(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1L(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var COLUMNS_PROPS_CONFLICTS=["data","width"],ColumnMeta=function(){function e(t){var r=this;_classCallCheck$1E(this,e),this.globalMeta=t,this.metas=new LazyFactoryMap(function(){return r._createMeta()})}return _createClass$1E(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);extend$1(o,n),extendByMetaType(o,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return columnFactory(this.globalMeta.getMetaConstructor(),COLUMNS_PROPS_CONFLICTS).prototype}}]),e}();function _typeof$1K(e){return _typeof$1K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1K(e)}function _toConsumableArray$k(e){return _arrayWithoutHoles$k(e)||_iterableToArray$m(e)||_unsupportedIterableToArray$T(e)||_nonIterableSpread$k()}function _nonIterableSpread$k(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$T(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$T(e,t)}}function _iterableToArray$m(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$k(e){if(Array.isArray(e))return _arrayLikeToArray$T(e)}function _arrayLikeToArray$T(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$1D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1H(n.key),n)}}function _createClass$1D(e,t,r){return t&&_defineProperties$1D(e.prototype,t),r&&_defineProperties$1D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1H(e){var t=_toPrimitive$1H(e,"string");return _typeof$1K(t)==="symbol"?t:String(t)}function _toPrimitive$1H(e,t){if(_typeof$1K(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1K(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CellMeta=function(){function e(t){var r=this;_classCallCheck$1D(this,e),this.columnMeta=t,this.metas=new LazyFactoryMap(function(){return r._createRow()})}return _createClass$1D(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);extend$1(i,o),extendByMetaType(i,o)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a,s=this.metas.obtain(r).obtain(n);(a=s._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(o),s[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,_toConsumableArray$k(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){assert(function(){return isUnsignedNumber(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new LazyFactoryMap(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function _typeof$1J(e){return _typeof$1J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1J(e)}function _classCallCheck$1C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1G(n.key),n)}}function _createClass$1C(e,t,r){return t&&_defineProperties$1C(e.prototype,t),r&&_defineProperties$1C(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1G(e){var t=_toPrimitive$1G(e,"string");return _typeof$1J(t)==="symbol"?t:String(t)}function _toPrimitive$1G(e,t){if(_typeof$1J(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1J(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MetaManager=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];_classCallCheck$1C(this,e),this.hot=t,this.globalMeta=new GlobalMeta(t),this.tableMeta=new TableMeta(this.globalMeta),this.columnMeta=new ColumnMeta(this.globalMeta),this.cellMeta=new CellMeta(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return _createClass$1C(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,s=this.cellMeta.getMeta(r,n);return s.visualRow=i,s.visualCol=a,s.row=r,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();mixin(MetaManager,localHooks$1);function _typeof$1I(e){return _typeof$1I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1I(e)}function replaceData(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,s=n.internalSource,l=n.source,u=n.metaManager,c=n.firstRun,f=toUpperCaseFirst(s),d=o.getSettings();Array.isArray(d.dataSchema)?o.dataType="array":isFunction(d.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(f),e,c,l);var h=new DataMap$1(o,e,u);if(t(h),_typeof$1I(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var y=h.getSchema();e=[];var p,v=0,b=0;for(v=0,b=d.startRows;v<b;v++)if((o.dataType==="object"||o.dataType==="function")&&d.dataSchema)p=deepClone(y),e.push(p);else if(o.dataType==="array")p=deepClone(y[0]),e.push(p);else{p=[];for(var S=0,w=d.startCols;S<w;S++)p.push(null);e.push(p)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(_typeof$1I(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),d.data=e,h.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=h.colToProp.bind(h),a.propToCol=h.propToCol.bind(h),a.countCachedColumns=h.countCachedColumns.bind(h),r(h),o.runHooks("after".concat(f),e,c,l),c||(o.runHooks("afterChange",null,s),o.render())}function _typeof$1H(e){return _typeof$1H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1H(e)}function _classCallCheck$1B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1F(n.key),n)}}function _createClass$1B(e,t,r){return t&&_defineProperties$1B(e.prototype,t),r&&_defineProperties$1B(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1F(e){var t=_toPrimitive$1F(e,"string");return _typeof$1H(t)==="symbol"?t:String(t)}function _toPrimitive$1F(e,t){if(_typeof$1H(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1H(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DynamicCellMetaMod=function(){function e(t){var r=this;_classCallCheck$1B(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),Hooks$1.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return _createClass$1B(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,s=r.visualCol,l=this.metaManager.hot,u=l.colToProp(s);r.prop=u,l.runHooks("beforeGetCellMeta",a,s,r);var c=hasOwnProperty$1(r,"type")?r.type:null,f=isFunction(r.cells)?r.cells(o,i,u):null;if(c)if(f){var d;f.type=(d=f.type)!==null&&d!==void 0?d:c}else f={type:c};f&&this.metaManager.updateCellMeta(o,i,f),l.runHooks("afterGetCellMeta",a,s,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function _typeof$1G(e){return _typeof$1G=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1G(e)}function _classCallCheck$1A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1E(n.key),n)}}function _createClass$1A(e,t,r){return t&&_defineProperties$1A(e.prototype,t),r&&_defineProperties$1A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1E(e){var t=_toPrimitive$1E(e,"string");return _typeof$1G(t)==="symbol"?t:String(t)}function _toPrimitive$1E(e,t){if(_typeof$1G(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1G(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ExtendMetaPropertiesMod=function(){function e(t){_classCallCheck$1A(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return _createClass$1A(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,s=a===void 0?function(){}:a,l=typeof i=="string",u=l?i:o,c="_".concat(u);r.metaManager.globalMeta.meta[c]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,c,s),l&&r.installPropWatcher(i,c,s)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(s){var l=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,s,l),this[n]=s},enumerable:!0,configurable:!0})}}]),e}(),mappings=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),normalizeKeys=function(t){return t.map(function(r){var n=r.toLowerCase();return mappings.has(n)?mappings.get(n):n}).sort().join("+")},getKeysList=function(t){return t.split("+")},normalizeEventKey=function(t){return t.toLowerCase()},_templateObject$c;function _toConsumableArray$j(e){return _arrayWithoutHoles$j(e)||_iterableToArray$l(e)||_unsupportedIterableToArray$S(e)||_nonIterableSpread$j()}function _nonIterableSpread$j(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$l(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$j(e){if(Array.isArray(e))return _arrayLikeToArray$S(e)}function _slicedToArray$C(e,t){return _arrayWithHoles$E(e)||_iterableToArrayLimit$C(e,t)||_unsupportedIterableToArray$S(e,t)||_nonIterableRest$E()}function _nonIterableRest$E(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$S(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$S(e,t)}}function _arrayLikeToArray$S(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$C(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$E(e){if(Array.isArray(e))return e}function _taggedTemplateLiteral$c(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var createContext=function(t){var r=createUniqueMap({errorIdExists:function(c){return'The "'.concat(c,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=c.keys,d=c.callback,h=c.group,y=c.runOnlyIf,p=y===void 0?function(){return!0}:y,v=c.captureCtrl,b=v===void 0?!1:v,S=c.preventDefault,w=S===void 0?!0:S,P=c.stopPropagation,E=P===void 0?!1:P,j=c.relativeToGroup,G=c.position;if(isUndefined(h))throw new Error("You need to define the shortcut's group.");if(isFunction(d)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(f)===!1)throw new Error(toSingleLine(_templateObject$c||(_templateObject$c=_taggedTemplateLiteral$c([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var q={callback:d,group:h,runOnlyIf:p,captureCtrl:b,preventDefault:w,stopPropagation:E};if(isDefined(j)){var z=[j,G];q.relativeToGroup=z[0],q.position=z[1]}f.forEach(function(U){var Z=normalizeKeys(U),te=r.hasItem(Z);if(te){var Q=r.getItem(Z),ie=Q.findIndex(function(he){return he.group===j});ie!==-1?G==="before"?ie-=1:ie+=1:ie=Q.length,Q.splice(ie,0,q)}else r.addItem(Z,[q])})},o=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.forEach(function(d){objectEach(f,function(h,y){Object.prototype.hasOwnProperty.call(d,y)===!1&&(d[y]=f[y])}),n(d)})},i=function(c){var f=normalizeKeys(c);r.removeItem(f)},a=function(c){var f=r.getItems();f.forEach(function(d){var h=_slicedToArray$C(d,2),y=h[0],p=h[1],v=p.filter(function(b){return b.group!==c});v.length===0?i(getKeysList(y)):(p.length=0,p.push.apply(p,_toConsumableArray$j(v)))})},s=function(c){var f=normalizeKeys(c),d=r.getItem(f);return isDefined(d)?d.slice():[]},l=function(c){var f=normalizeKeys(c);return r.hasItem(f)};return{addShortcut:n,addShortcuts:o,getShortcuts:s,hasShortcut:l,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function createKeysObserver(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var MODIFIER_KEYS=["meta","alt","shift","control"],modifierKeysObserver=createKeysObserver();function useRecorder(e,t,r,n,o){var i=function(h){return MODIFIER_KEYS.includes(h)},a=function(h){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,p=[];return h.altKey&&p.push("alt"),y&&(h.ctrlKey||h.metaKey)?p.push("control/meta"):(h.ctrlKey&&p.push("control"),h.metaKey&&p.push("meta")),h.shiftKey&&p.push("shift"),p},s=function(h){if(t(h)!==!1){var y=r(h);if(!(h.keyCode===229||y===!1||isImmediatePropagationStopped(h))){var p=normalizeEventKey(h.key),v=[];i(p)?modifierKeysObserver.press(p):v=a(h);var b=[p].concat(v),S=o(h,b);!S&&(isMacOS()&&v.includes("meta")||!isMacOS()&&v.includes("control"))&&o(h,[p].concat(a(h,!0))),n(h)}}},l=function(h){if(t(h)!==!1){var y=normalizeEventKey(h.key);i(y)!==!1&&modifierKeysObserver.release(y)}},u=function(){modifierKeysObserver.releaseAll()},c=function(){for(var h=e;h;)h.document.documentElement.addEventListener("keydown",s),h.document.documentElement.addEventListener("keyup",l),h.document.documentElement.addEventListener("blur",u),h=getParentWindow(h)},f=function(){for(var h=e;h;)h.document.documentElement.removeEventListener("keydown",s),h.document.documentElement.removeEventListener("keyup",l),h.document.documentElement.removeEventListener("blur",u),h=getParentWindow(h)};return{mount:c,unmount:f,isPressed:function(h){return modifierKeysObserver.isPressed(h)},releasePressedKeys:function(){return modifierKeysObserver.releaseAll()}}}var createShortcutManager=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=createUniqueMap({errorIdExists:function(p){return'The "'.concat(p,'" context name is already registered.')}}),s="grid",l=function(p){var v=createContext(p);return a.addItem(p,v),v},u=function(){return s},c=function(p){return a.getItem(p)},f=function(p){s=p},d=!1,h=useRecorder(r,n,o,i,function(y,p){var v=c(u()),b=!1;if(!v.hasShortcut(p))return b;for(var S=v.getShortcuts(p),w=0;w<S.length;w++){var P=S[w],E=P.callback,j=P.runOnlyIf,G=P.preventDefault,q=P.stopPropagation,z=P.captureCtrl;if(j(y)!==!1&&(d=z,b=E(y,p)===!1,d=!1,G&&y.preventDefault(),q&&y.stopPropagation(),b))break}return b});return h.mount(),{addContext:l,getActiveContextName:u,getContext:c,setActiveContextName:f,isCtrlPressed:function(){return!d&&(h.isPressed("control")||h.isPressed("meta"))},releasePressedKeys:function(){return h.releasePressedKeys()},destroy:function(){return h.unmount()}}},_templateObject$b,_templateObject2$3;function _typeof$1F(e){return _typeof$1F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1F(e)}function _taggedTemplateLiteral$b(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _slicedToArray$B(e,t){return _arrayWithHoles$D(e)||_iterableToArrayLimit$B(e,t)||_unsupportedIterableToArray$R(e,t)||_nonIterableRest$D()}function _nonIterableRest$D(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit$B(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$D(e){if(Array.isArray(e))return e}function _toConsumableArray$i(e){return _arrayWithoutHoles$i(e)||_iterableToArray$k(e)||_unsupportedIterableToArray$R(e)||_nonIterableSpread$i()}function _nonIterableSpread$i(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$R(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$R(e,t)}}function _iterableToArray$k(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$i(e){if(Array.isArray(e))return _arrayLikeToArray$R(e)}function _arrayLikeToArray$R(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var SHORTCUTS_GROUP$8="gridDefault",activeGuid=null,deprecationWarns=new Set;function Core(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,s=new EventManager$1(a),l,u,c,f,d=!0;hasValidParameter(o)&&registerAsRootInstance(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var h=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",y=["rtl","ltr"].includes(h)?h:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=getValidLanguageCode(t.language);var p=new MetaManager(a,t,[DynamicCellMetaMod,ExtendMetaPropertiesMod]),v=p.getTableMeta(),b=p.getGlobalMeta(),S=createUniqueMap();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),isRootInstance(this)&&_injectProductInfo(t.licenseKey,e),this.guid="ht_".concat(randomString()),this.columnIndexMapper=new IndexMapper,this.rowIndexMapper=new IndexMapper,u=new DataSource$1(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var w=function(m){var _=m.row,C=m.col;return a._createCellCoords(_>=0?a.rowIndexMapper.getRenderableFromVisualIndex(_):_,C>=0?a.columnIndexMapper.getRenderableFromVisualIndex(C):C)},P=function(m){var _=m.row,C=m.col;return a._createCellCoords(_>=0?a.rowIndexMapper.getVisualFromRenderableIndex(_):_,C>=0?a.columnIndexMapper.getVisualFromRenderableIndex(C):C)},E=new Selection$1(v,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(m){return l.propToCol(m)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(m,_){return a._createCellCoords(m,_)},createCellRange:function(m,_,C){return a._createCellRange(m,_,C)},visualToRenderableCoords:w,renderableToVisualCoords:P,isDisabledCellSelection:function(m,_){return a.getCellMeta(m,_).disableVisualSelection}});this.selection=E;var j=function(m){var _=m.hiddenIndexesChanged;_&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",j),this.rowIndexMapper.addLocalHook("cacheUpdated",j),this.selection.addLocalHook("beforeSetRangeStart",function(g){n.runHooks("beforeSetRangeStart",g)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(g){n.runHooks("beforeSetRangeStartOnly",g)}),this.selection.addLocalHook("beforeSetRangeEnd",function(g){n.runHooks("beforeSetRangeEnd",g),g.row<0&&(g.row=n.view._wt.wtTable.getFirstVisibleRow()),g.col<0&&(g.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(g){var m=createObjectPropListener(!1),_=n.selection.getSelectedRange(),C=_.current(),R=C.from,A=C.to,B=_.size()-1;n.runHooks("afterSelection",R.row,R.col,A.row,A.col,m,B),n.runHooks("afterSelectionByProp",R.row,a.colToProp(R.col),A.row,a.colToProp(A.col),m,B);var V=n.selection.isSelectedByAnyHeader(),K=n.selection.selectedRange.current(),J=!0;i&&(J=!1),m.isTouched()&&(J=!m.value);var ee=n.selection.isSelectedByRowHeader(),oe=n.selection.isSelectedByColumnHeader();J!==!1&&(V?ee?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(g.row)):oe&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(g.col)):K&&!n.selection.isMultiple()?n.view.scrollViewport(w(K.from)):n.view.scrollViewport(w(g))),ee&&oe?addClass(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ee?(removeClass(n.rootElement,"ht__selection--columns"),addClass(n.rootElement,"ht__selection--rows")):oe?(removeClass(n.rootElement,"ht__selection--rows"),addClass(n.rootElement,"ht__selection--columns")):removeClass(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(g){var m=g.length-1,_=g[m],C=_.from,R=_.to;n.runHooks("afterSelectionEnd",C.row,C.col,R.row,R.col,m),n.runHooks("afterSelectionEndByProp",C.row,a.colToProp(C.col),R.row,a.colToProp(R.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",function(g){var m=n.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=m)}),this.selection.addLocalHook("beforeModifyTransformStart",function(g){n.runHooks("modifyTransformStart",g)}),this.selection.addLocalHook("afterModifyTransformStart",function(g,m,_){n.runHooks("afterModifyTransformStart",g,m,_)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(g){n.runHooks("modifyTransformEnd",g)}),this.selection.addLocalHook("afterModifyTransformEnd",function(g,m,_){n.runHooks("afterModifyTransformEnd",g,m,_)}),this.selection.addLocalHook("afterDeselect",function(){f.destroyEditor(),n._refreshBorders(),removeClass(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(g){n.alter("insert_row_above",g,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(g){n.alter("insert_col_start",g,1,"auto")}),c={alter:function(m,_){var C,R,A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,B=arguments.length>3?arguments[3]:void 0,V=arguments.length>4?arguments[4]:void 0,K=function($e){if($e.length===0)return[];var Se=_toConsumableArray$i($e);Se.sort(function(Ie,Pe){var Ce=_slicedToArray$B(Ie,1),Ee=Ce[0],De=_slicedToArray$B(Pe,1),Ne=De[0];return Ee===Ne?0:Ee>Ne?1:-1});var Te=arrayReduce$1(Se,function(Ie,Pe){var Ce=_slicedToArray$B(Pe,2),Ee=Ce[0],De=Ce[1],Ne=Ie[Ie.length-1],ke=_slicedToArray$B(Ne,2),Re=ke[0],We=ke[1],Ue=Re+We;if(Ee<=Ue){var Ve=Math.max(De-(Ue-Ee),0);Ne[1]+=Ve}else Ie.push([Ee,De]);return Ie},[Se[0]]);return Te};switch(m){case"insert_row":deprecationWarns.has(m)||(deprecationWarns.add(m),warn(toSingleLine(_templateObject$b||(_templateObject$b=_taggedTemplateLiteral$b(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),m)));case"insert_row_below":case"insert_row_above":var J=a.countSourceRows();if(v.maxRows===J)return;var ee=m==="insert_row_below"?"below":"above";_=(C=_)!==null&&C!==void 0?C:m==="insert_row"||ee==="below"?J:0;var oe=l.createRow(_,A,{source:B,mode:ee}),ye=oe.delta,ae=oe.startPhysicalIndex;if(ye){var se=E.selectedRange.current(),X=se==null?void 0:se.from,_e=X==null?void 0:X.row,we=a.toVisualRow(ae);if(E.isSelectedByCorner())a.selectAll();else if(isDefined(_e)&&_e>=we){var ge=se.to,me=ge.row,ve=ge.col,O=X.col;E.isSelectedByRowHeader()&&(O=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(a._createCellCoords(_e+ye,O),!0),E.setRangeEnd(a._createCellCoords(me+ye,ve))}else a._refreshBorders()}break;case"insert_col":deprecationWarns.has(m)||(deprecationWarns.add(m),warn(toSingleLine(_templateObject2$3||(_templateObject2$3=_taggedTemplateLiteral$b(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),m)));case"insert_col_start":case"insert_col_end":var T=m==="insert_col_end"?"end":"start";_=(R=_)!==null&&R!==void 0?R:m==="insert_col"||T==="end"?a.countSourceCols():0;var k=l.createCol(_,A,{source:B,mode:T}),L=k.delta,M=k.startPhysicalIndex;if(L){if(Array.isArray(v.colHeaders)){var F=[a.toVisualColumn(M),0];F.length+=L,Array.prototype.splice.apply(v.colHeaders,F)}var N=E.selectedRange.current(),D=N==null?void 0:N.from,W=D==null?void 0:D.col,H=a.toVisualColumn(M);if(E.isSelectedByCorner())a.selectAll();else if(isDefined(W)&&W>=H){var Y=N.to,ne=Y.row,ue=Y.col,de=D.row;E.isSelectedByColumnHeader()&&(de=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(a._createCellCoords(de,W+L),!0),E.setRangeEnd(a._createCellCoords(ne,ue+L))}else a._refreshBorders()}break;case"remove_row":var be=function($e){var Se=0;arrayEach($e,function(Te){var Ie=_slicedToArray$B(Te,2),Pe=Ie[0],Ce=Ie[1],Ee=isEmpty(Pe)?a.countRows()-1:Math.max(Pe-Se,0);Number.isInteger(Pe)&&(Pe=Math.max(Pe-Se,0));var De=l.removeRow(Pe,Ce,B);if(De){var Ne=a.countRows(),ke=v.fixedRowsTop;ke>=Ee+1&&(v.fixedRowsTop-=Math.min(Ce,ke-Ee));var Re=v.fixedRowsBottom;Re&&Ee>=Ne-Re&&(v.fixedRowsBottom-=Math.min(Ce,Re)),Se+=Ce}})};Array.isArray(_)?be(K(_)):be([[_,A]]),c.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var Oe=function($e){var Se=0;arrayEach($e,function(Te){var Ie=_slicedToArray$B(Te,2),Pe=Ie[0],Ce=Ie[1],Ee=isEmpty(Pe)?a.countCols()-1:Math.max(Pe-Se,0),De=a.toPhysicalColumn(Ee);Number.isInteger(Pe)&&(Pe=Math.max(Pe-Se,0));var Ne=l.removeCol(Pe,Ce,B);if(Ne){var ke=v.fixedColumnsStart;ke>=Ee+1&&(v.fixedColumnsStart-=Math.min(Ce,ke-Ee)),Array.isArray(v.colHeaders)&&(typeof De>"u"&&(De=-1),v.colHeaders.splice(De,Ce)),Se+=Ce}})};Array.isArray(_)?Oe(K(_)):Oe([[_,A]]),c.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(m,'"'))}V||c.adjustRowsAndCols()},adjustRowsAndCols:function(){var m=v.minRows,_=v.minSpareRows,C=v.minCols,R=v.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&E.deselect(),m){var A=a.countRows();A<m&&l.createRow(A,m-A,{source:"auto"})}if(_){var B=a.countEmptyRows(!0);if(B<_){var V=_-B,K=Math.min(V,v.maxRows-a.countSourceRows());l.createRow(a.countRows(),K,{source:"auto"})}}{var J;(C||R)&&(J=a.countEmptyCols(!0));var ee=a.countCols();if(C&&!v.columns&&ee<C){var oe=C-ee;J+=oe,l.createCol(ee,oe,{source:"auto"})}if(R&&!v.columns&&a.dataType==="array"&&J<R){ee=a.countCols();var ye=R-J,ae=Math.min(ye,v.maxCols-ee);l.createCol(ee,ae,{source:"auto"})}}if(E.isSelected()){var se=a.countRows(),X=a.countCols();arrayEach(E.selectedRange,function(_e){var we=!1,ge=_e.from.row,me=_e.from.col,ve=_e.to.row,O=_e.to.col;ge>se-1?(ge=se-1,we=!0,ve>ge&&(ve=ge)):ve>se-1&&(ve=se-1,we=!0,ge>ve&&(ge=ve)),me>X-1?(me=X-1,we=!0,O>me&&(O=me)):O>X-1&&(O=X-1,we=!0,me>O&&(me=O)),we&&a.selectCell(ge,me,ve,O)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(m,_,C,R,A,B,V){var K,J,ee,oe,ye=[],ae={},se=[],X=m.row,_e=m.col;if(J=_.length,J===0)return!1;var we=0,ge=0;switch(isObject$6(C)&&(we=C.col-_e+1,ge=C.row-X+1),A){case"shift_down":var me=pivot(_),ve=me.length,O=Math.max(ve,we),T=a.getData().slice(X),k=pivot(T).slice(_e,_e+O);for(ee=0;ee<O;ee+=1)if(ee<ve){for(K=0,J=me[ee].length;K<ge-J;K+=1)me[ee].push(me[ee][K%J]);ee<k.length?se.push(me[ee].concat(k[ee])):se.push(me[ee].concat(new Array(T.length).fill(null)))}else se.push(me[ee%ve].concat(k[ee]));a.populateFromArray(X,_e,pivot(se));break;case"shift_right":var L=_.length,M=Math.max(L,ge),F=a.getData().slice(X).map(function(ke){return ke.slice(_e)});for(K=0;K<M;K+=1)if(K<L){for(ee=0,oe=_[K].length;ee<we-oe;ee+=1)_[K].push(_[K][ee%oe]);if(K<F.length)for(var N=0;N<F[K].length;N+=1)_[K].push(F[K][N]);else{var D;(D=_[K]).push.apply(D,_toConsumableArray$i(new Array(F[0].length).fill(null)))}}else _.push(_[K%J].slice(0,M).concat(F[K]));a.populateFromArray(X,_e,_);break;case"overwrite":default:ae.row=m.row,ae.col=m.col;var W={row:C&&m?C.row-m.row+1:1,col:C&&m?C.col-m.col+1:1},H=0,Y=0,ne=!0,ue,de=function(Re){var We=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Ue=_[Re%_.length];return We!==null?Ue[We%Ue.length]:Ue},be=_.length,Oe=C?C.row-m.row+1:0;for(C?J=Oe:J=Math.max(be,Oe),K=0;K<J&&!(C&&ae.row>C.row&&Oe>be||!v.allowInsertRow&&ae.row>a.countRows()-1||ae.row>=v.maxRows);K++){var Me=K-H,$e=de(Me).length,Se=C?C.col-m.col+1:0;if(C?oe=Se:oe=Math.max($e,Se),ae.col=m.col,ue=a.getCellMeta(ae.row,ae.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&ue.skipRowOnPaste){H+=1,ae.row+=1,J+=1;continue}for(Y=0,ee=0;ee<oe&&!(C&&ae.col>C.col&&Se>$e||!v.allowInsertColumn&&ae.col>a.countCols()-1||ae.col>=v.maxCols);ee++){if(ue=a.getCellMeta(ae.row,ae.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&ue.skipColumnOnPaste){Y+=1,ae.col+=1,oe+=1;continue}if(ue.readOnly&&R!=="UndoRedo.undo"){ae.col+=1;continue}var Te=ee-Y,Ie=de(Me,Te),Pe=a.getDataAtCell(ae.row,ae.col),Ce={row:Me,col:Te};if(R==="Autofill.fill"){var Ee=a.runHooks("beforeAutofillInsidePopulate",Ce,B,_,V,{},W);Ee&&(Ie=isUndefined(Ee.value)?Ie:Ee.value)}if(Ie!==null&&_typeof$1F(Ie)==="object")if(Array.isArray(Ie)&&Pe===null&&(Pe=[]),Pe===null||_typeof$1F(Pe)!=="object")ne=!1;else{var De=duckSchema(Array.isArray(Pe)?Pe:Pe[0]||Pe),Ne=duckSchema(Array.isArray(Ie)?Ie:Ie[0]||Ie);isObjectEqual(De,Ne)||Array.isArray(De)&&Array.isArray(Ne)?Ie=deepClone(Ie):ne=!1}else Pe!==null&&_typeof$1F(Pe)==="object"&&(ne=!1);ne&&ye.push([ae.row,ae.col,Ie]),ne=!0,ae.col+=1}ae.row+=1}a.setDataAtCell(ye,null,null,R||"populateFromArray");break}}};function G(g){var m=normalizeLanguageCode(g);hasLanguageDictionary(m)?(a.runHooks("beforeLanguageChange",m),b.language=m,a.runHooks("afterLanguageChange",m)):warnUserAboutLanguageRegistration(g)}function q(g,m){var _=g==="className"?a.rootElement:a.table;if(d)addClass(_,m);else{var C=[],R=[];b[g]&&(C=Array.isArray(b[g])?b[g]:stringToArray(b[g])),m&&(R=Array.isArray(m)?m:stringToArray(m));var A=getDifferenceOfArrays(C,R),B=getDifferenceOfArrays(R,C);A.length&&removeClass(_,A),B.length&&addClass(_,B)}b[g]=m}this.init=function(){u.setData(v.data),a.runHooks("beforeInit"),(isMobileBrowser()||isIpadOS())&&addClass(a.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new TableView$1(this),f=EditorManager$1.getInstance(a,v,E),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),d&&a.rootElement.offsetParent===null&&observeVisibilityChangeOnce(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),_typeof$1F(d)==="object"&&(a.runHooks("afterChange",d[0],d[1]),d=!1),a.runHooks("afterInit")};function z(){var g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function U(g){var m=g.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):g}function Z(g,m,_){if(g.length){var C=a.getActiveEditor(),R=a.runHooks("beforeChange",g,m||"edit"),A=!0;if(R===!1){C&&C.cancelChanges();return}var B=new z;B.onQueueEmpty=function(se){C&&A&&C.cancelChanges(),_(se)};for(var V=g.length-1;V>=0;V--)if(g[V]===null)g.splice(V,1);else{var K=_slicedToArray$B(g[V],4),J=K[0],ee=K[1],oe=K[3],ye=l.propToCol(ee),ae=a.getCellMeta(J,ye);ae.type==="numeric"&&typeof oe=="string"&&isNumericLike(oe)&&(g[V][3]=U(oe)),a.getCellValidator(ae)&&(B.addValidatorToQueue(),a.validateCell(g[V][3],ae,function(se,X){return function(_e){if(typeof _e!="boolean")throw new Error("Validation error: result is not boolean");if(_e===!1&&X.allowInvalid===!1){A=!1,g.splice(se,1),X.valid=!0;var we=a.getCell(X.visualRow,X.visualCol);we!==null&&removeClass(we,v.invalidCellClassName)}B.removeValidatorFormQueue()}}(V,ae),m))}B.checkIfQueueIsEmpty()}}function te(g,m){var _=g.length-1;if(!(_<0)){for(;_>=0;_--){var C=!1;if(g[_]===null){g.splice(_,1);continue}if(!((g[_][2]===null||g[_][2]===void 0)&&(g[_][3]===null||g[_][3]===void 0))){if(v.allowInsertRow)for(;g[_][0]>a.countRows()-1;){var R=l.createRow(void 0,void 0,{source:m}),A=R.delta;if(A===0){C=!0;break}}if(a.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;l.propToCol(g[_][1])>a.countCols()-1;){var B=l.createCol(void 0,void 0,{source:m}),V=B.delta;if(V===0){C=!0;break}}C||l.set(g[_][0],g[_][1],g[_][3])}}a.forceFullRender=!0,c.adjustRowsAndCols(),a.runHooks("beforeChangeRender",g,m),f.lockEditor(),a._refreshBorders(null),f.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",g,m||"edit");var K=a.getActiveEditor();K&&isDefined(K.refreshValue)&&K.refreshValue()}}this._createCellCoords=function(g,m){return a.view._wt.createCellCoords(g,m)},this._createCellRange=function(g,m,_){return a.view._wt.createCellRange(g,m,_)},this.validateCell=function(g,m,_,C){var R=a.getCellValidator(m);function A(B){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!V||m.hidden===!0){_(B);return}var K=m.visualCol,J=m.visualRow,ee=a.getCell(J,K,!0);if(ee&&ee.nodeName!=="TH"){var oe=a.rowIndexMapper.getRenderableFromVisualIndex(J),ye=a.columnIndexMapper.getRenderableFromVisualIndex(K);a.view._wt.getSetting("cellRenderer",oe,ye,ee)}_(B)}isRegExp(R)&&(R=function(B){return function(V,K){K(B.test(V))}}(R)),isFunction(R)?(g=a.runHooks("beforeValidate",g,m.visualRow,m.prop,C),a._registerImmediate(function(){R.call(m,g,function(B){a&&(B=a.runHooks("afterValidate",B,g,m.visualRow,m.prop,C),m.valid=B,A(B),a.runHooks("postAfterValidate",B,g,m.visualRow,m.prop,C))})})):a._registerImmediate(function(){m.valid=!0,A(m.valid,!1)})};function Q(g,m,_){return Array.isArray(g)?g:[[g,m,_]]}this.setDataAtCell=function(g,m,_,C){var R=Q(g,m,_),A=[],B=C,V,K,J;for(V=0,K=R.length;V<K;V++){if(_typeof$1F(R[V])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[V][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[V][1]>=this.countCols()?J=R[V][1]:J=l.colToProp(R[V][1]),A.push([R[V][0],J,u.getAtCell(this.toPhysicalRow(R[V][0]),R[V][1]),R[V][2]])}!B&&_typeof$1F(g)==="object"&&(B=m),a.runHooks("afterSetDataAtCell",A,B),Z(A,B,function(){te(A,B)})},this.setDataAtRowProp=function(g,m,_,C){var R=Q(g,m,_),A=[],B=C,V,K;for(V=0,K=R.length;V<K;V++)A.push([R[V][0],R[V][1],u.getAtCell(this.toPhysicalRow(R[V][0]),R[V][1]),R[V][2]]);!B&&_typeof$1F(g)==="object"&&(B=m),a.runHooks("afterSetDataAtRowProp",A,B),Z(A,B,function(){te(A,B)})},this.listen=function(){a&&!a.isListening()&&(activeGuid=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(activeGuid=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return activeGuid===a.guid},this.destroyEditor=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(g,m)},this.populateFromArray=function(g,m,_,C,R,A,B,V,K){if(!(_typeof$1F(_)==="object"&&_typeof$1F(_[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var J=typeof C=="number"?a._createCellCoords(C,R):null;return c.populateFromArray(a._createCellCoords(g,m),_,J,A,B,V,K)},this.spliceCol=function(g,m,_){for(var C,R=arguments.length,A=new Array(R>3?R-3:0),B=3;B<R;B++)A[B-3]=arguments[B];return(C=l).spliceCol.apply(C,[g,m,_].concat(A))},this.spliceRow=function(g,m,_){for(var C,R=arguments.length,A=new Array(R>3?R-3:0),B=3;B<R;B++)A[B-3]=arguments[B];return(C=l).spliceRow.apply(C,[g,m,_].concat(A))},this.getSelected=function(){if(E.isSelected())return arrayMap(E.getSelectedRange(),function(g){var m=g.from,_=g.to;return[m.row,m.col,_.row,_.col]})},this.getSelectedLast=function(){var g=this.getSelected(),m;return g&&g.length>0&&(m=g[g.length-1]),m},this.getSelectedRange=function(){if(E.isSelected())return Array.from(E.getSelectedRange())},this.getSelectedRangeLast=function(){var g=this.getSelectedRange(),m;return g&&g.length>0&&(m=g[g.length-1]),m},this.emptySelectedCells=function(g){var m=this;if(!(!E.isSelected()||this.countRows()===0||this.countCols()===0)){var _=[];arrayEach(E.getSelectedRange(),function(C){var R=C.getTopStartCorner(),A=C.getBottomEndCorner();rangeEach(R.row,A.row,function(B){rangeEach(R.col,A.col,function(V){m.getCellMeta(B,V).readOnly||_.push([B,V,null])})})}),_.length>0&&this.setDataAtCell(_,g)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(f.lockEditor(),this._refreshBorders(null),f.unlockEditor()))},this.batchRender=function(g){this.suspendRender();var m=g();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var _=g();return this.resumeExecution(m),_},this.batch=function(g){this.suspendRender(),this.suspendExecution();var m=g();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(a.view){var g=a.view.getLastSize(),m=g.width,_=g.height,C=a.rootElement.getBoundingClientRect(),R=C.width,A=C.height,B=R!==m||A!==_,V=a.runHooks("beforeRefreshDimensions",{width:m,height:_},{width:R,height:A},B)===!1;V||((B||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(R,A),a.render()),a.runHooks("afterRefreshDimensions",{width:m,height:_},{width:R,height:A},B))}},this.updateData=function(g,m){var _=this;replaceData(g,function(C){l=C},function(C){l=C,a.columnIndexMapper.fitToLength(_.getInitialColumnCount()),a.rowIndexMapper.fitToLength(_.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:p,firstRun:d})},this.loadData=function(g,m){replaceData(g,function(_){l=_},function(){p.clearCellsCache(),a.initIndexMappers(),c.adjustRowsAndCols(),d&&(d=[null,"loadData"])},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:p,firstRun:d})},this.getInitialColumnCount=function(){var g=v.columns,m=0;if(Array.isArray(g))m=g.length;else if(isFunction(g))if(a.dataType==="array")for(var _=this.countSourceCols(),C=0;C<_;C+=1)g(C)&&(m+=1);else(a.dataType==="object"||a.dataType==="function")&&(m=l.colToPropCache.length);else if(isDefined(v.dataSchema)){var R=l.getSchema();m=Array.isArray(R)?R.length:deepObjectSize(R)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,m,_,C){return isUndefined(g)?l.getAll():l.getRange(a._createCellCoords(g,m),a._createCellCoords(_,C),l.DESTINATION_RENDERER)},this.getCopyableText=function(g,m,_,C){return l.getCopyableText(a._createCellCoords(g,m),a._createCellCoords(_,C))},this.getCopyableData=function(g,m){return l.getCopyable(g,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,_=(d?a.loadData:a.updateData).bind(this),C=!1,R,A;if(isDefined(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(isDefined(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(isDefined(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(R in g)R==="data"||(R==="language"?G(g.language):R==="className"?q("className",g.className):R==="tableClassName"&&a.table?(q("tableClassName",g.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):Hooks$1.getSingleton().isRegistered(R)||Hooks$1.getSingleton().isDeprecated(R)?(isFunction(g[R])||Array.isArray(g[R]))&&(g[R].initialHook=!0,a.addHook(R,g[R])):!m&&hasOwnProperty$1(g,R)&&(b[R]=g[R]));g.data===void 0&&v.data===void 0?_(null,"updateSettings"):g.data!==void 0?_(g.data,"updateSettings"):g.columns!==void 0&&(l.createMap(),a.initIndexMappers());var B=a.countCols(),V=v.columns;if(V&&isFunction(V)&&(C=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&p.clearCache(),B>0)for(R=0,A=0;R<B;R++){if(V){var K=C?V(R):V[A];K&&p.updateColumnMeta(A,K)}A+=1}isDefined(g.cell)&&objectEach(g.cell,function(se){a.setCellMetaObject(se.row,se.col,se)}),a.runHooks("afterCellMetaReset");var J=a.rootElement.style.height;J!==""&&(J=parseInt(a.rootElement.style.height,10));var ee=g.height;if(isFunction(ee)&&(ee=ee()),m){var oe=a.rootElement.getAttribute("style");oe&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ee===null){var ye=a.rootElement.getAttribute("data-initialstyle");ye&&(ye.indexOf("height")>-1||ye.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",ye):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ee!==void 0&&(a.rootElement.style.height=isNaN(ee)?"".concat(ee):"".concat(ee,"px"),a.rootElement.style.overflow="hidden");if(typeof g.width<"u"){var ae=g.width;isFunction(ae)&&(ae=ae()),a.rootElement.style.width=isNaN(ae)?"".concat(ae):"".concat(ae,"px")}m||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",g)),c.adjustRowsAndCols(),a.view&&!d&&(a.forceFullRender=!0,f.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),f.unlockEditor()),!m&&a.view&&(J===""||ee===""||ee===void 0)&&J!==ee&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var g=a.getSelectedLast();if(v.getValue){if(isFunction(v.getValue))return v.getValue.call(a);if(g)return a.getData()[g[0][0]][v.getValue]}else if(g)return a.getDataAtCell(g[0],g[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,m,_,C,R){c.alter(g,m,_,C,R)},this.getCell=function(g,m){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,C=m,R=g;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;C=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return R===null||C===null?null:a.view.getCellAtCoords(a._createCellCoords(R,C),_)},this.getCoords=function(g){var m=this.view._wt.wtTable.getCoords(g);if(m===null)return null;var _=m.row,C=m.col,R=_,A=C;return _>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(_)),C>=0&&(A=this.columnIndexMapper.getVisualFromRenderableIndex(C)),a._createCellCoords(R,A)},this.colToProp=function(g){return l.colToProp(g)},this.propToCol=function(g){return l.propToCol(g)},this.toVisualRow=function(g){return n.rowIndexMapper.getVisualFromPhysicalIndex(g)},this.toVisualColumn=function(g){return n.columnIndexMapper.getVisualFromPhysicalIndex(g)},this.toPhysicalRow=function(g){return n.rowIndexMapper.getPhysicalFromVisualIndex(g)},this.toPhysicalColumn=function(g){return n.columnIndexMapper.getPhysicalFromVisualIndex(g)},this.getDataAtCell=function(g,m){return l.get(g,l.colToProp(m))},this.getDataAtRowProp=function(g,m){return l.get(g,m)},this.getDataAtCol=function(g){var m;return(m=[]).concat.apply(m,_toConsumableArray$i(l.getRange(a._createCellCoords(0,g),a._createCellCoords(v.data.length-1,g),l.DESTINATION_RENDERER)))},this.getDataAtProp=function(g){var m,_=l.getRange(a._createCellCoords(0,l.propToCol(g)),a._createCellCoords(v.data.length-1,l.propToCol(g)),l.DESTINATION_RENDERER);return(m=[]).concat.apply(m,_toConsumableArray$i(_))},this.getSourceData=function(g,m,_,C){var R;return g===void 0?R=u.getData():R=u.getByRange(a._createCellCoords(g,m),a._createCellCoords(_,C)),R},this.getSourceDataArray=function(g,m,_,C){var R;return g===void 0?R=u.getData(!0):R=u.getByRange(a._createCellCoords(g,m),a._createCellCoords(_,C),!0),R},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,m,_,C){var R=Q(g,m,_),A=this.hasHook("afterSetSourceDataAtCell"),B=[];A&&arrayEach(R,function(K){var J=_slicedToArray$B(K,3),ee=J[0],oe=J[1],ye=J[2];B.push([ee,oe,u.getAtCell(ee,oe),ye])}),arrayEach(R,function(K){var J=_slicedToArray$B(K,3),ee=J[0],oe=J[1],ye=J[2];u.setAtCell(ee,oe,ye)}),A&&this.runHooks("afterSetSourceDataAtCell",B,C),this.render();var V=a.getActiveEditor();V&&isDefined(V.refreshValue)&&V.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,m){return u.getAtCell(g,m)},this.getDataAtRow=function(g){var m=l.getRange(a._createCellCoords(g,0),a._createCellCoords(g,this.countCols()-1),l.DESTINATION_RENDERER);return m[0]||[]},this.getDataType=function(g,m,_,C){var R=this,A=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,m,_,C],B=A[0],V=A[1],K=A[2],J=A[3],ee=null,oe=null;K===void 0&&(K=B),J===void 0&&(J=V);var ye="mixed";return rangeEach(Math.max(Math.min(B,K),0),Math.max(B,K),function(ae){var se=!0;return rangeEach(Math.max(Math.min(V,J),0),Math.max(V,J),function(X){var _e=R.getCellMeta(ae,X);return oe=_e.type,ee?se=ee===oe:ee=oe,se}),ye=se?oe:"mixed",se}),ye},this.removeCellMeta=function(g,m,_){var C=[this.toPhysicalRow(g),this.toPhysicalColumn(m)],R=C[0],A=C[1],B=p.getCellMetaKeyValue(R,A,_),V=a.runHooks("beforeRemoveCellMeta",g,m,_,B);V!==!1&&(p.removeCellMeta(R,A,_),a.runHooks("afterRemoveCellMeta",g,m,_,B)),B=null},this.spliceCellsMeta=function(g){for(var m=this,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,C=arguments.length,R=new Array(C>2?C-2:0),A=2;A<C;A++)R[A-2]=arguments[A];if(R.length>0&&!Array.isArray(R[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");_>0&&p.removeRow(this.toPhysicalRow(g),_),R.length>0&&arrayEach(R.reverse(),function(B){p.createRow(m.toPhysicalRow(g)),arrayEach(B,function(V,K){return m.setCellMetaObject(g,K,V)})}),a.render()},this.setCellMetaObject=function(g,m,_){var C=this;_typeof$1F(_)==="object"&&objectEach(_,function(R,A){C.setCellMeta(g,m,A,R)})},this.setCellMeta=function(g,m,_,C){var R=a.runHooks("beforeSetCellMeta",g,m,_,C);if(R!==!1){var A=g,B=m;g<this.countRows()&&(A=this.toPhysicalRow(g)),m<this.countCols()&&(B=this.toPhysicalColumn(m)),p.setCellMeta(A,B,_,C),a.runHooks("afterSetCellMeta",g,m,_,C)}},this.getCellsMeta=function(){return p.getCellsMeta()},this.getCellMeta=function(g,m){var _=this.toPhysicalRow(g),C=this.toPhysicalColumn(m);return _===null&&(_=g),C===null&&(C=m),p.getCellMeta(_,C,{visualRow:g,visualColumn:m})},this.getCellMetaAtRow=function(g){return p.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||v.columns)},this.getCellRenderer=function(g,m){var _=typeof g=="number"?a.getCellMeta(g,m).renderer:g.renderer;return typeof _=="string"?_getItem$2(_):isUndefined(_)?_getItem$2("text"):_},this.getCellEditor=function(g,m){var _=typeof g=="number"?a.getCellMeta(g,m).editor:g.editor;return typeof _=="string"?_getItem$3(_):isUndefined(_)?_getItem$3("text"):_},this.getCellValidator=function(g,m){var _=typeof g=="number"?a.getCellMeta(g,m).validator:g.validator;return typeof _=="string"?_getItem$1(_):_},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,m){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,g)},this.validateColumns=function(g,m){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,g)},this._validateCells=function(g,m,_){var C=new z;g&&(C.onQueueEmpty=g);for(var R=a.countRows()-1;R>=0;){if(m!==void 0&&m.indexOf(R)===-1){R-=1;continue}for(var A=a.countCols()-1;A>=0;){if(_!==void 0&&_.indexOf(A)===-1){A-=1;continue}C.addValidatorToQueue(),a.validateCell(a.getDataAtCell(R,A),a.getCellMeta(R,A),function(B){if(typeof B!="boolean")throw new Error("Validation error: result is not boolean");B===!1&&(C.valid=!1),C.removeValidatorFormQueue()},"validateCells"),A-=1}R-=1}C.checkIfQueueIsEmpty()},this.getRowHeader=function(g){var m=v.rowHeaders,_=g;return _!==void 0&&(_=a.runHooks("modifyRowHeader",_)),_===void 0?(m=[],rangeEach(a.countRows()-1,function(C){m.push(a.getRowHeader(C))})):Array.isArray(m)&&m[_]!==void 0?m=m[_]:isFunction(m)?m=m(_):m&&typeof m!="string"&&typeof m!="number"&&(m=_+1),m},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(var g=0,m=a.countCols();g<m;g++)if(a.getColHeader(g))return!0;return!1},this.getColHeader=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,_=a.runHooks("modifyColHeader",g);if(_===void 0){for(var C=[],R=a.countCols(),A=0;A<R;A++)C.push(a.getColHeader(A));return C}var B=v.colHeaders,V=function(oe){for(var ye=[],ae=a.countCols(),se=0;se<ae;se++)isFunction(v.columns)&&v.columns(se)&&ye.push(se);return ye[oe]},K=a.toPhysicalColumn(_),J=V(K);return v.colHeaders===!1?B=null:v.columns&&isFunction(v.columns)&&v.columns(J)&&v.columns(J).title?B=v.columns(J).title:v.columns&&v.columns[K]&&v.columns[K].title?B=v.columns[K].title:Array.isArray(v.colHeaders)&&v.colHeaders[K]!==void 0?B=v.colHeaders[K]:isFunction(v.colHeaders)?B=v.colHeaders(K):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(B=spreadsheetColumnLabel(_)),B=a.runHooks("modifyColumnHeaderValue",B,g,m),B},this._getColWidthFromSettings=function(g){var m;if(g>=0){var _=a.getCellMeta(0,g);m=_.width}if((m===void 0||m===v.width)&&(m=v.colWidths),m!=null){switch(_typeof$1F(m)){case"object":m=m[g];break;case"function":m=m(g);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(g){var m=a._getColWidthFromSettings(g);return m=a.runHooks("modifyColWidth",m,g),m===void 0&&(m=ViewportColumnsCalculator$1.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(g){var m=v.rowHeights;if(m!=null){switch(_typeof$1F(m)){case"object":m=m[g];break;case"function":m=m(g);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(g){var m=a._getRowHeightFromSettings(g);return m=a.runHooks("modifyRowHeight",m,g),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){var g=v.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,m)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return rangeEachReverse(a.countRows()-1,function(_){if(a.isEmptyRow(_))m+=1;else if(g===!0)return!1}),m},this.countEmptyCols=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return rangeEachReverse(a.countCols()-1,function(_){if(a.isEmptyCol(_))m+=1;else if(g===!0)return!1}),m},this.isEmptyRow=function(g){return v.isEmptyRow.call(a,g)},this.isEmptyCol=function(g){return v.isEmptyCol.call(a,g)},this.selectCell=function(g,m,_,C){var R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return isUndefined(g)||isUndefined(m)?!1:this.selectCells([[g,m,_,C]],R,A)},this.selectCells=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(i=!0);var C=E.selectCells(g);return C&&_&&a.listen(),i=!1,C},this.selectColumns=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return E.selectColumns(g,m)},this.selectRows=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return E.selectRows(g,m)},this.deselectCell=function(){E.deselect()},this.selectAll=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=g&&this.hasRowHeaders(),_=g&&this.hasColHeaders();i=!0,E.selectAll(m,_),i=!1};var ie=function(m,_){return m.getNearestNotHiddenIndex(_,1,!0)};this.scrollViewportTo=function(g,m){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,C=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=!_,B=!C,V=g,K=m;if(R){var J=Number.isInteger(g),ee=Number.isInteger(m),oe=J?ie(this.rowIndexMapper,g):void 0,ye=ee?ie(this.columnIndexMapper,m):void 0;if(oe===null||ye===null)return!1;V=J?a.rowIndexMapper.getRenderableFromVisualIndex(oe):void 0,K=ee?a.columnIndexMapper.getRenderableFromVisualIndex(ye):void 0}var ae=Number.isInteger(V),se=Number.isInteger(K);return ae&&se?a.view.scrollViewport(a._createCellCoords(V,K),A,C,_,B):ae&&se===!1?a.view.scrollViewportVertically(V,A,_):se&&ae===!1?a.view.scrollViewportHorizontally(K,C,B):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),p.clearCache(),isRootInstance(a)){var g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}empty(a.rootElement),s.destroy(),f&&f.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),S.getItems().forEach(function(m){var _=_slicedToArray$B(m,2),C=_[1];C.destroy()}),S.clear(),a.runHooks("afterDestroy")},!0),Hooks$1.getSingleton().destroy(a),objectEach(a,function(m,_,C){isFunction(m)?C[_]=he(_):_!=="guid"&&(C[_]=null)}),a.isDestroyed=!0,l&&l.destroy(),a.rowIndexMapper=null,a.columnIndexMapper=null,l=null,c=null,E=null,f=null,a=null};function he(g){return function(){throw new Error('The "'.concat(g,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getPlugin=function(g){var m=toUpperCaseFirst(g);return m==="UndoRedo"?this.undoRedo:S.getItem(m)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(g)},this.getInstance=function(){return a},this.addHook=function(g,m){Hooks$1.getSingleton().add(g,m,a)},this.hasHook=function(g){return Hooks$1.getSingleton().has(g,a)||Hooks$1.getSingleton().has(g)},this.addHookOnce=function(g,m){Hooks$1.getSingleton().once(g,m,a)},this.removeHook=function(g,m){Hooks$1.getSingleton().remove(g,m,a)},this.runHooks=function(g,m,_,C,R,A,B){return Hooks$1.getSingleton().run(a,g,m,_,C,R,A,B)},this.getTranslatedPhrase=function(g,m){return getTranslatedPhrase(v.language,g,m)},this.toHTML=function(){return instanceToHTML(n)},this.toTableElement=function(){var g=n.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",instanceToHTML(n)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=g;typeof _=="function"&&(_=setTimeout(_,m)),this.timeouts.push(_)},this._clearTimeouts=function(){arrayEach(this.timeouts,function(g){clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){arrayEach(this.immediates,function(g){clearImmediate(g)})},this._refreshBorders=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.destroyEditor(g),a.view.render(),m&&E.isSelected()&&f.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var ce=createShortcutManager({handleEvent:function(m){var _=a.isListening(),C=(m==null?void 0:m.key)!==void 0;return _&&C},beforeKeyDown:function(m){return n.runHooks("beforeKeyDown",m)},afterKeyDown:function(m){n.isDestroyed||a.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(g){g.ctrlKey===!1&&g.metaKey===!1&&ce.releasePressedKeys()}),this.getShortcutManager=function(){return ce};var fe=ce.addContext("grid"),I={runOnlyIf:function(){return isDefined(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:SHORTCUTS_GROUP$8};ce.setActiveContextName("grid"),fe.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var m=a.getSelectedRange(),_=m[m.length-1].highlight,C=_.row,R=_.col,A=a.getDataAtCell(C,R),B=new Map,V=0;V<m.length;V++)m[V].forAll(function(K,J){if(K>=0&&J>=0&&(K!==C||J!==R)){var ee=a.getCellMeta(K,J),oe=ee.readOnly;oe||B.set("".concat(K,"x").concat(J),[K,J,A])}});a.setDataAtCell(Array.from(B.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){E.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){E.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),_=m.from,C=m.to,R=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);E.setRangeStart(_.clone()),E.setRangeEnd(a._createCellCoords(R,C.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){E.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){E.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),_=m.from,C=m.to,R=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);E.setRangeStart(_.clone()),E.setRangeEnd(a._createCellCoords(R,C.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){E.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var m,_=a.getSelectedRangeLast().highlight.row,C=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,_toConsumableArray$i(a.isRtl()?[a.countCols()-1,-1]:[0,1]));E.setRangeStart(a._createCellCoords(_,C))}},{keys:[["ArrowLeft","Shift"]],callback:function(){E.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,_=a.getSelectedRangeLast(),C=_.from,R=_.to,A=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,_toConsumableArray$i(a.isRtl()?[a.countCols()-1,-1]:[0,1]));E.setRangeStart(C.clone()),E.setRangeEnd(a._createCellCoords(R.row,A))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){E.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var m,_=a.getSelectedRangeLast().highlight.row,C=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,_toConsumableArray$i(a.isRtl()?[0,1]:[a.countCols()-1,-1]));E.setRangeStart(a._createCellCoords(_,C))}},{keys:[["ArrowRight","Shift"]],callback:function(){E.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,_=a.getSelectedRangeLast(),C=_.from,R=_.to,A=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,_toConsumableArray$i(a.isRtl()?[0,1]:[a.countCols()-1,-1]));E.setRangeStart(C.clone()),E.setRangeEnd(a._createCellCoords(R.row,A))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedColumnsStart,10),_=a.getSelectedRangeLast().highlight.row,C=a.columnIndexMapper.getNearestNotHiddenIndex(m,1);E.setRangeStart(a._createCellCoords(_,C))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){E.setRangeEnd(a._createCellCoords(E.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsTop,10),_=parseInt(a.getSettings().fixedColumnsStart,10),C=a.rowIndexMapper.getNearestNotHiddenIndex(m,1),R=a.columnIndexMapper.getNearestNotHiddenIndex(_,1);E.setRangeStart(a._createCellCoords(C,R))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){E.setRangeEnd(a._createCellCoords(E.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsBottom,10),_=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-m-1,-1),C=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);E.setRangeStart(a._createCellCoords(_,C))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){E.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),_=m.to,C=Math.max(_.row-a.countVisibleRows(),0),R=a.rowIndexMapper.getNearestNotHiddenIndex(C,1);if(R!==null){var A=a._createCellCoords(R,_.col),B=_.row-a.view.getFirstFullyVisibleRow(),V=Math.max(A.row-B,0);E.setRangeEnd(A),a.scrollViewportTo(V)}}},{keys:[["PageDown"]],callback:function(){E.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),_=m.to,C=Math.min(_.row+a.countVisibleRows(),a.countRows()-1),R=a.rowIndexMapper.getNearestNotHiddenIndex(C,-1);if(R!==null){var A=a._createCellCoords(R,_.col),B=_.row-a.view.getFirstFullyVisibleRow(),V=Math.min(A.row-B,a.countRows()-1);E.setRangeEnd(A),a.scrollViewportTo(V)}}},{keys:[["Tab"]],callback:function(m){var _=typeof v.tabMoves=="function"?v.tabMoves(m):v.tabMoves;E.transformStart(_.row,_.col,!0)}},{keys:[["Shift","Tab"]],callback:function(m){var _=typeof v.tabMoves=="function"?v.tabMoves(m):v.tabMoves;E.transformStart(-_.row,-_.col)}}],I),getPluginsNames().forEach(function(g){var m=getPlugin(g);S.addItem(g,new m(n))}),Hooks$1.getSingleton().run(a,"construct")}var MIXIN_NAME="hooksRefRegisterer",hooksRefRegisterer={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;arrayEach(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;objectEach(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};defineGetter(hooksRefRegisterer,"MIXIN_NAME",MIXIN_NAME,{writable:!1,enumerable:!1});const hooksRefRegisterer$1=hooksRefRegisterer;function _typeof$1E(e){return _typeof$1E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1E(e)}function _slicedToArray$A(e,t){return _arrayWithHoles$C(e)||_iterableToArrayLimit$A(e,t)||_unsupportedIterableToArray$Q(e,t)||_nonIterableRest$C()}function _nonIterableRest$C(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$Q(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$Q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$Q(e,t)}}function _arrayLikeToArray$Q(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$A(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$C(e){if(Array.isArray(e))return e}function _inherits$_(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$_(e,t)}function _setPrototypeOf$_(e,t){return _setPrototypeOf$_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$_(e,t)}function _createSuper$_(e){var t=_isNativeReflectConstruct$_();return function(){var n=_getPrototypeOf$_(e),o;if(t){var i=_getPrototypeOf$_(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$_(this,o)}}function _possibleConstructorReturn$_(e,t){if(t&&(_typeof$1E(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$_(e)}function _assertThisInitialized$_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$_(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$_(e){return _getPrototypeOf$_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$_(e)}function _classCallCheck$1z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1D(n.key),n)}}function _createClass$1z(e,t,r){return t&&_defineProperties$1z(e.prototype,t),r&&_defineProperties$1z(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1D(e){var t=_toPrimitive$1D(e,"string");return _typeof$1E(t)==="symbol"?t:String(t)}function _toPrimitive$1D(e,t){if(_typeof$1E(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1E(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EDITOR_TYPE$a="base",EDITOR_STATE=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),SHORTCUTS_GROUP_EDITOR$1="baseEditor",BaseEditor=function(){function e(t){_classCallCheck$1z(this,e),this.hot=t,this.instance=t,this.state=EDITOR_STATE.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return _createClass$1z(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,s){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=s,this.state=EDITOR_STATE.VIRGIN}},{key:"extend",value:function(){return function(r){_inherits$_(o,r);var n=_createSuper$_(o);function o(){return _classCallCheck$1z(this,o),n.apply(this,arguments)}return _createClass$1z(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,s,l;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),s=Math.max(u[0],u[2]),l=Math.max(u[1],u[3])}else{var c=[this.row,this.col,null,null];i=c[0],a=c[1],s=c[2],l=c[3]}var f=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(f)){var d=_slicedToArray$A(f,2);i=d[0],a=d[1]}var h=this.hot.getShortcutManager(),y=h.getContext("editor"),p={runOnlyIf:function(){return isDefined(o.hot.getSelected())},group:SHORTCUTS_GROUP_EDITOR$1};this.isInFullEditMode()&&y.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],p),this.hot.populateFromArray(i,a,r,s,l,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===EDITOR_STATE.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=EDITOR_STATE.EDITING,this.isInFullEditMode()){var s=typeof r=="string"?r:stringify$1(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var s=this._closeCallback;this._closeCallback=function(f){s&&s(f),o(f),i.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager(),u=l.getContext("editor");if(u.removeShortcutsByGroup(SHORTCUTS_GROUP_EDITOR$1),u.removeShortcutsByGroup(SHORTCUTS_GROUP_NAVIGATION),this.state===EDITOR_STATE.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===EDITOR_STATE.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var c=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof c=="string"?String.prototype.trim.call(c||""):c]]:a=[[c]],this.state=EDITOR_STATE.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(f){i.state=EDITOR_STATE.FINISHED,i.discardEditor(f)}):(this.state=EDITOR_STATE.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=EDITOR_STATE.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===EDITOR_STATE.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=EDITOR_STATE.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=EDITOR_STATE.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===EDITOR_STATE.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,s=this.hot.rootWindow,l=offset(n),u=outerWidth(n),c=offset(this.hot.rootElement),f=outerWidth(this.hot.rootElement),d=i.topOverlay.holder,h=i.inlineStartOverlay.holder,y=d!==s?d.scrollTop:0,p=h!==s?h.scrollLeft:0,v=s.innerWidth-c.left-f,b=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,S=b.wtTable,w=S.name,P=["master","inline_start"].includes(w)?y:0,E=["master","top","bottom"].includes(w)?p:0,j=l.top===c.top?0:1,G=l.top-c.top-j-P,q=0;this.hot.isRtl()?q=s.innerWidth-l.left-u-v-1+E:q=l.left-c.left-1-E,["top","top_inline_start_corner"].includes(w)&&(G+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(w)&&(q+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var z=this.hot.hasColHeaders(),U=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),te=this.hot.rowIndexMapper.getRenderableIndexesLength(),Q=te-this.hot.view._wt.getSetting("fixedRowsBottom");(z&&U<=0||U===Q)&&(G+=1),Z<=0&&(q+=1);var ie=a.rowsRenderCalculator.startPosition,he=a.columnsRenderCalculator.startPosition,ce=Math.abs(i.inlineStartOverlay.getScrollPosition()),fe=i.topOverlay.getScrollPosition(),I=getScrollbarWidth(this.hot.rootDocument),g=n.offsetTop+ie-fe,m=0;if(this.hot.isRtl()){var _=n.offsetLeft;_>=0?m=S.getWidth()-n.offsetLeft:m=Math.abs(_),m+=he-ce-u}else m=n.offsetLeft+he-ce;var C=getComputedStyle(this.TD,this.hot.rootWindow),R=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",A=parseInt(C[R],10)>0?0:1,B=parseInt(C.borderTopWidth,10)>0?0:1,V=outerWidth(n)+A,K=outerHeight(n)+B,J=hasVerticalScrollbar(d)?I:0,ee=hasHorizontalScrollbar(h)?I:0,oe=this.hot.view.maximumVisibleElementWidth(m)-J+A,ye=Math.max(this.hot.view.maximumVisibleElementHeight(g)-ee+B,23);return{top:G,start:q,height:K,maxHeight:ye,width:V,maxWidth:oe}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return EDITOR_TYPE$a}}]),e}();mixin(BaseEditor,hooksRefRegisterer$1);function autoResize(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(h,y,p){h.addEventListener(y,p,!1)},a=function(h,y,p){h.removeEventListener(y,p,!1)},s=function(h){var y,p;h?/^[a-zA-Z \.,\\\/\|0-9]$/.test(h)||(h="."):h="",n.textContent!==void 0?n.textContent=t.value+h:n.data=t.value+h,o.style.position="absolute",o.style.fontSize=f(t).fontSize,o.style.fontFamily=f(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),y=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>y?t.style.width=e.minWidth+"px":y>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=y+"px",p=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>p?t.style.height=e.minHeight+"px":e.maxHeight<p?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=p+"px"},l=function(){window.setTimeout(s,0)},u=function(h){if(h&&h.minHeight)if(h.minHeight=="inherit")e.minHeight=t.clientHeight;else{var y=parseInt(h.minHeight);isNaN(y)||(e.minHeight=y)}if(h&&h.maxHeight)if(h.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var p=parseInt(h.maxHeight);isNaN(p)||(e.maxHeight=p)}if(h&&h.minWidth)if(h.minWidth=="inherit")e.minWidth=t.clientWidth;else{var v=parseInt(h.minWidth);isNaN(v)||(e.minWidth=v)}if(h&&h.maxWidth)if(h.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var b=parseInt(h.maxWidth);isNaN(b)||(e.maxWidth=b)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},c=function(h,y,p){t=h,u(y),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),p&&(i(t,"change",s),i(t,"cut",l),i(t,"paste",l),i(t,"drop",l),i(t,"keydown",l),i(t,"focus",s),i(t,"compositionstart",l),i(t,"compositionupdate",l),i(t,"compositionend",l)),s()};function f(d){return d.currentStyle||document.defaultView.getComputedStyle(d)}return{init:function(h,y,p){c(h,y,p)},unObserve:function(){a(t,"change",s),a(t,"cut",l),a(t,"paste",l),a(t,"drop",l),a(t,"keydown",l),a(t,"focus",s),a(t,"compositionstart",l),a(t,"compositionupdate",l),a(t,"compositionend",l)},resize:s}}function updateCaretPosition(e,t){for(var r=getCaretPosition(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var s=n[a];a!==0&&(i+=n[a-1].length+1);var l=i+s.length;if(e==="home"?o=i:e==="end"&&(o=l),r<=l)break}setCaretPosition(t,o)}function _typeof$1D(e){return _typeof$1D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1D(e)}function _slicedToArray$z(e,t){return _arrayWithHoles$B(e)||_iterableToArrayLimit$z(e,t)||_unsupportedIterableToArray$P(e,t)||_nonIterableRest$B()}function _nonIterableRest$B(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$P(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$P(e,t)}}function _arrayLikeToArray$P(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$z(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$B(e){if(Array.isArray(e))return e}function _classCallCheck$1y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1C(n.key),n)}}function _createClass$1y(e,t,r){return t&&_defineProperties$1y(e.prototype,t),r&&_defineProperties$1y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1C(e){var t=_toPrimitive$1C(e,"string");return _typeof$1D(t)==="symbol"?t:String(t)}function _toPrimitive$1C(e,t){if(_typeof$1D(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1D(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$P(){return typeof Reflect<"u"&&Reflect.get?_get$P=Reflect.get.bind():_get$P=function(t,r,n){var o=_superPropBase$P(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$P.apply(this,arguments)}function _superPropBase$P(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$Z(e),e!==null););return e}function _inherits$Z(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$Z(e,t)}function _setPrototypeOf$Z(e,t){return _setPrototypeOf$Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$Z(e,t)}function _createSuper$Z(e){var t=_isNativeReflectConstruct$Z();return function(){var n=_getPrototypeOf$Z(e),o;if(t){var i=_getPrototypeOf$Z(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$Z(this,o)}}function _possibleConstructorReturn$Z(e,t){if(t&&(_typeof$1D(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$Z(e)}function _assertThisInitialized$Z(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$Z(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$Z(e){return _getPrototypeOf$Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$Z(e)}var EDITOR_VISIBLE_CLASS_NAME$1="ht_editor_visible",EDITOR_HIDDEN_CLASS_NAME="ht_editor_hidden",SHORTCUTS_GROUP$7="textEditor",EDITOR_TYPE$9="text",TextEditor=function(e){_inherits$Z(r,e);var t=_createSuper$Z(r);function r(n){var o;return _classCallCheck$1y(this,r),o=t.call(this,n),o.eventManager=new EventManager$1(_assertThisInitialized$Z(o)),o.autoResize=autoResize(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return _createClass$1y(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,s,l,u){var c=this.state;if(_get$P(_getPrototypeOf$Z(r.prototype),"prepare",this).call(this,o,i,a,s,l,u),!u.readOnly){this.refreshDimensions(!0);var f=u.allowInvalid,d=u.fragmentSelection;f&&(this.TEXTAREA.value=""),c!==EDITOR_STATE.FINISHED&&this.hideEditableElement();var h=!d;h&&!isMobileBrowser()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===EDITOR_STATE.VIRGIN&&(this.TEXTAREA.value="",_get$P(_getPrototypeOf$Z(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),hasClass(this.TEXTAREA_PARENT,this.layerClass)&&removeClass(this.TEXTAREA_PARENT,this.layerClass),addClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(isIE()||isEdge())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",removeClass(this.TEXTAREA_PARENT,this.layerClass),addClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;rangeEach(o.length-1,function(a){var s=o[a];if(hasClass(s,"handsontableEditor"))return i=!0,!1}),hasClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)&&removeClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),i?(this.layerClass=EDITOR_VISIBLE_CLASS_NAME$1,addClass(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),addClass(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==EDITOR_STATE.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,s=i.start,l=i.width,u=i.maxWidth,c=i.height,f=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(s,"px"),this.showEditableElement();var d=getComputedStyle(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=d.fontSize,this.TEXTAREA.style.fontFamily=d.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var h=getComputedStyle(this.TEXTAREA),y=parseInt(h.paddingLeft,10)+parseInt(h.paddingRight,10),p=parseInt(h.paddingTop,10)+parseInt(h.paddingBottom,10),v=l-y,b=c-p,S=u-y,w=f-p;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(v,S),minHeight:Math.min(b,w),maxWidth:S,maxHeight:w},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),isIOS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),s={runOnlyIf:function(){return isDefined(o.hot.getSelected())},group:SHORTCUTS_GROUP$7},l=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(c){var f=o.hot.getSettings(),d=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;o.hot.selection.transformStart(d.row,d.col,!0)}},{keys:[["Shift","Tab"]],callback:function(c){var f=o.hot.getSettings(),d=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;o.hot.selection.transformStart(-d.row,-d.col)}},{keys:[["Control","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(c){return!o.hot.selection.isMultiple()&&!c.altKey},relativeToGroup:SHORTCUTS_GROUP_EDITOR$2,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:SHORTCUTS_GROUP_EDITOR$2,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return l(),!1},relativeToGroup:SHORTCUTS_GROUP_EDITOR$2,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(c,f){var d=_slicedToArray$z(f,1),h=d[0];updateCaretPosition(h,o.TEXTAREA)}},{keys:[["End"]],callback:function(c,f){var d=_slicedToArray$z(f,1),h=d[0];updateCaretPosition(h,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],s)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(SHORTCUTS_GROUP_NAVIGATION),i.removeShortcutsByGroup(SHORTCUTS_GROUP$7),i.removeShortcutsByGroup(SHORTCUTS_GROUP_EDITOR$1)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[KEY_CODES.ARROW_UP,KEY_CODES.ARROW_RIGHT,KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return EDITOR_TYPE$9}}]),r}(BaseEditor),RENDERER_TYPE$7="base";function baseRenderer(e,t,r,n,o,i,a){var s=[],l=[];a.className&&addClass(t,a.className),a.readOnly&&s.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?s.push(a.invalidCellClassName):l.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!i&&a.placeholder&&s.push(a.placeholderCellClassName),removeClass(t,l),addClass(t,s)}baseRenderer.RENDERER_TYPE=RENDERER_TYPE$7;var RENDERER_TYPE$6="text";function textRenderer(e,t,r,n,o,i,a){baseRenderer.apply(this,[e,t,r,n,o,i,a]);var s=i;if(!s&&a.placeholder&&(s=a.placeholder),s=stringify$1(s),a.trimWhitespace&&(s=s.trim()),a.rendererTemplate){empty(t);var l=e.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=e.getSourceDataAtRow(r),t.appendChild(l)}else fastInnerText(t,s)}textRenderer.RENDERER_TYPE=RENDERER_TYPE$6;var CELL_TYPE$8="text",TextCellType={CELL_TYPE:CELL_TYPE$8,editor:TextEditor,renderer:textRenderer};_register(TextCellType);Handsontable$1.editors={BaseEditor};function Handsontable$1(e,t){var r=new Core(e,t||{},rootInstanceSymbol);return r.init(),r}Handsontable$1.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Core(e,t,rootInstanceSymbol)};Handsontable$1.DefaultSettings=metaSchemaFactory();Handsontable$1.hooks=Hooks$1.getSingleton();Handsontable$1.CellCoords=CellCoords$1;Handsontable$1.CellRange=CellRange$1;Handsontable$1.packageName="handsontable";Handsontable$1.buildDate="06/02/2023 12:34:58";Handsontable$1.version="12.3.1";Handsontable$1.languages={dictionaryKeys,getLanguageDictionary,getLanguagesDictionaries,registerLanguageDictionary,getTranslatedPhrase};function _typeof$1C(e){return _typeof$1C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1C(e)}function _classCallCheck$1x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1B(n.key),n)}}function _createClass$1x(e,t,r){return t&&_defineProperties$1x(e.prototype,t),r&&_defineProperties$1x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1B(e){var t=_toPrimitive$1B(e,"string");return _typeof$1C(t)==="symbol"?t:String(t)}function _toPrimitive$1B(e,t){if(_typeof$1C(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1C(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$O(){return typeof Reflect<"u"&&Reflect.get?_get$O=Reflect.get.bind():_get$O=function(t,r,n){var o=_superPropBase$O(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$O.apply(this,arguments)}function _superPropBase$O(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$Y(e),e!==null););return e}function _inherits$Y(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$Y(e,t)}function _setPrototypeOf$Y(e,t){return _setPrototypeOf$Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$Y(e,t)}function _createSuper$Y(e){var t=_isNativeReflectConstruct$Y();return function(){var n=_getPrototypeOf$Y(e),o;if(t){var i=_getPrototypeOf$Y(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$Y(this,o)}}function _possibleConstructorReturn$Y(e,t){if(t&&(_typeof$1C(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$Y(e)}function _assertThisInitialized$Y(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$Y(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$Y(e){return _getPrototypeOf$Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$Y(e)}var SHORTCUTS_GROUP$6="handsontableEditor",EDITOR_TYPE$8="handsontable",HandsontableEditor=function(e){_inherits$Y(r,e);var t=_createSuper$Y(r);function r(){return _classCallCheck$1x(this,r),t.apply(this,arguments)}return _createClass$1x(r,[{key:"open",value:function(){_get$O(_getPrototypeOf$Y(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),_get$O(_getPrototypeOf$Y(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,s,l,u){_get$O(_getPrototypeOf$Y(r.prototype),"prepare",this).call(this,o,i,a,s,l,u);var c=this,f={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(h,y){var p=this.getSourceData(y.row,y.col);p!==void 0&&c.setValue(p),c.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&extend$1(f,u.handsontable),this.htOptions=f}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||_get$O(_getPrototypeOf$Y(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){_get$O(_getPrototypeOf$Y(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}_get$O(_getPrototypeOf$Y(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");_get$O(_getPrototypeOf$Y(r.prototype),"registerShortcuts",this).call(this);var s={group:SHORTCUTS_GROUP$6,relativeToGroup:SHORTCUTS_GROUP_NAVIGATION,position:"before"},l=function(c,f){var d=o.htEditor.getInstance();if(c!==void 0&&(c<0||d.flipped&&c>d.countRows()-1?d.deselectCell():d.selectCell(c,0),d.getData().length))return f.preventDefault(),stopImmediatePropagation(f),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(c){var f=o.htEditor.getInstance(),d,h;return!f.getSelectedLast()&&f.flipped?d=f.countRows()-1:f.getSelectedLast()&&(f.flipped?(h=f.getSelectedLast()[0],d=Math.max(0,h-1)):(h=f.getSelectedLast()[0],d=h-1)),l(d,c)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(c){var f=o.htEditor.getInstance(),d,h;if(!f.getSelectedLast()&&!f.flipped)d=0;else if(f.getSelectedLast()){if(f.flipped)d=f.getSelectedLast()[0]+1;else if(!f.flipped){var y=f.countRows()-1;h=f.getSelectedLast()[0],d=Math.min(y,h+1)}}return l(d,c)},preventDefault:!1}],s)}},{key:"unregisterShortcuts",value:function(){_get$O(_getPrototypeOf$Y(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(SHORTCUTS_GROUP$6)}}],[{key:"EDITOR_TYPE",get:function(){return EDITOR_TYPE$8}}]),r}(TextEditor);function _typeof$1B(e){return _typeof$1B=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1B(e)}function _classCallCheck$1w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1A(n.key),n)}}function _createClass$1w(e,t,r){return t&&_defineProperties$1w(e.prototype,t),r&&_defineProperties$1w(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _get$N(){return typeof Reflect<"u"&&Reflect.get?_get$N=Reflect.get.bind():_get$N=function(t,r,n){var o=_superPropBase$N(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$N.apply(this,arguments)}function _superPropBase$N(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$X(e),e!==null););return e}function _inherits$X(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$X(e,t)}function _setPrototypeOf$X(e,t){return _setPrototypeOf$X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$X(e,t)}function _createSuper$X(e){var t=_isNativeReflectConstruct$X();return function(){var n=_getPrototypeOf$X(e),o;if(t){var i=_getPrototypeOf$X(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$X(this,o)}}function _possibleConstructorReturn$X(e,t){if(t&&(_typeof$1B(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$X(e)}function _assertThisInitialized$X(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$X(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$X(e){return _getPrototypeOf$X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$X(e)}function _defineProperty$j(e,t,r){return t=_toPropertyKey$1A(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1A(e){var t=_toPrimitive$1A(e,"string");return _typeof$1B(t)==="symbol"?t:String(t)}function _toPrimitive$1A(e,t){if(_typeof$1B(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1B(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var privatePool$g=new WeakMap,EDITOR_TYPE$7="autocomplete",AutocompleteEditor=function(e){_inherits$X(r,e);var t=_createSuper$X(r);function r(n){var o;return _classCallCheck$1w(this,r),o=t.call(this,n),_defineProperty$j(_assertThisInitialized$X(o),"sortByRelevance",function(i,a,s){var l=[],u=[],c=i.length,f=a.length,d,h,y,p;if(c===0){for(y=0;y<f;y++)u.push(y);return u}for(y=0;y<f;y++){if(h=stripTags(stringify$1(a[y])),s)p=h.indexOf(i);else{var v=this.cellProperties.locale;p=h.toLocaleLowerCase(v).indexOf(i.toLocaleLowerCase(v))}p!==-1&&(d=h.length-p-c,l.push({baseIndex:y,index:p,charsLeft:d,value:h}))}for(l.sort(function(b,S){if(S.index===-1)return-1;if(b.index===-1)return 1;if(b.index<S.index)return-1;if(S.index<b.index)return 1;if(b.index===S.index){if(b.charsLeft<S.charsLeft)return-1;if(b.charsLeft>S.charsLeft)return 1}return 0}),y=0,f=l.length;y<f;y++)u.push(l[y].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],privatePool$g.set(_assertThisInitialized$X(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return _createClass$1w(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var s=o.stripValueIfNeeded(a);return s===o.TEXTAREA.value});return isDefined(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){_get$N(_getPrototypeOf$X(r.prototype),"createElements",this).call(this),addClass(this.htContainer,"autocompleteEditor"),addClass(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=privatePool$g.get(this);_get$N(_getPrototypeOf$X(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var l=getScrollbarWidth();l===0&&i.isMacOS&&(l+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:s?[outerWidth(this.TEXTAREA)-2]:void 0,width:s?outerWidth(this.TEXTAREA)+l:void 0,renderer:function(c,f,d,h,y,p,v){textRenderer(c,f,d,h,y,p,v);var b=o.cellProperties,S=b.filteringCaseSensitive,w=b.allowHtml,P=b.locale,E=o.query,j=stringify$1(p),G,q;j&&!w&&(G=S===!0?j.indexOf(E):j.toLocaleLowerCase(P).indexOf(E.toLocaleLowerCase(P)),G!==-1&&(q=j.substr(G,E.length),j=j.replace(q,"<strong>".concat(q,"</strong>")))),f.innerHTML=j},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),_get$N(_getPrototypeOf$X(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){_get$N(_getPrototypeOf$X(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(s){i.rawChoices=s,i.updateChoicesList(i.stripValuesIfNeeded(s))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=getCaretPosition(this.TEXTAREA),a=getSelectionEndPosition(this.TEXTAREA),s=this.cellProperties.sortByRelevance,l=this.cellProperties.filter,u=null,c=null,f=o;s&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),f,this.cellProperties.filteringCaseSensitive));var d=Array.isArray(u)?u.length:0;if(l===!1)d&&(c=u[0]);else{for(var h=[],y=0,p=f.length;y<p&&!(s&&d<=y);y++)d?h.push(f[u[y]]):h.push(f[y]);c=0,f=h}this.strippedChoices=f,this.htEditor.loadData(pivot([f])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(c),this.hot.listen(),setCaretPosition(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=getTrimmingContainer(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var s=offset(this.TEXTAREA),l=outerHeight(this.TEXTAREA),u=this.getDropdownHeight(),c=o.scrollTop,f=outerHeight(this.hot.view._wt.wtTable.THEAD),d=offset(o),h=s.top-d.top-f+c,y=o.scrollHeight-h-f-l,p=u>y&&h>y;return p?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(p?h:y,u),p}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,s=0,l=0,u=null;do l=this.htEditor.getRowHeight(s)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=l,s+=1;while(a<o);u=a-l,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-l)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+getScrollbarWidth(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=arrayMap(o,function(l){return stringify$1(l)}),s=arrayMap(a,function(l){return i?l:stripTags(l)});return s}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},s=!1;return o===KEY_CODES.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(s=!0),o===KEY_CODES.ARROW_UP&&a.row>-1&&(s=!0),s}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=privatePool$g.get(this);if(a.skipOne=!1,isPrintableChar(o.keyCode)||o.keyCode===KEY_CODES.BACKSPACE||o.keyCode===KEY_CODES.DELETE||o.keyCode===KEY_CODES.INSERT){var s=10;if(o.keyCode===KEY_CODES.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},s)}}}],[{key:"EDITOR_TYPE",get:function(){return EDITOR_TYPE$7}}]),r}(HandsontableEditor);function _typeof$1A(e){return _typeof$1A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1A(e)}function _classCallCheck$1v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1z(n.key),n)}}function _createClass$1v(e,t,r){return t&&_defineProperties$1v(e.prototype,t),r&&_defineProperties$1v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1z(e){var t=_toPrimitive$1z(e,"string");return _typeof$1A(t)==="symbol"?t:String(t)}function _toPrimitive$1z(e,t){if(_typeof$1A(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1A(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$W(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$W(e,t)}function _setPrototypeOf$W(e,t){return _setPrototypeOf$W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$W(e,t)}function _createSuper$W(e){var t=_isNativeReflectConstruct$W();return function(){var n=_getPrototypeOf$W(e),o;if(t){var i=_getPrototypeOf$W(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$W(this,o)}}function _possibleConstructorReturn$W(e,t){if(t&&(_typeof$1A(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$W(e)}function _assertThisInitialized$W(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$W(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$W(e){return _getPrototypeOf$W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$W(e)}var EDITOR_TYPE$6="checkbox",CheckboxEditor=function(e){_inherits$W(r,e);var t=_createSuper$W(r);function r(){return _classCallCheck$1v(this,r),t.apply(this,arguments)}return _createClass$1v(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');hasClass(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return EDITOR_TYPE$6}}]),r}(BaseEditor),pikadayExports={},pikaday={get exports(){return pikadayExports},set exports(e){pikadayExports=e}};const require$$0=getAugmentedNamespace(moment);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=require$$0}catch{}e.exports=n(o)}})(commonjsGlobal,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,s=function(I,g,m,_){o?I.addEventListener(g,m,!!_):I.attachEvent("on"+g,m)},l=function(I,g,m,_){o?I.removeEventListener(g,m,!!_):I.detachEvent("on"+g,m)},u=function(I){return I.trim?I.trim():I.replace(/^\s+|\s+$/g,"")},c=function(I,g){return(" "+I.className+" ").indexOf(" "+g+" ")!==-1},f=function(I,g){c(I,g)||(I.className=I.className===""?g:I.className+" "+g)},d=function(I,g){I.className=u((" "+I.className+" ").replace(" "+g+" "," "))},h=function(I){return/Array/.test(Object.prototype.toString.call(I))},y=function(I){return/Date/.test(Object.prototype.toString.call(I))&&!isNaN(I.getTime())},p=function(I){var g=I.getDay();return g===0||g===6},v=function(I){return I%4===0&&I%100!==0||I%400===0},b=function(I,g){return[31,v(I)?29:28,31,30,31,30,31,31,30,31,30,31][g]},S=function(I){y(I)&&I.setHours(0,0,0,0)},w=function(I,g){return I.getTime()===g.getTime()},P=function(I,g,m){var _,C;for(_ in g)C=I[_]!==void 0,C&&typeof g[_]=="object"&&g[_]!==null&&g[_].nodeName===void 0?y(g[_])?m&&(I[_]=new Date(g[_].getTime())):h(g[_])?m&&(I[_]=g[_].slice(0)):I[_]=P({},g[_],m):(m||!C)&&(I[_]=g[_]);return I},E=function(I,g,m){var _;i.createEvent?(_=i.createEvent("HTMLEvents"),_.initEvent(g,!0,!1),_=P(_,m),I.dispatchEvent(_)):i.createEventObject&&(_=i.createEventObject(),_=P(_,m),I.fireEvent("on"+g,_))},j=function(I){return I.month<0&&(I.year-=Math.ceil(Math.abs(I.month)/12),I.month+=12),I.month>11&&(I.year+=Math.floor(Math.abs(I.month)/12),I.month-=12),I},G={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},q=function(I,g,m){for(g+=I.firstDay;g>=7;)g-=7;return m?I.i18n.weekdaysShort[g]:I.i18n.weekdays[g]},z=function(I){var g=[],m="false";if(I.isEmpty)if(I.showDaysInNextAndPreviousMonths)g.push("is-outside-current-month"),I.enableSelectionDaysInNextAndPreviousMonths||g.push("is-selection-disabled");else return'<td class="is-empty"></td>';return I.isDisabled&&g.push("is-disabled"),I.isToday&&g.push("is-today"),I.isSelected&&(g.push("is-selected"),m="true"),I.hasEvent&&g.push("has-event"),I.isInRange&&g.push("is-inrange"),I.isStartRange&&g.push("is-startrange"),I.isEndRange&&g.push("is-endrange"),'<td data-day="'+I.day+'" class="'+g.join(" ")+'" aria-selected="'+m+'"><button class="pika-button pika-day" type="button" data-pika-year="'+I.year+'" data-pika-month="'+I.month+'" data-pika-day="'+I.day+'">'+I.day+"</button></td>"},U=function(I,g){I.setHours(0,0,0,0);var m=I.getDate(),_=I.getDay(),C=g,R=C-1,A=7,B=function(oe){return(oe+A-1)%A};I.setDate(m+R-B(_));var V=new Date(I.getFullYear(),0,C),K=24*60*60*1e3,J=(I.getTime()-V.getTime())/K,ee=1+Math.round((J-R+B(V.getDay()))/A);return ee},Z=function(I,g,m,_){var C=new Date(m,g,I),R=n?r(C).isoWeek():U(C,_);return'<td class="pika-week">'+R+"</td>"},te=function(I,g,m,_){return'<tr class="pika-row'+(m?" pick-whole-week":"")+(_?" is-selected":"")+'">'+(g?I.reverse():I).join("")+"</tr>"},Q=function(I){return"<tbody>"+I.join("")+"</tbody>"},ie=function(I){var g,m=[];for(I.showWeekNumber&&m.push("<th></th>"),g=0;g<7;g++)m.push('<th scope="col"><abbr title="'+q(I,g)+'">'+q(I,g,!0)+"</abbr></th>");return"<thead><tr>"+(I.isRTL?m.reverse():m).join("")+"</tr></thead>"},he=function(I,g,m,_,C,R){var A,B,V,K=I._o,J=m===K.minYear,ee=m===K.maxYear,oe='<div id="'+R+'" class="pika-title" role="heading" aria-live="assertive">',ye,ae,se=!0,X=!0;for(V=[],A=0;A<12;A++)V.push('<option value="'+(m===C?A-g:12+A-g)+'"'+(A===_?' selected="selected"':"")+(J&&A<K.minMonth||ee&&A>K.maxMonth?' disabled="disabled"':"")+">"+K.i18n.months[A]+"</option>");for(ye='<div class="pika-label">'+K.i18n.months[_]+'<select class="pika-select pika-select-month" tabindex="-1">'+V.join("")+"</select></div>",h(K.yearRange)?(A=K.yearRange[0],B=K.yearRange[1]+1):(A=m-K.yearRange,B=1+m+K.yearRange),V=[];A<B&&A<=K.maxYear;A++)A>=K.minYear&&V.push('<option value="'+A+'"'+(A===m?' selected="selected"':"")+">"+A+"</option>");return ae='<div class="pika-label">'+m+K.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+V.join("")+"</select></div>",K.showMonthAfterYear?oe+=ae+ye:oe+=ye+ae,J&&(_===0||K.minMonth>=_)&&(se=!1),ee&&(_===11||K.maxMonth<=_)&&(X=!1),g===0&&(oe+='<button class="pika-prev'+(se?"":" is-disabled")+'" type="button">'+K.i18n.previousMonth+"</button>"),g===I._o.numberOfMonths-1&&(oe+='<button class="pika-next'+(X?"":" is-disabled")+'" type="button">'+K.i18n.nextMonth+"</button>"),oe+="</div>"},ce=function(I,g,m){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+m+'">'+ie(I)+Q(g)+"</table>"},fe=function(I){var g=this,m=g.config(I);g._onMouseDown=function(C){if(g._v){C=C||window.event;var R=C.target||C.srcElement;if(R)if(c(R,"is-disabled")||(c(R,"pika-button")&&!c(R,"is-empty")&&!c(R.parentNode,"is-disabled")?(g.setDate(new Date(R.getAttribute("data-pika-year"),R.getAttribute("data-pika-month"),R.getAttribute("data-pika-day"))),m.bound&&a(function(){g.hide(),m.blurFieldOnSelect&&m.field&&m.field.blur()},100)):c(R,"pika-prev")?g.prevMonth():c(R,"pika-next")&&g.nextMonth()),c(R,"pika-select"))g._c=!0;else if(C.preventDefault)C.preventDefault();else return C.returnValue=!1,!1}},g._onChange=function(C){C=C||window.event;var R=C.target||C.srcElement;R&&(c(R,"pika-select-month")?g.gotoMonth(R.value):c(R,"pika-select-year")&&g.gotoYear(R.value))},g._onKeyChange=function(C){if(C=C||window.event,g.isVisible())switch(C.keyCode){case 13:case 27:m.field&&m.field.blur();break;case 37:g.adjustDate("subtract",1);break;case 38:g.adjustDate("subtract",7);break;case 39:g.adjustDate("add",1);break;case 40:g.adjustDate("add",7);break;case 8:case 46:g.setDate(null);break}},g._parseFieldValue=function(){if(m.parse)return m.parse(m.field.value,m.format);if(n){var C=r(m.field.value,m.format,m.formatStrict);return C&&C.isValid()?C.toDate():null}else return new Date(Date.parse(m.field.value))},g._onInputChange=function(C){var R;C.firedBy!==g&&(R=g._parseFieldValue(),y(R)&&g.setDate(R),g._v||g.show())},g._onInputFocus=function(){g.show()},g._onInputClick=function(){g.show()},g._onInputBlur=function(){var C=i.activeElement;do if(c(C,"pika-single"))return;while(C=C.parentNode);g._c||(g._b=a(function(){g.hide()},50)),g._c=!1},g._onClick=function(C){C=C||window.event;var R=C.target||C.srcElement,A=R;if(R){!o&&c(R,"pika-select")&&(R.onchange||(R.setAttribute("onchange","return;"),s(R,"change",g._onChange)));do if(c(A,"pika-single")||A===m.trigger)return;while(A=A.parentNode);g._v&&R!==m.trigger&&A!==m.trigger&&g.hide()}},g.el=i.createElement("div"),g.el.className="pika-single"+(m.isRTL?" is-rtl":"")+(m.theme?" "+m.theme:""),s(g.el,"mousedown",g._onMouseDown,!0),s(g.el,"touchend",g._onMouseDown,!0),s(g.el,"change",g._onChange),m.keyboardInput&&s(i,"keydown",g._onKeyChange),m.field&&(m.container?m.container.appendChild(g.el):m.bound?i.body.appendChild(g.el):m.field.parentNode.insertBefore(g.el,m.field.nextSibling),s(m.field,"change",g._onInputChange),m.defaultDate||(m.defaultDate=g._parseFieldValue(),m.setDefaultDate=!0));var _=m.defaultDate;y(_)?m.setDefaultDate?g.setDate(_,!0):g.gotoDate(_):g.gotoDate(new Date),m.bound?(this.hide(),g.el.className+=" is-bound",s(m.trigger,"click",g._onInputClick),s(m.trigger,"focus",g._onInputFocus),s(m.trigger,"blur",g._onInputBlur)):this.show()};return fe.prototype={config:function(I){this._o||(this._o=P({},G,!0));var g=P(this._o,I,!0);g.isRTL=!!g.isRTL,g.field=g.field&&g.field.nodeName?g.field:null,g.theme=typeof g.theme=="string"&&g.theme?g.theme:null,g.bound=!!(g.bound!==void 0?g.field&&g.bound:g.field),g.trigger=g.trigger&&g.trigger.nodeName?g.trigger:g.field,g.disableWeekends=!!g.disableWeekends,g.disableDayFn=typeof g.disableDayFn=="function"?g.disableDayFn:null;var m=parseInt(g.numberOfMonths,10)||1;if(g.numberOfMonths=m>4?4:m,y(g.minDate)||(g.minDate=!1),y(g.maxDate)||(g.maxDate=!1),g.minDate&&g.maxDate&&g.maxDate<g.minDate&&(g.maxDate=g.minDate=!1),g.minDate&&this.setMinDate(g.minDate),g.maxDate&&this.setMaxDate(g.maxDate),h(g.yearRange)){var _=new Date().getFullYear()-10;g.yearRange[0]=parseInt(g.yearRange[0],10)||_,g.yearRange[1]=parseInt(g.yearRange[1],10)||_}else g.yearRange=Math.abs(parseInt(g.yearRange,10))||G.yearRange,g.yearRange>100&&(g.yearRange=100);return g},toString:function(I){return I=I||this._o.format,y(this._d)?this._o.toString?this._o.toString(this._d,I):n?r(this._d).format(I):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(I,g){n&&r.isMoment(I)&&this.setDate(I.toDate(),g)},getDate:function(){return y(this._d)?new Date(this._d.getTime()):null},setDate:function(I,g){if(!I)return this._d=null,this._o.field&&(this._o.field.value="",E(this._o.field,"change",{firedBy:this})),this.draw();if(typeof I=="string"&&(I=new Date(Date.parse(I))),!!y(I)){var m=this._o.minDate,_=this._o.maxDate;y(m)&&I<m?I=m:y(_)&&I>_&&(I=_),this._d=new Date(I.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),E(this._o.field,"change",{firedBy:this})),!g&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(I){var g=!0;if(y(I)){if(this.calendars){var m=new Date(this.calendars[0].year,this.calendars[0].month,1),_=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),C=I.getTime();_.setMonth(_.getMonth()+1),_.setDate(_.getDate()-1),g=C<m.getTime()||_.getTime()<C}g&&(this.calendars=[{month:I.getMonth(),year:I.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(I,g){var m=this.getDate()||new Date,_=parseInt(g)*24*60*60*1e3,C;I==="add"?C=new Date(m.valueOf()+_):I==="subtract"&&(C=new Date(m.valueOf()-_)),this.setDate(C)},adjustCalendars:function(){this.calendars[0]=j(this.calendars[0]);for(var I=1;I<this._o.numberOfMonths;I++)this.calendars[I]=j({month:this.calendars[0].month+I,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(I){isNaN(I)||(this.calendars[0].month=parseInt(I,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(I){isNaN(I)||(this.calendars[0].year=parseInt(I,10),this.adjustCalendars())},setMinDate:function(I){I instanceof Date?(S(I),this._o.minDate=I,this._o.minYear=I.getFullYear(),this._o.minMonth=I.getMonth()):(this._o.minDate=G.minDate,this._o.minYear=G.minYear,this._o.minMonth=G.minMonth,this._o.startRange=G.startRange),this.draw()},setMaxDate:function(I){I instanceof Date?(S(I),this._o.maxDate=I,this._o.maxYear=I.getFullYear(),this._o.maxMonth=I.getMonth()):(this._o.maxDate=G.maxDate,this._o.maxYear=G.maxYear,this._o.maxMonth=G.maxMonth,this._o.endRange=G.endRange),this.draw()},setStartRange:function(I){this._o.startRange=I},setEndRange:function(I){this._o.endRange=I},draw:function(I){if(!(!this._v&&!I)){var g=this._o,m=g.minYear,_=g.maxYear,C=g.minMonth,R=g.maxMonth,A="",B;this._y<=m&&(this._y=m,!isNaN(C)&&this._m<C&&(this._m=C)),this._y>=_&&(this._y=_,!isNaN(R)&&this._m>R&&(this._m=R));for(var V=0;V<g.numberOfMonths;V++)B="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),A+='<div class="pika-lendar">'+he(this,V,this.calendars[V].year,this.calendars[V].month,this.calendars[0].year,B)+this.render(this.calendars[V].year,this.calendars[V].month,B)+"</div>";this.el.innerHTML=A,g.bound&&g.field.type!=="hidden"&&a(function(){g.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),g.bound&&g.field.setAttribute("aria-label",g.ariaLabel)}},adjustPosition:function(){var I,g,m,_,C,R,A,B,V,K,J,ee;if(!this._o.container){if(this.el.style.position="absolute",I=this._o.trigger,g=I,m=this.el.offsetWidth,_=this.el.offsetHeight,C=window.innerWidth||i.documentElement.clientWidth,R=window.innerHeight||i.documentElement.clientHeight,A=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,J=!0,ee=!0,typeof I.getBoundingClientRect=="function")K=I.getBoundingClientRect(),B=K.left+window.pageXOffset,V=K.bottom+window.pageYOffset;else for(B=g.offsetLeft,V=g.offsetTop+g.offsetHeight;g=g.offsetParent;)B+=g.offsetLeft,V+=g.offsetTop;(this._o.reposition&&B+m>C||this._o.position.indexOf("right")>-1&&B-m+I.offsetWidth>0)&&(B=B-m+I.offsetWidth,J=!1),(this._o.reposition&&V+_>R+A||this._o.position.indexOf("top")>-1&&V-_-I.offsetHeight>0)&&(V=V-_-I.offsetHeight,ee=!1),this.el.style.left=B+"px",this.el.style.top=V+"px",f(this.el,J?"left-aligned":"right-aligned"),f(this.el,ee?"bottom-aligned":"top-aligned"),d(this.el,J?"right-aligned":"left-aligned"),d(this.el,ee?"top-aligned":"bottom-aligned")}},render:function(I,g,m){var _=this._o,C=new Date,R=b(I,g),A=new Date(I,g,1).getDay(),B=[],V=[];S(C),_.firstDay>0&&(A-=_.firstDay,A<0&&(A+=7));for(var K=g===0?11:g-1,J=g===11?0:g+1,ee=g===0?I-1:I,oe=g===11?I+1:I,ye=b(ee,K),ae=R+A,se=ae;se>7;)se-=7;ae+=7-se;for(var X=!1,_e=0,we=0;_e<ae;_e++){var ge=new Date(I,g,1+(_e-A)),me=y(this._d)?w(ge,this._d):!1,ve=w(ge,C),O=_.events.indexOf(ge.toDateString())!==-1,T=_e<A||_e>=R+A,k=1+(_e-A),L=g,M=I,F=_.startRange&&w(_.startRange,ge),N=_.endRange&&w(_.endRange,ge),D=_.startRange&&_.endRange&&_.startRange<ge&&ge<_.endRange,W=_.minDate&&ge<_.minDate||_.maxDate&&ge>_.maxDate||_.disableWeekends&&p(ge)||_.disableDayFn&&_.disableDayFn(ge);T&&(_e<A?(k=ye+k,L=K,M=ee):(k=k-R,L=J,M=oe));var H={day:k,month:L,year:M,hasEvent:O,isSelected:me,isToday:ve,isDisabled:W,isEmpty:T,isStartRange:F,isEndRange:N,isInRange:D,showDaysInNextAndPreviousMonths:_.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:_.enableSelectionDaysInNextAndPreviousMonths};_.pickWholeWeek&&me&&(X=!0),V.push(z(H)),++we===7&&(_.showWeekNumber&&V.unshift(Z(_e-A,g,I,_.firstWeekOfYearMinDays)),B.push(te(V,_.isRTL,_.pickWholeWeek,X)),V=[],we=0,X=!1)}return ce(_,B,m)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),d(this.el,"is-hidden"),this._o.bound&&(s(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var I=this._v;I!==!1&&(this._o.bound&&l(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),f(this.el,"is-hidden"),this._v=!1,I!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var I=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),I.keyboardInput&&l(i,"keydown",this._onKeyChange),I.field&&(l(I.field,"change",this._onInputChange),I.bound&&(l(I.trigger,"click",this._onInputClick),l(I.trigger,"focus",this._onInputFocus),l(I.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},fe})})(pikaday);const Pikaday=pikadayExports;function _typeof$1z(e){return _typeof$1z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1z(e)}function _classCallCheck$1u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1y(n.key),n)}}function _createClass$1u(e,t,r){return t&&_defineProperties$1u(e.prototype,t),r&&_defineProperties$1u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1y(e){var t=_toPrimitive$1y(e,"string");return _typeof$1z(t)==="symbol"?t:String(t)}function _toPrimitive$1y(e,t){if(_typeof$1z(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1z(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$M(){return typeof Reflect<"u"&&Reflect.get?_get$M=Reflect.get.bind():_get$M=function(t,r,n){var o=_superPropBase$M(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$M.apply(this,arguments)}function _superPropBase$M(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$V(e),e!==null););return e}function _inherits$V(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$V(e,t)}function _setPrototypeOf$V(e,t){return _setPrototypeOf$V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$V(e,t)}function _createSuper$V(e){var t=_isNativeReflectConstruct$V();return function(){var n=_getPrototypeOf$V(e),o;if(t){var i=_getPrototypeOf$V(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$V(this,o)}}function _possibleConstructorReturn$V(e,t){if(t&&(_typeof$1z(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$V(e)}function _assertThisInitialized$V(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$V(e){return _getPrototypeOf$V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$V(e)}var EDITOR_TYPE$5="date",SHORTCUTS_GROUP_EDITOR="dateEditor",DateEditor=function(e){_inherits$V(r,e);var t=_createSuper$V(r);function r(n){var o;return _classCallCheck$1u(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return _createClass$1u(r,[{key:"init",value:function(){var o=this;if(typeof hooks!="function")throw new Error("You need to include moment.js to your project.");if(typeof Pikaday!="function")throw new Error("You need to include Pikaday to your project.");_get$M(_getPrototypeOf$V(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){_get$M(_getPrototypeOf$V(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),addClass(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new EventManager$1(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,s,l,u){_get$M(_getPrototypeOf$V(r.prototype),"prepare",this).call(this,o,i,a,s,l,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");_get$M(_getPrototypeOf$V(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(l){l.stopPropagation()},group:SHORTCUTS_GROUP_EDITOR})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),s=a.getContext("editor");s.removeShortcutsByGroup(SHORTCUTS_GROUP_EDITOR),_get$M(_getPrototypeOf$V(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}_get$M(_getPrototypeOf$V(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),l=o?isFunctionKey(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new Pikaday(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+outerHeight(this.TD),"px");var c=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?c=i.right-outerWidth(this.datePicker):c=i.left,this.datePickerStyle.left="".concat(c,"px"),this.originalValue?(u=this.originalValue,hooks(u,a,!0).isValid()&&this.$datePicker.setMoment(hooks(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!l&&!s&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,hooks(u,a,!0).isValid()&&this.$datePicker.setMoment(hooks(u,a),!0),!l&&!s&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&deepExtend(a,this.cellProperties.datePickerConfig);var s=a.onSelect,l=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var c=u;isNaN(c.getTime())||(c=hooks(c).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(c),o.hideDatepicker(),s&&s()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),l&&l()},a}}],[{key:"EDITOR_TYPE",get:function(){return EDITOR_TYPE$5}}]),r}(TextEditor);function _typeof$1y(e){return _typeof$1y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1y(e)}function _classCallCheck$1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1x(n.key),n)}}function _createClass$1t(e,t,r){return t&&_defineProperties$1t(e.prototype,t),r&&_defineProperties$1t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1x(e){var t=_toPrimitive$1x(e,"string");return _typeof$1y(t)==="symbol"?t:String(t)}function _toPrimitive$1x(e,t){if(_typeof$1y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$L(){return typeof Reflect<"u"&&Reflect.get?_get$L=Reflect.get.bind():_get$L=function(t,r,n){var o=_superPropBase$L(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$L.apply(this,arguments)}function _superPropBase$L(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$U(e),e!==null););return e}function _inherits$U(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$U(e,t)}function _setPrototypeOf$U(e,t){return _setPrototypeOf$U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$U(e,t)}function _createSuper$U(e){var t=_isNativeReflectConstruct$U();return function(){var n=_getPrototypeOf$U(e),o;if(t){var i=_getPrototypeOf$U(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$U(this,o)}}function _possibleConstructorReturn$U(e,t){if(t&&(_typeof$1y(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$U(e)}function _assertThisInitialized$U(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$U(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$U(e){return _getPrototypeOf$U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$U(e)}var EDITOR_TYPE$4="dropdown",DropdownEditor=function(e){_inherits$U(r,e);var t=_createSuper$U(r);function r(){return _classCallCheck$1t(this,r),t.apply(this,arguments)}return _createClass$1t(r,[{key:"prepare",value:function(o,i,a,s,l,u){_get$L(_getPrototypeOf$U(r.prototype),"prepare",this).call(this,o,i,a,s,l,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return EDITOR_TYPE$4}}]),r}(AutocompleteEditor);Hooks$1.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===DropdownEditor&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function _typeof$1x(e){return _typeof$1x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1x(e)}function _classCallCheck$1s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1w(n.key),n)}}function _createClass$1s(e,t,r){return t&&_defineProperties$1s(e.prototype,t),r&&_defineProperties$1s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1w(e){var t=_toPrimitive$1w(e,"string");return _typeof$1x(t)==="symbol"?t:String(t)}function _toPrimitive$1w(e,t){if(_typeof$1x(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1x(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$T(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$T(e,t)}function _setPrototypeOf$T(e,t){return _setPrototypeOf$T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$T(e,t)}function _createSuper$T(e){var t=_isNativeReflectConstruct$T();return function(){var n=_getPrototypeOf$T(e),o;if(t){var i=_getPrototypeOf$T(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$T(this,o)}}function _possibleConstructorReturn$T(e,t){if(t&&(_typeof$1x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$T(e)}function _assertThisInitialized$T(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$T(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$T(e){return _getPrototypeOf$T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$T(e)}var EDITOR_TYPE$3="numeric",NumericEditor=function(e){_inherits$T(r,e);var t=_createSuper$T(r);function r(){return _classCallCheck$1s(this,r),t.apply(this,arguments)}return _createClass$1s(r,null,[{key:"EDITOR_TYPE",get:function(){return EDITOR_TYPE$3}}]),r}(TextEditor);function _typeof$1w(e){return _typeof$1w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1w(e)}function _classCallCheck$1r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1v(n.key),n)}}function _createClass$1r(e,t,r){return t&&_defineProperties$1r(e.prototype,t),r&&_defineProperties$1r(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1v(e){var t=_toPrimitive$1v(e,"string");return _typeof$1w(t)==="symbol"?t:String(t)}function _toPrimitive$1v(e,t){if(_typeof$1w(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1w(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$K(){return typeof Reflect<"u"&&Reflect.get?_get$K=Reflect.get.bind():_get$K=function(t,r,n){var o=_superPropBase$K(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$K.apply(this,arguments)}function _superPropBase$K(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$S(e),e!==null););return e}function _inherits$S(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$S(e,t)}function _setPrototypeOf$S(e,t){return _setPrototypeOf$S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$S(e,t)}function _createSuper$S(e){var t=_isNativeReflectConstruct$S();return function(){var n=_getPrototypeOf$S(e),o;if(t){var i=_getPrototypeOf$S(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$S(this,o)}}function _possibleConstructorReturn$S(e,t){if(t&&(_typeof$1w(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$S(e)}function _assertThisInitialized$S(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$S(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$S(e){return _getPrototypeOf$S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$S(e)}var EDITOR_TYPE$2="password",PasswordEditor=function(e){_inherits$S(r,e);var t=_createSuper$S(r);function r(){return _classCallCheck$1r(this,r),t.apply(this,arguments)}return _createClass$1r(r,[{key:"createElements",value:function(){_get$K(_getPrototypeOf$S(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return EDITOR_TYPE$2}}]),r}(TextEditor);function _typeof$1v(e){return _typeof$1v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1v(e)}function _classCallCheck$1q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1u(n.key),n)}}function _createClass$1q(e,t,r){return t&&_defineProperties$1q(e.prototype,t),r&&_defineProperties$1q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1u(e){var t=_toPrimitive$1u(e,"string");return _typeof$1v(t)==="symbol"?t:String(t)}function _toPrimitive$1u(e,t){if(_typeof$1v(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$J(){return typeof Reflect<"u"&&Reflect.get?_get$J=Reflect.get.bind():_get$J=function(t,r,n){var o=_superPropBase$J(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$J.apply(this,arguments)}function _superPropBase$J(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$R(e),e!==null););return e}function _inherits$R(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$R(e,t)}function _setPrototypeOf$R(e,t){return _setPrototypeOf$R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$R(e,t)}function _createSuper$R(e){var t=_isNativeReflectConstruct$R();return function(){var n=_getPrototypeOf$R(e),o;if(t){var i=_getPrototypeOf$R(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$R(this,o)}}function _possibleConstructorReturn$R(e,t){if(t&&(_typeof$1v(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$R(e)}function _assertThisInitialized$R(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$R(e){return _getPrototypeOf$R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$R(e)}var EDITOR_VISIBLE_CLASS_NAME="ht_editor_visible",SHORTCUTS_GROUP$5="selectEditor",EDITOR_TYPE$1="select",SelectEditor=function(e){_inherits$R(r,e);var t=_createSuper$R(r);function r(){return _classCallCheck$1q(this,r),t.apply(this,arguments)}return _createClass$1q(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",hasClass(this.select,EDITOR_VISIBLE_CLASS_NAME)&&removeClass(this.select,EDITOR_VISIBLE_CLASS_NAME),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,s,l,u){var c=this;_get$J(_getPrototypeOf$R(r.prototype),"prepare",this).call(this,o,i,a,s,l,u);var f=this.cellProperties.selectOptions,d;typeof f=="function"?d=this.prepareOptions(f(this.row,this.col,this.prop)):d=this.prepareOptions(f),empty(this.select),objectEach(d,function(h,y){var p=c.hot.rootDocument.createElement("OPTION");p.value=y,fastInnerHTML(p,h),c.select.appendChild(p)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,s=o.length;a<s;a++)i[o[a]]=o[a];else _typeof$1v(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===EDITOR_STATE.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,s=o.width,l=o.height,u=this.select.style;u.height="".concat(l,"px"),u.width="".concat(s,"px"),u.top="".concat(i,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",addClass(this.select,EDITOR_VISIBLE_CLASS_NAME)}}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),s={group:SHORTCUTS_GROUP$5};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=o.select.selectedIndex-1;u>=0&&(o.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=o.select.selectedIndex+1;u<=o.select.length-1&&(o.select[u].selected=!0)}}],s)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(SHORTCUTS_GROUP$5)}}],[{key:"EDITOR_TYPE",get:function(){return EDITOR_TYPE$1}}]),r}(BaseEditor);function _typeof$1u(e){return _typeof$1u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1u(e)}function _classCallCheck$1p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1t(n.key),n)}}function _createClass$1p(e,t,r){return t&&_defineProperties$1p(e.prototype,t),r&&_defineProperties$1p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1t(e){var t=_toPrimitive$1t(e,"string");return _typeof$1u(t)==="symbol"?t:String(t)}function _toPrimitive$1t(e,t){if(_typeof$1u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$I(){return typeof Reflect<"u"&&Reflect.get?_get$I=Reflect.get.bind():_get$I=function(t,r,n){var o=_superPropBase$I(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$I.apply(this,arguments)}function _superPropBase$I(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$Q(e),e!==null););return e}function _inherits$Q(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$Q(e,t)}function _setPrototypeOf$Q(e,t){return _setPrototypeOf$Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$Q(e,t)}function _createSuper$Q(e){var t=_isNativeReflectConstruct$Q();return function(){var n=_getPrototypeOf$Q(e),o;if(t){var i=_getPrototypeOf$Q(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$Q(this,o)}}function _possibleConstructorReturn$Q(e,t){if(t&&(_typeof$1u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$Q(e)}function _assertThisInitialized$Q(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$Q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$Q(e){return _getPrototypeOf$Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$Q(e)}var EDITOR_TYPE="time",TimeEditor=function(e){_inherits$Q(r,e);var t=_createSuper$Q(r);function r(){return _classCallCheck$1p(this,r),t.apply(this,arguments)}return _createClass$1p(r,[{key:"prepare",value:function(o,i,a,s,l,u){_get$I(_getPrototypeOf$Q(r.prototype),"prepare",this).call(this,o,i,a,s,l,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return EDITOR_TYPE}}]),r}(TextEditor);function registerAllEditors(){_register$3(BaseEditor),_register$3(AutocompleteEditor),_register$3(CheckboxEditor),_register$3(DateEditor),_register$3(DropdownEditor),_register$3(HandsontableEditor),_register$3(NumericEditor),_register$3(PasswordEditor),_register$3(SelectEditor),_register$3(TextEditor),_register$3(TimeEditor)}var RENDERER_TYPE$5="html";function htmlRenderer(e,t,r,n,o,i,a){baseRenderer.apply(this,[e,t,r,n,o,i,a]),fastInnerHTML(t,i??"",!1)}htmlRenderer.RENDERER_TYPE=RENDERER_TYPE$5;var RENDERER_TYPE$4="autocomplete";function autocompleteRenderer(e,t,r,n,o,i,a){var s=e.rootDocument,l=a.allowHtml?htmlRenderer:textRenderer,u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(s.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),addClass(t,"htAutocomplete"),!e.acArrowListener){var c=new EventManager$1(e);e.acArrowListener=function(f){hasClass(f.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},c.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){c.destroy()})}}autocompleteRenderer.RENDERER_TYPE=RENDERER_TYPE$4;var isListeningKeyDownEvent=new WeakMap,isCheckboxListenerAdded=new WeakMap,BAD_VALUE_CLASS="htBadValue",ATTR_ROW="data-row",ATTR_COLUMN="data-col",SHORTCUTS_GROUP$4="checkboxRenderer",RENDERER_TYPE$3="checkbox";Hooks$1.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,s=t.prop;if(o===RENDERER_TYPE$3){if(n){var l=n.value,u=n.property,c=r;if(l)c=typeof l=="function"?l(i,a,s,r):l;else if(u){var f=this.getDataAtRowProp(i,u);c=f!==null?f:r}e=c}return e}});function checkboxRenderer(e,t,r,n,o,i,a){var s=e.rootDocument;baseRenderer.apply(this,[e,t,r,n,o,i,a]),registerEvents(e);var l=createInput(s),u=a.label,c=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),empty(t),i===a.checkedTemplate||stringify$1(i).toLocaleLowerCase(a.locale)===stringify$1(a.checkedTemplate).toLocaleLowerCase(a.locale)?l.checked=!0:i===a.uncheckedTemplate||stringify$1(i).toLocaleLowerCase(a.locale)===stringify$1(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?l.checked=!1:isEmpty(i)?addClass(l,"noValue"):(l.style.display="none",addClass(l,BAD_VALUE_CLASS),c=!0),l.setAttribute(ATTR_ROW,r),l.setAttribute(ATTR_COLUMN,n),!c&&u){var f="";if(u.value)f=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var d=e.getDataAtRowProp(r,u.property);f=d!==null?d:""}var h=createLabel(s,f,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(h),t.appendChild(l)):(h.appendChild(l),l=h):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(l),t.appendChild(h)):(h.insertBefore(l,h.firstChild),l=h))}(!u||u&&!u.separated)&&t.appendChild(l),c&&t.appendChild(s.createTextNode("#bad-value#")),isListeningKeyDownEvent.has(e)||(isListeningKeyDownEvent.set(e,!0),y());function y(){var b=e.getShortcutManager(),S=b.getContext("grid"),w={group:SHORTCUTS_GROUP$4};S.addShortcuts([{keys:[["space"]],callback:function(){return p(),!v()}},{keys:[["enter"]],callback:function(){return p(),!v()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return p(!0),!v()},relativeToGroup:SHORTCUTS_GROUP_EDITOR$2,position:"before"}],w)}function p(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=e.getSelectedRange();if(S)for(var w=0;w<S.length;w++){for(var P=S[w].getTopStartCorner(),E=P.row,j=P.col,G=S[w].getBottomEndCorner(),q=G.row,z=G.col,U=[],Z=E;Z<=q;Z+=1)for(var te=j;te<=z;te+=1){var Q=e.getCellMeta(Z,te);if(Q.type!=="checkbox")return;if(Q.readOnly!==!0){typeof Q.checkedTemplate>"u"&&(Q.checkedTemplate=!0),typeof Q.uncheckedTemplate>"u"&&(Q.uncheckedTemplate=!1);var ie=e.getDataAtCell(Z,te);b===!1?[Q.checkedTemplate,Q.checkedTemplate.toString()].includes(ie)?U.push([Z,te,Q.uncheckedTemplate]):[Q.uncheckedTemplate,Q.uncheckedTemplate.toString(),null,void 0].includes(ie)&&U.push([Z,te,Q.checkedTemplate]):U.push([Z,te,Q.uncheckedTemplate])}}U.length>0&&e.setDataAtCell(U)}}function v(){var b=e.getSelectedRange();if(b){for(var S=0;S<b.length;S++)for(var w=b[S].getTopStartCorner(),P=b[S].getBottomEndCorner(),E=w.row;E<=P.row;E++)for(var j=w.col;j<=P.col;j++){var G=e.getCellMeta(E,j);if(G.type!=="checkbox")return!1;var q=e.getCell(E,j);if(q==null)return!0;var z=q.querySelectorAll("input[type=checkbox]");if(z.length>0&&!G.readOnly)return!0}return!1}}}checkboxRenderer.RENDERER_TYPE=RENDERER_TYPE$3;function registerEvents(e){var t=isCheckboxListenerAdded.get(e);if(!t){var r=e.rootElement;t=new EventManager$1(e),t.addEventListener(r,"click",function(n){return onClick(n,e)}),t.addEventListener(r,"mouseup",function(n){return onMouseUp(n,e)}),t.addEventListener(r,"change",function(n){return onChange(n,e)}),isCheckboxListenerAdded.set(e,t)}return t}function createInput(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function createLabel(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function onMouseUp(e,t){var r=e.target;isCheckboxInput(r)&&(!r.hasAttribute(ATTR_ROW)||!r.hasAttribute(ATTR_COLUMN)||setTimeout(t.listen,10))}function onClick(e,t){var r=e.target;if(isCheckboxInput(r)&&!(!r.hasAttribute(ATTR_ROW)||!r.hasAttribute(ATTR_COLUMN))){var n=parseInt(r.getAttribute(ATTR_ROW),10),o=parseInt(r.getAttribute(ATTR_COLUMN),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function onChange(e,t){var r=e.target;if(isCheckboxInput(r)&&!(!r.hasAttribute(ATTR_ROW)||!r.hasAttribute(ATTR_COLUMN))){var n=parseInt(r.getAttribute(ATTR_ROW),10),o=parseInt(r.getAttribute(ATTR_COLUMN),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function isCheckboxInput(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var numbro_minExports={},numbro_min={get exports(){return numbro_minExports},set exports(e){numbro_minExports=e}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,c){if(!o[u]){if(!n[u]){var f=typeof commonjsRequire=="function"&&commonjsRequire;if(!c&&f)return f(u,!0);if(s)return s(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var h=o[u]={exports:{}};n[u][0].call(h.exports,function(y){return a(n[u][1][y]||y)},h,h.exports,r,n,o,i)}return o[u].exports}for(var s=typeof commonjsRequire=="function"&&commonjsRequire,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(r,n,o){(function(i){var a,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",f=c+"Number primitive has more than 15 significant digits: ",d=1e14,h=14,y=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,b=1e9;function S(z){var U=0|z;return 0<z||z===U?U:U-1}function w(z){for(var U,Z,te=1,Q=z.length,ie=z[0]+"";te<Q;){for(U=z[te++]+"",Z=h-U.length;Z--;U="0"+U);ie+=U}for(Q=ie.length;ie.charCodeAt(--Q)===48;);return ie.slice(0,Q+1||1)}function P(z,U){var Z,te,Q=z.c,ie=U.c,he=z.s,ce=U.s,fe=z.e,I=U.e;if(!he||!ce)return null;if(Z=Q&&!Q[0],te=ie&&!ie[0],Z||te)return Z?te?0:-ce:he;if(he!=ce)return he;if(Z=he<0,te=fe==I,!Q||!ie)return te?0:!Q^Z?1:-1;if(!te)return I<fe^Z?1:-1;for(ce=(fe=Q.length)<(I=ie.length)?fe:I,he=0;he<ce;he++)if(Q[he]!=ie[he])return Q[he]>ie[he]^Z?1:-1;return fe==I?0:I<fe^Z?1:-1}function E(z,U,Z,te){if(z<U||Z<z||z!==(z<0?l(z):u(z)))throw Error(c+(te||"Argument")+(typeof z=="number"?z<U||Z<z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(z))}function j(z){var U=z.c.length-1;return S(z.e/h)==U&&z.c[U]%2!=0}function G(z,U){return(1<z.length?z.charAt(0)+"."+z.slice(1):z)+(U<0?"e":"e+")+U}function q(z,U,Z){var te,Q;if(U<0){for(Q=Z+".";++U;Q+=Z);z=Q+z}else if(++U>(te=z.length)){for(Q=Z,U-=te;--U;Q+=Z);z+=Q}else U<te&&(z=z.slice(0,U)+"."+z.slice(U));return z}(a=function z(U){var Z,te,Q,ie,he,ce,fe,I,g,m,_=X.prototype={constructor:X,toString:null,valueOf:null},C=new X(1),R=20,A=4,B=-7,V=21,K=-1e7,J=1e7,ee=!1,oe=1,ye=0,ae={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},se="0123456789abcdefghijklmnopqrstuvwxyz";function X(O,T){var k,L,M,F,N,D,W,H,Y=this;if(!(Y instanceof X))return new X(O,T);if(T==null){if(O instanceof X)return Y.s=O.s,Y.e=O.e,void(Y.c=(O=O.c)?O.slice():O);if((D=typeof O=="number")&&0*O==0){if(Y.s=1/O<0?(O=-O,-1):1,O===~~O){for(F=0,N=O;10<=N;N/=10,F++);return Y.e=F,void(Y.c=[O])}H=String(O)}else{if(H=String(O),!s.test(H))return Q(Y,H,D);Y.s=H.charCodeAt(0)==45?(H=H.slice(1),-1):1}-1<(F=H.indexOf("."))&&(H=H.replace(".","")),0<(N=H.search(/e/i))?(F<0&&(F=N),F+=+H.slice(N+1),H=H.substring(0,N)):F<0&&(F=H.length)}else{if(E(T,2,se.length,"Base"),H=String(O),T==10)return me(Y=new X(O instanceof X?O:H),R+Y.e+1,A);if(D=typeof O=="number"){if(0*O!=0)return Q(Y,H,D,T);if(Y.s=1/O<0?(H=H.slice(1),-1):1,X.DEBUG&&15<H.replace(/^0\.0*|\./,"").length)throw Error(f+O);D=!1}else Y.s=H.charCodeAt(0)===45?(H=H.slice(1),-1):1;for(k=se.slice(0,T),F=N=0,W=H.length;N<W;N++)if(k.indexOf(L=H.charAt(N))<0){if(L=="."){if(F<N){F=W;continue}}else if(!M&&(H==H.toUpperCase()&&(H=H.toLowerCase())||H==H.toLowerCase()&&(H=H.toUpperCase()))){M=!0,N=-1,F=0;continue}return Q(Y,String(O),D,T)}-1<(F=(H=te(H,T,10,Y.s)).indexOf("."))?H=H.replace(".",""):F=H.length}for(N=0;H.charCodeAt(N)===48;N++);for(W=H.length;H.charCodeAt(--W)===48;);if(H=H.slice(N,++W)){if(W-=N,D&&X.DEBUG&&15<W&&(y<O||O!==u(O)))throw Error(f+Y.s*O);if(J<(F=F-N-1))Y.c=Y.e=null;else if(F<K)Y.c=[Y.e=0];else{if(Y.e=F,Y.c=[],N=(F+1)%h,F<0&&(N+=h),N<W){for(N&&Y.c.push(+H.slice(0,N)),W-=h;N<W;)Y.c.push(+H.slice(N,N+=h));H=H.slice(N),N=h-H.length}else N-=W;for(;N--;H+="0");Y.c.push(+H)}}else Y.c=[Y.e=0]}function _e(O,T,k,L){var M,F,N,D,W;if(k==null?k=A:E(k,0,8),!O.c)return O.toString();if(M=O.c[0],N=O.e,T==null)W=w(O.c),W=L==1||L==2&&(N<=B||V<=N)?G(W,N):q(W,N,"0");else if(F=(O=me(new X(O),T,k)).e,D=(W=w(O.c)).length,L==1||L==2&&(T<=F||F<=B)){for(;D<T;W+="0",D++);W=G(W,F)}else if(T-=N,W=q(W,F,"0"),D<F+1){if(0<--T)for(W+=".";T--;W+="0");}else if(0<(T+=F-D))for(F+1==D&&(W+=".");T--;W+="0");return O.s<0&&M?"-"+W:W}function we(O,T){for(var k,L=1,M=new X(O[0]);L<O.length;L++){if(!(k=new X(O[L])).s){M=k;break}T.call(M,k)&&(M=k)}return M}function ge(O,T,k){for(var L=1,M=T.length;!T[--M];T.pop());for(M=T[0];10<=M;M/=10,L++);return(k=L+k*h-1)>J?O.c=O.e=null:O.c=k<K?[O.e=0]:(O.e=k,T),O}function me(O,T,k,L){var M,F,N,D,W,H,Y,ne=O.c,ue=p;if(ne){e:{for(M=1,D=ne[0];10<=D;D/=10,M++);if((F=T-M)<0)F+=h,N=T,Y=(W=ne[H=0])/ue[M-N-1]%10|0;else if((H=l((F+1)/h))>=ne.length){if(!L)break e;for(;ne.length<=H;ne.push(0));W=Y=0,N=(F%=h)-h+(M=1)}else{for(W=D=ne[H],M=1;10<=D;D/=10,M++);Y=(N=(F%=h)-h+M)<0?0:W/ue[M-N-1]%10|0}if(L=L||T<0||ne[H+1]!=null||(N<0?W:W%ue[M-N-1]),L=k<4?(Y||L)&&(k==0||k==(O.s<0?3:2)):5<Y||Y==5&&(k==4||L||k==6&&(0<F?0<N?W/ue[M-N]:0:ne[H-1])%10&1||k==(O.s<0?8:7)),T<1||!ne[0])return ne.length=0,L?(T-=O.e+1,ne[0]=ue[(h-T%h)%h],O.e=-T||0):ne[0]=O.e=0,O;if(F==0?(ne.length=H,D=1,H--):(ne.length=H+1,D=ue[h-F],ne[H]=0<N?u(W/ue[M-N]%ue[N])*D:0),L)for(;;){if(H==0){for(F=1,N=ne[0];10<=N;N/=10,F++);for(N=ne[0]+=D,D=1;10<=N;N/=10,D++);F!=D&&(O.e++,ne[0]==d&&(ne[0]=1));break}if(ne[H]+=D,ne[H]!=d)break;ne[H--]=0,D=1}for(F=ne.length;ne[--F]===0;ne.pop());}O.e>J?O.c=O.e=null:O.e<K&&(O.c=[O.e=0])}return O}function ve(O){var T,k=O.e;return k===null?O.toString():(T=w(O.c),T=k<=B||V<=k?G(T,k):q(T,k,"0"),O.s<0?"-"+T:T)}return X.clone=z,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(O){var T,k;if(O!=null){if(typeof O!="object")throw Error(c+"Object expected: "+O);if(O.hasOwnProperty(T="DECIMAL_PLACES")&&(E(k=O[T],0,b,T),R=k),O.hasOwnProperty(T="ROUNDING_MODE")&&(E(k=O[T],0,8,T),A=k),O.hasOwnProperty(T="EXPONENTIAL_AT")&&((k=O[T])&&k.pop?(E(k[0],-b,0,T),E(k[1],0,b,T),B=k[0],V=k[1]):(E(k,-b,b,T),B=-(V=k<0?-k:k))),O.hasOwnProperty(T="RANGE"))if((k=O[T])&&k.pop)E(k[0],-b,-1,T),E(k[1],1,b,T),K=k[0],J=k[1];else{if(E(k,-b,b,T),!k)throw Error(c+T+" cannot be zero: "+k);K=-(J=k<0?-k:k)}if(O.hasOwnProperty(T="CRYPTO")){if((k=O[T])!==!!k)throw Error(c+T+" not true or false: "+k);if(k){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw ee=!k,Error(c+"crypto unavailable");ee=k}else ee=k}if(O.hasOwnProperty(T="MODULO_MODE")&&(E(k=O[T],0,9,T),oe=k),O.hasOwnProperty(T="POW_PRECISION")&&(E(k=O[T],0,b,T),ye=k),O.hasOwnProperty(T="FORMAT")){if(typeof(k=O[T])!="object")throw Error(c+T+" not an object: "+k);ae=k}if(O.hasOwnProperty(T="ALPHABET")){if(typeof(k=O[T])!="string"||/^.$|[+-.\s]|(.).*\1/.test(k))throw Error(c+T+" invalid: "+k);se=k}}return{DECIMAL_PLACES:R,ROUNDING_MODE:A,EXPONENTIAL_AT:[B,V],RANGE:[K,J],CRYPTO:ee,MODULO_MODE:oe,POW_PRECISION:ye,FORMAT:ae,ALPHABET:se}},X.isBigNumber=function(O){return O instanceof X||O&&O._isBigNumber===!0||!1},X.maximum=X.max=function(){return we(arguments,_.lt)},X.minimum=X.min=function(){return we(arguments,_.gt)},X.random=(ie=9007199254740992,he=Math.random()*ie&2097151?function(){return u(Math.random()*ie)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(O){var T,k,L,M,F,N=0,D=[],W=new X(C);if(O==null?O=R:E(O,0,b),M=l(O/h),ee)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(M*=2));N<M;)9e15<=(F=131072*T[N]+(T[N+1]>>>11))?(k=crypto.getRandomValues(new Uint32Array(2)),T[N]=k[0],T[N+1]=k[1]):(D.push(F%1e14),N+=2);N=M/2}else{if(!crypto.randomBytes)throw ee=!1,Error(c+"crypto unavailable");for(T=crypto.randomBytes(M*=7);N<M;)9e15<=(F=281474976710656*(31&T[N])+1099511627776*T[N+1]+4294967296*T[N+2]+16777216*T[N+3]+(T[N+4]<<16)+(T[N+5]<<8)+T[N+6])?crypto.randomBytes(7).copy(T,N):(D.push(F%1e14),N+=7);N=M/7}if(!ee)for(;N<M;)(F=he())<9e15&&(D[N++]=F%1e14);for(M=D[--N],O%=h,M&&O&&(F=p[h-O],D[N]=u(M/F)*F);D[N]===0;D.pop(),N--);if(N<0)D=[L=0];else{for(L=-1;D[0]===0;D.splice(0,1),L-=h);for(N=1,F=D[0];10<=F;F/=10,N++);N<h&&(L-=h-N)}return W.e=L,W.c=D,W}),X.sum=function(){for(var O=1,T=arguments,k=new X(T[0]);O<T.length;)k=k.plus(T[O++]);return k},te=function(){var O="0123456789";function T(k,L,M,F){for(var N,D,W=[0],H=0,Y=k.length;H<Y;){for(D=W.length;D--;W[D]*=L);for(W[0]+=F.indexOf(k.charAt(H++)),N=0;N<W.length;N++)W[N]>M-1&&(W[N+1]==null&&(W[N+1]=0),W[N+1]+=W[N]/M|0,W[N]%=M)}return W.reverse()}return function(k,L,M,F,N){var D,W,H,Y,ne,ue,de,be,Oe=k.indexOf("."),Me=R,$e=A;for(0<=Oe&&(Y=ye,ye=0,k=k.replace(".",""),ue=(be=new X(L)).pow(k.length-Oe),ye=Y,be.c=T(q(w(ue.c),ue.e,"0"),10,M,O),be.e=be.c.length),H=Y=(de=T(k,L,M,N?(D=se,O):(D=O,se))).length;de[--Y]==0;de.pop());if(!de[0])return D.charAt(0);if(Oe<0?--H:(ue.c=de,ue.e=H,ue.s=F,de=(ue=Z(ue,be,Me,$e,M)).c,ne=ue.r,H=ue.e),Oe=de[W=H+Me+1],Y=M/2,ne=ne||W<0||de[W+1]!=null,ne=$e<4?(Oe!=null||ne)&&($e==0||$e==(ue.s<0?3:2)):Y<Oe||Oe==Y&&($e==4||ne||$e==6&&1&de[W-1]||$e==(ue.s<0?8:7)),W<1||!de[0])k=ne?q(D.charAt(1),-Me,D.charAt(0)):D.charAt(0);else{if(de.length=W,ne)for(--M;++de[--W]>M;)de[W]=0,W||(++H,de=[1].concat(de));for(Y=de.length;!de[--Y];);for(Oe=0,k="";Oe<=Y;k+=D.charAt(de[Oe++]));k=q(k,H,D.charAt(0))}return k}}(),Z=function(){function O(L,M,F){var N,D,W,H,Y=0,ne=L.length,ue=M%v,de=M/v|0;for(L=L.slice();ne--;)Y=((D=ue*(W=L[ne]%v)+(N=de*W+(H=L[ne]/v|0)*ue)%v*v+Y)/F|0)+(N/v|0)+de*H,L[ne]=D%F;return Y&&(L=[Y].concat(L)),L}function T(L,M,F,N){var D,W;if(F!=N)W=N<F?1:-1;else for(D=W=0;D<F;D++)if(L[D]!=M[D]){W=L[D]>M[D]?1:-1;break}return W}function k(L,M,F,N){for(var D=0;F--;)L[F]-=D,D=L[F]<M[F]?1:0,L[F]=D*N+L[F]-M[F];for(;!L[0]&&1<L.length;L.splice(0,1));}return function(L,M,F,N,D){var W,H,Y,ne,ue,de,be,Oe,Me,$e,Se,Te,Ie,Pe,Ce,Ee,De,Ne=L.s==M.s?1:-1,ke=L.c,Re=M.c;if(!(ke&&ke[0]&&Re&&Re[0]))return new X(L.s&&M.s&&(ke?!Re||ke[0]!=Re[0]:Re)?ke&&ke[0]==0||!Re?0*Ne:Ne/0:NaN);for(Me=(Oe=new X(Ne)).c=[],Ne=F+(H=L.e-M.e)+1,D||(D=d,H=S(L.e/h)-S(M.e/h),Ne=Ne/h|0),Y=0;Re[Y]==(ke[Y]||0);Y++);if(Re[Y]>(ke[Y]||0)&&H--,Ne<0)Me.push(1),ne=!0;else{for(Pe=ke.length,Ee=Re.length,Ne+=2,1<(ue=u(D/(Re[Y=0]+1)))&&(Re=O(Re,ue,D),ke=O(ke,ue,D),Ee=Re.length,Pe=ke.length),Ie=Ee,Se=($e=ke.slice(0,Ee)).length;Se<Ee;$e[Se++]=0);De=Re.slice(),De=[0].concat(De),Ce=Re[0],Re[1]>=D/2&&Ce++;do{if(ue=0,(W=T(Re,$e,Ee,Se))<0){if(Te=$e[0],Ee!=Se&&(Te=Te*D+($e[1]||0)),1<(ue=u(Te/Ce)))for(D<=ue&&(ue=D-1),be=(de=O(Re,ue,D)).length,Se=$e.length;T(de,$e,be,Se)==1;)ue--,k(de,Ee<be?De:Re,be,D),be=de.length,W=1;else ue==0&&(W=ue=1),be=(de=Re.slice()).length;if(be<Se&&(de=[0].concat(de)),k($e,de,Se,D),Se=$e.length,W==-1)for(;T(Re,$e,Ee,Se)<1;)ue++,k($e,Ee<Se?De:Re,Se,D),Se=$e.length}else W===0&&(ue++,$e=[0]);Me[Y++]=ue,$e[0]?$e[Se++]=ke[Ie]||0:($e=[ke[Ie]],Se=1)}while((Ie++<Pe||$e[0]!=null)&&Ne--);ne=$e[0]!=null,Me[0]||Me.splice(0,1)}if(D==d){for(Y=1,Ne=Me[0];10<=Ne;Ne/=10,Y++);me(Oe,F+(Oe.e=Y+H*h-1)+1,N,ne)}else Oe.e=H,Oe.r=+ne;return Oe}}(),ce=/^(-?)0([xbo])(?=\w[\w.]*$)/i,fe=/^([^.]+)\.$/,I=/^\.([^.]+)$/,g=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,Q=function(O,T,k,L){var M,F=k?T:T.replace(m,"");if(g.test(F))O.s=isNaN(F)?null:F<0?-1:1,O.c=O.e=null;else{if(!k&&(F=F.replace(ce,function(N,D,W){return M=(W=W.toLowerCase())=="x"?16:W=="b"?2:8,L&&L!=M?N:D}),L&&(M=L,F=F.replace(fe,"$1").replace(I,"0.$1")),T!=F))return new X(F,M);if(X.DEBUG)throw Error(c+"Not a"+(L?" base "+L:"")+" number: "+T);O.c=O.e=O.s=null}},_.absoluteValue=_.abs=function(){var O=new X(this);return O.s<0&&(O.s=1),O},_.comparedTo=function(O,T){return P(this,new X(O,T))},_.decimalPlaces=_.dp=function(O,T){var k,L,M;if(O!=null)return E(O,0,b),T==null?T=A:E(T,0,8),me(new X(this),O+this.e+1,T);if(!(k=this.c))return null;if(L=((M=k.length-1)-S(this.e/h))*h,M=k[M])for(;M%10==0;M/=10,L--);return L<0&&(L=0),L},_.dividedBy=_.div=function(O,T){return Z(this,new X(O,T),R,A)},_.dividedToIntegerBy=_.idiv=function(O,T){return Z(this,new X(O,T),0,1)},_.exponentiatedBy=_.pow=function(O,T){var k,L,M,F,N,D,W,H,Y=this;if((O=new X(O)).c&&!O.isInteger())throw Error(c+"Exponent not an integer: "+ve(O));if(T!=null&&(T=new X(T)),N=14<O.e,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!O.c||!O.c[0])return H=new X(Math.pow(+ve(Y),N?2-j(O):+ve(O))),T?H.mod(T):H;if(D=O.s<0,T){if(T.c?!T.c[0]:!T.s)return new X(NaN);(L=!D&&Y.isInteger()&&T.isInteger())&&(Y=Y.mod(T))}else{if(9<O.e&&(0<Y.e||Y.e<-1||(Y.e==0?1<Y.c[0]||N&&24e7<=Y.c[1]:Y.c[0]<8e13||N&&Y.c[0]<=9999975e7)))return F=Y.s<0&&j(O)?-0:0,-1<Y.e&&(F=1/F),new X(D?1/F:F);ye&&(F=l(ye/h+2))}for(W=N?(k=new X(.5),D&&(O.s=1),j(O)):(M=Math.abs(+ve(O)))%2,H=new X(C);;){if(W){if(!(H=H.times(Y)).c)break;F?H.c.length>F&&(H.c.length=F):L&&(H=H.mod(T))}if(M){if((M=u(M/2))===0)break;W=M%2}else if(me(O=O.times(k),O.e+1,1),14<O.e)W=j(O);else{if((M=+ve(O))==0)break;W=M%2}Y=Y.times(Y),F?Y.c&&Y.c.length>F&&(Y.c.length=F):L&&(Y=Y.mod(T))}return L?H:(D&&(H=C.div(H)),T?H.mod(T):F?me(H,ye,A,void 0):H)},_.integerValue=function(O){var T=new X(this);return O==null?O=A:E(O,0,8),me(T,T.e+1,O)},_.isEqualTo=_.eq=function(O,T){return P(this,new X(O,T))===0},_.isFinite=function(){return!!this.c},_.isGreaterThan=_.gt=function(O,T){return 0<P(this,new X(O,T))},_.isGreaterThanOrEqualTo=_.gte=function(O,T){return(T=P(this,new X(O,T)))===1||T===0},_.isInteger=function(){return!!this.c&&S(this.e/h)>this.c.length-2},_.isLessThan=_.lt=function(O,T){return P(this,new X(O,T))<0},_.isLessThanOrEqualTo=_.lte=function(O,T){return(T=P(this,new X(O,T)))===-1||T===0},_.isNaN=function(){return!this.s},_.isNegative=function(){return this.s<0},_.isPositive=function(){return 0<this.s},_.isZero=function(){return!!this.c&&this.c[0]==0},_.minus=function(O,T){var k,L,M,F,N=this,D=N.s;if(T=(O=new X(O,T)).s,!D||!T)return new X(NaN);if(D!=T)return O.s=-T,N.plus(O);var W=N.e/h,H=O.e/h,Y=N.c,ne=O.c;if(!W||!H){if(!Y||!ne)return Y?(O.s=-T,O):new X(ne?N:NaN);if(!Y[0]||!ne[0])return ne[0]?(O.s=-T,O):new X(Y[0]?N:A==3?-0:0)}if(W=S(W),H=S(H),Y=Y.slice(),D=W-H){for((M=(F=D<0)?(D=-D,Y):(H=W,ne)).reverse(),T=D;T--;M.push(0));M.reverse()}else for(L=(F=(D=Y.length)<(T=ne.length))?D:T,D=T=0;T<L;T++)if(Y[T]!=ne[T]){F=Y[T]<ne[T];break}if(F&&(M=Y,Y=ne,ne=M,O.s=-O.s),0<(T=(L=ne.length)-(k=Y.length)))for(;T--;Y[k++]=0);for(T=d-1;D<L;){if(Y[--L]<ne[L]){for(k=L;k&&!Y[--k];Y[k]=T);--Y[k],Y[L]+=d}Y[L]-=ne[L]}for(;Y[0]==0;Y.splice(0,1),--H);return Y[0]?ge(O,Y,H):(O.s=A==3?-1:1,O.c=[O.e=0],O)},_.modulo=_.mod=function(O,T){var k,L,M=this;return O=new X(O,T),!M.c||!O.s||O.c&&!O.c[0]?new X(NaN):!O.c||M.c&&!M.c[0]?new X(M):(oe==9?(L=O.s,O.s=1,k=Z(M,O,0,3),O.s=L,k.s*=L):k=Z(M,O,0,oe),(O=M.minus(k.times(O))).c[0]||oe!=1||(O.s=M.s),O)},_.multipliedBy=_.times=function(O,T){var k,L,M,F,N,D,W,H,Y,ne,ue,de,be,Oe,Me,$e=this,Se=$e.c,Te=(O=new X(O,T)).c;if(!(Se&&Te&&Se[0]&&Te[0]))return!$e.s||!O.s||Se&&!Se[0]&&!Te||Te&&!Te[0]&&!Se?O.c=O.e=O.s=null:(O.s*=$e.s,Se&&Te?(O.c=[0],O.e=0):O.c=O.e=null),O;for(L=S($e.e/h)+S(O.e/h),O.s*=$e.s,(W=Se.length)<(ne=Te.length)&&(be=Se,Se=Te,Te=be,M=W,W=ne,ne=M),M=W+ne,be=[];M--;be.push(0));for(Oe=d,Me=v,M=ne;0<=--M;){for(k=0,ue=Te[M]%Me,de=Te[M]/Me|0,F=M+(N=W);M<F;)k=((H=ue*(H=Se[--N]%Me)+(D=de*H+(Y=Se[N]/Me|0)*ue)%Me*Me+be[F]+k)/Oe|0)+(D/Me|0)+de*Y,be[F--]=H%Oe;be[F]=k}return k?++L:be.splice(0,1),ge(O,be,L)},_.negated=function(){var O=new X(this);return O.s=-O.s||null,O},_.plus=function(O,T){var k,L=this,M=L.s;if(T=(O=new X(O,T)).s,!M||!T)return new X(NaN);if(M!=T)return O.s=-T,L.minus(O);var F=L.e/h,N=O.e/h,D=L.c,W=O.c;if(!F||!N){if(!D||!W)return new X(M/0);if(!D[0]||!W[0])return W[0]?O:new X(D[0]?L:0*M)}if(F=S(F),N=S(N),D=D.slice(),M=F-N){for((k=0<M?(N=F,W):(M=-M,D)).reverse();M--;k.push(0));k.reverse()}for((M=D.length)-(T=W.length)<0&&(k=W,W=D,D=k,T=M),M=0;T;)M=(D[--T]=D[T]+W[T]+M)/d|0,D[T]=d===D[T]?0:D[T]%d;return M&&(D=[M].concat(D),++N),ge(O,D,N)},_.precision=_.sd=function(O,T){var k,L,M;if(O!=null&&O!==!!O)return E(O,1,b),T==null?T=A:E(T,0,8),me(new X(this),O,T);if(!(k=this.c))return null;if(L=(M=k.length-1)*h+1,M=k[M]){for(;M%10==0;M/=10,L--);for(M=k[0];10<=M;M/=10,L++);}return O&&this.e+1>L&&(L=this.e+1),L},_.shiftedBy=function(O){return E(O,-y,y),this.times("1e"+O)},_.squareRoot=_.sqrt=function(){var O,T,k,L,M,F=this,N=F.c,D=F.s,W=F.e,H=R+4,Y=new X("0.5");if(D!==1||!N||!N[0])return new X(!D||D<0&&(!N||N[0])?NaN:N?F:1/0);if((k=(D=Math.sqrt(+ve(F)))==0||D==1/0?(((T=w(N)).length+W)%2==0&&(T+="0"),D=Math.sqrt(+T),W=S((W+1)/2)-(W<0||W%2),new X(T=D==1/0?"1e"+W:(T=D.toExponential()).slice(0,T.indexOf("e")+1)+W)):new X(D+"")).c[0]){for((D=(W=k.e)+H)<3&&(D=0);;)if(M=k,k=Y.times(M.plus(Z(F,M,H,1))),w(M.c).slice(0,D)===(T=w(k.c)).slice(0,D)){if(k.e<W&&--D,(T=T.slice(D-3,D+1))!="9999"&&(L||T!="4999")){+T&&(+T.slice(1)||T.charAt(0)!="5")||(me(k,k.e+R+2,1),O=!k.times(k).eq(F));break}if(!L&&(me(M,M.e+R+2,0),M.times(M).eq(F))){k=M;break}H+=4,D+=4,L=1}}return me(k,k.e+R+1,A,O)},_.toExponential=function(O,T){return O!=null&&(E(O,0,b),O++),_e(this,O,T,1)},_.toFixed=function(O,T){return O!=null&&(E(O,0,b),O=O+this.e+1),_e(this,O,T)},_.toFormat=function(O,T,k){var L;if(k==null)O!=null&&T&&typeof T=="object"?(k=T,T=null):O&&typeof O=="object"?(k=O,O=T=null):k=ae;else if(typeof k!="object")throw Error(c+"Argument not an object: "+k);if(L=this.toFixed(O,T),this.c){var M,F=L.split("."),N=+k.groupSize,D=+k.secondaryGroupSize,W=k.groupSeparator||"",H=F[0],Y=F[1],ne=this.s<0,ue=ne?H.slice(1):H,de=ue.length;if(D&&(M=N,N=D,de-=D=M),0<N&&0<de){for(M=de%N||N,H=ue.substr(0,M);M<de;M+=N)H+=W+ue.substr(M,N);0<D&&(H+=W+ue.slice(M)),ne&&(H="-"+H)}L=Y?H+(k.decimalSeparator||"")+((D=+k.fractionGroupSize)?Y.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(k.fractionGroupSeparator||"")):Y):H}return(k.prefix||"")+L+(k.suffix||"")},_.toFraction=function(O){var T,k,L,M,F,N,D,W,H,Y,ne,ue,de=this,be=de.c;if(O!=null&&(!(D=new X(O)).isInteger()&&(D.c||D.s!==1)||D.lt(C)))throw Error(c+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+ve(D));if(!be)return new X(de);for(T=new X(C),H=k=new X(C),L=W=new X(C),ue=w(be),F=T.e=ue.length-de.e-1,T.c[0]=p[(N=F%h)<0?h+N:N],O=!O||0<D.comparedTo(T)?0<F?T:H:D,N=J,J=1/0,D=new X(ue),W.c[0]=0;Y=Z(D,T,0,1),(M=k.plus(Y.times(L))).comparedTo(O)!=1;)k=L,L=M,H=W.plus(Y.times(M=H)),W=M,T=D.minus(Y.times(M=T)),D=M;return M=Z(O.minus(k),L,0,1),W=W.plus(M.times(H)),k=k.plus(M.times(L)),W.s=H.s=de.s,ne=Z(H,L,F*=2,A).minus(de).abs().comparedTo(Z(W,k,F,A).minus(de).abs())<1?[H,L]:[W,k],J=N,ne},_.toNumber=function(){return+ve(this)},_.toPrecision=function(O,T){return O!=null&&E(O,1,b),_e(this,O,T,2)},_.toString=function(O){var T,k=this,L=k.s,M=k.e;return M===null?L?(T="Infinity",L<0&&(T="-"+T)):T="NaN":(T=O==null?M<=B||V<=M?G(w(k.c),M):q(w(k.c),M,"0"):O===10?q(w((k=me(new X(k),R+M+1,A)).c),k.e,"0"):(E(O,2,se.length,"Base"),te(q(w(k.c),M,"0"),10,O,L,!0)),L<0&&k.c[0]&&(T="-"+T)),T},_.valueOf=_.toJSON=function(){return ve(this)},_._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(_[Symbol.toStringTag]="BigNumber",_[Symbol.for("nodejs.util.inspect.custom")]=_.valueOf),U!=null&&X.set(U),X}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(S,w){return function(P){if(Array.isArray(P))return P}(S)||function(P,E){var j=[],G=!0,q=!1,z=void 0;try{for(var U,Z=P[Symbol.iterator]();!(G=(U=Z.next()).done)&&(j.push(U.value),!E||j.length!==E);G=!0);}catch(te){q=!0,z=te}finally{try{G||Z.return==null||Z.return()}finally{if(q)throw z}}return j}(S,w)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),s=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},f={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(S){var w=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},P=2<arguments.length?arguments[2]:void 0;if(typeof w=="string"&&(w=l.parseFormat(w)),!s.validateFormat(w))return"ERROR: invalid format";var E=w.prefix||"",j=w.postfix||"",G=function(q,z,U){switch(z.output){case"currency":return z=b(z,a.currentCurrencyDefaultFormat()),function(se,X,_e){var we=_e.currentCurrency(),ge=Object.assign({},f,X),me=void 0,ve="",O=!!ge.totalLength||!!ge.forceAverage||ge.average,T=X.currencyPosition||we.position,k=X.currencySymbol||we.symbol;ge.spaceSeparated&&(ve=" "),T==="infix"&&(me=ve+k+ve);var L=v({instance:se,providedFormat:X,state:_e,decimalSeparator:me});return T==="prefix"&&(L=se._value<0&&ge.negative==="sign"?"-".concat(ve).concat(k).concat(L.slice(1)):k+ve+L),T&&T!=="postfix"||(L=L+(ve=O?"":ve)+k),L}(q,z,a);case"percent":return z=b(z,a.currentPercentageDefaultFormat()),function(se,X,_e,we){var ge=X.prefixSymbol,me=v({instance:we(100*se._value),providedFormat:X,state:_e}),ve=Object.assign({},f,X);return ge?"%".concat(ve.spaceSeparated?" ":"").concat(me):"".concat(me).concat(ve.spaceSeparated?" ":"","%")}(q,z,a,U);case"byte":return z=b(z,a.currentByteDefaultFormat()),C=q,A=a,B=U,V=(R=z).base||"binary",K=c[V],J=h(C._value,K.suffixes,K.scale),ee=J.value,oe=J.suffix,ye=v({instance:B(ee),providedFormat:R,state:A,defaults:A.currentByteDefaultFormat()}),ae=A.currentAbbreviations(),"".concat(ye).concat(ae.spaced?" ":"").concat(oe);case"time":return z=b(z,a.currentTimeDefaultFormat()),I=q,g=Math.floor(I._value/60/60),m=Math.floor((I._value-60*g*60)/60),_=Math.round(I._value-60*g*60-60*m),"".concat(g,":").concat(m<10?"0":"").concat(m,":").concat(_<10?"0":"").concat(_);case"ordinal":return z=b(z,a.currentOrdinalDefaultFormat()),Z=q,te=z,ie=(Q=a).currentOrdinal(),he=Object.assign({},f,te),ce=v({instance:Z,providedFormat:te,state:Q}),fe=ie(Z._value),"".concat(ce).concat(he.spaceSeparated?" ":"").concat(fe);case"number":default:return v({instance:q,providedFormat:z,numbro:U})}var Z,te,Q,ie,he,ce,fe,I,g,m,_,C,R,A,B,V,K,J,ee,oe,ye,ae}(S,w,P);return G=(G=E+G)+j}function h(S,w,P){var E=w[0],j=Math.abs(S);if(P<=j){for(var G=1;G<w.length;++G){var q=Math.pow(P,G),z=Math.pow(P,G+1);if(q<=j&&j<z){E=w[G],S/=q;break}}E===w[0]&&(S/=Math.pow(P,w.length-1),E=w[w.length-1])}return{value:S,suffix:E}}function y(S){for(var w="",P=0;P<S;P++)w+="0";return w}function p(S,w){return S.toString().indexOf("e")!==-1?function(P,E){var j=P.toString(),G=i(j.split("e"),2),q=G[0],z=G[1],U=i(q.split("."),2),Z=U[0],te=U[1],Q=te===void 0?"":te;if(0<+z)j=Z+Q+y(z-Q.length);else{var ie=".";ie=+Z<0?"-0".concat(ie):"0".concat(ie);var he=(y(-z-1)+Math.abs(Z)+Q).substr(0,E);he.length<E&&(he+=y(E-he.length)),j=ie+he}return 0<+z&&0<E&&(j+=".".concat(y(E))),j}(S,w):(Math.round(+"".concat(S,"e+").concat(w))/Math.pow(10,w)).toFixed(w)}function v(S){var w=S.instance,P=S.providedFormat,E=S.state,j=E===void 0?a:E,G=S.decimalSeparator,q=S.defaults,z=q===void 0?j.currentDefaults():q,U=w._value;if(U===0&&j.hasZeroFormat())return j.getZeroFormat();if(!isFinite(U))return U.toString();var Z,te,Q,ie,he,ce,fe,I,g=Object.assign({},f,z,P),m=g.totalLength,_=m?0:g.characteristic,C=g.optionalCharacteristic,R=g.forceAverage,A=!!m||!!R||g.average,B=m?-1:A&&P.mantissa===void 0?0:g.mantissa,V=!m&&(P.optionalMantissa===void 0?B===-1:g.optionalMantissa),K=g.trimMantissa,J=g.thousandSeparated,ee=g.spaceSeparated,oe=g.negative,ye=g.forceSign,ae=g.exponential,se="";if(A){var X=function(O){var T=O.value,k=O.forceAverage,L=O.abbreviations,M=O.spaceSeparated,F=M!==void 0&&M,N=O.totalLength,D=N===void 0?0:N,W="",H=Math.abs(T),Y=-1;if(H>=Math.pow(10,12)&&!k||k==="trillion"?(W=L.trillion,T/=Math.pow(10,12)):H<Math.pow(10,12)&&H>=Math.pow(10,9)&&!k||k==="billion"?(W=L.billion,T/=Math.pow(10,9)):H<Math.pow(10,9)&&H>=Math.pow(10,6)&&!k||k==="million"?(W=L.million,T/=Math.pow(10,6)):(H<Math.pow(10,6)&&H>=Math.pow(10,3)&&!k||k==="thousand")&&(W=L.thousand,T/=Math.pow(10,3)),W&&(W=(F?" ":"")+W),D){var ne=T.toString().split(".")[0];Y=Math.max(D-ne.length,0)}return{value:T,abbreviation:W,mantissaPrecision:Y}}({value:U,forceAverage:R,abbreviations:j.currentAbbreviations(),spaceSeparated:ee,totalLength:m});U=X.value,se+=X.abbreviation,m&&(B=X.mantissaPrecision)}if(ae){var _e=(te=(Z={value:U,characteristicPrecision:_}).value,Q=Z.characteristicPrecision,ie=Q===void 0?0:Q,he=i(te.toExponential().split("e"),2),ce=he[0],fe=he[1],I=+ce,ie&&1<ie&&(I*=Math.pow(10,ie-1),fe=0<=(fe=+fe-(ie-1))?"+".concat(fe):fe),{value:I,abbreviation:"e".concat(fe)});U=_e.value,se=_e.abbreviation+se}var we,ge,me,ve=function(O,T,k,L,M){if(L===-1)return O;var F=p(T,L),N=i(F.toString().split("."),2),D=N[0],W=N[1],H=W===void 0?"":W;if(H.match(/^0+$/)&&(k||M))return D;var Y=H.match(/0+$/);return M&&Y?"".concat(D,".").concat(H.toString().slice(0,Y.index)):F.toString()}(U.toString(),U,V,B,K);return ve=function(O,T,k,L,M){var F=L.currentDelimiters(),N=F.thousands;M=M||F.decimal;var D=F.thousandsSize||3,W=O.toString(),H=W.split(".")[0],Y=W.split(".")[1];return k&&(T<0&&(H=H.slice(1)),function(ne,ue){for(var de=[],be=0,Oe=ne;0<Oe;Oe--)be===ue&&(de.unshift(Oe),be=0),be++;return de}(H.length,D).forEach(function(ne,ue){H=H.slice(0,ne+ue)+N+H.slice(ne+ue)}),T<0&&(H="-".concat(H))),W=Y?H+M+Y:H}(ve=function(O,T,k,L){var M=O,F=i(M.toString().split("."),2),N=F[0],D=F[1];if(N.match(/^-?0$/)&&k)return D?"".concat(N.replace("0",""),".").concat(D):N.replace("0","");if(N.length<L)for(var W=L-N.length,H=0;H<W;H++)M="0".concat(M);return M.toString()}(ve,0,C,_),U,J,j,G),(A||ae)&&(ve=ve+se),(ye||U<0)&&(we=ve,me=oe,ve=(ge=U)===0?we:+we==0?we.replace("-",""):0<ge?"+".concat(we):me==="sign"?we:"(".concat(we.replace("-",""),")")),ve}function b(S,w){if(!S)return w;var P=Object.keys(S);return P.length===1&&P[0]==="output"?w:S}n.exports=function(S){return{format:function(){for(var w=arguments.length,P=new Array(w),E=0;E<w;E++)P[E]=arguments[E];return d.apply(void 0,P.concat([S]))},getByteUnit:function(){for(var w=arguments.length,P=new Array(w),E=0;E<w;E++)P[E]=arguments[E];return function(j){var G=c.general;return h(j._value,G.suffixes,G.scale).suffix}.apply(void 0,P.concat([S]))},getBinaryByteUnit:function(){for(var w=arguments.length,P=new Array(w),E=0;E<w;E++)P[E]=arguments[E];return function(j){var G=c.binary;return h(j._value,G.suffixes,G.scale).suffix}.apply(void 0,P.concat([S]))},getDecimalByteUnit:function(){for(var w=arguments.length,P=new Array(w),E=0;E<w;E++)P[E]=arguments[E];return function(j){var G=c.decimal;return h(j._value,G.suffixes,G.scale).suffix}.apply(void 0,P.concat([S]))},formatOrDefault:b}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),s=r("./parsing"),l={},u=void 0,c={},f=null,d={};function h(p){u=p}function y(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return y().currency},l.currentAbbreviations=function(){return y().abbreviations},l.currentDelimiters=function(){return y().delimiters},l.currentOrdinal=function(){return y().ordinal},l.currentDefaults=function(){return Object.assign({},y().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().timeFormat)},l.setDefaults=function(p){p=s.parseFormat(p),a.validateFormat(p)&&(d=p)},l.getZeroFormat=function(){return f},l.setZeroFormat=function(p){return f=typeof p=="string"?p:null},l.hasZeroFormat=function(){return f!==null},l.languageData=function(p){if(p){if(c[p])return c[p];throw new Error('Unknown tag "'.concat(p,'"'))}return y()},l.registerLanguage=function(p){var v=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(p))throw new Error("Invalid language data");c[p.languageTag]=p,v&&h(p.languageTag)},l.setLanguage=function(p){var v=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!c[p]){var b=p.split("-")[0],S=Object.keys(c).find(function(w){return w.split("-")[0]===b});return c[S]?void h(S):void h(v)}h(p)},l.registerLanguage(i),u=i.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return s=i,void a.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&s.registerLanguage(u)});var s}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(s,l,u){var c=new i(s._value),f=l;return u.isNumbro(l)&&(f=l._value),f=new i(f),s._value=c.minus(f).toNumber(),s}n.exports=function(s){return{add:function(l,u){return f=u,d=s,h=new i((c=l)._value),y=f,d.isNumbro(f)&&(y=f._value),y=new i(y),c._value=h.plus(y).toNumber(),c;var c,f,d,h,y},subtract:function(l,u){return a(l,u,s)},multiply:function(l,u){return f=u,d=s,h=new i((c=l)._value),y=f,d.isNumbro(f)&&(y=f._value),y=new i(y),c._value=h.times(y).toNumber(),c;var c,f,d,h,y},divide:function(l,u){return f=u,d=s,h=new i((c=l)._value),y=f,d.isNumbro(f)&&(y=f._value),y=new i(y),c._value=h.dividedBy(y).toNumber(),c;var c,f,d,h,y},set:function(l,u){return c=l,d=f=u,s.isNumbro(f)&&(d=f._value),c._value=d,c;var c,f,d},difference:function(l,u){return c=u,a(d=(f=s)(l._value),c,f),Math.abs(d._value);var c,f,d}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(v,b){for(var S=0;S<b.length;S++){var w=b[S];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}var a=r("./globalState"),s=r("./validating"),l=r("./loading")(p),u=r("./unformatting"),c=r("./formatting")(p),f=r("./manipulating")(p),d=r("./parsing"),h=function(){function v(w){(function(P,E){if(!(P instanceof E))throw new TypeError("Cannot call a class as a function")})(this,v),this._value=w}var b,S;return b=v,(S=[{key:"clone",value:function(){return p(this._value)}},{key:"format",value:function(){var w=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,w)}},{key:"formatCurrency",value:function(w){return typeof w=="string"&&(w=d.parseFormat(w)),(w=c.formatOrDefault(w,a.currentCurrencyDefaultFormat())).output="currency",c.format(this,w)}},{key:"formatTime",value:function(){var w=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return w.output="time",c.format(this,w)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(w){return f.difference(this,w)}},{key:"add",value:function(w){return f.add(this,w)}},{key:"subtract",value:function(w){return f.subtract(this,w)}},{key:"multiply",value:function(w){return f.multiply(this,w)}},{key:"divide",value:function(w){return f.divide(this,w)}},{key:"set",value:function(w){return f.set(this,y(w))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(b.prototype,S),v}();function y(v){var b=v;return p.isNumbro(v)?b=v._value:typeof v=="string"?b=p.unformat(v):isNaN(v)&&(b=NaN),b}function p(v){return new h(y(v))}p.version="2.1.2",p.isNumbro=function(v){return v instanceof h},p.language=a.currentLanguage,p.registerLanguage=a.registerLanguage,p.setLanguage=a.setLanguage,p.languages=a.languages,p.languageData=a.languageData,p.zeroFormat=a.setZeroFormat,p.defaultFormat=a.currentDefaults,p.setDefaults=a.setDefaults,p.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,p.validate=s.validate,p.loadLanguagesInNode=l.loadLanguagesInNode,p.unformat=u.unformat,n.exports=p},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,s,l,u,c,f,d,h,y,p,v,b,S,w,P,E,j,G,q,z,U=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(s=U,i=(l=(a=i).match(/^{([^}]*)}/))?(s.prefix=l[1],a.slice(l[0].length)):a,c=U,function(Z,te){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(te.output="byte",te.base="general"):Z.indexOf("b")!==-1?(te.output="byte",te.base="binary"):Z.indexOf("d")!==-1?(te.output="byte",te.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(te.output="ordinal"):te.output="time";te.output="percent"}else te.output="currency"}(i=(f=(u=i).match(/{([^}]*)}$/))?(c.postfix=f[1],u.slice(0,-f[0].length)):u,U),d=U,(h=i.match(/[1-9]+[0-9]*/))&&(d.totalLength=+h[0]),y=U,(p=i.split(".")[0].match(/0+/))&&(y.characteristic=p[0].length),function(Z,te){if(Z.indexOf(".")!==-1){var Q=Z.split(".")[0];te.optionalCharacteristic=Q.indexOf("0")===-1}}(i,U),v=U,i.indexOf("a")!==-1&&(v.average=!0),S=U,(b=i).indexOf("K")!==-1?S.forceAverage="thousand":b.indexOf("M")!==-1?S.forceAverage="million":b.indexOf("B")!==-1?S.forceAverage="billion":b.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(Z,te){var Q=Z.split(".")[1];if(Q){var ie=Q.match(/0+/);ie&&(te.mantissa=ie[0].length)}}(i,U),P=U,(w=i).match(/\[\.]/)?P.optionalMantissa=!0:w.match(/\./)&&(P.optionalMantissa=!1),E=U,i.indexOf(",")!==-1&&(E.thousandSeparated=!0),j=U,i.indexOf(" ")!==-1&&(j.spaceSeparated=!0),q=U,(G=i).match(/^\+?\([^)]*\)$/)&&(q.negative="parenthesis"),G.match(/^\+?-/)&&(q.negative="sign"),z=U,i.match(/^\+/)&&(z.forceSign=!0),U)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",f=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,h=5<arguments.length?arguments[5]:void 0,y=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:function p(v,b){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",w=3<arguments.length?arguments[3]:void 0,P=4<arguments.length?arguments[4]:void 0,E=5<arguments.length?arguments[5]:void 0,j=6<arguments.length?arguments[6]:void 0;if(!isNaN(+v))return+v;var G="",q=v.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(q!==v)return-1*p(q,b,S,w,P,E,j);for(var z=0;z<i.length;z++){var U=i[z];if((G=v.replace(U.key,""))!==v)return p(G,b,S,w,P,E,j)*U.factor}if((G=v.replace("%",""))!==v)return p(G,b,S,w,P,E,j)/100;var Z=parseFloat(v);if(!isNaN(Z)){var te=w(Z);if(te&&te!=="."&&(G=v.replace(new RegExp("".concat(a(te),"$")),""))!==v)return p(G,b,S,w,P,E,j);var Q={};Object.keys(E).forEach(function(m){Q[E[m]]=m});for(var ie=Object.keys(Q).sort().reverse(),he=ie.length,ce=0;ce<he;ce++){var fe=ie[ce],I=Q[fe];if((G=v.replace(fe,""))!==v){var g=void 0;switch(I){case"thousand":g=Math.pow(10,3);break;case"million":g=Math.pow(10,6);break;case"billion":g=Math.pow(10,9);break;case"trillion":g=Math.pow(10,12)}return p(G,b,S,w,P,E,j)*g}}}}(function(p,v){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=p.replace(b,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(v.thousands),"([0-9])"),"g"),"$1$2")).replace(v.decimal,".")}(l,u,c),u,c,f,d,h,y)}n.exports={unformat:function(l,u){var c,f,d,h=r("./globalState"),y=h.currentDelimiters(),p=h.currentCurrency().symbol,v=h.currentOrdinal(),b=h.getZeroFormat(),S=h.currentAbbreviations(),w=void 0;if(typeof l=="string")w=function(P,E){if(!P.indexOf(":")||E.thousands===":")return!1;var j=P.split(":");if(j.length!==3)return!1;var G=+j[0],q=+j[1],z=+j[2];return!isNaN(G)&&!isNaN(q)&&!isNaN(z)}(l,y)?(c=l.split(":"),f=+c[0],d=+c[1],+c[2]+60*d+3600*f):s(l,y,p,v,b,S,u);else{if(typeof l!="number")return;w=l}if(w!==void 0)return w}}},{"./globalState":4}],10:[function(r,n,o){function i(y){return function(p){if(Array.isArray(p)){for(var v=0,b=new Array(p.length);v<p.length;v++)b[v]=p[v];return b}}(y)||function(p){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]")return Array.from(p)}(y)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(y){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(y)}var s=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(y,p){return p.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(y){return y.output==="byte"}},characteristic:{type:"number",restriction:function(y){return 0<=y},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(y){return 0<=y},message:"value must be positive"},{restriction:function(y,p){return!p.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(y){return 0<=y},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(y,p){return p.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(y){return y.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function f(y){return!!s.unformat(y)}function d(y,p,v){var b=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(y).map(function(w){if(!p[w])return console.error("".concat(v," Invalid key: ").concat(w)),!1;var P=y[w],E=p[w];if(typeof E=="string"&&(E={type:E}),E.type==="format"){if(!d(P,u,"[Validate ".concat(w,"]"),!0))return!1}else if(a(P)!==E.type)return console.error("".concat(v," ").concat(w,' type mismatched: "').concat(E.type,'" expected, "').concat(a(P),'" provided')),!1;if(E.restrictions&&E.restrictions.length)for(var j=E.restrictions.length,G=0;G<j;G++){var q=E.restrictions[G],z=q.restriction,U=q.message;if(!z(P,y))return console.error("".concat(v," ").concat(w," invalid value: ").concat(U)),!1}return E.restriction&&!E.restriction(P,y)?(console.error("".concat(v," ").concat(w," invalid value: ").concat(E.message)),!1):E.validValues&&E.validValues.indexOf(P)===-1?(console.error("".concat(v," ").concat(w," invalid value: must be among ").concat(JSON.stringify(E.validValues),', "').concat(P,'" provided')),!1):!(E.children&&!d(P,E.children,"[Validate ".concat(w,"]")))});return b||S.push.apply(S,i(Object.keys(p).map(function(w){var P=p[w];if(typeof P=="string"&&(P={type:P}),P.mandatory){var E=P.mandatory;if(typeof E=="function"&&(E=E(y)),E&&y[w]===void 0)return console.error("".concat(v,' Missing mandatory key "').concat(w,'"')),!1}return!0}))),S.reduce(function(w,P){return w&&P},!0)}function h(y){return d(y,u,"[Validate format]")}n.exports={validate:function(y,p){var v=f(y),b=h(p);return v&&b},validateFormat:h,validateInput:f,validateLanguage:function(y){return d(y,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(numbro_min);const numbro=numbro_minExports;var RENDERER_TYPE$2="numeric";function numericRenderer(e,t,r,n,o,i,a){var s=i;if(isNumeric(s)){var l=a.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,f=a.className||"",d=f.length?f.split(" "):[];if(typeof u<"u"&&!numbro.languages()[u]){var h=u.replace("-",""),y=numbro.allLanguages?numbro.allLanguages[u]:numbro[h];y&&numbro.registerLanguage(y)}numbro.setLanguage(u),s=numbro(s).format(c||"0"),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),a.className=d.join(" "),t.dir="ltr"}textRenderer(e,t,r,n,o,s,a)}numericRenderer.RENDERER_TYPE=RENDERER_TYPE$2;var RENDERER_TYPE$1="password";function passwordRenderer(e,t,r,n,o,i,a){textRenderer.apply(this,[e,t,r,n,o,i,a]);var s=a.hashLength||t.innerHTML.length,l=a.hashSymbol||"*",u="";rangeEach(s-1,function(){u+=l}),fastInnerHTML(t,u)}passwordRenderer.RENDERER_TYPE=RENDERER_TYPE$1;var RENDERER_TYPE="time";function timeRenderer(e,t,r,n,o,i,a){textRenderer.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}timeRenderer.RENDERER_TYPE=RENDERER_TYPE;function registerAllRenderers(){_register$2(autocompleteRenderer),_register$2(baseRenderer),_register$2(checkboxRenderer),_register$2(htmlRenderer),_register$2(numericRenderer),_register$2(passwordRenderer),_register$2(textRenderer),_register$2(timeRenderer)}var VALIDATOR_TYPE$3="autocomplete";function autocompleteValidator(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,process$1(r,t)):process$1(r,t)(this.source):t(!0)}autocompleteValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$3;function process$1(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var sameValue$1=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},call=functionCall,fixRegExpWellKnownSymbolLogic=fixRegexpWellKnownSymbolLogic,anObject=anObject$m,isNullOrUndefined=isNullOrUndefined$b,requireObjectCoercible$2=requireObjectCoercible$e,sameValue=sameValue$1,toString$2=toString$l,getMethod=getMethod$7,regExpExec=regexpExecAbstract;fixRegExpWellKnownSymbolLogic("search",function(e,t,r){return[function(o){var i=requireObjectCoercible$2(this),a=isNullOrUndefined(o)?void 0:getMethod(o,e);return a?call(a,o,i):new RegExp(o)[e](toString$2(i))},function(n){var o=anObject(this),i=toString$2(n),a=r(t,o,i);if(a.done)return a.value;var s=o.lastIndex;sameValue(s,0)||(o.lastIndex=0);var l=regExpExec(o,i);return sameValue(o.lastIndex,s)||(o.lastIndex=s),l===null?-1:l.index}]});function getNormalizedDate(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const dateHelpers=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate},Symbol.toStringTag,{value:"Module"}));var VALIDATOR_TYPE$2="date";function dateValidator(e,t){var r=_getEditorInstance(EDITOR_TYPE$5,this.instance),n=e,o=!0;n==null&&(n="");var i=hooks(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=hooks(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var s=correctFormat(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),o=!0}else o=!1;t(o)}dateValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$2;function correctFormat(e,t){var r=hooks(getNormalizedDate(e)),n=hooks(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var VALIDATOR_TYPE$1="numeric";function numericValidator(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:isNumeric(e))}numericValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$1;var STRICT_FORMATS=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],VALIDATOR_TYPE="time";function timeValidator(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=hooks(o,STRICT_FORMATS,!0).isValid()?hooks(o):hooks(o,r),s=a.isValid(),l=hooks(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=a.format(r),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),n=!0}else n=!1;t(n)}timeValidator.VALIDATOR_TYPE=VALIDATOR_TYPE;function registerAllValidators(){_register$1(autocompleteValidator),_register$1(dateValidator),_register$1(numericValidator),_register$1(timeValidator)}var CELL_TYPE$7="autocomplete",AutocompleteCellType={CELL_TYPE:CELL_TYPE$7,editor:AutocompleteEditor,renderer:autocompleteRenderer,validator:autocompleteValidator},CELL_TYPE$6="checkbox",CheckboxCellType={CELL_TYPE:CELL_TYPE$6,editor:CheckboxEditor,renderer:checkboxRenderer},CELL_TYPE$5="date",DateCellType={CELL_TYPE:CELL_TYPE$5,editor:DateEditor,renderer:autocompleteRenderer,validator:dateValidator},CELL_TYPE$4="dropdown",DropdownCellType={CELL_TYPE:CELL_TYPE$4,editor:DropdownEditor,renderer:autocompleteRenderer,validator:autocompleteValidator},CELL_TYPE$3="handsontable",HandsontableCellType={CELL_TYPE:CELL_TYPE$3,editor:HandsontableEditor,renderer:autocompleteRenderer},CELL_TYPE$2="numeric",NumericCellType={CELL_TYPE:CELL_TYPE$2,editor:NumericEditor,renderer:numericRenderer,validator:numericValidator,dataType:"number"},CELL_TYPE$1="password",PasswordCellType={CELL_TYPE:CELL_TYPE$1,editor:PasswordEditor,renderer:passwordRenderer,copyable:!1},CELL_TYPE="time",TimeCellType={CELL_TYPE,editor:TimeEditor,renderer:timeRenderer,validator:timeValidator};function registerAllCellTypes(){_register(AutocompleteCellType),_register(CheckboxCellType),_register(DateCellType),_register(DropdownCellType),_register(HandsontableCellType),_register(NumericCellType),_register(PasswordCellType),_register(TextCellType),_register(TimeCellType)}var collection=collection$5,collectionWeak=collectionWeak$2;collection("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},collectionWeak);function _typeof$1t(e){return _typeof$1t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1t(e)}function _slicedToArray$y(e,t){return _arrayWithHoles$A(e)||_iterableToArrayLimit$y(e,t)||_unsupportedIterableToArray$O(e,t)||_nonIterableRest$A()}function _nonIterableRest$A(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$O(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$O(e,t)}}function _arrayLikeToArray$O(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$y(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$A(e){if(Array.isArray(e))return e}function _classCallCheck$1o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1s(n.key),n)}}function _createClass$1o(e,t,r){return t&&_defineProperties$1o(e.prototype,t),r&&_defineProperties$1o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1s(e){var t=_toPrimitive$1s(e,"string");return _typeof$1t(t)==="symbol"?t:String(t)}function _toPrimitive$1s(e,t){if(_typeof$1t(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1t(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateMethodInitSpec$2(e,t){_checkPrivateRedeclaration$a(e,t),t.add(e)}function _checkPrivateRedeclaration$a(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateMethodGet$2(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var DEPS_TYPE_CHECKERS=new Map([["plugin",hasPlugin],["cell-type",hasItem],["editor",hasItem$3],["renderer",hasItem$2],["validator",hasItem$1]]),PLUGIN_KEY$x="base",privatePool$f=new WeakMap,missingDependeciesMsgs=[],initializedPlugins=null,_isRelevantToSettings=new WeakSet,BasePlugin=function(){function e(t){var r=this;_classCallCheck$1o(this,e),_classPrivateMethodInitSpec$2(this,_isRelevantToSettings),defineGetter(this,"hot",t,{writable:!1}),privatePool$f.set(this,{hooks:{}}),initializedPlugins=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return _createClass$1o(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var c=u.split(":"),f=_slicedToArray$y(c,2),d=f[0],h=f[1];if(!DEPS_TYPE_CHECKERS.has(d))throw new Error('Unknown plugin dependency type "'.concat(d,'" was found.'));DEPS_TYPE_CHECKERS.get(d)(h)||i.push(" - ".concat(h," (").concat(d,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");missingDependeciesMsgs.push(a)}}initializedPlugins||(initializedPlugins=getPluginsNames()),initializedPlugins.indexOf("UndoRedo")>=0&&initializedPlugins.splice(initializedPlugins.indexOf("UndoRedo"),1),initializedPlugins.indexOf(this.pluginName)>=0&&initializedPlugins.splice(initializedPlugins.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var s=initializedPlugins.length===0;if(s){if(missingDependeciesMsgs.length>0){var l=["".concat(missingDependeciesMsgs.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){privatePool$f.get(this).hooks[r]=privatePool$f.get(this).hooks[r]||[];var o=privatePool$f.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),privatePool$f.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;arrayEach(privatePool$f.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=privatePool$f.get(this).hooks;objectEach(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){arrayEach(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=_classPrivateMethodGet$2(this,_isRelevantToSettings,_isRelevantToSettings2).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),objectEach(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$x}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function _isRelevantToSettings2(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function _typeof$1s(e){return _typeof$1s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1s(e)}function _slicedToArray$x(e,t){return _arrayWithHoles$z(e)||_iterableToArrayLimit$x(e,t)||_unsupportedIterableToArray$N(e,t)||_nonIterableRest$z()}function _nonIterableRest$z(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$N(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$N(e,t)}}function _arrayLikeToArray$N(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$x(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$z(e){if(Array.isArray(e))return e}function _classCallCheck$1n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1r(n.key),n)}}function _createClass$1n(e,t,r){return t&&_defineProperties$1n(e.prototype,t),r&&_defineProperties$1n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1r(e){var t=_toPrimitive$1r(e,"string");return _typeof$1s(t)==="symbol"?t:String(t)}function _toPrimitive$1r(e,t){if(_typeof$1s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GhostTable$2=function(){function e(t){_classCallCheck$1n(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return _createClass$1n(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),arrayEach(this.rows,function(n){r(n.row,outerHeight(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),arrayEach(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){arrayEach(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(s){arrayEach(s.strings,function(l){var u=l.col,c=n.hot.getCellMeta(r,u);c.col=u,c.row=r;var f=n.hot.getCellRenderer(c),d=o.createElement("td");d.setAttribute("ghost-table",1),f(n.hot,d,r,u,n.hot.colToProp(u),l.value,c),i.appendChild(d)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(s){arrayEach(s.strings,function(l){var u=l.col,c=n.createElement("th");i.push([u,c]),o.appendChild(c)})}),this.table.tHead.appendChild(o),arrayEach(i,function(s){var l=_slicedToArray$x(s,2),u=l[0],c=l[1];r.hot.view.appendColHeader(u,c)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){arrayEach(a.strings,function(s){var l=s.row,u=n.hot.getCellMeta(l,r);u.col=r,u.row=l;var c=n.hot.getCellRenderer(u),f=o.createElement("td"),d=o.createElement("tr");f.setAttribute("ghost-table",1),c(n.hot,f,l,r,n.hot.colToProp(r),s.value,u),d.appendChild(f),i.appendChild(d)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),u=n.createElement("tr"),c=n.createElement("th");return this.isVertical()&&i.appendChild(l),this.isHorizontal()&&(u.appendChild(c),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&s.appendChild(u),i.appendChild(s),addClass(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:s,colGroup:l,tr:u,th:c}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return addClass(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const GhostTable$3=GhostTable$2;function _typeof$1r(e){return _typeof$1r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1r(e)}function _defineProperty$i(e,t,r){return t=_toPropertyKey$1q(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck$1m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1q(n.key),n)}}function _createClass$1m(e,t,r){return t&&_defineProperties$1m(e.prototype,t),r&&_defineProperties$1m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1q(e){var t=_toPrimitive$1q(e,"string");return _typeof$1r(t)==="symbol"?t:String(t)}function _toPrimitive$1q(e,t){if(_typeof$1r(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1r(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SamplesGenerator=function(){function e(t){_classCallCheck$1m(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return _createClass$1m(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,s=typeof o=="number"?{from:o,to:o}:o,l=s.from,u=s.to;return rangeEach(l,u,function(c){var f=i.generateSample(r,n,c);a.set(c,f)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,s=r==="row"?"col":"row",l=[];return rangeEach(n.from,n.to,function(u){var c=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),f=c.value,d=c.bundleSeed,h=typeof d=="string"&&d.length>0,y;h?y=d:isObject$6(f)?y="".concat(Object.keys(f).length):Array.isArray(f)?y="".concat(f.length):y="".concat(stringify$1(f).length),a.has(y)||a.set(y,{needed:i.getSampleCount(),strings:[]});var p=a.get(y);if(p.needed){var v=l.indexOf(f)>-1;(!v||i.allowDuplicates||h)&&(p.strings.push(_defineProperty$i({value:f},s,u)),l.push(f),p.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const SamplesGenerator$1=SamplesGenerator;function _typeof$1q(e){return _typeof$1q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1q(e)}function _slicedToArray$w(e,t){return _arrayWithHoles$y(e)||_iterableToArrayLimit$w(e,t)||_unsupportedIterableToArray$M(e,t)||_nonIterableRest$y()}function _nonIterableRest$y(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$M(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$M(e,t)}}function _arrayLikeToArray$M(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$w(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$y(e){if(Array.isArray(e))return e}function _classCallCheck$1l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1p(n.key),n)}}function _createClass$1l(e,t,r){return t&&_defineProperties$1l(e.prototype,t),r&&_defineProperties$1l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1p(e){var t=_toPrimitive$1p(e,"string");return _typeof$1q(t)==="symbol"?t:String(t)}function _toPrimitive$1p(e,t){if(_typeof$1q(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1q(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$H(){return typeof Reflect<"u"&&Reflect.get?_get$H=Reflect.get.bind():_get$H=function(t,r,n){var o=_superPropBase$H(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$H.apply(this,arguments)}function _superPropBase$H(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$P(e),e!==null););return e}function _inherits$P(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$P(e,t)}function _setPrototypeOf$P(e,t){return _setPrototypeOf$P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$P(e,t)}function _createSuper$P(e){var t=_isNativeReflectConstruct$P();return function(){var n=_getPrototypeOf$P(e),o;if(t){var i=_getPrototypeOf$P(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$P(this,o)}}function _possibleConstructorReturn$P(e,t){if(t&&(_typeof$1q(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$P(e)}function _assertThisInitialized$P(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$P(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$P(e){return _getPrototypeOf$P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$P(e)}Hooks$1.getSingleton().register("modifyAutoColumnSizeSeed");var PLUGIN_KEY$w="autoColumnSize",PLUGIN_PRIORITY$v=10,privatePool$e=new WeakMap,COLUMN_SIZE_MAP_NAME="autoColumnSize",AutoColumnSize=function(e){_inherits$P(r,e);var t=_createSuper$P(r);function r(n){var o;return _classCallCheck$1l(this,r),o=t.call(this,n),privatePool$e.set(_assertThisInitialized$P(o),{cachedColumnHeaders:[]}),o.ghostTable=new GhostTable$3(o.hot),o.samplesGenerator=new SamplesGenerator$1(function(i,a){var s=o.hot.getCellMeta(i,a),l="";s.spanned||(l=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new PhysicalIndexToValueMap,o.hot.columnIndexMapper.registerMap(COLUMN_SIZE_MAP_NAME,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,s){return o.onBeforeColumnResize(i,a,s)}),o}return _createClass$1l(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[PLUGIN_KEY$w]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[PLUGIN_KEY$w];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,s){return o.getColumnWidth(s,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),_get$H(_getPrototypeOf$P(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),_get$H(_getPrototypeOf$P(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;_get$H(_getPrototypeOf$P(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,s){return o.onBeforeColumnResize(i,a,s)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();a===-1||s===-1||this.calculateColumnsWidth({from:a,to:s},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;rangeEach(l.from,l.to,function(c){var f=o.hot.toPhysicalColumn(c);if(f===null&&(f=c),s||o.columnWidthsMap.getValueAtIndex(f)===null&&!o.hot._getColWidthFromSettings(f)){var d=o.samplesGenerator.generateColumnSamples(c,u);arrayEach(d,function(h){var y=_slicedToArray$w(h,2),p=y[0],v=y[1];return o.ghostTable.addColumn(p,v)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(c,f){var d=o.hot.toPhysicalColumn(c);o.columnWidthsMap.setValueAtIndex(d,f)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,s=this.hot.countCols()-1,l=null;this.inProgress=!0;var u=function f(){if(!o.hot){cancelAnimationFrame(l),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,s)},i),a=a+r.CALCULATION_STEP+1,a<s?l=requestAnimationFrame(f):(cancelAnimationFrame(l),o.inProgress=!1,o.hot.view.adjustElementsSize())},c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateColumnsWidth({from:0,to:c},i),this.firstCalculation=!1,a=c+1),a<s?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[PLUGIN_KEY$w],i=o&&hasOwnProperty$1(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&hasOwnProperty$1(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[PLUGIN_KEY$w],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return isObject$6(o)&&(i=o.syncLimit,isPercentValue(i)?i=valueAccordingPercent(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=i;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof s=="number"&&(s=Math.max(s,ViewportColumnsCalculator$1.DEFAULT_WIDTH))),s}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=privatePool$e.get(this),a=i.cachedColumnHeaders,s=arrayReduce$1(o,function(l,u,c){var f=a.length;return(f-1<c||a[c]!==u)&&l.push(c),f-1<c?a.push(u):a[c]=u,l},[]);return s}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){arrayEach(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!arrayFilter(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=arrayMap(o,function(s){var l=_slicedToArray$w(s,2),u=l[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var s=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),s=this.getColumnWidth(i,void 0,!1)),s}},{key:"onAfterInit",value:function(){privatePool$e.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=arrayFilter(o,function(s){var l;return isDefined((l=s.address)===null||l===void 0?void 0:l.col)}),a=arrayMap(i,function(s){return s.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),_get$H(_getPrototypeOf$P(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$w}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$v}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(BasePlugin),DIRECTIONS={horizontal:"horizontal",vertical:"vertical"};function getDeltas(e,t,r,n){var o=r.length,i=r?r[0].length:0,a=[],s=t.row-e.row,l=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],c=0;c<l;c++){var f=parseInt(r[0][c],10),d=parseInt(r[o-1][c],10),h=(n==="down"?d-f:f-d)/(o-1)||0;u.push(h)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var y=0;y<s;y++){var p=parseInt(r[y][0],10),v=parseInt(r[y][i-1],10),b=(n==="right"?v-p:p-v)/(i-1)||0;a.push([b])}return a}function getDragDirectionAndRange(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function getMappedFillHandleSetting(e){var t={};return e===!0?(t.directions=Object.keys(DIRECTIONS),t.autoInsertRow=!0):isObject$6(e)?(isDefined(e.autoInsertRow)?e.direction===DIRECTIONS.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,isDefined(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(DIRECTIONS)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function _typeof$1p(e){return _typeof$1p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1p(e)}function _toConsumableArray$h(e){return _arrayWithoutHoles$h(e)||_iterableToArray$j(e)||_unsupportedIterableToArray$L(e)||_nonIterableSpread$h()}function _nonIterableSpread$h(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$j(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$h(e){if(Array.isArray(e))return _arrayLikeToArray$L(e)}function _slicedToArray$v(e,t){return _arrayWithHoles$x(e)||_iterableToArrayLimit$v(e,t)||_unsupportedIterableToArray$L(e,t)||_nonIterableRest$x()}function _nonIterableRest$x(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$L(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$L(e,t)}}function _arrayLikeToArray$L(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$v(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$x(e){if(Array.isArray(e))return e}function _classCallCheck$1k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1o(n.key),n)}}function _createClass$1k(e,t,r){return t&&_defineProperties$1k(e.prototype,t),r&&_defineProperties$1k(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1o(e){var t=_toPrimitive$1o(e,"string");return _typeof$1p(t)==="symbol"?t:String(t)}function _toPrimitive$1o(e,t){if(_typeof$1p(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1p(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$G(){return typeof Reflect<"u"&&Reflect.get?_get$G=Reflect.get.bind():_get$G=function(t,r,n){var o=_superPropBase$G(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$G.apply(this,arguments)}function _superPropBase$G(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$O(e),e!==null););return e}function _inherits$O(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$O(e,t)}function _setPrototypeOf$O(e,t){return _setPrototypeOf$O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$O(e,t)}function _createSuper$O(e){var t=_isNativeReflectConstruct$O();return function(){var n=_getPrototypeOf$O(e),o;if(t){var i=_getPrototypeOf$O(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$O(this,o)}}function _possibleConstructorReturn$O(e,t){if(t&&(_typeof$1p(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$O(e)}function _assertThisInitialized$O(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$O(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$O(e){return _getPrototypeOf$O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$O(e)}Hooks$1.getSingleton().register("modifyAutofillRange");Hooks$1.getSingleton().register("beforeAutofill");Hooks$1.getSingleton().register("afterAutofill");var PLUGIN_KEY$v="autofill",PLUGIN_PRIORITY$u=20,SETTING_KEYS$2=["fillHandle"],INSERT_ROW_ALTER_ACTION_NAME="insert_row_below",INTERVAL_FOR_ADDING_ROW=200,Autofill=function(e){_inherits$O(r,e);var t=_createSuper$O(r);function r(n){var o;return _classCallCheck$1k(this,r),o=t.call(this,n),o.eventManager=new EventManager$1(_assertThisInitialized$O(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return _createClass$1k(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),_get$G(_getPrototypeOf$O(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$G(_getPrototypeOf$O(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),_get$G(_getPrototypeOf$O(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),s=a.row,l=a.col,u=i.getBottomEndCorner(),c=u.row,f=u.col,d=this.hot.runHooks("modifyCopyableRange",[{startRow:s,startCol:l,endRow:c,endCol:f}]),h=[],y=[],p=[];return arrayEach(d,function(v){for(var b=v.startRow;b<=v.endRow;b+=1)h.indexOf(b)===-1&&h.push(b);for(var S=v.startCol;S<=v.endCol;S+=1)y.indexOf(S)===-1&&y.push(S)}),arrayEach(h,function(v){var b=[];arrayEach(y,function(S){b.push(o.hot.getCopyableData(v,S))}),p.push(b)}),p}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=_slicedToArray$v(i,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.hot.getSelectedRangeLast(),d=f.getTopStartCorner(),h=f.getBottomEndCorner();this.resetSelectionOfDraggedArea();var y=[d.row,d.col,h.row,h.col],p=this.hot.runHooks("modifyAutofillRange",[Math.min(d.row,s),Math.min(d.col,l),Math.max(h.row,u),Math.max(h.col,c)],y),v=getDragDirectionAndRange(y,p,function(I,g){return o.hot._createCellCoords(I,g)}),b=v.directionOfDrag,S=v.startOfDragCoords,w=v.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var P=this.getSelectionData(),E=f.clone(),j=this.hot._createCellRange(S,S,w),G=this.hot.runHooks("beforeAutofill",P,E,j,b);if(G===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var q=getDeltas(S,w,P,b),z=G,U=G;if(["up","left"].indexOf(b)>-1&&!(U.length===1&&U[0].length===0))if(z=[],b==="up")for(var Z=w.row-S.row+1,te=Z%U.length,Q=0;Q<Z;Q++)z.push(U[(Q+(U.length-te))%U.length]);else for(var ie=w.col-S.col+1,he=ie%U[0].length,ce=0;ce<U.length;ce++){z.push([]);for(var fe=0;fe<ie;fe++)z[ce].push(U[ce][(fe+(U[ce].length-he))%U[ce].length])}this.hot.populateFromArray(S.row,S.col,z,w.row,w.col,"".concat(this.pluginName,".fill"),null,b,q),this.setSelection(p),this.hot.runHooks("afterAutofill",z,E,j,b),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),s=o;if(this.directions.includes(DIRECTIONS.vertical)&&this.directions.includes(DIRECTIONS.horizontal)){var l=i.getTopStartCorner();(a.col<=o.col||l.col>=o.col)&&(s=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||l.row>o.row)&&(s=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(DIRECTIONS.vertical))s=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(DIRECTIONS.horizontal))s=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(s)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(INSERT_ROW_ALTER_ACTION_NAME,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},INTERVAL_FOR_ADDING_ROW)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),s,l=o[2]+1;l<a;l++){for(var u=o[1];u<=o[3];u++){var c=i[l][u];if(c)return-1}var f=i[l][o[1]-1],d=i[l][o[3]+1];(f||d)&&(s=l)}return s}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,_toConsumableArray$h(arrayMap(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=offset(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+outerHeight(this.hot.table),s=offset(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+outerWidth(this.hot.table);return o.clientY>a&&o.clientX<=s}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=getMappedFillHandleSetting(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){_get$G(_getPrototypeOf$O(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$v}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$u}},{key:"SETTING_KEYS",get:function(){return[PLUGIN_KEY$v].concat(SETTING_KEYS$2)}}]),r}(BasePlugin);function _typeof$1o(e){return _typeof$1o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1o(e)}function _slicedToArray$u(e,t){return _arrayWithHoles$w(e)||_iterableToArrayLimit$u(e,t)||_unsupportedIterableToArray$K(e,t)||_nonIterableRest$w()}function _nonIterableRest$w(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$K(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$K(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$K(e,t)}}function _arrayLikeToArray$K(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$u(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$w(e){if(Array.isArray(e))return e}function _classCallCheck$1j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1n(n.key),n)}}function _createClass$1j(e,t,r){return t&&_defineProperties$1j(e.prototype,t),r&&_defineProperties$1j(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1n(e){var t=_toPrimitive$1n(e,"string");return _typeof$1o(t)==="symbol"?t:String(t)}function _toPrimitive$1n(e,t){if(_typeof$1o(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1o(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$F(){return typeof Reflect<"u"&&Reflect.get?_get$F=Reflect.get.bind():_get$F=function(t,r,n){var o=_superPropBase$F(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$F.apply(this,arguments)}function _superPropBase$F(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$N(e),e!==null););return e}function _inherits$N(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$N(e,t)}function _setPrototypeOf$N(e,t){return _setPrototypeOf$N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$N(e,t)}function _createSuper$N(e){var t=_isNativeReflectConstruct$N();return function(){var n=_getPrototypeOf$N(e),o;if(t){var i=_getPrototypeOf$N(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$N(this,o)}}function _possibleConstructorReturn$N(e,t){if(t&&(_typeof$1o(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$N(e)}function _assertThisInitialized$N(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$N(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$N(e){return _getPrototypeOf$N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$N(e)}var PLUGIN_KEY$u="autoRowSize",PLUGIN_PRIORITY$t=40,ROW_WIDTHS_MAP_NAME="autoRowSize",AutoRowSize=function(e){_inherits$N(r,e);var t=_createSuper$N(r);function r(n){var o;return _classCallCheck$1j(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new GhostTable$3(o.hot),o.samplesGenerator=new SamplesGenerator$1(function(i,a){var s;return i>=0?s=o.hot.getDataAtCell(i,a):i===-1&&(s=o.hot.getColHeader(a)),{value:s}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new PhysicalIndexToValueMap,o.hot.rowIndexMapper.registerMap(ROW_WIDTHS_MAP_NAME,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,s){return o.onBeforeRowResize(i,a,s)}),o}return _createClass$1j(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[PLUGIN_KEY$u];return o===!0||isObject$6(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),_get$F(_getPrototypeOf$N(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,_get$F(_getPrototypeOf$N(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,s){return o.onBeforeRowResize(i,a,s)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var c=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(c.get(-1))}rangeEach(l.from,l.to,function(f){if(s||o.rowHeightsMap.getValueAtIndex(f)===null){var d=o.samplesGenerator.generateRowSamples(f,u);arrayEach(d,function(h){var y=_slicedToArray$u(h,2),p=y[0],v=y[1];return o.ghostTable.addRow(p,v)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(f,d){f<0?o.headerHeight=d:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(f),d)})},!0),this.measuredRows=l.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,s=this.hot.countRows()-1,l=null;this.inProgress=!0;var u=function f(){if(!o.hot){cancelAnimationFrame(l),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,s)},i),a=a+r.CALCULATION_STEP+1,a<s?l=requestAnimationFrame(f):(cancelAnimationFrame(l),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateRowsHeight({from:0,to:c},i),this.firstCalculation=!1,a=c+1),a<s?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[PLUGIN_KEY$u],i=o&&hasOwnProperty$1(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&hasOwnProperty$1(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){isVisible(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[PLUGIN_KEY$u],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return isObject$6(o)&&(i=o.syncLimit,isPercentValue(i)?i=valueAccordingPercent(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),s=i;return a!==null&&a>(i||0)&&(s=a),s}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,s=a.from,l=a.to;this.hot.batchExecution(function(){rangeEach(Math.min(s,l),Math.max(s,l),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!arrayFilter(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(a===-1||s===-1)){if(this.calculateRowsHeight({from:a,to:s},void 0,o),i){var l=this.hot.countRows()-1;this.calculateRowsHeight({from:l-i,to:l})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var s=o;return a&&(this.calculateRowsHeight(i,void 0,!0),s=this.getRowHeight(i)),s}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),_get$F(_getPrototypeOf$N(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$u}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$t}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(BasePlugin);function _typeof$1n(e){return _typeof$1n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1n(e)}function _classCallCheck$1i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1m(n.key),n)}}function _createClass$1i(e,t,r){return t&&_defineProperties$1i(e.prototype,t),r&&_defineProperties$1i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1m(e){var t=_toPrimitive$1m(e,"string");return _typeof$1n(t)==="symbol"?t:String(t)}function _toPrimitive$1m(e,t){if(_typeof$1n(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1n(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$E(){return typeof Reflect<"u"&&Reflect.get?_get$E=Reflect.get.bind():_get$E=function(t,r,n){var o=_superPropBase$E(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$E.apply(this,arguments)}function _superPropBase$E(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$M(e),e!==null););return e}function _inherits$M(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$M(e,t)}function _setPrototypeOf$M(e,t){return _setPrototypeOf$M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$M(e,t)}function _createSuper$M(e){var t=_isNativeReflectConstruct$M();return function(){var n=_getPrototypeOf$M(e),o;if(t){var i=_getPrototypeOf$M(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$M(this,o)}}function _possibleConstructorReturn$M(e,t){if(t&&(_typeof$1n(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$M(e)}function _assertThisInitialized$M(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$M(e){return _getPrototypeOf$M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$M(e)}var _alterUtilsFactory$1=alterUtilsFactory("physicallyIndexed"),getListWithInsertedItems$1=_alterUtilsFactory$1.getListWithInsertedItems,getListWithRemovedItems$1=_alterUtilsFactory$1.getListWithRemovedItems,LooseBindsMap=function(e){_inherits$M(r,e);var t=_createSuper$M(r);function r(){return _classCallCheck$1i(this,r),t.call(this,function(n){return n})}return _createClass$1i(r,[{key:"insert",value:function(o,i){var a=getIncreasedIndexes(this.indexedValues,i);this.indexedValues=getListWithInsertedItems$1(a,o,i,this.initValueOrFn),_get$E(_getPrototypeOf$M(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=getListWithRemovedItems$1(this.indexedValues,o);this.indexedValues=getDecreasedIndexes(i,o),_get$E(_getPrototypeOf$M(r.prototype),"remove",this).call(this,o)}}]),r}(IndexMap);const LooseBindsMap$1=LooseBindsMap;function _typeof$1m(e){return _typeof$1m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1m(e)}function _toConsumableArray$g(e){return _arrayWithoutHoles$g(e)||_iterableToArray$i(e)||_unsupportedIterableToArray$J(e)||_nonIterableSpread$g()}function _nonIterableSpread$g(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$J(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$J(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$J(e,t)}}function _iterableToArray$i(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$g(e){if(Array.isArray(e))return _arrayLikeToArray$J(e)}function _arrayLikeToArray$J(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$1h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1l(n.key),n)}}function _createClass$1h(e,t,r){return t&&_defineProperties$1h(e.prototype,t),r&&_defineProperties$1h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1l(e){var t=_toPrimitive$1l(e,"string");return _typeof$1m(t)==="symbol"?t:String(t)}function _toPrimitive$1l(e,t){if(_typeof$1m(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1m(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$D(){return typeof Reflect<"u"&&Reflect.get?_get$D=Reflect.get.bind():_get$D=function(t,r,n){var o=_superPropBase$D(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$D.apply(this,arguments)}function _superPropBase$D(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$L(e),e!==null););return e}function _inherits$L(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$L(e,t)}function _setPrototypeOf$L(e,t){return _setPrototypeOf$L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$L(e,t)}function _createSuper$L(e){var t=_isNativeReflectConstruct$L();return function(){var n=_getPrototypeOf$L(e),o;if(t){var i=_getPrototypeOf$L(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$L(this,o)}}function _possibleConstructorReturn$L(e,t){if(t&&(_typeof$1m(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$L(e)}function _assertThisInitialized$L(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$L(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$L(e){return _getPrototypeOf$L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$L(e)}var _alterUtilsFactory=alterUtilsFactory("physicallyIndexed"),getListWithInsertedItems=_alterUtilsFactory.getListWithInsertedItems,getListWithRemovedItems=_alterUtilsFactory.getListWithRemovedItems,StrictBindsMap=function(e){_inherits$L(r,e);var t=_createSuper$L(r);function r(){return _classCallCheck$1h(this,r),t.call(this,function(n){return n})}return _createClass$1h(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=getListWithInsertedItems(this.indexedValues,o,i,function(s,l){return a.getNextValue(l)}),_get$D(_getPrototypeOf$L(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=getListWithRemovedItems(this.indexedValues,o),_get$D(_getPrototypeOf$L(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,_toConsumableArray$g(this.getValues()))+1+o}}]),r}(IndexMap);const StrictBindsMap$1=StrictBindsMap;function _typeof$1l(e){return _typeof$1l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1l(e)}function _classCallCheck$1g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1k(n.key),n)}}function _createClass$1g(e,t,r){return t&&_defineProperties$1g(e.prototype,t),r&&_defineProperties$1g(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1k(e){var t=_toPrimitive$1k(e,"string");return _typeof$1l(t)==="symbol"?t:String(t)}function _toPrimitive$1k(e,t){if(_typeof$1l(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1l(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$C(){return typeof Reflect<"u"&&Reflect.get?_get$C=Reflect.get.bind():_get$C=function(t,r,n){var o=_superPropBase$C(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$C.apply(this,arguments)}function _superPropBase$C(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$K(e),e!==null););return e}function _inherits$K(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$K(e,t)}function _setPrototypeOf$K(e,t){return _setPrototypeOf$K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$K(e,t)}function _createSuper$K(e){var t=_isNativeReflectConstruct$K();return function(){var n=_getPrototypeOf$K(e),o;if(t){var i=_getPrototypeOf$K(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$K(this,o)}}function _possibleConstructorReturn$K(e,t){if(t&&(_typeof$1l(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$K(e)}function _assertThisInitialized$K(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$K(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$K(e){return _getPrototypeOf$K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$K(e)}var PLUGIN_KEY$t="bindRowsWithHeaders",PLUGIN_PRIORITY$s=210,DEFAULT_BIND="loose",bindTypeToMapStrategy=new Map([["loose",LooseBindsMap$1],["strict",StrictBindsMap$1]]),BindRowsWithHeaders=function(e){_inherits$K(r,e);var t=_createSuper$K(r);function r(n){var o;return _classCallCheck$1g(this,r),o=t.call(this,n),o.headerIndexes=null,o}return _createClass$1g(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$t]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[PLUGIN_KEY$t];typeof i!="string"&&(i=DEFAULT_BIND);var a=bindTypeToMapStrategy.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(s){return o.onModifyRowHeader(s)}),_get$C(_getPrototypeOf$K(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),_get$C(_getPrototypeOf$K(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){_get$C(_getPrototypeOf$K(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$t}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$s}}]),r}(BasePlugin);function _typeof$1k(e){return _typeof$1k=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1k(e)}function _toConsumableArray$f(e){return _arrayWithoutHoles$f(e)||_iterableToArray$h(e)||_unsupportedIterableToArray$I(e)||_nonIterableSpread$f()}function _nonIterableSpread$f(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$I(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$I(e,t)}}function _iterableToArray$h(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$f(e){if(Array.isArray(e))return _arrayLikeToArray$I(e)}function _arrayLikeToArray$I(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$1f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1j(n.key),n)}}function _createClass$1f(e,t,r){return t&&_defineProperties$1f(e.prototype,t),r&&_defineProperties$1f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _get$B(){return typeof Reflect<"u"&&Reflect.get?_get$B=Reflect.get.bind():_get$B=function(t,r,n){var o=_superPropBase$B(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$B.apply(this,arguments)}function _superPropBase$B(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$J(e),e!==null););return e}function _inherits$J(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$J(e,t)}function _setPrototypeOf$J(e,t){return _setPrototypeOf$J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$J(e,t)}function _createSuper$J(e){var t=_isNativeReflectConstruct$J();return function(){var n=_getPrototypeOf$J(e),o;if(t){var i=_getPrototypeOf$J(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$J(this,o)}}function _possibleConstructorReturn$J(e,t){if(t&&(_typeof$1k(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$J(e)}function _assertThisInitialized$J(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$J(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$J(e){return _getPrototypeOf$J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$J(e)}function _classPrivateFieldInitSpec$9(e,t,r){_checkPrivateRedeclaration$9(e,t),t.set(e,r)}function _checkPrivateRedeclaration$9(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$h(e,t,r){return t=_toPropertyKey$1j(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1j(e){var t=_toPrimitive$1j(e,"string");return _typeof$1k(t)==="symbol"?t:String(t)}function _toPrimitive$1j(e,t){if(_typeof$1k(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1k(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$9(e,t){var r=_classExtractFieldDescriptor$9(e,t,"get");return _classApplyDescriptorGet$9(e,r)}function _classApplyDescriptorGet$9(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet$9(e,t,r){var n=_classExtractFieldDescriptor$9(e,t,"set");return _classApplyDescriptorSet$9(e,n,r),r}function _classExtractFieldDescriptor$9(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet$9(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var PLUGIN_KEY$s="collapsibleColumns",PLUGIN_PRIORITY$r=290,SETTING_KEYS$1=["nestedHeaders"],COLLAPSIBLE_ELEMENT_CLASS="collapsibleIndicator",actionDictionary=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),_collapsedColumnsMap=new WeakMap,CollapsibleColumns=function(e){_inherits$J(r,e);var t=_createSuper$J(r);function r(){var n;_classCallCheck$1f(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_defineProperty$h(_assertThisInitialized$J(n),"nestedHeadersPlugin",null),_defineProperty$h(_assertThisInitialized$J(n),"eventManager",new EventManager$1(_assertThisInitialized$J(n))),_defineProperty$h(_assertThisInitialized$J(n),"headerStateManager",null),_classPrivateFieldInitSpec$9(_assertThisInitialized$J(n),_collapsedColumnsMap,{writable:!0,value:null}),n}return _createClass$1f(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$s]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),_classPrivateFieldSet$9(this,_collapsedColumnsMap,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(s,l,u){return o.onBeforeOnCellMouseDown(s,l,u)}),_get$B(_getPrototypeOf$J(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}_get$B(_getPrototypeOf$J(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$9(this,_collapsedColumnsMap,null),this.nestedHeadersPlugin=null,this.clearButtons(),_get$B(_getPrototypeOf$J(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,l=function(c){c&&c.parentNode.removeChild(c)};rangeEach(0,o-1,function(u){var c=i.childNodes[u],f=a.childNodes[u],d=s?s.childNodes[u]:null;rangeEach(0,c.childNodes.length-1,function(h){var y=c.childNodes[h].querySelector(".".concat(COLLAPSIBLE_ELEMENT_CLASS));l(y),f&&f.childNodes[h]&&(y=f.childNodes[h].querySelector(".".concat(COLLAPSIBLE_ELEMENT_CLASS)),l(y)),s&&d&&d.childNodes[h]&&(y=d.childNodes[h].querySelector(".".concat(COLLAPSIBLE_ELEMENT_CLASS)),l(y))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(s){var l=s.collapsible,u=s.origColspan,c=s.headerLevel,f=s.columnIndex,d=s.isCollapsed;if(l===!0&&u>1&&(d&&o==="expand"||!d&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(c),col:f}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!actionDictionary.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var s=arrayFilter(o,function(v){var b=v.row;return b<0}),l=s.length>0;arrayEach(s,function(v){var b,S=v.row,w=v.col,P=(b=a.headerStateManager.getHeaderSettings(S,w))!==null&&b!==void 0?b:{},E=P.collapsible,j=P.isCollapsed;if(!E||j&&i==="collapse"||!j&&i==="expand")return l=!1,!1});var u=[],c=[];l&&arrayEach(s,function(v){var b=v.row,S=v.col,w=a.headerStateManager.triggerNodeModification(i,b,S),P=w.colspanCompensation,E=w.affectedColumns,j=w.rollbackModification;P>0&&(c.push.apply(c,_toConsumableArray$f(E)),u.push(j))});var f=this.getCollapsedColumns(),d=[];i==="collapse"?d=arrayUnique([].concat(_toConsumableArray$f(f),c)):i==="expand"&&(d=arrayFilter(f,function(v){return!c.includes(v)}));var h=actionDictionary.get(i),y=this.hot.runHooks(h.beforeHook,f,d,l);if(y===!1){arrayEach(u,function(v){v()});return}this.hot.batchExecution(function(){arrayEach(c,function(v){_classPrivateFieldGet$9(a,_collapsedColumnsMap).setValueAtIndex(a.hot.toPhysicalColumn(v),h.hideColumn)})},!0);var p=this.getCollapsedColumns().length!==f.length;this.hot.runHooks(h.afterHook,f,d,l,p),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return _classPrivateFieldGet$9(this,_collapsedColumnsMap).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(o,i,a){var s,l=(s=this.headerStateManager.getHeaderSettings(a,o))!==null&&s!==void 0?s:{},u=l.collapsible,c=l.origColspan,f=l.isCollapsed,d=u&&c>1&&o>=this.hot.getSettings().fixedColumnsStart,h=i.querySelector(".".concat(COLLAPSIBLE_ELEMENT_CLASS));if(d)h||(h=this.hot.rootDocument.createElement("div"),addClass(h,COLLAPSIBLE_ELEMENT_CLASS),i.querySelector("div:first-child").appendChild(h)),removeClass(h,["collapsed","expanded"]),f?(addClass(h,"collapsed"),fastInnerText(h,"+")):(addClass(h,"expanded"),fastInnerText(h,"-"));else{var y;(y=h)===null||y===void 0||y.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){hasClass(o.target,COLLAPSIBLE_ELEMENT_CLASS)&&(hasClass(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):hasClass(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),stopImmediatePropagation(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){_classPrivateFieldSet$9(this,_collapsedColumnsMap,null),_get$B(_getPrototypeOf$J(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$s}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$r}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[PLUGIN_KEY$s].concat(SETTING_KEYS$1)}}]),r}(BasePlugin);function _typeof$1j(e){return _typeof$1j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1j(e)}function ownKeys$8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$8(Object(r),!0).forEach(function(n){_defineProperty$g(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$g(e,t,r){return t=_toPropertyKey$1i(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray$t(e,t){return _arrayWithHoles$v(e)||_iterableToArrayLimit$t(e,t)||_unsupportedIterableToArray$H(e,t)||_nonIterableRest$v()}function _nonIterableRest$v(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$H(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$H(e,t)}}function _arrayLikeToArray$H(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$v(e){if(Array.isArray(e))return e}function _classCallCheck$1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1i(n.key),n)}}function _createClass$1e(e,t,r){return t&&_defineProperties$1e(e.prototype,t),r&&_defineProperties$1e(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1i(e){var t=_toPrimitive$1i(e,"string");return _typeof$1j(t)==="symbol"?t:String(t)}function _toPrimitive$1i(e,t){if(_typeof$1j(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1j(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var inheritedColumnProperties=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],SORT_EMPTY_CELLS_DEFAULT=!1,SHOW_SORT_INDICATOR_DEFAULT=!0,HEADER_ACTION_DEFAULT=!0,ColumnStatesManager=function(){function e(t,r){_classCallCheck$1e(this,e),this.hot=t,this.sortingStates=new LinkedPhysicalIndexToValueMap,this.sortEmptyCells=SORT_EMPTY_CELLS_DEFAULT,this.indicator=SHOW_SORT_INDICATOR_DEFAULT,this.headerAction=HEADER_ACTION_DEFAULT,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return _createClass$1e(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;isObject$6(r)&&objectEach(r,function(o,i){inheritedColumnProperties.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=_slicedToArray$t(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return isObject$6(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=_slicedToArray$t(o,2),a=i[0],s=i[1];return _objectSpread$8({column:r.hot.toVisualColumn(a)},s)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(isDefined(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),ASC_SORT_STATE="asc",DESC_SORT_STATE="desc",HEADER_SPAN_CLASS="colHeader";function isValidColumnState(e){if(isObject$6(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[ASC_SORT_STATE,DESC_SORT_STATE].includes(r)}function areValidSortStates(e){if(e.some(function(r){return isValidColumnState(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function getNextSortOrder(e){if(e!==DESC_SORT_STATE)return e===ASC_SORT_STATE?DESC_SORT_STATE:ASC_SORT_STATE}function getHeaderSpanElement(e){var t=e.querySelector(".".concat(HEADER_SPAN_CLASS));return t}function isFirstLevelColumnHeader(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function wasHeaderClickedProperly(e,t,r){return e===-1&&t>=0&&isRightClick(r)===!1}var HEADER_CLASS_ASC_SORT="ascending",HEADER_CLASS_DESC_SORT="descending",HEADER_CLASS_INDICATOR_DISABLED="indicatorDisabled",HEADER_SORT_CLASS="columnSorting",HEADER_ACTION_CLASS="sortAction",orderToCssClass=new Map([[ASC_SORT_STATE,HEADER_CLASS_ASC_SORT],[DESC_SORT_STATE,HEADER_CLASS_DESC_SORT]]);function getClassesToAdd$1(e,t,r,n){var o=[HEADER_SORT_CLASS];if(n&&o.push(HEADER_ACTION_CLASS),r===!1)return o.push(HEADER_CLASS_INDICATOR_DISABLED),o;var i=e.getSortOrderOfColumn(t);return isDefined(i)&&o.push(orderToCssClass.get(i)),o}function getClassesToRemove$1(){return Array.from(orderToCssClass.values()).concat(HEADER_ACTION_CLASS,HEADER_CLASS_INDICATOR_DISABLED,HEADER_SORT_CLASS)}function compareFunctionFactory$3(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?DO_NOT_SWAP:isEmpty(o)?isEmpty(i)?DO_NOT_SWAP:a&&e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:isEmpty(i)?a&&e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:isNaN(o)&&!isNaN(i)?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:o>i?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}var COLUMN_DATA_TYPE$3="default";function compareFunctionFactory$2(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),s=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return DO_NOT_SWAP;if(s){if(isEmpty(n))return e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(o))return e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND}return isNaN(i)?FIRST_AFTER_SECOND:isNaN(a)?FIRST_BEFORE_SECOND:i<a?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:i>a?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}var COLUMN_DATA_TYPE$2="numeric";function compareFunctionFactory$1(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,s){var l=isEmpty(a),u=isEmpty(s),c=l?o:a,f=u?o:s,d=c===o||c===n,h=f===o||f===n;if(i===!1){if(l&&u===!1)return FIRST_AFTER_SECOND;if(l===!1&&u)return FIRST_BEFORE_SECOND}return d===!1&&h?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:d&&h===!1?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:d===!1&&h===!1?compareFunctionFactory$3(e,t,r)(a,s):c===o&&f===n?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:c===n&&f===o?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}var COLUMN_DATA_TYPE$1="checkbox";function compareFunctionFactory(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return DO_NOT_SWAP;if(isEmpty(n))return isEmpty(o)?DO_NOT_SWAP:i&&e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(o))return i&&e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND;var a=t.dateFormat,s=hooks(n,a),l=hooks(o,a);return s.isValid()?l.isValid()?l.isAfter(s)?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:l.isBefore(s)?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP:FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND}}var COLUMN_DATA_TYPE="date",_staticRegister=staticRegister("sorting.compareFunctionFactory"),registerCompareFunctionFactory=_staticRegister.register,getGloballyCompareFunctionFactory=_staticRegister.getItem,hasGloballyCompareFunctionFactory=_staticRegister.hasItem,_staticRegister2=staticRegister("sorting.mainSortComparator"),registerRootComparator=_staticRegister2.register,getRootComparator=_staticRegister2.getItem;function getCompareFunctionFactory(e){return hasGloballyCompareFunctionFactory(e)?getGloballyCompareFunctionFactory(e):getGloballyCompareFunctionFactory(COLUMN_DATA_TYPE$3)}registerCompareFunctionFactory(COLUMN_DATA_TYPE$2,compareFunctionFactory$2);registerCompareFunctionFactory(COLUMN_DATA_TYPE$1,compareFunctionFactory$1);registerCompareFunctionFactory(COLUMN_DATA_TYPE,compareFunctionFactory);registerCompareFunctionFactory(COLUMN_DATA_TYPE$3,compareFunctionFactory$3);var DO_NOT_SWAP=0,FIRST_BEFORE_SECOND=-1,FIRST_AFTER_SECOND=1;function sort(e,t){for(var r=getRootComparator(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function _toArray$1(e){return _arrayWithHoles$u(e)||_iterableToArray$g(e)||_unsupportedIterableToArray$G(e)||_nonIterableRest$u()}function _nonIterableRest$u(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$G(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$G(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$G(e,t)}}function _arrayLikeToArray$G(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArray$g(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithHoles$u(e){if(Array.isArray(e))return e}function rootComparator$1(e,t){return function(r,n){var o=_toArray$1(r),i=o.slice(1),a=_toArray$1(n),s=a.slice(1);return function(u){var c=e[u],f=t[u],d=i[u],h=s[u],y=f.columnSorting,p=y.compareFunctionFactory?y.compareFunctionFactory:getCompareFunctionFactory(f.type),v=p(c,f,y)(d,h);return v}(0)}}function _typeof$1i(e){return _typeof$1i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1i(e)}var _excluded$3=["column"],_excluded2=["column"];function _toConsumableArray$e(e){return _arrayWithoutHoles$e(e)||_iterableToArray$f(e)||_unsupportedIterableToArray$F(e)||_nonIterableSpread$e()}function _nonIterableSpread$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$F(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$F(e,t)}}function _iterableToArray$f(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$e(e){if(Array.isArray(e))return _arrayLikeToArray$F(e)}function _arrayLikeToArray$F(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys$7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$7(Object(r),!0).forEach(function(n){_defineProperty$f(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$f(e,t,r){return t=_toPropertyKey$1h(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$3(e,t){if(e==null)return{};var r=_objectWithoutPropertiesLoose$3(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _objectWithoutPropertiesLoose$3(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function _classCallCheck$1d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1h(n.key),n)}}function _createClass$1d(e,t,r){return t&&_defineProperties$1d(e.prototype,t),r&&_defineProperties$1d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1h(e){var t=_toPrimitive$1h(e,"string");return _typeof$1i(t)==="symbol"?t:String(t)}function _toPrimitive$1h(e,t){if(_typeof$1i(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1i(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$A(){return typeof Reflect<"u"&&Reflect.get?_get$A=Reflect.get.bind():_get$A=function(t,r,n){var o=_superPropBase$A(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$A.apply(this,arguments)}function _superPropBase$A(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$I(e),e!==null););return e}function _inherits$I(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$I(e,t)}function _setPrototypeOf$I(e,t){return _setPrototypeOf$I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$I(e,t)}function _createSuper$I(e){var t=_isNativeReflectConstruct$I();return function(){var n=_getPrototypeOf$I(e),o;if(t){var i=_getPrototypeOf$I(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$I(this,o)}}function _possibleConstructorReturn$I(e,t){if(t&&(_typeof$1i(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$I(e)}function _assertThisInitialized$I(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$I(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$I(e){return _getPrototypeOf$I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$I(e)}var PLUGIN_KEY$r="columnSorting",PLUGIN_PRIORITY$q=50,APPEND_COLUMN_CONFIG_STRATEGY$1="append",REPLACE_COLUMN_CONFIG_STRATEGY="replace";registerRootComparator(PLUGIN_KEY$r,rootComparator$1);Hooks$1.getSingleton().register("beforeColumnSort");Hooks$1.getSingleton().register("afterColumnSort");var ColumnSorting=function(e){_inherits$I(r,e);var t=_createSuper$I(r);function r(n){var o;return _classCallCheck$1d(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=PLUGIN_KEY$r,o.indexesSequenceCache=null,o}return _createClass$1d(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new ColumnStatesManager(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new PhysicalIndexToValueMap(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),_get$A(_getPrototypeOf$I(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(s,l){var u=getHeaderSpanElement(l);isFirstLevelColumnHeader(s,l)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,_get$A(_getPrototypeOf$I(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),s=this.areValidSortConfigs(a),l=this.hot.runHooks("beforeColumnSort",i,a,s);l!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new IndexesSequence),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,s?a:i,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return isDefined(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return areValidSortStates(o)&&o.every(function(a){var s=a.column;return s<=i&&s>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),s=function(u){var c=u.column,f=_objectWithoutProperties$3(u,_excluded$3);return _objectSpread$7({column:i.hot.toPhysicalColumn(c)},f)};a.initialConfig=arrayMap(o,s),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,s=function(u){var c=u.column,f=_objectWithoutProperties$3(u,_excluded2);return _objectSpread$7({column:o.hot.toVisualColumn(c)},f)};return isDefined(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=arrayMap(a.initialConfig,s)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(isDefined(i)){var a=getNextSortOrder(i);return isDefined(a)?{column:o,sortOrder:a}:void 0}var s=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<s)return{column:o,sortOrder:getNextSortOrder()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:APPEND_COLUMN_CONFIG_STRATEGY$1,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),s=a!==-1,l=this.getSortConfig(),u=this.getColumnNextConfig(o);if(s){if(isUndefined(u))return[].concat(_toConsumableArray$e(l.slice(0,a)),_toConsumableArray$e(l.slice(a+1)));if(i===APPEND_COLUMN_CONFIG_STRATEGY$1)return[].concat(_toConsumableArray$e(l.slice(0,a)),_toConsumableArray$e(l.slice(a+1)),[u]);if(i===REPLACE_COLUMN_CONFIG_STRATEGY)return[].concat(_toConsumableArray$e(l.slice(0,a)),[u],_toConsumableArray$e(l.slice(a+1)))}return isDefined(u)?l.concat(u):l}},{key:"getPluginColumnConfig",value:function(o){if(isObject$6(o)){var i=o[this.pluginKey];if(isObject$6(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,o),l=Object.getPrototypeOf(s);return Array.isArray(l.columns)?Object.assign(a,i,this.getPluginColumnConfig(l.columns[o])):isFunction(l.columns)?Object.assign(a,i,this.getPluginColumnConfig(l.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],s=this.hot.countRows(),l=function(v){return arrayMap(o,function(b){return i.hot.getDataAtCell(v,b.column)})},u=0;u<this.getNumberOfRowsToSort(s);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(l(u)));var c=arrayMap(a,function(p){return p[0]});sort(a,this.pluginKey,arrayMap(o,function(p){return p.sortOrder}),arrayMap(o,function(p){return i.getFirstCellSettings(p.column)}));for(var f=a.length;f<s;f+=1)a.push([f].concat(l(f)));var d=arrayMap(a,function(p){return p[0]}),h=new Map(arrayMap(c,function(p,v){return[p,d[v]]})),y=arrayMap(this.hot.rowIndexMapper.getIndexesSequence(),function(p){return h.has(p)?h.get(p):p});this.hot.rowIndexMapper.setIndexesSequence(y)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(isObject$6(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(isObject$6(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||isObject$6(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=getHeaderSpanElement(i);if(!(isFirstLevelColumnHeader(o,i)===!1||a===null)){var s=this.getFirstCellSettings(o)[this.pluginKey],l=s.indicator,u=s.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,l,u)}}},{key:"updateHeaderClasses",value:function(o){if(removeClass(o,getClassesToRemove$1()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];addClass(o,getClassesToAdd$1.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){_get$A(_getPrototypeOf$I(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),isDefined(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],s=a.headerAction;return s&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,s){wasHeaderClickedProperly(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){wasHeaderClickedProperly(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),_get$A(_getPrototypeOf$I(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$r}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$q}}]),r}(BasePlugin),$$2=_export,uncurryThis$2=functionUncurryThis,toIntegerOrInfinity=toIntegerOrInfinity$8,thisNumberValue=thisNumberValue$2,$repeat=stringRepeat,fails$1=fails$I,$RangeError=RangeError,$String=String,floor=Math.floor,repeat=uncurryThis$2($repeat),stringSlice=uncurryThis$2("".slice),nativeToFixed=uncurryThis$2(1 .toFixed),pow=function(e,t,r){return t===0?r:t%2===1?pow(e,t-1,r*e):pow(e*e,t/2,r)},log=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},multiply=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=floor(o/1e7)},divide=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=floor(n/t),n=n%t*1e7},dataToString=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=$String(e[t]);r=r===""?n:r+repeat("0",7-n.length)+n}return r},FORCED=fails$1(function(){return nativeToFixed(8e-5,3)!=="0.000"||nativeToFixed(.9,0)!=="1"||nativeToFixed(1.255,2)!=="1.25"||nativeToFixed(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!fails$1(function(){nativeToFixed({})});$$2({target:"Number",proto:!0,forced:FORCED},{toFixed:function(t){var r=thisNumberValue(this),n=toIntegerOrInfinity(t),o=[0,0,0,0,0,0],i="",a="0",s,l,u,c;if(n<0||n>20)throw $RangeError("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return $String(r);if(r<0&&(i="-",r=-r),r>1e-21)if(s=log(r*pow(2,69,1))-69,l=s<0?r*pow(2,-s,1):r/pow(2,s,1),l*=4503599627370496,s=52-s,s>0){for(multiply(o,0,l),u=n;u>=7;)multiply(o,1e7,0),u-=7;for(multiply(o,pow(10,u,1),0),u=s-1;u>=23;)divide(o,1<<23),u-=23;divide(o,1<<u),multiply(o,1,1),divide(o,2),a=dataToString(o)}else multiply(o,0,l),multiply(o,1<<-s,0),a=dataToString(o)+repeat("0",n);return n>0?(c=a.length,a=i+(c<=n?"0."+repeat("0",n-c)+a:stringSlice(a,0,c-n)+"."+stringSlice(a,c-n))):a=i+a,a}});function _typeof$1h(e){return _typeof$1h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1h(e)}function _classCallCheck$1c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1g(n.key),n)}}function _createClass$1c(e,t,r){return t&&_defineProperties$1c(e.prototype,t),r&&_defineProperties$1c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1g(e){var t=_toPrimitive$1g(e,"string");return _typeof$1h(t)==="symbol"?t:String(t)}function _toPrimitive$1g(e,t){if(_typeof$1h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Endpoints=function(){function e(t,r){_classCallCheck$1c(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return _createClass$1c(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),arrayEach(i,function(a){var s={};n.assignSetting(a,s,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,s,"reversedRowCoords",!1),n.assignSetting(a,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"sourceColumn",a.destinationColumn),n.assignSetting(a,s,"type","sum"),n.assignSetting(a,s,"forceNumeric",!1),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"customFunction",null),n.assignSetting(a,s,"readOnly",!0),n.assignSetting(a,s,"roundFloat",!1),o.push(s)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();arrayEach(a,function(s){i==="row"&&s.destinationRow>=n&&(r==="insert_row"?s.alterRowOffset=o:r==="remove_row"&&(s.alterRowOffset=-1*o)),i==="col"&&s.destinationColumn>=n&&(r==="insert_col"?s.alterColumnOffset=o:r==="remove_col"&&(s.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var s=this,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function p(){return s.hot.removeHook("beforeViewRender",p),s.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var c=r.indexOf("row")>-1?"row":"col",f=r.indexOf("remove")>-1?-1:1,d=this.getAllEndpoints(),h=r.indexOf("move_row")===0,y=n;arrayEach(d,function(p){c==="row"&&p.destinationRow>=y&&(p.alterRowOffset=f*o),c==="col"&&p.destinationColumn>=y&&(p.alterColumnOffset=f*o)}),this.resetAllEndpoints(d,!h),h?arrayEach(d,function(p){s.extendEndpointRanges(p,y,i[0],i.length),s.recreatePhysicalRanges(p),s.clearOffsetInformation(p)}):arrayEach(d,function(p){s.shiftEndpointCoordinates(p,y)}),l&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){arrayEach(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];arrayEach(o,function(s){var l=[];if(s[1])for(var u=s[0];u<=s[1];u++)l.push(n.hot.toPhysicalRow(u));else l.push(n.hot.toPhysicalRow(s[0]));a.push(l)}),arrayEach(a,function(s){var l=[];arrayEach(s,function(u,c){c===0?l.push(u):s[c]!==s[c-1]+1&&(l.push(s[c-1]),i.push(l),l=[],l.push(u)),c===s.length-1&&(l.push(u),i.push(l))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,arrayEach(r.ranges,function(o){arrayEach(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var s=a.alterRowOffset||0,l=a.alterColumnOffset||0;return a.destinationRow+s>=r.hot.countRows()||a.destinationColumn+l>=r.hot.countCols()});i||(this.cellsToSetCache=[],arrayEach(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],arrayEach(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],arrayEach(r,function(i,a,s){"".concat(i[2]||"")!=="".concat(i[3])&&arrayEach(n.getAllEndpoints(),function(l,u){n.hot.propToCol(s[a][1])===l.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),arrayEach(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var s=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||s.readOnly!==r.readOnly)&&(s.readOnly=r.readOnly,s.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(i,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){warn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const Endpoints$1=Endpoints;function isNullishOrNaN(e){return e==null||isNaN(e)}function _typeof$1g(e){return _typeof$1g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1g(e)}var _templateObject$a;function _taggedTemplateLiteral$a(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$1b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1f(n.key),n)}}function _createClass$1b(e,t,r){return t&&_defineProperties$1b(e.prototype,t),r&&_defineProperties$1b(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1f(e){var t=_toPrimitive$1f(e,"string");return _typeof$1g(t)==="symbol"?t:String(t)}function _toPrimitive$1f(e,t){if(_typeof$1g(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1g(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$z(){return typeof Reflect<"u"&&Reflect.get?_get$z=Reflect.get.bind():_get$z=function(t,r,n){var o=_superPropBase$z(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$z.apply(this,arguments)}function _superPropBase$z(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$H(e),e!==null););return e}function _inherits$H(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$H(e,t)}function _setPrototypeOf$H(e,t){return _setPrototypeOf$H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$H(e,t)}function _createSuper$H(e){var t=_isNativeReflectConstruct$H();return function(){var n=_getPrototypeOf$H(e),o;if(t){var i=_getPrototypeOf$H(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$H(this,o)}}function _possibleConstructorReturn$H(e,t){if(t&&(_typeof$1g(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$H(e)}function _assertThisInitialized$H(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$H(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$H(e){return _getPrototypeOf$H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$H(e)}var PLUGIN_KEY$q="columnSummary",PLUGIN_PRIORITY$p=220,ColumnSummary=function(e){_inherits$H(r,e);var t=_createSuper$H(r);function r(n){var o;return _classCallCheck$1b(this,r),o=t.call(this,n),o.endpoints=null,o}return _createClass$1b(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$q]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[PLUGIN_KEY$q],this.endpoints=new Endpoints$1(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,s){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,s)}),this.addHook("beforeCreateCol",function(i,a,s){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,s)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(s))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(s))}),this.addHook("afterCreateRow",function(i,a,s){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,s)}),this.addHook("afterCreateCol",function(i,a,s){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,s)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(s))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(s))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),_get$z(_getPrototypeOf$H(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return objectEach(o.ranges,function(s){a+=i.getPartialSum(s,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,s=o[1]||o[0],l=null,u=0;do{if(l=this.getCellValue(s,i),l=isNullishOrNaN(l)?null:l,l!==null){var c=("".concat(l).split(".")[1]||[]).length||1;c>u&&(u=c)}a+=l||0,s-=1}while(s>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,s=null;return objectEach(o.ranges,function(l){var u=a.getPartialMinMax(l,o.sourceColumn,i);if(s===null&&u!==null&&(s=u),u!==null)switch(i){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}}),s===null?"Not enough data":s}},{key:"getPartialMinMax",value:function(o,i,a){var s=null,l=o[1]||o[0],u;do{if(u=this.getCellValue(l,i),u=isNullishOrNaN(u)?null:u,s===null)s=u;else if(u!==null)switch(a){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}l-=1}while(l>=o[0]);return s}},{key:"countEmpty",value:function(o,i){var a,s=0,l=o[1]||o[0];do a=this.getCellValue(l,i),a=isNullishOrNaN(a)?null:a,a===null&&(s+=1),l-=1;while(l>=o[0]);return s}},{key:"countEntries",value:function(o){var i=this,a=0,s=o.ranges;return objectEach(s,function(l){var u=l[1]===void 0?1:l[1]-l[0]+1,c=i.countEmpty(l,o.sourceColumn);a+=u,a-=c}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),s=this.hot.toVisualColumn(i),l=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&s!==null&&(u=this.hot.getCellMeta(a,s).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof l=="string"&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(toSingleLine(_templateObject$a||(_templateObject$a=_taggedTemplateLiteral$a(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return l}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$q}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$p}}]),r}(BasePlugin);function _typeof$1f(e){return _typeof$1f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1f(e)}function _classCallCheck$1a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1e(n.key),n)}}function _createClass$1a(e,t,r){return t&&_defineProperties$1a(e.prototype,t),r&&_defineProperties$1a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1e(e){var t=_toPrimitive$1e(e,"string");return _typeof$1f(t)==="symbol"?t:String(t)}function _toPrimitive$1e(e,t){if(_typeof$1f(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1f(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CommentEditor=function(){function e(t,r){_classCallCheck$1a(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return _createClass$1a(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:outerWidth(this.getInputElement()),height:outerHeight(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),addClass(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),addClass(r,e.CLASS_EDITOR),addClass(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const CommentEditor$1=CommentEditor;var KEY$c="---------";function separatorItem(){return{name:KEY$c}}function normalizeSelection(e){return arrayMap(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function isSeparator(e){return hasClass(e,"htSeparator")}function hasSubMenu(e){return hasClass(e,"htSubmenu")}function isDisabled(e){return hasClass(e,"htDisabled")}function isSelectionDisabled(e){return hasClass(e,"htSelectionDisabled")}function getValidSelection(e){var t=e.getSelected();return!t||t[0]<0?null:t}function prepareVerticalAlignClass(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function prepareHorizontalAlignClass(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function getAlignmentClasses(e,t){var r={};return arrayEach(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function align(e,t,r,n,o){arrayEach(e,function(i){i.forAll(function(a,s){a>=0&&s>=0&&applyAlignClassName(a,s,t,r,n,o)})})}function applyAlignClassName(e,t,r,n,o,i){var a=o(e,t),s=n;a.className&&(r==="vertical"?s=prepareVerticalAlignClass(a.className,n):s=prepareHorizontalAlignClass(a.className,n)),i(e,t,"className",s)}function checkSelectionConsistency(e,t){var r=!1;return Array.isArray(e)&&arrayEach(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function markLabelAsSelected(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function isItemHidden(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function shiftSeparators(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function popSeparators(e,t){var r=e.slice(0);return r.reverse(),r=shiftSeparators(r,t),r.reverse(),r}function removeDuplicatedSeparators(e){var t=[];return arrayEach(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function filterSeparators(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:KEY$c,r=e.slice(0);return r=shiftSeparators(r,t),r=popSeparators(r,t),r=removeDuplicatedSeparators(r),r}function _typeof$1e(e){return _typeof$1e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1e(e)}function _classCallCheck$19(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$19(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1d(n.key),n)}}function _createClass$19(e,t,r){return t&&_defineProperties$19(e.prototype,t),r&&_defineProperties$19(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1d(e){var t=_toPrimitive$1d(e,"string");return _typeof$1e(t)==="symbol"?t:String(t)}function _toPrimitive$1d(e,t){if(_typeof$1e(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1e(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DEFAULT_DISPLAY_DELAY=250,DEFAULT_HIDE_DELAY=250,DisplaySwitch=function(){function e(t){_classCallCheck$19(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return _createClass$19(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},DEFAULT_HIDE_DELAY)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DEFAULT_DISPLAY_DELAY;this.showDebounced=debounce(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();mixin(DisplaySwitch,localHooks$1);const DisplaySwitch$1=DisplaySwitch;function _typeof$1d(e){return _typeof$1d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1d(e)}function _defineProperty$e(e,t,r){return t=_toPropertyKey$1c(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck$18(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$18(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1c(n.key),n)}}function _createClass$18(e,t,r){return t&&_defineProperties$18(e.prototype,t),r&&_defineProperties$18(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1c(e){var t=_toPrimitive$1c(e,"string");return _typeof$1d(t)==="symbol"?t:String(t)}function _toPrimitive$1c(e,t){if(_typeof$1d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$y(){return typeof Reflect<"u"&&Reflect.get?_get$y=Reflect.get.bind():_get$y=function(t,r,n){var o=_superPropBase$y(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$y.apply(this,arguments)}function _superPropBase$y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$G(e),e!==null););return e}function _inherits$G(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$G(e,t)}function _setPrototypeOf$G(e,t){return _setPrototypeOf$G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$G(e,t)}function _createSuper$G(e){var t=_isNativeReflectConstruct$G();return function(){var n=_getPrototypeOf$G(e),o;if(t){var i=_getPrototypeOf$G(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$G(this,o)}}function _possibleConstructorReturn$G(e,t){if(t&&(_typeof$1d(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$G(e)}function _assertThisInitialized$G(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$G(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$G(e){return _getPrototypeOf$G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$G(e)}var PLUGIN_KEY$p="comments",PLUGIN_PRIORITY$o=60,privatePool$d=new WeakMap,META_COMMENT="comment",META_COMMENT_VALUE="value",META_STYLE="style",META_READONLY="readOnly",Comments=function(e){_inherits$G(r,e);var t=_createSuper$G(r);function r(n){var o;return _classCallCheck$18(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,privatePool$d.set(_assertThisInitialized$G(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return _createClass$18(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$p]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new CommentEditor$1(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new EventManager$1(this)),this.displaySwitch||(this.displaySwitch=new DisplaySwitch$1(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,s,l,u,c){return o.onAfterRenderer(i,c)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),_get$y(_getPrototypeOf$G(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$y(_getPrototypeOf$G(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){_get$y(_getPrototypeOf$G(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=closest(o.target,"TD","TBODY");return!!(i&&hasClass(i,"htCommentCell")&&closest(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var s=this.range.from.row,l=this.range.from.col;this.updateCommentMeta(s,l,_defineProperty$e({},META_COMMENT_VALUE,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,META_COMMENT),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,META_COMMENT_VALUE)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,META_COMMENT_VALUE)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(s[META_COMMENT]?s[META_COMMENT][META_COMMENT_VALUE]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var s=this.hot,l=s.rowIndexMapper,u=s.columnIndexMapper,c=this.range.from,f=c.row,d=c.col,h=l.getRenderableFromVisualIndex(f),y=u.getRenderableFromVisualIndex(d),p=h===null;this.editor.setPosition(0,0),h===null&&(h=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,-1))),y===null&&(y=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(d,-1)));var v=h===null,b=y===null;h=(o=h)!==null&&o!==void 0?o:0,y=(i=y)!==null&&i!==void 0?i:0;var S=this.hot,w=S.rootWindow,P=S.view._wt,E=P.wtTable,j=P.getCell({row:h,col:y},!0),G=this.getCommentMeta(f,d,META_STYLE);G?this.editor.setSize(G.width,G.height):this.editor.resetSize();var q=b?0:E.getStretchedColumnWidth(y),z=p&&!v?outerHeight(j):0,U=j.getBoundingClientRect(),Z=U.left,te=U.top,Q=U.width,ie=U.height,he=this.editor.getSize(),ce=he.width,fe=he.height,I=this.hot.rootWindow,g=I.innerWidth,m=I.innerHeight,_=this.hot.rootDocument.documentElement,C=Z+w.scrollX+q,R=te+w.scrollY+z;this.hot.isRtl()&&(C-=ce+q),this.hot.isLtr()&&Z+Q+ce>g?C=Z+w.scrollX-ce-1:this.hot.isRtl()&&C<-(_.scrollWidth-_.clientWidth)&&(C=Z+w.scrollX+q+1),te+fe>m&&(R-=fe-ie+1),this.editor.setPosition(C,R),this.editor.setReadOnlyState(this.getCommentMeta(f,d,META_READONLY))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,META_COMMENT_VALUE)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var s=this.hot.getCellMeta(o,i)[META_COMMENT],l;s?(l=deepClone(s),deepExtend(l,a)):l=a,this.hot.setCellMeta(o,i,META_COMMENT,l)}},{key:"getCommentMeta",value:function(o,i,a){var s=this.hot.getCellMeta(o,i);if(s[META_COMMENT])return s[META_COMMENT][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=closest(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=privatePool$d.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||hasClass(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var s=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(s)}else isChildOf(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[META_COMMENT]&&i[META_COMMENT][META_COMMENT_VALUE]&&addClass(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=privatePool$d.get(this);i.tempEditorDimensions={width:outerWidth(o.target),height:outerHeight(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=privatePool$d.get(this),a=outerWidth(o.target),s=outerHeight(o.target);(a!==i.tempEditorDimensions.width+1||s!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,_defineProperty$e({},META_STYLE,{width:a,height:s}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,s){a>=0&&s>=0&&o.removeCommentAtCell(a,s,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,s){if(a>=0&&s>=0){var l=!!o.getCommentMeta(a,s,META_READONLY);o.updateCommentMeta(a,s,_defineProperty$e({},META_READONLY,!l))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(CONTEXTMENU_ITEMS_EDIT_COMMENT):i.hot.getTranslatedPhrase(CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var l=this,u=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY_COMMENT),c=checkSelectionConsistency(this.getSelectedRangeLast(),function(f,d){var h=l.getCellMeta(f,d)[META_COMMENT];if(h&&(h=h[META_READONLY]),h)return!0});return c&&(u=markLabelAsSelected(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[PLUGIN_KEY$p];if(isObject$6(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),_get$y(_getPrototypeOf$G(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$p}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$o}}]),r}(BasePlugin);function _typeof$1c(e){return _typeof$1c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1c(e)}function _classCallCheck$17(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$17(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1b(n.key),n)}}function _createClass$17(e,t,r){return t&&_defineProperties$17(e.prototype,t),r&&_defineProperties$17(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1b(e){var t=_toPrimitive$1b(e,"string");return _typeof$1c(t)==="symbol"?t:String(t)}function _toPrimitive$1b(e,t){if(_typeof$1c(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1c(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CommandExecutor=function(){function e(t){_classCallCheck$17(this,e),this.hot=t,this.commands={},this.commonCallback=null}return _createClass$17(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var s=r.split(":"),l=s[0],u=s.length===2?s[1]:null,c=this.commands[l];if(!c)throw new Error("Menu command '".concat(l,"' not exists."));if(u&&c.submenu&&(c=findSubCommand(u,c.submenu.items)),c.disabled!==!0&&!(typeof c.disabled=="function"&&c.disabled.call(this.hot)===!0)&&!hasOwnProperty$1(c,"submenu")){var f=[];typeof c.callback=="function"&&f.push(c.callback),typeof this.commonCallback=="function"&&f.push(this.commonCallback),i.unshift(s.join(":")),arrayEach(f,function(d){return d.apply(n.hot,i)})}}}]),e}();function findSubCommand(e,t){var r;return arrayEach(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const CommandExecutor$1=CommandExecutor;var KEY$b="alignment";function alignmentItem(){return{key:KEY$b,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(KEY$b,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_LEFT),n=checkSelectionConsistency(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=markLabelAsSelected(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=getAlignmentClasses(r,function(a,s){return t.getCellMeta(a,s).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),align(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(KEY$b,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_CENTER),n=checkSelectionConsistency(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=markLabelAsSelected(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=getAlignmentClasses(r,function(a,s){return t.getCellMeta(a,s).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),align(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(KEY$b,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT),n=checkSelectionConsistency(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=markLabelAsSelected(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=getAlignmentClasses(r,function(a,s){return t.getCellMeta(a,s).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),align(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(KEY$b,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY),n=checkSelectionConsistency(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=markLabelAsSelected(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=getAlignmentClasses(r,function(a,s){return t.getCellMeta(a,s).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),align(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{name:KEY$c},{key:"".concat(KEY$b,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_TOP),n=checkSelectionConsistency(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=markLabelAsSelected(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=getAlignmentClasses(r,function(a,s){return t.getCellMeta(a,s).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),align(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(KEY$b,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE),n=checkSelectionConsistency(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=markLabelAsSelected(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=getAlignmentClasses(r,function(a,s){return t.getCellMeta(a,s).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),align(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(KEY$b,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM),n=checkSelectionConsistency(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=markLabelAsSelected(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=getAlignmentClasses(r,function(a,s){return t.getCellMeta(a,s).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),align(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1}]}}}var KEY$a="clear_column";function clearColumnItem(){return{key:KEY$a,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=getValidSelection(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var KEY$9="col_left";function columnLeftItem(){return{key:KEY$9,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=getValidSelection(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var KEY$8="col_right";function columnRightItem(){return{key:KEY$8,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=getValidSelection(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var KEY$7="make_read_only";function readOnlyItem(){return{key:KEY$7,name:function(){var t=this,r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY),n=checkSelectionConsistency(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=markLabelAsSelected(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=checkSelectionConsistency(r,function(o,i){return t.getCellMeta(o,i).readOnly});arrayEach(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var KEY$6="redo";function redoItem(){return{key:KEY$6,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function _slicedToArray$s(e,t){return _arrayWithHoles$t(e)||_iterableToArrayLimit$s(e,t)||_unsupportedIterableToArray$E(e,t)||_nonIterableRest$t()}function _nonIterableRest$t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$E(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$E(e,t)}}function _arrayLikeToArray$E(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$s(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$t(e){if(Array.isArray(e))return e}var KEY$5="remove_col";function removeColumnItem(){return{key:KEY$5,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=_slicedToArray$s(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COLUMN,r)},callback:function(){this.alter("remove_col",transformSelectionToColumnDistance(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=getValidSelection(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function _slicedToArray$r(e,t){return _arrayWithHoles$s(e)||_iterableToArrayLimit$r(e,t)||_unsupportedIterableToArray$D(e,t)||_nonIterableRest$s()}function _nonIterableRest$s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$D(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$D(e,t)}}function _arrayLikeToArray$D(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$r(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$s(e){if(Array.isArray(e))return e}var KEY$4="remove_row";function removeRowItem(){return{key:KEY$4,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=_slicedToArray$r(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_ROW,r)},callback:function(){this.alter("remove_row",transformSelectionToRowDistance(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=getValidSelection(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var KEY$3="row_above";function rowAboveItem(){return{key:KEY$3,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=getValidSelection(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var KEY$2="row_below";function rowBelowItem(){return{key:KEY$2,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=getValidSelection(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var KEY$1="no_items";function noItemsItem(){return{key:KEY$1,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}var KEY="undo";function undoItem(){return{key:KEY,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function _typeof$1b(e){return _typeof$1b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1b(e)}var _predefinedItems2;function _defineProperty$d(e,t,r){return t=_toPropertyKey$1a(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$1a(e){var t=_toPrimitive$1a(e,"string");return _typeof$1b(t)==="symbol"?t:String(t)}function _toPrimitive$1a(e,t){if(_typeof$1b(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1b(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ITEMS=[KEY$3,KEY$2,KEY$9,KEY$8,KEY$a,KEY$4,KEY$5,KEY,KEY$6,KEY$7,KEY$b,KEY$c,KEY$1],_predefinedItems=(_predefinedItems2={},_defineProperty$d(_predefinedItems2,KEY$c,separatorItem),_defineProperty$d(_predefinedItems2,KEY$1,noItemsItem),_defineProperty$d(_predefinedItems2,KEY$3,rowAboveItem),_defineProperty$d(_predefinedItems2,KEY$2,rowBelowItem),_defineProperty$d(_predefinedItems2,KEY$9,columnLeftItem),_defineProperty$d(_predefinedItems2,KEY$8,columnRightItem),_defineProperty$d(_predefinedItems2,KEY$a,clearColumnItem),_defineProperty$d(_predefinedItems2,KEY$4,removeRowItem),_defineProperty$d(_predefinedItems2,KEY$5,removeColumnItem),_defineProperty$d(_predefinedItems2,KEY,undoItem),_defineProperty$d(_predefinedItems2,KEY$6,redoItem),_defineProperty$d(_predefinedItems2,KEY$7,readOnlyItem),_defineProperty$d(_predefinedItems2,KEY$b,alignmentItem),_predefinedItems2);function predefinedItems(){var e={};return objectEach(_predefinedItems,function(t,r){e[r]=t()}),e}function _typeof$1a(e){return _typeof$1a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1a(e)}function _classCallCheck$16(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$16(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$19(n.key),n)}}function _createClass$16(e,t,r){return t&&_defineProperties$16(e.prototype,t),r&&_defineProperties$16(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$19(e){var t=_toPrimitive$19(e,"string");return _typeof$1a(t)==="symbol"?t:String(t)}function _toPrimitive$19(e,t){if(_typeof$1a(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1a(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ItemsFactory=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;_classCallCheck$16(this,e),this.hot=t,this.predefinedItems=predefinedItems(),this.defaultOrderPattern=r}return _createClass$16(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,objectEach(r,function(i,a){var s="";i.name===KEY$c?(o[KEY$c]=i,s=KEY$c):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,s=i.key):(o[i.key]=i,s=i.key),n.defaultOrderPattern.push(s)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return _getItems(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function _getItems(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),isObject$6(o)?objectEach(o,function(i,a){var s=r[typeof i=="string"?i:a];s||(s=i),isObject$6(i)?extend$1(s,i):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=a),n.push(s)}):arrayEach(o,function(i,a){var s=r[i];!s&&ITEMS.indexOf(i)>=0||(s||(s={name:i,key:"".concat(a)}),isObject$6(i)&&extend$1(s,i),s.key===void 0&&(s.key=a),n.push(s))}),n}const ItemsFactory$1=ItemsFactory;function _typeof$19(e){return _typeof$19=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$19(e)}function _classCallCheck$15(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$15(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$18(n.key),n)}}function _createClass$15(e,t,r){return t&&_defineProperties$15(e.prototype,t),r&&_defineProperties$15(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$18(e){var t=_toPrimitive$18(e,"string");return _typeof$19(t)==="symbol"?t:String(t)}function _toPrimitive$18(e,t){if(_typeof$19(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$19(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cursor=function(){function e(t,r){_classCallCheck$15(this,e);var n=getWindowScrollTop(r),o=getWindowScrollLeft(r),i,a,s,l,u,c;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),s=parseInt(t.left,10),u=t.height||0,c=t.width||0,a=i,l=s,i+=n,s+=o):this.type==="event"&&(i=parseInt(t.pageY,10),s=parseInt(t.pageX,10),u=t.target.clientHeight,c=t.target.clientWidth,a=i-n,l=s-o),this.top=i,this.topRelative=a,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=c}return _createClass$15(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const Cursor$1=Cursor;function _typeof$18(e){return _typeof$18=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$18(e)}function ownKeys$6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$6(Object(r),!0).forEach(function(n){_defineProperty$c(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$c(e,t,r){return t=_toPropertyKey$17(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck$14(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$14(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$17(n.key),n)}}function _createClass$14(e,t,r){return t&&_defineProperties$14(e.prototype,t),r&&_defineProperties$14(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$17(e){var t=_toPrimitive$17(e,"string");return _typeof$18(t)==="symbol"?t:String(t)}function _toPrimitive$17(e,t){if(_typeof$18(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$18(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MIN_WIDTH=215,SHORTCUTS_CONTEXT="menu",SHORTCUTS_GROUP$3=SHORTCUTS_CONTEXT,Menu=function(){function e(t,r){_classCallCheck$14(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:MIN_WIDTH,container:this.hot.rootDocument.documentElement},this.eventManager=new EventManager$1(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return _createClass$14(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=getParentWindow(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=debounce(function(h){return r.openSubMenu(h)},300),o=this.options.minWidth||MIN_WIDTH,i=!1,a=arrayFilter(this.menuItems,function(h){return h.key===KEY$1&&(i=!0),isItemHidden(h,r.hot)});if(a.length<1&&!i)a.push(predefinedItems()[KEY$1]);else if(a.length===0)return;a=filterSeparators(a,KEY$c);var s=!1,l={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(y){return isDefined(y)&&y<o?o:y},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(y,p,v,b,S,w){return r.menuItemRenderer(y,p,v,b,S,w)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(y,p){r.isAllSubMenusClosed()?n(p.row):r.openSubMenu(p.row)},rowHeights:function(y){return a[y].name===KEY$c?1:23},afterOnCellContextMenu:function(y){y.preventDefault(),isWindowsOS()&&s&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(y){r.hasSelectedItem()&&(s=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(y))},afterOnCellMouseUp:function(y){(!isWindowsOS()||!isRightClick(y))&&s&&r.hasSelectedItem()&&(isMobileBrowser()||isIpadOS()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new Core(this.container,l),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),c=u.addContext(SHORTCUTS_GROUP$3),f={group:SHORTCUTS_CONTEXT},d=_objectSpread$6(_objectSpread$6({},f),{},{runOnlyIf:function(y){return isInput(y.target)===!1||r.container.contains(y.target)===!1}});u.setActiveContextName("menu"),c.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var y=r.hotMenu.getSelectedLast();r.keyEvent=!0,y?r.selectNextCell(y[0],y[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var y=r.hotMenu.getSelectedLast();r.keyEvent=!0,y?r.selectPrevCell(y[0],y[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var y=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,y){var p=r.openSubMenu(y[0]);p&&p.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var y=r.hotMenu.getSelectedLast();r.keyEvent=!0,y&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(y){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(p[0]).submenu||(r.executeCommand(y),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var y=r.hotMenu.getSelectedLast();r.keyEvent=!0,y?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var y=r.hotMenu.getSelectedLast();r.keyEvent=!0,y?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],d),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!hasSubMenu(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;arrayEach(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?normalizeSelection(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,s=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===KEY$c||s===!0||a}},{key:"setPosition",value:function(r){var n=new Cursor$1(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);isSeparator(r)||isDisabled(r)||isSelectionDisabled(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);isSeparator(n)||isDisabled(n)||isSelectionDisabled(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(isSeparator(i)||isDisabled(i)||isSelectionDisabled(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(isSeparator(i)||isDisabled(i)||isSelectionDisabled(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,s){var l=this,u=r.getSourceDataAtRow(o),c=this.hot.rootDocument.createElement("div"),f=function(b){return hasOwnProperty$1(b,"submenu")},d=function(b){return new RegExp(KEY$c,"i").test(b.name)},h=function(b){return b.disabled===!0||typeof b.disabled=="function"&&b.disabled.call(l.hot)===!0},y=function(b){return b.disableSelection},p=s;typeof p=="function"&&(p=p.call(this.hot)),empty(n),addClass(c,"htItemWrapper"),n.appendChild(c),d(u)?addClass(n,"htSeparator"):typeof u.renderer=="function"?(addClass(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,c,o,i,a,p))):fastInnerHTML(c,p),h(u)?(addClass(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):y(u)?(addClass(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):f(u)?(addClass(n,"htSubmenu"),y(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(removeClass(n,["htSubmenu","htDisabled"]),y(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(isFunction(o)&&(o=o.call(this.hot),o===null||isUndefined(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),addClass(i,"htMenu ".concat(this.options.className)),o&&addClass(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),s=arrayReduce$1(n,function(l,u){return l+(u.name===KEY$c?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(s+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!isChildOf(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!isChildOf(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&hasClass(r.target,"htCore")&&isChildOf(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();mixin(Menu,localHooks$1);const Menu$1=Menu;function _typeof$17(e){return _typeof$17=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$17(e)}function _classCallCheck$13(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$13(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$16(n.key),n)}}function _createClass$13(e,t,r){return t&&_defineProperties$13(e.prototype,t),r&&_defineProperties$13(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$16(e){var t=_toPrimitive$16(e,"string");return _typeof$17(t)==="symbol"?t:String(t)}function _toPrimitive$16(e,t){if(_typeof$17(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$17(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$x(){return typeof Reflect<"u"&&Reflect.get?_get$x=Reflect.get.bind():_get$x=function(t,r,n){var o=_superPropBase$x(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$x.apply(this,arguments)}function _superPropBase$x(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$F(e),e!==null););return e}function _inherits$F(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$F(e,t)}function _setPrototypeOf$F(e,t){return _setPrototypeOf$F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$F(e,t)}function _createSuper$F(e){var t=_isNativeReflectConstruct$F();return function(){var n=_getPrototypeOf$F(e),o;if(t){var i=_getPrototypeOf$F(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$F(this,o)}}function _possibleConstructorReturn$F(e,t){if(t&&(_typeof$17(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$F(e)}function _assertThisInitialized$F(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$F(e){return _getPrototypeOf$F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$F(e)}var PLUGIN_KEY$o="contextMenu",PLUGIN_PRIORITY$n=70;Hooks$1.getSingleton().register("afterContextMenuDefaultOptions");Hooks$1.getSingleton().register("beforeContextMenuShow");Hooks$1.getSingleton().register("afterContextMenuShow");Hooks$1.getSingleton().register("afterContextMenuHide");Hooks$1.getSingleton().register("afterContextMenuExecute");var ContextMenu=function(e){_inherits$F(r,e);var t=_createSuper$F(r);function r(n){var o;return _classCallCheck$13(this,r),o=t.call(this,n),o.eventManager=new EventManager$1(_assertThisInitialized$F(o)),o.commandExecutor=new CommandExecutor$1(o.hot),o.itemsFactory=null,o.menu=null,o}return _createClass$13(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$o]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[PLUGIN_KEY$o];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new Menu$1(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(l))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),_get$x(_getPrototypeOf$F(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$x(_getPrototypeOf$F(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),_get$x(_getPrototypeOf$F(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,c=l.left;i=u-getWindowScrollTop(o.view),a=c-getWindowScrollLeft(o.view)}else i=-1*getWindowScrollTop(this.menu.hotMenu.rootWindow),a=-1*getWindowScrollLeft(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(i=this.commandExecutor).execute.apply(i,[o].concat(s))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new ItemsFactory$1(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[PLUGIN_KEY$o],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var s=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),arrayEach(s,function(l){return o.commandExecutor.registerCommand(l.key,l)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,s=i.colHeaders;function l(c){return c.nodeName==="TD"||c.parentNode.nodeName==="TD"}var u=o.target;this.close(),!hasClass(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||s)&&!l(u)&&!(hasClass(u,"current")&&hasClass(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),_get$x(_getPrototypeOf$F(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$o}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$n}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[KEY$3,KEY$2,KEY$c,KEY$9,KEY$8,KEY$c,KEY$4,KEY$5,KEY$c,KEY,KEY$6,KEY$c,KEY$7,KEY$c,KEY$b]}}]),r}(BasePlugin);ContextMenu.SEPARATOR={name:KEY$c};function copyItem(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function copyColumnHeadersOnlyItem(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function copyWithColumnGroupHeadersItem(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function copyWithColumnHeadersItem(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function cutItem(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CUT)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function _typeof$16(e){return _typeof$16=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$16(e)}function _classCallCheck$12(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$12(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$15(n.key),n)}}function _createClass$12(e,t,r){return t&&_defineProperties$12(e.prototype,t),r&&_defineProperties$12(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$15(e){var t=_toPrimitive$15(e,"string");return _typeof$16(t)==="symbol"?t:String(t)}function _toPrimitive$15(e,t){if(_typeof$16(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$16(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ClipboardData=function(){function e(){_classCallCheck$12(this,e),this.data={}}return _createClass$12(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function _typeof$15(e){return _typeof$15=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$15(e)}function _defineProperties$11(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$14(n.key),n)}}function _createClass$11(e,t,r){return t&&_defineProperties$11(e.prototype,t),r&&_defineProperties$11(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$14(e){var t=_toPrimitive$14(e,"string");return _typeof$15(t)==="symbol"?t:String(t)}function _toPrimitive$14(e,t){if(_typeof$15(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$15(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classCallCheck$11(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var PasteEvent=_createClass$11(function e(){_classCallCheck$11(this,e),this.clipboardData=new ClipboardData});function _typeof$14(e){return _typeof$14=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$14(e)}function _classCallCheck$10(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$10(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$13(n.key),n)}}function _createClass$10(e,t,r){return t&&_defineProperties$10(e.prototype,t),r&&_defineProperties$10(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$13(e){var t=_toPrimitive$13(e,"string");return _typeof$14(t)==="symbol"?t:String(t)}function _toPrimitive$13(e,t){if(_typeof$14(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$14(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FocusableWrapper=function(){function e(t){_classCallCheck$10(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new EventManager$1(this),this.listenersCount=new WeakSet,this.container=t}return _createClass$10(e,[{key:"useSecondaryElement",value:function(){var r=createOrGetSecondaryElement(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),forwardEventsToLocalHooks(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),forwardEventsToLocalHooks(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",isMobileBrowser()||selectElementIfAllowed(this.mainElement)}}]),e}();mixin(FocusableWrapper,localHooks$1);var refCounter=new WeakMap;function createElement(e){var t=new FocusableWrapper(e),r=refCounter.get(e);return r=isNaN(r)?0:r,refCounter.set(e,r+1),t}function deactivateElement(e){e.eventManager.clear()}var runLocalHooks=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function forwardEventsToLocalHooks(e,t,r){e.addEventListener(t,"copy",runLocalHooks("copy",r)),e.addEventListener(t,"cut",runLocalHooks("cut",r)),e.addEventListener(t,"paste",runLocalHooks("paste",r))}var secondaryElements=new WeakMap;function createOrGetSecondaryElement(e){var t=secondaryElements.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return secondaryElements.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function destroyElement(e){if(e instanceof FocusableWrapper){var t=refCounter.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),deactivateElement(e),t<=0){t=0;var r=secondaryElements.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),secondaryElements.delete(e.container)),e.mainElement=null}refCounter.set(e.container,t)}}function _typeof$13(e){return _typeof$13=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$13(e)}function _classCallCheck$$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$12(n.key),n)}}function _createClass$$(e,t,r){return t&&_defineProperties$$(e.prototype,t),r&&_defineProperties$$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$12(e){var t=_toPrimitive$12(e,"string");return _typeof$13(t)==="symbol"?t:String(t)}function _toPrimitive$12(e,t){if(_typeof$13(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$13(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateMethodInitSpec$1(e,t){_checkPrivateRedeclaration$8(e,t),t.add(e)}function _classPrivateFieldInitSpec$8(e,t,r){_checkPrivateRedeclaration$8(e,t),t.set(e,r)}function _checkPrivateRedeclaration$8(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateMethodGet$1(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function _classPrivateFieldGet$8(e,t){var r=_classExtractFieldDescriptor$8(e,t,"get");return _classApplyDescriptorGet$8(e,r)}function _classApplyDescriptorGet$8(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet$8(e,t,r){var n=_classExtractFieldDescriptor$8(e,t,"set");return _classApplyDescriptorSet$8(e,n,r),r}function _classExtractFieldDescriptor$8(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet$8(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var _selectedRange=new WeakMap,_countRows=new WeakMap,_countColumns=new WeakMap,_rowsLimit=new WeakMap,_columnsLimit$1=new WeakMap,_countColumnHeaders=new WeakMap,_trimColumnsRange=new WeakSet,_trimRowsRange=new WeakSet,CopyableRangesFactory=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;_classCallCheck$$(this,e),_classPrivateMethodInitSpec$1(this,_trimRowsRange),_classPrivateMethodInitSpec$1(this,_trimColumnsRange),_classPrivateFieldInitSpec$8(this,_selectedRange,{writable:!0,value:void 0}),_classPrivateFieldInitSpec$8(this,_countRows,{writable:!0,value:void 0}),_classPrivateFieldInitSpec$8(this,_countColumns,{writable:!0,value:void 0}),_classPrivateFieldInitSpec$8(this,_rowsLimit,{writable:!0,value:void 0}),_classPrivateFieldInitSpec$8(this,_columnsLimit$1,{writable:!0,value:void 0}),_classPrivateFieldInitSpec$8(this,_countColumnHeaders,{writable:!0,value:void 0}),_classPrivateFieldSet$8(this,_countRows,r),_classPrivateFieldSet$8(this,_countColumns,n),_classPrivateFieldSet$8(this,_rowsLimit,o),_classPrivateFieldSet$8(this,_columnsLimit$1,i),_classPrivateFieldSet$8(this,_countColumnHeaders,a)}return _createClass$$(e,[{key:"setSelectedRange",value:function(r){_classPrivateFieldSet$8(this,_selectedRange,r)}},{key:"getCellsRange",value:function(){if(_classPrivateFieldGet$8(this,_countRows).call(this)===0||_classPrivateFieldGet$8(this,_countColumns).call(this)===0)return null;var r=_classPrivateFieldGet$8(this,_selectedRange).getTopStartCorner(),n=r.row,o=r.col,i=_classPrivateFieldGet$8(this,_selectedRange).getBottomEndCorner(),a=i.row,s=i.col,l=_classPrivateMethodGet$1(this,_trimRowsRange,_trimRowsRange2).call(this,n,a),u=_classPrivateMethodGet$1(this,_trimColumnsRange,_trimColumnsRange2).call(this,o,s),c=a!==l||s!==u;return{isRangeTrimmed:c,startRow:n,startCol:o,endRow:l,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(_classPrivateFieldGet$8(this,_countColumns).call(this)===0||_classPrivateFieldGet$8(this,_countColumnHeaders).call(this)===0)return null;var r=_classPrivateFieldGet$8(this,_selectedRange).getTopStartCorner(),n=r.col,o=_classPrivateFieldGet$8(this,_selectedRange).getBottomEndCorner(),i=o.col,a=_classPrivateMethodGet$1(this,_trimColumnsRange,_trimColumnsRange2).call(this,n,i),s=i!==a;return{isRangeTrimmed:s,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(_classPrivateFieldGet$8(this,_countColumns).call(this)===0||_classPrivateFieldGet$8(this,_countColumnHeaders).call(this)===0)return null;var r=_classPrivateFieldGet$8(this,_selectedRange).getTopStartCorner(),n=r.col,o=_classPrivateFieldGet$8(this,_selectedRange).getBottomEndCorner(),i=o.col,a=_classPrivateMethodGet$1(this,_trimColumnsRange,_trimColumnsRange2).call(this,n,i),s=i!==a;return{isRangeTrimmed:s,startRow:-_classPrivateFieldGet$8(this,_countColumnHeaders).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function _trimColumnsRange2(e,t){return Math.min(t,Math.max(e+_classPrivateFieldGet$8(this,_columnsLimit$1).call(this)-1,e))}function _trimRowsRange2(e,t){return Math.min(t,Math.max(e+_classPrivateFieldGet$8(this,_rowsLimit).call(this)-1,e))}function normalizeRanges(e){var t=[],r=[];return arrayEach(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);rangeEach(o,i,function(l){t.indexOf(l)===-1&&t.push(l)});var a=Math.min(n.startCol,n.endCol),s=Math.max(n.startCol,n.endCol);rangeEach(a,s,function(l){r.indexOf(l)===-1&&r.push(l)})}),{rows:t,columns:r}}function _slicedToArray$q(e,t){return _arrayWithHoles$r(e)||_iterableToArrayLimit$q(e,t)||_unsupportedIterableToArray$C(e,t)||_nonIterableRest$r()}function _nonIterableRest$r(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$C(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$C(e,t)}}function _arrayLikeToArray$C(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$q(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$r(e){if(Array.isArray(e))return e}function _typeof$12(e){return _typeof$12=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$12(e)}function _classCallCheck$_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$11(n.key),n)}}function _createClass$_(e,t,r){return t&&_defineProperties$_(e.prototype,t),r&&_defineProperties$_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _get$w(){return typeof Reflect<"u"&&Reflect.get?_get$w=Reflect.get.bind():_get$w=function(t,r,n){var o=_superPropBase$w(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$w.apply(this,arguments)}function _superPropBase$w(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$E(e),e!==null););return e}function _inherits$E(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$E(e,t)}function _setPrototypeOf$E(e,t){return _setPrototypeOf$E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$E(e,t)}function _createSuper$E(e){var t=_isNativeReflectConstruct$E();return function(){var n=_getPrototypeOf$E(e),o;if(t){var i=_getPrototypeOf$E(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$E(this,o)}}function _possibleConstructorReturn$E(e,t){if(t&&(_typeof$12(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$E(e)}function _assertThisInitialized$E(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$E(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$E(e){return _getPrototypeOf$E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$E(e)}function _classPrivateMethodInitSpec(e,t){_checkPrivateRedeclaration$7(e,t),t.add(e)}function _classPrivateFieldInitSpec$7(e,t,r){_checkPrivateRedeclaration$7(e,t),t.set(e,r)}function _checkPrivateRedeclaration$7(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$b(e,t,r){return t=_toPropertyKey$11(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$11(e){var t=_toPrimitive$11(e,"string");return _typeof$12(t)==="symbol"?t:String(t)}function _toPrimitive$11(e,t){if(_typeof$12(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$12(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateMethodGet(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function _classPrivateFieldGet$7(e,t){var r=_classExtractFieldDescriptor$7(e,t,"get");return _classApplyDescriptorGet$7(e,r)}function _classApplyDescriptorGet$7(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet$7(e,t,r){var n=_classExtractFieldDescriptor$7(e,t,"set");return _classApplyDescriptorSet$7(e,n,r),r}function _classExtractFieldDescriptor$7(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet$7(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Hooks$1.getSingleton().register("afterCopyLimit");Hooks$1.getSingleton().register("modifyCopyableRange");Hooks$1.getSingleton().register("beforeCut");Hooks$1.getSingleton().register("afterCut");Hooks$1.getSingleton().register("beforePaste");Hooks$1.getSingleton().register("afterPaste");Hooks$1.getSingleton().register("beforeCopy");Hooks$1.getSingleton().register("afterCopy");var PLUGIN_KEY$n="copyPaste",PLUGIN_PRIORITY$m=80,SETTING_KEYS=["fragmentSelection"],META_HEAD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),_enableCopyColumnHeaders=new WeakMap,_enableCopyColumnGroupHeaders=new WeakMap,_enableCopyColumnHeadersOnly=new WeakMap,_copyMode=new WeakMap,_isTriggeredByCopy=new WeakMap,_isTriggeredByCut=new WeakMap,_copyableRangesFactory=new WeakMap,_countCopiedHeaders=new WeakSet,CopyPaste=function(e){_inherits$E(r,e);var t=_createSuper$E(r);function r(){var n;_classCallCheck$_(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_classPrivateMethodInitSpec(_assertThisInitialized$E(n),_countCopiedHeaders),_defineProperty$b(_assertThisInitialized$E(n),"columnsLimit",1/0),_defineProperty$b(_assertThisInitialized$E(n),"rowsLimit",1/0),_defineProperty$b(_assertThisInitialized$E(n),"pasteMode","overwrite"),_defineProperty$b(_assertThisInitialized$E(n),"uiContainer",n.hot.rootDocument.body),_classPrivateFieldInitSpec$7(_assertThisInitialized$E(n),_enableCopyColumnHeaders,{writable:!0,value:!1}),_classPrivateFieldInitSpec$7(_assertThisInitialized$E(n),_enableCopyColumnGroupHeaders,{writable:!0,value:!1}),_classPrivateFieldInitSpec$7(_assertThisInitialized$E(n),_enableCopyColumnHeadersOnly,{writable:!0,value:!1}),_classPrivateFieldInitSpec$7(_assertThisInitialized$E(n),_copyMode,{writable:!0,value:"cells-only"}),_classPrivateFieldInitSpec$7(_assertThisInitialized$E(n),_isTriggeredByCopy,{writable:!0,value:!1}),_classPrivateFieldInitSpec$7(_assertThisInitialized$E(n),_isTriggeredByCut,{writable:!0,value:!1}),_classPrivateFieldInitSpec$7(_assertThisInitialized$E(n),_copyableRangesFactory,{writable:!0,value:new CopyableRangesFactory({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),_defineProperty$b(_assertThisInitialized$E(n),"copyableRanges",[]),_defineProperty$b(_assertThisInitialized$E(n),"focusableElement",void 0),n}return _createClass$_(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$n]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[PLUGIN_KEY$n];if(_typeof$12(a)==="object"){var s,l;this.pasteMode=(s=a.pasteMode)!==null&&s!==void 0?s:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,_classPrivateFieldSet$7(this,_enableCopyColumnHeaders,!!a.copyColumnHeaders),_classPrivateFieldSet$7(this,_enableCopyColumnGroupHeaders,!!a.copyColumnGroupHeaders),_classPrivateFieldSet$7(this,_enableCopyColumnHeadersOnly,!!a.copyColumnHeadersOnly),this.uiContainer=(l=a.uiContainer)!==null&&l!==void 0?l:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=createElement(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),_get$w(_getPrototypeOf$E(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),_get$w(_getPrototypeOf$E(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&destroyElement(this.focusableElement),_get$w(_getPrototypeOf$E(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";_classPrivateFieldSet$7(this,_copyMode,o),_classPrivateFieldSet$7(this,_isTriggeredByCopy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){_classPrivateFieldSet$7(this,_isTriggeredByCut,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){return stringify(this.getRangedData(o))}},{key:"getRangedData",value:function(o){var i=this,a=[],s=normalizeRanges(o),l=s.rows,u=s.columns;return arrayEach(l,function(c){var f=[];arrayEach(u,function(d){c<0?f.push(i.hot.getColHeader(d,c)):f.push(i.hot.getCopyableData(c,d))}),a.push(f)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new PasteEvent;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){_classPrivateFieldGet$7(this,_copyableRangesFactory).setSelectedRange(o);var i=new Map([["headers",null],["cells",null]]);_classPrivateFieldGet$7(this,_copyMode)==="column-headers-only"?i.set("headers",_classPrivateFieldGet$7(this,_copyableRangesFactory).getMostBottomColumnHeadersRange()):(_classPrivateFieldGet$7(this,_copyMode)==="with-column-headers"?i.set("headers",_classPrivateFieldGet$7(this,_copyableRangesFactory).getMostBottomColumnHeadersRange()):_classPrivateFieldGet$7(this,_copyMode)==="with-column-group-headers"&&i.set("headers",_classPrivateFieldGet$7(this,_copyableRangesFactory).getAllColumnHeadersRange()),i.set("cells",_classPrivateFieldGet$7(this,_copyableRangesFactory).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(function(f){return f!==null}).map(function(f){var d=f.startRow,h=f.startCol,y=f.endRow,p=f.endCol;return{startRow:d,startCol:h,endRow:y,endCol:p}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=i.get("cells");if(a!==null&&a.isRangeTrimmed){var s=a.startRow,l=a.startCol,u=a.endRow,c=a.endCol;this.hot.runHooks("afterCopyLimit",u-s+1,c-l+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var o,i=(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.TEXTAREA;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o;return(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,s=o[0].length,l=[],u=i.getTopStartCorner(),c=u.row,f=u.col,d=i.getBottomEndCorner(),h=d.row,y=d.col,p=c,v=f,b=c,S=f;l.length<a||p<=h;){var w=this.hot.getCellMeta(p,f),P=w.skipRowOnPaste,E=w.visualRow;if(p=E+1,P!==!0){b=E,v=f;for(var j=[],G=l.length%a;j.length<s||v<=y;){var q=this.hot.getCellMeta(c,v),z=q.skipColumnOnPaste,U=q.visualCol;if(v=U+1,z!==!0){S=U;var Z=j.length%s;j.push(o[G][Z])}}l.push(j)}}return this.hot.populateFromArray(c,f,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[c,f,b,S]}}},{key:"onCopy",value:function(o){if(!(!this.hot.isListening()&&!_classPrivateFieldGet$7(this,_isTriggeredByCopy)||this.isEditorOpened())){this.setCopyableText(),_classPrivateFieldSet$7(this,_isTriggeredByCopy,!1);var i=this.getRangedData(this.copyableRanges),a=_classPrivateMethodGet(this,_countCopiedHeaders,_countCopiedHeaders2).call(this,this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a);if(s){var l=stringify(i);if(o&&o.clipboardData){var u=_dataToHTML(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[META_HEAD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",i,this.copyableRanges,a)}_classPrivateFieldSet$7(this,_copyMode,"cells-only"),o.preventDefault()}}},{key:"onCut",value:function(o){if(!(!this.hot.isListening()&&!_classPrivateFieldGet$7(this,_isTriggeredByCut)||this.isEditorOpened())){this.setCopyableText(),_classPrivateFieldSet$7(this,_isTriggeredByCut,!1);var i=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(a){var s=stringify(i);if(o&&o.clipboardData){var l=_dataToHTML(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[META_HEAD,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=sanitize(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var s=htmlToGridSettings(a,this.hot.rootDocument);i=s.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=parse(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var l=this.populateValues(i),u=_slicedToArray$q(l,4),c=u[0],f=u[1],d=u[2],h=u[3];this.hot.selectCell(c,f,Math.min(this.hot.countRows()-1,d),Math.min(this.hot.countCols()-1,h)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},copyItem(this)),_classPrivateFieldGet$7(this,_enableCopyColumnHeaders)&&o.items.push(copyWithColumnHeadersItem(this)),_classPrivateFieldGet$7(this,_enableCopyColumnGroupHeaders)&&o.items.push(copyWithColumnGroupHeadersItem(this)),_classPrivateFieldGet$7(this,_enableCopyColumnHeadersOnly)&&o.items.push(copyColumnHeadersOnlyItem(this)),o.items.push(cutItem(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&getSelectionText())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(destroyElement(this.focusableElement),this.focusableElement=null),_get$w(_getPrototypeOf$E(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$n}},{key:"SETTING_KEYS",get:function(){return[PLUGIN_KEY$n].concat(SETTING_KEYS)}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$m}}]),r}(BasePlugin);function _countCopiedHeaders2(e){for(var t=normalizeRanges(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function createId(e,t){return"border_row".concat(e,"col").concat(t)}function createDefaultCustomBorder(){return{width:1,color:"#000"}}function createSingleEmptyBorder(){return{hide:!0}}function createDefaultHtBorder(){return{width:1,color:"#000",cornerVisible:!1}}function normalizeBorder(e){if(isDefined(e.start)||isDefined(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(isDefined(e.end)||isDefined(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function denormalizeBorder(e){return isDefined(e.start)&&(e.left=e.start),isDefined(e.end)&&(e.right=e.end),e}function createEmptyBorders(e,t){return{id:createId(e,t),border:createDefaultHtBorder(),row:e,col:t,top:createSingleEmptyBorder(),bottom:createSingleEmptyBorder(),start:createSingleEmptyBorder(),end:createSingleEmptyBorder()}}function extendDefaultBorder(e,t){return hasOwnProperty$1(t,"border")&&t.border&&(e.border=t.border),hasOwnProperty$1(t,"top")&&isDefined(t.top)&&(t.top?(isObject$6(t.top)||(t.top=createDefaultCustomBorder()),e.top=t.top):(t.top=createSingleEmptyBorder(),e.top=t.top)),hasOwnProperty$1(t,"bottom")&&isDefined(t.bottom)&&(t.bottom?(isObject$6(t.bottom)||(t.bottom=createDefaultCustomBorder()),e.bottom=t.bottom):(t.bottom=createSingleEmptyBorder(),e.bottom=t.bottom)),hasOwnProperty$1(t,"start")&&isDefined(t.start)&&(t.start?(isObject$6(t.start)||(t.start=createDefaultCustomBorder()),e.start=t.start):(t.start=createSingleEmptyBorder(),e.start=t.start)),hasOwnProperty$1(t,"end")&&isDefined(t.end)&&(t.end?(isObject$6(t.end)||(t.end=createDefaultCustomBorder()),e.end=t.end):(t.end=createSingleEmptyBorder(),e.end=t.end)),e}function checkSelectionBorders(e,t){var r=!1;return arrayEach(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!hasOwnProperty$1(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function markSelected(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function hasLeftRightTypeOptions(e){return e.some(function(t){return isDefined(t.left)||isDefined(t.right)})}function hasStartEndTypeOptions(e){return e.some(function(t){return isDefined(t.start)||isDefined(t.end)})}var physicalToInlinePropNames=new Map([["left","start"],["right","end"]]);function toInlinePropName(e){var t;return(t=physicalToInlinePropNames.get(e))!==null&&t!==void 0?t:e}function bottom(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_BOTTOM),n=checkSelectionBorders(this,"bottom");return n&&(r=markSelected(r)),r},callback:function(r,n){var o=checkSelectionBorders(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function left(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_LEFT),o=checkSelectionBorders(this,t);return o&&(n=markSelected(n)),n},callback:function(n,o){var i=checkSelectionBorders(this,t);e.prepareBorder(o,t,i)}}}function noBorders(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!checkSelectionBorders(this)}}}function right(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_RIGHT),o=checkSelectionBorders(this,t);return o&&(n=markSelected(n)),n},callback:function(n,o){var i=checkSelectionBorders(this,t);e.prepareBorder(o,t,i)}}}function top(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_TOP),n=checkSelectionBorders(this,"top");return n&&(r=markSelected(r)),r},callback:function(r,n){var o=checkSelectionBorders(this,"top");e.prepareBorder(n,"top",o)}}}function _typeof$11(e){return _typeof$11=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$11(e)}function _slicedToArray$p(e,t){return _arrayWithHoles$q(e)||_iterableToArrayLimit$p(e,t)||_unsupportedIterableToArray$B(e,t)||_nonIterableRest$q()}function _nonIterableRest$q(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$B(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$B(e,t)}}function _arrayLikeToArray$B(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$p(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$q(e){if(Array.isArray(e))return e}function _classCallCheck$Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$10(n.key),n)}}function _createClass$Z(e,t,r){return t&&_defineProperties$Z(e.prototype,t),r&&_defineProperties$Z(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _get$v(){return typeof Reflect<"u"&&Reflect.get?_get$v=Reflect.get.bind():_get$v=function(t,r,n){var o=_superPropBase$v(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$v.apply(this,arguments)}function _superPropBase$v(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$D(e),e!==null););return e}function _inherits$D(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$D(e,t)}function _setPrototypeOf$D(e,t){return _setPrototypeOf$D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$D(e,t)}function _createSuper$D(e){var t=_isNativeReflectConstruct$D();return function(){var n=_getPrototypeOf$D(e),o;if(t){var i=_getPrototypeOf$D(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$D(this,o)}}function _possibleConstructorReturn$D(e,t){if(t&&(_typeof$11(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$D(e)}function _assertThisInitialized$D(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$D(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$D(e){return _getPrototypeOf$D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$D(e)}function _defineProperty$a(e,t,r){return t=_toPropertyKey$10(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$10(e){var t=_toPrimitive$10(e,"string");return _typeof$11(t)==="symbol"?t:String(t)}function _toPrimitive$10(e,t){if(_typeof$11(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$11(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PLUGIN_KEY$m="customBorders",PLUGIN_PRIORITY$l=90,CustomBorders=function(e){_inherits$D(r,e);var t=_createSuper$D(r);function r(){var n;_classCallCheck$Z(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_defineProperty$a(_assertThisInitialized$D(n),"savedBorders",[]),n}return _createClass$Z(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$m]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),_get$v(_getPrototypeOf$D(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),_get$v(_getPrototypeOf$D(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),_get$v(_getPrototypeOf$D(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,s=["top","bottom","start","end"],l=null;i&&(this.checkSettingsCohesion([i]),s=Object.keys(i),l=normalizeBorder(i));var u=detectSelectionType(o),c=normalizeSelectionFactory(u);arrayEach(o,function(f){for(var d=c(f),h=_slicedToArray$p(d,4),y=h[0],p=h[1],v=h[2],b=h[3],S=function(E){for(var j=function(z){arrayEach(s,function(U){a.prepareBorderFromCustomAdded(E,z,l,toInlinePropName(U))})},G=p;G<=b;G+=1)j(G)},w=y;w<=v;w+=1)S(w)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=detectSelectionType(o),s=normalizeSelectionFactory(a),l=[];return arrayEach(o,function(u){for(var c=s(u),f=_slicedToArray$p(c,4),d=f[0],h=f[1],y=f[2],p=f[3],v=function(w){for(var P=function(G){arrayEach(i.savedBorders,function(q){q.row===w&&q.col===G&&l.push(denormalizeBorder(q))})},E=h;E<=p;E+=1)P(E)},b=d;b<=y;b+=1)v(b)}),l}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):(arrayEach(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var s=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),l=this.checkCustomSelections(o,s,i);l||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:s})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,s){var l=this.hot.countRows(),u=this.hot.countCols();if(!(o>=l||i>=u)){var c=createEmptyBorders(o,i);a&&(c=extendDefaultBorder(c,a),arrayEach(this.hot.selection.highlight.customSelections,function(f){if(c.id===f.settings.id)return Object.assign(f.settings,a),c.id=f.settings.id,c.top=f.settings.top,c.bottom=f.settings.bottom,c.start=f.settings.start,c.end=f.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",denormalizeBorder(c)),this.insertBorderIntoSettings(c,s)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,s=Math.min(o.to.row,this.hot.countRows()-1),l=Math.min(o.to.col,this.hot.countCols()-1);rangeEach(o.from.row,s,function(u){rangeEach(o.from.col,l,function(c){var f=createEmptyBorders(u,c),d=0;u===o.from.row&&hasOwnProperty$1(i,"top")&&(d+=1,f.top=i.top),u===o.to.row&&hasOwnProperty$1(i,"bottom")&&(d+=1,f.bottom=i.bottom),c===o.from.col&&hasOwnProperty$1(i,"start")&&(d+=1,f.start=i.start),c===o.to.col&&hasOwnProperty$1(i,"end")&&(d+=1,f.end=i.end),d>0&&(a.hot.setCellMeta(u,c,"borders",denormalizeBorder(f)),a.insertBorderIntoSettings(f))})})}},{key:"removeAllBorders",value:function(o,i){var a=createId(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,s){var l=this.hot.getCellMeta(o,i).borders;if(!l||l.border===void 0?l=createEmptyBorders(o,i):l=normalizeBorder(l),s){l[a]=createSingleEmptyBorder();var u=this.countHide(l);if(u===4)this.removeAllBorders(o,i);else{var c=this.checkCustomSelectionsFromContextMenu(l,a,s);c||this.insertBorderIntoSettings(l),this.hot.setCellMeta(o,i,"borders",denormalizeBorder(l))}}else{l[a]=createDefaultCustomBorder();var f=this.checkCustomSelectionsFromContextMenu(l,a,s);f||this.insertBorderIntoSettings(l),this.hot.setCellMeta(o,i,"borders",denormalizeBorder(l))}}},{key:"prepareBorder",value:function(o,i,a){var s=this;arrayEach(o,function(l){var u=l.start,c=l.end;if(u.row===c.row&&u.col===c.col)i==="noBorders"?s.removeAllBorders(u.row,u.col):s.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":rangeEach(u.col,c.col,function(f){rangeEach(u.row,c.row,function(d){s.removeAllBorders(d,f)})});break;case"top":rangeEach(u.col,c.col,function(f){s.setBorder(u.row,f,i,a)});break;case"bottom":rangeEach(u.col,c.col,function(f){s.setBorder(c.row,f,i,a)});break;case"start":rangeEach(u.row,c.row,function(f){s.setBorder(f,u.col,i,a)});break;case"end":rangeEach(u.row,c.row,function(f){s.setBorder(f,c.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;arrayEach(o,function(a){var s=normalizeBorder(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,s):i.prepareBorderFromCustomAdded(a.row,a.col,s)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,s=o.start,l=o.end,u=[i,a,s,l];return arrayReduce$1(u,function(c,f){var d=c;return f&&f.hide&&(d+=1),d},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=arrayMap(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;arrayEach(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;arrayEach(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=arrayMap(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,s=this.countHide(o);return s===4?(this.spliceBorder(o.id),a=!0):arrayEach(this.savedBorders,function(l,u){if(o.id===l.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var s=!1;return arrayEach(this.hot.selection.highlight.customSelections,function(l){if(o.id===l.settings.id)return objectEach(l.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),s=!0,!1}),s}},{key:"checkCustomSelections",value:function(o,i,a){var s=this.countHide(o),l=!1;return s===4?(this.removeAllBorders(o.row,o.col),l=!0):arrayEach(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&objectEach(u.instanceBorders,function(c){c.changeBorderStyle(a,o)}),l=!0,!1}),l}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[PLUGIN_KEY$m];if(Array.isArray(o)){var i=deepClone(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=hasLeftRightTypeOptions(o),a=hasStartEndTypeOptions(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[PLUGIN_KEY$m]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[top(this),right(this),bottom(this),left(this),noBorders(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){_get$v(_getPrototypeOf$D(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$m}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$l}}]),r}(BasePlugin);function _typeof$10(e){return _typeof$10=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$10(e)}function _classCallCheck$Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$$(n.key),n)}}function _createClass$Y(e,t,r){return t&&_defineProperties$Y(e.prototype,t),r&&_defineProperties$Y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$$(e){var t=_toPrimitive$$(e,"string");return _typeof$10(t)==="symbol"?t:String(t)}function _toPrimitive$$(e,t){if(_typeof$10(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$10(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$u(){return typeof Reflect<"u"&&Reflect.get?_get$u=Reflect.get.bind():_get$u=function(t,r,n){var o=_superPropBase$u(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$u.apply(this,arguments)}function _superPropBase$u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$C(e),e!==null););return e}function _inherits$C(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$C(e,t)}function _setPrototypeOf$C(e,t){return _setPrototypeOf$C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$C(e,t)}function _createSuper$C(e){var t=_isNativeReflectConstruct$C();return function(){var n=_getPrototypeOf$C(e),o;if(t){var i=_getPrototypeOf$C(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$C(this,o)}}function _possibleConstructorReturn$C(e,t){if(t&&(_typeof$10(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$C(e)}function _assertThisInitialized$C(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$C(e){return _getPrototypeOf$C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$C(e)}var PLUGIN_KEY$l="dragToScroll",PLUGIN_PRIORITY$k=100,DragToScroll=function(e){_inherits$C(r,e);var t=_createSuper$C(r);function r(n){var o;return _classCallCheck$Y(this,r),o=t.call(this,n),o.eventManager=new EventManager$1(_assertThisInitialized$C(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return _createClass$Y(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$l]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),_get$u(_getPrototypeOf$C(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$u(_getPrototypeOf$C(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),_get$u(_getPrototypeOf$C(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,s=0;i<this.boundaries.top?s=i-this.boundaries.top:i>this.boundaries.bottom&&(s=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,s)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(s){return o.onMouseMove(s)}),a=getParentWindow(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!isRightClick(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,s){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),s<0?i.scrollTop-=20:s>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){_get$u(_getPrototypeOf$C(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$l}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$k}}]),r}(BasePlugin);function _typeof$$(e){return _typeof$$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$$(e)}function _classCallCheck$X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$_(n.key),n)}}function _createClass$X(e,t,r){return t&&_defineProperties$X(e.prototype,t),r&&_defineProperties$X(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$_(e){var t=_toPrimitive$_(e,"string");return _typeof$$(t)==="symbol"?t:String(t)}function _toPrimitive$_(e,t){if(_typeof$$(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$$(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$t(){return typeof Reflect<"u"&&Reflect.get?_get$t=Reflect.get.bind():_get$t=function(t,r,n){var o=_superPropBase$t(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$t.apply(this,arguments)}function _superPropBase$t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$B(e),e!==null););return e}function _inherits$B(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$B(e,t)}function _setPrototypeOf$B(e,t){return _setPrototypeOf$B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$B(e,t)}function _createSuper$B(e){var t=_isNativeReflectConstruct$B();return function(){var n=_getPrototypeOf$B(e),o;if(t){var i=_getPrototypeOf$B(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$B(this,o)}}function _possibleConstructorReturn$B(e,t){if(t&&(_typeof$$(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$B(e)}function _assertThisInitialized$B(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$B(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$B(e){return _getPrototypeOf$B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$B(e)}Hooks$1.getSingleton().register("afterDropdownMenuDefaultOptions");Hooks$1.getSingleton().register("beforeDropdownMenuShow");Hooks$1.getSingleton().register("afterDropdownMenuShow");Hooks$1.getSingleton().register("afterDropdownMenuHide");Hooks$1.getSingleton().register("afterDropdownMenuExecute");var PLUGIN_KEY$k="dropdownMenu",PLUGIN_PRIORITY$j=230,BUTTON_CLASS_NAME="changeType",DropdownMenu=function(e){_inherits$B(r,e);var t=_createSuper$B(r);function r(n){var o;return _classCallCheck$X(this,r),o=t.call(this,n),o.eventManager=new EventManager$1(_assertThisInitialized$B(o)),o.commandExecutor=new CommandExecutor$1(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return _createClass$X(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[PLUGIN_KEY$k]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new ItemsFactory$1(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[PLUGIN_KEY$k],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),_get$t(_getPrototypeOf$B(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var s=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new Menu$1(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",s),o.menu.setMenuItems(s),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var l,u=arguments.length,c=new Array(u),f=0;f<u;f++)c[f]=arguments[f];return(l=o.executeCommand).call.apply(l,[o].concat(c))}),arrayEach(s,function(l){return o.commandExecutor.registerCommand(l.key,l)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$t(_getPrototypeOf$B(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),_get$t(_getPrototypeOf$B(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(i=this.commandExecutor).execute.apply(i,[o].concat(s))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),hasClass(o.target,BUTTON_CLASS_NAME)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,c=l.left;i=u,a=c}var f=o.target.getBoundingClientRect();this.open({left:f.left+a,top:f.top+o.target.offsetHeight+3+i,width:f.width,height:f.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var s=a.parentNode.childNodes,l=Array.prototype.indexOf.call(s,a);if(!(o<0||l!==s.length-1)){var u=i.querySelector(".".concat(BUTTON_CLASS_NAME));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var c=this.hot.rootDocument.createElement("button");c.className=BUTTON_CLASS_NAME,c.type="button",c.onclick=function(){return!1},i.firstChild.insertBefore(c,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),_get$t(_getPrototypeOf$B(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$k}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$j}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[KEY$9,KEY$8,KEY$c,KEY$5,KEY$c,KEY$a,KEY$c,KEY$7,KEY$c,KEY$b]}}]),r}(BasePlugin);DropdownMenu.SEPARATOR={name:KEY$c};function _typeof$_(e){return _typeof$_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$_(e)}function _slicedToArray$o(e,t){return _arrayWithHoles$p(e)||_iterableToArrayLimit$o(e,t)||_unsupportedIterableToArray$A(e,t)||_nonIterableRest$p()}function _nonIterableRest$p(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$A(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$A(e,t)}}function _arrayLikeToArray$A(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$o(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$p(e){if(Array.isArray(e))return e}function _classCallCheck$W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$Z(n.key),n)}}function _createClass$W(e,t,r){return t&&_defineProperties$W(e.prototype,t),r&&_defineProperties$W(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$Z(e){var t=_toPrimitive$Z(e,"string");return _typeof$_(t)==="symbol"?t:String(t)}function _toPrimitive$Z(e,t){if(_typeof$_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataProvider=function(){function e(t){_classCallCheck$W(this,e),this.hot=t,this.options={}}return _createClass$W(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,s=n.endCol,l=this.options,u=[];return rangeEach(o,a,function(c){var f=[];!l.exportHiddenRows&&r._isHiddenRow(c)||(rangeEach(i,s,function(d){!l.exportHiddenColumns&&r._isHiddenColumn(d)||f.push(r.hot.getDataAtCell(c,d))}),u.push(f))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,s=this.hot.getRowHeader();rangeEach(i,a,function(l){!r.options.exportHiddenRows&&r._isHiddenRow(l)||n.push(s[l])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,s=this.hot.getColHeader();rangeEach(i,a,function(l){!r.options.exportHiddenColumns&&r._isHiddenColumn(l)||n.push(s[l])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=_slicedToArray$o(this.options.range,4),i=o[0],a=i===void 0?0:i,s=o[1],l=s===void 0?0:s,u=o[2],c=u===void 0?n:u,f=o[3],d=f===void 0?r:f;return a=Math.max(a,0),l=Math.max(l,0),c=Math.min(c,n),d=Math.min(d,r),{startRow:a,startCol:l,endRow:c,endCol:d}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const DataProvider$1=DataProvider;function _typeof$Z(e){return _typeof$Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$Z(e)}function _classCallCheck$V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$Y(n.key),n)}}function _createClass$V(e,t,r){return t&&_defineProperties$V(e.prototype,t),r&&_defineProperties$V(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$Y(e){var t=_toPrimitive$Y(e,"string");return _typeof$Z(t)==="symbol"?t:String(t)}function _toPrimitive$Y(e,t){if(_typeof$Z(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$Z(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BaseType=function(){function e(t,r){_classCallCheck$V(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return _createClass$V(e,[{key:"_mergeOptions",value:function(r){var n=clone$3(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=extend$1(clone$3(e.DEFAULT_OPTIONS),n),n=extend$1(n,r),n.filename=substitute(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const BaseType$1=BaseType;function _typeof$Y(e){return _typeof$Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$Y(e)}function _classCallCheck$U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$X(n.key),n)}}function _createClass$U(e,t,r){return t&&_defineProperties$U(e.prototype,t),r&&_defineProperties$U(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$X(e){var t=_toPrimitive$X(e,"string");return _typeof$Y(t)==="symbol"?t:String(t)}function _toPrimitive$X(e,t){if(_typeof$Y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$Y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$A(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$A(e,t)}function _setPrototypeOf$A(e,t){return _setPrototypeOf$A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$A(e,t)}function _createSuper$A(e){var t=_isNativeReflectConstruct$A();return function(){var n=_getPrototypeOf$A(e),o;if(t){var i=_getPrototypeOf$A(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$A(this,o)}}function _possibleConstructorReturn$A(e,t){if(t&&(_typeof$Y(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$A(e)}function _assertThisInitialized$A(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$A(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$A(e){return _getPrototypeOf$A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$A(e)}var CHAR_CARRIAGE_RETURN=String.fromCharCode(13),CHAR_DOUBLE_QUOTES=String.fromCharCode(34),CHAR_LINE_FEED=String.fromCharCode(10),Csv=function(e){_inherits$A(r,e);var t=_createSuper$A(r);function r(){return _classCallCheck$U(this,r),t.apply(this,arguments)}return _createClass$U(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),s=this.dataProvider.getColumnHeaders(),l=s.length>0,u=this.dataProvider.getRowHeaders(),c=u.length>0,f=i.bom?String.fromCharCode(65279):"";return l&&(s=arrayMap(s,function(d){return o._escapeCell(d,!0)}),c&&(f+=i.columnDelimiter),f+=s.join(i.columnDelimiter),f+=i.rowDelimiter),arrayEach(a,function(d,h){h>0&&(f+=i.rowDelimiter),c&&(f+=o._escapeCell(u[h])+i.columnDelimiter),f+=d.map(function(y){return o._escapeCell(y)}).join(i.columnDelimiter)}),f}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=stringify$1(o);return a!==""&&(i||a.indexOf(CHAR_CARRIAGE_RETURN)>=0||a.indexOf(CHAR_DOUBLE_QUOTES)>=0||a.indexOf(CHAR_LINE_FEED)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(BaseType$1);const Csv$1=Csv;function _typeof$X(e){return _typeof$X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$X(e)}function _defineProperty$9(e,t,r){return t=_toPropertyKey$W(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$W(e){var t=_toPrimitive$W(e,"string");return _typeof$X(t)==="symbol"?t:String(t)}function _toPrimitive$W(e,t){if(_typeof$X(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$X(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TYPE_CSV="csv",EXPORT_TYPES=_defineProperty$9({},TYPE_CSV,Csv$1);function typeFactory(e,t,r){return typeof EXPORT_TYPES[e]=="function"?new EXPORT_TYPES[e](t,r):null}function _typeof$W(e){return _typeof$W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$W(e)}function _classCallCheck$T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$V(n.key),n)}}function _createClass$T(e,t,r){return t&&_defineProperties$T(e.prototype,t),r&&_defineProperties$T(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$V(e){var t=_toPrimitive$V(e,"string");return _typeof$W(t)==="symbol"?t:String(t)}function _toPrimitive$V(e,t){if(_typeof$W(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$W(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$z(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$z(e,t)}function _setPrototypeOf$z(e,t){return _setPrototypeOf$z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$z(e,t)}function _createSuper$z(e){var t=_isNativeReflectConstruct$z();return function(){var n=_getPrototypeOf$z(e),o;if(t){var i=_getPrototypeOf$z(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$z(this,o)}}function _possibleConstructorReturn$z(e,t){if(t&&(_typeof$W(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$z(e)}function _assertThisInitialized$z(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$z(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$z(e){return _getPrototypeOf$z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$z(e)}var PLUGIN_KEY$j="exportFile",PLUGIN_PRIORITY$i=240,ExportFile=function(e){_inherits$z(r,e);var t=_createSuper$z(r);function r(){return _classCallCheck$T(this,r),t.apply(this,arguments)}return _createClass$T(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,s=a.rootDocument,l=a.rootWindow,u=this._createTypeFormatter(o,i),c=this._createBlob(u),f=l.URL||l.webkitURL,d=s.createElement("a"),h="".concat(u.options.filename,".").concat(u.options.fileExtension);if(d.download!==void 0){var y=f.createObjectURL(c);d.style.display="none",d.setAttribute("href",y),d.setAttribute("download",h),s.body.appendChild(d),d.dispatchEvent(new MouseEvent("click")),s.body.removeChild(d),setTimeout(function(){f.revokeObjectURL(y)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(c,h)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!EXPORT_TYPES[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return typeFactory(o,new DataProvider$1(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$j}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$i}}]),r}(BasePlugin);function _typeof$V(e){return _typeof$V=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$V(e)}function _classCallCheck$S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$U(n.key),n)}}function _createClass$S(e,t,r){return t&&_defineProperties$S(e.prototype,t),r&&_defineProperties$S(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$U(e){var t=_toPrimitive$U(e,"string");return _typeof$V(t)==="symbol"?t:String(t)}function _toPrimitive$U(e,t){if(_typeof$V(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$V(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BaseComponent=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;_classCallCheck$S(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new LinkedPhysicalIndexToValueMap)}return _createClass$S(e,[{key:"reset",value:function(){arrayEach(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),arrayEach(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();mixin(BaseComponent,localHooks$1);const BaseComponent$1=BaseComponent;var conditions={};function getCondition(e,t){if(!conditions[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=conditions[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function getConditionDescriptor(e){if(!conditions[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return conditions[e].descriptor}function registerCondition(e,t,r){r.key=e,conditions[e]={condition:t,descriptor:r}}var CONDITION_NAME$k="none";function condition$k(){return!0}registerCondition(CONDITION_NAME$k,condition$k,{name:FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});var CONDITION_NAME$j="empty";function condition$j(e){return isEmpty(e.value)}registerCondition(CONDITION_NAME$j,condition$j,{name:FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});var CONDITION_NAME$i="not_empty";function condition$i(e,t){return!getCondition(CONDITION_NAME$j,t)(e)}registerCondition(CONDITION_NAME$i,condition$i,{name:FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});function _slicedToArray$n(e,t){return _arrayWithHoles$o(e)||_iterableToArrayLimit$n(e,t)||_unsupportedIterableToArray$z(e,t)||_nonIterableRest$o()}function _nonIterableRest$o(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$z(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$z(e,t)}}function _arrayLikeToArray$z(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$n(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$o(e){if(Array.isArray(e))return e}var CONDITION_NAME$h="eq";function condition$h(e,t){var r=_slicedToArray$n(t,1),n=r[0];return stringify$1(e.value).toLocaleLowerCase(e.meta.locale)===stringify$1(n)}registerCondition(CONDITION_NAME$h,condition$h,{name:FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});var CONDITION_NAME$g="neq";function condition$g(e,t){return!getCondition(CONDITION_NAME$h,t)(e)}registerCondition(CONDITION_NAME$g,condition$g,{name:FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});function _slicedToArray$m(e,t){return _arrayWithHoles$n(e)||_iterableToArrayLimit$m(e,t)||_unsupportedIterableToArray$y(e,t)||_nonIterableRest$n()}function _nonIterableRest$n(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$y(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$y(e,t)}}function _arrayLikeToArray$y(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$m(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$n(e){if(Array.isArray(e))return e}var CONDITION_NAME$f="gt";function condition$f(e,t){var r=_slicedToArray$m(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}registerCondition(CONDITION_NAME$f,condition$f,{name:FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});function _slicedToArray$l(e,t){return _arrayWithHoles$m(e)||_iterableToArrayLimit$l(e,t)||_unsupportedIterableToArray$x(e,t)||_nonIterableRest$m()}function _nonIterableRest$m(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$x(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$x(e,t)}}function _arrayLikeToArray$x(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$l(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$m(e){if(Array.isArray(e))return e}var CONDITION_NAME$e="gte";function condition$e(e,t){var r=_slicedToArray$l(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}registerCondition(CONDITION_NAME$e,condition$e,{name:FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});function _slicedToArray$k(e,t){return _arrayWithHoles$l(e)||_iterableToArrayLimit$k(e,t)||_unsupportedIterableToArray$w(e,t)||_nonIterableRest$l()}function _nonIterableRest$l(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$w(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$w(e,t)}}function _arrayLikeToArray$w(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$k(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$l(e){if(Array.isArray(e))return e}var CONDITION_NAME$d="lt";function condition$d(e,t){var r=_slicedToArray$k(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}registerCondition(CONDITION_NAME$d,condition$d,{name:FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});function _slicedToArray$j(e,t){return _arrayWithHoles$k(e)||_iterableToArrayLimit$j(e,t)||_unsupportedIterableToArray$v(e,t)||_nonIterableRest$k()}function _nonIterableRest$k(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$v(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$v(e,t)}}function _arrayLikeToArray$v(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$j(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$k(e){if(Array.isArray(e))return e}var CONDITION_NAME$c="lte";function condition$c(e,t){var r=_slicedToArray$j(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}registerCondition(CONDITION_NAME$c,condition$c,{name:FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});function _slicedToArray$i(e,t){return _arrayWithHoles$j(e)||_iterableToArrayLimit$i(e,t)||_unsupportedIterableToArray$u(e,t)||_nonIterableRest$j()}function _nonIterableRest$j(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$u(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$u(e,t)}}function _arrayLikeToArray$u(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$i(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$j(e){if(Array.isArray(e))return e}var CONDITION_NAME$b="date_after";function condition$b(e,t){var r=_slicedToArray$i(t,1),n=r[0],o=hooks(e.value,e.meta.dateFormat),i=hooks(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}registerCondition(CONDITION_NAME$b,condition$b,{name:FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});function _slicedToArray$h(e,t){return _arrayWithHoles$i(e)||_iterableToArrayLimit$h(e,t)||_unsupportedIterableToArray$t(e,t)||_nonIterableRest$i()}function _nonIterableRest$i(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$t(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$t(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$t(e,t)}}function _arrayLikeToArray$t(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$h(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$i(e){if(Array.isArray(e))return e}var CONDITION_NAME$a="date_before";function condition$a(e,t){var r=_slicedToArray$h(t,1),n=r[0],o=hooks(e.value,e.meta.dateFormat),i=hooks(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}registerCondition(CONDITION_NAME$a,condition$a,{name:FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});function _slicedToArray$g(e,t){return _arrayWithHoles$h(e)||_iterableToArrayLimit$g(e,t)||_unsupportedIterableToArray$s(e,t)||_nonIterableRest$h()}function _nonIterableRest$h(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$s(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$s(e,t)}}function _arrayLikeToArray$s(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$g(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$h(e){if(Array.isArray(e))return e}var CONDITION_NAME$9="between";function condition$9(e,t){var r=_slicedToArray$g(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var s=parseFloat(i,10),l=parseFloat(a,10);i=Math.min(s,l),a=Math.max(s,l)}else if(e.meta.type==="date"){var u=getCondition(CONDITION_NAME$a,[a]),c=getCondition(CONDITION_NAME$b,[i]);return u(e)&&c(e)}return e.value>=i&&e.value<=a}registerCondition(CONDITION_NAME$9,condition$9,{name:FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});var CONDITION_NAME$8="not_between";function condition$8(e,t){return!getCondition(CONDITION_NAME$9,t)(e)}registerCondition(CONDITION_NAME$8,condition$8,{name:FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});function _slicedToArray$f(e,t){return _arrayWithHoles$g(e)||_iterableToArrayLimit$f(e,t)||_unsupportedIterableToArray$r(e,t)||_nonIterableRest$g()}function _nonIterableRest$g(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$r(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$r(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$r(e,t)}}function _arrayLikeToArray$r(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$f(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$g(e){if(Array.isArray(e))return e}var CONDITION_NAME$7="begins_with";function condition$7(e,t){var r=_slicedToArray$f(t,1),n=r[0];return stringify$1(e.value).toLocaleLowerCase(e.meta.locale).startsWith(stringify$1(n))}registerCondition(CONDITION_NAME$7,condition$7,{name:FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});var $$1=_export,uncurryThis$1=functionUncurryThisClause,getOwnPropertyDescriptor=objectGetOwnPropertyDescriptor.f,toLength=toLength$7,toString$1=toString$l,notARegExp=notARegexp,requireObjectCoercible$1=requireObjectCoercible$e,correctIsRegExpLogic=correctIsRegexpLogic,nativeEndsWith=uncurryThis$1("".endsWith),slice=uncurryThis$1("".slice),min=Math.min,CORRECT_IS_REGEXP_LOGIC=correctIsRegExpLogic("endsWith"),MDN_POLYFILL_BUG=!CORRECT_IS_REGEXP_LOGIC&&!!function(){var e=getOwnPropertyDescriptor(String.prototype,"endsWith");return e&&!e.writable}();$$1({target:"String",proto:!0,forced:!MDN_POLYFILL_BUG&&!CORRECT_IS_REGEXP_LOGIC},{endsWith:function(t){var r=toString$1(requireObjectCoercible$1(this));notARegExp(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:min(toLength(n),o),a=toString$1(t);return nativeEndsWith?nativeEndsWith(r,a,i):slice(r,i-a.length,i)===a}});function _slicedToArray$e(e,t){return _arrayWithHoles$f(e)||_iterableToArrayLimit$e(e,t)||_unsupportedIterableToArray$q(e,t)||_nonIterableRest$f()}function _nonIterableRest$f(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$q(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$q(e,t)}}function _arrayLikeToArray$q(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$f(e){if(Array.isArray(e))return e}var CONDITION_NAME$6="ends_with";function condition$6(e,t){var r=_slicedToArray$e(t,1),n=r[0];return stringify$1(e.value).toLocaleLowerCase(e.meta.locale).endsWith(stringify$1(n))}registerCondition(CONDITION_NAME$6,condition$6,{name:FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});function _slicedToArray$d(e,t){return _arrayWithHoles$e(e)||_iterableToArrayLimit$d(e,t)||_unsupportedIterableToArray$p(e,t)||_nonIterableRest$e()}function _nonIterableRest$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$p(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$p(e,t)}}function _arrayLikeToArray$p(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$d(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$e(e){if(Array.isArray(e))return e}var CONDITION_NAME$5="contains";function condition$5(e,t){var r=_slicedToArray$d(t,1),n=r[0];return stringify$1(e.value).toLocaleLowerCase(e.meta.locale).indexOf(stringify$1(n))>=0}registerCondition(CONDITION_NAME$5,condition$5,{name:FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});var CONDITION_NAME$4="not_contains";function condition$4(e,t){return!getCondition(CONDITION_NAME$5,t)(e)}registerCondition(CONDITION_NAME$4,condition$4,{name:FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});var CONDITION_NAME$3="date_tomorrow";function condition$3(e){var t=hooks(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(hooks().subtract(-1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$3,condition$3,{name:FILTERS_CONDITIONS_TOMORROW,inputsCount:0});var CONDITION_NAME$2="date_today";function condition$2(e){var t=hooks(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(hooks().startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$2,condition$2,{name:FILTERS_CONDITIONS_TODAY,inputsCount:0});var CONDITION_NAME$1="date_yesterday";function condition$1(e){var t=hooks(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(hooks().subtract(1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$1,condition$1,{name:FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});getComparisonFunction();function toVisualValue(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var SUPPORT_SET_CONSTRUCTOR=new Set([1]).has(1),SUPPORT_FAST_DEDUPE=SUPPORT_SET_CONSTRUCTOR&&typeof Array.from=="function";function createArrayAssertion(e){var t=e;return SUPPORT_SET_CONSTRUCTOR&&(t=new Set(t)),function(r){var n;return SUPPORT_SET_CONSTRUCTOR?n=t.has(r):n=!!~t.indexOf(r),n}}function toEmptyString(e){return e??""}function unifyColumnValues(e){var t=e;return SUPPORT_FAST_DEDUPE?t=Array.from(new Set(t)):t=arrayUnique(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function intersectValues(e,t,r,n){var o=[],i=e===t,a;return i||(a=createArrayAssertion(t)),arrayEach(e,function(s){var l=!1;(i||a(s))&&(l=!0);var u={checked:l,value:s,visualValue:toVisualValue(s,r)};n&&n(u),o.push(u)}),o}function _slicedToArray$c(e,t){return _arrayWithHoles$d(e)||_iterableToArrayLimit$c(e,t)||_unsupportedIterableToArray$o(e,t)||_nonIterableRest$d()}function _nonIterableRest$d(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$o(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$o(e,t)}}function _arrayLikeToArray$o(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$c(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$d(e){if(Array.isArray(e))return e}var CONDITION_NAME="by_value";function condition(e,t){var r=_slicedToArray$c(t,1),n=r[0];return n(e.value)}registerCondition(CONDITION_NAME,condition,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=_slicedToArray$c(t,1),n=r[0];return[createArrayAssertion(n)]},showOperators:!1});var operations={};function getOperationFunc(e){if(!operations[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=operations[e].func;return function(r,n){return t(r,n)}}function getOperationName(e){return operations[e].name}function registerOperation(e,t,r){operations[e]={name:t,func:r}}var OPERATION_ID$2="conjunction",SHORT_NAME_FOR_COMPONENT$2=FILTERS_LABELS_CONJUNCTION;function operationResult$2(e,t){return e.every(function(r){return r.func(t)})}registerOperation(OPERATION_ID$2,SHORT_NAME_FOR_COMPONENT$2,operationResult$2);var OPERATION_ID$1="disjunction",SHORT_NAME_FOR_COMPONENT$1=FILTERS_LABELS_DISJUNCTION;function operationResult$1(e,t){return e.some(function(r){return r.func(t)})}registerOperation(OPERATION_ID$1,SHORT_NAME_FOR_COMPONENT$1,operationResult$1);var OPERATION_ID="disjunctionWithExtraCondition",SHORT_NAME_FOR_COMPONENT=FILTERS_LABELS_DISJUNCTION;function operationResult(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}registerOperation(OPERATION_ID,SHORT_NAME_FOR_COMPONENT,operationResult);function _typeof$U(e){return _typeof$U=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$U(e)}var _TYPES;function _defineProperty$8(e,t,r){return t=_toPropertyKey$T(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$T(e){var t=_toPrimitive$T(e,"string");return _typeof$U(t)==="symbol"?t:String(t)}function _toPrimitive$T(e,t){if(_typeof$U(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$U(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TYPE_NUMERIC="numeric",TYPE_TEXT="text",TYPE_DATE="date",TYPES=(_TYPES={},_defineProperty$8(_TYPES,TYPE_NUMERIC,[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$f,CONDITION_NAME$e,CONDITION_NAME$d,CONDITION_NAME$c,CONDITION_NAME$9,CONDITION_NAME$8]),_defineProperty$8(_TYPES,TYPE_TEXT,[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$7,CONDITION_NAME$6,KEY$c,CONDITION_NAME$5,CONDITION_NAME$4]),_defineProperty$8(_TYPES,TYPE_DATE,[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$a,CONDITION_NAME$b,CONDITION_NAME$9,KEY$c,CONDITION_NAME$3,CONDITION_NAME$2,CONDITION_NAME$1]),_TYPES);function getOptionsList(e){var t=[],r=e;return TYPES[r]||(r=TYPE_TEXT),arrayEach(TYPES[r],function(n){var o;n===KEY$c?o={name:KEY$c}:o=clone$3(getConditionDescriptor(n)),t.push(o)}),t}function _typeof$T(e){return _typeof$T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$T(e)}function _classCallCheck$R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$S(n.key),n)}}function _createClass$R(e,t,r){return t&&_defineProperties$R(e.prototype,t),r&&_defineProperties$R(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$S(e){var t=_toPrimitive$S(e,"string");return _typeof$T(t)==="symbol"?t:String(t)}function _toPrimitive$S(e,t){if(_typeof$T(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$T(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var STATE_BUILT$2="built",STATE_BUILDING="building",EVENTS_TO_REGISTER=["click","input","keydown","keypress","keyup","focus","blur","change"],BaseUI$6=function(){function e(t,r){_classCallCheck$R(this,e),this.hot=t,this.eventManager=new EventManager$1(this),this.options=extend$1(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return _createClass$R(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===STATE_BUILDING?this._element:this.buildState===STATE_BUILT$2?(this.update(),this._element):(this.buildState=STATE_BUILDING,this.build(),this.buildState=STATE_BUILT$2,this._element)}},{key:"isBuilt",value:function(){return this.buildState===STATE_BUILT$2}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,s){r.eventManager.addEventListener(a,s,function(l){return r.runLocalHooks(s,l,r)})};if(this.buildState||(this.buildState=STATE_BUILDING),this.options.className&&addClass(this._element,this.options.className),this.options.children.length)arrayEach(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);objectEach(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),arrayEach(EVENTS_TO_REGISTER,function(i){return n(o,i)})}else arrayEach(EVENTS_TO_REGISTER,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return clone$3({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();mixin(BaseUI$6,localHooks$1);const BaseUI$7=BaseUI$6;function _typeof$S(e){return _typeof$S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$S(e)}function _classCallCheck$Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$R(n.key),n)}}function _createClass$Q(e,t,r){return t&&_defineProperties$Q(e.prototype,t),r&&_defineProperties$Q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$R(e){var t=_toPrimitive$R(e,"string");return _typeof$S(t)==="symbol"?t:String(t)}function _toPrimitive$R(e,t){if(_typeof$S(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$S(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$s(){return typeof Reflect<"u"&&Reflect.get?_get$s=Reflect.get.bind():_get$s=function(t,r,n){var o=_superPropBase$s(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$s.apply(this,arguments)}function _superPropBase$s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$y(e),e!==null););return e}function _inherits$y(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$y(e,t)}function _setPrototypeOf$y(e,t){return _setPrototypeOf$y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$y(e,t)}function _createSuper$y(e){var t=_isNativeReflectConstruct$y();return function(){var n=_getPrototypeOf$y(e),o;if(t){var i=_getPrototypeOf$y(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$y(this,o)}}function _possibleConstructorReturn$y(e,t){if(t&&(_typeof$S(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$y(e)}function _assertThisInitialized$y(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$y(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$y(e){return _getPrototypeOf$y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$y(e)}var privatePool$c=new WeakMap,InputUI=function(e){_inherits$y(r,e);var t=_createSuper$y(r);function r(n,o){var i;return _classCallCheck$Q(this,r),i=t.call(this,n,extend$1(r.DEFAULTS,o)),privatePool$c.set(_assertThisInitialized$y(i),{}),i.registerHooks(),i}return _createClass$Q(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){_get$s(_getPrototypeOf$y(r.prototype),"build",this).call(this);var o=privatePool$c.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,addClass(this._element,"htUIInput"),addClass(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=privatePool$c.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&privatePool$c.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return clone$3({placeholder:"",type:"text",tagName:"input"})}}]),r}(BaseUI$7);const InputUI$1=InputUI;function _typeof$R(e){return _typeof$R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$R(e)}function _classCallCheck$P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$Q(n.key),n)}}function _createClass$P(e,t,r){return t&&_defineProperties$P(e.prototype,t),r&&_defineProperties$P(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$Q(e){var t=_toPrimitive$Q(e,"string");return _typeof$R(t)==="symbol"?t:String(t)}function _toPrimitive$Q(e,t){if(_typeof$R(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$R(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$r(){return typeof Reflect<"u"&&Reflect.get?_get$r=Reflect.get.bind():_get$r=function(t,r,n){var o=_superPropBase$r(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$r.apply(this,arguments)}function _superPropBase$r(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$x(e),e!==null););return e}function _inherits$x(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$x(e,t)}function _setPrototypeOf$x(e,t){return _setPrototypeOf$x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$x(e,t)}function _createSuper$x(e){var t=_isNativeReflectConstruct$x();return function(){var n=_getPrototypeOf$x(e),o;if(t){var i=_getPrototypeOf$x(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$x(this,o)}}function _possibleConstructorReturn$x(e,t){if(t&&(_typeof$R(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$x(e)}function _assertThisInitialized$x(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$x(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$x(e){return _getPrototypeOf$x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$x(e)}var privatePool$b=new WeakMap,SelectUI=function(e){_inherits$x(r,e);var t=_createSuper$x(r);function r(n,o){var i;return _classCallCheck$P(this,r),i=t.call(this,n,extend$1(r.DEFAULTS,o)),privatePool$b.set(_assertThisInitialized$x(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return _createClass$P(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return arrayEach(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;_get$r(_getPrototypeOf$x(r.prototype),"build",this).call(this),this.menu=new Menu$1(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new BaseUI$7(this.hot,{className:"htUISelectCaption"}),a=new BaseUI$7(this.hot,{className:"htUISelectDropdown"}),s=privatePool$b.get(this);s.caption=i,s.captionElement=i.element,s.dropdown=a,arrayEach([i,a],function(l){return o._element.appendChild(l.element)}),this.menu.addLocalHook("select",function(l){return o.onMenuSelect(l)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(FILTERS_CONDITIONS_NONE),privatePool$b.get(this).captionElement.textContent=o,_get$r(_getPrototypeOf$x(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==KEY$c&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=privatePool$b.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),_get$r(_getPrototypeOf$x(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return clone$3({className:"htUISelect",wrapIt:!1})}}]),r}(BaseUI$7);const SelectUI$1=SelectUI;function _typeof$Q(e){return _typeof$Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$Q(e)}function _classCallCheck$O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$P(n.key),n)}}function _createClass$O(e,t,r){return t&&_defineProperties$O(e.prototype,t),r&&_defineProperties$O(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$P(e){var t=_toPrimitive$P(e,"string");return _typeof$Q(t)==="symbol"?t:String(t)}function _toPrimitive$P(e,t){if(_typeof$Q(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$Q(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$q(){return typeof Reflect<"u"&&Reflect.get?_get$q=Reflect.get.bind():_get$q=function(t,r,n){var o=_superPropBase$q(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$q.apply(this,arguments)}function _superPropBase$q(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$w(e),e!==null););return e}function _inherits$w(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$w(e,t)}function _setPrototypeOf$w(e,t){return _setPrototypeOf$w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$w(e,t)}function _createSuper$w(e){var t=_isNativeReflectConstruct$w();return function(){var n=_getPrototypeOf$w(e),o;if(t){var i=_getPrototypeOf$w(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$w(this,o)}}function _possibleConstructorReturn$w(e,t){if(t&&(_typeof$Q(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$w(e)}function _assertThisInitialized$w(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$w(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$w(e){return _getPrototypeOf$w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$w(e)}var ConditionComponent=function(e){_inherits$w(r,e);var t=_createSuper$w(r);function r(n,o){var i;return _classCallCheck$O(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new SelectUI$1(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new InputUI$1(i.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_VALUE})),i.elements.push(new InputUI$1(i.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),i.registerHooks(),i}return _createClass$O(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),arrayEach(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=clone$3(o.command);a.name.startsWith(FILTERS_CONDITIONS_NAMESPACE)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),arrayEach(o.args,function(s,l){if(l>a.inputsCount-1)return!1;var u=i.getInputElement(l);u.setValue(s),u[a.inputsCount>l?"show":"hide"](),l||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||getConditionDescriptor(CONDITION_NAME$k),i=[];return arrayEach(this.getInputElements(),function(a,s){o.inputsCount>s&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=getConditionDescriptor(o?o.name:CONDITION_NAME$k);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||arrayEach(this.getInputElements(),function(s){return s.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof SelectUI$1})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof InputUI$1})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,s,l,u,c,f){addClass(s.parentNode,"htFiltersMenuCondition"),o.addSeparator&&addClass(s.parentNode,"border");var d=o.hot.rootDocument.createElement("div");return addClass(d,"htFiltersMenuLabel"),d.textContent=f,s.appendChild(d),s.parentNode.hasAttribute("ghost-table")||arrayEach(o.elements,function(h){return s.appendChild(h.element)}),s}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[getConditionDescriptor(CONDITION_NAME$k)];if(o!==null){var a=o.visualIndex;i=getOptionsList(this.hot.getDataType(0,a,this.hot.countRows(),a))}arrayEach(this.getInputElements(),function(s){return s.hide()}),this.getSelectElement().setItems(i),_get$q(_getPrototypeOf$w(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){arrayEach(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){isKey(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),stopImmediatePropagation(o)):isKey(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(o))}}]),r}(BaseComponent$1);const ConditionComponent$1=ConditionComponent;function _typeof$P(e){return _typeof$P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$P(e)}function _classCallCheck$N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$O(n.key),n)}}function _createClass$N(e,t,r){return t&&_defineProperties$N(e.prototype,t),r&&_defineProperties$N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$O(e){var t=_toPrimitive$O(e,"string");return _typeof$P(t)==="symbol"?t:String(t)}function _toPrimitive$O(e,t){if(_typeof$P(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$P(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$p(){return typeof Reflect<"u"&&Reflect.get?_get$p=Reflect.get.bind():_get$p=function(t,r,n){var o=_superPropBase$p(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$p.apply(this,arguments)}function _superPropBase$p(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$v(e),e!==null););return e}function _inherits$v(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$v(e,t)}function _setPrototypeOf$v(e,t){return _setPrototypeOf$v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$v(e,t)}function _createSuper$v(e){var t=_isNativeReflectConstruct$v();return function(){var n=_getPrototypeOf$v(e),o;if(t){var i=_getPrototypeOf$v(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$v(this,o)}}function _possibleConstructorReturn$v(e,t){if(t&&(_typeof$P(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$v(e)}function _assertThisInitialized$v(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$v(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$v(e){return _getPrototypeOf$v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$v(e)}var privatePool$a=new WeakMap,RadioInputUI=function(e){_inherits$v(r,e);var t=_createSuper$v(r);function r(n,o){var i;return _classCallCheck$N(this,r),i=t.call(this,n,extend$1(r.DEFAULTS,o)),privatePool$a.set(_assertThisInitialized$v(i),{}),i}return _createClass$N(r,[{key:"build",value:function(){_get$p(_getPrototypeOf$v(r.prototype),"build",this).call(this);var o=privatePool$a.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=privatePool$a.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&privatePool$a.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return clone$3({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(BaseUI$7);const RadioInputUI$1=RadioInputUI;function _typeof$O(e){return _typeof$O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$O(e)}var _templateObject$9;function _taggedTemplateLiteral$9(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$N(n.key),n)}}function _createClass$M(e,t,r){return t&&_defineProperties$M(e.prototype,t),r&&_defineProperties$M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$N(e){var t=_toPrimitive$N(e,"string");return _typeof$O(t)==="symbol"?t:String(t)}function _toPrimitive$N(e,t){if(_typeof$O(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$O(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$u(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$u(e,t)}function _setPrototypeOf$u(e,t){return _setPrototypeOf$u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$u(e,t)}function _createSuper$u(e){var t=_isNativeReflectConstruct$u();return function(){var n=_getPrototypeOf$u(e),o;if(t){var i=_getPrototypeOf$u(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$u(this,o)}}function _possibleConstructorReturn$u(e,t){if(t&&(_typeof$O(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$u(e)}function _assertThisInitialized$u(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$u(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$u(e){return _getPrototypeOf$u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$u(e)}var SELECTED_AT_START_ELEMENT_INDEX=0,OperatorsComponent=function(e){_inherits$u(r,e);var t=_createSuper$u(r);function r(n,o){var i;return _classCallCheck$M(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return _createClass$M(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,s){return addClass(s.parentNode,"htFiltersMenuOperators"),s.parentNode.hasAttribute("ghost-table")||arrayEach(o.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[OPERATION_ID$2,OPERATION_ID$1];arrayEach(i,function(a){var s=new RadioInputUI$1(o.hot,{name:"operator",label:{htmlFor:a,textContent:getOperationName(a)},value:a,checked:a===i[SELECTED_AT_START_ELEMENT_INDEX],id:a});s.addLocalHook("change",function(l){return o.onRadioInputChange(l)}),o.elements.push(s)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(toSingleLine(_templateObject$9||(_templateObject$9=_taggedTemplateLiteral$9(["Radio button with index "," doesn't exist."])),o));arrayEach(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof RadioInputUI$1&&i.isChecked()});return o?o.getValue():OPERATION_ID$2}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&arrayEach(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:OPERATION_ID$2,i=arguments.length>1?arguments[1]:void 0,a=o;a===OPERATION_ID&&(a=OPERATION_ID$1),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(SELECTED_AT_START_ELEMENT_INDEX)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(BaseComponent$1);const OperatorsComponent$1=OperatorsComponent;var uncurryThis=functionUncurryThis,requireObjectCoercible=requireObjectCoercible$e,toString=toString$l,quot=/"/g,replace=uncurryThis("".replace),createHtml=function(e,t,r,n){var o=toString(requireObjectCoercible(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+replace(toString(n),quot,"&quot;")+'"'),i+">"+o+"</"+t+">"},fails=fails$I,stringHtmlForced=function(e){return fails(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},$=_export,createHTML=createHtml,forcedStringHTMLMethod=stringHtmlForced;$({target:"String",proto:!0,forced:forcedStringHTMLMethod("link")},{link:function(t){return createHTML(this,"a","href",t)}});function _typeof$N(e){return _typeof$N=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$N(e)}function _classCallCheck$L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$M(n.key),n)}}function _createClass$L(e,t,r){return t&&_defineProperties$L(e.prototype,t),r&&_defineProperties$L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$M(e){var t=_toPrimitive$M(e,"string");return _typeof$N(t)==="symbol"?t:String(t)}function _toPrimitive$M(e,t){if(_typeof$N(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$N(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$o(){return typeof Reflect<"u"&&Reflect.get?_get$o=Reflect.get.bind():_get$o=function(t,r,n){var o=_superPropBase$o(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$o.apply(this,arguments)}function _superPropBase$o(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$t(e),e!==null););return e}function _inherits$t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$t(e,t)}function _setPrototypeOf$t(e,t){return _setPrototypeOf$t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$t(e,t)}function _createSuper$t(e){var t=_isNativeReflectConstruct$t();return function(){var n=_getPrototypeOf$t(e),o;if(t){var i=_getPrototypeOf$t(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$t(this,o)}}function _possibleConstructorReturn$t(e,t){if(t&&(_typeof$N(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$t(e)}function _assertThisInitialized$t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$t(e){return _getPrototypeOf$t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$t(e)}var privatePool$9=new WeakMap,LinkUI=function(e){_inherits$t(r,e);var t=_createSuper$t(r);function r(n,o){var i;return _classCallCheck$L(this,r),i=t.call(this,n,extend$1(r.DEFAULTS,o)),privatePool$9.set(_assertThisInitialized$t(i),{}),i}return _createClass$L(r,[{key:"build",value:function(){_get$o(_getPrototypeOf$t(r.prototype),"build",this).call(this);var o=privatePool$9.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(privatePool$9.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return clone$3({href:"#",tagName:"a"})}}]),r}(BaseUI$7);const LinkUI$1=LinkUI;function _typeof$M(e){return _typeof$M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$M(e)}function _toConsumableArray$d(e){return _arrayWithoutHoles$d(e)||_iterableToArray$e(e)||_unsupportedIterableToArray$n(e)||_nonIterableSpread$d()}function _nonIterableSpread$d(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$n(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$n(e,t)}}function _iterableToArray$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$d(e){if(Array.isArray(e))return _arrayLikeToArray$n(e)}function _arrayLikeToArray$n(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$L(n.key),n)}}function _createClass$K(e,t,r){return t&&_defineProperties$K(e.prototype,t),r&&_defineProperties$K(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$L(e){var t=_toPrimitive$L(e,"string");return _typeof$M(t)==="symbol"?t:String(t)}function _toPrimitive$L(e,t){if(_typeof$M(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$M(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$n(){return typeof Reflect<"u"&&Reflect.get?_get$n=Reflect.get.bind():_get$n=function(t,r,n){var o=_superPropBase$n(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$n.apply(this,arguments)}function _superPropBase$n(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$s(e),e!==null););return e}function _inherits$s(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$s(e,t)}function _setPrototypeOf$s(e,t){return _setPrototypeOf$s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$s(e,t)}function _createSuper$s(e){var t=_isNativeReflectConstruct$s();return function(){var n=_getPrototypeOf$s(e),o;if(t){var i=_getPrototypeOf$s(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$s(this,o)}}function _possibleConstructorReturn$s(e,t){if(t&&(_typeof$M(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$s(e)}function _assertThisInitialized$s(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$s(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$s(e){return _getPrototypeOf$s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$s(e)}var privatePool$8=new WeakMap,SHORTCUTS_GROUP$2="multipleSelect.itemBox",MultipleSelectUI=function(e){_inherits$s(r,e);var t=_createSuper$s(r);function r(n,o){var i;return _classCallCheck$K(this,r),i=t.call(this,n,extend$1(r.DEFAULTS,o)),privatePool$8.set(_assertThisInitialized$s(i),{}),i.searchInput=new InputUI$1(i.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new LinkUI$1(i.hot,{textContent:FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"}),i.clearAllUI=new LinkUI$1(i.hot,{textContent:FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return _createClass$K(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return _toConsumableArray$d(this.items)}},{key:"getValue",value:function(){return itemsToValue(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;_get$n(_getPrototypeOf$s(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),s=new BaseUI$7(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(s.element),this._element.appendChild(a);var l=function(c){if(o._element){o.itemsBox&&o.itemsBox.destroy(),addClass(c,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(c,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(y,p,v,b,S,w){y.title=w.instance.getDataAtRowProp(p,w.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-getScrollbarWidth(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var f=o.itemsBox.getShortcutManager(),d=f.getContext("grid");d.addShortcut({keys:[["Escape"]],callback:function(y){o.runLocalHooks("keydown",y,o)},group:SHORTCUTS_GROUP$2})}};l(a),setTimeout(function(){return l(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(valueToItems(this.items,this.options.value)),_get$n(_getPrototypeOf$s(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,_get$n(_getPrototypeOf$s(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),s;a===""?s=_toConsumableArray$d(this.items):s=arrayFilter(this.items,function(l){return"".concat(l.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(s)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=partial(isKey,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(stopImmediatePropagation(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),arrayEach(this.itemsBox.getSourceData(),function(a,s){a.checked=!0,i.push(dataRowToChangesArray(a,s)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),arrayEach(this.itemsBox.getSourceData(),function(a,s){a.checked=!1,i.push(dataRowToChangesArray(a,s)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return clone$3({className:"htUIMultipleSelect",value:[]})}}]),r}(BaseUI$7);const MultipleSelectUI$1=MultipleSelectUI;function valueToItems(e,t){var r=createArrayAssertion(t);return arrayMap(e,function(n){return n.checked=r(n.value),n})}function itemsToValue(e){var t=[];return arrayEach(e,function(r){r.checked&&t.push(r.value)}),t}function _typeof$L(e){return _typeof$L=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$L(e)}function _slicedToArray$b(e,t){return _arrayWithHoles$c(e)||_iterableToArrayLimit$b(e,t)||_unsupportedIterableToArray$m(e,t)||_nonIterableRest$c()}function _nonIterableRest$c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$m(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$m(e,t)}}function _arrayLikeToArray$m(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$b(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$c(e){if(Array.isArray(e))return e}function _classCallCheck$J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$K(n.key),n)}}function _createClass$J(e,t,r){return t&&_defineProperties$J(e.prototype,t),r&&_defineProperties$J(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$K(e){var t=_toPrimitive$K(e,"string");return _typeof$L(t)==="symbol"?t:String(t)}function _toPrimitive$K(e,t){if(_typeof$L(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$L(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$m(){return typeof Reflect<"u"&&Reflect.get?_get$m=Reflect.get.bind():_get$m=function(t,r,n){var o=_superPropBase$m(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$m.apply(this,arguments)}function _superPropBase$m(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$r(e),e!==null););return e}function _inherits$r(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$r(e,t)}function _setPrototypeOf$r(e,t){return _setPrototypeOf$r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$r(e,t)}function _createSuper$r(e){var t=_isNativeReflectConstruct$r();return function(){var n=_getPrototypeOf$r(e),o;if(t){var i=_getPrototypeOf$r(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$r(this,o)}}function _possibleConstructorReturn$r(e,t){if(t&&(_typeof$L(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$r(e)}function _assertThisInitialized$r(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$r(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$r(e){return _getPrototypeOf$r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$r(e)}var ValueComponent=function(e){_inherits$r(r,e);var t=_createSuper$r(r);function r(n,o){var i;return _classCallCheck$J(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new MultipleSelectUI$1(i.hot)),i.registerHooks(),i}return _createClass$J(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===CONDITION_NAME){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?CONDITION_NAME$k:CONDITION_NAME},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(l,u,c,f,d){var h=arrayFilter(u,function(j){return j.name===CONDITION_NAME}),y=_slicedToArray$b(h,1),p=y[0],v={},b=i.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS);if(p){var S=unifyColumnValues(arrayMap(f(l,d),function(j){return j.value}));c&&(p.args[0]=c);var w=[],P=intersectValues(S,p.args[0],b,function(j){j.checked&&w.push(j.value)}),E=o.editedConditionStack.column;v.locale=i.hot.getCellMeta(0,E).locale,v.args=[w],v.command=getConditionDescriptor(CONDITION_NAME),v.itemsSnapshot=P}else v.args=[],v.command=getConditionDescriptor(CONDITION_NAME$k);i.state.setValueAtIndex(l,v)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof MultipleSelectUI$1})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,s,l,u,c,f){addClass(s.parentNode,"htFiltersMenuValue");var d=o.hot.rootDocument.createElement("div");return addClass(d,"htFiltersMenuLabel"),d.textContent=f,s.appendChild(d),s.parentNode.hasAttribute("ghost-table")||arrayEach(o.elements,function(h){return s.appendChild(h.element)}),s}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS),i=unifyColumnValues(this._getColumnVisibleValues()),a=intersectValues(i,i,o);this.getMultipleSelectElement().setItems(a),_get$m(_getPrototypeOf$r(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var s=this.hot.getPlugin("filters").getSelectedColumn();s!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){isKey(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:arrayMap(this.hot.getDataAtCol(o.visualIndex),function(i){return toEmptyString(i)})}}]),r}(BaseComponent$1);const ValueComponent$1=ValueComponent;function _typeof$K(e){return _typeof$K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$K(e)}function _classCallCheck$I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$J(n.key),n)}}function _createClass$I(e,t,r){return t&&_defineProperties$I(e.prototype,t),r&&_defineProperties$I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$J(e){var t=_toPrimitive$J(e,"string");return _typeof$K(t)==="symbol"?t:String(t)}function _toPrimitive$J(e,t){if(_typeof$K(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$K(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$q(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$q(e,t)}function _setPrototypeOf$q(e,t){return _setPrototypeOf$q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$q(e,t)}function _createSuper$q(e){var t=_isNativeReflectConstruct$q();return function(){var n=_getPrototypeOf$q(e),o;if(t){var i=_getPrototypeOf$q(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$q(this,o)}}function _possibleConstructorReturn$q(e,t){if(t&&(_typeof$K(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$q(e)}function _assertThisInitialized$q(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$q(e){return _getPrototypeOf$q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$q(e)}var ActionBarComponent=function(e){_inherits$q(r,e);var t=_createSuper$q(r);function r(n,o){var i;return _classCallCheck$I(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new InputUI$1(i.hot,{type:"button",value:FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new InputUI$1(i.hot,{type:"button",value:FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return _createClass$I(r,[{key:"registerHooks",value:function(){var o=this;arrayEach(this.elements,function(i){i.addLocalHook("click",function(a,s){return o.onButtonClick(a,s)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,s){return addClass(s.parentNode,"htFiltersMenuActionBar"),s.parentNode.hasAttribute("ghost-table")||arrayEach(o.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(BaseComponent$1);const ActionBarComponent$1=ActionBarComponent;function _typeof$J(e){return _typeof$J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$J(e)}var _templateObject$8,_templateObject2$2;function _slicedToArray$a(e,t){return _arrayWithHoles$b(e)||_iterableToArrayLimit$a(e,t)||_unsupportedIterableToArray$l(e,t)||_nonIterableRest$b()}function _nonIterableRest$b(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$l(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$l(e,t)}}function _arrayLikeToArray$l(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$a(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$b(e){if(Array.isArray(e))return e}function _taggedTemplateLiteral$8(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$I(n.key),n)}}function _createClass$H(e,t,r){return t&&_defineProperties$H(e.prototype,t),r&&_defineProperties$H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$I(e){var t=_toPrimitive$I(e,"string");return _typeof$J(t)==="symbol"?t:String(t)}function _toPrimitive$I(e,t){if(_typeof$J(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$J(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MAP_NAME="ConditionCollection.filteringStates",ConditionCollection=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;_classCallCheck$H(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new LinkedPhysicalIndexToValueMap,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(MAP_NAME,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return _createClass$H(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,s)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2;return r.length?getOperationFunc(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,s=arrayMap(n.args,function(f){return typeof f=="string"?f.toLocaleLowerCase(a):f}),l=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(toSingleLine(_templateObject$8||(_templateObject$8=_taggedTemplateLiteral$8(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(isUndefined(operations[o]))throw new Error(toSingleLine(_templateObject2$2||(_templateObject2$2=_taggedTemplateLiteral$8(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var c=this.getConditions(r);c.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:l,args:s,func:getCondition(l,s)}]},i):c.push({name:l,args:s,func:getCondition(l,s)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=_slicedToArray$a(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return arrayReduce$1(this.filteringStates.getEntries(),function(r,n){var o=_slicedToArray$a(n,2),i=o[0],a=o[1],s=a.operation,l=a.conditions;return r.push({column:i,operation:s,conditions:arrayMap(l,function(u){var c=u.name,f=u.args;return{name:c,args:f}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),arrayEach(r,function(o){arrayEach(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(MAP_NAME),this.filteringStates=null,this.clearLocalHooks()}}]),e}();mixin(ConditionCollection,localHooks$1);const ConditionCollection$1=ConditionCollection;function _typeof$I(e){return _typeof$I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$I(e)}function _classCallCheck$G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$H(n.key),n)}}function _createClass$G(e,t,r){return t&&_defineProperties$G(e.prototype,t),r&&_defineProperties$G(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$H(e){var t=_toPrimitive$H(e,"string");return _typeof$I(t)==="symbol"?t:String(t)}function _toPrimitive$H(e,t){if(_typeof$I(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$I(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataFilter=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};_classCallCheck$G(this,e),this.conditionCollection=t,this.columnDataFactory=r}return _createClass$G(e,[{key:"filter",value:function(){var r=this,n=[];return arrayEach(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return arrayEach(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return arrayEach(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const DataFilter$1=DataFilter;function _typeof$H(e){return _typeof$H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$H(e)}function _classCallCheck$F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$G(n.key),n)}}function _createClass$F(e,t,r){return t&&_defineProperties$F(e.prototype,t),r&&_defineProperties$F(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$G(e){var t=_toPrimitive$G(e,"string");return _typeof$H(t)==="symbol"?t:String(t)}function _toPrimitive$G(e,t){if(_typeof$H(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$H(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ConditionUpdateObserver=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};_classCallCheck$F(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return _createClass$F(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,arrayEach(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var s=i.slice(0,a),l=i.slice(a);l.length&&l[0].column===r&&l.shift();var u=curry(function(f,d){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],y=new ConditionCollection$1(o.hot,!1),p=[].concat(f,h);y.importAllConditions(p);var v=o.columnDataFactory(d),b;y.isEmpty()?b=v:b=new DataFilter$1(y,function(w){return o.columnDataFactory(w)}).filter(),b=arrayMap(b,function(w){return w.meta.visualRow});var S=createArrayAssertion(b);return y.destroy(),arrayFilter(v,function(w){return S(w.meta.visualRow)})})(s),c=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:c},dependentConditionStacks:l,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;arrayEach(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),objectEach(this,function(n,o){r[o]=null})}}]),e}();mixin(ConditionUpdateObserver,localHooks$1);const ConditionUpdateObserver$1=ConditionUpdateObserver;function _typeof$G(e){return _typeof$G=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$G(e)}var _templateObject$7;function _taggedTemplateLiteral$7(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _slicedToArray$9(e,t){return _arrayWithHoles$a(e)||_iterableToArrayLimit$9(e,t)||_unsupportedIterableToArray$k(e,t)||_nonIterableRest$a()}function _nonIterableRest$a(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$k(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$k(e,t)}}function _arrayLikeToArray$k(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$9(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$a(e){if(Array.isArray(e))return e}function _classCallCheck$E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$F(n.key),n)}}function _createClass$E(e,t,r){return t&&_defineProperties$E(e.prototype,t),r&&_defineProperties$E(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$F(e){var t=_toPrimitive$F(e,"string");return _typeof$G(t)==="symbol"?t:String(t)}function _toPrimitive$F(e,t){if(_typeof$G(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$G(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$l(){return typeof Reflect<"u"&&Reflect.get?_get$l=Reflect.get.bind():_get$l=function(t,r,n){var o=_superPropBase$l(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$l.apply(this,arguments)}function _superPropBase$l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$p(e),e!==null););return e}function _inherits$p(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$p(e,t)}function _setPrototypeOf$p(e,t){return _setPrototypeOf$p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$p(e,t)}function _createSuper$p(e){var t=_isNativeReflectConstruct$p();return function(){var n=_getPrototypeOf$p(e),o;if(t){var i=_getPrototypeOf$p(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$p(this,o)}}function _possibleConstructorReturn$p(e,t){if(t&&(_typeof$G(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$p(e)}function _assertThisInitialized$p(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$p(e){return _getPrototypeOf$p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$p(e)}var PLUGIN_KEY$i="filters",PLUGIN_PRIORITY$h=250,Filters=function(e){_inherits$p(r,e);var t=_createSuper$p(r);function r(n){var o;return _classCallCheck$E(this,r),o=t.call(this,n),o.eventManager=new EventManager$1(_assertThisInitialized$p(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.lastSelectedColumn=null,o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return _createClass$E(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$i]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new TrimmingMap),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,s=function(h){return h.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),h.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),h.addLocalHook("change",function(y){return o.onComponentChange(h,y)}),h},l=function(){return"".concat(o.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_CONDITION),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_VALUE),":")};if(!this.components.get("filter_by_condition")){var c=new ConditionComponent$1(this.hot,{id:"filter_by_condition",name:l,addSeparator:!1,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",s(c))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new OperatorsComponent$1(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var f=new ConditionComponent$1(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",s(f))}this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new ValueComponent$1(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new ActionBarComponent$1(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new ConditionCollection$1(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ConditionUpdateObserver$1(this.hot,this.conditionCollection,function(d){return o.getDataMapAtColumn(d)}),this.conditionUpdateObserver.addLocalHook("update",function(d){return o.updateComponents(d)})),this.components.forEach(function(d){return d.show()}),this.addHook("beforeDropdownMenuSetItems",function(d){return o.onBeforeDropdownMenuSetItems(d)}),this.addHook("afterDropdownMenuDefaultOptions",function(d){return o.onAfterDropdownMenuDefaultOptions(d)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(d){return o.onAfterChange(d)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),_get$l(_getPrototypeOf$p(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,s){a.destroy(),o.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}_get$l(_getPrototypeOf$p(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:OPERATION_ID$2,l=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(l,{command:{key:i},args:a},s)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),s=[],l=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",l);if(u!==!1)if(a){var c=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),s=arrayMap(i.filter(),function(d){return d.meta.visualRow});var f=createArrayAssertion(s);rangeEach(o.hot.countSourceRows()-1,function(d){f(d)||c.push(d)}),arrayEach(c,function(d){o.filtersRowsMap.setValueAtIndex(d,!0)})},!0),s.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",l),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),s=[];return arrayEach(this.hot.getSourceDataAtCol(a),function(l,u){var c,f=i.hot.getCellMeta(u,a),d=f.row,h=f.col,y=f.visualCol,p=f.visualRow,v=f.type,b=f.instance,S=f.dateFormat,w=f.locale,P=(c=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&c!==void 0?c:l;s.push({meta:{row:d,col:h,visualCol:y,visualRow:p,type:v,instance:b,dateFormat:S,locale:w},value:toEmptyString(P)})}),s}},{key:"onAfterChange",value:function(o){var i=this;o&&arrayEach(o,function(a){var s=_slicedToArray$9(a,2),l=s[1],u=i.hot.propToCol(l);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=unifyColumnValues(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(s){s.isHidden()||s.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:KEY$c}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,s){var l=o;return l===OPERATION_ID$1&&i.command.key!==CONDITION_NAME$k&&a.command.key!==CONDITION_NAME$k&&s.command.key!==CONDITION_NAME$k?l=OPERATION_ID:s.command.key!==CONDITION_NAME$k&&(i.command.key===CONDITION_NAME$k||a.command.key===CONDITION_NAME$k)&&(l=OPERATION_ID$2),l}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var s;(s=this.dropdownMenuPlugin)===null||s===void 0||s.close();return}var l=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),c=this.components.get("filter_by_condition2").getState(),f=this.components.get("filter_by_value").getState(),d=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,c,f);this.conditionUpdateObserver.groupChanges();var h=this.conditionCollection.getColumnStackPosition(l);h===-1&&(h=void 0),this.conditionCollection.removeConditions(l),u.command.key!==CONDITION_NAME$k&&(this.conditionCollection.addCondition(l,u,d,h),c.command.key!==CONDITION_NAME$k&&this.conditionCollection.addCondition(l,c,d,h)),f.command.key!==CONDITION_NAME$k&&this.conditionCollection.addCondition(l,f,d,h),this.conditionUpdateObserver.flush(),this.components.forEach(function(y){return y.saveState(l)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===ConditionComponent$1&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,s):this.hideComponents.apply(this,s)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?addClass(i,"htFiltersActive"):removeClass(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new DataFilter$1(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,s=a.conditions,l=a.column,u=s.filter(function(d){return d.name===CONDITION_NAME}),c=s.filter(function(d){return d.name!==CONDITION_NAME});if(u.length>=2||c.length>=3)warn(toSingleLine(_templateObject$7||(_templateObject$7=_taggedTemplateLiteral$7([`The filter conditions have been applied properly, but couldn’t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var f=this.conditionCollection.getOperation(l);this.components.get("filter_by_condition").updateState(c[0],l),this.components.get("filter_by_condition2").updateState(c[1],l),this.components.get("filter_operators").updateState(f,l),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return arrayEach(s,function(u){arrayEach(i.menuItems,function(c,f){c.key===u.getMenuItemDescriptor().key&&o.push(f)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,s=a.getPlugin("hiddenRows"),l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];var f=this.getIndexesOfComponents.apply(this,u);o?s.showRows(f):s.hideRows(f),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),_get$l(_getPrototypeOf$p(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$i}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$h}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(BasePlugin);function _typeof$F(e){return _typeof$F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$F(e)}function ownKeys$5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$5(Object(r),!0).forEach(function(n){_defineProperty$7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$7(e,t,r){return t=_toPropertyKey$E(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$E(e){var t=_toPrimitive$E(e,"string");return _typeof$F(t)==="symbol"?t:String(t)}function _toPrimitive$E(e,t){if(_typeof$F(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$F(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DEFAULT_LICENSE_KEY="internal-use-in-handsontable",DEFAULT_SETTINGS={licenseKey:DEFAULT_LICENSE_KEY,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function getEngineSettingsOverrides(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[PLUGIN_KEY$h])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function cleanEngineSettings(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function getEngineSettingsWithDefaultsAndOverrides(e){var t,r=e[PLUGIN_KEY$h],n=cleanEngineSettings(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=getEngineSettingsOverrides(e);return _objectSpread$5(_objectSpread$5(_objectSpread$5({},DEFAULT_SETTINGS),n),o)}function getEngineSettingsWithOverrides(e){var t,r=e[PLUGIN_KEY$h],n=cleanEngineSettings(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=getEngineSettingsOverrides(e);return _objectSpread$5(_objectSpread$5({},n),o)}function _typeof$E(e){return _typeof$E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$E(e)}function getEngineRelationshipRegistry(){var e="engine_relationship",t=staticRegister(PLUGIN_KEY$h);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function getSharedEngineUsageRegistry(){var e="shared_engine_usage",t=staticRegister(PLUGIN_KEY$h);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function setupEngine(e){var t=e.getSettings(),r=t[PLUGIN_KEY$h],n=r==null?void 0:r.engine;if(r===!0||isUndefined(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return registerEngine((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(_typeof$E(n)==="object"&&isUndefined(n.hyperformula)){var i=getEngineRelationshipRegistry(),a=getSharedEngineUsageRegistry().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:DEFAULT_LICENSE_KEY}),n}return null}function registerEngine(e,t,r){var n=t[PLUGIN_KEY$h],o=getEngineSettingsWithDefaultsAndOverrides(t),i=getEngineRelationshipRegistry(),a=getSharedEngineUsageRegistry();registerCustomFunctions(e,n.functions),registerLanguage(e,n.language);var s=e.buildEmpty(o);return i.set(s,[r]),a.set(s,[r.guid]),registerNamedExpressions(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function getRegisteredHotInstances(e){var t,r=getEngineRelationshipRegistry(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function unregisterEngine(e,t){if(e){var r=getEngineRelationshipRegistry(),n=r.get(e),o=getSharedEngineUsageRegistry(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function registerCustomFunctions(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){warn(a.message)}})}function registerLanguage(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){warn(n.message)}}}function registerNamedExpressions(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(s){warn(s.message)}}),e.resumeEvaluation())}function setupSheet(e,t){return(isUndefined(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}function isEscapedFormulaExpression(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function unescapeFormulaExpression(e){return isEscapedFormulaExpression(e)?e.substr(1):e}function _toConsumableArray$c(e){return _arrayWithoutHoles$c(e)||_iterableToArray$d(e)||_unsupportedIterableToArray$j(e)||_nonIterableSpread$c()}function _nonIterableSpread$c(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$d(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$c(e){if(Array.isArray(e))return _arrayLikeToArray$j(e)}function ownKeys$4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$4(Object(r),!0).forEach(function(n){_defineProperty$6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _typeof$D(e){return _typeof$D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$D(e)}function _slicedToArray$8(e,t){return _arrayWithHoles$9(e)||_iterableToArrayLimit$8(e,t)||_unsupportedIterableToArray$j(e,t)||_nonIterableRest$9()}function _nonIterableRest$9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$j(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$j(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$j(e,t)}}function _arrayLikeToArray$j(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$8(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$9(e){if(Array.isArray(e))return e}function _classCallCheck$D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$D(n.key),n)}}function _createClass$D(e,t,r){return t&&_defineProperties$D(e.prototype,t),r&&_defineProperties$D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _get$k(){return typeof Reflect<"u"&&Reflect.get?_get$k=Reflect.get.bind():_get$k=function(t,r,n){var o=_superPropBase$k(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$k.apply(this,arguments)}function _superPropBase$k(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$o(e),e!==null););return e}function _inherits$o(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$o(e,t)}function _setPrototypeOf$o(e,t){return _setPrototypeOf$o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$o(e,t)}function _createSuper$o(e){var t=_isNativeReflectConstruct$o();return function(){var n=_getPrototypeOf$o(e),o;if(t){var i=_getPrototypeOf$o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$o(this,o)}}function _possibleConstructorReturn$o(e,t){if(t&&(_typeof$D(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$o(e)}function _assertThisInitialized$o(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$o(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$o(e){return _getPrototypeOf$o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$o(e)}function _defineProperty$6(e,t,r){return t=_toPropertyKey$D(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$D(e){var t=_toPrimitive$D(e,"string");return _typeof$D(t)==="symbol"?t:String(t)}function _toPrimitive$D(e,t){if(_typeof$D(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$D(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldInitSpec$6(e,t,r){_checkPrivateRedeclaration$6(e,t),t.set(e,r)}function _checkPrivateRedeclaration$6(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$6(e,t,r){var n=_classExtractFieldDescriptor$6(e,t,"set");return _classApplyDescriptorSet$6(e,n,r),r}function _classApplyDescriptorSet$6(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function _classPrivateFieldGet$6(e,t){var r=_classExtractFieldDescriptor$6(e,t,"get");return _classApplyDescriptorGet$6(e,r)}function _classExtractFieldDescriptor$6(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorGet$6(e,t){return t.get?t.get.call(e):t.value}var PLUGIN_KEY$h="formulas",PLUGIN_PRIORITY$g=260,ROW_MOVE_UNDO_REDO_NAME="row_move";Hooks$1.getSingleton().register("afterNamedExpressionAdded");Hooks$1.getSingleton().register("afterNamedExpressionRemoved");Hooks$1.getSingleton().register("afterSheetAdded");Hooks$1.getSingleton().register("afterSheetRemoved");Hooks$1.getSingleton().register("afterSheetRenamed");Hooks$1.getSingleton().register("afterFormulasValuesUpdate");var isBlockedSource=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},_internalOperationPending=new WeakMap,_hotWasInitializedWithEmptyData=new WeakMap,_engineListeners=new WeakMap,Formulas=function(e){_inherits$o(r,e);var t=_createSuper$o(r);function r(){var n;_classCallCheck$D(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_classPrivateFieldInitSpec$6(_assertThisInitialized$o(n),_internalOperationPending,{writable:!0,value:!1}),_classPrivateFieldInitSpec$6(_assertThisInitialized$o(n),_hotWasInitializedWithEmptyData,{writable:!0,value:!1}),_classPrivateFieldInitSpec$6(_assertThisInitialized$o(n),_engineListeners,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),_defineProperty$6(_assertThisInitialized$o(n),"staticRegister",staticRegister("formulas")),_defineProperty$6(_assertThisInitialized$o(n),"engine",null),_defineProperty$6(_assertThisInitialized$o(n),"sheetName",null),n}return _createClass$D(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$h]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=setupEngine(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){warn("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeUpdateData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterUpdateData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("beforeUndo",function(s){(s==null?void 0:s.actionType)!==ROW_MOVE_UNDO_REDO_NAME&&i.engine.undo()}),this.addHook("beforeRedo",function(s){(s==null?void 0:s.actionType)!==ROW_MOVE_UNDO_REDO_NAME&&i.engine.redo()}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),_classPrivateFieldGet$6(this,_engineListeners).forEach(function(s){var l=_slicedToArray$8(s,2),u=l[0],c=l[1];return i.engine.on(u,c)}),_get$k(_getPrototypeOf$o(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;_classPrivateFieldGet$6(this,_engineListeners).forEach(function(i){var a=_slicedToArray$8(i,2),s=a[0],l=a[1];return o.engine.off(s,l)}),unregisterEngine(this.engine,this.hot),this.engine=null,_get$k(_getPrototypeOf$o(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){this.engine.updateConfig(getEngineSettingsWithOverrides(this.hot.getSettings()));var i=this.hot.getSettings()[PLUGIN_KEY$h];if(isDefined(i)&&isDefined(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!o.data&&this.sheetName===null){var a=this.hot.getSettings()[PLUGIN_KEY$h].sheetName;a&&this.engine.doesSheetExist(a)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(a??void 0,this.hot.getSourceDataArray())}_get$k(_getPrototypeOf$o(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;_classPrivateFieldGet$6(this,_engineListeners).forEach(function(i){var a,s=_slicedToArray$8(i,2),l=s[0],u=s[1];return(a=o.engine)===null||a===void 0?void 0:a.off(l,u)}),_classPrivateFieldSet$6(this,_engineListeners,null),unregisterEngine(this.engine,this.hot),this.engine=null,_get$k(_getPrototypeOf$o(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(o,i,a,s,l){return!l&&o>=a?s+(o-a):i}},{key:"toPhysicalRowPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(o,this.hot.toPhysicalRow(o),this.hot.countRows(),this.hot.countSourceRows(),i)}},{key:"toPhysicalColumnPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(o,this.hot.toPhysicalColumn(o),this.hot.countCols(),this.hot.countSourceCols(),i)}},{key:"addSheet",value:function(o,i){if(isDefined(i)&&!isArrayOfArrays(i))return warn("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return warn("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(s){return warn(s.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){error("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(toUpperCaseFirst(PLUGIN_KEY$h),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(o),l=this.hot.toPhysicalColumn(i);return s!==null&&l!==null?this.engine.getCellType({sheet:a,row:s,col:l}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(o),l=this.hot.toPhysicalColumn(i);return s===null||l===null?!1:this.engine.doesCellHaveFormula({sheet:a,row:s,col:l})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=new Set;o.forEach(function(l){var u,c=l==null||(u=l.address)===null||u===void 0?void 0:u.sheet;c!==void 0&&(s.has(c)||s.add(c))}),getRegisteredHotInstances(this.engine).forEach(function(l,u){if((a||u!==i.sheetId)&&s.has(u)){var c;l.render(),(c=l.view)===null||c===void 0||c.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=function(c){var f,d=(f=c==null?void 0:c.address)!==null&&f!==void 0?f:{},h=d.row,y=d.col,p=d.sheet;return isDefined(p)?"".concat(p,":").concat(h,"x").concat(y):""},l=new Set(a.map(function(u){return s(u)}));o.forEach(function(u){var c,f,d=(c=u.address)!==null&&c!==void 0?c:{},h=d.row,y=d.col,p=isDefined(h)?i.hot.toVisualRow(h):null,v=isDefined(y)?i.hot.toVisualColumn(y):null;if(!(p===null||v===null)){var b=u==null||(f=u.address)===null||f===void 0?void 0:f.sheet,S=s(u);if(b!==void 0&&!l.has(S)){var w=getRegisteredHotInstances(i.engine).get(b);if(!w)return;w.validateCell(w.getDataAtCell(p,v),w.getCellMeta(p,v),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var s={row:this.toPhysicalRowPosition(o),col:this.toPhysicalColumnPosition(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){warn("Not possible to set cell data at ".concat(JSON.stringify(s)));return}return this.engine.setCellContents(s,a)}},{key:"onBeforeValidate",value:function(o,i,a){var s=this.hot.propToCol(a);if(this.isFormulaCellType(i,s)){var l={row:this.hot.toPhysicalRow(i),col:this.hot.toPhysicalColumn(s),sheet:this.sheetId},u=this.engine.getCellValue(l);return _typeof$D(u)==="object"&&u!==null?u.value:u}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var s=this,l=function(d){return _objectSpread$4(_objectSpread$4({},d),{},{sheet:s.sheetId})},u={start:l(i.getTopStartCorner()),end:l(i.getBottomEndCorner())},c={start:l(a.getTopStartCorner()),end:l(a.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(c)===!1?!1:this.engine.getFillRangeData(u,c)}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(toUpperCaseFirst(PLUGIN_KEY$h))||_classPrivateFieldSet$6(this,_hotWasInitializedWithEmptyData,isUndefined(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(toUpperCaseFirst(PLUGIN_KEY$h)))if(this.sheetName=setupSheet(this.engine,this.hot.getSettings()[PLUGIN_KEY$h].sheetName),_classPrivateFieldGet$6(this,_hotWasInitializedWithEmptyData))this.switchSheet(this.sheetName);else{var s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){_classPrivateFieldSet$6(this,_internalOperationPending,!0);var l=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(l),_classPrivateFieldSet$6(this,_internalOperationPending,!1)}}}},{key:"onModifyData",value:function(o,i,a,s){if(!(s!=="get"||_classPrivateFieldGet$6(this,_internalOperationPending)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(o),u=this.isFormulaCellType(l,i);if(!u){var c=this.getCellType(l,i);if(c!=="ARRAY"){isEscapedFormulaExpression(a.value)&&(a.value=unescapeFormulaExpression(a.value));return}}var f={row:o,col:this.toPhysicalColumnPosition(i),sheet:this.sheetId},d=this.engine.getCellValue(f),h=_typeof$D(d)==="object"&&d!==null?d.value:d;a.value=h}}},{key:"onModifySourceData",value:function(o,i,a,s){if(!(s!=="get"||_classPrivateFieldGet$6(this,_internalOperationPending)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(o),u=this.hot.propToCol(i),c=this.isFormulaCellType(l,u);if(!c){var f=this.getCellType(l,u);if(f!=="ARRAY")return}var d=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(d.width===0&&d.height===0)){var h={row:o,col:this.toPhysicalColumnPosition(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(h)}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!isBlockedSource(i)){var s=[],l=[],u=this.engine.batch(function(){o.forEach(function(c){var f=_slicedToArray$8(c,4),d=f[0],h=f[1],y=f[3],p=a.hot.propToCol(h),v=a.hot.toPhysicalRow(d),b=a.hot.toPhysicalColumn(p),S={row:v,col:b,sheet:a.sheetId};v!==null&&b!==null?a.syncChangeWithEngine(d,p,y):s.push([d,p,y]),l.push({address:S})})});s.length&&this.hot.addHookOnce("afterChange",function(){var c=a.engine.batch(function(){s.forEach(function(f){var d=_slicedToArray$8(f,3),h=d[0],y=d[1],p=d[2];a.syncChangeWithEngine(h,y,p)})});a.renderDependentSheets(c,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,l)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!isBlockedSource(i)){var s=[],l=[];o.forEach(function(u){var c=_slicedToArray$8(u,4),f=c[0],d=c[1],h=c[3],y=a.hot.propToCol(d);if(isNumeric(y)){var p={row:f,col:a.toPhysicalColumnPosition(y),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(p)){warn("Not possible to set source cell data at ".concat(JSON.stringify(p)));return}l.push({address:p}),s.push.apply(s,_toConsumableArray$c(a.engine.setCellContents(p,h)))}}),this.renderDependentSheets(s),this.validateDependentCells(s,l)}}},{key:"onBeforeCreateRow",value:function(o,i){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(o),i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(o),i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var s=this,l=a.every(function(u){return s.engine.isItPossibleToRemoveRows(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var s=this,l=a.every(function(u){return s.engine.isItPossibleToRemoveColumns(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!isBlockedSource(a)){var s=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(o),i]);this.renderDependentSheets(s)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!isBlockedSource(a)){var s=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(o),i]);this.renderDependentSheets(s)}}},{key:"onAfterRemoveRow",value:function(o,i,a,s){var l=this;if(!isBlockedSource(s)){var u=a.sort().reverse(),c=this.engine.batch(function(){u.forEach(function(f){l.engine.removeRows(l.sheetId,[f,1])})});this.renderDependentSheets(c)}}},{key:"onAfterRemoveCol",value:function(o,i,a,s){var l=this;if(!isBlockedSource(s)){var u=a.sort().reverse(),c=this.engine.batch(function(){u.forEach(function(f){l.engine.removeColumns(l.sheetId,[f,1])})});this.renderDependentSheets(c)}}},{key:"onAfterDetachChild",value:function(o,i,a){var s,l=this;_classPrivateFieldSet$6(this,_internalOperationPending,!0);var u=this.hot.getSourceDataArray(a,0,a+(((s=i.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());_classPrivateFieldSet$6(this,_internalOperationPending,!1),u.forEach(function(c,f){c.forEach(function(d,h){l.engine.setCellContents({col:h,row:a+f,sheet:l.sheetId},[[d]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$h}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$g}}]),r}(BasePlugin);function _slicedToArray$7(e,t){return _arrayWithHoles$8(e)||_iterableToArrayLimit$7(e,t)||_unsupportedIterableToArray$i(e,t)||_nonIterableRest$8()}function _nonIterableRest$8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$i(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$i(e,t)}}function _arrayLikeToArray$i(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$7(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$8(e){if(Array.isArray(e))return e}function hideColumnItem(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=_slicedToArray$7(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_COLUMN,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),s=[],l=i;l<=a;l+=1)s.push(l);e.hideColumns(s);var u=s[s.length-1],c=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(c)&&c>=0?this.selectColumns(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function _toConsumableArray$b(e){return _arrayWithoutHoles$b(e)||_iterableToArray$c(e)||_unsupportedIterableToArray$h(e)||_nonIterableSpread$b()}function _nonIterableSpread$b(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$h(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$h(e,t)}}function _iterableToArray$c(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$b(e){if(Array.isArray(e))return _arrayLikeToArray$h(e)}function _arrayLikeToArray$h(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function showColumnItem(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_COLUMN,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var s=a-i+1===this.countCols();s||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=arrayMap(e.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,s=i.getBottomEndCorner().col,l=this.columnIndexMapper,u=l.getRenderableFromVisualIndex(a),c=l.getRenderableFromVisualIndex(s),f=l.getNotTrimmedIndexes(),d=[];if(a!==s){var h=s-a+1,y=c-u+1;if(h>y){var p=f.slice(a,s+1);d.push.apply(d,_toConsumableArray$b(p.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)d.push.apply(d,_toConsumableArray$b(f.slice(0,a)));else if(u===null)d.push.apply(d,_toConsumableArray$b(f.slice(0,this.countCols())));else{var v=this.countCols()-1,b=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(v,-1));c===b&&v>s&&d.push.apply(d,_toConsumableArray$b(f.slice(s+1)))}return arrayEach(d,function(S){t.push(n.toVisualColumn(S))}),t.length===0}}}function _typeof$C(e){return _typeof$C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$C(e)}function _classCallCheck$C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$C(n.key),n)}}function _createClass$C(e,t,r){return t&&_defineProperties$C(e.prototype,t),r&&_defineProperties$C(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$C(e){var t=_toPrimitive$C(e,"string");return _typeof$C(t)==="symbol"?t:String(t)}function _toPrimitive$C(e,t){if(_typeof$C(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$C(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$j(){return typeof Reflect<"u"&&Reflect.get?_get$j=Reflect.get.bind():_get$j=function(t,r,n){var o=_superPropBase$j(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$j.apply(this,arguments)}function _superPropBase$j(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$n(e),e!==null););return e}function _inherits$n(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$n(e,t)}function _setPrototypeOf$n(e,t){return _setPrototypeOf$n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$n(e,t)}function _createSuper$n(e){var t=_isNativeReflectConstruct$n();return function(){var n=_getPrototypeOf$n(e),o;if(t){var i=_getPrototypeOf$n(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$n(this,o)}}function _possibleConstructorReturn$n(e,t){if(t&&(_typeof$C(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$n(e)}function _assertThisInitialized$n(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$n(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$n(e){return _getPrototypeOf$n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$n(e)}function _classPrivateFieldInitSpec$5(e,t,r){_checkPrivateRedeclaration$5(e,t),t.set(e,r)}function _checkPrivateRedeclaration$5(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$5(e,t){var r=_classExtractFieldDescriptor$5(e,t,"get");return _classApplyDescriptorGet$5(e,r)}function _classApplyDescriptorGet$5(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet$5(e,t,r){var n=_classExtractFieldDescriptor$5(e,t,"set");return _classApplyDescriptorSet$5(e,n,r),r}function _classExtractFieldDescriptor$5(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet$5(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Hooks$1.getSingleton().register("beforeHideColumns");Hooks$1.getSingleton().register("afterHideColumns");Hooks$1.getSingleton().register("beforeUnhideColumns");Hooks$1.getSingleton().register("afterUnhideColumns");var PLUGIN_KEY$g="hiddenColumns",PLUGIN_PRIORITY$f=310,_settings$1=new WeakMap,_hiddenColumnsMap=new WeakMap,HiddenColumns=function(e){_inherits$n(r,e);var t=_createSuper$n(r);function r(){var n;_classCallCheck$C(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_classPrivateFieldInitSpec$5(_assertThisInitialized$n(n),_settings$1,{writable:!0,value:{}}),_classPrivateFieldInitSpec$5(_assertThisInitialized$n(n),_hiddenColumnsMap,{writable:!0,value:null}),n}return _createClass$C(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$g]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[PLUGIN_KEY$g];isObject$6(i)&&(_classPrivateFieldSet$5(this,_settings$1,i),isUndefined(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),_classPrivateFieldSet$5(this,_hiddenColumnsMap,new HidingMap),_classPrivateFieldGet$5(this,_hiddenColumnsMap).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$5(this,_hiddenColumnsMap)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return o.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyColWidth",function(a,s){return o.onModifyColWidth(a,s)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),_get$j(_getPrototypeOf$n(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$j(_getPrototypeOf$n(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$5(this,_settings$1,{}),_get$j(_getPrototypeOf$n(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),s=this.isValidConfig(o),l=a,u=_classPrivateFieldGet$5(this,_hiddenColumnsMap).getValues().slice(),c=o.length>0;if(s&&c){var f=o.map(function(h){return i.hot.toPhysicalColumn(h)});arrayEach(f,function(h){u[h]=!1}),l=arrayReduce$1(u,function(h,y,p){return y&&h.push(i.hot.toVisualColumn(p)),h},[])}var d=this.hot.runHooks("beforeUnhideColumns",a,l,s&&c);d!==!1&&(s&&c&&_classPrivateFieldGet$5(this,_hiddenColumnsMap).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,l,s&&c,s&&l.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),s=this.isValidConfig(o),l=a;s&&(l=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){arrayEach(o,function(c){_classPrivateFieldGet$5(i,_hiddenColumnsMap).setValueAtIndex(i.hot.toPhysicalColumn(c),!0)})},!0),this.hot.runHooks("afterHideColumns",a,l,s,s&&l.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return arrayMap(_classPrivateFieldGet$5(this,_hiddenColumnsMap).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return _classPrivateFieldGet$5(this,_hiddenColumnsMap).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){arrayEach(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if(_classPrivateFieldGet$5(this,_settings$1).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(_classPrivateFieldGet$5(this,_settings$1).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenColumn");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(_classPrivateFieldGet$5(this,_settings$1).copyPasteEnabled)return o;var a=[],s=function(u,c,f,d){a.push({startRow:u,endRow:c,startCol:f,endCol:d})};return arrayEach(o,function(l){var u=!0,c=0;rangeEach(l.startCol,l.endCol,function(f){i.isHidden(f)?(u||s(l.startRow,l.endRow,c,f-1),u=!0):(u&&(c=f),f===l.endCol&&s(l.startRow,l.endRow,c,f),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!_classPrivateFieldGet$5(this,_settings$1).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),addClass(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:KEY$c},hideColumnItem(this),showColumnItem(this))}},{key:"onMapInit",value:function(){Array.isArray(_classPrivateFieldGet$5(this,_settings$1).columns)&&this.hideColumns(_classPrivateFieldGet$5(this,_settings$1).columns)}},{key:"destroy",value:function(){_classPrivateFieldSet$5(this,_settings$1,null),_classPrivateFieldSet$5(this,_hiddenColumnsMap,null),_get$j(_getPrototypeOf$n(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$g}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$f}}]),r}(BasePlugin);function _slicedToArray$6(e,t){return _arrayWithHoles$7(e)||_iterableToArrayLimit$6(e,t)||_unsupportedIterableToArray$g(e,t)||_nonIterableRest$7()}function _nonIterableRest$7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$g(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$g(e,t)}}function _arrayLikeToArray$g(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$6(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$7(e){if(Array.isArray(e))return e}function hideRowItem(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=_slicedToArray$6(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_ROW,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),s=[],l=i;l<=a;l+=1)s.push(l);e.hideRows(s);var u=s[s.length-1],c=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(c)&&c>=0?this.selectRows(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function _toConsumableArray$a(e){return _arrayWithoutHoles$a(e)||_iterableToArray$b(e)||_unsupportedIterableToArray$f(e)||_nonIterableSpread$a()}function _nonIterableSpread$a(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$f(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$f(e,t)}}function _iterableToArray$b(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$a(e){if(Array.isArray(e))return _arrayLikeToArray$f(e)}function _arrayLikeToArray$f(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function showRowItem(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_ROW,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var s=a-i+1===this.countRows();s||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=arrayMap(e.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,s=i.getBottomEndCorner().row,l=this.rowIndexMapper,u=l.getRenderableFromVisualIndex(a),c=l.getRenderableFromVisualIndex(s),f=l.getNotTrimmedIndexes(),d=[];if(a!==s){var h=s-a+1,y=c-u+1;if(h>y){var p=f.slice(a,s+1);d.push.apply(d,_toConsumableArray$a(p.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)d.push.apply(d,_toConsumableArray$a(f.slice(0,a)));else if(u===null)d.push.apply(d,_toConsumableArray$a(f.slice(0,this.countRows())));else{var v=this.countRows()-1,b=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(v,-1));c===b&&v>s&&d.push.apply(d,_toConsumableArray$a(f.slice(s+1)))}return arrayEach(d,function(S){t.push(n.toVisualRow(S))}),t.length===0}}}function _typeof$B(e){return _typeof$B=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$B(e)}function _classCallCheck$B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$B(n.key),n)}}function _createClass$B(e,t,r){return t&&_defineProperties$B(e.prototype,t),r&&_defineProperties$B(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$B(e){var t=_toPrimitive$B(e,"string");return _typeof$B(t)==="symbol"?t:String(t)}function _toPrimitive$B(e,t){if(_typeof$B(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$B(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$i(){return typeof Reflect<"u"&&Reflect.get?_get$i=Reflect.get.bind():_get$i=function(t,r,n){var o=_superPropBase$i(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$i.apply(this,arguments)}function _superPropBase$i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$m(e),e!==null););return e}function _inherits$m(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$m(e,t)}function _setPrototypeOf$m(e,t){return _setPrototypeOf$m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$m(e,t)}function _createSuper$m(e){var t=_isNativeReflectConstruct$m();return function(){var n=_getPrototypeOf$m(e),o;if(t){var i=_getPrototypeOf$m(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$m(this,o)}}function _possibleConstructorReturn$m(e,t){if(t&&(_typeof$B(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$m(e)}function _assertThisInitialized$m(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$m(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$m(e){return _getPrototypeOf$m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$m(e)}function _classPrivateFieldInitSpec$4(e,t,r){_checkPrivateRedeclaration$4(e,t),t.set(e,r)}function _checkPrivateRedeclaration$4(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$4(e,t){var r=_classExtractFieldDescriptor$4(e,t,"get");return _classApplyDescriptorGet$4(e,r)}function _classApplyDescriptorGet$4(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet$4(e,t,r){var n=_classExtractFieldDescriptor$4(e,t,"set");return _classApplyDescriptorSet$4(e,n,r),r}function _classExtractFieldDescriptor$4(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet$4(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Hooks$1.getSingleton().register("beforeHideRows");Hooks$1.getSingleton().register("afterHideRows");Hooks$1.getSingleton().register("beforeUnhideRows");Hooks$1.getSingleton().register("afterUnhideRows");var PLUGIN_KEY$f="hiddenRows",PLUGIN_PRIORITY$e=320,_settings=new WeakMap,_hiddenRowsMap=new WeakMap,HiddenRows=function(e){_inherits$m(r,e);var t=_createSuper$m(r);function r(){var n;_classCallCheck$B(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_classPrivateFieldInitSpec$4(_assertThisInitialized$m(n),_settings,{writable:!0,value:{}}),_classPrivateFieldInitSpec$4(_assertThisInitialized$m(n),_hiddenRowsMap,{writable:!0,value:null}),n}return _createClass$B(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$f]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[PLUGIN_KEY$f];isObject$6(i)&&(_classPrivateFieldSet$4(this,_settings,i),isUndefined(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),_classPrivateFieldSet$4(this,_hiddenRowsMap,new HidingMap),_classPrivateFieldGet$4(this,_hiddenRowsMap).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$4(this,_hiddenRowsMap)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return o.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyRowHeight",function(a,s){return o.onModifyRowHeight(a,s)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),_get$i(_getPrototypeOf$m(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$i(_getPrototypeOf$m(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$4(this,_settings,{}),_get$i(_getPrototypeOf$m(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),s=this.isValidConfig(o),l=a,u=_classPrivateFieldGet$4(this,_hiddenRowsMap).getValues().slice(),c=o.length>0;if(s&&c){var f=o.map(function(h){return i.hot.toPhysicalRow(h)});arrayEach(f,function(h){u[h]=!1}),l=arrayReduce$1(u,function(h,y,p){return y&&h.push(i.hot.toVisualRow(p)),h},[])}var d=this.hot.runHooks("beforeUnhideRows",a,l,s&&c);d!==!1&&(s&&c&&_classPrivateFieldGet$4(this,_hiddenRowsMap).setValues(u),this.hot.runHooks("afterUnhideRows",a,l,s&&c,s&&l.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),s=this.isValidConfig(o),l=a;s&&(l=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){arrayEach(o,function(c){_classPrivateFieldGet$4(i,_hiddenRowsMap).setValueAtIndex(i.hot.toPhysicalRow(c),!0)})},!0),this.hot.runHooks("afterHideRows",a,l,s,s&&l.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return arrayMap(_classPrivateFieldGet$4(this,_hiddenRowsMap).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return _classPrivateFieldGet$4(this,_hiddenRowsMap).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){arrayEach(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(_classPrivateFieldGet$4(this,_settings).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenRow");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(_classPrivateFieldGet$4(this,_settings).copyPasteEnabled)return o;var a=[],s=function(u,c,f,d){a.push({startRow:u,endRow:c,startCol:f,endCol:d})};return arrayEach(o,function(l){var u=!0,c=0;rangeEach(l.startRow,l.endRow,function(f){i.isHidden(f)?(u||s(c,f-1,l.startCol,l.endCol),u=!0):(u&&(c=f),f===l.endRow&&s(c,f,l.startCol,l.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!_classPrivateFieldGet$4(this,_settings).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),addClass(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:KEY$c},hideRowItem(this),showRowItem(this))}},{key:"onMapInit",value:function(){Array.isArray(_classPrivateFieldGet$4(this,_settings).rows)&&this.hideRows(_classPrivateFieldGet$4(this,_settings).rows)}},{key:"destroy",value:function(){_classPrivateFieldSet$4(this,_settings,null),_classPrivateFieldSet$4(this,_hiddenRowsMap,null),_get$i(_getPrototypeOf$m(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$f}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$e}}]),r}(BasePlugin);function _slicedToArray$5(e,t){return _arrayWithHoles$6(e)||_iterableToArrayLimit$5(e,t)||_unsupportedIterableToArray$e(e,t)||_nonIterableRest$6()}function _nonIterableRest$6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$e(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$e(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$e(e,t)}}function _arrayLikeToArray$e(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$5(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$6(e){if(Array.isArray(e))return e}function freezeColumnItem(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function(r,n){var o=_slicedToArray$5(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function _slicedToArray$4(e,t){return _arrayWithHoles$5(e)||_iterableToArrayLimit$4(e,t)||_unsupportedIterableToArray$d(e,t)||_nonIterableRest$5()}function _nonIterableRest$5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$d(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$d(e,t)}}function _arrayLikeToArray$d(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$4(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$5(e){if(Array.isArray(e))return e}function unfreezeColumnItem(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function(r,n){var o=_slicedToArray$4(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function _typeof$A(e){return _typeof$A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$A(e)}function _classCallCheck$A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$A(n.key),n)}}function _createClass$A(e,t,r){return t&&_defineProperties$A(e.prototype,t),r&&_defineProperties$A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$A(e){var t=_toPrimitive$A(e,"string");return _typeof$A(t)==="symbol"?t:String(t)}function _toPrimitive$A(e,t){if(_typeof$A(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$A(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$h(){return typeof Reflect<"u"&&Reflect.get?_get$h=Reflect.get.bind():_get$h=function(t,r,n){var o=_superPropBase$h(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$h.apply(this,arguments)}function _superPropBase$h(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$l(e),e!==null););return e}function _inherits$l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$l(e,t)}function _setPrototypeOf$l(e,t){return _setPrototypeOf$l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$l(e,t)}function _createSuper$l(e){var t=_isNativeReflectConstruct$l();return function(){var n=_getPrototypeOf$l(e),o;if(t){var i=_getPrototypeOf$l(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$l(this,o)}}function _possibleConstructorReturn$l(e,t){if(t&&(_typeof$A(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$l(e)}function _assertThisInitialized$l(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$l(e){return _getPrototypeOf$l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$l(e)}Hooks$1.getSingleton().register("beforeColumnFreeze");Hooks$1.getSingleton().register("afterColumnFreeze");Hooks$1.getSingleton().register("beforeColumnUnfreeze");Hooks$1.getSingleton().register("afterColumnUnfreeze");var PLUGIN_KEY$e="manualColumnFreeze",PLUGIN_PRIORITY$d=110,privatePool$7=new WeakMap,ManualColumnFreeze=function(e){_inherits$l(r,e);var t=_createSuper$l(r);function r(n){var o;return _classCallCheck$A(this,r),o=t.call(this,n),privatePool$7.set(_assertThisInitialized$l(o),{afterFirstUse:!1}),o}return _createClass$A(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$e]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),_get$h(_getPrototypeOf$l(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=privatePool$7.get(this);o.afterFirstUse=!1,_get$h(_getPrototypeOf$l(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$h(_getPrototypeOf$l(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=privatePool$7.get(this),a=this.hot.getSettings(),s=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnFreeze",o,s);l!==!1&&(s&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,s))}},{key:"unfreezeColumn",value:function(o){var i=privatePool$7.get(this),a=this.hot.getSettings(),s=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnUnfreeze",o,s);l!==!1&&(s&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,s))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},freezeColumnItem(this),unfreezeColumnItem(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=privatePool$7.get(this);if(a.afterFirstUse){var s=this.hot.getSettings().fixedColumnsStart;if(i<s||o.some(function(l){return l<s}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$e}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$d}}]),r}(BasePlugin);function _typeof$z(e){return _typeof$z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$z(e)}function _classCallCheck$z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$z(n.key),n)}}function _createClass$z(e,t,r){return t&&_defineProperties$z(e.prototype,t),r&&_defineProperties$z(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$z(e){var t=_toPrimitive$z(e,"string");return _typeof$z(t)==="symbol"?t:String(t)}function _toPrimitive$z(e,t){if(_typeof$z(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$z(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var STATE_INITIALIZED$1=0,STATE_BUILT$1=1,STATE_APPENDED$1=2,UNIT$1="px",BaseUI$4=function(){function e(t){_classCallCheck$z(this,e),this.hot=t,this._element=null,this.state=STATE_INITIALIZED$1,this.inlineProperty=t.isRtl()?"right":"left"}return _createClass$z(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=STATE_APPENDED$1}},{key:"build",value:function(){this.state===STATE_INITIALIZED$1&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT$1)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED$1}},{key:"isAppended",value:function(){return this.state===STATE_APPENDED$1}},{key:"isBuilt",value:function(){return this.state>=STATE_BUILT$1}},{key:"setPosition",value:function(r,n){isNumeric(r)&&(this._element.style.top=r+UNIT$1),isNumeric(n)&&(this._element.style[this.inlineProperty]=n+UNIT$1)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){isNumeric(r)&&(this._element.style.width=r+UNIT$1),isNumeric(n)&&(this._element.style.height=n+UNIT$1)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){isNumeric(r)&&(this._element.style.marginTop=r+UNIT$1),isNumeric(n)&&(this._element.style["margin".concat(toUpperCaseFirst(this.inlineProperty))]=n+UNIT$1)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(toUpperCaseFirst(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const BaseUI$5=BaseUI$4;function _typeof$y(e){return _typeof$y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$y(e)}function _classCallCheck$y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$y(n.key),n)}}function _createClass$y(e,t,r){return t&&_defineProperties$y(e.prototype,t),r&&_defineProperties$y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$y(e){var t=_toPrimitive$y(e,"string");return _typeof$y(t)==="symbol"?t:String(t)}function _toPrimitive$y(e,t){if(_typeof$y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$g(){return typeof Reflect<"u"&&Reflect.get?_get$g=Reflect.get.bind():_get$g=function(t,r,n){var o=_superPropBase$g(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$g.apply(this,arguments)}function _superPropBase$g(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$k(e),e!==null););return e}function _inherits$k(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$k(e,t)}function _setPrototypeOf$k(e,t){return _setPrototypeOf$k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$k(e,t)}function _createSuper$k(e){var t=_isNativeReflectConstruct$k();return function(){var n=_getPrototypeOf$k(e),o;if(t){var i=_getPrototypeOf$k(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$k(this,o)}}function _possibleConstructorReturn$k(e,t){if(t&&(_typeof$y(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$k(e)}function _assertThisInitialized$k(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$k(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$k(e){return _getPrototypeOf$k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$k(e)}var CSS_CLASSNAME$3="ht__manualColumnMove--backlight",BacklightUI$2=function(e){_inherits$k(r,e);var t=_createSuper$k(r);function r(){return _classCallCheck$y(this,r),t.apply(this,arguments)}return _createClass$y(r,[{key:"build",value:function(){_get$g(_getPrototypeOf$k(r.prototype),"build",this).call(this),addClass(this._element,CSS_CLASSNAME$3)}}]),r}(BaseUI$5);const BacklightUI$3=BacklightUI$2;function _typeof$x(e){return _typeof$x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$x(e)}function _classCallCheck$x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$x(n.key),n)}}function _createClass$x(e,t,r){return t&&_defineProperties$x(e.prototype,t),r&&_defineProperties$x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$x(e){var t=_toPrimitive$x(e,"string");return _typeof$x(t)==="symbol"?t:String(t)}function _toPrimitive$x(e,t){if(_typeof$x(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$x(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$f(){return typeof Reflect<"u"&&Reflect.get?_get$f=Reflect.get.bind():_get$f=function(t,r,n){var o=_superPropBase$f(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$f.apply(this,arguments)}function _superPropBase$f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$j(e),e!==null););return e}function _inherits$j(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$j(e,t)}function _setPrototypeOf$j(e,t){return _setPrototypeOf$j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$j(e,t)}function _createSuper$j(e){var t=_isNativeReflectConstruct$j();return function(){var n=_getPrototypeOf$j(e),o;if(t){var i=_getPrototypeOf$j(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$j(this,o)}}function _possibleConstructorReturn$j(e,t){if(t&&(_typeof$x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$j(e)}function _assertThisInitialized$j(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$j(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$j(e){return _getPrototypeOf$j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$j(e)}var CSS_CLASSNAME$2="ht__manualColumnMove--guideline",GuidelineUI$2=function(e){_inherits$j(r,e);var t=_createSuper$j(r);function r(){return _classCallCheck$x(this,r),t.apply(this,arguments)}return _createClass$x(r,[{key:"build",value:function(){_get$f(_getPrototypeOf$j(r.prototype),"build",this).call(this),addClass(this._element,CSS_CLASSNAME$2)}}]),r}(BaseUI$5);const GuidelineUI$3=GuidelineUI$2;function _typeof$w(e){return _typeof$w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$w(e)}function _classCallCheck$w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$w(n.key),n)}}function _createClass$w(e,t,r){return t&&_defineProperties$w(e.prototype,t),r&&_defineProperties$w(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$w(e){var t=_toPrimitive$w(e,"string");return _typeof$w(t)==="symbol"?t:String(t)}function _toPrimitive$w(e,t){if(_typeof$w(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$w(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$e(){return typeof Reflect<"u"&&Reflect.get?_get$e=Reflect.get.bind():_get$e=function(t,r,n){var o=_superPropBase$e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$e.apply(this,arguments)}function _superPropBase$e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$i(e),e!==null););return e}function _inherits$i(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$i(e,t)}function _setPrototypeOf$i(e,t){return _setPrototypeOf$i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$i(e,t)}function _createSuper$i(e){var t=_isNativeReflectConstruct$i();return function(){var n=_getPrototypeOf$i(e),o;if(t){var i=_getPrototypeOf$i(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$i(this,o)}}function _possibleConstructorReturn$i(e,t){if(t&&(_typeof$w(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$i(e)}function _assertThisInitialized$i(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$i(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$i(e){return _getPrototypeOf$i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$i(e)}Hooks$1.getSingleton().register("beforeColumnMove");Hooks$1.getSingleton().register("afterColumnMove");var PLUGIN_KEY$d="manualColumnMove",PLUGIN_PRIORITY$c=120,privatePool$6=new WeakMap,CSS_PLUGIN$1="ht__manualColumnMove",CSS_SHOW_UI$1="show-ui",CSS_ON_MOVING$1="on-moving--columns",CSS_AFTER_SELECTION$1="after-selection--columns",ManualColumnMove=function(e){_inherits$i(r,e);var t=_createSuper$i(r);function r(n){var o;return _classCallCheck$w(this,r),o=t.call(this,n),privatePool$6.set(_assertThisInitialized$i(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new EventManager$1(_assertThisInitialized$i(o)),o.backlight=new BacklightUI$3(n),o.guideline=new GuidelineUI$3(n),o}return _createClass$w(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$d]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),addClass(this.hot.rootElement,CSS_PLUGIN$1),_get$e(_getPrototypeOf$i(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),_get$e(_getPrototypeOf$i(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){removeClass(this.hot.rootElement,CSS_PLUGIN$1),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),_get$e(_getPrototypeOf$i(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=privatePool$6.get(this),s=a.cachedDropIndex,l=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,s,l);if(a.cachedDropIndex=void 0,u!==!1){l&&this.hot.columnIndexMapper.moveIndexes(o,i);var c=l&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,s,l,c),c}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),s=privatePool$6.get(this);return s.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=o.length+i>a,l=i<0,u=o.some(function(f){return f<0}),c=o.some(function(f){return f>=a});return!(s||l||u||c)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,s){return a-s!==i})}},{key:"countFinalIndex",value:function(o,i){var a=arrayReduce$1(o,function(s,l){return l<i&&(s+=1),s},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,s=0,l=o;l<=i;l+=1){var u=a.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(s+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return s}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[PLUGIN_KEY$d];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return rangeEach(o,i,function(s){a.push(s)}),a}},{key:"refreshPositions",value:function(){var o=privatePool$6.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtOverlays.scrollableElement,l=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),c=a.hider.offsetWidth,f=a.TBODY.offsetLeft,d=this.backlight.getOffset().start,h=this.backlight.getSize().width,y=0,p=0;if(this.hot.isRtl()){var v=this.hot.rootWindow,b=outerWidth(this.hot.rootElement),S=v.innerWidth-o.rootElementOffset-b;p=v.innerWidth-o.target.eventPageX-S-(s.scrollX===void 0?l:0)}else p=o.target.eventPageX-(o.rootElementOffset-(s.scrollX===void 0?l:0));if(o.hasRowHeaders&&(y=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=l),u+=y,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=p){var w=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=w+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var P=p,E=u;p+h+d>=c?P=c-h-d:p+d<f+y&&(P=f+y+Math.abs(d)),u>=c-1?E=c-1:E===0?E=1:s.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(E-=o.rootElementOffset<=s.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,P),this.guideline.setPosition(null,E)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,s){var l=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),c=this.hot.getSelectedRangeLast(),f=privatePool$6.get(this),d=hasClass(o.target,"sortAction");if(!c||!u||f.pressed||o.button!==0||d){f.pressed=!1,f.columnsToMove.length=0,removeClass(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1]);return}var h=this.guideline.isBuilt()&&!this.guideline.isAppended(),y=this.backlight.isBuilt()&&!this.backlight.isAppended();h&&y&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var p=c.from,v=c.to,b=Math.min(p.col,v.col),S=Math.max(p.col,v.col);if(i.row<0&&i.col>=b&&i.col<=S){s.column=!0,f.pressed=!0,f.target.eventPageX=o.pageX,f.target.eventOffsetX=o.offsetX,f.hoveredColumn=i.col,f.target.TD=a,f.target.col=i.col,f.columnsToMove=this.prepareColumnsToMoving(b,S),f.hasRowHeaders=!!this.hot.getSettings().rowHeaders,f.countCols=this.hot.countCols(),f.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,f.rootElementOffset=offset(this.hot.rootElement).left;var w=f.hasRowHeaders?-1:0,P=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,E=i.col<f.fixedColumnsStart,j=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),G=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),q=this.getColumnsWidth(b,i.col-1)+G,z=this.getColumnsWidth(w,b-1)+(E?j:0)+q;this.backlight.setPosition(P,z),this.backlight.setSize(this.getColumnsWidth(b,S),l.hider.offsetHeight-P),this.backlight.setOffset(null,-q),addClass(this.hot.rootElement,CSS_ON_MOVING$1)}else removeClass(this.hot.rootElement,CSS_AFTER_SELECTION$1),f.pressed=!1,f.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=privatePool$6.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,s){var l=this.hot.getSelectedRangeLast(),u=privatePool$6.get(this);!l||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?removeClass(this.hot.rootElement,CSS_SHOW_UI$1):addClass(this.hot.rootElement,CSS_SHOW_UI$1),s.row=!0,s.column=!0,s.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=privatePool$6.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,removeClass(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1,CSS_AFTER_SELECTION$1]),this.hot.selection.isSelectedByColumnHeader()&&addClass(this.hot.rootElement,CSS_AFTER_SELECTION$1),!(a<1||i===void 0)){var s=o.columnsToMove[0],l=this.hot.toPhysicalColumn(s),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualColumn(l),f=c+a-1;this.hot.selectColumns(c,f)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,s=i+a;this.backlight.setPosition(s),this.backlight.setSize(null,o.hider.offsetHeight-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),_get$e(_getPrototypeOf$i(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$d}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$c}}]),r}(BasePlugin);function _typeof$v(e){return _typeof$v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$v(e)}function _classCallCheck$v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$v(n.key),n)}}function _createClass$v(e,t,r){return t&&_defineProperties$v(e.prototype,t),r&&_defineProperties$v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$v(e){var t=_toPrimitive$v(e,"string");return _typeof$v(t)==="symbol"?t:String(t)}function _toPrimitive$v(e,t){if(_typeof$v(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$d(){return typeof Reflect<"u"&&Reflect.get?_get$d=Reflect.get.bind():_get$d=function(t,r,n){var o=_superPropBase$d(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$d.apply(this,arguments)}function _superPropBase$d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$h(e),e!==null););return e}function _inherits$h(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$h(e,t)}function _setPrototypeOf$h(e,t){return _setPrototypeOf$h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$h(e,t)}function _createSuper$h(e){var t=_isNativeReflectConstruct$h();return function(){var n=_getPrototypeOf$h(e),o;if(t){var i=_getPrototypeOf$h(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$h(this,o)}}function _possibleConstructorReturn$h(e,t){if(t&&(_typeof$v(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$h(e)}function _assertThisInitialized$h(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$h(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$h(e){return _getPrototypeOf$h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$h(e)}var PLUGIN_KEY$c="manualColumnResize",PLUGIN_PRIORITY$b=130,PERSISTENT_STATE_KEY$1="manualColumnWidths",privatePool$5=new WeakMap,ManualColumnResize=function(e){_inherits$h(r,e);var t=_createSuper$h(r);function r(n){var o;_classCallCheck$v(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new EventManager$1(_assertThisInitialized$h(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,privatePool$5.set(_assertThisInitialized$h(o),{config:void 0}),addClass(o.handle,"manualColumnResizer"),addClass(o.guide,"manualColumnResizerGuide"),o}return _createClass$v(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[PLUGIN_KEY$c]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new PhysicalIndexToValueMap,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,s){return o.onBeforeColumnResize(i,a,s)}),this.bindEvents(),_get$d(_getPrototypeOf$h(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$d(_getPrototypeOf$h(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=privatePool$5.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),_get$d(_getPrototypeOf$h(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY$1,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY$1,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),s=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(s,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=privatePool$5.get(this),a=this.hot.getSettings()[PLUGIN_KEY$c],s=this.loadManualColumnWidths();typeof s<"u"?this.hot.batchExecution(function(){s.forEach(function(l,u){o.columnWidthsMap.setValueAtIndex(u,l)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(l,u){o.columnWidthsMap.setValueAtIndex(u,l)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(l,u){o.columnWidthsMap.setValueAtIndex(u,l)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,s=a.wtTable.getCoords(this.currentTH),l=s.col;if(!(l<0)){var u=outerHeight(this.currentTH),c=this.currentTH.getBoundingClientRect(),f=l<a.getSetting("fixedColumnsStart"),d;f&&(d=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),d||(d=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.selectedCols=[];var h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){var y=this.hot.getSelectedRange();arrayEach(y,function(p){var v=p.getTopStartCorner().col,b=p.getBottomEndCorner().col;rangeEach(v,b,function(S){i.selectedCols.includes(S)||i.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=d.start-6,this.startWidth=parseInt(c.width,10),this.handle.style.top="".concat(d.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(outerHeight(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);addClass(this.handle,"active"),addClass(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){removeClass(this.handle,"active"),removeClass(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!closest(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!isDetached(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,c){var f=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);f!==void 0&&(o.newSize=f),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),c&&i()};if(this.dblclick>=2){var s=this.selectedCols.length;s>1?(arrayEach(this.selectedCols,function(l){a(l)}),i()):arrayEach(this.selectedCols,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;hasClass(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,arrayEach(this.selectedCols,function(s){i.newSize=i.setManualSize(s,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,c){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),c&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var s=this.selectedCols.length;s>1?(arrayEach(this.selectedCols,function(l){a(l)}),i()):arrayEach(this.selectedCols,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,s=i.rootElement;this.eventManager.addEventListener(s,"mouseover",function(l){return o.onMouseOver(l)}),this.eventManager.addEventListener(s,"mousedown",function(l){return o.onMouseDown(l)}),this.eventManager.addEventListener(a,"mousemove",function(l){return o.onMouseMove(l)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var s=this.hot.toPhysicalColumn(i),l=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[PLUGIN_KEY$c]&&l&&(a=l)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){_get$d(_getPrototypeOf$h(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$c}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$b}}]),r}(BasePlugin);function _typeof$u(e){return _typeof$u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$u(e)}function _classCallCheck$u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$u(n.key),n)}}function _createClass$u(e,t,r){return t&&_defineProperties$u(e.prototype,t),r&&_defineProperties$u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$u(e){var t=_toPrimitive$u(e,"string");return _typeof$u(t)==="symbol"?t:String(t)}function _toPrimitive$u(e,t){if(_typeof$u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var STATE_INITIALIZED=0,STATE_BUILT=1,STATE_APPENDED=2,UNIT="px",BaseUI$2=function(){function e(t){_classCallCheck$u(this,e),this.hot=t,this._element=null,this.state=STATE_INITIALIZED}return _createClass$u(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=STATE_APPENDED}},{key:"build",value:function(){this.state===STATE_INITIALIZED&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED}},{key:"isAppended",value:function(){return this.state===STATE_APPENDED}},{key:"isBuilt",value:function(){return this.state>=STATE_BUILT}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+UNIT),n!==void 0&&(this._element.style.left=n+UNIT)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+UNIT),n&&(this._element.style.height=n+UNIT)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+UNIT),n&&(this._element.style.marginLeft=n+UNIT)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const BaseUI$3=BaseUI$2;function _typeof$t(e){return _typeof$t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$t(e)}function _classCallCheck$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$t(n.key),n)}}function _createClass$t(e,t,r){return t&&_defineProperties$t(e.prototype,t),r&&_defineProperties$t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$t(e){var t=_toPrimitive$t(e,"string");return _typeof$t(t)==="symbol"?t:String(t)}function _toPrimitive$t(e,t){if(_typeof$t(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$t(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$c(){return typeof Reflect<"u"&&Reflect.get?_get$c=Reflect.get.bind():_get$c=function(t,r,n){var o=_superPropBase$c(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$c.apply(this,arguments)}function _superPropBase$c(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$g(e),e!==null););return e}function _inherits$g(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$g(e,t)}function _setPrototypeOf$g(e,t){return _setPrototypeOf$g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$g(e,t)}function _createSuper$g(e){var t=_isNativeReflectConstruct$g();return function(){var n=_getPrototypeOf$g(e),o;if(t){var i=_getPrototypeOf$g(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$g(this,o)}}function _possibleConstructorReturn$g(e,t){if(t&&(_typeof$t(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$g(e)}function _assertThisInitialized$g(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$g(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$g(e){return _getPrototypeOf$g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$g(e)}var CSS_CLASSNAME$1="ht__manualRowMove--backlight",BacklightUI=function(e){_inherits$g(r,e);var t=_createSuper$g(r);function r(){return _classCallCheck$t(this,r),t.apply(this,arguments)}return _createClass$t(r,[{key:"build",value:function(){_get$c(_getPrototypeOf$g(r.prototype),"build",this).call(this),addClass(this._element,CSS_CLASSNAME$1)}}]),r}(BaseUI$3);const BacklightUI$1=BacklightUI;function _typeof$s(e){return _typeof$s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$s(e)}function _classCallCheck$s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$s(n.key),n)}}function _createClass$s(e,t,r){return t&&_defineProperties$s(e.prototype,t),r&&_defineProperties$s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$s(e){var t=_toPrimitive$s(e,"string");return _typeof$s(t)==="symbol"?t:String(t)}function _toPrimitive$s(e,t){if(_typeof$s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$b(){return typeof Reflect<"u"&&Reflect.get?_get$b=Reflect.get.bind():_get$b=function(t,r,n){var o=_superPropBase$b(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$b.apply(this,arguments)}function _superPropBase$b(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$f(e),e!==null););return e}function _inherits$f(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$f(e,t)}function _setPrototypeOf$f(e,t){return _setPrototypeOf$f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$f(e,t)}function _createSuper$f(e){var t=_isNativeReflectConstruct$f();return function(){var n=_getPrototypeOf$f(e),o;if(t){var i=_getPrototypeOf$f(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$f(this,o)}}function _possibleConstructorReturn$f(e,t){if(t&&(_typeof$s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$f(e)}function _assertThisInitialized$f(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$f(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$f(e){return _getPrototypeOf$f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$f(e)}var CSS_CLASSNAME="ht__manualRowMove--guideline",GuidelineUI=function(e){_inherits$f(r,e);var t=_createSuper$f(r);function r(){return _classCallCheck$s(this,r),t.apply(this,arguments)}return _createClass$s(r,[{key:"build",value:function(){_get$b(_getPrototypeOf$f(r.prototype),"build",this).call(this),addClass(this._element,CSS_CLASSNAME)}}]),r}(BaseUI$3);const GuidelineUI$1=GuidelineUI;function _typeof$r(e){return _typeof$r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$r(e)}function _classCallCheck$r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$r(n.key),n)}}function _createClass$r(e,t,r){return t&&_defineProperties$r(e.prototype,t),r&&_defineProperties$r(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$r(e){var t=_toPrimitive$r(e,"string");return _typeof$r(t)==="symbol"?t:String(t)}function _toPrimitive$r(e,t){if(_typeof$r(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$r(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$a(){return typeof Reflect<"u"&&Reflect.get?_get$a=Reflect.get.bind():_get$a=function(t,r,n){var o=_superPropBase$a(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$a.apply(this,arguments)}function _superPropBase$a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$e(e),e!==null););return e}function _inherits$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$e(e,t)}function _setPrototypeOf$e(e,t){return _setPrototypeOf$e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$e(e,t)}function _createSuper$e(e){var t=_isNativeReflectConstruct$e();return function(){var n=_getPrototypeOf$e(e),o;if(t){var i=_getPrototypeOf$e(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$e(this,o)}}function _possibleConstructorReturn$e(e,t){if(t&&(_typeof$r(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$e(e)}function _assertThisInitialized$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$e(e){return _getPrototypeOf$e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$e(e)}Hooks$1.getSingleton().register("beforeRowMove");Hooks$1.getSingleton().register("afterRowMove");var PLUGIN_KEY$b="manualRowMove",PLUGIN_PRIORITY$a=140,privatePool$4=new WeakMap,CSS_PLUGIN="ht__manualRowMove",CSS_SHOW_UI="show-ui",CSS_ON_MOVING="on-moving--rows",CSS_AFTER_SELECTION="after-selection--rows",ManualRowMove=function(e){_inherits$e(r,e);var t=_createSuper$e(r);function r(n){var o;return _classCallCheck$r(this,r),o=t.call(this,n),privatePool$4.set(_assertThisInitialized$e(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new EventManager$1(_assertThisInitialized$e(o)),o.backlight=new BacklightUI$1(n),o.guideline=new GuidelineUI$1(n),o}return _createClass$r(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$b]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),addClass(this.hot.rootElement,CSS_PLUGIN),_get$a(_getPrototypeOf$e(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),_get$a(_getPrototypeOf$e(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){removeClass(this.hot.rootElement,CSS_PLUGIN),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),_get$a(_getPrototypeOf$e(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=privatePool$4.get(this),s=a.cachedDropIndex,l=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,s,l);if(a.cachedDropIndex=void 0,u!==!1){l&&this.hot.rowIndexMapper.moveIndexes(o,i);var c=l&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,s,l,c),c}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),s=privatePool$4.get(this);return s.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=o.length+i>a,l=i<0,u=o.some(function(f){return f<0}),c=o.some(function(f){return f>=a});return!(s||l||u||c)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,s){return a-s!==i})}},{key:"countFinalIndex",value:function(o,i){var a=arrayReduce$1(o,function(s,l){return l<i&&(s+=1),s},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,s=0,l=o;l<=i;l++){var u=a.getRenderableFromVisualIndex(l);u!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return s}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[PLUGIN_KEY$b];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,s=o.to,l=Math.min(a.row,s.row),u=Math.max(a.row,s.row);return rangeEach(l,u,function(c){i.push(c)}),i}},{key:"refreshPositions",value:function(){var o=privatePool$4.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),s=this.hot.view.getLastFullyVisibleRow(),l=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&s<l&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,c=o.target.TD,f=offset(this.hot.rootElement),d=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),h=o.target.eventPageY-f.top+u.holder.scrollTop,y=u.hider.offsetHeight,p=u.TBODY.offsetTop,v=this.backlight.getOffset().top,b=this.backlight.getSize().height;this.isFixedRowTop(i.row)&&(d+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:c.offsetHeight/2+d<=h?(o.target.row=i.row+1,d+=i.row===0?c.offsetHeight-1:c.offsetHeight):o.target.row=i.row;var S=h,w=d;h+b+v>=y?S=y-b-v:h+v<p&&(S=p+Math.abs(v)),d>=y-1&&(w=y-1),this.backlight.setPosition(S),this.guideline.setPosition(w)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,s){var l=this.hot.view._wt,u=l.wtTable,c=l.wtViewport,f=this.hot.selection.isSelectedByRowHeader(),d=this.hot.getSelectedRangeLast(),h=privatePool$4.get(this);if(!d||!f||h.pressed||o.button!==0){h.pressed=!1,h.rowsToMove.length=0,removeClass(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI]);return}var y=this.guideline.isBuilt()&&!this.guideline.isAppended(),p=this.backlight.isBuilt()&&!this.backlight.isAppended();y&&p&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var v=d.from,b=d.to,S=Math.min(v.row,b.row),w=Math.max(v.row,b.row);if(i.col<0&&i.row>=S&&i.row<=w){s.row=!0,h.pressed=!0,h.target.eventPageY=o.pageY,h.target.coords=i,h.target.TD=a,h.rowsToMove=this.prepareRowsToMoving();var P=u.holder.scrollLeft+c.getRowHeaderWidth();this.backlight.setPosition(null,P),this.backlight.setSize(u.hider.offsetWidth-P,this.getRowsHeight(S,w)),this.backlight.setOffset((this.getRowsHeight(S,i.row-1)+o.offsetY)*-1,null),addClass(this.hot.rootElement,CSS_ON_MOVING),this.refreshPositions()}else removeClass(this.hot.rootElement,CSS_AFTER_SELECTION),h.pressed=!1,h.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=privatePool$4.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,s){var l=this.hot.getSelectedRangeLast(),u=privatePool$4.get(this);!l||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?removeClass(this.hot.rootElement,CSS_SHOW_UI):addClass(this.hot.rootElement,CSS_SHOW_UI),s.row=!0,s.column=!0,s.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=privatePool$4.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,removeClass(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI,CSS_AFTER_SELECTION]),this.hot.selection.isSelectedByRowHeader()&&addClass(this.hot.rootElement,CSS_AFTER_SELECTION),!(a<1||i===void 0)){var s=o.rowsToMove[0],l=this.hot.toPhysicalRow(s),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualRow(l),f=c+a-1;this.hot.selectRows(c,f)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,s=i+a;this.backlight.setPosition(null,s),this.backlight.setSize(o.hider.offsetWidth-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),_get$a(_getPrototypeOf$e(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$b}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$a}}]),r}(BasePlugin);function _typeof$q(e){return _typeof$q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$q(e)}function _classCallCheck$q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$q(n.key),n)}}function _createClass$q(e,t,r){return t&&_defineProperties$q(e.prototype,t),r&&_defineProperties$q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$q(e){var t=_toPrimitive$q(e,"string");return _typeof$q(t)==="symbol"?t:String(t)}function _toPrimitive$q(e,t){if(_typeof$q(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$q(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$9(){return typeof Reflect<"u"&&Reflect.get?_get$9=Reflect.get.bind():_get$9=function(t,r,n){var o=_superPropBase$9(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$9.apply(this,arguments)}function _superPropBase$9(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$d(e),e!==null););return e}function _inherits$d(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$d(e,t)}function _setPrototypeOf$d(e,t){return _setPrototypeOf$d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$d(e,t)}function _createSuper$d(e){var t=_isNativeReflectConstruct$d();return function(){var n=_getPrototypeOf$d(e),o;if(t){var i=_getPrototypeOf$d(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$d(this,o)}}function _possibleConstructorReturn$d(e,t){if(t&&(_typeof$q(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$d(e)}function _assertThisInitialized$d(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$d(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$d(e){return _getPrototypeOf$d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$d(e)}var PLUGIN_KEY$a="manualRowResize",PLUGIN_PRIORITY$9=30,PERSISTENT_STATE_KEY="manualRowHeights",privatePool$3=new WeakMap,ManualRowResize=function(e){_inherits$d(r,e);var t=_createSuper$d(r);function r(n){var o;_classCallCheck$q(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new EventManager$1(_assertThisInitialized$d(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,privatePool$3.set(_assertThisInitialized$d(o),{config:void 0}),addClass(o.handle,"manualRowResizer"),addClass(o.guide,"manualRowResizerGuide"),o}return _createClass$q(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[PLUGIN_KEY$a]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new PhysicalIndexToValueMap,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),_get$9(_getPrototypeOf$d(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$9(_getPrototypeOf$d(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=privatePool$3.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),_get$9(_getPrototypeOf$d(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),s=Math.max(i,ViewportRowsCalculator$1.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,s),s}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,s=a._wt,l=s.wtTable.getCoords(this.currentTH),u=l.row;if(!(u<0)){var c=outerWidth(this.currentTH),f=this.currentTH.getBoundingClientRect(),d=u<s.getSetting("fixedRowsTop"),h=u>=a.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom"),y;d?y=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col):h&&(y=s.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),y||(y=s.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var p=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&p){var v=this.hot.getSelectedRange();arrayEach(v,function(b){var S=b.getTopStartCorner().row,w=b.getBottomStartCorner().row;rangeEach(S,w,function(P){i.selectedRows.includes(P)||i.selectedRows.push(P)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=y.top-6,this.startHeight=parseInt(f.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(y.start,"px"),this.handle.style.width="".concat(c,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(outerWidth(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);addClass(this.handle,"active"),addClass(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){removeClass(this.handle,"active"),removeClass(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,s=closest(o,["TH"],this.hot.rootElement);return s&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!isDetached(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,c){var f=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);f!==void 0&&(o.newSize=f),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),c&&i()};if(this.dblclick>=2){var s=this.selectedRows.length;s>1?(arrayEach(this.selectedRows,function(l){a(l)}),i()):arrayEach(this.selectedRows,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;hasClass(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),arrayEach(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,c){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),c&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var s=this.selectedRows.length;s>1?(arrayEach(this.selectedRows,function(l){a(l)}),i()):arrayEach(this.selectedRows,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,s=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(l){return o.onMouseOver(l)}),this.eventManager.addEventListener(a,"mousedown",function(l){return o.onMouseDown(l)}),this.eventManager.addEventListener(s,"mousemove",function(l){return o.onMouseMove(l)}),this.eventManager.addEventListener(s,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var s=this.hot.toPhysicalRow(i),l=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[PLUGIN_KEY$a]&&l&&(a=l)}return a}},{key:"onMapInit",value:function(){var o=this,i=privatePool$3.get(this),a=this.hot.getSettings()[PLUGIN_KEY$a],s=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof s<"u"?s.forEach(function(l,u){o.rowHeightsMap.setValueAtIndex(u,l)}):Array.isArray(a)?(a.forEach(function(l,u){o.rowHeightsMap.setValueAtIndex(u,l)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(l,u){o.rowHeightsMap.setValueAtIndex(u,l)})},!0)}},{key:"destroy",value:function(){_get$9(_getPrototypeOf$d(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$a}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$9}}]),r}(BasePlugin);function _typeof$p(e){return _typeof$p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$p(e)}var _templateObject$6,_templateObject2$1,_templateObject3,_templateObject4;function _taggedTemplateLiteral$6(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$p(n.key),n)}}function _createClass$p(e,t,r){return t&&_defineProperties$p(e.prototype,t),r&&_defineProperties$p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$p(e){var t=_toPrimitive$p(e,"string");return _typeof$p(t)==="symbol"?t:String(t)}function _toPrimitive$p(e,t){if(_typeof$p(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$p(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MergedCellCoords=function(){function e(t,r,n,o,i,a){_classCallCheck$p(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return _createClass$p(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",s=r[0]?"col":"row",l=Math.min(n,i),u=Math.max(n,i),c=this[s],f=this[s]+this[a]-1;if(c>=n&&(this[s]+=o),o>0)n<=f&&n>c&&(this[a]+=o);else if(o<0){if(l<=c&&u>=f)return this.removed=!0,!1;if(c>=l&&c<=u){var d=u-c+1,h=Math.abs(o)-d;this[s]-=h+o,this[a]-=d}else if(c<=l&&f>=u)this[a]+=o;else if(c<=l&&f>=l&&f<u){var y=f-l+1;this[a]-=y}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return toSingleLine(_templateObject$6||(_templateObject$6=_taggedTemplateLiteral$6(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return toSingleLine(_templateObject2$1||(_templateObject2$1=_taggedTemplateLiteral$6(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return toSingleLine(_templateObject3||(_templateObject3=_taggedTemplateLiteral$6(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return toSingleLine(_templateObject4||(_templateObject4=_taggedTemplateLiteral$6(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const MergedCellCoords$1=MergedCellCoords;function applySpanProperties(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function _typeof$o(e){return _typeof$o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$o(e)}var _templateObject$5;function _taggedTemplateLiteral$5(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _toConsumableArray$9(e){return _arrayWithoutHoles$9(e)||_iterableToArray$a(e)||_unsupportedIterableToArray$c(e)||_nonIterableSpread$9()}function _nonIterableSpread$9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$c(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$c(e,t)}}function _iterableToArray$a(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$9(e){if(Array.isArray(e))return _arrayLikeToArray$c(e)}function _arrayLikeToArray$c(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$o(n.key),n)}}function _createClass$o(e,t,r){return t&&_defineProperties$o(e.prototype,t),r&&_defineProperties$o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$o(e){var t=_toPrimitive$o(e,"string");return _typeof$o(t)==="symbol"?t:String(t)}function _toPrimitive$o(e,t){if(_typeof$o(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$o(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MergedCellsCollection=function(){function e(t){_classCallCheck$o(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return _createClass$o(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return arrayEach(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return arrayEach(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],s=r;if(!s.includesRange){var l=this.hot._createCellCoords(s.from.row,s.from.col),u=this.hot._createCellCoords(s.to.row,s.to.col);s=this.hot._createCellRange(l,l,u)}return arrayEach(i,function(c){var f=n.hot._createCellCoords(c.row,c.col),d=n.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1),h=n.hot._createCellRange(f,f,d);o?s.overlaps(h)&&a.push(c):s.includesRange(h)&&a.push(c)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,s=r.colspan,l=new MergedCellCoords$1(o,i,a,s,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),c=this.isOverlapping(l);return!u&&!c?(this.hot&&l.normalize(this.hot),n.push(l),l):(warn(e.IS_OVERLAPPING_WARNING(l)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];arrayEach(n,function(a){var s=r.hot.getCell(a.row,a.col);s&&o.push([s,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,arrayEach(o,function(a,s){rangeEach(0,a.rowspan-1,function(l){rangeEach(0,a.colspan-1,function(u){if(u!==0||l!==0){var c=r.hot.getCell(a.row+l,a.col+u);c&&i.push([c,null,null,null])}})}),o[s][1]=null}),arrayEach(o,function(a){applySpanProperties.apply(void 0,_toConsumableArray$9(a))}),arrayEach(i,function(a){applySpanProperties.apply(void 0,_toConsumableArray$9(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return arrayEach(this.mergedCells,function(a){var s=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return s.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}arrayEach(this.mergedCells,function(s){s.shift(a,n)}),rangeEachReverse(this.mergedCells.length-1,0,function(s){var l=i.mergedCells[s];l&&l.removed&&i.mergedCells.splice(i.mergedCells.indexOf(l),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return toSingleLine(_templateObject$5||(_templateObject$5=_taggedTemplateLiteral$5(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const MergedCellsCollection$1=MergedCellsCollection;function _typeof$n(e){return _typeof$n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$n(e)}function _slicedToArray$3(e,t){return _arrayWithHoles$4(e)||_iterableToArrayLimit$3(e,t)||_unsupportedIterableToArray$b(e,t)||_nonIterableRest$4()}function _nonIterableRest$4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$b(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$b(e,t)}}function _arrayLikeToArray$b(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$3(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$4(e){if(Array.isArray(e))return e}function _classCallCheck$n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$n(n.key),n)}}function _createClass$n(e,t,r){return t&&_defineProperties$n(e.prototype,t),r&&_defineProperties$n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$n(e){var t=_toPrimitive$n(e,"string");return _typeof$n(t)==="symbol"?t:String(t)}function _toPrimitive$n(e,t){if(_typeof$n(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$n(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AutofillCalculations=function(){function e(t){_classCallCheck$n(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return _createClass$n(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),s=this.getAutofillSize(r,n,o),l=_slicedToArray$3(r,4),u=l[0],c=l[1],f=l[2],d=l[3],h=["up","down"].indexOf(o)>-1,y=h?f-u+1:d-c+1,p=Math.floor(s/y)*y,v=s-p,b=this.getFarthestCollection(r,n,o,i);if(b){if(o==="down"){var S=b.row+b.rowspan-u-v,w=a[2]+S;w>=this.plugin.hot.countRows()?a[2]-=v:a[2]+=v?S:0}else if(o==="right"){var P=b.col+b.colspan-c-v,E=a[3]+P;E>=this.plugin.hot.countCols()?a[3]-=v:a[3]+=v?P:0}else if(o==="up"){var j=f-v-b.row+1,G=a[0]+j;G<0?a[0]+=v:a[0]-=v?j:0}else if(o==="left"){var q=d-v-b.col+1,z=a[1]+q;z<0?a[1]+=v:a[1]-=v?q:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:s,dragArea:a,cycleLength:y}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),extend$1(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=_slicedToArray$3(r,4),a=i[0],s=i[1],l=i[2],u=i[3],c=_slicedToArray$3(n,4),f=c[0],d=c[1],h=c[2],y=c[3];switch(o){case"up":return a-f;case"down":return h-l;case"left":return s-d;case"right":return y-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=_slicedToArray$3(r,4),a=i[0],s=i[1],l=i[2],u=i[3],c=_slicedToArray$3(n,4),f=c[0],d=c[1],h=c[2],y=c[3];switch(o){case"up":return[f,d,a-1,u];case"down":return[l+1,s,h,u];case"left":return[f,d,l,s-1];case"right":return[a,u+1,h,y];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=_slicedToArray$3(r,4),s=a[0],l=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(o)>-1,d=f?u:c,h=f?s:l,y=this.getAutofillSize(r,n,o),p=f?u-s+1:c-l+1,v=Math.floor(y/p)*p,b=y-v,S=null,w=null,P=null;switch(o){case"up":S="includesVertically",P=d-b+1;break;case"left":S="includesHorizontally",P=d-b+1;break;case"down":S="includesVertically",P=h+b-1;break;case"right":S="includesHorizontally",P=h+b-1;break}return arrayEach(i,function(E){E[S](P)&&E.isFarther(w,o)&&(w=E)}),w}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(d,h){switch(i){case"up":return d.row-h>=n.from.row;case"down":return d.row+d.rowspan-1+h<=n.to.row;case"left":return d.col-h>=n.from.column;case"right":return d.col+d.colspan-1+h<=n.to.column;default:return null}},s=0,l=null,u=1;do for(var c=0;c<o.length;c+=1){if(l=o[c],s=u*this.currentFillData.cycleLength,a(l,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}c===o.length-1&&(u+=1)}while(a(l,s));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return arrayEach(r,function(a){var s=a[0],l=n.plugin.hot.propToCol(a[1]);(o.min===null||s<o.min)&&(o.min=s),(o.max===null||s>o.max)&&(o.max=s),(i.min===null||l<i.min)&&(i.min=l),(i.max===null||l>i.max)&&(i.max=l)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=_slicedToArray$3(i,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.plugin.hot._createCellCoords(s,l),d=this.plugin.hot._createCellCoords(u,c),h=this.plugin.hot._createCellRange(f,f,d);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}]),e}();const AutofillCalculations$1=AutofillCalculations;function _typeof$m(e){return _typeof$m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$m(e)}function _classCallCheck$m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$m(n.key),n)}}function _createClass$m(e,t,r){return t&&_defineProperties$m(e.prototype,t),r&&_defineProperties$m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$m(e){var t=_toPrimitive$m(e,"string");return _typeof$m(t)==="symbol"?t:String(t)}function _toPrimitive$m(e,t){if(_typeof$m(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$m(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SelectionCalculations=function(){function e(t){_classCallCheck$m(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return _createClass$m(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,s=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,s)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,s=null,l=null;r.row?(a=n.includesVertically(o),s=n.row,l=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),s=n.col,l=n.getLastColumn()),i!==0&&(i>0?a&&o!==s&&(i+=l-o+1):a&&o!==l&&(i-=o-s+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),s=Math.min(o[1],o[3]),l=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var c=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(c){var f=this.plugin.mergedCellsCollection.get(r,n);if(f){var d=f.getLastRow(),h=f.getLastColumn(),y=a<=f.row&&s<=f.col&&l>=d&&u>=h;if(y)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(f,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var s=0;s<o.length;s+=1){for(var l=[],u=0;u<n.length;u+=1)l[u]=n[u].includes(o[s]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const SelectionCalculations$1=SelectionCalculations;function toggleMergeItem(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=MergedCellCoords$1.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function _typeof$l(e){return _typeof$l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$l(e)}function _slicedToArray$2(e,t){return _arrayWithHoles$3(e)||_iterableToArrayLimit$2(e,t)||_unsupportedIterableToArray$a(e,t)||_nonIterableRest$3()}function _nonIterableRest$3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit$2(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$3(e){if(Array.isArray(e))return e}function _toConsumableArray$8(e){return _arrayWithoutHoles$8(e)||_iterableToArray$9(e)||_unsupportedIterableToArray$a(e)||_nonIterableSpread$8()}function _nonIterableSpread$8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$a(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$a(e,t)}}function _iterableToArray$9(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$8(e){if(Array.isArray(e))return _arrayLikeToArray$a(e)}function _arrayLikeToArray$a(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$l(n.key),n)}}function _createClass$l(e,t,r){return t&&_defineProperties$l(e.prototype,t),r&&_defineProperties$l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$l(e){var t=_toPrimitive$l(e,"string");return _typeof$l(t)==="symbol"?t:String(t)}function _toPrimitive$l(e,t){if(_typeof$l(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$l(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$8(){return typeof Reflect<"u"&&Reflect.get?_get$8=Reflect.get.bind():_get$8=function(t,r,n){var o=_superPropBase$8(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$8.apply(this,arguments)}function _superPropBase$8(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$c(e),e!==null););return e}function _inherits$c(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$c(e,t)}function _setPrototypeOf$c(e,t){return _setPrototypeOf$c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$c(e,t)}function _createSuper$c(e){var t=_isNativeReflectConstruct$c();return function(){var n=_getPrototypeOf$c(e),o;if(t){var i=_getPrototypeOf$c(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$c(this,o)}}function _possibleConstructorReturn$c(e,t){if(t&&(_typeof$l(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$c(e)}function _assertThisInitialized$c(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$c(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$c(e){return _getPrototypeOf$c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$c(e)}Hooks$1.getSingleton().register("beforeMergeCells");Hooks$1.getSingleton().register("afterMergeCells");Hooks$1.getSingleton().register("beforeUnmergeCells");Hooks$1.getSingleton().register("afterUnmergeCells");var PLUGIN_KEY$9="mergeCells",PLUGIN_PRIORITY$8=150,privatePool$2=new WeakMap,SHORTCUTS_GROUP$1=PLUGIN_KEY$9,MergeCells=function(e){_inherits$c(r,e);var t=_createSuper$c(r);function r(n){var o;return _classCallCheck$l(this,r),o=t.call(this,n),privatePool$2.set(_assertThisInitialized$c(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return _createClass$l(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$9]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new MergedCellsCollection$1(this),this.autofillCalculations=new AutofillCalculations$1(this),this.selectionCalculations=new SelectionCalculations$1(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),_get$8(_getPrototypeOf$c(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),_get$8(_getPrototypeOf$c(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[PLUGIN_KEY$9];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),_get$8(_getPrototypeOf$c(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var o=this;if(isChrome()){var i=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(s){for(var l=s.row,u=s.rowspan,c=l+1;c<l+u;c++)a.push(c)}),a=_toConsumableArray$8(new Set(a)),a.forEach(function(s){var l=o.hot.rowIndexMapper.getRenderableFromVisualIndex(s);o.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var c=u.getRow(l);c&&(c.style.background=getStyle(c,"backgroundColor").replace(")",", 0.99)"),i.push(c))})}),this.hot._registerTimeout(function(){i.forEach(function(s){s.style.background=getStyle(s,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(o){var i=!0;return o?(MergedCellCoords$1.containsNegativeValues(o)?(warn(MergedCellCoords$1.NEGATIVE_VALUES_WARNING(o)),i=!1):MergedCellCoords$1.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(warn(MergedCellCoords$1.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):MergedCellCoords$1.isSingleCell(o)?(warn(MergedCellCoords$1.IS_SINGLE_CELL(o)),i=!1):MergedCellCoords$1.containsZeroSpan(o)&&(warn(MergedCellCoords$1.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a=[];if(arrayEach(o,function(s){if(i.validateSetting(s)){var l=i.hot._createCellCoords(s.row,s.col),u=i.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),c=i.hot._createCellRange(l,l,u);i.mergeRange(c,!0,!0),rangeEach(s.row,s.row+s.rowspan-1,function(f){rangeEach(s.col,s.col+s.colspan-1,function(d){f===s.row&&d===s.col||a.push([f,d,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=o.getTopStartCorner(),u=o.getBottomEndCorner(),c={row:l.row,col:l.col,rowspan:u.row-l.row+1,colspan:u.col-l.col+1},f=[],d=null;if(!this.canMergeRange(c,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),rangeEach(0,c.rowspan-1,function(y){rangeEach(0,c.colspan-1,function(p){var v=null;f[y]||(f[y]=[]),y===0&&p===0?v=i.hot.getSourceDataAtCell(i.hot.toPhysicalRow(c.row),i.hot.toPhysicalColumn(c.col)):i.hot.setCellMeta(c.row+y,c.col+p,"hidden",!0),f[y][p]=v})}),this.hot.setCellMeta(c.row,c.col,"spanned",!0);var h=this.mergedCellsCollection.add(c);return h?(s?d=[c.row,c.col,f]:this.hot.populateFromArray(c.row,c.col,f,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",o,c,a),d):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.mergedCellsCollection.getWithinRange(o);s&&(this.hot.runHooks("beforeUnmergeCells",o,a),arrayEach(s,function(l){i.mergedCellsCollection.remove(l.row,l.col),rangeEach(0,l.rowspan-1,function(u){rangeEach(0,l.colspan-1,function(c){i.hot.removeCellMeta(l.row+u,l.col+c,"hidden")})}),i.hot.removeCellMeta(l.row,l.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,s){var l=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,s);this.mergeRange(this.hot._createCellRange(l,l,u))}},{key:"unmerge",value:function(o,i,a,s){var l=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,s);this.unmergeRange(this.hot._createCellRange(l,l,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[PLUGIN_KEY$9]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(l){return!l.altKey},group:SHORTCUTS_GROUP$1})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(SHORTCUTS_GROUP$1)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),s=0;s<i.length;s+=1)if(a.from.row===i[s].row&&a.from.col===i[s].col&&a.to.row===i[s].row+i[s].rowspan-1&&a.to.col===i[s].col+i[s].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=privatePool$2.get(this),a=this.hot.getSelectedRangeLast(),s={row:o.row,col:o.col},l=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),c=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),c){var f=this.hot._createCellCoords(c.row,c.col),d=this.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1),h=this.hot._createCellRange(f,f,d);h.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),s.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:s.row,s.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:s.col,o.row>0?s.row=c.row+c.rowspan-1-u.row+o.row:o.row<0&&(s.row=u.row-c.row+o.row),o.col>0?s.col=c.col+c.colspan-1-u.col+o.col:o.col<0&&(s.col=u.col-c.col+o.col)}l=this.hot._createCellCoords(a.highlight.row+s.row,a.highlight.col+s.col);var y=this.mergedCellsCollection.get(l.row,l.col);if(y){var p=this.mergedCellsCollection.getFirstRenderableCoords(y.row,y.col);i.lastDesiredCoords=l,s={row:p.row-u.row,col:p.col-u.col}}s.row!==0&&(o.row=s.row),s.col!==0&&(o.col=s.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),s=clone$3(o),l=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=clone$3(s),c=this.mergedCellsCollection.getWithinRange(l,!0);do u=clone$3(s),this.selectionCalculations.getUpdatedSelectionRange(a,s),arrayEach(c,function(f){i.selectionCalculations.snapDelta(s,a,f)});while(s.row!==u.row||s.col!==u.col);o.row=s.row,o.col=s.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var s=a.row,l=a.col,u=a.colspan,c=a.rowspan;return[s,l,s+c-1,l+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},toggleMergeItem(this))}},{key:"onAfterRenderer",value:function(o,i,a){var s=this.mergedCellsCollection.get(i,a),l=isObject$6(s)?clone$3(s):void 0;if(isObject$6(l)){var u=this.hot,c=u.rowIndexMapper,f=u.columnIndexMapper,d=l.row,h=l.col,y=l.colspan,p=l.rowspan,v=this.translateMergedCellToRenderable(d,p,h,y),b=_slicedToArray$2(v,2),S=b[0],w=b[1],P=c.getRenderableFromVisualIndex(i),E=f.getRenderableFromVisualIndex(a),j=S-P+1,G=w-E+1;l.row=c.getNearestNotHiddenIndex(l.row,1),l.col=f.getNearestNotHiddenIndex(l.col,1),l.rowspan=Math.min(l.rowspan,j),l.colspan=Math.min(l.colspan,G)}applySpanProperties(o,l,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){var l=this.mergedCellsCollection.mergedCells[s],u=l.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var s=this.mergedCellsCollection.get(o,i);s&&(s.row!==o||s.col!==i?a.copyable=!1:(a.rowspan=s.rowspan,a.colspan=s.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(o.startRow),l=0;l<i;l+=1){var u=this.mergedCellsCollection.get(s,l);if(isObject$6(u)){var c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(c<o.startRow){o.startRow=c,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(o.endRow),l=0;l<i;l+=1){var u=this.mergedCellsCollection.get(s,l);if(isObject$6(u)){var c=u.row+u.rowspan-1,f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,-1));if(f>o.endRow){o.endRow=f,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(o.startColumn),l=0;l<i;l+=1){var u=this.mergedCellsCollection.get(l,s);if(isObject$6(u)){var c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(c<o.startColumn){o.startColumn=c,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(o.endColumn),l=0;l<i;l+=1){var u=this.mergedCellsCollection.get(l,s);if(isObject$6(u)){var c=u.col+u.colspan-1,f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,-1));if(f>o.endColumn){o.endColumn=f,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,s){var l=this.hot,u=l.rowIndexMapper,c=l.columnIndexMapper,f,d;i===0?f=u.getNearestNotHiddenIndex(o,1):f=u.getNearestNotHiddenIndex(o+i-1,-1),s===0?d=c.getNearestNotHiddenIndex(a,1):d=c.getNearestNotHiddenIndex(a+s-1,-1);var h=o>=0?u.getRenderableFromVisualIndex(f):o,y=a>=0?c.getRenderableFromVisualIndex(d):a;return[h,y]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),s=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,s,a))return s=i,s;var l=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return l&&(s=this.autofillCalculations.snapDragArea(i,s,a,l)),s}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(a);arrayEach(s,function(l){a.getBottomEndCorner().row===l.getLastRow()&&a.getBottomEndCorner().col===l.getLastColumn()&&(o[2]=l.row,o[3]=l.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var s=this.mergedCellsCollection.get(o.row,o.col);if(s){var l=i>0,u=i<0,c=a<0,f=a>0,d=s.row+s.rowspan-1===this.hot.countRows()-1,h=s.row===0,y=s.col+s.colspan-1===this.hot.countCols()-1,p=s.col===0;(l&&d||u&&h||f&&y||c&&p)&&(o.row=s.row,o.col=s.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,s){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,s)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$9}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$8}}]),r}(BasePlugin);function _toArray(e){return _arrayWithHoles$2(e)||_iterableToArray$8(e)||_unsupportedIterableToArray$9(e)||_nonIterableRest$2()}function _nonIterableRest$2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$9(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$9(e,t)}}function _arrayLikeToArray$9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArray$8(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithHoles$2(e){if(Array.isArray(e))return e}function rootComparator(e,t){return function(r,n){var o=_toArray(r),i=o.slice(1),a=_toArray(n),s=a.slice(1);return function l(u){var c=e[u],f=t[u],d=i[u],h=s[u],y=f.multiColumnSorting,p=y.compareFunctionFactory?y.compareFunctionFactory:getCompareFunctionFactory(f.type),v=p(c,f,y)(d,h);if(v===DO_NOT_SWAP){var b=u+1;if(typeof t[b]<"u")return l(b)}return v}(0)}}var _templateObject$4;function _taggedTemplateLiteral$4(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function warnAboutPluginsConflict(){warn(toSingleLine(_templateObject$4||(_templateObject$4=_taggedTemplateLiteral$4(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var COLUMN_ORDER_PREFIX="sort";function getClassesToAdd(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(COLUMN_ORDER_PREFIX,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function getClassesToRemove(e){var t=e.className.split(" "),r=new RegExp("^".concat(COLUMN_ORDER_PREFIX,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function _typeof$k(e){return _typeof$k=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$k(e)}function _classCallCheck$k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$k(n.key),n)}}function _createClass$k(e,t,r){return t&&_defineProperties$k(e.prototype,t),r&&_defineProperties$k(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$k(e){var t=_toPrimitive$k(e,"string");return _typeof$k(t)==="symbol"?t:String(t)}function _toPrimitive$k(e,t){if(_typeof$k(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$k(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$7(){return typeof Reflect<"u"&&Reflect.get?_get$7=Reflect.get.bind():_get$7=function(t,r,n){var o=_superPropBase$7(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$7.apply(this,arguments)}function _superPropBase$7(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$b(e),e!==null););return e}function _inherits$b(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$b(e,t)}function _setPrototypeOf$b(e,t){return _setPrototypeOf$b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$b(e,t)}function _createSuper$b(e){var t=_isNativeReflectConstruct$b();return function(){var n=_getPrototypeOf$b(e),o;if(t){var i=_getPrototypeOf$b(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$b(this,o)}}function _possibleConstructorReturn$b(e,t){if(t&&(_typeof$k(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$b(e)}function _assertThisInitialized$b(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$b(e){return _getPrototypeOf$b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$b(e)}var PLUGIN_KEY$8="multiColumnSorting",PLUGIN_PRIORITY$7=170,APPEND_COLUMN_CONFIG_STRATEGY="append",CONFLICTED_PLUGIN_KEY="columnSorting";registerRootComparator(PLUGIN_KEY$8,rootComparator);var MultiColumnSorting=function(e){_inherits$b(r,e);var t=_createSuper$b(r);function r(n){var o;return _classCallCheck$k(this,r),o=t.call(this,n),o.pluginKey=PLUGIN_KEY$8,o}return _createClass$k(r,[{key:"isEnabled",value:function(){return _get$7(_getPrototypeOf$b(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&warnAboutPluginsConflict(),_get$7(_getPrototypeOf$b(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){_get$7(_getPrototypeOf$b(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){_get$7(_getPrototypeOf$b(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){_get$7(_getPrototypeOf$b(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return _get$7(_getPrototypeOf$b(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return _get$7(_getPrototypeOf$b(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){_get$7(_getPrototypeOf$b(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(i=_get$7(_getPrototypeOf$b(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(s)),removeClass(o,getClassesToRemove(o)),this.enabled!==!1&&addClass(o,getClassesToAdd.apply(void 0,s))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&warnAboutPluginsConflict(),_get$7(_getPrototypeOf$b(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){wasHeaderClickedProperly(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,APPEND_COLUMN_CONFIG_STRATEGY))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$8}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$7}}]),r}(ColumnSorting);function _typeof$j(e){return _typeof$j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$j(e)}function _classCallCheck$j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$j(n.key),n)}}function _createClass$j(e,t,r){return t&&_defineProperties$j(e.prototype,t),r&&_defineProperties$j(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$j(e){var t=_toPrimitive$j(e,"string");return _typeof$j(t)==="symbol"?t:String(t)}function _toPrimitive$j(e,t){if(_typeof$j(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$j(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$6(){return typeof Reflect<"u"&&Reflect.get?_get$6=Reflect.get.bind():_get$6=function(t,r,n){var o=_superPropBase$6(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$6.apply(this,arguments)}function _superPropBase$6(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$a(e),e!==null););return e}function _inherits$a(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$a(e,t)}function _setPrototypeOf$a(e,t){return _setPrototypeOf$a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$a(e,t)}function _createSuper$a(e){var t=_isNativeReflectConstruct$a();return function(){var n=_getPrototypeOf$a(e),o;if(t){var i=_getPrototypeOf$a(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$a(this,o)}}function _possibleConstructorReturn$a(e,t){if(t&&(_typeof$j(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$a(e)}function _assertThisInitialized$a(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$a(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$a(e){return _getPrototypeOf$a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$a(e)}var PLUGIN_KEY$7="multipleSelectionHandles",PLUGIN_PRIORITY$6=160,MultipleSelectionHandles=function(e){_inherits$a(r,e);var t=_createSuper$a(r);function r(n){var o;return _classCallCheck$j(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return _createClass$j(r,[{key:"isEnabled",value:function(){return isMobileBrowser()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new EventManager$1(this)),this.registerListeners(),_get$6(_getPrototypeOf$a(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function s(l){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(l);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(l){var u;if(hasClass(l.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1;if(hasClass(l.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(l){if(hasClass(l.target,"topSelectionHandle-HitArea"))return s.call(i,"top"),i.touchStartRange=void 0,l.preventDefault(),!1;if(hasClass(l.target,"bottomSelectionHandle-HitArea"))return s.call(i,"bottom"),i.touchStartRange=void 0,l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(l){var u=o.hot.rootDocument,c,f,d,h,y,p;if(i.dragged.length!==0){var v=u.elementFromPoint(l.touches[0].clientX,l.touches[0].clientY);!v||v===i.lastSetCell||((v.nodeName==="TD"||v.nodeName==="TH")&&(c=i.hot.getCoords(v),c.col===-1&&(c.col=0),f=i.hot.getSelectedRangeLast(),d=f.getWidth(),h=f.getHeight(),y=f.getDirection(),d===1&&h===1&&i.hot.selection.setRangeEnd(c),p=i.getCurrentRangeCoords(f,c,i.touchStartRange.direction,y,i.dragged[0]),p.start!==null&&i.hot.selection.setRangeStart(p.start),i.hot.selection.setRangeEnd(p.end),i.lastSetCell=v),l.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,s,l){var u=o.getTopStartCorner(),c=o.getBottomEndCorner(),f=o.getBottomStartCorner(),d=o.getTopEndCorner(),h={start:null,end:null};switch(a){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":l==="top"?h={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(f.row,i.col)}:h={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":l==="bottom"&&(h={start:this.hot._createCellCoords(c.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(s){case"NE-SW":l==="top"?h={start:i,end:f}:h.end=i;break;case"NW-SE":l==="top"?h={start:i,end:c}:h.end=i;break;case"SE-NW":l==="top"?h={start:i,end:u}:h.end=i;break;case"SW-NE":l==="top"?h={start:i,end:d}:h.end=i;break}break;case"SW-NE":switch(s){case"NW-SE":l==="bottom"?h={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(f.row,i.col)}:h={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,c.col)};break;case"SW-NE":l==="top"?h={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,c.col)}:h={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":l==="bottom"?h={start:this.hot._createCellCoords(i.row,d.col),end:this.hot._createCellCoords(u.row,i.col)}:l==="top"&&(h={start:f,end:i});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":l==="top"&&(h.end=i);break;case"SE-NW":l==="top"?h.end=i:h={start:i,end:u};break}break}return h}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$7}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$6}}]),r}(BasePlugin);function createDefaultHeaderSettings(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,s=e.collapsible,l=s===void 0?!1:s,u=e.crossHiddenColumns,c=u===void 0?[]:u,f=e.isCollapsed,d=f===void 0?!1:f,h=e.isHidden,y=h===void 0?!1:h,p=e.isRoot,v=p===void 0?!1:p,b=e.isPlaceholder,S=b===void 0?!1:b;return{label:r,colspan:o,origColspan:a,collapsible:l,isCollapsed:d,crossHiddenColumns:c,isHidden:y,isRoot:v,isPlaceholder:S}}function createPlaceholderHeaderSettings(){return{label:"",isPlaceholder:!0}}function _toConsumableArray$7(e){return _arrayWithoutHoles$7(e)||_iterableToArray$7(e)||_unsupportedIterableToArray$8(e)||_nonIterableSpread$7()}function _nonIterableSpread$7(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$8(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$8(e,t)}}function _iterableToArray$7(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$7(e){if(Array.isArray(e))return _arrayLikeToArray$8(e)}function _arrayLikeToArray$8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function normalizeSettings(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;arrayEach(e,function(o){var i=[],a=0;r.push(i),arrayEach(o,function(s){var l=createDefaultHeaderSettings();if(isObject$6(s)){var u=s.label,c=s.colspan;l.label=stringify$1(u),typeof c=="number"&&c>1&&(l.colspan=c,l.origColspan=c)}else l.label=stringify$1(s);a+=l.origColspan;var f=!1;if(a>=t&&(l.colspan=l.origColspan-(a-t),l.origColspan=l.colspan,f=!0),i.push(l),l.colspan>1)for(var d=0;d<l.colspan-1;d++)i.push(createPlaceholderHeaderSettings());return!f})});var n=Math.max.apply(Math,_toConsumableArray$7(arrayMap(r,function(o){return o.length})));return arrayEach(r,function(o){if(o.length<n){var i=arrayMap(new Array(n-o.length),function(){return createDefaultHeaderSettings()});o.splice.apply(o,[o.length,0].concat(_toConsumableArray$7(i)))}}),r}function _typeof$i(e){return _typeof$i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$i(e)}var _excluded$2=["row","col"];function ownKeys$3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$3(Object(r),!0).forEach(function(n){_defineProperty$5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$5(e,t,r){return t=_toPropertyKey$i(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$2(e,t){if(e==null)return{};var r=_objectWithoutPropertiesLoose$2(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _objectWithoutPropertiesLoose$2(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function _classCallCheck$i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$i(n.key),n)}}function _createClass$i(e,t,r){return t&&_defineProperties$i(e.prototype,t),r&&_defineProperties$i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$i(e){var t=_toPrimitive$i(e,"string");return _typeof$i(t)==="symbol"?t:String(t)}function _toPrimitive$i(e,t){if(_typeof$i(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$i(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldInitSpec$3(e,t,r){_checkPrivateRedeclaration$3(e,t),t.set(e,r)}function _checkPrivateRedeclaration$3(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$3(e,t){var r=_classExtractFieldDescriptor$3(e,t,"get");return _classApplyDescriptorGet$3(e,r)}function _classApplyDescriptorGet$3(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet$3(e,t,r){var n=_classExtractFieldDescriptor$3(e,t,"set");return _classApplyDescriptorSet$3(e,n,r),r}function _classExtractFieldDescriptor$3(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet$3(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var HEADER_CONFIGURABLE_PROPS=["label","collapsible"],_data=new WeakMap,_dataLength=new WeakMap,_columnsLimit=new WeakMap,SourceSettings=function(){function e(){_classCallCheck$i(this,e),_classPrivateFieldInitSpec$3(this,_data,{writable:!0,value:[]}),_classPrivateFieldInitSpec$3(this,_dataLength,{writable:!0,value:0}),_classPrivateFieldInitSpec$3(this,_columnsLimit,{writable:!0,value:1/0})}return _createClass$i(e,[{key:"setColumnsLimit",value:function(r){_classPrivateFieldSet$3(this,_columnsLimit,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_classPrivateFieldSet$3(this,_data,normalizeSettings(r,_classPrivateFieldGet$3(this,_columnsLimit))),_classPrivateFieldSet$3(this,_dataLength,_classPrivateFieldGet$3(this,_data).length)}},{key:"getData",value:function(){return _classPrivateFieldGet$3(this,_data)}},{key:"mergeWith",value:function(r){var n=this;arrayEach(r,function(o){var i=o.row,a=o.col,s=_objectWithoutProperties$2(o,_excluded$2),l=n.getHeaderSettings(i,a);l!==null&&extend$1(l,s,HEADER_CONFIGURABLE_PROPS)})}},{key:"map",value:function(r){arrayEach(_classPrivateFieldGet$3(this,_data),function(n){arrayEach(n,function(o){var i=r(_objectSpread$3({},o));isObject$6(i)&&extend$1(o,i,HEADER_CONFIGURABLE_PROPS)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=_classPrivateFieldGet$3(this,_dataLength)||r<0)return null;var i=_classPrivateFieldGet$3(this,_data)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=_classPrivateFieldGet$3(this,_dataLength)||r<0)return i;for(var a=_classPrivateFieldGet$3(this,_data)[r],s=0,l=n;l<a.length;l++){var u=a[l];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=u.colspan,i.push(u),u.colspan>1&&(l+=u.colspan-1),s===o)break;if(s>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return _classPrivateFieldGet$3(this,_dataLength)}},{key:"getColumnsCount",value:function(){return _classPrivateFieldGet$3(this,_dataLength)>0?_classPrivateFieldGet$3(this,_data)[0].length:0}},{key:"clear",value:function(){_classPrivateFieldSet$3(this,_data,[]),_classPrivateFieldSet$3(this,_dataLength,0)}}]),e}();function _typeof$h(e){return _typeof$h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$h(e)}function ownKeys$2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$2(Object(r),!0).forEach(function(n){_defineProperty$4(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _classCallCheck$h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$h(n.key),n)}}function _createClass$h(e,t,r){return t&&_defineProperties$h(e.prototype,t),r&&_defineProperties$h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$4(e,t,r){return t=_toPropertyKey$h(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$h(e){var t=_toPrimitive$h(e,"string");return _typeof$h(t)==="symbol"?t:String(t)}function _toPrimitive$h(e,t){if(_typeof$h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _toConsumableArray$6(e){return _arrayWithoutHoles$6(e)||_iterableToArray$6(e)||_unsupportedIterableToArray$7(e)||_nonIterableSpread$6()}function _nonIterableSpread$6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$7(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$7(e,t)}}function _iterableToArray$6(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$6(e){if(Array.isArray(e))return _arrayLikeToArray$7(e)}function _arrayLikeToArray$7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var TRAVERSAL_DF_PRE="DF-pre-order";function depthFirstPreOrder(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=depthFirstPreOrder.call(this.childs[n],e,t)}return r}var TRAVERSAL_DF_POST="DF-post-order";function depthFirstPostOrder(e,t){for(var r=0;r<this.childs.length;r++){var n=depthFirstPostOrder.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var TRAVERSAL_BF="BF";function breadthFirst(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,_toConsumableArray$6(o.childs)),e.call(t,o)!==!1&&n()}}n()}var DEFAULT_TRAVERSAL_STRATEGY=TRAVERSAL_BF,TRAVERSAL_STRATEGIES=new Map([[TRAVERSAL_DF_PRE,depthFirstPreOrder],[TRAVERSAL_DF_POST,depthFirstPostOrder],[TRAVERSAL_BF,breadthFirst]]),TreeNode=function(){function e(t){_classCallCheck$h(this,e),_defineProperty$4(this,"data",{}),_defineProperty$4(this,"parent",null),_defineProperty$4(this,"childs",[]),this.data=t}return _createClass$h(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(_objectSpread$2({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=_objectSpread$2({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_TRAVERSAL_STRATEGY;if(!TRAVERSAL_STRATEGIES.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));TRAVERSAL_STRATEGIES.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var s=r.call(n,a);s!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function _typeof$g(e){return _typeof$g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$g(e)}function ownKeys$1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread$1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$1(Object(r),!0).forEach(function(n){_defineProperty$3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$3(e,t,r){return t=_toPropertyKey$g(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray$1(e,t){return _arrayWithHoles$1(e)||_iterableToArrayLimit$1(e,t)||_unsupportedIterableToArray$6(e,t)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$6(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$6(e,t)}}function _arrayLikeToArray$6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$1(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles$1(e){if(Array.isArray(e))return e}function _classCallCheck$g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$g(n.key),n)}}function _createClass$g(e,t,r){return t&&_defineProperties$g(e.prototype,t),r&&_defineProperties$g(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$g(e){var t=_toPrimitive$g(e,"string");return _typeof$g(t)==="symbol"?t:String(t)}function _toPrimitive$g(e,t){if(_typeof$g(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$g(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldInitSpec$2(e,t,r){_checkPrivateRedeclaration$2(e,t),t.set(e,r)}function _checkPrivateRedeclaration$2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$2(e,t){var r=_classExtractFieldDescriptor$2(e,t,"get");return _classApplyDescriptorGet$2(e,r)}function _classApplyDescriptorGet$2(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet$2(e,t,r){var n=_classExtractFieldDescriptor$2(e,t,"set");return _classApplyDescriptorSet$2(e,n,r),r}function _classExtractFieldDescriptor$2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet$2(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var _rootNodes=new WeakMap,_rootsIndex=new WeakMap,_sourceSettings$1=new WeakMap,HeadersTree=function(){function e(t){_classCallCheck$g(this,e),_classPrivateFieldInitSpec$2(this,_rootNodes,{writable:!0,value:new Map}),_classPrivateFieldInitSpec$2(this,_rootsIndex,{writable:!0,value:new Map}),_classPrivateFieldInitSpec$2(this,_sourceSettings$1,{writable:!0,value:null}),_classPrivateFieldSet$2(this,_sourceSettings$1,t)}return _createClass$g(e,[{key:"getRoots",value:function(){return Array.from(_classPrivateFieldGet$2(this,_rootNodes).values())}},{key:"getRootByColumn",value:function(r){var n;return _classPrivateFieldGet$2(this,_rootsIndex).has(r)&&(n=_classPrivateFieldGet$2(this,_rootNodes).get(_classPrivateFieldGet$2(this,_rootsIndex).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-_classPrivateFieldGet$2(this,_rootsIndex).get(n),a=0,s;return o.walkDown(function(l){var u=l.data,c=u.origColspan,f=u.headerLevel;if(r===f){if(i>=a&&i<=a+c-1)return s=l,s.data.isRoot=n===s.data.columnIndex,!1;a+=c}}),s}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;_classPrivateFieldGet$2(this,_rootsIndex).clear(),arrayEach(_classPrivateFieldGet$2(this,_rootNodes),function(o){for(var i=_slicedToArray$1(o,2),a=i[1].data.colspan,s=n;s<n+a;s++)_classPrivateFieldGet$2(r,_rootsIndex).set(s,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=_classPrivateFieldGet$2(this,_sourceSettings$1).getColumnsCount(),n=0;n<r;){var o=_classPrivateFieldGet$2(this,_sourceSettings$1).getHeaderSettings(0,n),i=new TreeNode;_classPrivateFieldGet$2(this,_rootNodes).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=_classPrivateFieldGet$2(this,_sourceSettings$1).getHeadersSettings(o,n,a);o+=1,arrayEach(s,function(l){var u=_objectSpread$1(_objectSpread$1({},l),{},{headerLevel:o-1,columnIndex:n}),c;o===1?(r.data=u,c=r):(c=new TreeNode(u),r.addChild(c)),o<_classPrivateFieldGet$2(i,_sourceSettings$1).getLayersCount()&&i.buildLeaves(c,n,o,l.origColspan),n+=l.origColspan})}},{key:"clear",value:function(){_classPrivateFieldGet$2(this,_rootNodes).clear(),_classPrivateFieldGet$2(this,_rootsIndex).clear()}}]),e}();function traverseHiddenNodeColumnIndexes(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function getFirstChildProperty(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function isNodeReflectsFirstChildColspan(e){return getFirstChildProperty(e,"origColspan")===e.data.origColspan}function expandNode(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=isNodeReflectsFirstChildColspan(e);if(n)return expandNode(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)arrayEach(o,function(f){f.replaceTreeWith(f.data.clonedTree),f.data.clonedTree=null;var d=f.data;a+=d.colspan,traverseHiddenNodeColumnIndexes(f,function(h){i.add(h)})});else{var s=t.colspan,l=t.origColspan,u=t.columnIndex;a=l-s;for(var c=1;c<l;c++)i.add(u+c)}return e.walkUp(function(f){var d=f.data;d.colspan+=a,d.colspan>=d.origColspan?(d.colspan=d.origColspan,d.isCollapsed=!1):isNodeReflectsFirstChildColspan(f)&&(d.isCollapsed=getFirstChildProperty(f,"isCollapsed"))}),{rollbackModification:function(){return collapseNode(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function collapseNode(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=isNodeReflectsFirstChildColspan(e);if(o)return collapseNode(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)arrayEach(i,function(d){traverseHiddenNodeColumnIndexes(d,function(h){a.add(h)}),d.data.clonedTree=d.cloneTree(),d.walkDown(function(h){var y=h.data;y.isHidden=!0})});else for(var s=r.origColspan,l=r.columnIndex,u=1;u<s;u++){var c=l+u;a.add(c)}var f=r.colspan-((t=getFirstChildProperty(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(d){var h=d.data;h.colspan-=f,h.colspan<=1?(h.colspan=1,h.isCollapsed=!0):isNodeReflectsFirstChildColspan(d)&&(h.isCollapsed=getFirstChildProperty(d,"isCollapsed"))}),{rollbackModification:function(){return expandNode(e)},affectedColumns:Array.from(a),colspanCompensation:f}}var _templateObject$3;function _taggedTemplateLiteral$3(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function hideColumn(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(toSingleLine(_templateObject$3||(_templateObject$3=_taggedTemplateLiteral$3([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var _templateObject$2;function _taggedTemplateLiteral$2(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function showColumn(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(toSingleLine(_templateObject$2||(_templateObject$2=_taggedTemplateLiteral$2([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var availableModifiers=new Map([["collapse",collapseNode],["expand",expandNode],["hide-column",hideColumn],["show-column",showColumn]]);function triggerNodeModification(e,t,r){if(!availableModifiers.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return availableModifiers.get(e)(t,r)}var _excluded$1=["crossHiddenColumns"];function _objectWithoutProperties$1(e,t){if(e==null)return{};var r=_objectWithoutPropertiesLoose$1(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _objectWithoutPropertiesLoose$1(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function generateMatrix(e){var t=[];return arrayEach(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,s=o.headerLevel,l=o.crossHiddenColumns,u=createNestedArrayIfNecessary(t,s),c=!1,f=a;f<a+i;f++){var d=l.includes(f);if(d||c)u.push(createPlaceholderHeaderSettings());else{var h=createHeaderSettings(o);h.isRoot=!0,u.push(h),c=!0}}})}),t}function createHeaderSettings(e){var t=createDefaultHeaderSettings(e);t.crossHiddenColumns;var r=_objectWithoutProperties$1(t,_excluded$1);return r}function createNestedArrayIfNecessary(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function _typeof$f(e){return _typeof$f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$f(e)}var _excluded=["row"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(n){_defineProperty$2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _defineProperty$2(e,t,r){return t=_toPropertyKey$f(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties(e,t){if(e==null)return{};var r=_objectWithoutPropertiesLoose(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _objectWithoutPropertiesLoose(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function _classCallCheck$f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$f(n.key),n)}}function _createClass$f(e,t,r){return t&&_defineProperties$f(e.prototype,t),r&&_defineProperties$f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$f(e){var t=_toPrimitive$f(e,"string");return _typeof$f(t)==="symbol"?t:String(t)}function _toPrimitive$f(e,t){if(_typeof$f(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$f(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldInitSpec$1(e,t,r){_checkPrivateRedeclaration$1(e,t),t.set(e,r)}function _checkPrivateRedeclaration$1(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$1(e,t,r){var n=_classExtractFieldDescriptor$1(e,t,"set");return _classApplyDescriptorSet$1(e,n,r),r}function _classApplyDescriptorSet$1(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function _classPrivateFieldGet$1(e,t){var r=_classExtractFieldDescriptor$1(e,t,"get");return _classApplyDescriptorGet$1(e,r)}function _classExtractFieldDescriptor$1(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorGet$1(e,t){return t.get?t.get.call(e):t.value}var _sourceSettings=new WeakMap,_headersTree=new WeakMap,_stateMatrix=new WeakMap,StateManager=function(){function e(){_classCallCheck$f(this,e),_classPrivateFieldInitSpec$1(this,_sourceSettings,{writable:!0,value:new SourceSettings}),_classPrivateFieldInitSpec$1(this,_headersTree,{writable:!0,value:new HeadersTree(_classPrivateFieldGet$1(this,_sourceSettings))}),_classPrivateFieldInitSpec$1(this,_stateMatrix,{writable:!0,value:[[]]})}return _createClass$f(e,[{key:"setState",value:function(r){_classPrivateFieldGet$1(this,_sourceSettings).setData(r);var n=!1;try{_classPrivateFieldGet$1(this,_headersTree).buildTree()}catch{_classPrivateFieldGet$1(this,_headersTree).clear(),_classPrivateFieldGet$1(this,_sourceSettings).clear(),n=!0}return _classPrivateFieldSet$1(this,_stateMatrix,generateMatrix(_classPrivateFieldGet$1(this,_headersTree).getRoots())),n}},{key:"setColumnsLimit",value:function(r){_classPrivateFieldGet$1(this,_sourceSettings).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=arrayMap(r,function(i){var a=i.row,s=_objectWithoutProperties(i,_excluded);return _objectSpread({row:a<0?n.rowCoordsToLevel(a):a},s)});_classPrivateFieldGet$1(this,_sourceSettings).mergeWith(o),_classPrivateFieldGet$1(this,_headersTree).buildTree(),_classPrivateFieldSet$1(this,_stateMatrix,generateMatrix(_classPrivateFieldGet$1(this,_headersTree).getRoots()))}},{key:"mapState",value:function(r){_classPrivateFieldGet$1(this,_sourceSettings).map(r),_classPrivateFieldGet$1(this,_headersTree).buildTree(),_classPrivateFieldSet$1(this,_stateMatrix,generateMatrix(_classPrivateFieldGet$1(this,_headersTree).getRoots()))}},{key:"mapNodes",value:function(r){return arrayReduce$1(_classPrivateFieldGet$1(this,_headersTree).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=_classPrivateFieldGet$1(this,_headersTree).getNode(n,o),a;return i&&(a=triggerNodeModification(r,i,o),_classPrivateFieldSet$1(this,_stateMatrix,generateMatrix(_classPrivateFieldGet$1(this,_headersTree).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(o=(i=_classPrivateFieldGet$1(this,_stateMatrix)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var o=_classPrivateFieldGet$1(this,_headersTree).getNode(r,n);return o?_objectSpread({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var s=n-1;s>=0;){var l,u=(l=this.getHeaderSettings(r,s))!==null&&l!==void 0?l:{isRoot:!0},c=u.isRoot;if(c)break;s-=1}return s}},{key:"getLayersCount",value:function(){return _classPrivateFieldGet$1(this,_sourceSettings).getLayersCount()}},{key:"getColumnsCount",value:function(){return _classPrivateFieldGet$1(this,_sourceSettings).getColumnsCount()}},{key:"clear",value:function(){_classPrivateFieldSet$1(this,_stateMatrix,[]),_classPrivateFieldGet$1(this,_sourceSettings).clear(),_classPrivateFieldGet$1(this,_headersTree).clear()}}]),e}();function _typeof$e(e){return _typeof$e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$e(e)}function _classCallCheck$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$e(n.key),n)}}function _createClass$e(e,t,r){return t&&_defineProperties$e(e.prototype,t),r&&_defineProperties$e(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty$1(e,t,r){return t=_toPropertyKey$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$e(e){var t=_toPrimitive$e(e,"string");return _typeof$e(t)==="symbol"?t:String(t)}function _toPrimitive$e(e,t){if(_typeof$e(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$e(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GhostTable=function(){function e(t,r){_classCallCheck$e(this,e),_defineProperty$1(this,"hot",void 0),_defineProperty$1(this,"nestedHeaderSettingsGetter",void 0),_defineProperty$1(this,"layersCount",0),_defineProperty$1(this,"container",void 0),_defineProperty$1(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return _createClass$e(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),s=o.createElement("table"),l=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),c=0;c<this.layersCount;c++){for(var f=o.createElement("tr"),d=0;d<u;d++){var h=i.getVisualFromRenderableIndex(d);h===null&&(h=d);var y=o.createElement("th"),p=this.nestedHeaderSettingsGetter(c,h);if(p&&(!p.isPlaceholder||p.isHidden)){var v=p.label;l&&(v+='<button class="changeType"></button>'),fastInnerHTML(y,v),y.colSpan=p.colspan,f.appendChild(y)}}s.appendChild(f)}a.appendChild(s),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const GhostTable$1=GhostTable;function _typeof$d(e){return _typeof$d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$d(e)}var _templateObject$1,_templateObject2;function _taggedTemplateLiteral$1(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$d(n.key),n)}}function _createClass$d(e,t,r){return t&&_defineProperties$d(e.prototype,t),r&&_defineProperties$d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _get$5(){return typeof Reflect<"u"&&Reflect.get?_get$5=Reflect.get.bind():_get$5=function(t,r,n){var o=_superPropBase$5(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$5.apply(this,arguments)}function _superPropBase$5(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$9(e),e!==null););return e}function _inherits$9(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$9(e,t)}function _setPrototypeOf$9(e,t){return _setPrototypeOf$9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$9(e,t)}function _createSuper$9(e){var t=_isNativeReflectConstruct$9();return function(){var n=_getPrototypeOf$9(e),o;if(t){var i=_getPrototypeOf$9(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$9(this,o)}}function _possibleConstructorReturn$9(e,t){if(t&&(_typeof$d(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$9(e)}function _assertThisInitialized$9(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$9(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$9(e){return _getPrototypeOf$9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$9(e)}function _defineProperty(e,t,r){return t=_toPropertyKey$d(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey$d(e){var t=_toPrimitive$d(e,"string");return _typeof$d(t)==="symbol"?t:String(t)}function _toPrimitive$d(e,t){if(_typeof$d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldInitSpec(e,t,r){_checkPrivateRedeclaration(e,t),t.set(e,r)}function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet(e,t,r){var n=_classExtractFieldDescriptor(e,t,"set");return _classApplyDescriptorSet(e,n,r),r}function _classApplyDescriptorSet(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function _classPrivateFieldGet(e,t){var r=_classExtractFieldDescriptor(e,t,"get");return _classApplyDescriptorGet(e,r)}function _classExtractFieldDescriptor(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classApplyDescriptorGet(e,t){return t.get?t.get.call(e):t.value}var PLUGIN_KEY$6="nestedHeaders",PLUGIN_PRIORITY$5=280,_stateManager=new WeakMap,_hidingIndexMapObserver=new WeakMap,NestedHeaders=function(e){_inherits$9(r,e);var t=_createSuper$9(r);function r(){var n;_classCallCheck$d(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_classPrivateFieldInitSpec(_assertThisInitialized$9(n),_stateManager,{writable:!0,value:new StateManager}),_classPrivateFieldInitSpec(_assertThisInitialized$9(n),_hidingIndexMapObserver,{writable:!0,value:null}),_defineProperty(_assertThisInitialized$9(n),"ghostTable",new GhostTable$1(n.hot,function(s,l){return n.getHeaderSettings(s,l)})),_defineProperty(_assertThisInitialized$9(n),"detectedOverlappedHeaders",!1),n}return _createClass$d(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$6]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&warn(toSingleLine(_templateObject$1||(_templateObject$1=_taggedTemplateLiteral$1([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(s){return o.onAfterGetColumnHeaderRenderers(s)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return o.onModifyColumnHeaderValue.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("beforeCopy",function(){return o.onBeforeCopy.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),_get$5(_getPrototypeOf$9(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;_classPrivateFieldGet(this,_stateManager).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=_classPrivateFieldGet(this,_stateManager).setState(a)),this.detectedOverlappedHeaders&&warn(toSingleLine(_templateObject2||(_templateObject2=_taggedTemplateLiteral$1([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(s,l){var u=s===!0?"hide-column":"show-column";_classPrivateFieldGet(o,_stateManager).triggerColumnModification(u,l)}),!_classPrivateFieldGet(this,_hidingIndexMapObserver)&&this.enabled&&_classPrivateFieldSet(this,_hidingIndexMapObserver,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(s){s.forEach(function(l){var u=l.op,c=l.index,f=l.newValue;if(u==="replace"){var d=f===!0?"hide-column":"show-column";_classPrivateFieldGet(o,_stateManager).triggerColumnModification(d,c)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),_get$5(_getPrototypeOf$9(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),_classPrivateFieldGet(this,_stateManager).clear(),_classPrivateFieldGet(this,_hidingIndexMapObserver).unsubscribe(),_classPrivateFieldSet(this,_hidingIndexMapObserver,null),this.ghostTable.clear(),_get$5(_getPrototypeOf$9(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return _classPrivateFieldGet(this,_stateManager)}},{key:"getLayersCount",value:function(){return _classPrivateFieldGet(this,_stateManager).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return _classPrivateFieldGet(this,_stateManager).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,s=o.wtOverlays.topOverlay.clone.wtTable.THEAD,l=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var c=a.childNodes[u];if(!c)break;for(var f=s.childNodes[u],d=l?l.childNodes[u]:null,h=0,y=c.childNodes.length;h<y;h++)c.childNodes[h].removeAttribute("colspan"),removeClass(c.childNodes[h],"hiddenHeader"),f&&f.childNodes[h]&&(f.childNodes[h].removeAttribute("colspan"),removeClass(f.childNodes[h],"hiddenHeader")),l&&d&&d.childNodes[h]&&(d.childNodes[h].removeAttribute("colspan"),removeClass(d.childNodes[h],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(s,l){var u,c=i.hot,f=c.columnIndexMapper,d=c.view,h=f.getVisualFromRenderableIndex(s);h===null&&(h=s),l.removeAttribute("colspan"),removeClass(l,"hiddenHeader");var y=(u=_classPrivateFieldGet(i,_stateManager).getHeaderSettings(o,h))!==null&&u!==void 0?u:{label:""},p=y.colspan,v=y.isHidden,b=y.isPlaceholder;if(b||v)addClass(l,"hiddenHeader");else if(p>1){var S,w,P=d._wt.wtOverlays,E=(S=P.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(l),j=(w=P.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(l),G=E||j?Math.min(p,a-s):p;G>1&&l.setAttribute("colspan",G)}i.hot.view.appendColHeader(h,l,function(){return i.getColumnHeaderValue.apply(i,arguments)},o)}}},{key:"getColumnHeaderValue",value:function(o,i){var a,s=(a=_classPrivateFieldGet(this,_stateManager).getHeaderSettings(i,o))!==null&&a!==void 0?a:{},l=s.isHidden,u=s.isPlaceholder;return u||l?"":this.hot.getColHeader(o,i)}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var s=_classPrivateFieldGet(this,_stateManager).getHeaderTreeNodeData(i,o);if(!s)return o;var l=a.classNames,u=a.columnCursor,c=a.selectionType,f=a.selectionWidth,d=_classPrivateFieldGet(this,_stateManager).getHeaderSettings(i,o),h=d.isRoot,y=d.colspan;if(c===HEADER_TYPE){if(!h)return s.columnIndex}else c===ACTIVE_HEADER_TYPE&&(y>f-u||!h)&&(l.length=0);return o}},{key:"onBeforeCopy",value:function(o,i,a){var s=a.columnHeadersCount;if(s!==0)for(var l=0;l<i.length;l++){var u=i[l],c=u.startRow,f=u.startCol,d=u.endRow,h=u.endCol,y=d-c+1,p=f-h+1;if(c>=0||p===1)break;for(var v=f;v<=h;v++)for(var b=c;b<=d;b++){var S,w=y+b,P=v-f;if(P!==0){var E=(S=_classPrivateFieldGet(this,_stateManager).getHeaderTreeNodeData(b,v))===null||S===void 0?void 0:S.isRoot;E===!1&&(o[w][P]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,s){var l=this._getHeaderTreeNodeDataByCoords(i);l&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var s=this.hot.selection,l=s.isSelected()?s.getSelectedRange().current():null,u=[],c=a.columnIndex,f=a.origColspan,d=!s.inInSelection(i);o.shiftKey&&l?i.col<l.from.col?u.push(l.getTopEndCorner().col,c,i.row):i.col>l.from.col?u.push(l.getTopStartCorner().col,c+f-1,i.row):u.push(c,c+f-1,i.row):(isLeftClick(o)||isRightClick(o)&&d)&&u.push(c,c+f-1,i.row),s.selectColumns.apply(s,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,s){var l;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var c=u.columnIndex,f=u.origColspan,d=this.hot.getSelectedRangeLast(),h=d.getTopStartCorner(),y=d.getBottomEndCorner(),p=d.from;s.column=!0,s.cell=!0;var v=[];i.col<p.col?v.push(y.col,c):i.col>p.col?v.push(h.col,c+f-1):v.push(c,c+f-1),(l=this.hot).selectColumns.apply(l,v)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){o.length=0;for(var i=0;i<_classPrivateFieldGet(this,_stateManager).getLayersCount();i++)o.push(this.headerRendererFactory(i))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=_classPrivateFieldGet(this,_stateManager).getLayersCount(),a=o.startColumn,s=!!i,l=0;l<i;l++){var u=_classPrivateFieldGet(this,_stateManager).findLeftMostColumnIndex(l,o.startColumn),c=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(s=!1),isNumeric(c)&&c<o.startColumn){a=c;break}}o.startColumn=s?_classPrivateFieldGet(this,_stateManager).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onModifyColumnHeaderValue",value:function(o,i,a){var s,l=(s=_classPrivateFieldGet(this,_stateManager).getHeaderTreeNodeData(a,i))!==null&&s!==void 0?s:{label:""},u=l.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){_classPrivateFieldSet(this,_stateManager,null),_classPrivateFieldGet(this,_hidingIndexMapObserver)!==null&&(_classPrivateFieldGet(this,_hidingIndexMapObserver).unsubscribe(),_classPrivateFieldSet(this,_hidingIndexMapObserver,null)),_get$5(_getPrototypeOf$9(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return _classPrivateFieldGet(this,_stateManager).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$6}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$5}}]),r}(BasePlugin);function _toConsumableArray$5(e){return _arrayWithoutHoles$5(e)||_iterableToArray$5(e)||_unsupportedIterableToArray$5(e)||_nonIterableSpread$5()}function _nonIterableSpread$5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$5(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$5(e,t)}}function _iterableToArray$5(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$5(e){if(Array.isArray(e))return _arrayLikeToArray$5(e)}function _arrayLikeToArray$5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _typeof$c(e){return _typeof$c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$c(e)}function _classCallCheck$c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$c(n.key),n)}}function _createClass$c(e,t,r){return t&&_defineProperties$c(e.prototype,t),r&&_defineProperties$c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$c(e){var t=_toPrimitive$c(e,"string");return _typeof$c(t)==="symbol"?t:String(t)}function _toPrimitive$c(e,t){if(_typeof$c(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$c(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataManager=function(){function e(t,r){_classCallCheck$c(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return _createClass$c(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},rangeEach(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&arrayEach(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,s=!1,l=n;if(isNaN(l)&&l.end)return l;var u=r;return u||(u={__children:this.data},s=!0,l-=1),o!=null&&l===o?{result:u,end:!0}:i!=null&&u===i?{result:l,end:!0}:(l+=1,u.__children&&arrayEach(u.__children,function(c){if(a.parentReference.set(c,s?null:u),l=a.readTreeNodes(c,l,o,i),isNaN(l)&&l.end)return!1}),l)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return objectEach(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(arrayEach(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||_typeof$c(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var s=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var s=this.getRowIndex(r),l=s+n+1;this.hot.runHooks("beforeCreateRow",l,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),a=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(rangeEach(r[0],r[2],function(b){var S=n.translateTrimmedRow(b);a.push(n.getDataObject(S))}),rangeEach(0,a.length-2,function(b){n.detachFromParent(a[b],!1)}),i=a[a.length-1]):i=r;var s=this.getRowIndex(i),l=this.countChildren(i),u=this.getRowIndexWithinParent(i),c=this.getRowParent(i),f=this.getRowParent(c),d=this.getRowIndex(f),h=null;if(this.hot.runHooks("beforeDetachChild",c,i),u!=null){var y=Array.from(new Array(s+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",s,l+1,y,this.plugin.pluginName),c.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,l+1,y,this.plugin.pluginName),f){h=d+this.countChildren(f);var p=this.getChild(f,this.countChildren(f)-1),v=this.getRowIndex(p);this.hot.runHooks("beforeCreateRow",v+1,l+1,this.plugin.pluginName),f.__children.push(i)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,l+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",c,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];arrayEach(o,function(s){a.push(i.getDataObject(s))}),arrayEach(a,function(s){var l=i.getRowIndexWithinParent(s),u=i.getRowParent(s);u===null?i.data.splice(l,1):u.__children.splice(l,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,s=r;if(i&&i.__children&&i.__children.length===0?(a=i,s=0):r<this.countAllRows()&&(a=this.getRowParent(r),s=this.getRowIndexWithinParent(r)),a)if(o){var l;(l=a.__children).splice.apply(l,[s,n].concat(_toConsumableArray$5(o)))}else a.__children.splice(s,n);else if(o){var u;(u=this.data).splice.apply(u,[s,n].concat(_toConsumableArray$5(o)))}else this.data.splice(s,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),s=this.getRowParent(r),l=this.getRowIndexWithinParent(r),u=s.__children.slice(l,l+1),c=r>n,f=a?this.getRowParent(n-1):this.getRowParent(n);f==null&&(f=this.getRowParent(n-1)),f==null&&(f=this.getDataObject(n-1)),f?f.__children||(f.__children=[]):(f=this.getDataObject(n),f.__children=[]);var d=a||o||i?f.__children.length:this.getRowIndexWithinParent(n),h=s===f;f.__children.splice(d,0,u[0]),s.__children.splice(l+(c&&h?1:0),1),this.syncRowWithRawSource(s),h||this.syncRowWithRawSource(f)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const DataManager$1=DataManager;function _typeof$b(e){return _typeof$b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$b(e)}function _defineProperties$b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$b(n.key),n)}}function _createClass$b(e,t,r){return t&&_defineProperties$b(e.prototype,t),r&&_defineProperties$b(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$b(e){var t=_toPrimitive$b(e,"string");return _typeof$b(t)==="symbol"?t:String(t)}function _toPrimitive$b(e,t){if(_typeof$b(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$b(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classCallCheck$b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var BaseUI=_createClass$b(function e(t,r){_classCallCheck$b(this,e),this.hot=r,this.plugin=t});const BaseUI$1=BaseUI;function _typeof$a(e){return _typeof$a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$a(e)}function _classCallCheck$a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$a(n.key),n)}}function _createClass$a(e,t,r){return t&&_defineProperties$a(e.prototype,t),r&&_defineProperties$a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$a(e){var t=_toPrimitive$a(e,"string");return _typeof$a(t)==="symbol"?t:String(t)}function _toPrimitive$a(e,t){if(_typeof$a(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$a(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$8(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$8(e,t)}function _setPrototypeOf$8(e,t){return _setPrototypeOf$8=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$8(e,t)}function _createSuper$8(e){var t=_isNativeReflectConstruct$8();return function(){var n=_getPrototypeOf$8(e),o;if(t){var i=_getPrototypeOf$8(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$8(this,o)}}function _possibleConstructorReturn$8(e,t){if(t&&(_typeof$a(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$8(e)}function _assertThisInitialized$8(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$8(e){return _getPrototypeOf$8=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$8(e)}var HeadersUI=function(e){_inherits$8(r,e);var t=_createSuper$8(r);function r(n,o){var i;return _classCallCheck$a(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return _createClass$a(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),s=this.dataManager.getRowLevel(a),l=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],c=u.querySelector("span.rowHeader"),f=u.querySelectorAll('[class^="ht_nesting"]');if(arrayEach(f,function(p){p&&u.removeChild(p)}),addClass(i,r.CSS_CLASSES.indicatorContainer),s){var d=this.hot.rootDocument,h=c.cloneNode(!0);u.innerHTML="",rangeEach(0,s-1,function(){var p=d.createElement("SPAN");addClass(p,r.CSS_CLASSES.emptyIndicator),u.appendChild(p)}),u.appendChild(h)}if(this.dataManager.hasChildren(l)){var y=this.hot.rootDocument.createElement("DIV");addClass(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?addClass(y,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):addClass(y,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(y)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(BaseUI$1);const HeadersUI$1=HeadersUI;function _typeof$9(e){return _typeof$9=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$9(e)}function _toConsumableArray$4(e){return _arrayWithoutHoles$4(e)||_iterableToArray$4(e)||_unsupportedIterableToArray$4(e)||_nonIterableSpread$4()}function _nonIterableSpread$4(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$4(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$4(e,t)}}function _iterableToArray$4(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$4(e){if(Array.isArray(e))return _arrayLikeToArray$4(e)}function _arrayLikeToArray$4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$9(n.key),n)}}function _createClass$9(e,t,r){return t&&_defineProperties$9(e.prototype,t),r&&_defineProperties$9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$9(e){var t=_toPrimitive$9(e,"string");return _typeof$9(t)==="symbol"?t:String(t)}function _toPrimitive$9(e,t){if(_typeof$9(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$9(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$7(e,t)}function _setPrototypeOf$7(e,t){return _setPrototypeOf$7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$7(e,t)}function _createSuper$7(e){var t=_isNativeReflectConstruct$7();return function(){var n=_getPrototypeOf$7(e),o;if(t){var i=_getPrototypeOf$7(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$7(this,o)}}function _possibleConstructorReturn$7(e,t){if(t&&(_typeof$9(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$7(e)}function _assertThisInitialized$7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$7(e){return _getPrototypeOf$7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$7(e)}var CollapsingUI=function(e){_inherits$7(r,e);var t=_createSuper$7(r);function r(n,o){var i;return _classCallCheck$9(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,s)},shiftStash:function(s,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l==null&&(l=1/0),arrayEach(i.lastCollapsedRows,function(c,f){c>=s&&c<l&&(i.lastCollapsedRows[f]=c+u)})},applyStash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,s),i.lastCollapsedRows=void 0},trimStash:function(s,l){rangeEach(s,s+l-1,function(u){var c=i.lastCollapsedRows.indexOf(u);c>-1&&i.lastCollapsedRows.splice(c,1)})}},i}return _createClass$9(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,c=null,f=null;return isNaN(o)?(u=o,c=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),c=o),this.dataManager.hasChildren(u)&&arrayEach(u.__children,function(d){l.push(i.dataManager.getRowIndex(d))}),f=this.collapseRows(l,!0,!1),s&&this.trimRows(f),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(c)===-1&&this.collapsedRows.push(c),f}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];arrayEach(o,function(u){l.push.apply(l,_toConsumableArray$4(i.collapseChildren(u,!1,!1)))}),s&&this.trimRows(l),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return arrayEach(o,function(u){l.push(u),a&&i.collapseChildRows(u,l)}),s&&this.trimRows(l),l}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var l=this.dataManager.getDataObject(o);arrayEach(l.__children,function(u){var c=i.dataManager.getRowIndex(u);a.push(c),i.collapseChildRows(c,a)})}s&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return arrayEach(o,function(u){l.push(u),a&&i.expandChildRows(u,l)}),s&&this.untrimRows(l),l}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var l=this.dataManager.getDataObject(o);arrayEach(l.__children,function(u){if(!i.isAnyParentCollapsed(u)){var c=i.dataManager.getRowIndex(u);a.push(c),i.expandChildRows(c,a)}})}s&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,c=null,f=null;return isNaN(o)?(u=o,c=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),c=o),this.collapsedRows.splice(this.collapsedRows.indexOf(c),1),this.dataManager.hasChildren(u)&&arrayEach(u.__children,function(d){var h=i.dataManager.getRowIndex(d);l.push(h)}),f=this.expandRows(l,!0,!1),s&&this.untrimRows(f),a&&this.renderAndAdjust(),f}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];arrayEach(o,function(u){l.push.apply(l,_toConsumableArray$4(i.expandChildren(u,!1,!1)))}),s&&this.untrimRows(l),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];arrayEach(i,function(s){o.dataManager.hasChildren(s)&&a.push(s)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];arrayEach(i,function(s){o.dataManager.hasChildren(s)&&a.push(s)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){arrayEach(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){arrayEach(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),s=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&arrayEach(a.__children,function(l){var u=i.dataManager.getRowIndex(l);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return s=!1,!1}),s}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);hasClass(o.target,HeadersUI$1.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),stopImmediatePropagation(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(BaseUI$1);const CollapsingUI$1=CollapsingUI;function _typeof$8(e){return _typeof$8=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$8(e)}function _classCallCheck$8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$8(n.key),n)}}function _createClass$8(e,t,r){return t&&_defineProperties$8(e.prototype,t),r&&_defineProperties$8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$8(e){var t=_toPrimitive$8(e,"string");return _typeof$8(t)==="symbol"?t:String(t)}function _toPrimitive$8(e,t){if(_typeof$8(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$8(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits$6(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$6(e,t)}function _setPrototypeOf$6(e,t){return _setPrototypeOf$6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$6(e,t)}function _createSuper$6(e){var t=_isNativeReflectConstruct$6();return function(){var n=_getPrototypeOf$6(e),o;if(t){var i=_getPrototypeOf$6(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$6(this,o)}}function _possibleConstructorReturn$6(e,t){if(t&&(_typeof$8(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$6(e)}function _assertThisInitialized$6(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$6(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$6(e){return _getPrototypeOf$6=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$6(e)}var privatePool$1=new WeakMap,ContextMenuUI=function(e){_inherits$6(r,e);var t=_createSuper$6(r);function r(n,o){var i;return _classCallCheck$8(this,r),i=t.call(this,n,o),privatePool$1.set(_assertThisInitialized$6(i),{row_above:function(s,l){var u=l[l.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(s,l){var u=l[l.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return _createClass$8(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:function(){var l=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(l);i.dataManager.addChild(u)},disabled:function(){var l=i.hot.getSelectedLast();return!l||l[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var l=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(l[0]),c=i.dataManager.getRowParent(u);return!c||!l||l[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return rangeEach(0,o.items.length-1,function(s){if(s===0)return arrayEach(a,function(l,u){o.items.splice(s+u,0,l)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=privatePool$1.get(this);return rangeEach(0,o.items.length-1,function(a){var s=i[o.items[a].key];s!=null&&(o.items[a].callback=s)}),o}}]),r}(BaseUI$1);const ContextMenuUI$1=ContextMenuUI;function _typeof$7(e){return _typeof$7=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$7(e)}var _templateObject;function _toConsumableArray$3(e){return _arrayWithoutHoles$3(e)||_iterableToArray$3(e)||_unsupportedIterableToArray$3(e)||_nonIterableSpread$3()}function _nonIterableSpread$3(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$3(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$3(e,t)}}function _iterableToArray$3(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$3(e){if(Array.isArray(e))return _arrayLikeToArray$3(e)}function _arrayLikeToArray$3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$7(n.key),n)}}function _createClass$7(e,t,r){return t&&_defineProperties$7(e.prototype,t),r&&_defineProperties$7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$7(e){var t=_toPrimitive$7(e,"string");return _typeof$7(t)==="symbol"?t:String(t)}function _toPrimitive$7(e,t){if(_typeof$7(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$7(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RowMoveController=function(){function e(t){_classCallCheck$7(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return _createClass$7(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,s=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(s)return!1;this.movedToCollapsed=!1;var l=o===this.hot.countRows(),u=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),c=!0,f=r.map(function(v){if(!c)return!1;var b=a.dataManager.translateTrimmedRow(v);return c=a.shouldAllowMoving(b,u),b}),d=f.indexOf(u)===-1;if(!c||!d)return!1;var h=this.getBaseParent(f),y=this.getTargetParent(l,u),p=h===y;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(y),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(f,u,p),this.moveRows(f,u,y),this.dataManager.rewriteCache(),this.moveCellsMeta(f,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,s=!1;return isUndefined(i)&&(warn(toSingleLine(_templateObject||(_templateObject=_taggedTemplateLiteral([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),s=!0),s}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,_toConsumableArray$3(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(s){i.dataManager.moveRow(s,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],s=Math.max.apply(Math,_toConsumableArray$3(r))<n;r.forEach(function(l){a.push(o.hot.getCellMetaAtRow(l))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(s?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,s=null,l=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var c=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),f=this.dataManager.getRowIndex(c);i=this.dataManager.untranslateTrimmedRow(f),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);s=this.hot.selection,l=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(a,l),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function _typeof$6(e){return _typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$6(e)}function _toConsumableArray$2(e){return _arrayWithoutHoles$2(e)||_iterableToArray$2(e)||_unsupportedIterableToArray$2(e)||_nonIterableSpread$2()}function _nonIterableSpread$2(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$2(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$2(e,t)}}function _iterableToArray$2(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$2(e){if(Array.isArray(e))return _arrayLikeToArray$2(e)}function _arrayLikeToArray$2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$6(n.key),n)}}function _createClass$6(e,t,r){return t&&_defineProperties$6(e.prototype,t),r&&_defineProperties$6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$6(e){var t=_toPrimitive$6(e,"string");return _typeof$6(t)==="symbol"?t:String(t)}function _toPrimitive$6(e,t){if(_typeof$6(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$6(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$4(){return typeof Reflect<"u"&&Reflect.get?_get$4=Reflect.get.bind():_get$4=function(t,r,n){var o=_superPropBase$4(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$4.apply(this,arguments)}function _superPropBase$4(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$5(e),e!==null););return e}function _inherits$5(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$5(e,t)}function _setPrototypeOf$5(e,t){return _setPrototypeOf$5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$5(e,t)}function _createSuper$5(e){var t=_isNativeReflectConstruct$5();return function(){var n=_getPrototypeOf$5(e),o;if(t){var i=_getPrototypeOf$5(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$5(this,o)}}function _possibleConstructorReturn$5(e,t){if(t&&(_typeof$6(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$5(e)}function _assertThisInitialized$5(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$5(e){return _getPrototypeOf$5=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$5(e)}var PLUGIN_KEY$5="nestedRows",PLUGIN_PRIORITY$4=300,privatePool=new WeakMap,WRONG_DATA_TYPE_ERROR="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",NestedRows=function(e){_inherits$5(r,e);var t=_createSuper$5(r);function r(n){var o;return _classCallCheck$6(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,privatePool.set(_assertThisInitialized$5(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return _createClass$6(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$5]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new TrimmingMap),this.dataManager=new DataManager$1(this,this.hot),this.collapsingUI=new CollapsingUI$1(this,this.hot),this.headersUI=new HeadersUI$1(this,this.hot),this.contextMenuUI=new ContextMenuUI$1(this,this.hot),this.rowMoveController=new RowMoveController(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),this.addHook("beforeUpdateData",function(i){return o.onBeforeLoadData(i)}),_get$4(_getPrototypeOf$5(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),_get$4(_getPrototypeOf$5(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),_get$4(_getPrototypeOf$5(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,s){return this.rowMoveController.onBeforeRowMove(o,i,a,s)}},{key:"disableCoreAPIModifiers",value:function(){var o=privatePool.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=privatePool.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=privatePool.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=privatePool.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var s=privatePool.get(this);return s.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var s=privatePool.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),s.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,s){var l=this;if(s!==this.pluginName){var u=privatePool.get(this);setTimeout(function(){u.skipRender=null,l.headersUI.updateRowHeaderWidth(),l.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var s=this,l=Array.from(a.reduce(function(u,c){if(s.dataManager.isParent(c)){var f=s.dataManager.getDataObject(c).__children;return u.add(c),Array.isArray(f)&&f.forEach(function(d){return u.add(s.dataManager.getRowIndex(d))}),u}return u.add(c)},new Set));a.length=0,a.push.apply(a,l)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,_toConsumableArray$2(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=privatePool.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){_get$4(_getPrototypeOf$5(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!isArrayOfObjects(o)){error(WRONG_DATA_TYPE_ERROR),this.hot.getSettings()[PLUGIN_KEY$5]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$5}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$4}}]),r}(BasePlugin);function _typeof$5(e){return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$5(e)}function _classCallCheck$5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$5(n.key),n)}}function _createClass$5(e,t,r){return t&&_defineProperties$5(e.prototype,t),r&&_defineProperties$5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$5(e){var t=_toPrimitive$5(e,"string");return _typeof$5(t)==="symbol"?t:String(t)}function _toPrimitive$5(e,t){if(_typeof$5(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$5(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Storage=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;_classCallCheck$5(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return _createClass$5(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;arrayEach(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const Storage$1=Storage;function _typeof$4(e){return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$4(e)}function _classCallCheck$4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$4(n.key),n)}}function _createClass$4(e,t,r){return t&&_defineProperties$4(e.prototype,t),r&&_defineProperties$4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$4(e){var t=_toPrimitive$4(e,"string");return _typeof$4(t)==="symbol"?t:String(t)}function _toPrimitive$4(e,t){if(_typeof$4(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$4(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$3(){return typeof Reflect<"u"&&Reflect.get?_get$3=Reflect.get.bind():_get$3=function(t,r,n){var o=_superPropBase$3(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$3.apply(this,arguments)}function _superPropBase$3(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$4(e),e!==null););return e}function _inherits$4(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$4(e,t)}function _setPrototypeOf$4(e,t){return _setPrototypeOf$4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$4(e,t)}function _createSuper$4(e){var t=_isNativeReflectConstruct$4();return function(){var n=_getPrototypeOf$4(e),o;if(t){var i=_getPrototypeOf$4(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$4(this,o)}}function _possibleConstructorReturn$4(e,t){if(t&&(_typeof$4(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$4(e)}function _assertThisInitialized$4(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$4(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$4(e){return _getPrototypeOf$4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$4(e)}Hooks$1.getSingleton().register("persistentStateSave");Hooks$1.getSingleton().register("persistentStateLoad");Hooks$1.getSingleton().register("persistentStateReset");var PLUGIN_KEY$4="persistentState",PLUGIN_PRIORITY$3=0,PersistentState=function(e){_inherits$4(r,e);var t=_createSuper$4(r);function r(n){var o;return _classCallCheck$4(this,r),o=t.call(this,n),o.storage=void 0,o}return _createClass$4(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$4]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new Storage$1(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),_get$3(_getPrototypeOf$4(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,_get$3(_getPrototypeOf$4(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$3(_getPrototypeOf$4(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){_get$3(_getPrototypeOf$4(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$4}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$3}}]),r}(BasePlugin);function _typeof$3(e){return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$3(e)}function _toConsumableArray$1(e){return _arrayWithoutHoles$1(e)||_iterableToArray$1(e)||_unsupportedIterableToArray$1(e)||_nonIterableSpread$1()}function _nonIterableSpread$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray$1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$1(e,t)}}function _iterableToArray$1(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$1(e){if(Array.isArray(e))return _arrayLikeToArray$1(e)}function _arrayLikeToArray$1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$3(n.key),n)}}function _createClass$3(e,t,r){return t&&_defineProperties$3(e.prototype,t),r&&_defineProperties$3(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$3(e){var t=_toPrimitive$3(e,"string");return _typeof$3(t)==="symbol"?t:String(t)}function _toPrimitive$3(e,t){if(_typeof$3(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$3(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$2(){return typeof Reflect<"u"&&Reflect.get?_get$2=Reflect.get.bind():_get$2=function(t,r,n){var o=_superPropBase$2(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$2.apply(this,arguments)}function _superPropBase$2(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$3(e),e!==null););return e}function _inherits$3(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$3(e,t)}function _setPrototypeOf$3(e,t){return _setPrototypeOf$3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$3(e,t)}function _createSuper$3(e){var t=_isNativeReflectConstruct$3();return function(){var n=_getPrototypeOf$3(e),o;if(t){var i=_getPrototypeOf$3(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$3(this,o)}}function _possibleConstructorReturn$3(e,t){if(t&&(_typeof$3(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$3(e)}function _assertThisInitialized$3(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$3(e){return _getPrototypeOf$3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$3(e)}var PLUGIN_KEY$3="search",PLUGIN_PRIORITY$2=190,DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",DEFAULT_CALLBACK=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},DEFAULT_QUERY_METHOD=function(t,r,n){return isUndefined(t)||t===null||!t.toLocaleLowerCase||t.length===0||isUndefined(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},Search=function(e){_inherits$3(r,e);var t=_createSuper$3(r);function r(n){var o;return _classCallCheck$3(this,r),o=t.call(this,n),o.callback=DEFAULT_CALLBACK,o.queryMethod=DEFAULT_QUERY_METHOD,o.searchResultClass=DEFAULT_SEARCH_RESULT_CLASS,o}return _createClass$3(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[PLUGIN_KEY$3]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[PLUGIN_KEY$3];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),_get$2(_getPrototypeOf$3(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),_get$2(_getPrototypeOf$3(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$2(_getPrototypeOf$3(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),l=this.hot.countRows(),u=this.hot.countCols(),c=[],f=this.hot;return rangeEach(0,l-1,function(d){rangeEach(0,u-1,function(h){var y=i.hot.getDataAtCell(d,h),p=i.hot.getCellMeta(d,h),v=p.search.callback||a,b=p.search.queryMethod||s,S=b(o,y,p);if(S){var w={row:d,col:h,data:y};c.push(w)}v&&v(f,d,h,y,S)})}),c}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){isObject$6(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,s,l,u){var c=u.className||[],f=[];if(typeof c=="string")f=c.split(" ");else{var d;(d=f).push.apply(d,_toConsumableArray$1(c))}this.isEnabled()&&u.isSearchResult?f.includes(this.searchResultClass)||f.push("".concat(this.searchResultClass)):f.includes(this.searchResultClass)&&f.splice(f.indexOf(this.searchResultClass),1),u.className=f.join(" ")}},{key:"destroy",value:function(){_get$2(_getPrototypeOf$3(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$3}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$2}}]),r}(BasePlugin);function _typeof$2(e){return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2(e)}function _classCallCheck$2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$2(n.key),n)}}function _createClass$2(e,t,r){return t&&_defineProperties$2(e.prototype,t),r&&_defineProperties$2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$2(e){var t=_toPrimitive$2(e,"string");return _typeof$2(t)==="symbol"?t:String(t)}function _toPrimitive$2(e,t){if(_typeof$2(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$2(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get$1(){return typeof Reflect<"u"&&Reflect.get?_get$1=Reflect.get.bind():_get$1=function(t,r,n){var o=_superPropBase$1(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get$1.apply(this,arguments)}function _superPropBase$1(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$2(e),e!==null););return e}function _inherits$2(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$2(e,t)}function _setPrototypeOf$2(e,t){return _setPrototypeOf$2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$2(e,t)}function _createSuper$2(e){var t=_isNativeReflectConstruct$2();return function(){var n=_getPrototypeOf$2(e),o;if(t){var i=_getPrototypeOf$2(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$2(this,o)}}function _possibleConstructorReturn$2(e,t){if(t&&(_typeof$2(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$2(e)}function _assertThisInitialized$2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$2(e){return _getPrototypeOf$2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$2(e)}var PLUGIN_KEY$2="touchScroll",PLUGIN_PRIORITY$1=200,TouchScroll=function(e){_inherits$2(r,e);var t=_createSuper$2(r);function r(n){var o;return _classCallCheck$2(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return _createClass$2(r,[{key:"isEnabled",value:function(){return isTouchSupported()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),_get$1(_getPrototypeOf$2(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,_get$1(_getPrototypeOf$2(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){_get$1(_getPrototypeOf$2(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,s=o.inlineStartOverlay,l=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(s),l&&this.scrollbars.push(l),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&this.clones.push(l.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,arrayEach(this.clones,function(o){addClass(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,arrayEach(this.clones,function(i){removeClass(i,"hide-tween"),addClass(i,"show-tween")}),this.hot._registerTimeout(function(){arrayEach(o.clones,function(i){removeClass(i,"show-tween")})},400),arrayEach(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$2}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY$1}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(BasePlugin);function _typeof$1(e){return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1(e)}function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey$1(n.key),n)}}function _createClass$1(e,t,r){return t&&_defineProperties$1(e.prototype,t),r&&_defineProperties$1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey$1(e){var t=_toPrimitive$1(e,"string");return _typeof$1(t)==="symbol"?t:String(t)}function _toPrimitive$1(e,t){if(_typeof$1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof$1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _get(){return typeof Reflect<"u"&&Reflect.get?_get=Reflect.get.bind():_get=function(t,r,n){var o=_superPropBase(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_get.apply(this,arguments)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf$1(e),e!==null););return e}function _inherits$1(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf$1(e,t)}function _setPrototypeOf$1(e,t){return _setPrototypeOf$1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf$1(e,t)}function _createSuper$1(e){var t=_isNativeReflectConstruct$1();return function(){var n=_getPrototypeOf$1(e),o;if(t){var i=_getPrototypeOf$1(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn$1(this,o)}}function _possibleConstructorReturn$1(e,t){if(t&&(_typeof$1(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1(e)}function _assertThisInitialized$1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$1(e){return _getPrototypeOf$1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf$1(e)}var PLUGIN_KEY$1="trimRows",PLUGIN_PRIORITY=330,TrimRows=function(e){_inherits$1(r,e);var t=_createSuper$1(r);function r(n){var o;return _classCallCheck$1(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return _createClass$1(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PLUGIN_KEY$1]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new TrimmingMap),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),_get(_getPrototypeOf$1(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[PLUGIN_KEY$1];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),arrayEach(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),_get(_getPrototypeOf$1(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),_get(_getPrototypeOf$1(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),s=this.isValidConfig(o),l=a;s&&(l=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){arrayEach(o,function(c){i.trimmedRowsMap.setValueAtIndex(c,!0)})},!0),this.hot.runHooks("afterTrimRow",a,l,s,s&&l.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),s=i,l=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&(arrayEach(o,function(f){l[f]=!1}),s=arrayReduce$1(l,function(f,d,h){return d&&f.push(h),f},[]));var c=this.hot.runHooks("beforeUntrimRow",i,s,a&&u);c!==!1&&(a&&u&&this.trimmedRowsMap.setValues(l),this.hot.runHooks("afterUntrimRow",i,s,a&&u,a&&s.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[PLUGIN_KEY$1];Array.isArray(i)&&this.hot.batchExecution(function(){arrayEach(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){_get(_getPrototypeOf$1(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PLUGIN_KEY$1}},{key:"PLUGIN_PRIORITY",get:function(){return PLUGIN_PRIORITY}}]),r}(BasePlugin);function _typeof(e){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return _typeof(t)==="symbol"?t:String(t)}function _toPrimitive(e,t){if(_typeof(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_typeof(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _inherits(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n=_getPrototypeOf(e),o;if(t){var i=_getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(e,t){if(t&&(_typeof(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(e,t)}}function _arrayLikeToArray(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var SHORTCUTS_GROUP="undoRedo",PLUGIN_KEY="undoRedo";function UndoRedo(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(l){var u=_slicedToArray(l,4),c=u[2],f=u[3];return c!==f});if(a){var s=function(){var u=r.reduce(function(f,d){return f.push(_toConsumableArray(d)),f},[]);arrayEach(u,function(f){f[1]=e.propToCol(f[1])});var c=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new UndoRedo.ChangeAction(u,c)};t.done(s,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new UndoRedo.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var l=e.toPhysicalRow(r),u=deepClone(t.instance.getSourceData(l,0,l+n-1,t.instance.countSourceCols()-1));return new UndoRedo.RemoveRowAction(l,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new UndoRedo.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var l=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),c=[],f=[],d=[];rangeEach(l.length-1,function(p){var v=[],b=l[p];rangeEach(u,u+(n-1),function(S){v.push(b[e.toPhysicalColumn(S)])}),c.push(v)}),rangeEach(n-1,function(p){d.push(e.toPhysicalColumn(u+p))}),Array.isArray(e.getSettings().colHeaders)&&rangeEach(n-1,function(p){f.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+p)]||null)});var h=e.columnIndexMapper.getIndexesSequence(),y=e.rowIndexMapper.getIndexesSequence();return new UndoRedo.RemoveColumnAction(u,d,c,f,h,y,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new UndoRedo.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new UndoRedo.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new UndoRedo.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new UndoRedo.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new UndoRedo.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}UndoRedo.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=deepClone(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=deepClone(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0};UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};UndoRedo.prototype.isEnabled=function(){return this.enabled};UndoRedo.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,exposeUndoRedoMethods(e),this.registerShortcuts(),e.addHook("afterChange",onAfterChange)}};UndoRedo.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,removeExposedUndoRedoMethods(e),this.unregisterShortcuts(),e.removeHook("afterChange",onAfterChange)}};UndoRedo.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};UndoRedo.Action=function(){};UndoRedo.Action.prototype.undo=function(){};UndoRedo.Action.prototype.redo=function(){};UndoRedo.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};inherit(UndoRedo.ChangeAction,UndoRedo.Action);UndoRedo.ChangeAction.prototype.undo=function(e,t){for(var r=deepClone(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=_slicedToArray(r[s],2),c=u[0],f=u[1];e.getSettings().minSpareRows&&c+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(c+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&f+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(f+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};UndoRedo.ChangeAction.prototype.redo=function(e,t){for(var r=deepClone(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};inherit(UndoRedo.CreateRowAction,UndoRedo.Action);UndoRedo.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};UndoRedo.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};inherit(UndoRedo.RemoveRowAction,UndoRedo.Action);UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(s){var l=parseInt(s,10);o.push([r.index+a,isNaN(l)?s:l,i[s]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};inherit(UndoRedo.CreateColumnAction,UndoRedo.Action);UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};UndoRedo.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};inherit(UndoRedo.RemoveColumnAction,UndoRedo.Action);UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(d,h,y){return y[r.indexes.indexOf(o[h])]},a=this.data.length,s=[],l=0;l<a;l++)s.push(arrayMap(this.data[l],i));var u=arrayMap(this.headers,i),c=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),arrayEach(e.getSourceDataArray(),function(f,d){arrayEach(o,function(h,y){f[h]=s[d][y],c.push([d,h,f[h]])})}),e.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(o[0],o.length),typeof this.headers<"u"&&arrayEach(u,function(f,d){e.getSettings().colHeaders[o[d]]=f}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};UndoRedo.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};UndoRedo.CellAlignmentAction.prototype.undo=function(e,t){var r=this;arrayEach(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};UndoRedo.CellAlignmentAction.prototype.redo=function(e,t){align(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};UndoRedo.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};inherit(UndoRedo.FiltersAction,UndoRedo.Action);UndoRedo.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};UndoRedo.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var MergeCellsAction=function(e){_inherits(r,e);var t=_createSuper(r);function r(n,o){var i;_classCallCheck(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),s=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,s.row,s.col),i}return _createClass(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var s=this.cellRange.getTopStartCorner();o.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(UndoRedo.Action);UndoRedo.MergeCellsAction=MergeCellsAction;var UnmergeCellsAction=function(e){_inherits(r,e);var t=_createSuper(r);function r(n,o){var i;return _classCallCheck(this,r),i=t.call(this),i.cellRange=o,i}return _createClass(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(UndoRedo.Action);UndoRedo.UnmergeCellsAction=UnmergeCellsAction;UndoRedo.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};inherit(UndoRedo.RowMoveAction,UndoRedo.Action);UndoRedo.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(c){return c>r.finalIndex}),a=o.filter(function(c){return c<=r.finalIndex}),s=i.sort(function(c,f){return f-c}).concat(a.sort(function(c,f){return c-f}));e.addHookOnce("afterViewRender",t);for(var l=0;l<s.length;l+=1){var u=e.toVisualRow(s[l]);n.moveRow(u,s[l])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};UndoRedo.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};UndoRedo.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};UndoRedo.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:SHORTCUTS_GROUP};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};UndoRedo.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(SHORTCUTS_GROUP)};function onAfterChange(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function exposeUndoRedoMethods(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function removeExposedUndoRedoMethods(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var hook=Hooks$1.getSingleton();hook.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});hook.register("beforeUndo");hook.register("afterUndo");hook.register("beforeRedo");hook.register("afterRedo");UndoRedo.PLUGIN_KEY=PLUGIN_KEY;UndoRedo.SETTING_KEYS=!0;function registerAllPlugins(){registerPlugin(AutoColumnSize),registerPlugin(Autofill),registerPlugin(AutoRowSize),registerPlugin(BindRowsWithHeaders),registerPlugin(CollapsibleColumns),registerPlugin(ColumnSorting),registerPlugin(ColumnSummary),registerPlugin(Comments),registerPlugin(ContextMenu),registerPlugin(CopyPaste),registerPlugin(CustomBorders),registerPlugin(DragToScroll),registerPlugin(DropdownMenu),registerPlugin(ExportFile),registerPlugin(Filters),registerPlugin(Formulas),registerPlugin(HiddenColumns),registerPlugin(HiddenRows),registerPlugin(ManualColumnFreeze),registerPlugin(ManualColumnMove),registerPlugin(ManualColumnResize),registerPlugin(ManualRowMove),registerPlugin(ManualRowResize),registerPlugin(MergeCells),registerPlugin(MultiColumnSorting),registerPlugin(MultipleSelectionHandles),registerPlugin(NestedHeaders),registerPlugin(NestedRows),registerPlugin(PersistentState),registerPlugin(Search),registerPlugin(TouchScroll),registerPlugin(TrimRows),registerPlugin(UndoRedo)}function registerAllModules(){registerAllEditors(),registerAllRenderers(),registerAllValidators(),registerAllCellTypes(),registerAllPlugins()}function jQueryWrapper(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),o=n.data("handsontable");if(typeof r!="string"){var i=r||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}var a;if(o)if(typeof o[r]<"u"){for(var s,l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];a=(s=o[r]).call.apply(s,[o].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return a})}var _Handsontable$cellTyp,_Handsontable$editors,_Handsontable$rendere,_Handsontable$validat,_Handsontable$plugins;registerAllModules();jQueryWrapper(Handsontable$1);Handsontable$1.__GhostTable=GhostTable$3;Handsontable$1._getListenersCounter=getListenersCounter;Handsontable$1._getRegisteredMapsCounter=getRegisteredMapsCounter;Handsontable$1.EventManager=EventManager$1;var HELPERS=[arrayHelpers,browserHelpers,dataHelpers,dateHelpers,featureHelpers,functionHelpers,mixedHelpers,numberHelpers,objectHelpers,stringHelpers,unicodeHelpers,parseTableHelpers],DOM=[domHelpers,domEventHelpers];Handsontable$1.helper={};Handsontable$1.dom={};arrayEach(HELPERS,function(e){arrayEach(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Handsontable$1.helper[t]=e[t])})});arrayEach(DOM,function(e){arrayEach(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Handsontable$1.dom[t]=e[t])})});Handsontable$1.cellTypes=(_Handsontable$cellTyp=Handsontable$1.cellTypes)!==null&&_Handsontable$cellTyp!==void 0?_Handsontable$cellTyp:{};arrayEach(getNames(),function(e){Handsontable$1.cellTypes[e]=_getItem(e)});Handsontable$1.cellTypes.registerCellType=_register;Handsontable$1.cellTypes.getCellType=_getItem;Handsontable$1.editors=(_Handsontable$editors=Handsontable$1.editors)!==null&&_Handsontable$editors!==void 0?_Handsontable$editors:{};arrayEach(getNames$3(),function(e){Handsontable$1.editors["".concat(toUpperCaseFirst(e),"Editor")]=_getItem$3(e)});Handsontable$1.editors.registerEditor=_register$3;Handsontable$1.editors.getEditor=_getItem$3;Handsontable$1.renderers=(_Handsontable$rendere=Handsontable$1.renderers)!==null&&_Handsontable$rendere!==void 0?_Handsontable$rendere:{};arrayEach(getNames$2(),function(e){var t=_getItem$2(e);e==="base"&&(Handsontable$1.renderers.cellDecorator=t),Handsontable$1.renderers["".concat(toUpperCaseFirst(e),"Renderer")]=t});Handsontable$1.renderers.registerRenderer=_register$2;Handsontable$1.renderers.getRenderer=_getItem$2;Handsontable$1.validators=(_Handsontable$validat=Handsontable$1.validators)!==null&&_Handsontable$validat!==void 0?_Handsontable$validat:{};arrayEach(getNames$1(),function(e){Handsontable$1.validators["".concat(toUpperCaseFirst(e),"Validator")]=_getItem$1(e)});Handsontable$1.validators.registerValidator=_register$1;Handsontable$1.validators.getValidator=_getItem$1;Handsontable$1.plugins=(_Handsontable$plugins=Handsontable$1.plugins)!==null&&_Handsontable$plugins!==void 0?_Handsontable$plugins:{};arrayEach(getPluginsNames(),function(e){Handsontable$1.plugins[e]=getPlugin(e)});Handsontable$1.plugins["".concat(toUpperCaseFirst(BasePlugin.PLUGIN_KEY),"Plugin")]=BasePlugin;Handsontable$1.plugins.registerPlugin=registerPlugin;Handsontable$1.plugins.getPlugin=getPlugin;const Handsontable=Object.freeze(Object.defineProperty({__proto__:null,CellCoords:CellCoords$1,CellRange:CellRange$1,default:Handsontable$1},Symbol.toStringTag,{value:"Module"})),handsontable_min="",hotLanguageHandler=(e,{code:t,language:r})=>{const n={nestedHeaders:[[]],data:[],columns:[],manualColumnResize:!0,licenseKey:"non-commercial-and-evaluation",mergeCells:[],height:"auto",readOnly:!0,modifyColWidth:(c,f)=>c>300?300:c};let o=null,i={},a=0,s=[],l=()=>{for(const[c,f]of n.nestedHeaders.entries())if(s[c])s[c].colspan++;else{const d=f.reduce((h,y)=>h+(["undefined","string"].includes(typeof y)?1:y.colspan),0);a>d&&f.push(...new Array(a-d))}};for(const c of t.split(`
`)){if(c.startsWith("# OPTIONS")){o="options";continue}else if(c.startsWith("# COLUMNS")){o="columns";continue}else if(c.startsWith("# DATA")){o="data";continue}switch(o){case"options":{const f=c.split(":").map(d=>d.trim());["true","false"].includes(f[1])?n[f[0]]=f[1]==="true":n[f[0]]=f[1];continue}case"columns.options":{if(c.trim()==="}"){n.columns.push(i),i={},o="columns";continue}const f=c.split(":").map(d=>d.trim());["true","false"].includes(f[1])?i[f[0]]=f[1]==="true":i[f[0]]=f[1];continue}case"columns":{if(c.endsWith("[")){if(s.push({label:c.substr(0,c.length-2).trim(),colspan:0}),n.nestedHeaders.length<=s.length){const f=[];a>0&&f.push(...new Array(a)),n.nestedHeaders.push(f)}}else if(c.trim()==="]"){const f=s.pop();n.nestedHeaders[s.length].push(f)}else c.endsWith("{")?(n.nestedHeaders[s.length].push(c.substr(0,c.length-2).trim()),o="columns.options",a++,l()):(n.columns.push({}),n.nestedHeaders[s.length].push(c.trim()),a++,l());continue}case"data":{const f=c.split("|").map(d=>d.trim().replace(/\\n/g,`
`));for(const[d,h]of f.entries()){const p=/^<\$(?:w(?<width>\d+))?\s?(?:h(?<height>\d+))?\s?(?:s"(?<styling>.+?)")?\>/gm.exec(h);if(p){if(p.groups.height||p.groups.width){const v=parseInt(p.groups.height)||1,b=parseInt(p.groups.width)||1,S=n.data.length;n.mergeCells.push({col:d,row:S,colspan:b,rowspan:v})}f[d]=f[d].substring(p[0].length)}}n.data.push(f);continue}default:continue}}const u=`<div id="HOTable-${e.length}"></div>`;return e.push(n),u},hotLanguageSerialize=e=>{const t=e.getData(),r=e.getSettings().nestedHeaders,n=e.getSettings().mergeCells,o=e.getSettings().columns,i=Object.entries(Object.getPrototypeOf(e.getSettings())),a={};for(const[c,f]of i)typeof f=="boolean"&&f!==Handsontable$1.DefaultSettings[c]&&(a[c]=f);delete a.contextMenu,delete a.manualColumnResize,console.log(n);let s="```handsontable\n";s+=`# OPTIONS
`;for(const[c,f]of Object.entries(a))s+=`${c}: ${f}
`;s+=`# COLUMNS
`;const l=new Array(r.length).fill(0),u=(c,f)=>{let d=l[c],h=0;for(;d<r[c].length&&!["string","object"].includes(typeof r[c][d]);)d++;for(;h<f&&d<r[c].length;){if(typeof r[c][d]=="object")s+=`${"".padStart(c*2," ")}${r[c][d].label} [
`,u(c+1,r[c][d].colspan),h+=r[c][d].colspan;else if(typeof r[c][d]=="string"){s+=`${"".padStart(c*2," ")}${r[c][d]}`;let y=0;for(let p=0;p<d;p++)y+=["undefined","string"].includes(typeof r[c][p])?1:r[c][p].colspan;if(Object.keys(o[y]).length>0){s+=` {
`;for(const[p,v]of Object.entries(o[h]))s+=`${"".padStart((c+1)*2," ")}${p}: ${v}
`;s+=`${"".padStart(c*2," ")}}
`}else s+=`
`;h+=1}else h+=1;d++}c!==0&&(s+=`${"".padStart((c-1)*2," ")}]
`),l[c]=d};u(0,r[0].reduce((c,f)=>c+(["undefined","string"].includes(typeof f)?1:f.colspan),0)),s+=`# DATA
`,console.log(t),console.log(n);for(const c of n)t[c.row][c.col]=`<$w${c.colspan}h${c.rowspan}>`+t[c.row][c.col];for(let c=0;c<t.length;c++)t[c]=t[c].join("|").replace(/\r?\n/g,"\\n");return s+=t.join(`
`),s+="\n```",s},subscriber_queue=[];function readable(e,t){return{subscribe:writable(e,t).subscribe}}function writable(e,t=noop$1){let r;const n=new Set;function o(s){if(safe_not_equal(e,s)&&(e=s,r)){const l=!subscriber_queue.length;for(const u of n)u[1](),subscriber_queue.push(u,e);if(l){for(let u=0;u<subscriber_queue.length;u+=2)subscriber_queue[u][0](subscriber_queue[u+1]);subscriber_queue.length=0}}}function i(s){o(s(e))}function a(s,l=noop$1){const u=[s,l];return n.add(u),n.size===1&&(r=t(o)||noop$1),s(e),()=>{n.delete(u),n.size===0&&(r(),r=null)}}return{set:o,update:i,subscribe:a}}function derived(e,t,r){const n=!Array.isArray(e),o=n?[e]:e,i=t.length<2;return readable(r,a=>{let s=!1;const l=[];let u=0,c=noop$1;const f=()=>{if(u)return;c();const h=t(n?l[0]:l,a);i?a(h):c=is_function(h)?h:noop$1},d=o.map((h,y)=>subscribe(h,p=>{l[y]=p,u&=~(1<<y),s&&f()},()=>{u|=1<<y}));return s=!0,f(),function(){run_all(d),c()}})}const currentPath=(()=>{const{subscribe:e,set:t}=writable("");return e(r=>{console.log(window.history.state),window.history.pushState({},"",`${window.location.origin}${window.location.pathname}?page=${r}`)}),{subscribe:e,set:t,reset:()=>t("")}})(),hostRootAddr=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"./docs/":"https://raw.githubusercontent.com/fudgepop01/master/fudgepop01.github.io/portfolio/public/docs/",defaultTypes=["bool","char","i8","u8","short","i16","u16","int","i32","u32","long","i64","u64","long long","i128","u128","float","f32","double","f64","long double"],currStuctPathStore=()=>{let e="";const{subscribe:t,set:r}=writable("");return{subscribe:t,set:n=>{let o;(o=n.toLowerCase().indexOf("/structs/"))!==-1&&(n=n.substring(0,o+8),n!=e&&(e=n,r(n)))}}},currStructPath=currStuctPathStore(),typeDataStore=()=>{const{subscribe:e,update:t}=writable(JSON.parse(localStorage.getItem("structs")||"{}"));return{subscribe:e,addTypes:async r=>{const n=await(await fetch(`${hostRootAddr}${r}/_consolidated.json`)).json();t(o=>{const i={...o,[r]:n};return localStorage.setItem("structs",JSON.stringify(i)),i})}}},typeData=typeDataStore();currStructPath.subscribe(e=>{e.length&&typeData.addTypes(e)});currentPath.subscribe(e=>{currStructPath.set(e)});const typeList=derived([typeData,currStructPath],([e,t])=>e[t]==null?[...defaultTypes]:[...defaultTypes,...Object.keys(e[t])]);let currentTypeList=[],currentTypeData={},currentStructPath="";typeList.subscribe(e=>{currentTypeList=e});typeData.subscribe(e=>{currentTypeData=e[currentStructPath]});currStructPath.subscribe(e=>{currentStructPath=e});Handsontable$1.renderers.registerRenderer("type",(e,t,r,n,o,i,a)=>{if(t.style.fontFamily="monospace",typeof i=="string"&&a.readOnly){const s=i.endsWith("*")?i.substring(0,i.length-1):i;if(t.innerHTML="",currentTypeData[s]){const l=document.createElement("span");l.onclick=()=>currentPath.set(currentTypeData[s].path.substring(1)),l.className="link",l.innerText=i,t.appendChild(l)}else{const l=document.createElement("span");l.innerText=i,t.appendChild(l)}}return a.readOnly&&t.classList.add("htDimmed"),t});const typeSizeMap=e=>{if(e.endsWith("*"))return 4;switch(e.startsWith("unsigned")||e.startsWith("signed")?e=e.substring(e.indexOf(" ")):(e.startsWith("u")||e.startsWith("i"))&&(e=e.substring(1)),e){case"bool":return 1;case"char":case"8":return 1;case"short":case"short int":case"16":return 2;case"int":case"32":return 4;case"long":case"long int":case"64":return 8;case"long long":case"long long int":case"128":return 16;case"float":case"f32":return 4;case"double":case"f64":return 8;case"long double":return 12;default:return}},structHandler=(e,t,{code:r,language:n})=>{var h;const o={nestedHeaders:[["offset",{colspan:1,label:"type"},"length","name","comments"]],data:[],columns:[{renderer:"hex"},{renderer:"type",type:"autocomplete",source:currentTypeList,strict:!1},{},{},{}],mergeCells:[],manualColumnResize:!0,licenseKey:"non-commercial-and-evaluation",height:"auto",readOnly:!0,modifyColWidth:(y,p)=>y>300?300:y},i={colHeaders:["offset","type","name","comments"],data:[],columns:[{renderer:"hex"},{renderer:"type",type:"autocomplete",source:currentTypeList,strict:!1},{},{}],manualColumnResize:!0,licenseKey:"non-commercial-and-evaluation",height:"auto",readOnly:!0,modifyColWidth:(y,p)=>y>300?300:y},a=[],s=[];let l="",u={offsetType:"rel",comments:"",offset:"0x00000000"},c=0,f="";for(const y of r.replace(/\r/g,"").split(`
`).map(p=>p.trim())){if(y.endsWith("{")){l=y.substring(0,y.length-1);continue}if(y.startsWith("$$")){u.offset=`0x${y.substring(2)}`,u.offsetType="abs";continue}if(y.startsWith("$")){const w=parseInt(y.substring(1),16);s.push({name:"_spacer",offsetType:"rel",offset:`0x${c.toString(16).padStart(8,"0")}`,comments:"",type:"char",length:w-c}),u.offset=`0x${w.toString(16).padStart(8,"0")}`,c=w;continue}if(y.startsWith("//")){const w=y.substring(2).trim();if(w.startsWith("@param")){const P=/@param\s(?<varName>\w+)\s(?<comment>.+)/g.exec(w);u.arguments||(u.arguments={}),f=P.groups.varName,u.arguments[f]||(u.arguments[f]={comments:""}),u.arguments[f].comments||(u.arguments[f].comments=""),P.groups.comment&&(u.arguments[f].comments+=P.groups.comment)}else w.startsWith("@return")?(f="@return",u.return||(u.return={}),u.return.comments||(u.return={comments:""}),u.return.comments+=w.substring(8)):(u.return||(u.return={comments:""}),f==="@return"?u.return.comments+=` ${w}`:f.length?u.arguments[f].comments+=` ${w}`:u.comments+=` ${w}`);continue}const v=/(?<returnType>(?:unsigned\s|signed\s)?\w+\*?)\s(?<fnName>\w+)\((?<args>.+)\)/g.exec(y);if(v){u.arguments||(u.arguments={}),u.return||(u.return={}),u.return.type=v.groups.returnType,u.name=v.groups.fnName;const w=/(?<typing>(?:unsigned\s|signed\s)?\w+\*?)\s(?<argName>\w+)/g;let P;for(;(P=w.exec(v.groups.args))!==null;)u.arguments[P.groups.argName]||(u.arguments[P.groups.argName]={}),u.arguments[P.groups.argName].type=P.groups.typing;a.push(u),f="",u={comments:"",offsetType:"rel",offset:`0x${c.toString(16).padStart(8,"0")}`}}const S=/(?<type>(?:unsigned\s|signed\s)?\w+\*?)\s(?<name>\w+)(?:\[(?<count>\d+)\])?/g.exec(y);if(S){u.name=S.groups.name,u.type=S.groups.type;const w=parseInt(S.groups.count)||1;S.groups.count&&(u.length=w),console.log(u.name,currentTypeData);const P=(typeSizeMap(u.type)||((h=currentTypeData[u.type])==null?void 0:h.size)||0)*w;P!==0&&(s.push(u),c+=P),f="",u={comments:"",offsetType:"rel",offset:`0x${c.toString(16).padStart(8,"0")}`}}}for(const[y,p]of s.entries())o.data.push([p.offset,p.type,p.length||"",p.name,p.comments]);for(const y of a){if(i.data.push([y.offset,y.return.type,y.name,y.comments]),y.arguments)for(const[p,v]of Object.entries(y.arguments))i.data.push(["",v.type,p,v.comments]);y.return&&i.data.push(["",y.return.type,"@return",y.return.comments])}a.length===0&&i.data.push(["","","",""]);const d=`<div id="structTable-${e.length}"></div>`;return e.push({name:l,properties:o,functions:i}),d},rendererFactory=(e,t,r,n)=>({code(o,i,a){switch(i){case"handsontable":return hotLanguageHandler(e.hotLang,{code:o,language:i});case"struct":return structHandler(e.struct.tableData,e.struct.getCurrentData,{code:o,language:i});default:return!1}},heading(o,i,a,s){return t.push({text:a,level:i,id:s.slug(a,{dryrun:!0})}),!1},link(o,i,a){if(o.startsWith("/")){const s=o.indexOf("#")==-1?void 0:o.indexOf("#");return r.includes(o.substring(1,s))?`<a href="${window.location.origin}${window.location.pathname}?page=${o.substring(1,s)}&location=${s?new Slugger().slug(o.substr(s),{dryrun:!0}):""}">${a}</a>`:`<span class="invalid-link" data-targetpage="${o.substring(1,s)}">${a}</span>`}else{if(o.startsWith("#"))return`<a href="${window.location.origin}${window.location.pathname}?page=${localStorage.getItem("lastPage")}&location=${new Slugger().slug(o.substr(1),{dryrun:!0})}">${a}</a>`;if(o.includes("localhost")||o.includes("fudgepop01.github.io")){const s=new URLSearchParams(o.substring(o.indexOf("?"))).get("page");return r.includes(s)?`<a href="${window.location.origin}${window.location.pathname}${o.replace(/https?:\/\/(?:localhost:\d{4}|fudgepop01\.github\.io)/g,"")}">${a}</a>`:`<span class="invalid-link" data-targetpage="${s}">${a}</span>`}}return!1},image(o,i,a){return console.log(o,i,a),a==="SCRIPT"?(window.location.hostname==="localhost"?n=[...n,`${window.location.origin}${window.location.pathname}docs/${o.substring(1)}.js`]:window.location.origin==="https://fudgepop01.github.io"&&(n=[...n,`https://raw.githubusercontent.com/fudgepop01/fudgepop01.github.io/main/public/docs/${o.substring(1)}.js`]),""):!1}}),copyToClipboard=e=>{navigator.clipboard.writeText(e)},registerHexRenderers=()=>{Handsontable$1.renderers.registerRenderer("hex",(e,t,r,n,o,i,a)=>(t.style.fontFamily="monospace",t.style.fontWeight="bold",t.style.textAlign="center",typeof i=="string"?i.length>0?t.innerText="0x"+(i.startsWith("0x")?parseInt(i,16):parseInt(i)).toString(16).toUpperCase():t.innerText="-":typeof i=="number"?t.innerText="0x"+i.toString(16).toUpperCase():t.innerText="NaN",a.readOnly&&(t.className="htDimmed"),t))},PageNav_svelte_svelte_type_style_lang="";function get_each_context$1(e,t,r){const n=e.slice();return n[12]=t[r],n}function create_else_block$2(e){let t,r,n=e[12].label+"",o,i,a,s,l,u,c,f,d;return s=new PageNav({props:{pageDirStructure:e[12],pageRoot:e[1]+e[12].label,lastPage:e[2],clickEvt:e[3]}}),{c(){t=element("menuitem"),r=element("span"),o=text$1(n),i=space(),a=element("div"),create_component(s.$$.fragment),l=space(),attr(r,"class","svelte-15ysesh"),attr(a,"class","nav-dir-links svelte-15ysesh"),set_style(a,"max-height",e[4](e[12])*25+"px"),attr(t,"class",u="nav-dir-header "+(e[12].collapsed?"":"active")+" svelte-15ysesh"),attr(t,"tabindex","0")},m(h,y){insert(h,t,y),append(t,r),append(r,o),append(t,i),append(t,a),mount_component(s,a,null),append(t,l),c=!0,f||(d=[listen(t,"click",click_handler_1),listen(t,"keydown",e[9])],f=!0)},p(h,y){(!c||y&1)&&n!==(n=h[12].label+"")&&set_data(o,n);const p={};y&1&&(p.pageDirStructure=h[12]),y&3&&(p.pageRoot=h[1]+h[12].label),y&4&&(p.lastPage=h[2]),y&8&&(p.clickEvt=h[3]),s.$set(p),(!c||y&1)&&set_style(a,"max-height",h[4](h[12])*25+"px"),(!c||y&1&&u!==(u="nav-dir-header "+(h[12].collapsed?"":"active")+" svelte-15ysesh"))&&attr(t,"class",u)},i(h){c||(transition_in(s.$$.fragment,h),c=!0)},o(h){transition_out(s.$$.fragment,h),c=!1},d(h){h&&detach(t),destroy_component(s),f=!1,run_all(d)}}}function create_if_block$2(e){let t,r=e[12].replace(/_/g," ")+"",n,o,i,a,s;function l(...c){return e[7](e[12],...c)}function u(...c){return e[8](e[12],...c)}return{c(){t=element("menuitem"),n=text$1(r),o=space(),attr(t,"class",i="nav-link "+(e[2]===e[1]+e[12]?"current":"")+" svelte-15ysesh"),attr(t,"tabindex","0")},m(c,f){insert(c,t,f),append(t,n),append(t,o),a||(s=[listen(t,"click",l),listen(t,"keydown",u)],a=!0)},p(c,f){e=c,f&1&&r!==(r=e[12].replace(/_/g," ")+"")&&set_data(n,r),f&7&&i!==(i="nav-link "+(e[2]===e[1]+e[12]?"current":"")+" svelte-15ysesh")&&attr(t,"class",i)},i:noop$1,o:noop$1,d(c){c&&detach(t),a=!1,run_all(s)}}}function create_each_block$1(e){let t,r,n,o;const i=[create_if_block$2,create_else_block$2],a=[];function s(l,u){return typeof l[12]=="string"?0:1}return t=s(e),r=a[t]=i[t](e),{c(){r.c(),n=empty$2()},m(l,u){a[t].m(l,u),insert(l,n,u),o=!0},p(l,u){let c=t;t=s(l),t===c?a[t].p(l,u):(group_outros(),transition_out(a[c],1,1,()=>{a[c]=null}),check_outros(),r=a[t],r?r.p(l,u):(r=a[t]=i[t](l),r.c()),transition_in(r,1),r.m(n.parentNode,n))},i(l){o||(transition_in(r),o=!0)},o(l){transition_out(r),o=!1},d(l){a[t].d(l),l&&detach(n)}}}function create_fragment$3(e){let t,r,n=e[0].children,o=[];for(let a=0;a<n.length;a+=1)o[a]=create_each_block$1(get_each_context$1(e,n,a));const i=a=>transition_out(o[a],1,1,()=>{o[a]=null});return{c(){for(let a=0;a<o.length;a+=1)o[a].c();t=empty$2()},m(a,s){for(let l=0;l<o.length;l+=1)o[l].m(a,s);insert(a,t,s),r=!0},p(a,[s]){if(s&127){n=a[0].children;let l;for(l=0;l<n.length;l+=1){const u=get_each_context$1(a,n,l);o[l]?(o[l].p(u,s),transition_in(o[l],1)):(o[l]=create_each_block$1(u),o[l].c(),transition_in(o[l],1),o[l].m(t.parentNode,t))}for(group_outros(),l=n.length;l<o.length;l+=1)i(l);check_outros()}},i(a){if(!r){for(let s=0;s<n.length;s+=1)transition_in(o[s]);r=!0}},o(a){o=o.filter(Boolean);for(let s=0;s<o.length;s+=1)transition_out(o[s]);r=!1},d(a){destroy_each(o,a),a&&detach(t)}}}const click_handler_1=function(e){e.stopPropagation(),this.classList.toggle("active")};function instance$3(e,t,r){let{pageDirStructure:n={label:"_",children:[]}}=t,{pageRoot:o=""}=t,{lastPage:i=""}=t,{clickEvt:a=async()=>{}}=t;const s=p=>{let v=0;for(const b of p.children)typeof b!="string"&&(v+=s(b)),v++;return v},l=p=>p instanceof HTMLElement?(p.focus(),!0):!1,u=(p,v)=>{var w,P;const b=v==="next"?"nextElementSibling":"previousElementSibling",S=v==="next"?"firstElementChild":"lastElementChild";if(p[b]instanceof HTMLElement)l(p[b]);else if((w=p==null?void 0:p.parentElement)!=null&&w.parentElement.classList.contains("nav-dir-header")){const E=p.parentElement.parentElement[b];E?(p.parentElement.parentElement.classList.remove("active"),E.classList.contains("nav-dir-header")?(E.classList.add("active"),l(E.children.item(1)[S])):l(E)):u(p.parentElement.parentElement,v)}else(P=p==null?void 0:p.parentElement)!=null&&P.parentElement&&l(p.parentElement.parentElement)},c=p=>{if(p.target instanceof HTMLElement)switch(p.code){case"ArrowDown":u(p.target,"next");break;case"ArrowUp":u(p.target,"previous");break;case"ArrowRight":case"Enter":p.target.classList.contains("active")?l(p.target.children.item(1).firstElementChild):p.target.classList.add("active");break;case"ArrowLeft":p.target.classList.contains("active")?p.target.classList.remove("active"):l(p.target.parentElement.parentElement);break;case"Tab":u(p.target,p.shiftKey?"next":"previous");break}},f=(p,v)=>{if(p.target instanceof HTMLElement)switch(p.code){case"ArrowDown":u(p.target,"next");break;case"ArrowUp":u(p.target,"previous");break;case"Space":case"ArrowRight":case"Enter":v();break;case"ArrowLeft":l(p.target.parentElement.parentElement);break;case"Tab":u(p.target,p.shiftKey?"next":"previous");break}},d=(p,v)=>{v.stopPropagation(),a(o+p)},h=(p,v)=>{v.stopPropagation(),v.preventDefault(),f(v,()=>a(o+p))},y=function(p){p.stopPropagation(),p.preventDefault(),c(p)};return e.$$set=p=>{"pageDirStructure"in p&&r(0,n=p.pageDirStructure),"pageRoot"in p&&r(1,o=p.pageRoot),"lastPage"in p&&r(2,i=p.lastPage),"clickEvt"in p&&r(3,a=p.clickEvt)},[n,o,i,a,s,c,f,d,h,y]}class PageNav extends SvelteComponent{constructor(t){super(),init(this,t,instance$3,create_fragment$3,safe_not_equal,{pageDirStructure:0,pageRoot:1,lastPage:2,clickEvt:3})}}const StandardTable_svelte_svelte_type_style_lang="";function create_else_block$1(e){let t,r;function n(a,s){return a[2]?create_if_block_1$1:a[0]?create_else_block_1$1:create_if_block_2$1}let o=n(e),i=o(e);return{c(){i.c(),t=space(),r=element("div"),set_style(r,"display",e[0]?"none":"block")},m(a,s){i.m(a,s),insert(a,t,s),insert(a,r,s),e[11](r)},p(a,s){o===(o=n(a))&&i?i.p(a,s):(i.d(1),i=o(a),i&&(i.c(),i.m(t.parentNode,t))),s&1&&set_style(r,"display",a[0]?"none":"block")},d(a){i.d(a),a&&detach(t),a&&detach(r),e[11](null)}}}function create_if_block$1(e){let t,r,n;return{c(){t=element("button"),t.textContent="show table",set_style(t,"display","block"),attr(t,"class","svelte-2pzyd5")},m(o,i){insert(o,t,i),r||(n=listen(t,"click",e[4]),r=!0)},p:noop$1,d(o){o&&detach(t),r=!1,n()}}}function create_else_block_1$1(e){let t,r,n;return{c(){t=element("button"),t.textContent="show table",set_style(t,"display","block"),attr(t,"class","svelte-2pzyd5")},m(o,i){insert(o,t,i),r||(n=listen(t,"click",e[10]),r=!0)},p:noop$1,d(o){o&&detach(t),r=!1,n()}}}function create_if_block_2$1(e){let t,r,n,o,i;return{c(){t=element("button"),t.textContent="hide table",r=space(),n=element("button"),n.textContent="edit table",attr(t,"class","svelte-2pzyd5"),attr(n,"class","svelte-2pzyd5")},m(a,s){insert(a,t,s),insert(a,r,s),insert(a,n,s),o||(i=[listen(t,"click",e[9]),listen(n,"click",e[6])],o=!0)},p:noop$1,d(a){a&&detach(t),a&&detach(r),a&&detach(n),o=!1,run_all(i)}}}function create_if_block_1$1(e){let t,r,n,o,i;return{c(){t=element("button"),t.textContent="stop editing",r=space(),n=element("button"),n.textContent="copy as markdown",attr(t,"class","svelte-2pzyd5"),attr(n,"class","svelte-2pzyd5")},m(a,s){insert(a,t,s),insert(a,r,s),insert(a,n,s),o||(i=[listen(t,"click",e[7]),listen(n,"click",e[5])],o=!0)},p:noop$1,d(a){a&&detach(t),a&&detach(r),a&&detach(n),o=!1,run_all(i)}}}function create_fragment$2(e){let t;function r(i,a){return i[1]==!1?create_if_block$1:create_else_block$1}let n=r(e),o=n(e);return{c(){o.c(),t=empty$2()},m(i,a){o.m(i,a),insert(i,t,a)},p(i,[a]){n===(n=r(i))&&o?o.p(i,a):(o.d(1),o=n(i),o&&(o.c(),o.m(t.parentNode,t)))},i:noop$1,o:noop$1,d(i){o.d(i),i&&detach(t)}}}function instance$2(e,t,r){let{tableData:n}=t,{hidden:o}=t,i=!1,a=!1,s,l;const u=async()=>{r(1,i=!0),await tick(),l=new Handsontable$1(s,n)},c=()=>{copyToClipboard(hotLanguageSerialize(l))},f=()=>{l.updateSettings({readOnly:!1,contextMenu:!0,allowInsertColumn:!0,allowInsertRow:!0}),r(2,a=!0)},d=()=>{l.updateSettings({readOnly:!0,contextMenu:!1}),r(2,a=!1)};onMount(()=>{o||u(),r(0,o=!1)});const h=()=>r(0,o=!0),y=()=>r(0,o=!1);function p(v){binding_callbacks[v?"unshift":"push"](()=>{s=v,r(3,s)})}return e.$$set=v=>{"tableData"in v&&r(8,n=v.tableData),"hidden"in v&&r(0,o=v.hidden)},[o,i,a,s,u,c,f,d,n,h,y,p]}class StandardTable extends SvelteComponent{constructor(t){super(),init(this,t,instance$2,create_fragment$2,safe_not_equal,{tableData:8,hidden:0})}}const StructTable_svelte_svelte_type_style_lang="";function create_else_block(e){let t,r,n,o,i,a,s,l,u;function c(h,y){return h[3]?create_if_block_1:h[0]?create_else_block_1:create_if_block_2}let f=c(e),d=f(e);return{c(){d.c(),t=space(),r=element("div"),n=element("span"),n.textContent="properties",o=space(),i=element("div"),a=space(),s=element("span"),s.textContent="functions",l=space(),u=element("div"),attr(n,"class","block-heading svelte-18qp6ys"),attr(s,"class","block-heading svelte-18qp6ys"),attr(r,"class","tables"),set_style(r,"display",e[0]?"none":"block")},m(h,y){d.m(h,y),insert(h,t,y),insert(h,r,y),append(r,n),append(r,o),append(r,i),e[13](i),append(r,a),append(r,s),append(r,l),append(r,u),e[14](u)},p(h,y){f===(f=c(h))&&d?d.p(h,y):(d.d(1),d=f(h),d&&(d.c(),d.m(t.parentNode,t))),y&1&&set_style(r,"display",h[0]?"none":"block")},d(h){d.d(h),h&&detach(t),h&&detach(r),e[13](null),e[14](null)}}}function create_if_block(e){let t,r,n;return{c(){t=element("button"),t.textContent="show table",set_style(t,"display","block"),attr(t,"class","svelte-18qp6ys")},m(o,i){insert(o,t,i),r||(n=listen(t,"click",e[6]),r=!0)},p:noop$1,d(o){o&&detach(t),r=!1,n()}}}function create_else_block_1(e){let t,r,n;return{c(){t=element("button"),t.textContent="show table",set_style(t,"display","block"),attr(t,"class","svelte-18qp6ys")},m(o,i){insert(o,t,i),r||(n=listen(t,"click",e[12]),r=!0)},p:noop$1,d(o){o&&detach(t),r=!1,n()}}}function create_if_block_2(e){let t,r,n,o,i;return{c(){t=element("button"),t.textContent="hide table",r=space(),n=element("button"),n.textContent="edit table",attr(t,"class","svelte-18qp6ys"),attr(n,"class","svelte-18qp6ys")},m(a,s){insert(a,t,s),insert(a,r,s),insert(a,n,s),o||(i=[listen(t,"click",e[11]),listen(n,"click",e[7])],o=!0)},p:noop$1,d(a){a&&detach(t),a&&detach(r),a&&detach(n),o=!1,run_all(i)}}}function create_if_block_1(e){let t,r,n;return{c(){t=element("button"),t.textContent="stop editing",attr(t,"class","svelte-18qp6ys")},m(o,i){insert(o,t,i),r||(n=listen(t,"click",e[8]),r=!0)},p:noop$1,d(o){o&&detach(t),r=!1,n()}}}function create_fragment$1(e){let t,r,n,o;function i(l,u){return l[2]==!1?create_if_block:create_else_block}let a=i(e),s=a(e);return{c(){t=element("h5"),r=text$1(e[1]),n=space(),s.c(),o=empty$2(),attr(t,"class","block-heading")},m(l,u){insert(l,t,u),append(t,r),insert(l,n,u),s.m(l,u),insert(l,o,u)},p(l,[u]){u&2&&set_data(r,l[1]),a===(a=i(l))&&s?s.p(l,u):(s.d(1),s=a(l),s&&(s.c(),s.m(o.parentNode,o)))},i:noop$1,o:noop$1,d(l){l&&detach(t),l&&detach(n),s.d(l),l&&detach(o)}}}function instance$1(e,t,r){let{name:n}=t,{structData:o}=t,{fnData:i}=t,{hidden:a}=t,s=!1,l=!1,u,c,f,d;const h=async()=>{r(2,s=!0),await tick(),c=new Handsontable(u,o),d=new Handsontable(f,i)},y=()=>{c.updateSettings({readOnly:!1,contextMenu:!0,allowInsertColumn:!0,allowInsertRow:!0}),d.updateSettings({readOnly:!1,contextMenu:!0,allowInsertColumn:!0,allowInsertRow:!0}),r(3,l=!0)},p=()=>{c.updateSettings({readOnly:!0,contextMenu:!1}),d.updateSettings({readOnly:!0,contextMenu:!1}),r(3,l=!1)};onMount(()=>{a||h(),r(0,a=!1)});const v=()=>r(0,a=!0),b=()=>r(0,a=!1);function S(P){binding_callbacks[P?"unshift":"push"](()=>{u=P,r(4,u)})}function w(P){binding_callbacks[P?"unshift":"push"](()=>{f=P,r(5,f)})}return e.$$set=P=>{"name"in P&&r(1,n=P.name),"structData"in P&&r(9,o=P.structData),"fnData"in P&&r(10,i=P.fnData),"hidden"in P&&r(0,a=P.hidden)},[a,n,s,l,u,f,h,y,p,o,i,v,b,S,w]}class StructTable extends SvelteComponent{constructor(t){super(),init(this,t,instance$1,create_fragment$1,safe_not_equal,{name:1,structData:9,fnData:10,hidden:0})}}const App_svelte_svelte_type_style_lang="";function get_each_context(e,t,r){const n=e.slice();return n[17]=t[r],n}function create_each_block(e){let t,r,n=e[17].text+"",o,i;return{c(){t=element("li"),r=element("a"),o=text$1(n),attr(r,"href",i="#"+e[17].id),set_style(t,"margin-left",(e[17].level-1)*10+"px"),attr(t,"class","svelte-1k3jykm")},m(a,s){insert(a,t,s),append(t,r),append(r,o)},p(a,s){s&2&&n!==(n=a[17].text+"")&&set_data(o,n),s&2&&i!==(i="#"+a[17].id)&&attr(r,"href",i),s&2&&set_style(t,"margin-left",(a[17].level-1)*10+"px")},d(a){a&&detach(t)}}}function create_fragment(e){let t,r,n,o,i,a,s,l,u,c,f,d,h,y,p,v,b,S,w,P,E,j,G;d=new PageNav({props:{pageDirStructure:e[6],clickEvt:e[10],lastPage:e[4]}});let q=e[1],z=[];for(let U=0;U<q.length;U+=1)z[U]=create_each_block(get_each_context(e,q,U));return{c(){t=element("header"),r=element("button"),r.textContent="pages",n=space(),o=element("button"),o.textContent="content",i=space(),a=element("div"),l=space(),u=element("main"),c=element("div"),f=element("div"),create_component(d.$$.fragment),y=space(),p=element("div"),v=element("div"),b=space(),S=element("div"),w=element("ul");for(let U=0;U<z.length;U+=1)z[U].c();attr(r,"class","sidebarButton svelte-1k3jykm"),attr(o,"class","navButton svelte-1k3jykm"),attr(t,"class","svelte-1k3jykm"),attr(a,"class",s="offToggle "+(e[3]||e[2]?"active":"")+" svelte-1k3jykm"),attr(f,"class","list svelte-1k3jykm"),attr(c,"class",h="sidebar "+(e[3]?"active":"")+" svelte-1k3jykm"),attr(v,"class","content-wrapper svelte-1k3jykm"),attr(v,"id","content"),attr(p,"class","content svelte-1k3jykm"),attr(w,"class","svelte-1k3jykm"),attr(S,"class",P="TOC "+(e[2]?"active":"")+" svelte-1k3jykm"),attr(u,"class","svelte-1k3jykm")},m(U,Z){insert(U,t,Z),append(t,r),append(t,n),append(t,o),insert(U,i,Z),insert(U,a,Z),insert(U,l,Z),insert(U,u,Z),append(u,c),append(c,f),mount_component(d,f,null),append(u,y),append(u,p),append(p,v),v.innerHTML=e[5],append(u,b),append(u,S),append(S,w);for(let te=0;te<z.length;te+=1)z[te].m(w,null);E=!0,j||(G=[listen(r,"click",e[7]),listen(o,"click",e[8]),listen(a,"click",e[9])],j=!0)},p(U,[Z]){(!E||Z&12&&s!==(s="offToggle "+(U[3]||U[2]?"active":"")+" svelte-1k3jykm"))&&attr(a,"class",s);const te={};if(Z&64&&(te.pageDirStructure=U[6]),Z&1&&(te.clickEvt=U[10]),Z&16&&(te.lastPage=U[4]),d.$set(te),(!E||Z&8&&h!==(h="sidebar "+(U[3]?"active":"")+" svelte-1k3jykm"))&&attr(c,"class",h),(!E||Z&32)&&(v.innerHTML=U[5]),Z&2){q=U[1];let Q;for(Q=0;Q<q.length;Q+=1){const ie=get_each_context(U,q,Q);z[Q]?z[Q].p(ie,Z):(z[Q]=create_each_block(ie),z[Q].c(),z[Q].m(w,null))}for(;Q<z.length;Q+=1)z[Q].d(1);z.length=q.length}(!E||Z&4&&P!==(P="TOC "+(U[2]?"active":"")+" svelte-1k3jykm"))&&attr(S,"class",P)},i(U){E||(transition_in(d.$$.fragment,U),E=!0)},o(U){transition_out(d.$$.fragment,U),E=!1},d(U){U&&detach(t),U&&detach(i),U&&detach(a),U&&detach(l),U&&detach(u),destroy_component(d),destroy_each(z,U),j=!1,run_all(G)}}}function instance($$self,$$props,$$invalidate){let $currentPath;component_subscribe($$self,currentPath,e=>$$invalidate(0,$currentPath=e)),registerHexRenderers();const tables=[],structData=[];let TOC=[],TOCIsActive=!1,sidebarIsActive=!1,lastPage=localStorage.getItem("lastPage"),pages=[],pageScripts=[];const getStructData=()=>localStorage.getItem("structs");marked.use({renderer:rendererFactory({hotLang:tables,struct:{getCurrentData:getStructData,tableData:structData}},TOC,pages,pageScripts)});let markedHTMLOut="";const updatePageContent=async()=>{localStorage.setItem("lastPage",$currentPath),$$invalidate(4,lastPage=$currentPath),tables.length=0,structData.length=0,$$invalidate(1,TOC.length=0,TOC),$$invalidate(5,markedHTMLOut=marked(await(await fetch(`${hostRootAddr}${$currentPath}.md`)).text())),$$invalidate(1,TOC);for(const src of pageScripts)console.log(src),eval(await(await fetch(src)).text());pageScripts=[],await tick();for(const[e,t]of tables.entries())new StandardTable({target:document.getElementById(`HOTable-${e}`),props:{tableData:t,hidden:tables.length>10}});for(const[e,{name:t,properties:r,functions:n}]of structData.entries())console.log(document.getElementById(`structTable-${e}`)),new StructTable({target:document.getElementById(`structTable-${e}`),props:{name:t,structData:r,fnData:n,hidden:!0}});for(const[e,t]of structData.entries())console.log(e,t);const titleHeader=document.createElement("h6");titleHeader.innerText=$currentPath.replace(/\//g," > "),document.getElementById("content").prepend(titleHeader);for(const e of document.querySelectorAll("h1, h2, h3, h4, h5, h6"))e.classList.add("page-link"),e.addEventListener("click",()=>{navigator.clipboard.writeText(`${window.location.origin}${window.location.pathname}?page=${$currentPath}&location=${e.id}`)})};let pageDirStructure={label:"_root",children:[],collapsed:!1};(async()=>{let t;t=(await(await fetch(`${hostRootAddr}_pages.txt`)).text()).replace(/\r/g,"").split(`
`);const r=[],n=[pageDirStructure];let o=0;for(const l of t){if(l.trim().startsWith("? ")||l.length===0)continue;const u=l.search(/\S/);if(u<o){const f=(o-u)/2;for(let d=0;d<f;d++)r.pop();n.length=r.length+1,o=u}else o=u;let c=l.trim();if(c.startsWith("?c")&&(c=c.substring(2).trim(),c.endsWith("/"))){pages.push(r.join("")+c),r.push(c),n[n.length-1].children.push({label:c,children:[],collapsed:!0}),n.push(n[n.length-1].children.slice(-1)[0]),o+=2;continue}pages.push(r.join("")+c),l.endsWith("/")?(r.push(c),n[n.length-1].children.push({label:c,children:[]}),n.push(n[n.length-1].children.slice(-1)[0]),o+=2):n[n.length-1].children.push(c)}$$invalidate(6,pageDirStructure);const i=new URLSearchParams(window.location.search),a=i.get("page"),s=i.get("location");set_store_value(currentPath,$currentPath=a||localStorage.getItem("lastPage")||"index",$currentPath),await tick(),s&&document.getElementById(new marked.Slugger().slug(s,{dryrun:!0})).scrollIntoView()})();const click_handler=()=>$$invalidate(3,sidebarIsActive=!0),click_handler_1=()=>$$invalidate(2,TOCIsActive=!0),click_handler_2=()=>{$$invalidate(2,TOCIsActive=!1),$$invalidate(3,sidebarIsActive=!1)},func=e=>{set_store_value(currentPath,$currentPath=e,$currentPath)};return $$self.$$.update=()=>{$$self.$$.dirty&1&&updatePageContent()},[$currentPath,TOC,TOCIsActive,sidebarIsActive,lastPage,markedHTMLOut,pageDirStructure,click_handler,click_handler_1,click_handler_2,func]}class App extends SvelteComponent{constructor(t){super(),init(this,t,instance,create_fragment,safe_not_equal,{})}}new App({target:document.getElementById("app")})});export default st();
